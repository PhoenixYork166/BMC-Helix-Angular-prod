{"version":3,"file":"revert-customization.component.js","sourceRoot":"","sources":["../../../../../../../libs/platform/shared/components/revert-customization/revert-customization.component.ts","../../../../../../../libs/platform/shared/components/revert-customization/revert-customization.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, EventEmitter, Input, OnChanges, OnDestroy, OnInit, Output, SimpleChanges } from '@angular/core';\nimport {\n  FormBuilderEvent,\n  IFormBuilderEvent,\n  IFormWidgetComponent,\n  RX_OVERLAY,\n  RxOverlayService\n} from '@helix/platform/shared/api';\nimport { ReplaySubject } from 'rxjs';\nimport { RX_MODAL, RxModalService } from '@helix/platform/ui-kit';\nimport { RX_REVERT_CUSTOMIZATION } from './revert-customization.constants';\nimport { IRevertCustomizationOptions } from './revert-customization.interfaces';\n\n@Component({\n  selector: 'rx-revert-customization',\n  templateUrl: './revert-customization.component.html'\n})\nexport class RxRevertCustomizationComponent implements OnInit, OnDestroy, OnChanges, IFormWidgetComponent {\n  @Input()\n  options: IRevertCustomizationOptions;\n\n  @Input()\n  isDisabled: boolean;\n\n  @Output()\n  events: EventEmitter<IFormBuilderEvent> = new EventEmitter();\n\n  showOverlayOptions = false;\n  isRevertActionHidden = false;\n  isOverlayOperationHidden = false;\n  overlayOperation: string;\n\n  private destroyed$ = new ReplaySubject<boolean>(1);\n\n  constructor(private rxModalService: RxModalService, private rxOverlayService: RxOverlayService) {}\n\n  ngOnInit() {\n    this.updateData();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (\n      changes.options &&\n      (changes.options.currentValue.overlayGroupId !== changes.options.previousValue?.overlayGroupId ||\n        changes.options.currentValue.overlayDescriptor?.parentOverlayGroupId !==\n          changes.options.previousValue?.overlayDescriptor?.parentOverlayGroupId)\n    ) {\n      this.updateData();\n    }\n  }\n\n  ngOnDestroy() {\n    this.destroyed$.next(true);\n    this.destroyed$.complete();\n  }\n\n  private updateData(): void {\n    if (this.options.overlayGroupId) {\n      this.overlayOperation = this.getOverlayOperation();\n      this.isOverlayOperationHidden = RX_OVERLAY.operationTypes.createdInThisOverlayGroup === this.overlayOperation;\n      this.isRevertActionHidden = this.shouldHideRevertAction();\n      this.showOverlayOptions = !this.isOverlayOperationHidden || !this.isRevertActionHidden;\n    } else {\n      this.overlayOperation = RX_OVERLAY.operationTypes.createdInThisOverlayGroup;\n      this.isOverlayOperationHidden = true;\n      this.isRevertActionHidden = true;\n    }\n\n    this.events.emit({ type: FormBuilderEvent.HideWidget, payload: !this.showOverlayOptions });\n  }\n\n  private revertCustomization(): void {\n    this.events.emit({ type: RX_REVERT_CUSTOMIZATION.events.revertCustomization });\n  }\n\n  private getOverlayOperation(): string {\n    return this.rxOverlayService.getOverlayOperation(\n      this.options.overlayGroupId,\n      this.options.overlayDescriptor ? this.options.overlayDescriptor.parentOverlayGroupId : null\n    );\n  }\n\n  private shouldHideRevertAction(): boolean {\n    return this.overlayOperation === RX_OVERLAY.operationTypes.customizedInThisOverlayGroup\n      ? !this.options.allowOverlay\n      : true;\n  }\n\n  onRevertCustomization(): void {\n    this.rxModalService\n      .confirm({\n        title: 'Warning',\n        modalStyle: RX_MODAL.modalStyles.warning,\n        message: 'Are you sure you want to revert customization?'\n      })\n      .then((revert: boolean) => {\n        if (revert) {\n          this.revertCustomization();\n        }\n      });\n  }\n}\n","<div *ngIf=\"showOverlayOptions\" class=\"d-flex justify-content-between align-items-end\">\n  <div *ngIf=\"!isOverlayOperationHidden\" class=\"mb-0\">\n    <adapt-rx-control-label label=\"Customization status\" class=\"d-block pb-1\"></adapt-rx-control-label>\n    {{ overlayOperation }}\n  </div>\n\n  <adapt-button\n    class=\"p-0\"\n    btn-type=\"tertiary\"\n    rx-id=\"revert-customization-button\"\n    *ngIf=\"!isRevertActionHidden\"\n    (click)=\"onRevertCustomization()\"\n  >\n    <span class=\"d-icon-left-undo\"></span>\n    Revert\n  </adapt-button>\n</div>\n"]}