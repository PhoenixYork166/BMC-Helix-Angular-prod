{"version":3,"file":"canvas-outlet.component.js","sourceRoot":"","sources":["../../../../../../../../../../libs/platform/view/designer/components/view-designer-canvas/component/canvas-outlet/canvas-outlet.component.ts","../../../../../../../../../../libs/platform/view/designer/components/view-designer-canvas/component/canvas-outlet/canvas-outlet.component.html"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  ComponentFactoryResolver,\n  EventEmitter,\n  Inject,\n  Input,\n  OnInit,\n  OnDestroy,\n  Optional,\n  Output,\n  SkipSelf,\n  Type,\n  ViewChild,\n  ViewContainerRef\n} from '@angular/core';\nimport { DropListOrientation } from '@angular/cdk/drag-drop';\nimport { RX_VIEW_DEFINITION } from '@helix/platform/view/api';\nimport { IViewDesignerCanvasItemApi } from '../../interfaces/view-designer-canvas-item-api.interface';\nimport { ViewDesignerCanvasItemApiToken } from '../../tokens/view-designer-canvas-item-api.token';\nimport {\n  IViewComponentDropData,\n  IViewComponentDropPredicateData\n} from '../../interfaces/view-designer-canvas.interfaces';\nimport { CanvasOutletHelperService } from './canvas-outlet-helper.service';\nimport { CanvasItemContainerComponent } from '../canvas-item-container/canvas-item-container.component';\nimport { ReplaySubject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\n@Component({\n  selector: 'rx-canvas-outlet',\n  templateUrl: './canvas-outlet.component.html',\n  providers: [CanvasOutletHelperService]\n})\nexport class CanvasOutletComponent implements OnInit, OnDestroy {\n  containerComponentInstance: any = null;\n  private destroyed$: ReplaySubject<boolean> = new ReplaySubject(1);\n\n  @Input()\n  name = RX_VIEW_DEFINITION.defaultOutletName;\n\n  @Input()\n  skipParentPredicate = false;\n\n  @Input()\n  containerComponent: Type<any>;\n\n  @Input()\n  dropListOrientation: DropListOrientation = 'vertical';\n\n  @ViewChild('container', { read: ViewContainerRef, static: true })\n  container: ViewContainerRef;\n\n  @Output()\n  beforeViewComponentDrop = new EventEmitter<IViewComponentDropData>();\n\n  @Input()\n  dropPredicate: (data: IViewComponentDropPredicateData) => boolean = () => true;\n\n  constructor(\n    @Inject(ViewDesignerCanvasItemApiToken) private canvasItemApi: IViewDesignerCanvasItemApi,\n    @SkipSelf() @Optional() private parentOutletComponent: CanvasOutletComponent,\n    private canvasOutletHelperService: CanvasOutletHelperService,\n    private componentFactoryResolver: ComponentFactoryResolver\n  ) {}\n\n  ngOnDestroy(): void {\n    this.destroyed$.next(true);\n    this.destroyed$.complete();\n  }\n\n  ngOnInit(): void {\n    this.containerComponentInstance = this.canvasItemApi.core.registerOutlet(\n      this.name,\n      this.container,\n      this.componentFactoryResolver.resolveComponentFactory(this.containerComponent || CanvasItemContainerComponent)\n    ).instance;\n\n    this.canvasOutletHelperService.dropListOrientation = this.dropListOrientation;\n    this.canvasOutletHelperService.parentOutletComponent = this.parentOutletComponent;\n    this.canvasOutletHelperService.dropPredicate = this.dropPredicate;\n    this.canvasOutletHelperService.skipParentPredicate = this.skipParentPredicate;\n    this.canvasOutletHelperService.containerComponentInstance = this.containerComponentInstance;\n\n    this.canvasOutletHelperService.beforeViewComponentDrop$.pipe(takeUntil(this.destroyed$)).subscribe((event) => {\n      this.beforeViewComponentDrop.emit(event);\n    });\n  }\n\n  canBeDropped(data: IViewComponentDropPredicateData): boolean {\n    return this.canvasOutletHelperService.canBeDropped(data);\n  }\n\n  componentDropPredicate(data: IViewComponentDropPredicateData, skipPredicate = false): boolean {\n    return this.canvasOutletHelperService.componentDropPredicate(data, skipPredicate);\n  }\n}\n","<ng-container #container></ng-container>\n"]}