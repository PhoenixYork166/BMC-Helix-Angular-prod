{"version":3,"file":"record-designer.service.js","sourceRoot":"","sources":["../../../../../../../libs/platform/record/designer/record-designer/record-designer.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\nimport { IRecordDefinitionModel, IRecordFieldDefinitionModel } from '../record-designer.types';\nimport {\n  AssociationSelectionType,\n  IFieldDefinition,\n  IRecordDefinition,\n  RX_RECORD_DEFINITION,\n  RxFieldDefinitionService,\n  RxRecordDefinitionService\n} from '@helix/platform/record/api';\nimport { find, isNumber, omit } from 'lodash';\nimport { RxDefinitionNameService, RxLocalizationService, RxOverlayService } from '@helix/platform/shared/api';\nimport { RxDateUtilsService, RxGuidService } from '@helix/platform/utils';\nimport moment from 'moment-es6';\n\n@Injectable()\nexport class RxRecordDesignerService {\n  constructor(\n    private rxDefinitionNameService: RxDefinitionNameService,\n    private rxFieldDefinitionService: RxFieldDefinitionService,\n    private rxGuidService: RxGuidService,\n    private rxOverlayService: RxOverlayService,\n    private rxRecordDefinitionService: RxRecordDefinitionService,\n    private rxLocalizationService: RxLocalizationService,\n    private rxDateUtilService: RxDateUtilsService\n  ) {}\n\n  // Convert \"$ID$ = 'ID'\" to ${Record1.PRIMARY_RECORD_DEFINITION.ID} = ${Record2.SECONDARY_RECORD_DEFINITION.ID}\n  getJoinCriteriaExpression(\n    joinCriteria: string,\n    primaryRecordDefinitionName: string,\n    secondaryRecordDefinitionName: string\n  ): string {\n    const primaryFieldRegExp = new RegExp('\\\\$(?!NULL)([\\\\w .]+)\\\\$', 'g');\n    const secondaryFieldRegExp = new RegExp(\"'([^']+)'\", 'g');\n\n    return (joinCriteria || '')\n      .replace(\n        primaryFieldRegExp,\n        '${' +\n          this.rxDefinitionNameService.getDisplayName(primaryRecordDefinitionName) +\n          '.' +\n          RX_RECORD_DEFINITION.sourceRecordTypes.primary +\n          '.$1}'\n      )\n      .replace(\n        secondaryFieldRegExp,\n        '${' +\n          this.rxDefinitionNameService.getDisplayName(secondaryRecordDefinitionName) +\n          '.' +\n          RX_RECORD_DEFINITION.sourceRecordTypes.secondary +\n          '.$1}'\n      );\n  }\n\n  // Convert ${Record1.PRIMARY_RECORD_DEFINITION.ID} = ${Record2.SECONDARY_RECORD_DEFINITION.ID} to \"$ID$ = 'ID'\"\n  getJoinCriteriaArExpression(\n    joinCriteria: string,\n    primaryRecordDefinitionName: string,\n    secondaryRecordDefinitionName: string\n  ): string {\n    const primaryFieldRegExp = new RegExp(\n      '\\\\${' +\n        this.rxDefinitionNameService.getDisplayName(primaryRecordDefinitionName) +\n        '\\\\.' +\n        RX_RECORD_DEFINITION.sourceRecordTypes.primary +\n        '\\\\.([^}]+)}',\n      'g'\n    );\n\n    const secondaryFieldRegExp = new RegExp(\n      '\\\\${' +\n        this.rxDefinitionNameService.getDisplayName(secondaryRecordDefinitionName) +\n        '\\\\.' +\n        RX_RECORD_DEFINITION.sourceRecordTypes.secondary +\n        '\\\\.([^}]+)}',\n      'g'\n    );\n\n    return (joinCriteria || '')\n      .replace(primaryFieldRegExp, '#$1#')\n      .replace(/#/g, '$')\n      .replace(secondaryFieldRegExp, \"'$1'\");\n  }\n\n  getDefinitionFromDefinitionModel(model: IRecordDefinitionModel, bundleId: string): IRecordDefinition {\n    return {\n      allowFieldsOverlay: model.customizationOptions.allowFieldsOverlay,\n      allowNonAdminToDeleteRecordInstances: model.allowNonAdminToDeleteRecordInstances,\n      allowIndexesOverlay: model.customizationOptions.allowIndexesOverlay,\n      allowOtherPropertiesOverlay: model.customizationOptions.allowOtherPropertiesOverlay,\n      allowPermissionsOverlay: model.customizationOptions.allowPermissionsOverlay,\n      enableCognitiveSearch: model.enableCognitiveSearch,\n      description: model.description,\n      guid: model.guid,\n      indexDefinitions:\n        model.resourceType === RX_RECORD_DEFINITION.recordDefinitionTypes.regular.recordDefinitionType\n          ? model.indexDefinitions.map((indexDefinitionModel) => omit(indexDefinitionModel, 'isAutomaticIndex'))\n          : undefined,\n      inheritanceDescriptor: model.recordInheritanceSelector.inheritanceDescriptor,\n      isAbstract: model.recordInheritanceSelector.inheritanceOptions?.isAbstract,\n      isFinal: model.recordInheritanceSelector.inheritanceOptions?.isFinal,\n      isSharedInstanceStorage: model.recordInheritanceSelector.inheritanceOptions?.isSharedInstanceStorage,\n      joinCriteria: model.joinCriteria\n        ? this.getJoinCriteriaArExpression(\n            model.joinCriteria,\n            model.primaryRecordDefinitionName,\n            model.secondaryRecordDefinitionName\n          )\n        : undefined,\n      joinType: model.joinType,\n      lastChangedBy: model.lastChangedBy,\n      lastUpdateTime: model.lastUpdateTime ? moment(model.lastUpdateTime).format() : null,\n      name: `${bundleId}:${model.name}`,\n      overlayGroupId: model.overlayGroupId,\n      owner: model.owner,\n      overlayDescriptor: model.overlayDescriptor,\n      permissions: model.permissions,\n      primaryRecordDefinitionName: model.primaryRecordDefinitionName,\n      resourceType: model.resourceType,\n      secondaryRecordDefinitionName: model.secondaryRecordDefinitionName,\n      shouldExportData: model.shouldExportData,\n      scope: model.customizationOptions.scope,\n      tags: model.tags,\n      version: model.version,\n      weightedRelevancyFields: {\n        TITLE: model.weightedRelevancyTitle,\n        ENVIRONMENT: model.weightedRelevancyEnvironment,\n        KEYWORDS: model.weightedRelevancyKeywords\n      },\n      displayFieldIdInAssociation: find(model.fields, { id: model.displayFieldIdInAssociation })\n        ? model.displayFieldIdInAssociation\n        : null,\n      archiveDescriptor: {\n        ageQualifierFieldId: model.ageQualifierFieldId,\n        ageQualifierInDays: model.ageQualifierInDays,\n        archiveRecordDefinitionName: model.archiveRecordDefinitionName,\n        description: model.archiveDescription,\n        archiveType: model.archiveType,\n        includeAttachments: model.includeAttachments,\n        archiveDataCriteria: model.archiveDataCriteria,\n        isEnabled: model.isArchivingEnabled\n      },\n      associationsToFollowForArchive: model.associationsToFollowForArchive,\n      auditDescriptor: {\n        isEnabled: model.isAuditingEnabled,\n        auditRecordDefinitionName: model.auditRecordDefinitionName,\n        auditDataCriteria: model.auditDataCriteria,\n        associatedAuditFieldsByAssociationName: model.associatedAuditFieldsByAssociationName\n      },\n      auditSourceRecordDefinitionName: model.auditSourceRecordDefinitionName,\n      fieldDefinitions: model.fields.map((fieldModel: IRecordFieldDefinitionModel) => {\n        const field: IFieldDefinition = {\n          resourceType: fieldModel.resourceType,\n          lastUpdateTime: fieldModel.lastUpdateTime,\n          lastChangedBy: fieldModel.lastChangedBy,\n          owner: fieldModel.owner,\n          name: fieldModel.name,\n          tags: fieldModel.tags,\n          description: fieldModel.description,\n          overlayGroupId: fieldModel.overlayGroupId,\n          id: isNumber(fieldModel.id) ? fieldModel.id : '',\n          fieldOption: fieldModel.fieldOption,\n          permissions: fieldModel.permissions,\n          fieldTypeName: fieldModel.fieldTypeName,\n          isInherited: fieldModel.isInherited,\n          explicitPermissions: fieldModel.explicitPermissions,\n          overlayDescriptor: fieldModel.overlayDescriptor,\n          fieldMapping: fieldModel.fieldMapping,\n          allowPermissionsOverlay: fieldModel.allowPermissionsOverlay,\n          allowOtherPropertiesOverlay: fieldModel.allowOtherPropertiesOverlay,\n          auditOption: fieldModel.audit ? 'AUDIT_AND_COPY' : fieldModel.copy ? 'COPY' : null,\n          allowPermissionsEdit: fieldModel.allowPermissionsEdit,\n          maxLength: fieldModel.maxLength,\n          searchDefinition: fieldModel.searchDefinition,\n          namedListDefinition: fieldModel.namedListDefinition,\n          shouldPersistEncrypted: fieldModel.shouldPersistEncrypted,\n          shouldPersistHashed: fieldModel.shouldPersistHashed,\n          pattern: fieldModel.pattern,\n          anyUserAllowedToSubmit: fieldModel.anyUserAllowedToSubmit\n        };\n\n        if (fieldModel.resourceType === RX_RECORD_DEFINITION.dataTypes.localizedCharacter.resourceType) {\n          field.defaultValueByLocale = fieldModel.defaultValueByLocale;\n        } else if (fieldModel.resourceType === RX_RECORD_DEFINITION.dataTypes.selection.resourceType) {\n          field.defaultValue = fieldModel.selectionFieldOptionProperties.defaultValue as unknown as string;\n          field.optionNamesById = fieldModel.selectionFieldOptionProperties?.optionNamesById;\n          field.optionLabelsById = fieldModel.selectionFieldOptionProperties?.optionLabelsById;\n        } else if (fieldModel.resourceType !== RX_RECORD_DEFINITION.dataTypes.attachment.resourceType) {\n          field.defaultValue = fieldModel.defaultValue;\n        }\n\n        return field;\n      })\n      // TODO-VM: update when new custom component in inspector config is implemented\n    };\n  }\n\n  getDefinitionModelFromDefinition(recordDefinition: IRecordDefinition): IRecordDefinitionModel {\n    return {\n      allowNonAdminToDeleteRecordInstances: recordDefinition.allowNonAdminToDeleteRecordInstances,\n      isArchivingEnabled: recordDefinition.archiveDescriptor?.isEnabled,\n      ageQualifierFieldId: recordDefinition.archiveDescriptor?.ageQualifierFieldId,\n      ageQualifierInDays: recordDefinition.archiveDescriptor?.ageQualifierInDays,\n      archiveRecordDefinitionName: recordDefinition.archiveDescriptor?.archiveRecordDefinitionName,\n      archiveDescription: recordDefinition.archiveDescriptor?.description,\n      archiveType: recordDefinition.archiveDescriptor?.archiveType,\n      includeAttachments: recordDefinition.archiveDescriptor?.includeAttachments,\n      archiveDataCriteria: recordDefinition.archiveDescriptor?.archiveDataCriteria,\n      associationsToFollowForArchive: {\n        specificAssociationNames: recordDefinition.associationsToFollowForArchive?.specificAssociationNames || [],\n        selectionType:\n          recordDefinition.associationsToFollowForArchive?.selectionType || AssociationSelectionType.FollowParent\n      },\n      isAuditingEnabled: recordDefinition.auditDescriptor?.isEnabled,\n      auditRecordDefinitionName: recordDefinition.auditDescriptor?.auditRecordDefinitionName,\n      auditDataCriteria: recordDefinition.auditDescriptor?.auditDataCriteria,\n      associatedAuditFieldsByAssociationName: recordDefinition.auditDescriptor?.associatedAuditFieldsByAssociationName,\n      auditSourceRecordDefinitionName: recordDefinition.auditSourceRecordDefinitionName,\n      customizationOptions: {\n        allowFieldsOverlay: recordDefinition.allowFieldsOverlay,\n        allowIndexesOverlay: recordDefinition.allowIndexesOverlay,\n        allowOtherPropertiesOverlay: recordDefinition.allowOtherPropertiesOverlay,\n        allowPermissionsOverlay: recordDefinition.allowPermissionsOverlay,\n        allowOverlay: false,\n        fields: recordDefinition.fieldDefinitions as IRecordFieldDefinitionModel[],\n        scope: recordDefinition.scope\n      },\n      description: recordDefinition.description,\n      displayFieldIdInAssociation: recordDefinition.displayFieldIdInAssociation,\n      enableCognitiveSearch: recordDefinition.enableCognitiveSearch,\n      fullPermissions: recordDefinition.fullPermissions,\n      guid: recordDefinition.guid || this.rxGuidService.generate(),\n      indexDefinitions: recordDefinition.indexDefinitions?.map((indexDefinition) => ({\n        ...indexDefinition,\n        isAutomaticIndex: this.rxRecordDefinitionService.isAutomaticIndex(indexDefinition)\n      })),\n      isAuditRecordDefinition: recordDefinition.isAuditRecordDefinition,\n      joinCriteria: this.getJoinCriteriaExpression(\n        recordDefinition.joinCriteria,\n        recordDefinition.primaryRecordDefinitionName,\n        recordDefinition.secondaryRecordDefinitionName\n      ),\n      joinType: recordDefinition.joinType,\n      lastUpdateTime: recordDefinition.lastUpdateTime\n        ? this.rxDateUtilService.formatDate(recordDefinition.lastUpdateTime, 'medium')\n        : recordDefinition.lastUpdateTime,\n      lastChangedBy: recordDefinition.lastChangedBy,\n      localizableStringsByFieldId: recordDefinition.localizableStringsByFieldId,\n      name: this.rxDefinitionNameService.getDisplayName(recordDefinition.name),\n      overlayDescriptor: recordDefinition.overlayDescriptor,\n      overlayGroupId: recordDefinition.overlayGroupId,\n      overlayOperation: this.rxOverlayService.getOverlayOperation(\n        recordDefinition.overlayGroupId,\n        recordDefinition.overlayDescriptor ? recordDefinition.overlayDescriptor.parentOverlayGroupId : null\n      ),\n      owner: recordDefinition.owner,\n      permissions: recordDefinition.permissions,\n      primaryRecordDefinitionName: recordDefinition.primaryRecordDefinitionName,\n      secondaryRecordDefinitionName: recordDefinition.secondaryRecordDefinitionName,\n      recordInheritanceSelector: {\n        inheritanceDescriptor: recordDefinition.inheritanceDescriptor,\n        inheritanceOptions: {\n          isAbstract: recordDefinition.isAbstract,\n          isSharedInstanceStorage: recordDefinition.isSharedInstanceStorage,\n          isFinal: recordDefinition.isFinal\n        },\n        isInheritingCoreFields: null,\n        inheritedFieldDefinitions: []\n      },\n      recordSearchFields: recordDefinition.fieldDefinitions.filter(\n        (field) => field.searchDefinition\n      ) as IRecordFieldDefinitionModel[],\n      recordInstancePrefix: recordDefinition.recordInstancePrefix,\n      recordTypeName: recordDefinition.recordTypeName,\n      resourceType: recordDefinition.resourceType,\n      rowSecurityPropagations: recordDefinition.rowSecurityPropagations,\n      securityLabels: recordDefinition.securityLabels,\n      shouldExportData: recordDefinition.shouldExportData,\n      tags: recordDefinition.tags,\n      upgradeVersion: recordDefinition.upgradeVersion,\n      version: recordDefinition.version,\n      weightedRelevancyTitle: recordDefinition.weightedRelevancyFields?.TITLE,\n      weightedRelevancyEnvironment: recordDefinition.weightedRelevancyFields?.ENVIRONMENT,\n      weightedRelevancyKeywords: recordDefinition.weightedRelevancyFields?.KEYWORDS,\n      fields: recordDefinition.fieldDefinitions.map((fieldDefinition: IFieldDefinition) => ({\n        allowOtherPropertiesOverlay: fieldDefinition.allowOtherPropertiesOverlay,\n        allowPermissionsEdit: fieldDefinition.allowPermissionsEdit,\n        allowPermissionsOverlay: fieldDefinition.allowPermissionsOverlay,\n        anyUserAllowedToSubmit: fieldDefinition.anyUserAllowedToSubmit,\n        audit: fieldDefinition.auditOption === 'AUDIT_AND_COPY',\n        copy: fieldDefinition.auditOption === 'AUDIT_AND_COPY' || fieldDefinition.auditOption === 'COPY',\n        defaultValue: fieldDefinition.defaultValue,\n        defaultValueByLocale: fieldDefinition.defaultValueByLocale,\n        description: fieldDefinition.description,\n        explicitPermissions: fieldDefinition.explicitPermissions,\n        fieldMapping: fieldDefinition.fieldMapping,\n        fieldOption: fieldDefinition.fieldOption,\n        fieldTypeName: fieldDefinition.fieldTypeName,\n        guid: this.rxGuidService.generate(),\n        id: isNumber(fieldDefinition.id) ? fieldDefinition.id : fieldDefinition.customId || '',\n        isCoreField: this.rxFieldDefinitionService.isCoreField(fieldDefinition),\n        isInherited: fieldDefinition.isInherited,\n        isNewField: false,\n        lastChangedBy: fieldDefinition.lastChangedBy,\n        lastUpdateTime: fieldDefinition.lastUpdateTime,\n        maxLength: fieldDefinition.maxLength,\n        maxSize: fieldDefinition.maxSize,\n        maxValue: fieldDefinition.maxValue,\n        minValue: fieldDefinition.minValue,\n        name: fieldDefinition.name,\n        overlayDescriptor: fieldDefinition.overlayDescriptor,\n        overlayGroupId: fieldDefinition.overlayGroupId,\n        owner: fieldDefinition.owner,\n        permissions: fieldDefinition.permissions,\n        precision: fieldDefinition.precision,\n        resourceType: fieldDefinition.resourceType,\n        searchDefinition: fieldDefinition.searchDefinition,\n        selectionFieldOptionProperties: {\n          defaultValue: fieldDefinition.defaultValue as unknown as number,\n          optionNamesById: fieldDefinition.optionNamesById,\n          optionLabelsById: fieldDefinition.optionLabelsById\n        },\n        shouldPersistEncrypted: fieldDefinition.shouldPersistEncrypted,\n        shouldPersistHashed: fieldDefinition.shouldPersistHashed,\n        namedListDefinition: fieldDefinition.namedListDefinition,\n        pattern: fieldDefinition.pattern,\n        tags: fieldDefinition.tags\n      }))\n    };\n  }\n}\n"]}