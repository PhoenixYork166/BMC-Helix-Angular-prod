{"version":3,"file":"permissions-policy-header.component.js","sourceRoot":"","sources":["../../../../../../../libs/platform/admin/components/permissions-policy-header/permissions-policy-header.component.ts","../../../../../../../libs/platform/admin/components/permissions-policy-header/permissions-policy-header.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAU,SAAS,EAAE,MAAM,eAAe,CAAC;AAC7D,OAAO,EAAE,OAAO,EAAE,MAAM,gBAAgB,CAAC;AAEzC,OAAO,EAAE,qBAAqB,EAAE,4BAA4B,EAAE,MAAM,4BAA4B,CAAC;AACjG,OAAO,EAAE,iBAAiB,EAAE,MAAM,8BAA8B,CAAC;AACjE,OAAO,EAAE,gBAAgB,EAAE,MAAM,qBAAqB,CAAC;;;;;;;AAMvD,MAAM,OAAO,qCAAsC,SAAQ,iBAAiB;IAU1E,YACU,qBAA4C,EAC5C,gBAAkC,EAClC,4BAA0D;QAElE,KAAK,EAAE,CAAC;QAJA,0BAAqB,GAArB,qBAAqB,CAAuB;QAC5C,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,iCAA4B,GAA5B,4BAA4B,CAA8B;QAT5D,gBAAW,GAAG,mBAAmB,CAAC;QAE1C,4BAAuB,GAAG,EAAE,CAAC;QAC7B,cAAS,GAAG,+FAA+F,CAAC;IAS5G,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,qBAAqB,CAAC,KAAK,EAAE;YAChC,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,OAAO,EAAE;SAC9B,CAAC,CAAC;QAEH,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,4BAA4B,CAAC,gBAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,SAAS,CAAC,CAAC,YAAY,EAAE,EAAE;YAC1G,IAAI,CAAC,uBAAuB,GAAG,YAAY,CAAC,KAAe,CAAC;QAC9D,CAAC,CAAC,CAAC;IACL,CAAC;IAED,OAAO;;QACL,OAAO,MAAA,IAAI,CAAC,2BAA2B,0CAAE,KAAK,CAAC;IACjD,CAAC;IAED,WAAW;QACT,IAAI,CAAC,4BAA4B,CAAC,gBAAgB,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,uBAAuB,CAAC,CAAC,SAAS,CAAC,GAAG,EAAE;YAChH,IAAI,CAAC,qBAAqB,CAAC,iBAAiB,CAC1C,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,sDAAsD,CAAC,CACtF,CAAC;YAEF,IAAI,CAAC,2BAA2B,CAAC,OAAO,CAAC,cAAc,EAAE,CAAC;QAC5D,CAAC,CAAC,CAAC;IACL,CAAC;;kIAxCU,qCAAqC;sHAArC,qCAAqC,0LACE,OAAO,kECZ3D,uvCAsCA;2FD3Ba,qCAAqC;kBAJjD,SAAS;mBAAC;oBACT,QAAQ,EAAE,6BAA6B;oBACvC,WAAW,EAAE,4CAA4C;iBAC1D;sLAGC,2BAA2B;sBAD1B,SAAS;uBAAC,6BAA6B,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE","sourcesContent":["import { Component, OnInit, ViewChild } from '@angular/core';\nimport { NgModel } from '@angular/forms';\nimport { Subscription } from 'rxjs';\nimport { RxNotificationService, RxSystemConfigurationService } from '@helix/platform/shared/api';\nimport { BaseViewComponent } from '@helix/platform/view/runtime';\nimport { TranslateService } from '@ngx-translate/core';\n\n@Component({\n  selector: 'rx-admin-permissions-policy',\n  templateUrl: './permissions-policy-header.component.html'\n})\nexport class PermissionsPolicyHeaderAdminComponent extends BaseViewComponent implements OnInit {\n  @ViewChild('permissionPolicyHeaderModel', { read: NgModel, static: true })\n  permissionPolicyHeaderModel: NgModel;\n\n  private settingName = 'permissionsPolicy';\n\n  permissionsPolicyHeader = '';\n  syntaxUrl = 'https://github.com/w3c/webappsec-permissions-policy/blob/main/permissions-policy-explainer.md';\n  busy: Subscription;\n\n  constructor(\n    private rxNotificationService: RxNotificationService,\n    private translateService: TranslateService,\n    private rxSystemConfigurationService: RxSystemConfigurationService\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {\n    this.notifyPropertyChanged('api', {\n      isDirty: () => this.isDirty()\n    });\n\n    this.busy = this.rxSystemConfigurationService.getConfiguration(this.settingName).subscribe((settingsData) => {\n      this.permissionsPolicyHeader = settingsData.value as string;\n    });\n  }\n\n  isDirty(): boolean {\n    return this.permissionPolicyHeaderModel?.dirty;\n  }\n\n  onSaveClick(): void {\n    this.rxSystemConfigurationService.setConfiguration(this.settingName, this.permissionsPolicyHeader).subscribe(() => {\n      this.rxNotificationService.addSuccessMessage(\n        this.translateService.instant('com.bmc.arsys.rx.client.admin.settings-saved.message')\n      );\n\n      this.permissionPolicyHeaderModel.control.markAsPristine();\n    });\n  }\n}\n","<rx-admin-settings\n  header=\"{{ 'com.bmc.arsys.rx.client.admin.permissions-policy-header.header.title' | translate }}\"\n  [busy]=\"busy\"\n>\n  <adapt-rx-textfield\n    [label]=\"'com.bmc.arsys.rx.client.admin.permissions-policy-header.label' | translate\"\n    [(ngModel)]=\"permissionsPolicyHeader\"\n    rx-id=\"permission-policy-header\"\n    name=\"permissionPolicyHeaderModel\"\n    class=\"form-group d-block\"\n    #permissionPolicyHeaderModel=\"ngModel\"\n    [autofocus]=\"true\"\n    [tooltip]=\"{\n      iconName: 'question_circle_o',\n      content: popover,\n      placement: 'right',\n      popoverMode: true,\n      maxWidth: 400\n    }\"\n  ></adapt-rx-textfield>\n\n  <button\n    class=\"align-self-start\"\n    rx-id=\"save-button\"\n    adapt-button\n    btn-type=\"primary\"\n    type=\"button\"\n    [disabled]=\"!permissionsPolicyHeader || !isDirty()\"\n    (click)=\"onSaveClick()\"\n  >\n    {{ 'com.bmc.arsys.rx.client.common.save.label' | translate }}\n  </button>\n\n  <ng-template #popover>\n    {{ 'com.bmc.arsys.rx.client.admin.permissions-policy-header.syntax-information.message' | translate }}\n    <a class=\"text-secondary\" target=\"_blank\" href=\"{{ syntaxUrl }}\">{{ syntaxUrl }}</a>\n  </ng-template>\n</rx-admin-settings>\n"]}