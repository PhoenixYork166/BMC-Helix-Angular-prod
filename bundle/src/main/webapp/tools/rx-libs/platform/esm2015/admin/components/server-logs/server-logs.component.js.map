{"version":3,"file":"server-logs.component.js","sourceRoot":"","sources":["../../../../../../../libs/platform/admin/components/server-logs/server-logs.component.ts","../../../../../../../libs/platform/admin/components/server-logs/server-logs.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, HostBinding, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup } from '@angular/forms';\nimport { RxServerLogsService } from './server-logs.service';\nimport { IServerLogsConfig } from './server-logs.types';\nimport { RxNotificationService, RxServerErrorHandlerService } from '@helix/platform/shared/api';\nimport { RX_SERVER_LOGS } from './server-logs.constant';\nimport { Subscription } from 'rxjs';\nimport { BaseViewComponent } from '@helix/platform/view/runtime';\nimport { RxFileService } from '@helix/platform/utils';\n\n@Component({\n  selector: 'rx-admin-server-logs',\n  templateUrl: './server-logs.component.html',\n  styleUrls: ['./server-logs.component.scss']\n})\nexport class ServerLogsAdminComponent extends BaseViewComponent implements OnInit {\n  @HostBinding('class')\n  hostClass = 'd-block col-md-9 p-0';\n\n  constructor(\n    private formBuilder: FormBuilder,\n    private rxNotificationService: RxNotificationService,\n    private rxServerErrorHandlerService: RxServerErrorHandlerService,\n    private rxServerLogsService: RxServerLogsService\n  ) {\n    super();\n  }\n\n  busy: Subscription;\n  serverLogsForm: FormGroup;\n  shouldDisplayAdditionalLogTypes: boolean;\n  isDownloadInProgress: boolean;\n\n  private getServerLogsConfig() {\n    this.busy = this.rxServerLogsService.getConfig().subscribe((serverLogsConfig: IServerLogsConfig) => {\n      this.serverLogsForm.patchValue(serverLogsConfig);\n    });\n  }\n\n  toggleAdditionalLogTypes() {\n    this.shouldDisplayAdditionalLogTypes = !this.shouldDisplayAdditionalLogTypes;\n  }\n\n  save() {\n    const formValue = this.serverLogsForm.getRawValue();\n\n    this.rxServerLogsService.save(formValue).subscribe(() => {\n      this.rxNotificationService.addSuccessMessage('Server Logs configuration saved successfully.');\n      this.serverLogsForm.markAsPristine();\n    });\n  }\n\n  downloadLogs() {\n    this.isDownloadInProgress = true;\n\n    this.rxServerLogsService\n      .downloadServerLogs({\n        fileNames: ['server', 'License']\n      })\n      .subscribe(\n        (data) => {\n          RxFileService.saveFile(data);\n          this.isDownloadInProgress = false;\n        },\n        (error) => {\n          error.data = JSON.parse(String.fromCharCode.apply(null, new Uint8Array(error.error)));\n          this.rxServerErrorHandlerService.handle(error);\n          this.isDownloadInProgress = false;\n        }\n      );\n  }\n\n  get autoTurnOffDuration() {\n    return this.serverLogsForm.get('autoTurnOffDuration').value;\n  }\n\n  ngOnInit() {\n    this.notifyPropertyChanged('api', {\n      isDirty: () => this.serverLogsForm.dirty\n    });\n\n    this.serverLogsForm = this.formBuilder.group(RX_SERVER_LOGS.defaultFormConfig);\n\n    this.getServerLogsConfig();\n  }\n}\n","<rx-admin-settings header=\"{{ 'com.bmc.arsys.rx.client.admin.server-logs.header.title' | translate }}\" [busy]=\"busy\">\n  <form [formGroup]=\"serverLogsForm\">\n    <div>\n      <h6 class=\"dt\">{{ 'com.bmc.arsys.rx.client.admin.server-logs.capture-logs.title' | translate }}</h6>\n      <div class=\"d-flex p-0 logs-duration\" rx-id=\"logs-duration\">\n        <adapt-rx-counter\n          formControlName=\"autoTurnOffDuration\"\n          min=\"1\"\n          adaptIntegerNumber\n        >\n        </adapt-rx-counter>\n        <span class=\"p-2\">{{ 'com.bmc.arsys.rx.client.admin.server-logs.minutes.label' | translate }}</span>\n      </div>\n      <div *ngIf=\"autoTurnOffDuration < 1\" class=\"adapt-mt-error\">\n        {{ 'com.bmc.arsys.rx.client.admin.server-logs.minimum-of-one-minute.label' | translate }}\n      </div>\n    </div>\n\n    <div>\n      <h6 class=\"dt\">{{ 'com.bmc.arsys.rx.client.admin.server-logs.log-types-to-be-captured.title' | translate }}</h6>\n      <adapt-rx-checkbox\n        formControlName=\"ruleLogOn\"\n        label=\"{{ 'com.bmc.arsys.rx.client.admin.server-logs.rule.label' | translate }}\"\n      ></adapt-rx-checkbox>\n      <adapt-rx-checkbox\n        formControlName=\"timedRuleLogOn\"\n        label=\"{{ 'com.bmc.arsys.rx.client.admin.server-logs.escalation.label' | translate }}\"\n      ></adapt-rx-checkbox>\n      <adapt-rx-checkbox\n        formControlName=\"processLogOn\"\n        label=\"{{ 'com.bmc.arsys.rx.client.admin.server-logs.process.label' | translate }}\"\n      ></adapt-rx-checkbox>\n    </div>\n\n    <div rx-id=\"show-additional-log\" (click)=\"toggleAdditionalLogTypes()\" class=\"btn-link alert-link pt-2\">\n      {{\n        (shouldDisplayAdditionalLogTypes\n          ? 'com.bmc.arsys.rx.client.admin.server-logs.show-less.label'\n          : 'com.bmc.arsys.rx.client.admin.server-logs.show-more.label'\n        ) | translate\n      }}\n    </div>\n\n    <div *ngIf=\"shouldDisplayAdditionalLogTypes\">\n      <h6 class=\"dt\">\n        {{ 'com.bmc.arsys.rx.client.admin.server-logs.additional-log-types-to-be-captured.title' | translate }}\n      </h6>\n      <adapt-rx-checkbox\n        formControlName=\"sqlLogOn\"\n        label=\"{{ 'com.bmc.arsys.rx.client.admin.server-logs.sql.label' | translate }}\"\n      ></adapt-rx-checkbox>\n      <adapt-rx-checkbox\n        formControlName=\"apiLogOn\"\n        label=\"{{ 'com.bmc.arsys.rx.client.admin.server-logs.api.label' | translate }}\"\n      ></adapt-rx-checkbox>\n    </div>\n\n    <div class=\"mt-4 d-flex\">\n      <button\n        type=\"submit\"\n        adapt-button\n        btn-type=\"primary\"\n        [disabled]=\"serverLogsForm.pristine || autoTurnOffDuration < 1\"\n        (click)=\"save()\"\n        rx-id=\"save-button\"\n        class=\"mr-3\"\n      >\n        {{ 'com.bmc.arsys.rx.client.common.save.label' | translate }}\n      </button>\n\n      <button\n        type=\"button\"\n        adapt-button\n        btn-type=\"secondary\"\n        [adaptInlineLoader]=\"isDownloadInProgress\"\n        activeText=\"Downloading...\"\n        (click)=\"downloadLogs()\"\n        rx-id=\"download-button\"\n      >\n        {{ 'com.bmc.arsys.rx.client.admin.server-logs.download-logs.label' | translate }}\n      </button>\n    </div>\n  </form>\n</rx-admin-settings>\n"]}