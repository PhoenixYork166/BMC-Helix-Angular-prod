{"version":3,"file":"rename-definition-modal.component.js","sourceRoot":"","sources":["../../../../../../../libs/platform/shared/components/rename-definition-modal/rename-definition-modal.component.ts","../../../../../../../libs/platform/shared/components/rename-definition-modal/rename-definition-modal.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, Injector, OnInit, ViewChild } from '@angular/core';\nimport { ActiveModalRef, DismissReasons } from '@bmc-ux/adapt-angular';\nimport { AbstractControl, NgForm, ValidationErrors } from '@angular/forms';\nimport { RX_RECORD_DEFINITION } from '@helix/platform/record/api';\nimport { IPlainObject, RxDefinitionNameService } from '@helix/platform/shared/api';\nimport { RxModalClass } from '@helix/platform/ui-kit';\n\n@Component({\n  selector: 'rx-rename-definition-modal',\n  templateUrl: './rename-definition-modal.component.html'\n})\nexport class RenameDefinitionModalComponent extends RxModalClass implements OnInit {\n  modalData: IPlainObject;\n  bundleId: string;\n  definitionDisplayName: string;\n  oldDefinitionDisplayName: string;\n  definitionNames: string[];\n\n  @ViewChild('renameDefinitionModalForm', { static: true, read: NgForm })\n  renameDefinitionModalForm: NgForm;\n\n  constructor(\n    protected injector: Injector,\n    private activeModalRef: ActiveModalRef,\n    private rxDefinitionNameService: RxDefinitionNameService\n  ) {\n    super(activeModalRef, injector);\n    this.modalData = this.activeModalRef.getData();\n  }\n\n  ngOnInit() {\n    super.ngOnInit();\n\n    this.bundleId = this.rxDefinitionNameService.getBundleId(this.modalData.definitionName);\n    this.definitionDisplayName = this.rxDefinitionNameService.getDisplayName(this.modalData.definitionName);\n    this.oldDefinitionDisplayName = this.rxDefinitionNameService.getDisplayName(this.modalData.definitionName);\n\n    this.definitionNames = this.modalData.definitionNames\n      .map((definitionName) => this.rxDefinitionNameService.getDisplayName(definitionName))\n      .filter((definitionName) => definitionName !== this.definitionDisplayName);\n  }\n\n  isDirty(): boolean {\n    return this.renameDefinitionModalForm.form.dirty;\n  }\n\n  getCorrectDefinitionNameValidator(): (control: AbstractControl) => ValidationErrors | null {\n    return (control: AbstractControl) => {\n      let result = null;\n\n      if (control.value && !RX_RECORD_DEFINITION.validDefinitionNameRegex.test(control.value)) {\n        result = { invalidDefinitionName: { message: this.modalData.validationErrorText } };\n      }\n\n      return result;\n    };\n  }\n\n  onCancelClick() {\n    this.activeModalRef.dismiss(DismissReasons.CLOSE_BTN);\n  }\n\n  onSaveClick() {\n    if (this.bundleId) {\n      this.activeModalRef.close(\n        this.rxDefinitionNameService.getDefinitionName(this.bundleId, this.definitionDisplayName)\n      );\n    } else {\n      this.activeModalRef.close(this.definitionDisplayName);\n    }\n  }\n}\n","<div class=\"modal-body\">\n  <adapt-alert\n    *ngIf=\"modalData.infoText\"\n    [config]=\"{ title: modalData.infoText, type: 'inline', variant: 'warning' }\"\n  ></adapt-alert>\n\n  <form #renameDefinitionModalForm=\"ngForm\">\n    <adapt-rx-textfield\n      name=\"definitionDisplayName\"\n      [(ngModel)]=\"definitionDisplayName\"\n      [label]=\"modalData.fieldLabel\"\n      [rxCustomValidators]=\"getCorrectDefinitionNameValidator()\"\n      [maxlength]=\"modalData.maxLength || null\"\n      [rxUnique]=\"{\n        errorMessage:\n          'com.bmc.arsys.rx.client.rename-definition-modal.definition-already-exists.message'\n          | translate: { definitionType: modalData.definitionType },\n        items: definitionNames\n      }\"\n      adaptRequired\n      [autofocus]=\"modalData.autoFocus !== false\"\n    ></adapt-rx-textfield>\n  </form>\n</div>\n\n<div class=\"modal-footer\">\n  <button\n    rx-id=\"save-button\"\n    adapt-button\n    btn-type=\"primary\"\n    type=\"button\"\n    [disabled]=\"\n      !renameDefinitionModalForm.form.dirty ||\n      !renameDefinitionModalForm.form.valid ||\n      oldDefinitionDisplayName === definitionDisplayName\n    \"\n    (click)=\"onSaveClick()\"\n  >\n    {{ 'com.bmc.arsys.rx.client.common.save.label' | translate }}\n  </button>\n\n  <button rx-id=\"cancel-button\" adapt-button btn-type=\"secondary\" type=\"button\" (click)=\"onCancelClick()\">\n    {{ 'com.bmc.arsys.rx.client.common.cancel.label' | translate }}\n  </button>\n</div>\n"]}