{"version":3,"file":"rule-reassignment.component.js","sourceRoot":"","sources":["../../../../../../../../libs/platform/admin/components/rule-pool-management/rule-reassignment/rule-reassignment.component.ts","../../../../../../../../libs/platform/admin/components/rule-pool-management/rule-reassignment/rule-reassignment.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, Injector, OnDestroy, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { TranslateService } from '@ngx-translate/core';\nimport { ReplaySubject, Observable } from 'rxjs';\nimport { finalize, takeUntil, take } from 'rxjs/operators';\nimport { ActiveModalRef, DismissReasons, RxSelectOption } from '@bmc-ux/adapt-angular';\nimport { RxNotificationService } from '@helix/platform/shared/api';\nimport { RxModalClass } from '@helix/platform/ui-kit';\nimport { RxRuleDefinitionService } from '@helix/platform/rule/api';\nimport { RxRulePoolManagementService } from '../rule-pool-management.service';\n\n@Component({\n  selector: 'rx-rule-reassignment',\n  templateUrl: './rule-reassignment.component.html'\n})\nexport class RuleReassignmentComponent extends RxModalClass implements OnInit, OnDestroy {\n  isSaveButtonDisabled = true;\n  poolFormControl = new FormControl([]);\n  poolSelectOptions$: Observable<RxSelectOption[]>;\n\n  private destroyed$ = new ReplaySubject<boolean>(1);\n  private selectedPoolId: number;\n\n  constructor(\n    private activeModalRef: ActiveModalRef,\n    private rxNotificationService: RxNotificationService,\n    private rxRuleDefinitionService: RxRuleDefinitionService,\n    private rxRulePoolManagementService: RxRulePoolManagementService,\n    private translateService: TranslateService,\n    protected injector: Injector\n  ) {\n    super(activeModalRef, injector);\n\n    this.poolFormControl.valueChanges.pipe(takeUntil(this.destroyed$)).subscribe((selectedPools: RxSelectOption[]) => {\n      this.selectedPoolId = selectedPools[0].id;\n      this.isSaveButtonDisabled = false;\n    });\n  }\n\n  ngOnInit(): void {\n    super.ngOnInit();\n\n    this.poolSelectOptions$ = this.rxRulePoolManagementService.getAvailablePoolOptions();\n  }\n\n  optionFormatter(selectOption: RxSelectOption): string {\n    return selectOption.name;\n  }\n\n  save(): void {\n    this.allowDismiss = false;\n    this.isSaveButtonDisabled = true;\n\n    this.rxRulePoolManagementService\n      .reassignRuleToPool(this.activeModalRef.getData().ruleName, this.selectedPoolId)\n      .pipe(\n        take(1),\n        finalize(() => {\n          this.allowDismiss = true;\n          this.isSaveButtonDisabled = false;\n        })\n      )\n      .subscribe(() => {\n        this.rxNotificationService.addSuccessMessage(\n          this.translateService.instant('com.bmc.arsys.rx.client.admin.rule-pool-management.reassignment-saved.message')\n        );\n\n        this.activeModalRef.close(true);\n      });\n  }\n\n  cancel(): void {\n    this.activeModalRef.dismiss(DismissReasons.CLOSE_BTN);\n  }\n\n  ngOnDestroy(): void {\n    this.destroyed$.next(true);\n    this.destroyed$.complete();\n  }\n}\n","<div class=\"modal-header\">\n  <h5 class=\"modal-title\">\n    {{ 'com.bmc.arsys.rx.client.admin.rule-pool-management.reassignment-dialog.title' | translate }}\n  </h5>\n  <button\n    class=\"close dp-close\"\n    type=\"button\"\n    rx-id=\"x-button\"\n    [disabled]=\"!allowDismiss\"\n    (click)=\"cancel()\"\n  ></button>\n</div>\n\n<div class=\"modal-body\">\n  <adapt-rx-select\n    [formControl]=\"poolFormControl\"\n    [options]=\"poolSelectOptions$ | async\"\n    [optionFormatter]=\"optionFormatter\"\n    [label]=\"'com.bmc.arsys.rx.client.admin.rule-pool-management.assign-to.label' | translate\"\n  ></adapt-rx-select>\n</div>\n\n<div class=\"modal-footer\">\n  <button\n    adapt-button\n    btn-type=\"primary\"\n    type=\"button\"\n    rx-id=\"save-button\"\n    (click)=\"save()\"\n    [adaptInlineLoader]=\"!allowDismiss\"\n    [disabled]=\"isSaveButtonDisabled || !allowDismiss\"\n  >\n    {{ 'com.bmc.arsys.rx.client.common.save.label' | translate }}\n  </button>\n  <button\n    adapt-button\n    btn-type=\"secondary\"\n    type=\"button\"\n    rx-id=\"cancel-button\"\n    (click)=\"cancel()\"\n    [disabled]=\"!allowDismiss\"\n  >\n    {{ 'com.bmc.arsys.rx.client.common.cancel.label' | translate }}\n  </button>\n</div>\n"]}