{"version":3,"file":"document-tone-analysis.component.js","sourceRoot":"","sources":["../../../../../../../../libs/platform/admin/components/tone-analysis-testing/document-tone-analysis/document-tone-analysis.component.ts","../../../../../../../../libs/platform/admin/components/tone-analysis-testing/document-tone-analysis/document-tone-analysis.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, ViewChild } from '@angular/core';\nimport { NgForm } from '@angular/forms';\nimport { RxSelectOption } from '@bmc-ux/adapt-angular';\nimport { RxCommandFactoryService } from '@helix/platform/shared/api';\nimport { get, isNil, toNumber } from 'lodash';\nimport { RX_TONE_ANALYSIS_TESTING } from '../tone-analysis-testing.constant';\nimport { IDocumentTone } from '../tone-analysis-testing.interfaces';\nimport { RxSystemConfigurationService } from '@helix/platform/shared/api';\nimport { finalize } from 'rxjs/operators';\n\n@Component({\n  selector: 'rx-document-tone-analysis',\n  templateUrl: './document-tone-analysis.component.html',\n  styleUrls: ['./document-tone-analysis.component.scss']\n})\nexport class DocumentToneAnalysisComponent implements OnInit {\n  languageOptions: RxSelectOption[] = RX_TONE_ANALYSIS_TESTING.languageOptions;\n  language: RxSelectOption = [];\n  documentText: string[];\n  toneScoreThreshold: number;\n  defaultToneScoreThreshold = 0.5;\n  containsHtml: boolean;\n  includeSentenceLevelAnalysis: boolean;\n  extractedToneData: IDocumentTone;\n\n  @ViewChild('documentToneAnalysisForm', { static: true, read: NgForm })\n  documentToneAnalysisForm: NgForm;\n\n  constructor(\n    private rxCommandFactoryService: RxCommandFactoryService,\n    private rxSystemConfigurationService: RxSystemConfigurationService\n  ) {}\n\n  ngOnInit(): void {\n    this.rxSystemConfigurationService\n      .getConfiguration(RX_TONE_ANALYSIS_TESTING.systemSettingKeys.toneScoreThreshold)\n      .pipe(finalize(() => this.reset()))\n      .subscribe((data) => {\n        this.defaultToneScoreThreshold = data.value ? toNumber(data.value) : 0.5;\n      });\n  }\n\n  clearDocumentText() {\n    this.documentText = null;\n  }\n\n  optionFormatter(option: RxSelectOption): string {\n    return option.name;\n  }\n\n  setDefaultThreshold(): void {\n    this.toneScoreThreshold = this.defaultToneScoreThreshold;\n  }\n\n  analyzeTone(): void {\n    this.rxCommandFactoryService\n      .forResourceType(RX_TONE_ANALYSIS_TESTING.documentEngagementResourceType)\n      .execute({\n        resourceType: RX_TONE_ANALYSIS_TESTING.documentEngagementResourceType,\n        language: get(this.language[0], 'id'),\n        text: this.documentText,\n        containsHTML: this.containsHtml,\n        sentenceLevelAnalysis: this.includeSentenceLevelAnalysis,\n        toneScoreThreshold: this.toneScoreThreshold\n      })\n      .subscribe((response) => {\n        this.extractedToneData = response;\n      });\n  }\n\n  reset(): void {\n    this.language = [RX_TONE_ANALYSIS_TESTING.languageOptions[0]];\n    this.documentText = null;\n    this.toneScoreThreshold = this.defaultToneScoreThreshold;\n    this.containsHtml = false;\n    this.includeSentenceLevelAnalysis = false;\n    this.extractedToneData = null;\n    this.documentToneAnalysisForm.form.markAsPristine();\n  }\n\n  isAnalyzeToneButtonDisabled(): boolean {\n    return this.documentToneAnalysisForm.pristine || this.documentToneAnalysisForm.invalid;\n  }\n\n  isResetButtonDisabled(): boolean {\n    return this.documentToneAnalysisForm.pristine && isNil(this.documentText);\n  }\n}\n","<form #documentToneAnalysisForm=\"ngForm\">\n  <div class=\"row mb-4\">\n    <div class=\"col-md-3\">\n      <adapt-rx-select\n        rx-id=\"language\"\n        name=\"language\"\n        [(ngModel)]=\"language\"\n        label=\"{{ 'com.bmc.arsys.rx.client.admin.tone-analysis-testing.language.label' | translate }}\"\n        [options]=\"languageOptions\"\n        [optionFormatter]=\"optionFormatter\"\n      ></adapt-rx-select>\n    </div>\n\n    <div class=\"col-md-3 contains-html\">\n      <adapt-rx-checkbox\n        rx-id=\"document-text-contains-html\"\n        name=\"containsHtml\"\n        [(ngModel)]=\"containsHtml\"\n        label=\"{{\n          'com.bmc.arsys.rx.client.admin.tone-analysis-testing.document-text-contains-html.label' | translate\n        }}\"\n      ></adapt-rx-checkbox>\n    </div>\n\n    <div class=\"col-md-6\">\n      <adapt-rx-control-label\n        label=\"{{ 'com.bmc.arsys.rx.client.admin.tone-analysis-testing.document-tone.label' | translate }}\"\n      ></adapt-rx-control-label>\n      <div class=\"mt-1\">\n        <adapt-badge variant=\"info\" *ngIf=\"!extractedToneData\">\n          {{ 'com.bmc.arsys.rx.client.common.none.label' | translate }}\n        </adapt-badge>\n        <adapt-badge variant=\"info\" class=\"mr-1\" *ngFor=\"let score of extractedToneData?.documentTone?.scores\">\n          <b>{{ score.toneName }}</b> ({{ score.score }})\n        </adapt-badge>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"row\">\n    <div class=\"col-md-6 form-group\">\n      <button\n        rx-id=\"clear-button\"\n        type=\"button\"\n        adapt-button\n        btn-type=\"tertiary\"\n        class=\"p-0 float-right\"\n        (click)=\"clearDocumentText()\"\n      >\n        {{ 'com.bmc.arsys.rx.client.common.clear.label' | translate }}\n      </button>\n\n      <adapt-rx-textarea\n        rx-id=\"document-text\"\n        name=\"documentText\"\n        [(ngModel)]=\"documentText\"\n        label=\"{{ 'com.bmc.arsys.rx.client.admin.tone-analysis-testing.document-text.label' | translate }}\"\n        placeholder=\"Type or paste document text here\"\n        [rows]=\"12\"\n        required\n      ></adapt-rx-textarea>\n\n      <div class=\"form-group pt-3\">\n        <button\n          type=\"button\"\n          adapt-button\n          btn-type=\"tertiary\"\n          rx-id=\"set-to-default-button\"\n          class=\"p-0 float-right\"\n          (click)=\"setDefaultThreshold()\"\n        >\n          {{ 'com.bmc.arsys.rx.client.admin.set-to-default.label' | translate }}\n        </button>\n\n        <adapt-rx-counter\n          rx-id=\"tone-score-threshold\"\n          name=\"toneScoreThresholdField\"\n          [(ngModel)]=\"toneScoreThreshold\"\n          label=\"{{ 'com.bmc.arsys.rx.client.admin.tone-analysis-testing.tone-score-threshold.label' | translate }}\"\n          [max]=\"1.0\"\n          [min]=\"0.5\"\n          [step]=\"0.1\"\n          [size]=\"'small'\"\n          adaptRequired\n          [tooltip]=\"{\n            iconName: 'question_circle_o',\n            content: 'com.bmc.arsys.rx.client.admin.tone-analysis-testing.tone-score-threshold.tooltip' | translate,\n            placement: 'right',\n            popoverMode: true\n          }\"\n        >\n        </adapt-rx-counter>\n      </div>\n\n      <div class=\"form-group\">\n        <adapt-rx-switch\n          rx-id=\"include-sentence-level-analysis\"\n          name=\"includeSentenceLevelAnalysis\"\n          [(ngModel)]=\"includeSentenceLevelAnalysis\"\n          label=\"{{\n            'com.bmc.arsys.rx.client.admin.tone-analysis-testing.include-sentence-level-analysis.label' | translate\n          }}\"\n        ></adapt-rx-switch>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"col-12 form-group\">\n          <button\n            class=\"mr-2 d-icon-left-check_adapt\"\n            adapt-button\n            btn-type=\"primary\"\n            type=\"button\"\n            rx-id=\"analyze-tone-button\"\n            (click)=\"analyzeTone()\"\n            [disabled]=\"isAnalyzeToneButtonDisabled()\"\n          >\n            {{ 'com.bmc.arsys.rx.client.admin.tone-analysis-testing.analyze-tone.label' | translate }}\n          </button>\n\n          <button\n            class=\"mr-2 d-icon-left-undo\"\n            adapt-button\n            btn-type=\"secondary\"\n            type=\"button\"\n            rx-id=\"reset-button\"\n            (click)=\"reset()\"\n            [disabled]=\"isResetButtonDisabled()\"\n          >\n            {{ 'com.bmc.arsys.rx.client.common.reset.label' | translate }}\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"col-md-6 form-group\">\n      <div rx-id=\"sentences-tone\" name=\"sentenceTone\">\n        <adapt-rx-control-label label=\"Sentences tone\"></adapt-rx-control-label>\n        <div class=\"sentences-tones form-control\">\n          <div class=\"sentences-tone\" *ngFor=\"let sentenceTone of extractedToneData?.sentencesTone\">\n            <div class=\"sentence\">{{ sentenceTone.text }}</div>\n            <div>\n              <adapt-badge class=\"mr-1\" variant=\"info\" *ngFor=\"let score of sentenceTone?.scores\">\n                <b>{{ score.toneName }}</b> ({{ score.score }})</adapt-badge\n              >\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</form>\n"]}