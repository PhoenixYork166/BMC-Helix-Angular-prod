{"version":3,"file":"approval-request-comment.component.js","sourceRoot":"","sources":["../../../../../../../../libs/platform/approval/components/approval-console/approval-request-comment/approval-request-comment.component.ts","../../../../../../../../libs/platform/approval/components/approval-console/approval-request-comment/approval-request-comment.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, Injector } from '@angular/core';\nimport { ActiveModalRef, DismissReasons, FileObj } from '@bmc-ux/adapt-angular';\nimport { IApprovalRequest } from '../approval-console.types';\nimport { RxApprovalConsoleService } from '../approval-console.service';\nimport { RxNotificationService } from '@helix/platform/shared/api';\nimport { TranslateService } from '@ngx-translate/core';\nimport { finalize } from 'rxjs/operators';\nimport { RxModalClass } from '@helix/platform/ui-kit';\nimport { trim } from 'lodash';\n\n@Component({\n  selector: 'rx-approval-request-comment',\n  templateUrl: './approval-request-comment.component.html'\n})\nexport class ApprovalRequestCommentComponent extends RxModalClass {\n  comment: string;\n  attachment: FileObj[] = [];\n\n  constructor(\n    private activeModalRef: ActiveModalRef,\n    private translateService: TranslateService,\n    private rxNotificationService: RxNotificationService,\n    private rxApprovalConsoleService: RxApprovalConsoleService,\n    protected injector: Injector\n  ) {\n    super(activeModalRef, injector);\n  }\n\n  isDirty(): boolean {\n    return !!(this.comment || this.attachment[0]?.data);\n  }\n\n  saveComment(): void {\n    this.allowDismiss = false;\n\n    const formData = new FormData();\n    const request: IApprovalRequest = this.activeModalRef.getData().selectedRequest;\n\n    formData.append('comments', this.comment);\n    formData.append('application', request.application);\n    formData.append('applicationRequestId', request.resolvedDisplayValues.request);\n    formData.append('signatureID', request.signatureID);\n\n    if (this.attachment[0]?.data) {\n      formData.append('attachment', this.attachment[0].data, this.attachment[0].data.name);\n    }\n\n    this.rxApprovalConsoleService\n      .saveQuestion(formData, 'comment')\n      .pipe(\n        finalize(() => {\n          this.allowDismiss = true;\n        })\n      )\n      .subscribe(() => {\n        this.rxNotificationService.addSuccessMessage(\n          this.translateService.instant('com.bmc.arsys.rx.client.approval.console.comments.comment-added.message')\n        );\n\n        this.activeModalRef.close(true);\n      });\n  }\n\n  cancel(): void {\n    this.activeModalRef.dismiss(DismissReasons.CLOSE_BTN);\n  }\n\n  isCommentEmpty(): boolean {\n    return !trim(this.comment);\n  }\n}\n","<div class=\"modal-header\">\n  <h5 class=\"modal-title\">\n    {{ 'com.bmc.arsys.rx.client.approval.console.comments.new.label' | translate }}\n  </h5>\n\n  <button\n    class=\"close dp-close\"\n    type=\"button\"\n    rx-id=\"x-button\"\n    [disabled]=\"!allowDismiss\"\n    (click)=\"cancel()\"\n  ></button>\n</div>\n\n<div class=\"modal-body\">\n  <adapt-rx-textarea\n    label=\"{{ 'com.bmc.arsys.rx.client.common.comment.label' | translate }}\"\n    class=\"d-block form-group\"\n    [(ngModel)]=\"comment\"\n    [required]=\"true\"\n    [autofocus]=\"true\"\n    rows=\"3\"\n  ></adapt-rx-textarea>\n\n  <adapt-rx-uploader\n    adaptRequired\n    [(ngModel)]=\"attachment\"\n    [enableDnD]=\"true\"\n    [showMaxSizeRestriction]=\"false\"\n    label=\"{{ 'com.bmc.arsys.rx.client.common.attachment.label' | translate }}\"\n  >\n  </adapt-rx-uploader>\n</div>\n\n<div class=\"modal-footer\">\n  <button\n    adapt-button\n    class=\"mr-2\"\n    btn-type=\"primary\"\n    type=\"button\"\n    rx-id=\"save-button\"\n    [disabled]=\"isCommentEmpty() || !allowDismiss\"\n    [adaptInlineLoader]=\"!allowDismiss\"\n    (click)=\"saveComment()\"\n  >\n    {{ 'com.bmc.arsys.rx.client.common.save.label' | translate }}\n  </button>\n\n  <button\n    adapt-button\n    type=\"button\"\n    btn-type=\"secondary\"\n    rx-id=\"cancel-button\"\n    (click)=\"cancel()\"\n    [disabled]=\"!allowDismiss\"\n  >\n    {{ 'com.bmc.arsys.rx.client.common.cancel.label' | translate }}\n  </button>\n</div>\n"]}