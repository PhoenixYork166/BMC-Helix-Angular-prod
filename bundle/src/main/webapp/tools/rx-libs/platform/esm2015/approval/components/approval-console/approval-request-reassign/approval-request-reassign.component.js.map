{"version":3,"file":"approval-request-reassign.component.js","sourceRoot":"","sources":["../../../../../../../../libs/platform/approval/components/approval-console/approval-request-reassign/approval-request-reassign.component.ts","../../../../../../../../libs/platform/approval/components/approval-console/approval-request-reassign/approval-request-reassign.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,eAAe,CAAC;AAGpD,OAAO,EAAE,qBAAqB,EAAE,MAAM,4BAA4B,CAAC;AACnE,OAAO,EAAE,cAAc,EAAE,cAAc,EAAE,MAAM,uBAAuB,CAAC;AACvE,OAAO,EAAE,wBAAwB,EAAE,MAAM,6BAA6B,CAAC;AACvE,OAAO,EAAE,GAAG,IAAI,IAAI,EAAE,MAAM,QAAQ,CAAC;AACrC,OAAO,EAAE,mBAAmB,EAAE,MAAM,2BAA2B,CAAC;AAChE,OAAO,EAAE,gBAAgB,EAAE,MAAM,qBAAqB,CAAC;AACvD,OAAO,EAAE,QAAQ,EAAE,MAAM,gBAAgB,CAAC;AAC1C,OAAO,EAAE,YAAY,EAAE,MAAM,wBAAwB,CAAC;;;;;;;;AAMtD,MAAM,OAAO,gCAAiC,SAAQ,YAAY;IAIhE,YACU,gBAAkC,EAClC,qBAA4C,EAC5C,cAA8B,EAC9B,wBAAkD,EAChD,QAAkB;QAE5B,KAAK,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC;QANxB,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,0BAAqB,GAArB,qBAAqB,CAAuB;QAC5C,mBAAc,GAAd,cAAc,CAAgB;QAC9B,6BAAwB,GAAxB,wBAAwB,CAA0B;QAChD,aAAQ,GAAR,QAAQ,CAAU;QAR9B,iBAAY,GAAoC,EAAE,CAAC;QACnD,mBAAc,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAUlD,CAAC;IAED,OAAO;QACL,OAAO,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;IACpC,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;QAE1B,MAAM,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,CAAC,0BAA0B,EAAE,CAAC,iBAAyB,EAAE,EAAE,CAAC,iBAC7G,iBAAiB,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,KAAK,IAC1C,IAAI,CAAC,wBAAwB,CAAC,iBAAiB,CAAC,mBAAmB,CAAC,QAAQ,EAAE,iBAAiB,CAAC,EACnG,CAAC,CAAC;QAEJ,IAAI,CAAC,wBAAwB;aAC1B,eAAe,CAAC,QAAQ,CAAC;aACzB,IAAI,CACH,QAAQ,CAAC,GAAG,EAAE;YACZ,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;QAC3B,CAAC,CAAC,CACH;aACA,SAAS,CAAC,GAAG,EAAE;YACd,IAAI,CAAC,qBAAqB,CAAC,iBAAiB,CAC1C,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,qEAAqE,CAAC,CACrG,CAAC;YAEF,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAClC,CAAC,CAAC,CAAC;IACP,CAAC;IAED,MAAM;QACJ,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;IACxD,CAAC;IAEO,gBAAgB,CACtB,UAAkB,EAClB,QAAgB,EAChB,WAAmB;QAEnB,OAAO,IAAI,CAAC,wBAAwB,CAAC,gBAAgB,CAAC,UAAU,EAAE,QAAQ,EAAE,WAAW,CAAC,CAAC;IAC3F,CAAC;IAED,eAAe,CAAC,MAAqC;QACnD,OAAO,GAAG,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,YAAY,EAAE,CAAC;IAClD,CAAC;;6HAxDU,gCAAgC;iHAAhC,gCAAgC,2FChB7C,ohDA2DA;2FD3Ca,gCAAgC;kBAJ5C,SAAS;mBAAC;oBACT,QAAQ,EAAE,8BAA8B;oBACxC,WAAW,EAAE,4CAA4C;iBAC1D","sourcesContent":["import { Component, Injector } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { IRxSelectWithPaginationOption, IRxSelectWithPaginationOptionsPage } from '@helix/platform/shared/components';\nimport { RxNotificationService } from '@helix/platform/shared/api';\nimport { ActiveModalRef, DismissReasons } from '@bmc-ux/adapt-angular';\nimport { RxApprovalConsoleService } from '../approval-console.service';\nimport { map as _map } from 'lodash';\nimport { ApprovalCommandType } from '../approval-console.types';\nimport { TranslateService } from '@ngx-translate/core';\nimport { finalize } from 'rxjs/operators';\nimport { RxModalClass } from '@helix/platform/ui-kit';\n\n@Component({\n  selector: 'rx-approval-request-reassign',\n  templateUrl: './approval-request-reassign.component.html'\n})\nexport class ApprovalRequestReassignComponent extends RxModalClass {\n  selectedUser: IRxSelectWithPaginationOption[] = [];\n  userLoaderFunc = this.getApprovalUsers.bind(this);\n\n  constructor(\n    private translateService: TranslateService,\n    private rxNotificationService: RxNotificationService,\n    private activeModalRef: ActiveModalRef,\n    private rxApprovalConsoleService: RxApprovalConsoleService,\n    protected injector: Injector\n  ) {\n    super(activeModalRef, injector);\n  }\n\n  isDirty(): boolean {\n    return !!this.selectedUser.length;\n  }\n\n  reassign(): void {\n    this.allowDismiss = false;\n\n    const commands = _map(this.activeModalRef.getData().selectedRequestInstanceIds, (signatureInstance: string) => ({\n      assignToApprovers: this.selectedUser[0].value,\n      ...this.rxApprovalConsoleService.getCommandPayload(ApprovalCommandType.Reassign, signatureInstance)\n    }));\n\n    this.rxApprovalConsoleService\n      .reassignRequest(commands)\n      .pipe(\n        finalize(() => {\n          this.allowDismiss = true;\n        })\n      )\n      .subscribe(() => {\n        this.rxNotificationService.addSuccessMessage(\n          this.translateService.instant('com.bmc.arsys.rx.client.approval.console.request.reassigned.message')\n        );\n\n        this.activeModalRef.close(true);\n      });\n  }\n\n  cancel(): void {\n    this.activeModalRef.dismiss(DismissReasons.CLOSE_BTN);\n  }\n\n  private getApprovalUsers(\n    startIndex: number,\n    pageSize: number,\n    searchQuery: string\n  ): Observable<IRxSelectWithPaginationOptionsPage> {\n    return this.rxApprovalConsoleService.getApprovalUsers(startIndex, pageSize, searchQuery);\n  }\n\n  optionFormatter(option: IRxSelectWithPaginationOption): string {\n    return `${option.value} ${option.displayValue}`;\n  }\n}\n","<div class=\"modal-header\">\n  <h5 class=\"modal-title\">\n    {{ 'com.bmc.arsys.rx.client.approval.console.request.reassign-dialog.title' | translate }}\n  </h5>\n\n  <button\n    class=\"close dp-close\"\n    type=\"button\"\n    rx-id=\"x-button\"\n    [disabled]=\"!allowDismiss\"\n    (click)=\"cancel()\"\n  ></button>\n</div>\n\n<div class=\"modal-body\">\n  <rx-select-with-pagination\n    label=\"{{ 'com.bmc.arsys.rx.client.approval.console.request.reassign.label' | translate }}\"\n    class=\"form-group d-block\"\n    [(ngModel)]=\"selectedUser\"\n    [optionLoader]=\"userLoaderFunc\"\n    [required]=\"true\"\n    [template]=\"optionTemplate\"\n    [optionFormatter]=\"optionFormatter\"\n  ></rx-select-with-pagination>\n</div>\n\n<div class=\"modal-footer\">\n  <button\n    adapt-button\n    class=\"mr-2\"\n    btn-type=\"primary\"\n    type=\"button\"\n    rx-id=\"save-button\"\n    [adaptInlineLoader]=\"!allowDismiss\"\n    [disabled]=\"!selectedUser.length || !allowDismiss\"\n    (click)=\"reassign()\"\n  >\n    {{ 'com.bmc.arsys.rx.client.common.save.label' | translate }}\n  </button>\n\n  <button\n    adapt-button\n    type=\"button\"\n    btn-type=\"secondary\"\n    rx-id=\"cancel-button\"\n    (click)=\"cancel()\"\n    [disabled]=\"!allowDismiss\"\n  >\n    {{ 'com.bmc.arsys.rx.client.common.cancel.label' | translate }}\n  </button>\n</div>\n\n<ng-template #optionTemplate let-option>\n  <strong>{{ option.displayValue }}</strong>\n\n  <div class=\"text-secondary\">\n    {{ option.value }}\n  </div>\n</ng-template>\n"]}