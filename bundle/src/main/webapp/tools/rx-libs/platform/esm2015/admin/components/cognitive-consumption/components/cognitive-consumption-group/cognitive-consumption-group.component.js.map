{"version":3,"file":"cognitive-consumption-group.component.js","sourceRoot":"","sources":["../../../../../../../../../libs/platform/admin/components/cognitive-consumption/components/cognitive-consumption-group/cognitive-consumption-group.component.ts","../../../../../../../../../libs/platform/admin/components/cognitive-consumption/components/cognitive-consumption-group/cognitive-consumption-group.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,KAAK,EAAU,MAAM,eAAe,CAAC;AAEzD,OAAO,EAAE,cAAc,EAAE,MAAM,wBAAwB,CAAC;AACxD,OAAO,EAAE,gBAAgB,EAAE,MAAM,qBAAqB,CAAC;AACvD,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,QAAQ,CAAC;AACtD,OAAO,MAAM,MAAM,YAAY,CAAC;AAChC,OAAO,EAAE,wBAAwB,EAAE,MAAM,sCAAsC,CAAC;AAChF,OAAO,EAAE,6BAA6B,EAAE,MAAM,qCAAqC,CAAC;AASpF,OAAO,EAAE,8CAA8C,EAAE,MAAM,gGAAgG,CAAC;;;;;;;;AAOhK,MAAM,OAAO,kCAAkC;IAqB7C,YACU,cAA8B,EAC9B,6BAA4D,EAC5D,gBAAkC;QAFlC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,kCAA6B,GAA7B,6BAA6B,CAA+B;QAC5D,qBAAgB,GAAhB,gBAAgB,CAAkB;QAT5C,eAAU,GAAiC;YACzC,SAAS,EAAE,EAAE;YACb,OAAO,EAAE,MAAM,EAAE,CAAC,MAAM,CAAC,SAAS,CAAC;YACnC,SAAS,EAAE,wBAAwB,CAAC,QAAQ,CAAC,SAAS;SACvD,CAAC;IAMC,CAAC;IAEJ,QAAQ;QACN,IAAI,CAAC,iCAAiC,EAAE,CAAC;IAC3C,CAAC;IAED,iCAAiC;QAC/B,IAAI,CAAC,iBAAiB,GAAG,EAAE,CAAC;QAC5B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC;QAE9C,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,SAAS,CAAC;aACnE,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,EAAE,QAAQ,CAAC;aACtB,MAAM,CAAC,SAAS,CAAC,CAAC;QAErB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,6BAA6B;aAC3C,wBAAwB,CAAC,wBAAwB,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,EAAE,IAAI,CAAC,UAAU,CAAC;aACvG,SAAS,CAAC,CAAC,YAAoC,EAAE,EAAE;YAClD,OAAO,CAAC,YAAY,CAAC,iBAAiB,EAAE,CAAC,iBAAiB,EAAE,EAAE;gBAC5D,IAAI,iBAAiB,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,KAAK,CAAC,EAAE;oBAC1D,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;iBAChD;YACH,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAED,oBAAoB;QAClB,IAAI,CAAC,cAAc;aAChB,SAAS,CAAC;YACT,KAAK,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAClC,wFAAwF,CACzF;YACD,OAAO,EAAE,8CAA8C;YACvD,IAAI,EAAE,OAAO;YACb,IAAI,EAAE;gBACJ,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE;aACvB;SACF,CAAC;aACD,KAAK,CAAC,IAAI,CAAC,CAAC;IACjB,CAAC;;+HA/DU,kCAAkC;mHAAlC,kCAAkC,8JCvB/C,yuCAqCA;2FDda,kCAAkC;kBAL9C,SAAS;mBAAC;oBACT,QAAQ,EAAE,gCAAgC;oBAC1C,WAAW,EAAE,8CAA8C;oBAC3D,SAAS,EAAE,CAAC,8CAA8C,CAAC;iBAC5D;gLAGC,KAAK;sBADJ,KAAK;gBAIN,eAAe;sBADd,KAAK;gBAIN,SAAS;sBADR,KAAK","sourcesContent":["import { Component, Input, OnInit } from '@angular/core';\nimport { BusyConfig } from '@bmc-ux/adapt-angular';\nimport { RxModalService } from '@helix/platform/ui-kit';\nimport { TranslateService } from '@ngx-translate/core';\nimport { forEach, isEmpty, noop, omit } from 'lodash';\nimport moment from 'moment-es6';\nimport { RX_COGNITIVE_CONSUMPTION } from '../../cognitive-consumption.constant';\nimport { RxCognitiveConsumptionService } from '../../cognitive-consumption.service';\nimport {\n  ICognitiveConsumptionChart,\n  ICognitiveConsumptionGroup,\n  ICognitiveConsumptionGroupData,\n  ICognitiveLicenseUsage,\n  ICognitiveLicenseUsageCount,\n  ICognitiveLicenseUsageParams\n} from '../../cognitive-consumption.types';\nimport { CognitiveConsumptionNotificationModalComponent } from '../cognitive-consumption-notification-modal/cognitive-consumption-notification-modal.component';\n\n@Component({\n  selector: 'rx-cognitive-consumption-group',\n  templateUrl: './cognitive-consumption-group.component.html',\n  styleUrls: ['./cognitive-consumption-group.component.scss']\n})\nexport class CognitiveConsumptionGroupComponent implements OnInit {\n  @Input()\n  group: ICognitiveConsumptionGroup;\n\n  @Input()\n  isAdministrator: boolean;\n\n  @Input()\n  sectionId: string;\n\n  busy: BusyConfig['busy'];\n  charts: ICognitiveConsumptionChart[];\n  groupData: ICognitiveConsumptionGroupData;\n  licenceUsageCount: ICognitiveLicenseUsageCount[];\n\n  parameters: ICognitiveLicenseUsageParams = {\n    startDate: '',\n    endDate: moment().format('YYYY-MM'),\n    countType: RX_COGNITIVE_CONSUMPTION.settings.countType\n  };\n\n  constructor(\n    private rxModalService: RxModalService,\n    private rxCognitiveConsumptionService: RxCognitiveConsumptionService,\n    private translateService: TranslateService\n  ) {}\n\n  ngOnInit() {\n    this.generateCognitiveConsumptionGroup();\n  }\n\n  generateCognitiveConsumptionGroup(): void {\n    this.licenceUsageCount = [];\n    this.groupData = omit(this.group, ['charts']);\n\n    this.parameters.startDate = moment(this.parameters.endDate, 'YYYY-MM')\n      .add(-1 * 36, 'months')\n      .format('YYYY-MM');\n\n    this.busy = this.rxCognitiveConsumptionService\n      .getCognitiveLicenseUsage(RX_COGNITIVE_CONSUMPTION.settings.licenseType, this.group.id, this.parameters)\n      .subscribe((licenseUsage: ICognitiveLicenseUsage) => {\n        forEach(licenseUsage.licenseUsageCount, (licenseUsageCount) => {\n          if (licenseUsageCount && !isEmpty(licenseUsageCount.count)) {\n            this.licenceUsageCount.push(licenseUsageCount);\n          }\n        });\n      });\n  }\n\n  onNotificationsClick(): void {\n    this.rxModalService\n      .openModal({\n        title: this.translateService.instant(\n          'com.bmc.arsys.rx.client.admin.cognitive-consumption-group.add-edit-notifications.title'\n        ),\n        content: CognitiveConsumptionNotificationModalComponent,\n        size: 'rx-lg',\n        data: {\n          groupId: this.group.id\n        }\n      })\n      .catch(noop);\n  }\n}\n","<button\n  *ngIf=\"isAdministrator\"\n  class=\"d-icon-envelope_o mb-4\"\n  adapt-button\n  btn-type=\"tertiary\"\n  type=\"button\"\n  rx-id=\"notifications-button\"\n  (click)=\"onNotificationsClick()\"\n>\n  {{ 'com.bmc.arsys.rx.client.admin.cognitive-consumption-group.notifications.label' | translate }}\n</button>\n\n<div class=\"d-flex flex-row flex-wrap\">\n  <div class=\"card mb-4 mr-4 placeholder\" *ngFor=\"let chart of group.charts\">\n    <div class=\"card-block p-4\">\n      <rx-busy-indicator [options]=\"{ busy: busy, loaderType: 'section' }\"></rx-busy-indicator>\n\n      <div *ngIf=\"licenceUsageCount.length\">\n        <rx-cognitive-consumption-chart\n          [chart]=\"chart\"\n          [groupData]=\"groupData\"\n          [licenceUsageCount]=\"licenceUsageCount\"\n        ></rx-cognitive-consumption-chart>\n      </div>\n\n      <div *ngIf=\"!licenceUsageCount.length\">\n        <h5 class=\"m-0\">{{ chart.title | translate }}</h5>\n        <div class=\"mt-6 pt-4\">\n          <adapt-empty-state\n            type=\"chart\"\n            label=\"{{ 'com.bmc.arsys.rx.client.empty-state.no-data-to-display.label' | translate }}\"\n          ></adapt-empty-state>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n"]}