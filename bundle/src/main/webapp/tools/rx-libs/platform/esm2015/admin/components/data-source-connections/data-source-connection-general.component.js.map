{"version":3,"file":"data-source-connection-general.component.js","sourceRoot":"","sources":["../../../../../../../libs/platform/admin/components/data-source-connections/data-source-connection-general.component.ts","../../../../../../../libs/platform/admin/components/data-source-connections/data-source-connection-general.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { RxSelectOption } from '@bmc-ux/adapt-angular';\nimport { get, head } from 'lodash';\nimport { ReplaySubject } from 'rxjs';\nimport { TranslateService } from '@ngx-translate/core';\nimport { withLatestFrom, take, tap, takeUntil } from 'rxjs/operators';\n\nimport { RxWizardModalComponent } from '@helix/platform/shared/components';\nimport { RX_DATA_SOURCE_CONNECTIONS } from './data-source-connections.constant';\n\n@Component({\n  selector: 'rx-data-source-connection-general',\n  templateUrl: './data-source-connection-general.component.html',\n  styleUrls: ['./data-source-connection-general.component.scss']\n})\nexport class DataSourceConnectionGeneralComponent implements OnInit, OnDestroy {\n  generalForm: FormGroup;\n\n  dataSourceConfigTypes: RxSelectOption[] = Object.values(RX_DATA_SOURCE_CONNECTIONS.resourceTypes).map(\n    (resourceType) => ({\n      ...resourceType,\n      name: this.translateService.instant(resourceType.name)\n    })\n  );\n\n  private defaultSelection = this.translateService.instant('com.bmc.arsys.rx.client.common.select.label');\n\n  private destroyed$ = new ReplaySubject<boolean>(1);\n\n  constructor(private rxWizardModalComponent: RxWizardModalComponent, private translateService: TranslateService) {}\n\n  ngOnInit(): void {\n    this.rxWizardModalComponent.context$.pipe(take(1)).subscribe((context) => {\n      this.generalForm = new FormGroup({\n        dataSourceName: new FormControl(context.dataSourceName, [Validators.required]),\n        resourceType: new FormControl([context.resourceType], [Validators.required])\n      });\n\n      if (this.generalForm.invalid) {\n        this.rxWizardModalComponent.api.disableNextButton();\n      }\n    });\n\n    this.generalForm.valueChanges\n      .pipe(withLatestFrom(this.rxWizardModalComponent.context$), takeUntil(this.destroyed$))\n      .subscribe(([value, context]) => {\n        this.rxWizardModalComponent.api.updateContext({\n          ...value,\n          resourceType: head(value.resourceType),\n          isGeneralFormPristine: this.generalForm.pristine\n        });\n\n        if (this.generalForm.valid) {\n          this.rxWizardModalComponent.api.enableNextButton();\n        } else {\n          this.rxWizardModalComponent.api.disableNextButton();\n        }\n      });\n  }\n\n  optionFormatter = (dataSourceOption: RxSelectOption): string => {\n    return get(dataSourceOption, 'name', this.defaultSelection);\n  };\n\n  ngOnDestroy(): void {\n    this.destroyed$.next();\n    this.destroyed$.complete();\n  }\n}\n","<form [formGroup]=\"generalForm\">\n  <div class=\"row\">\n    <div class=\"col-md-6\">\n      <adapt-rx-textfield\n        label=\"{{ 'com.bmc.arsys.rx.client.common.name.label' | translate }}\"\n        name=\"dataSourceName\"\n        formControlName=\"dataSourceName\"\n        rx-id=\"name-field\"\n        class=\"d-block form-group\"\n      >\n      </adapt-rx-textfield>\n    </div>\n  </div>\n  <div class=\"row\">\n    <div class=\"col-md-6\">\n      <adapt-rx-select\n        label=\"{{ 'com.bmc.arsys.rx.client.common.item-type.label' | translate }}\"\n        name=\"resourceType\"\n        class=\"d-block form-group\"\n        rx-id=\"type-field\"\n        formControlName=\"resourceType\"\n        [options]=\"dataSourceConfigTypes\"\n        [optionFormatter]=\"optionFormatter\"\n      >\n      </adapt-rx-select>\n    </div>\n  </div>\n</form>\n"]}