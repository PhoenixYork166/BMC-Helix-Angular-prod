{"version":3,"file":"record-indexes-control.component.js","sourceRoot":"","sources":["../../../../../../../../libs/platform/record/designer/record-designer/record-indexes-control/record-indexes-control.component.ts","../../../../../../../../libs/platform/record/designer/record-designer/record-indexes-control/record-indexes-control.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { RX_MODAL, RxModalService } from '@helix/platform/ui-kit';\nimport { ValueAccessor } from '@helix/platform/shared/components';\nimport { TranslateService } from '@ngx-translate/core';\nimport { IIndexesEditorOptions, IRecordIndexesControlOptions } from './record-indexes-control.types';\nimport { noop } from 'lodash';\nimport { RecordIndexesEditorComponent } from './record-indexes-editor.component';\nimport { IIndexDefinitionModel } from '../../record-designer.types';\nimport { OpenViewActionModalSize } from '@helix/platform/view/api';\nimport { IFormFocusable } from '@helix/platform/shared/api';\n\n@Component({\n  selector: 'rx-record-indexes',\n  templateUrl: './record-indexes-control.component.html',\n  styleUrls: ['./record-indexes-control.component.scss'],\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: RecordIndexesControlComponent,\n      multi: true\n    }\n  ]\n})\nexport class RecordIndexesControlComponent extends ValueAccessor<IIndexDefinitionModel[]> implements IFormFocusable {\n  @Input()\n  options: IRecordIndexesControlOptions;\n\n  constructor(private rxModalService: RxModalService, private translateService: TranslateService) {\n    super();\n  }\n\n  openIndexesEditor(indexToEditIndex: number = null): void {\n    this.rxModalService\n      .openModal({\n        title: this.translateService.instant('com.bmc.arsys.rx.client.record-designer.indexes.edit-indexes.label'),\n        data: {\n          indexes: this.value,\n          indexToEditIndex,\n          isReadOnly: this.options.isReadOnly,\n          fields: this.options.definitionModel.fields\n        } as IIndexesEditorOptions,\n        content: RecordIndexesEditorComponent,\n        size: OpenViewActionModalSize.Large\n      })\n      .then((indexes: IIndexDefinitionModel[]) => {\n        this.value = indexes;\n      })\n      .catch(noop);\n  }\n\n  removeIndex($index: number): void {\n    this.rxModalService\n      .confirm({\n        title: this.translateService.instant('com.bmc.arsys.rx.client.common.warning.label'),\n        modalStyle: RX_MODAL.modalStyles.warning,\n        message: this.translateService.instant(\n          'com.bmc.arsys.rx.client.record-designer.indexes.delete-index-confirmation.message'\n        )\n      })\n      .then((result: boolean) => {\n        if (result) {\n          this.value = this.value.filter((index, itemIndex) => itemIndex !== $index);\n        }\n      });\n  }\n\n  focus(data?: { indexToEditIndex: number }): void {\n    if (data?.indexToEditIndex) {\n      this.openIndexesEditor(data.indexToEditIndex);\n    } else {\n      this.openIndexesEditor();\n    }\n  }\n}\n","<adapt-button btn-type=\"tertiary\" rx-id=\"open-indexes-editor\" class=\"p-0 pb-1\" (click)=\"openIndexesEditor()\">\n  <span class=\"d-icon-plus_circle\"></span>\n  {{ 'com.bmc.arsys.rx.client.record-designer.indexes.edit-indexes.label' | translate }}\n</adapt-button>\n\n<div class=\"record-index rounded mb-1 border font-weight-bold\" *ngFor=\"let index of value; let $index = index\">\n  <div class=\"d-flex mb-1\">\n    <span rx-id=\"record-index-name\" [title]=\"index.indexName\">\n      <span *ngIf=\"!index.isAutomaticIndex\">{{\n        index.indexName || 'com.bmc.arsys.rx.client.record-designer.indexes.new-index.label' | translate\n      }}</span>\n      <span *ngIf=\"index.isAutomaticIndex\"\n        >{{\n          'com.bmc.arsys.rx.client.record-designer.indexes.automatic-index.label'\n            | translate\n              : {\n                  indexName:\n                    index.indexName || 'com.bmc.arsys.rx.client.record-designer.indexes.new-index.label' | translate\n                }\n        }}\n        <adapt-icon\n          name=\"question_circle_o\"\n          class=\"ml-2\"\n          [adaptPopover]=\"'com.bmc.arsys.rx.client.record-designer.indexes.system-index.tooltip' | translate\"\n        >\n        </adapt-icon>\n      </span>\n    </span>\n\n    <button\n      class=\"ml-auto rx-button-unstyled d-icon-left-pencil btn-link\"\n      type=\"button\"\n      rx-id=\"open-index-editor\"\n      (click)=\"openIndexesEditor($index)\"\n      *ngIf=\"!index.isAutomaticIndex\"\n    ></button>\n\n    <button\n      type=\"button\"\n      class=\"rx-button-unstyled d-icon-cross btn-link\"\n      rx-id=\"remove-index\"\n      (click)=\"removeIndex($index)\"\n      *ngIf=\"!options.isReadOnly && !index.isAutomaticIndex\"\n    ></button>\n  </div>\n\n  <div class=\"caption ellipsis\">\n    {{\n      (index.unique\n        ? 'com.bmc.arsys.rx.client.record-designer.indexes.unique-index.label'\n        : 'com.bmc.arsys.rx.client.record-designer.indexes.non-unique-index.label.value'\n      ) | translate\n    }},\n    {{\n      index.indexFieldIds.length === 1\n        ? ('com.bmc.arsys.rx.client.record-designer.indexes.one-field-index.label' | translate)\n        : ('com.bmc.arsys.rx.client.record-designer.indexes.many-fields-index.label'\n          | translate: { fieldCount: index.indexFieldIds.length })\n    }}\n  </div>\n</div>\n"]}