{"version":3,"file":"localized-character-field-definition.service.js","sourceRoot":"","sources":["../../../../../../../../libs/platform/record/designer/record-designer/services/localized-character-field-definition.service.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,oBAAoB,EAAE,MAAM,4BAA4B,CAAC;AAClE,OAAO,EAAE,4BAA4B,EAAE,MAAM,iCAAiC,CAAC;AAC/E,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE,MAAM,eAAe,CAAC;AAGrD,OAAO,EAAE,2BAA2B,EAA8B,MAAM,mCAAmC,CAAC;AAC5G,OAAO,EAAE,sCAAsC,EAAE,MAAM,gFAAgF,CAAC;AAExI,OAAO,EAAoB,mBAAmB,EAAE,MAAM,wBAAwB,CAAC;AAC/E,OAAO,EAAE,oBAAoB,EAAE,MAAM,uBAAuB,CAAC;;;AAK7D,MAAM,OAAO,0CAA2C,SAAQ,4BAA4B;IAG1F,YAAY,QAAkB,EAAU,oBAA0C;QAChF,KAAK,CAAC,QAAQ,CAAC,CAAC;QADsB,yBAAoB,GAApB,oBAAoB,CAAsB;QAFlF,iBAAY,GAAG,oBAAoB,CAAC,SAAS,CAAC,kBAAkB,CAAC,YAAY,CAAC;IAI9E,CAAC;IAED,0BAA0B,CAAC,eAAqD;QAC9E,OAAO,KAAK,CAAC,0BAA0B,iCAClC,eAAe,KAClB,SAAS,EAAE,GAAG,IACd,CAAC;IACL,CAAC;IAED,uBAAuB,CACrB,UAAuC,EACvC,eAAuC,EACvC,UAAmB;QAEnB,MAAM,eAAe,GAAG,KAAK,CAAC,uBAAuB,CAAC,UAAU,EAAE,eAAe,EAAE,UAAU,CAAC,CAAC;QAE/F,eAAe,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,eAAe,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC;YAC/D;gBACE,IAAI,EAAE,WAAW;gBACjB,SAAS,EAAE,2BAA2B;gBACtC,UAAU,EAAE,UAAU;gBACtB,OAAO,EAAE;oBACP,KAAK,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,6CAA6C,CAAC;oBACnF,QAAQ,EAAE,CAAC;oBACX,QAAQ,EAAE,GAAG;oBACb,gBAAgB,EAAE,IAAI;iBACO;aAChC;YACD;gBACE,IAAI,EAAE,sBAAsB;gBAC5B,SAAS,EAAE,sCAAsC;gBACjD,OAAO,EAAE;oBACP,UAAU,EAAE,UAAU;iBACkB;aAC3C;SACF,CAAC,CAAC;QAEH,OAAO,eAAe,CAAC;IACzB,CAAC;IAED,QAAQ,CAAC,UAAuC,EAAE,eAAuC;QACvF,MAAM,gBAAgB,GAAG,KAAK,CAAC,QAAQ,CAAC,UAAU,EAAE,eAAe,CAAC,CAAC;QAErE,IAAI,IAAI,CAAC,oBAAoB,CAAC,sBAAsB,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,MAAM,CAAC,UAAU,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE;YAC9G,gBAAgB,CAAC,IAAI,CAAC;gBACpB,IAAI,EAAE,mBAAmB,CAAC,KAAK;gBAC/B,WAAW,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CACxC,8EAA8E,CAC/E;gBACD,IAAI,EAAE;oBACJ,YAAY,EAAE,WAAW;oBACzB,IAAI,EAAE,UAAU,CAAC,IAAI;iBACtB;aACF,CAAC,CAAC;SACJ;QAED,OAAO,gBAAgB,CAAC;IAC1B,CAAC;;uIA9DU,0CAA0C;2IAA1C,0CAA0C,cAFzC,MAAM;2FAEP,0CAA0C;kBAHtD,UAAU;mBAAC;oBACV,UAAU,EAAE,MAAM;iBACnB","sourcesContent":["import { RX_RECORD_DEFINITION } from '@helix/platform/record/api';\nimport { RxBaseFieldDefinitionService } from './base-field-definition.service';\nimport { Injectable, Injector } from '@angular/core';\nimport { IFormBuilderConfig } from '@helix/platform/shared/api';\nimport { IRecordDefinitionModel, IRecordFieldDefinitionModel } from '../../record-designer.types';\nimport { CounterFormControlComponent, ICounterFormControlOptions } from '@helix/platform/shared/components';\nimport { LocalizedCharacterFieldEditorComponent } from '../localized-character-field-editor/localized-character-field-editor.component';\nimport { ILocalizedCharacterFieldEditorOptions } from '../localized-character-field-editor/localized-character-field-editor.interface';\nimport { IValidationIssue, ValidationIssueType } from '@helix/platform/ui-kit';\nimport { RxNumberUtilsService } from '@helix/platform/utils';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class RxLocalizedCharacterFieldDefinitionService extends RxBaseFieldDefinitionService {\n  resourceType = RX_RECORD_DEFINITION.dataTypes.localizedCharacter.resourceType;\n\n  constructor(injector: Injector, private rxNumberUtilsService: RxNumberUtilsService) {\n    super(injector);\n  }\n\n  getNewFieldDefinitionModel(fieldProperties: Partial<IRecordFieldDefinitionModel>) {\n    return super.getNewFieldDefinitionModel({\n      ...fieldProperties,\n      maxLength: 254\n    });\n  }\n\n  getFieldInspectorConfig(\n    fieldModel: IRecordFieldDefinitionModel,\n    definitionModel: IRecordDefinitionModel,\n    isReadOnly: boolean\n  ): IFormBuilderConfig {\n    const inspectorConfig = super.getFieldInspectorConfig(fieldModel, definitionModel, isReadOnly);\n\n    inspectorConfig[1].controls = inspectorConfig[1].controls.concat([\n      {\n        name: 'maxLength',\n        component: CounterFormControlComponent,\n        isDisabled: isReadOnly,\n        options: {\n          label: this.translateService.instant('com.bmc.arsys.rx.client.common.length.label'),\n          minValue: 0,\n          maxValue: 254,\n          allowIntegerOnly: true\n        } as ICounterFormControlOptions\n      },\n      {\n        name: 'defaultValueByLocale',\n        component: LocalizedCharacterFieldEditorComponent,\n        options: {\n          isReadOnly: isReadOnly\n        } as ILocalizedCharacterFieldEditorOptions\n      }\n    ]);\n\n    return inspectorConfig;\n  }\n\n  validate(fieldModel: IRecordFieldDefinitionModel, definitionModel: IRecordDefinitionModel): IValidationIssue[] {\n    const validationIssues = super.validate(fieldModel, definitionModel);\n\n    if (this.rxNumberUtilsService.isFiniteOrNumberString(fieldModel.maxLength) && Number(fieldModel.maxLength) < 0) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.invalid-min-length-error.message'\n        ),\n        data: {\n          propertyName: 'maxLength',\n          guid: fieldModel.guid\n        }\n      });\n    }\n\n    return validationIssues;\n  }\n}\n"]}