{"version":3,"file":"customization-options.component.js","sourceRoot":"","sources":["../../../../../../../../libs/platform/shared/components/form-controls/customization-options/customization-options.component.ts","../../../../../../../../libs/platform/shared/components/form-controls/customization-options/customization-options.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input, OnChanges, SimpleChanges } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport {\n  ICustomizationControlValue,\n  ICustomizationOptions,\n  ICustomizationOptionsEditorData,\n  IScopeSelectionOption,\n  RxBundleCacheService,\n  RxOverlayService,\n  RX_OVERLAY\n} from '@helix/platform/shared/api';\nimport { RxModalService } from '@helix/platform/ui-kit';\nimport { noop } from 'lodash';\nimport { take } from 'rxjs/operators';\nimport { CoarseGrainedCustomizationOptionsEditorComponent } from '../../coarse-grained-customization-options-editor/coarse-grained-customization-options-editor.component';\nimport { ValueAccessor } from '../../form-builder/value-accessor';\n\n@Component({\n  selector: 'rx-scope-customization-control',\n  templateUrl: './customization-options.component.html',\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: CustomizationOptionsComponent,\n      multi: true\n    }\n  ]\n})\nexport class CustomizationOptionsComponent extends ValueAccessor<ICustomizationControlValue> implements OnChanges {\n  @Input()\n  options: ICustomizationOptions;\n\n  allowOverlayLabel: string;\n  definitionScopeName: string;\n  overlayOperation: string;\n\n  private scopeSelectionOptions: IScopeSelectionOption[];\n\n  constructor(\n    private rxModalService: RxModalService,\n    private rxBundleCacheService: RxBundleCacheService,\n    private rxOverlayService: RxOverlayService\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {\n    if (this.options) {\n      this.updateValues();\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.options) {\n      this.updateValues();\n    }\n  }\n\n  private getOverlayOperation(): string {\n    return this.rxOverlayService.getOverlayOperation(\n      this.options.overlayGroupId,\n      this.options.overlayDescriptor?.parentOverlayGroupId || null\n    );\n  }\n\n  private updateValues(): void {\n    this.setAllowOverlayLabel(this.options.allowOverlay);\n\n    this.rxBundleCacheService\n      .getDefinitionScopeName(this.options.scope)\n      .pipe(take(1))\n      .subscribe((definitionScopeName: string) => (this.definitionScopeName = definitionScopeName));\n\n    this.rxBundleCacheService\n      .getDefinitionScopeSelectionOptions()\n      .pipe(take(1))\n      .subscribe(\n        (scopeSelectionOptions: IScopeSelectionOption[]) => (this.scopeSelectionOptions = scopeSelectionOptions)\n      );\n\n    if (this.options.overlayGroupId) {\n      this.overlayOperation = this.getOverlayOperation();\n    } else {\n      this.overlayOperation = RX_OVERLAY.operationTypes.createdInThisOverlayGroup;\n    }\n  }\n\n  openCustomizationOptionsEditor(): void {\n    this.rxModalService\n      .openModal({\n        title: 'Scope/Customization options',\n        content: CoarseGrainedCustomizationOptionsEditorComponent,\n        blockKeyboard: false,\n        size: 'sm',\n\n        data: {\n          definitionScopeName: this.definitionScopeName,\n          allowOverlay: this.options.allowOverlay,\n          scopeSelectionOptions: this.scopeSelectionOptions,\n          isDisabled: this.options.isDisabled,\n          overlayOperation: this.overlayOperation,\n          definitionTypeDisplayName: this.options.definitionTypeDisplayName\n        } as ICustomizationOptionsEditorData\n      })\n      .then((result: ICustomizationControlValue) => {\n        this.setAllowOverlayLabel(result.allowOverlay);\n        this.definitionScopeName = this.scopeSelectionOptions.find((value) => value.id === result.scope).name;\n\n        this.value = result;\n      })\n      .catch(noop);\n  }\n\n  setAllowOverlayLabel(allowOverlay: boolean): void {\n    this.allowOverlayLabel = allowOverlay\n      ? RX_OVERLAY.overlayAllowedLabels.allowed\n      : RX_OVERLAY.overlayAllowedLabels.notAllowed;\n  }\n}\n","<div class=\"d-flex\">\n  <adapt-button\n    btn-type=\"tertiary\"\n    rx-id=\"open-customization-options-editor-link\"\n    (click)=\"openCustomizationOptionsEditor()\"\n    class=\"p-0\"\n  >\n    {{ 'com.bmc.arsys.rx.client.designer.scope-customization-options.title' | translate }}\n  </adapt-button>\n  <adapt-icon\n    name=\"question_circle_o\"\n    class=\"ml-2\"\n    placement=\"right\"\n    maxWidth=\"400\"\n    [adaptPopover]=\"'com.bmc.arsys.rx.client.designer.scope-customization-options.scope.tooltip' | translate\"\n  >\n  </adapt-icon>\n</div>\n\n<p rx-id=\"scope-name-label\" class=\"mb-0 pt-2\">\n  {{\n    'com.bmc.arsys.rx.client.designer.scope-customization-options.scope.label'\n      | translate: { definitionScopeName: definitionScopeName }\n  }}\n</p>\n<div rx-id=\"customization-options-label\" class=\"pt-2\">\n  {{\n    'com.bmc.arsys.rx.client.designer.scope-customization-options.customization.label'\n      | translate: { allowOverlayLabel: allowOverlayLabel }\n  }}\n</div>\n"]}