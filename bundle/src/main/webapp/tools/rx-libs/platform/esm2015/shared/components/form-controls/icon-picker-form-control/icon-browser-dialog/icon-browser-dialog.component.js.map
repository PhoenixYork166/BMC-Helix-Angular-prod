{"version":3,"file":"icon-browser-dialog.component.js","sourceRoot":"","sources":["../../../../../../../../../libs/platform/shared/components/form-controls/icon-picker-form-control/icon-browser-dialog/icon-browser-dialog.component.ts","../../../../../../../../../libs/platform/shared/components/form-controls/icon-picker-form-control/icon-browser-dialog/icon-browser-dialog.component.html"],"names":[],"mappings":"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","sourcesContent":["import {\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  Inject,\n  OnDestroy,\n  QueryList,\n  ViewChild,\n  ViewChildren\n} from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\nimport { FormControl } from '@angular/forms';\nimport { BehaviorSubject, combineLatest, fromEvent, Observable, ReplaySubject } from 'rxjs';\nimport {\n  debounceTime,\n  distinctUntilChanged,\n  filter,\n  map,\n  startWith,\n  take,\n  takeUntil,\n  tap,\n  withLatestFrom\n} from 'rxjs/operators';\nimport { UP_ARROW, DOWN_ARROW, LEFT_ARROW, RIGHT_ARROW, ENTER } from '@angular/cdk/keycodes';\nimport { ActiveModalRef, DismissReasons } from '@bmc-ux/adapt-angular';\nimport { isNumber } from 'lodash';\n\nimport { IIconBrowserDialogConfig, IIconGlyph } from '../icon-picker.types';\n\n@Component({\n  selector: 'rx-icon-browser-dialog',\n  templateUrl: './icon-browser-dialog.component.html',\n  styleUrls: ['./icon-browser-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class IconBrowserDialogComponent implements AfterViewInit, OnDestroy {\n  config: IIconBrowserDialogConfig = this.activeModalRef.getData();\n\n  searchFormControl = new FormControl();\n\n  selectedIcon$ = new BehaviorSubject<IIconGlyph>(this.config.selectedIcon);\n\n  filteredIcons$: Observable<IIconGlyph[]> = this.searchFormControl.valueChanges.pipe(\n    debounceTime(200),\n    startWith(''),\n    distinctUntilChanged(),\n    map((query) =>\n      query\n        ? this.config.icons.filter(({ name }) => name.toLowerCase().indexOf(query.toLowerCase()) > -1)\n        : this.config.icons\n    )\n  );\n\n  isSelectButtonDisabled$ = combineLatest([this.selectedIcon$, this.filteredIcons$]).pipe(\n    map(\n      ([selectedIcon, filteredIcons]) =>\n        !selectedIcon || !filteredIcons.length || selectedIcon === this.config.selectedIcon\n    )\n  );\n\n  @ViewChildren('iconButton', { read: ElementRef })\n  iconButtons: QueryList<ElementRef<HTMLButtonElement>>;\n\n  @ViewChild('iconsList', { read: ElementRef })\n  iconsList: ElementRef<HTMLUListElement>;\n\n  private selectedIndex$: Observable<number> = combineLatest([this.selectedIcon$, this.filteredIcons$]).pipe(\n    map(([selectedIcon, filteredIcons]) =>\n      selectedIcon ? filteredIcons.findIndex((icon) => icon.id === selectedIcon.id) : null\n    ),\n    distinctUntilChanged()\n  );\n\n  private destroyed$ = new ReplaySubject<boolean>(1);\n\n  constructor(private activeModalRef: ActiveModalRef, @Inject(DOCUMENT) private document: any) {}\n\n  ngAfterViewInit(): void {\n    fromEvent<KeyboardEvent>(this.iconsList.nativeElement, 'keydown')\n      .pipe(\n        filter((event) => [UP_ARROW, DOWN_ARROW, LEFT_ARROW, RIGHT_ARROW, ENTER].includes(event.keyCode)),\n        tap((event) => event.preventDefault()),\n        withLatestFrom(this.filteredIcons$, this.selectedIndex$),\n        takeUntil(this.destroyed$)\n      )\n      .subscribe(([event, icons, selectedIndex]) => {\n        // we have to subtract 1px from the icon button width to compensate -1 margin trick in the CSS\n        const cellsPerLine = Math.floor(\n          this.iconsList.nativeElement.clientWidth / (this.iconButtons.first.nativeElement.offsetWidth - 1)\n        );\n\n        let newIndex: number;\n\n        if ([UP_ARROW, DOWN_ARROW, LEFT_ARROW, RIGHT_ARROW].includes(event.keyCode)) {\n          if (isNumber(selectedIndex)) {\n            switch (event.keyCode) {\n              case LEFT_ARROW: {\n                newIndex = selectedIndex > 0 ? selectedIndex - 1 : 0;\n                break;\n              }\n\n              case UP_ARROW: {\n                newIndex = selectedIndex - cellsPerLine;\n\n                if (newIndex < 0) {\n                  newIndex = selectedIndex;\n                }\n\n                break;\n              }\n\n              case RIGHT_ARROW: {\n                newIndex = selectedIndex < icons.length - 1 ? selectedIndex + 1 : selectedIndex;\n                break;\n              }\n\n              case DOWN_ARROW: {\n                newIndex = selectedIndex + cellsPerLine;\n\n                if (newIndex >= icons.length) {\n                  newIndex = selectedIndex;\n                }\n\n                break;\n              }\n            }\n          } else {\n            newIndex = 0;\n          }\n\n          this.selectIcon(icons[newIndex]);\n\n          this.scrollToSelectedIcon();\n        } else {\n          event.preventDefault();\n\n          if (this.selectedIcon$.value) {\n            this.onSelect();\n          }\n        }\n      });\n\n    this.scrollToSelectedIcon();\n  }\n\n  ngOnDestroy(): void {\n    this.destroyed$.next();\n    this.destroyed$.complete();\n\n    this.selectedIcon$.complete();\n  }\n\n  selectIcon(icon: IIconGlyph): void {\n    this.selectedIcon$.next(icon);\n  }\n\n  onSelect(): void {\n    this.activeModalRef.close(this.selectedIcon$.value);\n  }\n\n  onCancel(): void {\n    this.activeModalRef.dismiss(DismissReasons.CLOSE_BTN);\n  }\n\n  isIconSelected(icon: IIconGlyph): boolean {\n    return this.selectedIcon$.value?.id === icon.id;\n  }\n\n  private scrollToSelectedIcon(): void {\n    this.selectedIcon$.pipe(take(1)).subscribe((selectedIcon) => {\n      if (selectedIcon) {\n        this.iconsList.nativeElement.querySelector(`.d-icon-${selectedIcon.id}`)?.scrollIntoView({\n          block: 'nearest',\n          inline: 'nearest'\n        });\n      }\n    });\n  }\n\n  trackByFn(index: number, item: IIconGlyph): string {\n    return item.id;\n  }\n}\n","<div class=\"modal-body mh-100\">\n  <div class=\"d-flex w-100 h-100\">\n    <ng-container *ngIf=\"filteredIcons$ | async as filteredIcons\">\n      <div class=\"w-100 h-100\">\n        <adapt-rx-search\n          class=\"icon-search-field\"\n          [formControl]=\"searchFormControl\"\n          [autofocus]=\"true\"\n          (keydown)=\"$event.stopPropagation()\"\n        ></adapt-rx-search>\n\n        <div class=\"icons-browser d-flex\">\n          <ul #iconsList class=\"icons-list h-100\" *ngIf=\"filteredIcons?.length; else noIconsFound\" tabindex=\"0\">\n            <li\n              *ngFor=\"let icon of filteredIcons; trackBy: trackByFn\"\n              class=\"icon-list-item\"\n              [class.icon-list-item-selected]=\"isIconSelected(icon)\"\n            >\n              <button\n                #iconButton\n                class=\"icon-button p-0\"\n                tabindex=\"-1\"\n                [ngClass]=\"'d-icon-' + icon.id\"\n                (click)=\"selectIcon(icon)\"\n              >\n                <span class=\"sr-only\">{{ icon.name }}</span>\n              </button>\n            </li>\n          </ul>\n\n          <ng-template #noIconsFound>\n            <div class=\"icon-empty-state flex-grow-1\">\n              <adapt-empty-state class=\"flex-grow-1\" [type]=\"'search'\" [label]=\"'No icons found'\"></adapt-empty-state>\n            </div>\n          </ng-template>\n        </div>\n      </div>\n\n      <div\n        *ngIf=\"filteredIcons?.length\"\n        class=\"icon-preview d-flex flex-column justify-content-center align-items-center\"\n      >\n        <ng-container *ngIf=\"selectedIcon$ | async as selectedIcon; else noIconSelected\">\n          <adapt-icon [name]=\"selectedIcon.id\" [testID]=\"selectedIcon.id\"></adapt-icon>\n\n          <p class=\"icon-title mt-1 mb-0\">{{ selectedIcon.name }}</p>\n        </ng-container>\n\n        <ng-template #noIconSelected>\n          <p class=\"no-icon-selected mb-0\">No icon selected</p>\n        </ng-template>\n      </div>\n    </ng-container>\n  </div>\n</div>\n\n<div class=\"modal-footer\">\n  <button\n    rx-id=\"select-button\"\n    adapt-button\n    btn-type=\"primary\"\n    type=\"button\"\n    [disabled]=\"isSelectButtonDisabled$ | async\"\n    (click)=\"onSelect()\"\n  >\n    Select\n  </button>\n\n  <button rx-id=\"cancel-button\" adapt-button btn-type=\"secondary\" type=\"button\" (click)=\"onCancel()\">Cancel</button>\n</div>\n"]}