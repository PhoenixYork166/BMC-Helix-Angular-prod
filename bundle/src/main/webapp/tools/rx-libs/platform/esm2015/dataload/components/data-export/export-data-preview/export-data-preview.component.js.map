{"version":3,"file":"export-data-preview.component.js","sourceRoot":"","sources":["../../../../../../../../libs/platform/dataload/components/data-export/export-data-preview/export-data-preview.component.ts","../../../../../../../../libs/platform/dataload/components/data-export/export-data-preview/export-data-preview.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAU,MAAM,eAAe,CAAC;AAClD,OAAO,EAAc,EAAE,EAAE,MAAM,MAAM,CAAC;AACtC,OAAO,EAIL,gBAAgB,EACjB,MAAM,iCAAiC,CAAC;AACzC,OAAO,EAAE,cAAc,EAAE,cAAc,EAAE,MAAM,uBAAuB,CAAC;AAEvE,OAAO,EAAE,+BAA+B,EAAE,MAAM,4BAA4B,CAAC;AAC7E,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;;;;;;AAQtC,MAAM,OAAO,0BAA0B;IAIrC,YACU,cAA8B,EAC9B,+BAAgE;QADhE,mBAAc,GAAd,cAAc,CAAgB;QAC9B,oCAA+B,GAA/B,+BAA+B,CAAiC;QAJ1E,gBAAW,GAAG,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,CAAC;IAKzC,CAAC;IAEJ,QAAQ;QACN,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;YACnB,oBAAoB,EAAE,IAAI,CAAC,WAAW,CAAC,cAAc;YACrD,kBAAkB,EAAE,gBAAgB,CAAC,QAAQ;YAC7C,OAAO,EAAE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,0BAA0B,CAAC,CAAC,GAAG,CAC9E,CAAC,KAAqB,EAAE,KAAa,EAAE,EAAE,CAAC,CAAC;gBACzC,KAAK,EAAE,KAAK,CAAC,IAAI;gBACjB,OAAO,EAAE,KAAK,CAAC,EAAE,CAAC,QAAQ,EAAE;gBAC5B,OAAO,EAAE,KAAK,GAAG,CAAC;aACnB,CAAC,CAC2C;YAC/C,MAAM,EAAE,iBAAiB;YACzB,OAAO,EAAE,CAAC,WAAsC,EAAE,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC;SAC/E,CAAC,CAAC;IACL,CAAC;IAEO,OAAO,CAAC,WAAsC;QACpD,WAAW,CAAC,eAAe,GAAG,CAAC,WAAW,CAAC,eAAe,EAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC;aACtF,MAAM,CAAC,OAAO,CAAC;aACf,IAAI,CAAC,KAAK,CAAC,CAAC;QAEf,OAAO,IAAI,CAAC,+BAA+B,CAAC,IAAI,CAAC;YAC/C,MAAM,EAAE,IAAI,mBAEL,WAAW,GAEhB,CAAC,YAAY,CAAC,CACf;SACF,CAAC,CAAC;IACL,CAAC;IAED,KAAK;QACH,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;IACxD,CAAC;;uHA1CU,0BAA0B;2GAA1B,0BAA0B,8DCnBvC,wVASA;2FDUa,0BAA0B;kBALtC,SAAS;mBAAC;oBACT,QAAQ,EAAE,wBAAwB;oBAClC,WAAW,EAAE,sCAAsC;oBACnD,SAAS,EAAE,CAAC,sCAAsC,CAAC;iBACpD","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport {\n  IRecordGridColumn,\n  IRecordGridConfig,\n  IRecordGridDataPageParams,\n  RowSelectionMode\n} from '@helix/platform/view/components';\nimport { ActiveModalRef, DismissReasons } from '@bmc-ux/adapt-angular';\nimport { IDataPageResult } from '@helix/platform/shared/api';\nimport { RxRecordInstanceDataPageService } from '@helix/platform/record/api';\nimport { omit, sortBy } from 'lodash';\nimport { ICriteriaField } from '../data-export.types';\n\n@Component({\n  selector: 'dl-export-data-preview',\n  templateUrl: './export-data-preview.component.html',\n  styleUrls: ['./export-data-preview.component.scss']\n})\nexport class ExportDataPreviewComponent implements OnInit {\n  gridConfig: Observable<IRecordGridConfig>;\n  gridContext = this.activeModalRef.getData();\n\n  constructor(\n    private activeModalRef: ActiveModalRef,\n    private rxRecordInstanceDataPageService: RxRecordInstanceDataPageService\n  ) {}\n\n  ngOnInit(): void {\n    this.gridConfig = of({\n      recordDefinitionName: this.gridContext.definitionName,\n      enableRowSelection: RowSelectionMode.Multiple,\n      columns: sortBy(this.gridContext.selectedFields, 'visibleOnPreviewPriority').map(\n        (field: ICriteriaField, index: number) => ({\n          title: field.name,\n          fieldId: field.id.toString(),\n          visible: index < 9\n        })\n      ) as IRecordGridColumn[] as IRecordGridColumn[],\n      styles: 'flex-fill h-100',\n      getData: (queryParams: IRecordGridDataPageParams) => this.getData(queryParams)\n    });\n  }\n\n  private getData(queryParams: IRecordGridDataPageParams): Observable<IDataPageResult> {\n    queryParams.queryExpression = [queryParams.queryExpression, this.gridContext.queryFilter]\n      .filter(Boolean)\n      .join('AND');\n\n    return this.rxRecordInstanceDataPageService.post({\n      params: omit(\n        {\n          ...queryParams\n        },\n        ['searchText']\n      )\n    });\n  }\n\n  close(): void {\n    this.activeModalRef.dismiss(DismissReasons.CLOSE_BTN);\n  }\n}\n","<div class=\"p-4 data-preview-modal-body\">\n  <rx-record-grid [config]=\"gridConfig\"></rx-record-grid>\n</div>\n\n<div class=\"modal-footer\">\n  <button adapt-button type=\"button\" btn-type=\"secondary\" rx-id=\"close-button\" (click)=\"close()\">\n    {{ 'com.bmc.arsys.rx.client.common.close.label' | translate }}\n  </button>\n</div>\n"]}