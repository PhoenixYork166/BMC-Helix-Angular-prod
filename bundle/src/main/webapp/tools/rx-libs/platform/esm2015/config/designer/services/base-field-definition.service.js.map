{"version":3,"file":"base-field-definition.service.js","sourceRoot":"","sources":["../../../../../../../libs/platform/config/designer/services/base-field-definition.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { IFieldOptions } from '@helix/platform/config/api';\nimport { RX_RECORD_DEFINITION } from '@helix/platform/record/api';\nimport { IFormBuilderConfig } from '@helix/platform/shared/api';\nimport {\n  ISelectFormControlOptions,\n  ISwitcherFormControlOptions,\n  ITextFormControlOptions,\n  SelectFormControlComponent,\n  SwitchFormControlComponent,\n  TextFormControlComponent\n} from '@helix/platform/shared/components';\nimport { TranslateService } from '@ngx-translate/core';\nimport { RX_CONFIG_DESIGNER } from '../config-designer.constant';\nimport { Injector } from '@angular/core';\nimport { IValidationIssue, ValidationIssueType } from '@helix/platform/ui-kit';\nimport { IConfigFieldDefinitionModel } from '../config-designer.types';\nimport { trim } from 'lodash';\n\nexport abstract class BaseFieldDefinitionService {\n  protected translateService = this.injector.get(TranslateService);\n\n  private readonly defaultFieldGroupName = this.translateService.instant(\n    'com.bmc.arsys.rx.client.common.general-items.label'\n  );\n\n  abstract readonly dataType: string;\n\n  constructor(private injector: Injector) {}\n\n  getNewFieldDefinitionModel(fieldProperties: Partial<IConfigFieldDefinitionModel>): IConfigFieldDefinitionModel {\n    return {\n      dataType: this.dataType,\n      required: false,\n      defaultValue: null,\n      localeList: [\n        {\n          locale: 'en',\n          fieldGrouping: this.defaultFieldGroupName,\n          settingLabel: fieldProperties.id\n        }\n      ],\n      ...fieldProperties\n    } as IConfigFieldDefinitionModel;\n  }\n\n  getFieldInspectorConfig(options: IFieldOptions): IFormBuilderConfig {\n    return [\n      {\n        label: this.translateService.instant('com.bmc.arsys.rx.client.common.general-items.label'),\n        controls: [\n          {\n            name: 'id',\n            component: TextFormControlComponent,\n            isDisabled: !options.isNew,\n            options: {\n              label: this.translateService.instant('com.bmc.arsys.rx.client.common.field-name.label'),\n              required: true\n            } as ITextFormControlOptions\n          },\n          {\n            name: 'settingLabel',\n            component: TextFormControlComponent,\n            options: {\n              label: this.translateService.instant(\n                'com.bmc.arsys.rx.client.config-designer.config-properties.field-label.label'\n              ),\n              required: true\n            }\n          },\n          {\n            name: 'dataType',\n            component: SelectFormControlComponent,\n            isDisabled: true,\n            options: {\n              label: this.translateService.instant('com.bmc.arsys.rx.client.common.data-type.label'),\n              options: [\n                {\n                  id: RX_CONFIG_DESIGNER.dataTypes.attachment.resourceType,\n                  name: this.translateService.instant(RX_CONFIG_DESIGNER.dataTypes.attachment.labelKey)\n                },\n                {\n                  id: RX_RECORD_DEFINITION.dataTypes.boolean.resourceType,\n                  name: this.translateService.instant(RX_RECORD_DEFINITION.dataTypes.boolean.labelKey)\n                },\n                {\n                  id: RX_RECORD_DEFINITION.dataTypes.character.resourceType,\n                  name: this.translateService.instant(RX_RECORD_DEFINITION.dataTypes.character.labelKey)\n                },\n                {\n                  id: RX_CONFIG_DESIGNER.dataTypes.color.resourceType,\n                  name: this.translateService.instant(RX_CONFIG_DESIGNER.dataTypes.color.labelKey)\n                },\n                {\n                  id: RX_RECORD_DEFINITION.dataTypes.dateOnly.resourceType,\n                  name: this.translateService.instant(RX_RECORD_DEFINITION.dataTypes.dateOnly.labelKey)\n                },\n                {\n                  id: RX_RECORD_DEFINITION.dataTypes.decimal.resourceType,\n                  name: this.translateService.instant(RX_RECORD_DEFINITION.dataTypes.decimal.labelKey)\n                },\n                {\n                  id: RX_RECORD_DEFINITION.dataTypes.integer.resourceType,\n                  name: this.translateService.instant(RX_RECORD_DEFINITION.dataTypes.integer.labelKey)\n                },\n                {\n                  id: RX_CONFIG_DESIGNER.dataTypes.secure.resourceType,\n                  name: this.translateService.instant(RX_CONFIG_DESIGNER.dataTypes.secure.labelKey)\n                },\n                {\n                  id: RX_RECORD_DEFINITION.dataTypes.selection.resourceType,\n                  name: this.translateService.instant(RX_RECORD_DEFINITION.dataTypes.selection.labelKey)\n                }\n              ]\n            } as ISelectFormControlOptions\n          }\n        ]\n      },\n      {\n        label: this.translateService.instant('com.bmc.arsys.rx.client.common.details.label'),\n        controls: [\n          {\n            name: 'required',\n            component: SwitchFormControlComponent,\n            options: {\n              label: this.translateService.instant(\n                'com.bmc.arsys.rx.client.config-designer.config-properties.required-field.label'\n              )\n            } as ISwitcherFormControlOptions\n          },\n          {\n            name: 'keySetting',\n            component: SwitchFormControlComponent,\n            options: {\n              label: this.translateService.instant(\n                'com.bmc.arsys.rx.client.config-designer.config-properties.key-field.label'\n              )\n            } as ISwitcherFormControlOptions\n          }\n        ]\n      }\n    ] as IFormBuilderConfig;\n  }\n\n  validate(fieldModel: IConfigFieldDefinitionModel): IValidationIssue[] {\n    const validationIssues: IValidationIssue[] = [];\n\n    if (!trim(fieldModel.id)) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.cannot-be-blank.message',\n          {\n            propertyName: this.translateService.instant('com.bmc.arsys.rx.client.common.field-name.label')\n          }\n        ),\n        data: {\n          propertyName: 'id',\n          guid: fieldModel.guid\n        }\n      });\n    }\n\n    if (!trim(fieldModel.settingLabel)) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.cannot-be-blank.message',\n          {\n            propertyName: this.translateService.instant(\n              'com.bmc.arsys.rx.client.config-designer.config-properties.field-label.label'\n            )\n          }\n        ),\n        data: {\n          propertyName: 'settingLabel',\n          guid: fieldModel.guid\n        }\n      });\n    }\n\n    return validationIssues;\n  }\n}\n"]}