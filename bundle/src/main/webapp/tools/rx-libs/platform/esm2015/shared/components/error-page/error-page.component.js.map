{"version":3,"file":"error-page.component.js","sourceRoot":"","sources":["../../../../../../../libs/platform/shared/components/error-page/error-page.component.ts","../../../../../../../libs/platform/shared/components/error-page/error-page.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, Inject, OnDestroy, OnInit } from '@angular/core';\nimport { Title } from '@angular/platform-browser';\nimport { ActivatedRoute } from '@angular/router';\nimport { IErrorPageData } from './error-page.interfaces';\nimport { takeUntil, switchMap, map, tap } from 'rxjs/operators';\nimport { ReplaySubject, forkJoin } from 'rxjs';\nimport { DOCUMENT } from '@angular/common';\nimport {\n  RxGlobalCacheService,\n  RxCurrentUserService,\n  RxAngularApplicationService,\n  RX_APPLICATION,\n  IBundleDescriptor,\n  RxAuthService\n} from '@helix/platform/shared/api';\nimport { remove, sortBy, filter } from 'lodash';\n\n@Component({\n  selector: 'rx-error-page',\n  templateUrl: './error-page.component.html',\n  styleUrls: ['error-page.component.scss']\n})\nexport class RxErrorPageComponent implements OnInit, OnDestroy {\n  data: IErrorPageData;\n  showSignInLink = false;\n  showApplications = false;\n\n  applications$ = this.rxGlobalCacheService.getBundleDescriptors().pipe(\n    switchMap((bundleDescriptors: IBundleDescriptor[]) => {\n      const applicationBundleDescriptors = filter(bundleDescriptors, { isApplication: true, isLicensed: true });\n\n      remove(applicationBundleDescriptors, { id: RX_APPLICATION.settingsBundleId });\n\n      if (!this.rxCurrentUserService.isAdministrator()) {\n        remove(applicationBundleDescriptors, { id: RX_APPLICATION.dataloadBundleId });\n      }\n\n      if (!this.rxCurrentUserService.isAdministrator() && !this.rxCurrentUserService.isBusinessAnalyst()) {\n        remove(applicationBundleDescriptors, { id: RX_APPLICATION.innovationStudioBundleId });\n      }\n\n      const applications = sortBy(\n        applicationBundleDescriptors,\n        (bundleDescriptor: IBundleDescriptor) => bundleDescriptor.friendlyName\n      ).map((app: IBundleDescriptor) =>\n        this.rxAngularApplicationService.isAngularJsApplication(app.id).pipe(\n          map((isAngularJsApplication: boolean) => {\n            let url: string;\n\n            if (app.hasCustomEntryPoint && app.id !== RX_APPLICATION.innovationStudioBundleId) {\n              url = `/${app.id}/index.html`;\n            } else if (isAngularJsApplication) {\n              url = `/innovationsuite/index.html#/${app.id}`;\n            } else {\n              url = `/helix/index.html#/${app.id}`;\n            }\n\n            return {\n              id: app.id,\n              friendlyName: app.friendlyName,\n              url\n            };\n          })\n        )\n      );\n\n      return forkJoin(applications);\n    }),\n    tap(() => (this.rxGlobalCacheService.applicationId = 'unknown-application'))\n  );\n\n  private destroyed$ = new ReplaySubject<boolean>(1);\n\n  constructor(\n    @Inject(DOCUMENT) private document: any,\n    private title: Title,\n    private route: ActivatedRoute,\n    private rxAuthService: RxAuthService,\n    private rxGlobalCacheService: RxGlobalCacheService,\n    private rxCurrentUserService: RxCurrentUserService,\n    private rxAngularApplicationService: RxAngularApplicationService\n  ) {\n    this.document.body.style.overflow = 'hidden';\n  }\n\n  ngOnInit() {\n    this.route.data.pipe(takeUntil(this.destroyed$)).subscribe((data) => {\n      this.data = { ...data } as IErrorPageData;\n      this.title.setTitle(this.data.errorTitle);\n      this.showSignInLink = this.data.showSignInLink;\n      this.showApplications = this.data.showApplications ?? false;\n    });\n  }\n\n  logout(): void {\n    this.rxAuthService.logout().subscribe();\n  }\n\n  ngOnDestroy(): void {\n    this.document.body.style.removeProperty('overflow');\n    this.destroyed$.next(true);\n    this.destroyed$.complete();\n  }\n}\n","<div class=\"error-wrapper\">\n  <ng-container *ngIf=\"!showApplications\">\n    <h2>{{ this.data.errorTitle }}</h2>\n    <div [innerHTML]=\"this.data.errorMessage\"></div>\n  </ng-container>\n\n  <div *ngIf=\"showApplications\">\n    <h3>\n      The page you are trying to reach does not exist. Please open one of the applications below and bookmark it for\n      future reference.\n    </h3>\n\n    <ul>\n      <li *ngFor=\"let app of applications$ | async\">\n        <a [href]=\"app.url\">{{ app.friendlyName }}</a>\n      </li>\n    </ul>\n  </div>\n</div>\n"]}