{"version":3,"file":"shell-base.class.js","sourceRoot":"","sources":["../../../../../../../libs/platform/shared/components/shell/shell-base.class.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable, Injector, OnDestroy, OnInit, Renderer2, TemplateRef } from '@angular/core';\nimport { NavigationCancel, NavigationEnd, NavigationError, NavigationStart, Router } from '@angular/router';\nimport { AdaptNavigationComponent, AdaptTranslateService, NavigationAction, ProfileModel } from '@bmc-ux/adapt-angular';\nimport { RxRecordInstanceService } from '@helix/platform/record/api';\nimport {\n  RX_APPLICATION,\n  RX_USER,\n  RxAngularApplicationService,\n  RxAuthService,\n  RxComponentCanDeactivateGuard,\n  RxCurrentUserService,\n  RxFeatureService,\n  RxGlobalCacheService,\n  RxSystemConfigurationService\n} from '@helix/platform/shared/api';\nimport { IRxShellConfig, IRxShellMenuItem } from '@helix/platform/view/api';\nimport { TranslateService } from '@ngx-translate/core';\nimport { filter as _filter, find, get, includes, isBoolean, isEmpty, lowerCase, noop, remove, sortBy } from 'lodash';\nimport {\n  combineLatest,\n  forkJoin,\n  from,\n  merge,\n  NEVER,\n  Observable,\n  of,\n  ReplaySubject,\n  Subject,\n  Subscription\n} from 'rxjs';\nimport {\n  catchError,\n  defaultIfEmpty,\n  filter,\n  map,\n  shareReplay,\n  skip,\n  switchMap,\n  take,\n  takeUntil,\n  tap,\n  withLatestFrom\n} from 'rxjs/operators';\nimport { RxGainsightConfiguratorService } from './gainsight/gainsight-configurator.service';\nimport { IRxShellApplication } from './shell-component.types';\nimport { RX_USER_MESSAGE } from './user-messages/user-message.constants';\nimport { RxUserMessageService } from './user-messages/user-message.service';\n\n@Injectable()\nexport abstract class ShellBase implements OnInit, OnDestroy {\n  protected abstract adaptNavigation: AdaptNavigationComponent;\n  protected abstract userMessagesPopover: TemplateRef<any>;\n\n  isShellInitialized = false;\n\n  busySubscription: Subscription;\n\n  protected currentMenuItemId: number = null;\n  protected translateService: TranslateService = this.injector.get(TranslateService);\n  protected flattenedMenuItems: IRxShellMenuItem[] = [];\n\n  protected rxComponentCanDeactivateGuard: RxComponentCanDeactivateGuard =\n    this.injector.get(RxComponentCanDeactivateGuard);\n\n  protected rxUserMessageService: RxUserMessageService = this.injector.get(RxUserMessageService);\n  protected rxAuthService: RxAuthService = this.injector.get(RxAuthService);\n  protected rxCurrentUserService: RxCurrentUserService = this.injector.get(RxCurrentUserService);\n  protected rxRecordInstanceService: RxRecordInstanceService = this.injector.get(RxRecordInstanceService);\n  protected rxGlobalCacheService: RxGlobalCacheService = this.injector.get(RxGlobalCacheService);\n  protected rxAngularApplicationService: RxAngularApplicationService = this.injector.get(RxAngularApplicationService);\n  protected rxSystemConfigurationService: RxSystemConfigurationService =\n    this.injector.get(RxSystemConfigurationService);\n\n  protected rxFeatureService: RxFeatureService = this.injector.get(RxFeatureService);\n  protected adaptTranslateService: AdaptTranslateService = this.injector.get(AdaptTranslateService);\n\n  protected rxGainsightConfiguratorService: RxGainsightConfiguratorService =\n    this.injector.get(RxGainsightConfiguratorService);\n\n  protected router: Router = this.injector.get(Router);\n\n  protected applicationDescriptor$ = this.rxGlobalCacheService.getApplicationBundleDescriptor();\n\n  private destroyed$ = new ReplaySubject<boolean>(1);\n  bundleDescriptors: IRxShellApplication[];\n\n  private removeWindowBlurListener: () => void;\n\n  private helixPortalUrl: string;\n\n  private navigationEnd$ = this.router.events.pipe(\n    filter<NavigationEnd>((event) => event instanceof NavigationEnd),\n    filter((event) => event.url !== '/unknown-application')\n  );\n\n  private closeBannerSubject = new Subject<boolean>();\n\n  hasBanner$ = merge(\n    this.rxGainsightConfiguratorService.gainsightInitConfiguration$.pipe(\n      filter((gainsightConfiguration) => Boolean(gainsightConfiguration)),\n      map((gainsightConfiguration) => gainsightConfiguration.displayBanner),\n      defaultIfEmpty(false)\n    ),\n    this.closeBannerSubject.pipe(map((value) => !value))\n  ).pipe(shareReplay(1));\n\n  private translations = this.adaptTranslateService.getCurrentLanguage();\n\n  alertText = this.translations['adapt.agreement.navigation.alertText'];\n  alertLinkText = this.translations['adapt.agreement.navigation.alertLinkText'];\n\n  protected shellConfig$ = this.getShellConfig();\n\n  private applicationSwitcherActionItems$ = combineLatest([\n    this.applicationDescriptor$,\n    this.rxGlobalCacheService.getBundleDescriptors(),\n    this.shellConfig$,\n    this.rxSystemConfigurationService.queryConfiguration(['Helix-Portal-URL']).pipe(\n      map((value) => get(value, '[0].value')),\n      catchError(() => of(null))\n    )\n  ]).pipe(\n    take(1),\n    switchMap(([currentBundleDescriptor, bundleDescriptors, shellConfig, helixPortalUrl]) => {\n      if (shellConfig.allowAppSwitching) {\n        const applicationList = _filter(bundleDescriptors, { isApplication: true, isLicensed: true });\n\n        this.bundleDescriptors = bundleDescriptors;\n        this.helixPortalUrl = helixPortalUrl as string;\n\n        remove(applicationList, currentBundleDescriptor);\n        remove(applicationList, { id: RX_APPLICATION.settingsBundleId });\n\n        if (!this.rxCurrentUserService.isAdministrator()) {\n          remove(applicationList, { id: RX_APPLICATION.dataloadBundleId });\n        }\n\n        if (!this.rxCurrentUserService.isAdministrator() && !this.rxCurrentUserService.isBusinessAnalyst()) {\n          remove(applicationList, { id: RX_APPLICATION.innovationStudioBundleId });\n        }\n\n        remove(applicationList, { showInAppLauncher: false });\n\n        const optedInApplications = applicationList.map((app) =>\n          this.rxAngularApplicationService.isAngularJsApplication(app.id).pipe(\n            map((isAngularJsApplication) => ({\n              id: app.id,\n              friendlyName: app.localizedDisplayName || app.friendlyName,\n              isAngularJsApplication\n            }))\n          )\n        );\n\n        return forkJoin(optedInApplications);\n      } else {\n        return of([]);\n      }\n    }),\n    map((applicationList) => {\n      if (\n        includes(['Fixed', 'Floating', 'Bundled'], this.rxCurrentUserService.get().licenseType) &&\n        this.helixPortalUrl\n      ) {\n        applicationList.push({\n          friendlyName: this.translateService.instant(\n            'com.bmc.arsys.rx.client.shell.application-launcher.bmc-helix-dashboard.label'\n          ),\n          url: `${this.helixPortalUrl}/dashboards`\n        });\n      }\n\n      if (applicationList.length) {\n        return {\n          name: this.translateService.instant('com.bmc.arsys.rx.client.shell.application-launcher.label'),\n          tooltip: this.translateService.instant('com.bmc.arsys.rx.client.shell.application-launcher.label'),\n          className: 'd-icon-tiles',\n          switcher: {\n            allItems: {\n              items: sortBy(\n                applicationList\n                  .filter((app) => app.id !== this.rxGlobalCacheService.applicationId)\n                  .map((app) => {\n                    return {\n                      name: app.friendlyName,\n                      action: this.launchApplication.bind(this, app.id, app.isAngularJsApplication, app.url)\n                    };\n                  }),\n                (application) => lowerCase(application.name)\n              ) as any\n            },\n            recentItems: {} as any\n          }\n        };\n      } else {\n        return {};\n      }\n    })\n  );\n\n  private showUserMessagesAction: NavigationAction = {\n    name: this.translateService.instant(RX_USER_MESSAGE.title),\n    tooltip: this.translateService.instant(RX_USER_MESSAGE.title),\n    count: 0,\n    action: noop,\n    className: 'd-icon-bell_o'\n  };\n\n  private administrationSettingsAction: NavigationAction = {\n    name: this.translateService.instant('com.bmc.arsys.rx.client.common.settings.label'),\n    tooltip: this.translateService.instant('com.bmc.arsys.rx.client.common.settings.label'),\n    route: `/${this.rxGlobalCacheService.applicationId}/settings`,\n    className: 'd-icon-gear'\n  };\n\n  navigationMenuItems$: Observable<IRxShellMenuItem[]>;\n\n  navigationActionItems$: Observable<NavigationAction[]>;\n\n  brandingInfo$ = this.applicationDescriptor$.pipe(\n    map((applicationDescriptor) => ({\n      logoClass: 'logo-helix',\n      productName: applicationDescriptor.localizedDisplayName || applicationDescriptor.friendlyName,\n      hideMobileLogo: false,\n      switcher: {\n        filter: {\n          placeholder: this.translateService.instant('com.bmc.arsys.rx.client.common.search.label')\n        }\n      }\n    }))\n  );\n\n  userProfileMenu$: Observable<ProfileModel>;\n\n  protected constructor(protected injector: Injector) {\n    this.navigationEnd$.pipe(skip(1), takeUntil(this.destroyed$)).subscribe({\n      next: () => {\n        this.highlightMenuItem(this.getActiveNavigationMenuItem());\n      },\n      complete: () => {\n        this.rxUserMessageService.cancelMessagePolling();\n      }\n    });\n\n    // ADAPT dropdowns listen to the click events and close themselves when the event is fired.\n    // When user clicks inside an iframe though, the event is not propagated to the main window and the\n    // dropdowns remain open.\n    // Here we simulate the click on the document of the main window to close the dropdowns.\n    this.removeWindowBlurListener = injector.get(Renderer2).listen('window', 'blur', () => {\n      document.body.click();\n    });\n  }\n\n  ngOnInit() {\n    this.showUserMessagesAction.popover = this.userMessagesPopover;\n\n    this.rxUserMessageService.messageCount$.subscribe((messageCount) => {\n      this.showUserMessagesAction.count = messageCount;\n    });\n\n    this.navigationMenuItems$ = this.getNavigationMenuItems().pipe(\n      tap(() => {\n        // We perform a setTimeout according to Adapt documentation.\n        // Else on smaller screens the menus might be displayed horizontally\n        // in the shell rather than vertically for smaller screens.\n        // https://github.bmc.com/pages/bmc-ux/adapt-angular/#/components/navigation\n        setTimeout(() => {\n          this.adaptNavigation.checkForHamburger();\n          this.isShellInitialized = true;\n\n          const activeNavigationMenuItem = this.getActiveNavigationMenuItem();\n\n          this.highlightMenuItem(activeNavigationMenuItem);\n        });\n      })\n    );\n\n    this.navigationActionItems$ = combineLatest([\n      this.shellConfig$,\n      this.getNavigationActionItems(),\n      this.applicationSwitcherActionItems$\n    ]).pipe(\n      map(([shellConfig, navigationActionItems, applicationSwitcherActionItems]) => [\n        ...navigationActionItems,\n        this.showUserMessagesAction,\n        ...(shellConfig.administrationSettingsState ? [this.administrationSettingsAction] : []),\n        applicationSwitcherActionItems\n      ]),\n      takeUntil(this.destroyed$)\n    );\n\n    const isGainsightFeatureEnabled = this.rxFeatureService.isFeatureEnabled('DRD21-11744');\n\n    this.userProfileMenu$ = combineLatest([this.rxGainsightConfiguratorService.gainsightInitConfiguration$, this.getUserMenuItems()]).pipe(\n      tap(([gainsightConfig, userMenuItems]) => {\n        const analyticsMenuItem = find(userMenuItems, { id: 0 });\n\n        if (analyticsMenuItem) {\n          const shouldHideAnalyticsMenuItem =\n            !isGainsightFeatureEnabled ||\n            !gainsightConfig.settings.enableGainsight ||\n            isEmpty(gainsightConfig.productTag);\n\n          analyticsMenuItem.hide = shouldHideAnalyticsMenuItem;\n        }\n      }),\n      map(([gainsightConfig, userMenuItems]) => {\n        const currentUser = this.rxCurrentUserService.get();\n\n        const userAvatarUrl = currentUser.personInstanceId\n          ? this.rxRecordInstanceService.getAttachmentDownloadUrl(\n              RX_USER.userProfileRecordDefinitionName,\n              RX_USER.userProfilePictureFieldId,\n              currentUser.personInstanceId\n            )\n          : '';\n\n        return {\n          desc: this.translateService.instant('com.bmc.arsys.rx.client.shell.user-profile.signedin.label'),\n          userName: currentUser.fullName,\n          image: userAvatarUrl,\n          typeLong: true,\n          inverted: false,\n          signOut: {\n            title: this.translateService.instant('com.bmc.arsys.rx.client.common.sign-out.label'),\n            action: this.logout.bind(this)\n          },\n          menu: userMenuItems\n        };\n      })\n    ) as Observable<any>;\n\n    this.router.events.pipe(takeUntil(this.destroyed$)).subscribe((event) => {\n      switch (true) {\n        case event instanceof NavigationStart: {\n          this.busySubscription = NEVER.subscribe();\n          break;\n        }\n\n        case event instanceof NavigationEnd:\n        case event instanceof NavigationCancel:\n        case event instanceof NavigationError: {\n          this.busySubscription?.unsubscribe();\n          break;\n        }\n\n        default: {\n          break;\n        }\n      }\n    });\n  }\n\n  protected highlightMenuItem(menuItem: IRxShellMenuItem): void {\n    if (menuItem) {\n      this.currentMenuItemId = menuItem.id;\n      this.adaptNavigation.selectMenuItem(this.currentMenuItemId);\n    } else {\n      const lastMenuItem = this.adaptNavigation.searchTree(this.adaptNavigation.menuModel, this.currentMenuItemId);\n\n      if (lastMenuItem) {\n        lastMenuItem.active = false;\n\n        if (lastMenuItem.parent) {\n          lastMenuItem.parent.active = false;\n        }\n      }\n\n      this.currentMenuItemId = null;\n      this.adaptNavigation.currentActiveId = null;\n    }\n  }\n\n  protected logout(): void {\n    let canDeactivate = this.rxComponentCanDeactivateGuard.canDeactivate();\n\n    if (isBoolean(canDeactivate)) {\n      canDeactivate = of(canDeactivate);\n    }\n\n    from(canDeactivate)\n      .pipe(\n        filter(Boolean),\n        tap(() => {\n          this.rxComponentCanDeactivateGuard.disable();\n        }),\n        switchMap(() => this.rxAuthService.logout())\n      )\n      .subscribe();\n  }\n\n  protected abstract getActiveNavigationMenuItem(): IRxShellMenuItem;\n\n  protected abstract getNavigationActionItems(): Observable<NavigationAction[]>;\n\n  protected abstract getNavigationMenuItems(): Observable<IRxShellMenuItem[]>;\n\n  protected abstract getUserMenuItems(): Observable<IRxShellMenuItem[]>;\n\n  protected abstract getShellConfig(): Observable<IRxShellConfig>;\n\n  protected launchApplication(bundleId: string, isAngularJsApplication: boolean, portalUrl: string): void {\n    let url;\n\n    if (portalUrl) {\n      url = portalUrl;\n    } else {\n      const application = find(this.bundleDescriptors, { id: bundleId });\n\n      if (application.hasCustomEntryPoint && application.id !== RX_APPLICATION.innovationStudioBundleId) {\n        url = `/${bundleId}/index.html`;\n      } else if (isAngularJsApplication) {\n        url = `/innovationsuite/index.html#/${bundleId}`;\n      } else {\n        url = `/helix/index.html#/${bundleId}`;\n      }\n    }\n\n    window.open(url);\n  }\n\n  closeBanner(): void {\n    this.closeBannerSubject.next(true);\n  }\n\n  ngOnDestroy(): void {\n    this.removeWindowBlurListener();\n    this.rxUserMessageService.cancelMessagePolling();\n    this.closeBannerSubject.complete();\n\n    this.destroyed$.next();\n    this.destroyed$.complete();\n  }\n}\n"]}