{"version":3,"file":"approval-request-general-details.component.js","sourceRoot":"","sources":["../../../../../../../../libs/platform/approval/components/approval-console/approval-request-general-details/approval-request-general-details.component.ts","../../../../../../../../libs/platform/approval/components/approval-console/approval-request-general-details/approval-request-general-details.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input, OnChanges, SimpleChanges } from '@angular/core';\nimport { RX_APPROVAL_CONSOLE } from '../approval-console.constant';\nimport {\n  ApprovalGridType,\n  ApprovalRequestStatus,\n  IApprovalRequest,\n  IRequestAdditionalFields\n} from '../approval-console.types';\nimport { combineLatest, EMPTY, NEVER, Observable, of, Subject, Subscription } from 'rxjs';\nimport { map, switchMap, tap } from 'rxjs/operators';\nimport { IValueWithLabel } from '@helix/platform/utils';\nimport { RxApprovalConsoleService } from '../approval-console.service';\nimport { forEach } from 'lodash';\nimport { DatePipe } from '@angular/common';\nimport { TranslateService } from '@ngx-translate/core';\nimport { RxDefinitionNameService } from '@helix/platform/shared/api';\nimport { RxApprovalConsoleHelperService } from '../approval-console-helper.service';\n\n@Component({\n  selector: 'rx-approval-request-general-details',\n  templateUrl: './approval-request-general-details.component.html',\n  styleUrls: ['./approval-request-general-details.component.scss']\n})\nexport class ApprovalRequestGeneralDetailsComponent implements OnChanges {\n  @Input()\n  approvalRequest: IApprovalRequest;\n\n  @Input()\n  gridType: ApprovalGridType;\n\n  private approvalRequest$ = new Subject<IApprovalRequest>();\n  readonly statuses: any;\n  busy: Subscription;\n\n  allRequestFields$: Observable<IValueWithLabel[]> = this.approvalRequest$.pipe(\n    tap(() => {\n      this.busy = NEVER.subscribe();\n    }),\n    switchMap((currentRequest: IApprovalRequest) =>\n      this.gridType === ApprovalGridType.NeedAttentionRequests\n        ? this.rxApprovalConsoleService.getCurrentRequestDetails(\n            currentRequest[RX_APPROVAL_CONSOLE.needAttentionRequestsGrid.fields.requestID],\n            currentRequest[RX_APPROVAL_CONSOLE.needAttentionRequestsGrid.fields.application]\n          )\n        : of(currentRequest)\n    ),\n    switchMap((approvalRequest: IApprovalRequest) =>\n      combineLatest([\n        of(approvalRequest as IApprovalRequest),\n        this.rxApprovalConsoleService.getRequestLabelDetails(approvalRequest.application, approvalRequest.process)\n      ])\n    ),\n    map(([approvalRequest, requestLabelDetails]) => {\n      const allFields: IValueWithLabel[] = [\n        {\n          label: this.translateService.instant('com.bmc.arsys.rx.client.approval.console.request-id.label'),\n          value: approvalRequest.resolvedDisplayValues.request || approvalRequest.request\n        },\n        {\n          label: this.translateService.instant('com.bmc.arsys.rx.client.approval.console.requester.label'),\n          value: approvalRequest.resolvedDisplayValues.requester || approvalRequest.requester\n        },\n\n        {\n          label: this.translateService.instant('com.bmc.arsys.rx.client.approval.console.request-date.label'),\n          value: this.datePipe.transform(approvalRequest.createDateSig, 'medium')\n        },\n\n        {\n          label: this.translateService.instant('com.bmc.arsys.rx.client.common.description.label'),\n          value: approvalRequest.resolvedDisplayValues.summary || approvalRequest.summary\n        },\n\n        {\n          label: this.translateService.instant('com.bmc.arsys.rx.client.common.status.label'),\n          value: this.statuses[approvalRequest.status]\n        },\n\n        {\n          label: this.translateService.instant('com.bmc.arsys.rx.client.approval.console.status-date.label'),\n          value: this.datePipe.transform(approvalRequest.sigTermStateDate, 'medium')\n        }\n      ];\n\n      if (approvalRequest.actionDate) {\n        allFields.push({\n          label: '',\n          value: this.datePipe.transform(approvalRequest.actionDate, 'medium')\n        });\n      }\n\n      if (approvalRequest.justification) {\n        allFields.push({\n          label: this.translateService.instant('com.bmc.arsys.rx.client.approval.justification-reason.label'),\n          value: approvalRequest.justification\n        });\n      }\n\n      const labelValues: IRequestAdditionalFields = {\n        14508: approvalRequest.resolvedDisplayValues.otherDetail1,\n        14509: approvalRequest.resolvedDisplayValues.otherDetail2,\n        14510: approvalRequest.resolvedDisplayValues.otherDetail3,\n        14511: approvalRequest.resolvedDisplayValues.otherDetail4\n      };\n\n      forEach(requestLabelDetails, (label, key) => {\n        if (label) {\n          allFields.push({\n            label: requestLabelDetails[key],\n            value: this.rxApprovalConsoleHelperService.formatValue(labelValues[key])\n          });\n        }\n      });\n\n      allFields.push({\n        label: this.translateService.instant('com.bmc.arsys.rx.client.approval.console.activity-log.label'),\n        value: `${this.rxDefinitionNameService.getDisplayName(approvalRequest.application)} ${\n          approvalRequest.resolvedDisplayValues.request || approvalRequest.request\n        }, ${approvalRequest.resolvedDisplayValues.requester || approvalRequest.requester}`\n      });\n\n      return allFields;\n    }),\n    tap(() => {\n      this.busy = EMPTY.subscribe();\n    })\n  );\n\n  constructor(\n    private rxApprovalConsoleHelperService: RxApprovalConsoleHelperService,\n    private rxDefinitionNameService: RxDefinitionNameService,\n    private datePipe: DatePipe,\n    private translateService: TranslateService,\n    private rxApprovalConsoleService: RxApprovalConsoleService\n  ) {\n    this.statuses = {\n      [ApprovalRequestStatus.Pending]: this.translateService.instant(\n        RX_APPROVAL_CONSOLE.approvalRequestTypes.pending.labelKey\n      ),\n      [ApprovalRequestStatus.RequestMoreInfo]: this.translateService.instant(\n        RX_APPROVAL_CONSOLE.approvalRequestTypes.moreInfo.labelKey\n      ),\n      [ApprovalRequestStatus.Hold]: this.translateService.instant(\n        RX_APPROVAL_CONSOLE.approvalRequestTypes.onHold.labelKey\n      ),\n      [ApprovalRequestStatus.MoreInfo]: this.translateService.instant(\n        RX_APPROVAL_CONSOLE.approvalRequestTypes.moreInfo.labelKey\n      ),\n      [ApprovalRequestStatus.NeedsAttention]: this.translateService.instant(\n        RX_APPROVAL_CONSOLE.approvalRequestTypes.needAttention.labelKey\n      ),\n      [ApprovalRequestStatus.Approved]: this.translateService.instant(\n        RX_APPROVAL_CONSOLE.approvalRequestTypes.approved.labelKey\n      ),\n      [ApprovalRequestStatus.Rejected]: this.translateService.instant(\n        RX_APPROVAL_CONSOLE.approvalRequestTypes.rejected.labelKey\n      ),\n      [ApprovalRequestStatus.Cancelled]: this.translateService.instant(\n        RX_APPROVAL_CONSOLE.approvalRequestTypes.cancelled.labelKey\n      ),\n      [ApprovalRequestStatus.Error]: this.translateService.instant(\n        RX_APPROVAL_CONSOLE.approvalRequestTypes.error.labelKey\n      ),\n      [ApprovalRequestStatus.Closed]: this.translateService.instant(\n        RX_APPROVAL_CONSOLE.approvalRequestTypes.closed.labelKey\n      )\n    };\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.approvalRequest?.currentValue) {\n      this.approvalRequest$.next(changes.approvalRequest.currentValue);\n    }\n  }\n}\n","<rx-busy-indicator [options]=\"{ busy: busy }\"></rx-busy-indicator>\n\n<adapt-empty-state\n  type=\"alerts\"\n  *ngIf=\"!approvalRequest\"\n  label=\"{{ 'com.bmc.arsys.rx.client.approval.console.no-request-selected.message' | translate }}\"\n></adapt-empty-state>\n\n<div [hidden]=\"!approvalRequest\" *ngIf=\"allRequestFields$ | async as requestFields\" class=\"pt-2 pl-3\">\n  <rx-read-only-field\n    *ngFor=\"let field of requestFields\"\n    class=\"d-block form-group\"\n    label=\"{{ field.label }}\"\n    value=\"{{ field.value }}\"\n  ></rx-read-only-field>\n</div>\n"]}