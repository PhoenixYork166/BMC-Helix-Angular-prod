{"version":3,"file":"helix-platform-security-login.js","sources":["../../../../libs/platform/security/login/login-page/login-page.component.ts","../../../../libs/platform/security/login/login-page/login-page.component.html","../../../../libs/platform/security/login/login-page/login-page-routing.module.ts","../../../../libs/platform/security/login/login-page/login-page.module.ts","../../../../libs/platform/security/login/helix-platform-security-login.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport { Title } from '@angular/platform-browser';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { IBundleDescriptor, RxAuthService, RxBundleService } from '@helix/platform/shared/api';\nimport { TranslateService } from '@ngx-translate/core';\nimport { get } from 'lodash';\nimport { EMPTY, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\n\n@Component({\n  selector: 'rx-login-page',\n  templateUrl: './login-page.component.html'\n})\nexport class LoginPageComponent {\n  userName: string;\n  userPassword: string;\n  timeout: any;\n  isLoading = false;\n  bundleFriendlyName = '';\n  shouldReloadPage = true;\n  areStylesLoaded = false;\n\n  footerItems = {\n    content: {\n      copyright: 'Copyright 1997 - 2023 BMC Software, Inc.',\n      info: this.translateService.instant('login.trademark'),\n      helixLogo: true\n    }\n  };\n\n  constructor(\n    private activatedRoute: ActivatedRoute,\n    private router: Router,\n    private title: Title,\n    private rxAuthService: RxAuthService,\n    private rxBundleService: RxBundleService,\n    private translateService: TranslateService\n  ) {\n    this.shouldReloadPage = get(this.router.getCurrentNavigation(), 'extras.state.shouldReloadPage');\n\n    if (this.shouldReloadPage) {\n      window.location.reload();\n    } else {\n      this.title.setTitle('Login');\n\n      this.activatedRoute.paramMap.subscribe((params) => {\n        const bundleId = params.get('bundleId');\n\n        this.rxBundleService\n          .getFromJsonp(bundleId)\n          .pipe(\n            catchError(() => {\n              this.router.navigate(['unknown-application']);\n\n              return EMPTY;\n            })\n          )\n          .subscribe((bundleDescriptor: IBundleDescriptor) => {\n            if (bundleDescriptor.isApplication) {\n              this.bundleFriendlyName = bundleDescriptor.friendlyName;\n              this.title.setTitle(`Login - ${this.bundleFriendlyName}`);\n            } else {\n              this.router.navigate(['unknown-application']);\n            }\n          });\n      });\n    }\n  }\n\n  login(): void {\n    this.isLoading = true;\n\n    this.rxAuthService\n      .login(this.userName, this.userPassword)\n      .pipe(\n        catchError((err) => {\n          this.isLoading = false;\n\n          return throwError(err);\n        })\n      )\n      .subscribe();\n  }\n}\n","<link rel=\"stylesheet\" href=\"/helix/assets/adapt-css/dist/css/adapt-css-bs4.min.css\" (load)=\"areStylesLoaded = true\" />\n\n<adapt-login\n  productName=\"{{ bundleFriendlyName }}\"\n  logoClass=\"logo-bmc-helix logo-light\"\n  [footerConfig]=\"footerItems\"\n  *ngIf=\"!shouldReloadPage && areStylesLoaded\"\n>\n  <form class=\"form\" novalidate autocomplete=\"off\" method=\"post\">\n    <adapt-rx-textfield\n      class=\"form-group textfield\"\n      rx-id=\"username\"\n      [label]=\"'login.username' | translate\"\n      [name]=\"'username'\"\n      [placeholder]=\"'login.username' | translate\"\n      [autofocus]=\"true\"\n      [(ngModel)]=\"userName\"\n    >\n    </adapt-rx-textfield>\n\n    <adapt-rx-textfield\n      class=\"form-group textfield\"\n      rx-id=\"password\"\n      [isPassword]=\"true\"\n      [label]=\"'login.password' | translate\"\n      [placeholder]=\"'login.password' | translate\"\n      autocomplete=\"off\"\n      [(ngModel)]=\"userPassword\"\n      [ngModelOptions]=\"{ standalone: true }\"\n    >\n    </adapt-rx-textfield>\n\n    <button\n      adapt-button\n      btn-type=\"primary\"\n      size=\"block\"\n      rx-id=\"sign-in-button\"\n      type=\"submit\"\n      class=\"form__button mb-0\"\n      (click)=\"login()\"\n      [disabled]=\"!userName || isLoading\"\n    >\n      {{ 'login.login' | translate }}\n    </button>\n  </form>\n</adapt-login>\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { RxLoginLocalizationResolver, RxApplicationLoaderResolver } from '@helix/platform/shared/api';\nimport { LoginPageComponent } from './login-page.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LoginPageComponent,\n    resolve: {\n      loader: RxApplicationLoaderResolver,\n      RxLoginLocalizationResolver\n    },\n    pathMatch: 'full'\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class LoginPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { AdaptButtonModule, AdaptLoginPageModule, AdaptRxTextfieldModule } from '@bmc-ux/adapt-angular';\nimport { AdaptTextFieldModule } from '@bmc-ux/obsolete';\nimport { TranslateModule } from '@ngx-translate/core';\n\nimport { LoginPageRoutingModule } from './login-page-routing.module';\nimport { LoginPageComponent } from './login-page.component';\n\n@NgModule({\n  declarations: [LoginPageComponent],\n  imports: [\n    CommonModule,\n    LoginPageRoutingModule,\n    TranslateModule,\n    FormsModule,\n    AdaptLoginPageModule,\n    AdaptTextFieldModule,\n    AdaptButtonModule,\n    AdaptRxTextfieldModule\n  ]\n})\nexport class LoginPageModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}