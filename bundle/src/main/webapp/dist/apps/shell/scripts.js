if(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define("rxjs",["exports"],e):e(t.rxjs={})}(this,function(t){function e(t,e){function n(){this.constructor=t}Rt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function n(t){return"function"==typeof t}function i(t){setTimeout(function(){throw t},0)}function r(t){return null!==t&&"object"==typeof t}function o(t){return t.reduce(function(t,e){return t.concat(e instanceof Kt?e.errors:e)},[])}function s(t){for(;t;){var e=t.destination,n=t.isStopped;if(t.closed||n)return!1;t=e&&e instanceof jt?e:null}return!0}function a(t){return t}function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return c(t)}function c(t){return 0===t.length?a:1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}}function u(t){if(t||(t=Mt.Promise||Promise),!t)throw Error("no Promise impl found");return t}function h(){return function(t){return t.lift(new Yt(t))}}function d(t){return t?function(t){return new Vt(function(e){return t.schedule(function(){return e.complete()})})}(t):he}function f(t){return t&&"function"==typeof t.schedule}function p(t,e){return new Vt(function(n){var i=new Bt,r=0;return i.add(e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||i.add(this.schedule()))})),i})}function m(t,e){return e?p(t,e):new Vt(de(t))}function v(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return f(e=t[t.length-1])?(t.pop(),p(t,e)):m(t)}function y(t,e){return new Vt(e?function(n){return e.schedule(b,0,{error:t,subscriber:n})}:function(e){return e.error(t)})}function b(t){t.subscriber.error(t.error)}function C(t){return t in Te&&(delete Te[t],!0)}function I(){}function E(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new Ke(t,e))}}function T(t){var e=this,n=t.args,i=t.subscriber,r=(t=t.params).callbackFunc,o=t.context,s=t.scheduler,a=t.subject;if(!a){a=t.subject=new Ce;try{r.apply(o,n.concat([function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.add(s.schedule(w,0,{value:1>=t.length?t[0]:t,subject:a}))}]))}catch(l){a.error(l)}}this.add(a.subscribe(i))}function w(t){var e=t.subject;e.next(t.value),e.complete()}function x(t){var e=this,n=t.params,i=t.subscriber;t=t.context;var r=n.callbackFunc,o=n.args,s=n.scheduler,a=n.subject;if(!a){a=n.subject=new Ce;try{r.apply(t,o.concat([function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(n=t.shift())?e.add(s.schedule(D,0,{err:n,subject:a})):e.add(s.schedule(_,0,{value:1>=t.length?t[0]:t,subject:a}))}]))}catch(l){this.add(s.schedule(D,0,{err:l,subject:a}))}}this.add(a.subscribe(i))}function _(t){var e=t.subject;e.next(t.value),e.complete()}function D(t){t.subject.error(t.err)}function A(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}function O(t,e,n,i,r){if(void 0===r&&(r=new je(t,n,i)),!r.closed)return e instanceof Vt?e.subscribe(r):Fe(e)(r)}function S(t,e){if(null!=t){if(t&&"function"==typeof t[Ft])return function(t,e){return new Vt(function(n){var i=new Bt;return i.add(e.schedule(function(){var r=t[Ft]();i.add(r.subscribe({next:function(t){i.add(e.schedule(function(){return n.next(t)}))},error:function(t){i.add(e.schedule(function(){return n.error(t)}))},complete:function(){i.add(e.schedule(function(){return n.complete()}))}}))})),i})}(t,e);if(A(t))return function(t,e){return new Vt(function(n){var i=new Bt;return i.add(e.schedule(function(){return t.then(function(t){i.add(e.schedule(function(){n.next(t),i.add(e.schedule(function(){return n.complete()}))}))},function(t){i.add(e.schedule(function(){return n.error(t)}))})})),i})}(t,e);if(Ge(t))return p(t,e);if(t&&"function"==typeof t[fe]||"string"==typeof t)return function(t,e){if(!t)throw Error("Iterable cannot be null");return new Vt(function(n){var i,r=new Bt;return r.add(function(){i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(function(){i=t[fe](),r.add(e.schedule(function(){if(!n.closed){var t,e;try{var r=i.next();t=r.value,e=r.done}catch(o){return void n.error(o)}e?n.complete():(n.next(t),this.schedule())}}))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function R(t,e){return e?S(t,e):t instanceof Vt?t:new Vt(Fe(t))}function k(t,e){if(!e.closed){if(t instanceof Vt)return t.subscribe(e);var n;try{n=Fe(t)(e)}catch(i){e.error(i)}return n}}function N(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?function(i){return i.pipe(N(function(n,i){return R(t(n,i)).pipe(E(function(t,r){return e(n,t,i,r)}))},n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new $e(t,n))})}function M(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),N(a,t)}function P(){return M(1)}function L(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return P()(v.apply(void 0,t))}function K(t){return new Vt(function(e){var n;try{n=t()}catch(i){return void e.error(i)}return(n?R(n):d()).subscribe(e)})}function B(t,e){return new Vt(function(n){var i=t.length;if(0===i)n.complete();else for(var r=Array(i),o=0,s=0,a=function(a){var l=R(t[a]),c=!1;n.add(l.subscribe({next:function(t){c||(c=!0,s++),r[a]=t},error:function(t){return n.error(t)},complete:function(){++o!==i&&c||(s===i&&n.next(e?e.reduce(function(t,e,n){return t[e]=r[n],t},{}):r),n.complete())}}))},l=0;l<i;l++)a(l)})}function z(t,e,n,i,r){var o;if(t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener)t.addEventListener(e,n,r),o=function(){return t.removeEventListener(e,n,r)};else if(t&&"function"==typeof t.on&&"function"==typeof t.off)t.on(e,n),o=function(){return t.off(e,n)};else if(t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener)t.addListener(e,n),o=function(){return t.removeListener(e,n)};else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var s=0,a=t.length;s<a;s++)z(t[s],e,n,i,r)}i.add(o)}function j(t){var e=t.subscriber,n=t.condition;if(!e.closed){if(t.needIterate)try{t.state=t.iterate(t.state)}catch(o){return void e.error(o)}else t.needIterate=!0;if(n){var i=void 0;try{i=n(t.state)}catch(o){return void e.error(o)}if(!i)return void e.complete();if(e.closed)return}var r;try{r=t.resultSelector(t.state)}catch(o){return void e.error(o)}if(!e.closed&&(e.next(r),!e.closed))return this.schedule(t)}}function G(t){return!Lt(t)&&0<=t-parseFloat(t)+1}function F(t){var e=t.subscriber,n=t.counter;t=t.period,e.next(n),this.schedule({subscriber:e,counter:n+1,period:t},t)}function V(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];e=Number.POSITIVE_INFINITY;var n=null,i=t[t.length-1];return f(i)?(n=t.pop(),1<t.length&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof i&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof Vt?t[0]:M(e)(m(t,n))}function H(t){var e=t.keys,n=t.index,i=t.subscriber,r=t.subscription;if(t=t.obj,!i.closed)if(n<e.length){var o=e[n];i.next([o,t[o]]),r.add(this.schedule({keys:e,index:n+1,subscriber:i,subscription:r,obj:t}))}else i.complete()}function U(t,e){function n(){return!n.pred.apply(n.thisArg,arguments)}return n.pred=t,n.thisArg=e,n}function Z(t,e){return function(n){return n.lift(new qe(t,e))}}function W(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){if(!Lt(t[0]))return t[0];t=t[0]}return m(t,void 0).lift(new Qe)}function $(t){var e=t.start,n=t.index,i=t.subscriber;n>=t.count?i.complete():(i.next(e),i.closed||(t.index=n+1,t.start=e+1,this.schedule(t)))}function Y(t,e,n){void 0===t&&(t=0);var i=-1;return G(e)?i=1>Number(e)?1:Number(e):f(e)&&(n=e),f(n)||(n=Oe),new Vt(function(e){var r=G(t)?t:+t-n.now();return n.schedule(X,r,{index:0,period:i,subscriber:e})})}function X(t){var e=t.index,n=t.period,i=t.subscriber;if(i.next(e),!i.closed){if(-1===n)return i.complete();t.index=e+1,this.schedule(t,n)}}function q(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"function"==typeof(e=t[t.length-1])&&t.pop(),m(t,void 0).lift(new en(e))}function J(t){return function(e){return e.lift(new an(t))}}function Q(t){var e=t.subscriber,n=t.context;n&&e.closeContext(n),e.closed||(t.context=e.openContext(),t.context.closeAction=this.schedule(t,t.bufferTimeSpan))}function tt(t){var e=t.bufferCreationInterval,n=t.bufferTimeSpan,i=t.subscriber,r=t.scheduler,o=i.openContext();i.closed||(i.add(o.closeAction=r.schedule(et,n,{subscriber:i,context:o})),this.schedule(t,e))}function et(t){t.subscriber.closeContext(t.context)}function nt(t,e){return N(t,e,1)}function it(t){t.debouncedNext()}function rt(t){return void 0===t&&(t=null),function(e){return e.lift(new On(t))}}function ot(t,e){return function(n){return n.lift(new Fn(t,e))}}function st(t){return void 0===t&&(t=at),function(e){return e.lift(new Hn(t))}}function at(){return new Pe}function lt(t){return function(e){return 0===t?d():e.lift(new Zn(t))}}function ct(t){return function(e){return 0===t?d():e.lift(new ui(t))}}function ut(t,e){var n=!1;return 2<=arguments.length&&(n=!0),function(i){return i.lift(new mi(t,e,n))}}function ht(t,e){return 2<=arguments.length?function(n){return l(ut(t,e),ct(1),rt(e))(n)}:function(e){return l(ut(function(e,n,i){return t(e,n,i+1)}),ct(1))(e)}}function dt(t,e){return function(n){var i;if(i="function"==typeof t?t:function(){return t},"function"==typeof e)return n.lift(new Ci(i,e));var r=Object.create(n,Jt);return r.source=n,r.subjectFactory=i,r}}function ft(t){var e=t.period;t.subscriber.notifyNext(),this.schedule(t,e)}function pt(){return new Wt}function gt(t,e){return"function"==typeof e?function(n){return n.pipe(gt(function(n,i){return R(t(n,i)).pipe(E(function(t,r){return e(n,t,i,r)}))}))}:function(e){return e.lift(new Ji(t))}}function mt(t){t.subscriber.clearThrottle()}function vt(t,e,n){return void 0===n&&(n=Oe),function(i){var r=t instanceof Date&&!isNaN(+t),o=r?+t-n.now():Math.abs(t);return i.lift(new dr(o,r,e,n))}}function yt(t,e,n){return 0===n?[e]:(t.push(e),t)}function bt(t){var e=t.subscriber,n=t.windowTimeSpan,i=t.window;i&&e.closeWindow(i),t.window=e.openWindow(),this.schedule(t,n)}function Ct(t){var e=t.windowTimeSpan,n=t.subscriber,i=t.scheduler,r=t.windowCreationInterval,o=n.openWindow(),s={action:this,subscription:null};s.subscription=i.schedule(It,e,{subscriber:n,window:o,context:s}),this.add(s.subscription),this.schedule(t,r)}function It(t){var e=t.subscriber,n=t.window;(t=t.context)&&t.action&&t.subscription&&t.action.remove(t.subscription),e.closeWindow(n)}function Et(t,e){for(var n=0,i=e.length;n<i;n++)for(var r=e[n],o=Object.getOwnPropertyNames(r.prototype),s=0,a=o.length;s<a;s++){var l=o[s];t.prototype[l]=r.prototype[l]}}function Tt(t,e){return void 0===e&&(e=null),new zr({method:"GET",url:t,headers:e})}function wt(t,e,n){return new zr({method:"POST",url:t,body:e,headers:n})}function xt(t,e){return new zr({method:"DELETE",url:t,headers:e})}function _t(t,e,n){return new zr({method:"PUT",url:t,body:e,headers:n})}function Dt(t,e,n){return new zr({method:"PATCH",url:t,body:e,headers:n})}function At(t,e){return Br(new zr({method:"GET",url:t,responseType:"json",headers:e}))}function Ot(t,e){switch(t){case"json":return t="response"in e?e.responseType?e.response:JSON.parse(e.response||e.responseText||"null"):JSON.parse(e.responseText||"null");case"xml":return e.responseXML;default:return"response"in e?e.response:e.responseText}}var St,Rt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},kt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Nt=!1,Mt={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t?console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+Error().stack):Nt&&console.log("RxJS: Back to a better error behavior. Thank you. <3"),Nt=t},get useDeprecatedSynchronousErrorHandling(){return Nt}},Pt={closed:!0,next:function(t){},error:function(t){if(Mt.useDeprecatedSynchronousErrorHandling)throw t;i(t)},complete:function(){}},Lt=Array.isArray||function(t){return t&&"number"==typeof t.length},Kt=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),Bt=function(){function t(t){this.closed=!1,this._subscriptions=this._parentOrParents=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var i=this._parentOrParents,s=this._ctorUnsubscribe,a=this._unsubscribe,l=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,i instanceof t)i.remove(this);else if(null!==i)for(var c=0;c<i.length;++c)i[c].remove(this);if(n(a)){s&&(this._unsubscribe=void 0);try{a.call(this)}catch(u){e=u instanceof Kt?o(u.errors):[u]}}if(Lt(l))for(c=-1,i=l.length;++c<i;)if(r(s=l[c]))try{s.unsubscribe()}catch(u){e=e||[],u instanceof Kt?e=e.concat(o(u.errors)):e.push(u)}if(e)throw new Kt(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;n instanceof t||(e=n,(n=new t)._subscriptions=[e]);break;default:throw Error("unrecognized teardown "+e+" added to Subscription.")}if(null===(e=n._parentOrParents))n._parentOrParents=this;else if(e instanceof t){if(e===this)return n;n._parentOrParents=[e,this]}else{if(-1!==e.indexOf(this))return n;e.push(this)}return null===(e=this._subscriptions)?this._subscriptions=[n]:e.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;e&&(-1!==(t=e.indexOf(t))&&e.splice(t,1))},t.EMPTY=((e=new t).closed=!0,e),t}(),zt="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),jt=function(t){function n(e,i,r){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=Pt;break;case 1:if(!e){o.destination=Pt;break}if("object"==typeof e){e instanceof n?(o.syncErrorThrowable=e.syncErrorThrowable,o.destination=e,e.add(o)):(o.syncErrorThrowable=!0,o.destination=new Gt(o,e));break}default:o.syncErrorThrowable=!0,o.destination=new Gt(o,e,i,r)}return o}return e(n,t),n.prototype[zt]=function(){return this},n.create=function(t,e,i){return(t=new n(t,e,i)).syncErrorThrowable=!1,t},n.prototype.next=function(t){this.isStopped||this._next(t)},n.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},n.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},n.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},n.prototype._next=function(t){this.destination.next(t)},n.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},n.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},n.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.isStopped=this.closed=!1,this._parentOrParents=t,this},n}(Bt),Gt=function(t){function r(e,i,r,o){var s,a=t.call(this)||this;return a._parentSubscriber=e,e=a,n(i)?s=i:i&&(s=i.next,r=i.error,o=i.complete,i!==Pt&&(n((e=Object.create(i)).unsubscribe)&&a.add(e.unsubscribe.bind(e)),e.unsubscribe=a.unsubscribe.bind(a))),a._context=e,a._next=s,a._error=r,a._complete=o,a}return e(r,t),r.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;Mt.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},r.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=Mt.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?this.__tryOrSetError(e,this._error,t):this.__tryOrUnsub(this._error,t),this.unsubscribe();else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):i(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;i(t)}}},r.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};Mt.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,n):this.__tryOrUnsub(n)}this.unsubscribe()}},r.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),Mt.useDeprecatedSynchronousErrorHandling)throw n;i(n)}},r.prototype.__tryOrSetError=function(t,e,n){if(!Mt.useDeprecatedSynchronousErrorHandling)throw Error("bad call");try{e.call(this._context,n)}catch(r){return Mt.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0):i(r),!0}return!1},r.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._parentSubscriber=this._context=null,t.unsubscribe()},r}(jt),Ft="function"==typeof Symbol&&Symbol.observable||"@@observable",Vt=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var i=this.operator;t:{if(t){if(t instanceof jt)break t;if(t[zt]){t=t[zt]();break t}}t=t||e||n?new jt(t,e,n):new jt(Pt)}if(i?t.add(i.call(t,this.source)):t.add(this.source||Mt.useDeprecatedSynchronousErrorHandling&&!t.syncErrorThrowable?this._subscribe(t):this._trySubscribe(t)),Mt.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable&&(t.syncErrorThrowable=!1,t.syncErrorThrown))throw t.syncErrorValue;return t},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){Mt.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),s(t)?t.error(e):console.warn(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=u(e))(function(e,i){var r;r=n.subscribe(function(e){try{t(e)}catch(n){i(n),r&&r.unsubscribe()}},i,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[Ft]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:c(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=u(t))(function(t,n){var i;e.subscribe(function(t){return i=t},function(t){return n(t)},function(){return t(i)})})},t.create=function(e){return new t(e)},t}(),Ht=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),Ut=function(t){function n(e,n){var i=t.call(this)||this;return i.subject=e,i.subscriber=n,i.closed=!1,i}return e(n,t),n.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;this.subject=null,!e||0===e.length||t.isStopped||t.closed||-1!==(t=e.indexOf(this.subscriber))&&e.splice(t,1)}},n}(Bt),Zt=function(t){function n(e){var n=t.call(this,e)||this;return n.destination=e,n}return e(n,t),n}(jt),Wt=function(t){function n(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return e(n,t),n.prototype[zt]=function(){return new Zt(this)},n.prototype.lift=function(t){var e=new $t(this,this);return e.operator=t,e},n.prototype.next=function(t){if(this.closed)throw new Ht;if(!this.isStopped)for(var e=(n=this.observers).length,n=n.slice(),i=0;i<e;i++)n[i].next(t)},n.prototype.error=function(t){if(this.closed)throw new Ht;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=(n=this.observers).length,n=n.slice(),i=0;i<e;i++)n[i].error(t);this.observers.length=0},n.prototype.complete=function(){if(this.closed)throw new Ht;this.isStopped=!0;for(var t=(e=this.observers).length,e=e.slice(),n=0;n<t;n++)e[n].complete();this.observers.length=0},n.prototype.unsubscribe=function(){this.closed=this.isStopped=!0,this.observers=null},n.prototype._trySubscribe=function(e){if(this.closed)throw new Ht;return t.prototype._trySubscribe.call(this,e)},n.prototype._subscribe=function(t){if(this.closed)throw new Ht;return this.hasError?(t.error(this.thrownError),Bt.EMPTY):this.isStopped?(t.complete(),Bt.EMPTY):(this.observers.push(t),new Ut(this,t))},n.prototype.asObservable=function(){var t=new Vt;return t.source=this,t},n.create=function(t,e){return new $t(t,e)},n}(Vt),$t=function(t){function n(e,n){var i=t.call(this)||this;return i.destination=e,i.source=n,i}return e(n,t),n.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},n.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},n.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},n.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):Bt.EMPTY},n}(Wt),Yt=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var n=this.connectable;return n._refCount++,t=new Xt(t,n),e=e.subscribe(t),t.closed||(t.connection=n.connect()),e},t}(),Xt=function(t){function n(e,n){return(e=t.call(this,e)||this).connectable=n,e}return e(n,t),n.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;0>=e?this.connection=null:(t._refCount=e-1,1<e?this.connection=null:(e=this.connection,t=t._connection,this.connection=null,!t||e&&t!==e||t.unsubscribe()))}else this.connection=null},n}(jt),qt=function(t){function n(e,n){var i=t.call(this)||this;return i.source=e,i.subjectFactory=n,i._refCount=0,i._isComplete=!1,i}return e(n,t),n.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},n.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},n.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new Bt).add(this.source.subscribe(new Qt(this.getSubject(),this))),t.closed&&(this._connection=null,t=Bt.EMPTY)),t},n.prototype.refCount=function(){return h()(this)},n}(Vt),Jt={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:(St=qt.prototype)._subscribe},_isComplete:{value:St._isComplete,writable:!0},getSubject:{value:St.getSubject},connect:{value:St.connect},refCount:{value:St.refCount}},Qt=function(t){function n(e,n){return(e=t.call(this,e)||this).connectable=n,e}return e(n,t),n.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},n.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},n.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},n}(Zt);!function(t){function n(e,n){return(e=t.call(this,e)||this).connectable=n,e}e(n,t),n.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;0>=e?this.connection=null:(t._refCount=e-1,1<e?this.connection=null:(e=this.connection,t=t._connection,this.connection=null,!t||e&&t!==e||t.unsubscribe()))}else this.connection=null}}(jt);var te=function(){function t(t,e,n,i){this.keySelector=t,this.elementSelector=e,this.durationSelector=n,this.subjectSelector=i}return t.prototype.call=function(t,e){return e.subscribe(new ee(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},t}(),ee=function(t){function n(e,n,i,r,o){return(e=t.call(this,e)||this).keySelector=n,e.elementSelector=i,e.durationSelector=r,e.subjectSelector=o,e.groups=null,e.attemptedToUnsubscribe=!1,e.count=0,e}return e(n,t),n.prototype._next=function(t){var e;try{e=this.keySelector(t)}catch(n){return void this.error(n)}this._group(t,e)},n.prototype._group=function(t,e){var n=this.groups;n||(n=this.groups=new Map);var i,r=n.get(e);if(this.elementSelector)try{i=this.elementSelector(t)}catch(o){this.error(o)}else i=t;if(!r&&(r=this.subjectSelector?this.subjectSelector():new Wt,n.set(e,r),t=new ie(e,r,this),this.destination.next(t),this.durationSelector)){t=void 0;try{t=this.durationSelector(new ie(e,r))}catch(o){return void this.error(o)}this.add(t.subscribe(new ne(e,r,this)))}r.closed||r.next(i)},n.prototype._error=function(t){var e=this.groups;e&&(e.forEach(function(e,n){e.error(t)}),e.clear()),this.destination.error(t)},n.prototype._complete=function(){var t=this.groups;t&&(t.forEach(function(t,e){t.complete()}),t.clear()),this.destination.complete()},n.prototype.removeGroup=function(t){this.groups.delete(t)},n.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&t.prototype.unsubscribe.call(this))},n}(jt),ne=function(t){function n(e,n,i){var r=t.call(this,n)||this;return r.key=e,r.group=n,r.parent=i,r}return e(n,t),n.prototype._next=function(t){this.complete()},n.prototype._unsubscribe=function(){var t=this.parent,e=this.key;this.key=this.parent=null,t&&t.removeGroup(e)},n}(jt),ie=function(t){function n(e,n,i){var r=t.call(this)||this;return r.key=e,r.groupSubject=n,r.refCountSubscription=i,r}return e(n,t),n.prototype._subscribe=function(t){var e=new Bt,n=this.refCountSubscription,i=this.groupSubject;return n&&!n.closed&&e.add(new re(n)),e.add(i.subscribe(t)),e},n}(Vt),re=function(t){function n(e){var n=t.call(this)||this;return n.parent=e,e.count++,n}return e(n,t),n.prototype.unsubscribe=function(){var e=this.parent;e.closed||this.closed||(t.prototype.unsubscribe.call(this),--e.count,0===e.count&&e.attemptedToUnsubscribe&&e.unsubscribe())},n}(Bt),oe=function(t){function n(e){var n=t.call(this)||this;return n._value=e,n}return e(n,t),Object.defineProperty(n.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),n.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},n.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Ht;return this._value},n.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},n}(Wt),se=function(t){function n(e,n){var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i.pending=!1,i}return e(n,t),n.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t,t=this.id;var n=this.scheduler;return null!=t&&(this.id=this.recycleAsyncId(n,t,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},n.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},n.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},n.prototype.execute=function(t,e){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(t=this._execute(t,e))?t:void(!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},n.prototype._execute=function(t,e){e=!1;var n=void 0;try{this.work(t)}catch(i){e=!0,n=!!i&&i||Error(i)}if(e)return this.unsubscribe(),n},n.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,i=n.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},n}(function(t){function n(e,n){return t.call(this)||this}return e(n,t),n.prototype.schedule=function(t,e){return this},n}(Bt)),ae=function(t){function n(e,n){var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i}return e(n,t),n.prototype.schedule=function(e,n){return void 0===n&&(n=0),0<n?t.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},n.prototype.execute=function(e,n){return 0<n||this.closed?t.prototype.execute.call(this,e,n):this._execute(e,n)},n.prototype.requestAsyncId=function(e,n,i){return void 0===i&&(i=0),null!==i&&0<i||null===i&&0<this.delay?t.prototype.requestAsyncId.call(this,e,n,i):e.flush(this)},n}(se),le=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=function(){return Date.now()},t}(),ce=function(t){function n(e,i){void 0===i&&(i=le.now);var r=t.call(this,e,function(){return n.delegate&&n.delegate!==r?n.delegate.now():i()})||this;return r.actions=[],r.active=!1,r.scheduled=void 0,r}return e(n,t),n.prototype.schedule=function(e,i,r){return void 0===i&&(i=0),n.delegate&&n.delegate!==this?n.delegate.schedule(e,i,r):t.prototype.schedule.call(this,e,i,r)},n.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},n}(le),ue=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n}(ce))(ae),he=new Vt(function(t){return t.complete()}),de=function(t){return function(e){for(var n=0,i=t.length;n<i&&!e.closed;n++)e.next(t[n]);e.complete()}};!function(t){t.NEXT="N",t.ERROR="E",t.COMPLETE="C"}(t.NotificationKind||(t.NotificationKind={}));var fe,pe=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){switch(this.kind){case"N":return v(this.value);case"E":return y(this.error);case"C":return d()}throw Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}(),ge=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new me(t,this.scheduler,this.delay))},t}(),me=function(t){function n(e,n,i){return void 0===i&&(i=0),(e=t.call(this,e)||this).scheduler=n,e.delay=i,e}return e(n,t),n.dispatch=function(t){t.notification.observe(t.destination),this.unsubscribe()},n.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(n.dispatch,this.delay,new ve(t,this.destination)))},n.prototype._next=function(t){this.scheduleMessage(pe.createNext(t))},n.prototype._error=function(t){this.scheduleMessage(pe.createError(t)),this.unsubscribe()},n.prototype._complete=function(){this.scheduleMessage(pe.createComplete()),this.unsubscribe()},n}(jt),ve=function(t,e){this.notification=t,this.destination=e},ye=function(t){function n(e,n,i){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var r=t.call(this)||this;return r.scheduler=i,r._events=[],r._infiniteTimeWindow=!1,r._bufferSize=1>e?1:e,r._windowTime=1>n?1:n,n===Number.POSITIVE_INFINITY?(r._infiniteTimeWindow=!0,r.next=r.nextInfiniteTimeWindow):r.next=r.nextTimeWindow,r}return e(n,t),n.prototype.nextInfiniteTimeWindow=function(e){if(!this.isStopped){var n=this._events;n.push(e),n.length>this._bufferSize&&n.shift()}t.prototype.next.call(this,e)},n.prototype.nextTimeWindow=function(e){this.isStopped||(this._events.push(new be(this._getNow(),e)),this._trimBufferThenGetEvents()),t.prototype.next.call(this,e)},n.prototype._subscribe=function(t){var e,n=this._infiniteTimeWindow,i=n?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,o=i.length;if(this.closed)throw new Ht;if(this.isStopped||this.hasError?e=Bt.EMPTY:(this.observers.push(t),e=new Ut(this,t)),r&&t.add(t=new me(t,r)),n)for(n=0;n<o&&!t.closed;n++)t.next(i[n]);else for(n=0;n<o&&!t.closed;n++)t.next(i[n].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},n.prototype._getNow=function(){return(this.scheduler||ue).now()},n.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,n=this._windowTime,i=this._events,r=i.length,o=0;o<r&&!(t-i[o].time<n);)o++;return r>e&&(o=Math.max(o,r-e)),0<o&&i.splice(0,o),i},n}(Wt),be=function(t,e){this.time=t,this.value=e},Ce=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=null,e.hasNext=!1,e.hasCompleted=!1,e}return e(n,t),n.prototype._subscribe=function(e){return this.hasError?(e.error(this.thrownError),Bt.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),Bt.EMPTY):t.prototype._subscribe.call(this,e)},n.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},n.prototype.error=function(e){this.hasCompleted||t.prototype.error.call(this,e)},n.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&t.prototype.next.call(this,this.value),t.prototype.complete.call(this)},n}(Wt),Ie=1,Ee=Promise.resolve(),Te={},we=function(t){var e=Ie++;return Te[e]=!0,Ee.then(function(){return C(e)&&t()}),e},xe=function(t){C(t)},_e=function(t){function n(e,n){var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i}return e(n,t),n.prototype.requestAsyncId=function(e,n,i){return void 0===i&&(i=0),null!==i&&0<i?t.prototype.requestAsyncId.call(this,e,n,i):(e.actions.push(this),e.scheduled||(e.scheduled=we(e.flush.bind(e,null))))},n.prototype.recycleAsyncId=function(e,n,i){if(void 0===i&&(i=0),null!==i&&0<i||null===i&&0<this.delay)return t.prototype.recycleAsyncId.call(this,e,n,i);0===e.actions.length&&(xe(n),e.scheduled=void 0)},n}(se),De=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,i=-1,r=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++i<r&&(t=n.shift()));if(this.active=!1,e){for(;++i<r&&(t=n.shift());)t.unsubscribe();throw e}},n}(ce))(_e),Ae=new ce(se),Oe=Ae,Se=function(t){function n(e,n){var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i}return e(n,t),n.prototype.requestAsyncId=function(e,n,i){return void 0===i&&(i=0),null!==i&&0<i?t.prototype.requestAsyncId.call(this,e,n,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(function(){return e.flush(null)})))},n.prototype.recycleAsyncId=function(e,n,i){if(void 0===i&&(i=0),null!==i&&0<i||null===i&&0<this.delay)return t.prototype.recycleAsyncId.call(this,e,n,i);0===e.actions.length&&(cancelAnimationFrame(n),e.scheduled=void 0)},n}(se),Re=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,i=-1,r=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++i<r&&(t=n.shift()));if(this.active=!1,e){for(;++i<r&&(t=n.shift());)t.unsubscribe();throw e}},n}(ce))(Se),ke=function(t){function n(e,n){void 0===e&&(e=Ne),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=t.call(this,e,function(){return i.frame})||this;return i.maxFrames=n,i.frame=0,i.index=-1,i}return e(n,t),n.prototype.flush=function(){for(var t,e,n=this.actions,i=this.maxFrames;(e=n[0])&&e.delay<=i&&(n.shift(),this.frame=e.delay,!(t=e.execute(e.state,e.delay))););if(t){for(;e=n.shift();)e.unsubscribe();throw t}},n.frameTimeFactor=10,n}(ce),Ne=function(t){function n(e,n,i){void 0===i&&(i=e.index+=1);var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r.index=i,r.active=!0,r.index=e.index=i,r}return e(n,t),n.prototype.schedule=function(e,i){if(void 0===i&&(i=0),!this.id)return t.prototype.schedule.call(this,e,i);this.active=!1;var r=new n(this.scheduler,this.work);return this.add(r),r.schedule(e,i)},n.prototype.requestAsyncId=function(t,e,i){return void 0===i&&(i=0),this.delay=t.frame+i,(t=t.actions).push(this),t.sort(n.sortActions),!0},n.prototype.recycleAsyncId=function(t,e,n){},n.prototype._execute=function(e,n){if(!0===this.active)return t.prototype._execute.call(this,e,n)},n.sortActions=function(t,e){return t.delay===e.delay?t.index===e.index?0:t.index>e.index?1:-1:t.delay>e.delay?1:-1},n}(se),Me=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}(),Pe=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}(),Le=function(){function t(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return t.prototype=Object.create(Error.prototype),t}(),Ke=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new Be(t,this.project,this.thisArg))},t}(),Be=function(t){function n(e,n,i){return(e=t.call(this,e)||this).project=n,e.count=0,e.thisArg=i||e,e}return e(n,t),n.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)},n}(jt),ze=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.notifyNext=function(t,e,n,i,r){this.destination.next(e)},n.prototype.notifyError=function(t,e){this.destination.error(t)},n.prototype.notifyComplete=function(t){this.destination.complete()},n}(jt),je=function(t){function n(e,n,i){var r=t.call(this)||this;return r.parent=e,r.outerValue=n,r.outerIndex=i,r.index=0,r}return e(n,t),n.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},n.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},n.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},n}(jt);fe="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";var Ge=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t},Fe=function(t){if(t&&"function"==typeof t[Ft])return function(t){return function(e){var n=t[Ft]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)}}(t);if(Ge(t))return de(t);if(A(t))return function(t){return function(e){return t.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,i),e}}(t);if(t&&"function"==typeof t[fe])return function(t){return function(e){for(var n=t[fe]();;){var i=void 0;try{i=n.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof n.return&&e.add(function(){n.return&&n.return()}),e}}(t);throw t=r(t)?"an invalid object":"'"+t+"'",new TypeError("You provided "+t+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},Ve={},He=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new Ue(t,this.resultSelector))},t}(),Ue=function(t){function n(e,n){return(e=t.call(this,e)||this).resultSelector=n,e.active=0,e.values=[],e.observables=[],e}return e(n,t),n.prototype._next=function(t){this.values.push(Ve),this.observables.push(t)},n.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.toRespond=this.active=e;for(var n=0;n<e;n++)this.add(O(this,t[n],void 0,n))}},n.prototype.notifyComplete=function(t){0==--this.active&&this.destination.complete()},n.prototype.notifyNext=function(t,e,n){var i=(t=this.values)[n];i=this.toRespond?i===Ve?--this.toRespond:this.toRespond:0;t[n]=e,0===i&&(this.resultSelector?this._tryResultSelector(t):this.destination.next(t.slice()))},n.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)},n}(ze),Ze=function(t){function n(e){var n=t.call(this)||this;return n.parent=e,n}return e(n,t),n.prototype._next=function(t){this.parent.notifyNext(t)},n.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},n.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},n}(jt);!function(t){function n(e,n,i){var r=t.call(this)||this;return r.parent=e,r.outerValue=n,r.outerIndex=i,r}e(n,t),n.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this)},n.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},n.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()}}(jt);var We=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.notifyNext=function(t){this.destination.next(t)},n.prototype.notifyError=function(t){this.destination.error(t)},n.prototype.notifyComplete=function(){this.destination.complete()},n}(jt);!function(t){function n(){return null!==t&&t.apply(this,arguments)||this}e(n,t),n.prototype.notifyNext=function(t,e,n,i){this.destination.next(e)},n.prototype.notifyError=function(t){this.destination.error(t)},n.prototype.notifyComplete=function(t){this.destination.complete()}}(jt);var $e=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new Ye(t,this.project,this.concurrent))},t}(),Ye=function(t){function n(e,n,i){return void 0===i&&(i=Number.POSITIVE_INFINITY),(e=t.call(this,e)||this).project=n,e.concurrent=i,e.hasCompleted=!1,e.buffer=[],e.active=0,e.index=0,e}return e(n,t),n.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},n.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(e)},n.prototype._innerSub=function(t){var e=new Ze(this),n=this.destination;n.add(e),(t=k(t,e))!==e&&n.add(t)},n.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},n.prototype.notifyNext=function(t){this.destination.next(t)},n.prototype.notifyComplete=function(){var t=this.buffer;this.active--,0<t.length?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},n}(We),Xe=new Vt(I),qe=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new Je(t,this.predicate,this.thisArg))},t}(),Je=function(t){function n(e,n,i){return(e=t.call(this,e)||this).predicate=n,e.thisArg=i,e.count=0,e}return e(n,t),n.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)},n}(jt),Qe=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new tn(t))},t}(),tn=function(t){function n(e){return(e=t.call(this,e)||this).hasFirst=!1,e.observables=[],e.subscriptions=[],e}return e(n,t),n.prototype._next=function(t){this.observables.push(t)},n.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{for(var n=0;n<e&&!this.hasFirst;n++){var i=O(this,t[n],void 0,n);this.subscriptions&&this.subscriptions.push(i),this.add(i)}this.observables=null}},n.prototype.notifyNext=function(t,e,n){if(!this.hasFirst){for(this.hasFirst=!0,t=0;t<this.subscriptions.length;t++)if(t!==n){var i=this.subscriptions[t];i.unsubscribe(),this.remove(i)}this.subscriptions=null}this.destination.next(e)},n}(ze),en=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new nn(t,this.resultSelector))},t}(),nn=function(t){function n(e,n,i){return void 0===i&&Object.create(null),(e=t.call(this,e)||this).resultSelector=n,e.iterators=[],e.active=0,e.resultSelector="function"==typeof n?n:void 0,e}return e(n,t),n.prototype._next=function(t){var e=this.iterators;Lt(t)?e.push(new on(t)):"function"==typeof t[fe]?e.push(new rn(t[fe]())):e.push(new sn(this.destination,this,t))},n.prototype._complete=function(){var t=this.iterators,e=t.length;if(this.unsubscribe(),0===e)this.destination.complete();else{this.active=e;for(var n=0;n<e;n++){var i=t[n];i.stillUnsubscribed?this.destination.add(i.subscribe()):this.active--}}},n.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},n.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,n=this.destination,i=0;i<e;i++){if("function"==typeof(s=t[i]).hasValue&&!s.hasValue())return}var r=!1,o=[];for(i=0;i<e;i++){var s,a=(s=t[i]).next();if(s.hasCompleted()&&(r=!0),a.done)return void n.complete();o.push(a.value)}this.resultSelector?this._tryresultSelector(o):n.next(o),r&&n.complete()},n.prototype._tryresultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)},n}(jt),rn=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return!(!t||!t.done)},t}(),on=function(){function t(t){this.array=t,this.length=this.index=0,this.length=t.length}return t.prototype[fe]=function(){return this},t.prototype.next=function(t){t=this.index++;var e=this.array;return t<this.length?{value:e[t],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),sn=function(t){function n(e,n,i){return(e=t.call(this,e)||this).parent=n,e.observable=i,e.stillUnsubscribed=!0,e.buffer=[],e.isComplete=!1,e}return e(n,t),n.prototype[fe]=function(){return this},n.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},n.prototype.hasValue=function(){return 0<this.buffer.length},n.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},n.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},n.prototype.notifyNext=function(t){this.buffer.push(t),this.parent.checkIterators()},n.prototype.subscribe=function(){return k(this.observable,new Ze(this))},n}(We),an=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new ln(t,this.durationSelector))},t}(),ln=function(t){function n(e,n){return(e=t.call(this,e)||this).durationSelector=n,e.hasValue=!1,e}return e(n,t),n.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=void 0;try{e=(0,this.durationSelector)(t)}catch(n){return this.destination.error(n)}!(t=k(e,new Ze(this)))||t.closed?this.clearThrottle():this.add(this.throttled=t)}},n.prototype.clearThrottle=function(){var t=this.value,e=this.hasValue,n=this.throttled;n&&(this.remove(n),this.throttled=void 0,n.unsubscribe()),e&&(this.value=void 0,this.hasValue=!1,this.destination.next(t))},n.prototype.notifyNext=function(){this.clearThrottle()},n.prototype.notifyComplete=function(){this.clearThrottle()},n}(We),cn=function(){function t(t){this.closingNotifier=t}return t.prototype.call=function(t,e){return e.subscribe(new un(t,this.closingNotifier))},t}(),un=function(t){function n(e,n){return(e=t.call(this,e)||this).buffer=[],e.add(k(n,new Ze(e))),e}return e(n,t),n.prototype._next=function(t){this.buffer.push(t)},n.prototype.notifyNext=function(){var t=this.buffer;this.buffer=[],this.destination.next(t)},n}(We),hn=function(){function t(t,e){this.bufferSize=t,this.subscriberClass=(this.startBufferEvery=e)&&t!==e?fn:dn}return t.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},t}(),dn=function(t){function n(e,n){return(e=t.call(this,e)||this).bufferSize=n,e.buffer=[],e}return e(n,t),n.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},n.prototype._complete=function(){var e=this.buffer;0<e.length&&this.destination.next(e),t.prototype._complete.call(this)},n}(jt),fn=function(t){function n(e,n,i){return(e=t.call(this,e)||this).bufferSize=n,e.startBufferEvery=i,e.buffers=[],e.count=0,e}return e(n,t),n.prototype._next=function(t){var e=this.bufferSize,n=this.startBufferEvery,i=this.buffers,r=this.count;for(this.count++,0==r%n&&i.push([]),n=i.length;n--;)(r=i[n]).push(t),r.length===e&&(i.splice(n,1),this.destination.next(r))},n.prototype._complete=function(){for(var e=this.buffers,n=this.destination;0<e.length;){var i=e.shift();0<i.length&&n.next(i)}t.prototype._complete.call(this)},n}(jt),pn=function(){function t(t,e,n,i){this.bufferTimeSpan=t,this.bufferCreationInterval=e,this.maxBufferSize=n,this.scheduler=i}return t.prototype.call=function(t,e){return e.subscribe(new mn(t,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},t}(),gn=function(){this.buffer=[]},mn=function(t){function n(e,n,i,r,o){if((e=t.call(this,e)||this).bufferTimeSpan=n,e.bufferCreationInterval=i,e.maxBufferSize=r,e.scheduler=o,e.contexts=[],r=e.openContext(),e.timespanOnly=null==i||0>i,e.timespanOnly)e.add(r.closeAction=o.schedule(Q,n,{subscriber:e,context:r,bufferTimeSpan:n}));else{var s={bufferTimeSpan:n,bufferCreationInterval:i,subscriber:e,scheduler:o};e.add(r.closeAction=o.schedule(et,n,{subscriber:e,context:r})),e.add(o.schedule(tt,i,s))}return e}return e(n,t),n.prototype._next=function(t){for(var e,n=this.contexts,i=n.length,r=0;r<i;r++){var o=n[r],s=o.buffer;s.push(t),s.length==this.maxBufferSize&&(e=o)}e&&this.onBufferFull(e)},n.prototype._error=function(e){this.contexts.length=0,t.prototype._error.call(this,e)},n.prototype._complete=function(){for(var e=this.contexts,n=this.destination;0<e.length;){var i=e.shift();n.next(i.buffer)}t.prototype._complete.call(this)},n.prototype._unsubscribe=function(){this.contexts=null},n.prototype.onBufferFull=function(t){if(this.closeContext(t),(t=t.closeAction).unsubscribe(),this.remove(t),!this.closed&&this.timespanOnly){t=this.openContext();var e=this.bufferTimeSpan;this.add(t.closeAction=this.scheduler.schedule(Q,e,{subscriber:this,context:t,bufferTimeSpan:e}))}},n.prototype.openContext=function(){var t=new gn;return this.contexts.push(t),t},n.prototype.closeContext=function(t){this.destination.next(t.buffer);var e=this.contexts;0<=(e?e.indexOf(t):-1)&&e.splice(e.indexOf(t),1)},n}(jt),vn=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new yn(t,this.openings,this.closingSelector))},t}(),yn=function(t){function n(e,n,i){return(e=t.call(this,e)||this).closingSelector=i,e.contexts=[],e.add(O(e,n)),e}return e(n,t),n.prototype._next=function(t){for(var e=this.contexts,n=e.length,i=0;i<n;i++)e[i].buffer.push(t)},n.prototype._error=function(e){for(var n=this.contexts;0<n.length;){var i=n.shift();i.subscription.unsubscribe(),i.buffer=null,i.subscription=null}this.contexts=null,t.prototype._error.call(this,e)},n.prototype._complete=function(){for(var e=this.contexts;0<e.length;){var n=e.shift();this.destination.next(n.buffer),n.subscription.unsubscribe(),n.buffer=null,n.subscription=null}this.contexts=null,t.prototype._complete.call(this)},n.prototype.notifyNext=function(t,e){t?this.closeBuffer(t):this.openBuffer(e)},n.prototype.notifyComplete=function(t){this.closeBuffer(t.context)},n.prototype.openBuffer=function(t){try{var e=this.closingSelector.call(this,t);e&&this.trySubscribe(e)}catch(n){this._error(n)}},n.prototype.closeBuffer=function(t){var e=this.contexts;if(e&&t){var n=t.subscription;this.destination.next(t.buffer),e.splice(e.indexOf(t),1),this.remove(n),n.unsubscribe()}},n.prototype.trySubscribe=function(t){var e=this.contexts,n=new Bt,i={buffer:[],subscription:n};e.push(i),!(t=O(this,t,i))||t.closed?this.closeBuffer(i):(t.context=i,this.add(t),n.add(t))},n}(ze),bn=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new Cn(t,this.closingSelector))},t}(),Cn=function(t){function n(e,n){return(e=t.call(this,e)||this).closingSelector=n,e.subscribing=!1,e.openBuffer(),e}return e(n,t),n.prototype._next=function(t){this.buffer.push(t)},n.prototype._complete=function(){var e=this.buffer;e&&this.destination.next(e),t.prototype._complete.call(this)},n.prototype._unsubscribe=function(){this.buffer=void 0,this.subscribing=!1},n.prototype.notifyNext=function(){this.openBuffer()},n.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},n.prototype.openBuffer=function(){var t,e=this.closingSubscription;e&&(this.remove(e),e.unsubscribe()),(e=this.buffer)&&this.destination.next(e),this.buffer=[];try{t=(0,this.closingSelector)()}catch(n){return this.error(n)}this.closingSubscription=e=new Bt,this.add(e),this.subscribing=!0,e.add(k(t,new Ze(this))),this.subscribing=!1},n}(We),In=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new En(t,this.selector,this.caught))},t}(),En=function(t){function n(e,n,i){return(e=t.call(this,e)||this).selector=n,e.caught=i,e}return e(n,t),n.prototype.error=function(e){if(!this.isStopped){var n=void 0;try{n=this.selector(e,this.caught)}catch(i){return void t.prototype.error.call(this,i)}this._unsubscribeAndRecycle(),e=new Ze(this),this.add(e),(n=k(n,e))!==e&&this.add(n)}},n}(We),Tn=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new wn(t,this.predicate,this.source))},t}(),wn=function(t){function n(e,n,i){return(e=t.call(this,e)||this).predicate=n,e.source=i,e.count=0,e.index=0,e}return e(n,t),n.prototype._next=function(t){this.predicate?this._tryPredicate(t):this.count++},n.prototype._tryPredicate=function(t){var e;try{e=this.predicate(t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e&&this.count++},n.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},n}(jt),xn=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new _n(t,this.durationSelector))},t}(),_n=function(t){function n(e,n){return(e=t.call(this,e)||this).durationSelector=n,e.hasValue=!1,e}return e(n,t),n.prototype._next=function(t){try{var e=this.durationSelector.call(this,t);e&&this._tryNext(t,e)}catch(n){this.destination.error(n)}},n.prototype._complete=function(){this.emitValue(),this.destination.complete()},n.prototype._tryNext=function(t,e){var n=this.durationSubscription;this.value=t,this.hasValue=!0,n&&(n.unsubscribe(),this.remove(n)),(n=k(e,new Ze(this)))&&!n.closed&&this.add(this.durationSubscription=n)},n.prototype.notifyNext=function(){this.emitValue()},n.prototype.notifyComplete=function(){this.emitValue()},n.prototype.emitValue=function(){if(this.hasValue){var e=this.value,n=this.durationSubscription;n&&(this.durationSubscription=void 0,n.unsubscribe(),this.remove(n)),this.value=void 0,this.hasValue=!1,t.prototype._next.call(this,e)}},n}(We),Dn=function(){function t(t,e){this.dueTime=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new An(t,this.dueTime,this.scheduler))},t}(),An=function(t){function n(e,n,i){return(e=t.call(this,e)||this).dueTime=n,e.scheduler=i,e.debouncedSubscription=null,e.lastValue=null,e.hasValue=!1,e}return e(n,t),n.prototype._next=function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(it,this.dueTime,this))},n.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},n.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var t=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}},n.prototype.clearDebounce=function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)},n}(jt),On=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new Sn(t,this.defaultValue))},t}(),Sn=function(t){function n(e,n){return(e=t.call(this,e)||this).defaultValue=n,e.isEmpty=!0,e}return e(n,t),n.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},n.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},n}(jt),Rn=function(){function t(t,e){this.delay=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new kn(t,this.delay,this.scheduler))},t}(),kn=function(t){function n(e,n,i){return(e=t.call(this,e)||this).delay=n,e.scheduler=i,e.queue=[],e.active=!1,e.errored=!1,e}return e(n,t),n.dispatch=function(t){for(var e=t.source,n=e.queue,i=t.scheduler,r=t.destination;0<n.length&&0>=n[0].time-i.now();)n.shift().notification.observe(r);0<n.length?(e=Math.max(0,n[0].time-i.now()),this.schedule(t,e)):(this.unsubscribe(),e.active=!1)},n.prototype._schedule=function(t){this.active=!0,this.destination.add(t.schedule(n.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))},n.prototype.scheduleNotification=function(t){if(!0!==this.errored){var e=this.scheduler;t=new Nn(e.now()+this.delay,t),this.queue.push(t),!1===this.active&&this._schedule(e)}},n.prototype._next=function(t){this.scheduleNotification(pe.createNext(t))},n.prototype._error=function(t){this.errored=!0,this.queue=[],this.destination.error(t),this.unsubscribe()},n.prototype._complete=function(){this.scheduleNotification(pe.createComplete()),this.unsubscribe()},n}(jt),Nn=function(t,e){this.time=t,this.notification=e},Mn=function(){function t(t){this.delayDurationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new Pn(t,this.delayDurationSelector))},t}(),Pn=function(t){function n(e,n){return(e=t.call(this,e)||this).delayDurationSelector=n,e.completed=!1,e.delayNotifierSubscriptions=[],e.index=0,e}return e(n,t),n.prototype.notifyNext=function(t,e,n,i,r){this.destination.next(t),this.removeSubscription(r),this.tryComplete()},n.prototype.notifyError=function(t,e){this._error(t)},n.prototype.notifyComplete=function(t){(t=this.removeSubscription(t))&&this.destination.next(t),this.tryComplete()},n.prototype._next=function(t){var e=this.index++;try{var n=this.delayDurationSelector(t,e);n&&this.tryDelay(n,t)}catch(i){this.destination.error(i)}},n.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},n.prototype.removeSubscription=function(t){t.unsubscribe();var e=this.delayNotifierSubscriptions.indexOf(t);return-1!==e&&this.delayNotifierSubscriptions.splice(e,1),t.outerValue},n.prototype.tryDelay=function(t,e){(t=O(this,t,e))&&!t.closed&&(this.destination.add(t),this.delayNotifierSubscriptions.push(t))},n.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},n}(ze),Ln=function(t){function n(e,n){var i=t.call(this)||this;return i.source=e,i.subscriptionDelay=n,i}return e(n,t),n.prototype._subscribe=function(t){this.subscriptionDelay.subscribe(new Kn(t,this.source))},n}(Vt),Kn=function(t){function n(e,n){var i=t.call(this)||this;return i.parent=e,i.source=n,i.sourceSubscribed=!1,i}return e(n,t),n.prototype._next=function(t){this.subscribeToSource()},n.prototype._error=function(t){this.unsubscribe(),this.parent.error(t)},n.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},n.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},n}(jt),Bn=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new zn(t))},t}(),zn=function(t){function n(e){return t.call(this,e)||this}return e(n,t),n.prototype._next=function(t){t.observe(this.destination)},n}(jt),jn=function(){function t(t,e){this.keySelector=t,this.flushes=e}return t.prototype.call=function(t,e){return e.subscribe(new Gn(t,this.keySelector,this.flushes))},t}(),Gn=function(t){function n(e,n,i){return(e=t.call(this,e)||this).keySelector=n,e.values=new Set,i&&e.add(k(i,new Ze(e))),e}return e(n,t),n.prototype.notifyNext=function(){this.values.clear()},n.prototype.notifyError=function(t){this._error(t)},n.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},n.prototype._useKeySelector=function(t){var e,n=this.destination;try{e=this.keySelector(t)}catch(i){return void n.error(i)}this._finalizeNext(e,t)},n.prototype._finalizeNext=function(t,e){var n=this.values;n.has(t)||(n.add(t),this.destination.next(e))},n}(We),Fn=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new Vn(t,this.compare,this.keySelector))},t}(),Vn=function(t){function n(e,n,i){return(e=t.call(this,e)||this).keySelector=i,e.hasKey=!1,"function"==typeof n&&(e.compare=n),e}return e(n,t),n.prototype.compare=function(t,e){return t===e},n.prototype._next=function(t){var e;try{e=(n=this.keySelector)?n(t):t}catch(g){return this.destination.error(g)}if(n=!1,this.hasKey)try{var n=(0,this.compare)(this.key,e)}catch(g){return this.destination.error(g)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))},n}(jt),Hn=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new Un(t,this.errorFactory))},t}(),Un=function(t){function n(e,n){return(e=t.call(this,e)||this).errorFactory=n,e.hasValue=!1,e}return e(n,t),n.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},n.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},n}(jt),Zn=function(){function t(t){if(this.total=t,0>this.total)throw new Me}return t.prototype.call=function(t,e){return e.subscribe(new Wn(t,this.total))},t}(),Wn=function(t){function n(e,n){return(e=t.call(this,e)||this).total=n,e.count=0,e}return e(n,t),n.prototype._next=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},n}(jt),$n=function(){function t(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}return t.prototype.call=function(t,e){return e.subscribe(new Yn(t,this.predicate,this.thisArg,this.source))},t}(),Yn=function(t){function n(e,n,i,r){return(e=t.call(this,e)||this).predicate=n,e.thisArg=i,e.source=r,e.index=0,e.thisArg=i||e,e}return e(n,t),n.prototype.notifyComplete=function(t){this.destination.next(t),this.destination.complete()},n.prototype._next=function(t){var e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e||this.notifyComplete(!1)},n.prototype._complete=function(){this.notifyComplete(!0)},n}(jt),Xn=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new qn(t))},t}(),qn=function(t){function n(e){return(e=t.call(this,e)||this).hasCompleted=!1,e.hasSubscription=!1,e}return e(n,t),n.prototype._next=function(t){this.hasSubscription||(this.hasSubscription=!0,this.add(k(t,new Ze(this))))},n.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},n.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},n}(We),Jn=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new Qn(t,this.project))},t}(),Qn=function(t){function n(e,n){return(e=t.call(this,e)||this).project=n,e.hasSubscription=!1,e.hasCompleted=!1,e.index=0,e}return e(n,t),n.prototype._next=function(t){this.hasSubscription||this.tryNext(t)},n.prototype.tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(i){return void this.destination.error(i)}this.hasSubscription=!0,this._innerSub(e)},n.prototype._innerSub=function(t){var e=new Ze(this),n=this.destination;n.add(e),(t=k(t,e))!==e&&n.add(t)},n.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},n.prototype.notifyNext=function(t){this.destination.next(t)},n.prototype.notifyError=function(t){this.destination.error(t)},n.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},n}(We),ti=function(){function t(t,e,n){this.project=t,this.concurrent=e,this.scheduler=n}return t.prototype.call=function(t,e){return e.subscribe(new ei(t,this.project,this.concurrent,this.scheduler))},t}(),ei=function(t){function n(e,n,i,r){return(e=t.call(this,e)||this).project=n,e.concurrent=i,e.scheduler=r,e.index=0,e.active=0,e.hasCompleted=!1,i<Number.POSITIVE_INFINITY&&(e.buffer=[]),e}return e(n,t),n.dispatch=function(t){t.subscriber.subscribeToProjection(t.result,t.value,t.index)},n.prototype._next=function(t){var e=this.destination;if(e.closed)this._complete();else{var i=this.index++;if(this.active<this.concurrent){e.next(t);try{var r=(0,this.project)(t,i);this.scheduler?this.destination.add(this.scheduler.schedule(n.dispatch,0,{subscriber:this,result:r,value:t,index:i})):this.subscribeToProjection(r,t,i)}catch(o){e.error(o)}}else this.buffer.push(t)}},n.prototype.subscribeToProjection=function(t,e,n){this.active++,this.destination.add(k(t,new Ze(this)))},n.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&this.destination.complete(),this.unsubscribe()},n.prototype.notifyNext=function(t){this._next(t)},n.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t&&0<t.length&&this._next(t.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},n}(We),ni=function(){function t(t){this.callback=t}return t.prototype.call=function(t,e){return e.subscribe(new ii(t,this.callback))},t}(),ii=function(t){function n(e,n){return(e=t.call(this,e)||this).add(new Bt(n)),e}return e(n,t),n}(jt),ri=function(){function t(t,e,n,i){this.predicate=t,this.source=e,this.yieldIndex=n,this.thisArg=i}return t.prototype.call=function(t,e){return e.subscribe(new oi(t,this.predicate,this.source,this.yieldIndex,this.thisArg))},t}(),oi=function(t){function n(e,n,i,r,o){return(e=t.call(this,e)||this).predicate=n,e.source=i,e.yieldIndex=r,e.thisArg=o,e.index=0,e}return e(n,t),n.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete(),this.unsubscribe()},n.prototype._next=function(t){var e=this.predicate,n=this.thisArg,i=this.index++;try{e.call(n||this,t,i,this.source)&&this.notifyComplete(this.yieldIndex?i:t)}catch(g){this.destination.error(g)}},n.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},n}(jt),si=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new ai(t))},t}(),ai=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype._next=function(t){},n}(jt),li=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new ci(t))},t}(),ci=function(t){function n(e){return t.call(this,e)||this}return e(n,t),n.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},n.prototype._next=function(t){this.notifyComplete(!1)},n.prototype._complete=function(){this.notifyComplete(!0)},n}(jt),ui=function(){function t(t){if(this.total=t,0>this.total)throw new Me}return t.prototype.call=function(t,e){return e.subscribe(new hi(t,this.total))},t}(),hi=function(t){function n(e,n){return(e=t.call(this,e)||this).total=n,e.ring=[],e.count=0,e}return e(n,t),n.prototype._next=function(t){var e=this.ring,n=this.total,i=this.count++;e.length<n?e.push(t):e[i%n]=t},n.prototype._complete=function(){var t=this.destination,e=this.count;if(0<e)for(var n=this.count>=this.total?this.total:this.count,i=this.ring,r=0;r<n;r++){var o=e++%n;t.next(i[o])}t.complete()},n}(jt),di=function(){function t(t){this.value=t}return t.prototype.call=function(t,e){return e.subscribe(new fi(t,this.value))},t}(),fi=function(t){function n(e,n){return(e=t.call(this,e)||this).value=n,e}return e(n,t),n.prototype._next=function(t){this.destination.next(this.value)},n}(jt),pi=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new gi(t))},t}(),gi=function(t){function n(e){return t.call(this,e)||this}return e(n,t),n.prototype._next=function(t){this.destination.next(pe.createNext(t))},n.prototype._error=function(t){var e=this.destination;e.next(pe.createError(t)),e.complete()},n.prototype._complete=function(){var t=this.destination;t.next(pe.createComplete()),t.complete()},n}(jt),mi=function(){function t(t,e,n){void 0===n&&(n=!1),this.accumulator=t,this.seed=e,this.hasSeed=n}return t.prototype.call=function(t,e){return e.subscribe(new vi(t,this.accumulator,this.seed,this.hasSeed))},t}(),vi=function(t){function n(e,n,i,r){return(e=t.call(this,e)||this).accumulator=n,e._seed=i,e.hasSeed=r,e.index=0,e}return e(n,t),Object.defineProperty(n.prototype,"seed",{get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t},enumerable:!0,configurable:!0}),n.prototype._next=function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)},n.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.accumulator(this.seed,t,n)}catch(i){this.destination.error(i)}this.seed=e,this.destination.next(e)},n}(jt),yi=function(){function t(t,e,n){this.accumulator=t,this.seed=e,this.concurrent=n}return t.prototype.call=function(t,e){return e.subscribe(new bi(t,this.accumulator,this.seed,this.concurrent))},t}(),bi=function(t){function n(e,n,i,r){return(e=t.call(this,e)||this).accumulator=n,e.acc=i,e.concurrent=r,e.hasValue=!1,e.hasCompleted=!1,e.buffer=[],e.active=0,e.index=0,e}return e(n,t),n.prototype._next=function(t){if(this.active<this.concurrent){var e=this.index++,n=this.destination,i=void 0;try{i=(0,this.accumulator)(this.acc,t,e)}catch(r){return n.error(r)}this.active++,this._innerSub(i)}else this.buffer.push(t)},n.prototype._innerSub=function(t){var e=new Ze(this),n=this.destination;n.add(e),(t=k(t,e))!==e&&n.add(t)},n.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},n.prototype.notifyNext=function(t){var e=this.destination;this.acc=t,this.hasValue=!0,e.next(t)},n.prototype.notifyComplete=function(){var t=this.buffer;this.active--,0<t.length?this._next(t.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},n}(We),Ci=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var n=this.selector,i=this.subjectFactory();return(t=n(i).subscribe(t)).add(e.subscribe(i)),t},t}(),Ii=function(){function t(t){this.nextSources=t}return t.prototype.call=function(t,e){return e.subscribe(new Ei(t,this.nextSources))},t}(),Ei=function(t){function n(e,n){var i=t.call(this,e)||this;return i.destination=e,i.nextSources=n,i}return e(n,t),n.prototype.notifyError=function(){this.subscribeToNextSource()},n.prototype.notifyComplete=function(){this.subscribeToNextSource()},n.prototype._error=function(t){this.subscribeToNextSource(),this.unsubscribe()},n.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},n.prototype.subscribeToNextSource=function(){var t=this.nextSources.shift();if(t){var e=new Ze(this),n=this.destination;n.add(e),(t=k(t,e))!==e&&n.add(t)}else this.destination.complete()},n}(We),Ti=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new wi(t))},t}(),wi=function(t){function n(e){return(e=t.call(this,e)||this).hasPrev=!1,e}return e(n,t),n.prototype._next=function(t){var e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)},n}(jt),xi=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new _i(t,this.count,this.source))},t}(),_i=function(t){function n(e,n,i){return(e=t.call(this,e)||this).count=n,e.source=i,e}return e(n,t),n.prototype.complete=function(){if(!this.isStopped){var e=this.source,n=this.count;if(0===n)return t.prototype.complete.call(this);-1<n&&(this.count=n-1),e.subscribe(this._unsubscribeAndRecycle())}},n}(jt),Di=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new Ai(t,this.notifier,e))},t}(),Ai=function(t){function n(e,n,i){return(e=t.call(this,e)||this).notifier=n,e.source=i,e.sourceIsBeingSubscribedTo=!0,e}return e(n,t),n.prototype.notifyNext=function(){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},n.prototype.notifyComplete=function(){if(!1===this.sourceIsBeingSubscribedTo)return t.prototype.complete.call(this)},n.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return t.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next(void 0)}},n.prototype._unsubscribe=function(){var t=this.notifications,e=this.retriesSubscription;t&&(t.unsubscribe(),this.notifications=void 0),e&&(e.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},n.prototype._unsubscribeAndRecycle=function(){var e=this._unsubscribe;return this._unsubscribe=null,t.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=e,this},n.prototype.subscribeToRetries=function(){var e;this.notifications=new Wt;try{e=(0,this.notifier)(this.notifications)}catch(n){return t.prototype.complete.call(this)}this.retries=e,this.retriesSubscription=k(e,new Ze(this))},n}(We),Oi=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Si(t,this.count,this.source))},t}(),Si=function(t){function n(e,n,i){return(e=t.call(this,e)||this).count=n,e.source=i,e}return e(n,t),n.prototype.error=function(e){if(!this.isStopped){var n=this.source,i=this.count;if(0===i)return t.prototype.error.call(this,e);-1<i&&(this.count=i-1),n.subscribe(this._unsubscribeAndRecycle())}},n}(jt),Ri=function(){function t(t,e){this.notifier=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new ki(t,this.notifier,this.source))},t}(),ki=function(t){function n(e,n,i){return(e=t.call(this,e)||this).notifier=n,e.source=i,e}return e(n,t),n.prototype.error=function(e){if(!this.isStopped){var n=this.errors,i=this.retries,r=this.retriesSubscription;if(i)this.retriesSubscription=this.errors=void 0;else{n=new Wt;try{i=(0,this.notifier)(n)}catch(o){return t.prototype.error.call(this,o)}r=k(i,new Ze(this))}this._unsubscribeAndRecycle(),this.errors=n,this.retries=i,this.retriesSubscription=r,n.next(e)}},n.prototype._unsubscribe=function(){var t=this.errors,e=this.retriesSubscription;t&&(t.unsubscribe(),this.errors=void 0),e&&(e.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},n.prototype.notifyNext=function(){var t=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=t,this.source.subscribe(this)},n}(We),Ni=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return t=new Mi(t),(e=e.subscribe(t)).add(k(this.notifier,new Ze(t))),e},t}(),Mi=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasValue=!1,e}return e(n,t),n.prototype._next=function(t){this.value=t,this.hasValue=!0},n.prototype.notifyNext=function(){this.emitValue()},n.prototype.notifyComplete=function(){this.emitValue()},n.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},n}(We),Pi=function(){function t(t,e){this.period=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new Li(t,this.period,this.scheduler))},t}(),Li=function(t){function n(e,n,i){return(e=t.call(this,e)||this).period=n,e.scheduler=i,e.hasValue=!1,e.add(i.schedule(ft,n,{subscriber:e,period:n})),e}return e(n,t),n.prototype._next=function(t){this.lastValue=t,this.hasValue=!0},n.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},n}(jt),Ki=function(){function t(t,e){this.compareTo=t,this.comparator=e}return t.prototype.call=function(t,e){return e.subscribe(new Bi(t,this.compareTo,this.comparator))},t}(),Bi=function(t){function n(e,n,i){var r=t.call(this,e)||this;return r.compareTo=n,r.comparator=i,r._a=[],r._b=[],r._oneComplete=!1,r.destination.add(n.subscribe(new zi(e,r))),r}return e(n,t),n.prototype._next=function(t){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(t),this.checkValues())},n.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0,this.unsubscribe()},n.prototype.checkValues=function(){for(var t=this._a,e=this._b,n=this.comparator;0<t.length&&0<e.length;){var i=t.shift(),r=e.shift(),o=!1;try{o=n?n(i,r):i===r}catch(s){this.destination.error(s)}o||this.emit(!1)}},n.prototype.emit=function(t){var e=this.destination;e.next(t),e.complete()},n.prototype.nextB=function(t){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(t),this.checkValues())},n.prototype.completeB=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},n}(jt),zi=function(t){function n(e,n){return(e=t.call(this,e)||this).parent=n,e}return e(n,t),n.prototype._next=function(t){this.parent.nextB(t)},n.prototype._error=function(t){this.parent.error(t),this.unsubscribe()},n.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},n}(jt),ji=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Gi(t,this.predicate,this.source))},t}(),Gi=function(t){function n(e,n,i){return(e=t.call(this,e)||this).predicate=n,e.source=i,e.seenValue=!1,e.index=0,e}return e(n,t),n.prototype.applySingleValue=function(t){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=t)},n.prototype._next=function(t){var e=this.index++;this.predicate?this.tryNext(t,e):this.applySingleValue(t)},n.prototype.tryNext=function(t,e){try{this.predicate(t,e,this.source)&&this.applySingleValue(t)}catch(n){this.destination.error(n)}},n.prototype._complete=function(){var t=this.destination;0<this.index?(t.next(this.seenValue?this.singleValue:void 0),t.complete()):t.error(new Pe)},n}(jt),Fi=function(){function t(t){this.total=t}return t.prototype.call=function(t,e){return e.subscribe(new Vi(t,this.total))},t}(),Vi=function(t){function n(e,n){return(e=t.call(this,e)||this).total=n,e.count=0,e}return e(n,t),n.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},n}(jt),Hi=function(){function t(t){if(this._skipCount=t,0>this._skipCount)throw new Me}return t.prototype.call=function(t,e){return 0===this._skipCount?e.subscribe(new jt(t)):e.subscribe(new Ui(t,this._skipCount))},t}(),Ui=function(t){function n(e,n){return(e=t.call(this,e)||this)._skipCount=n,e._count=0,e._ring=Array(n),e}return e(n,t),n.prototype._next=function(t){var e=this._skipCount;if((n=this._count++)<e)this._ring[n]=t;else{e=n%e;var n,i=(n=this._ring)[e];n[e]=t,this.destination.next(i)}},n}(jt),Zi=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new Wi(t,this.notifier))},t}(),Wi=function(t){function n(e,n){(e=t.call(this,e)||this).hasValue=!1;var i=new Ze(e);return e.add(i),e.innerSubscription=i,(n=k(n,i))!==i&&(e.add(n),e.innerSubscription=n),e}return e(n,t),n.prototype._next=function(e){this.hasValue&&t.prototype._next.call(this,e)},n.prototype.notifyNext=function(){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},n.prototype.notifyComplete=function(){},n}(We),$i=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new Yi(t,this.predicate))},t}(),Yi=function(t){function n(e,n){return(e=t.call(this,e)||this).predicate=n,e.skipping=!0,e.index=0,e}return e(n,t),n.prototype._next=function(t){var e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)},n.prototype.tryCallPredicate=function(t){try{this.skipping=!!this.predicate(t,this.index++)}catch(e){this.destination.error(e)}},n}(jt),Xi=function(t){function n(e,n,i){void 0===n&&(n=0),void 0===i&&(i=De);var r=t.call(this)||this;return r.source=e,r.delayTime=n,r.scheduler=i,(!G(n)||0>n)&&(r.delayTime=0),i&&"function"==typeof i.schedule||(r.scheduler=De),r}return e(n,t),n.create=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=De),new n(t,e,i)},n.dispatch=function(t){return this.add(t.source.subscribe(t.subscriber))},n.prototype._subscribe=function(t){return this.scheduler.schedule(n.dispatch,this.delayTime,{source:this.source,subscriber:t})},n}(Vt),qi=function(){function t(t,e){this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return new Xi(e,this.delay,this.scheduler).subscribe(t)},t}(),Ji=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new Qi(t,this.project))},t}(),Qi=function(t){function n(e,n){return(e=t.call(this,e)||this).project=n,e.index=0,e}return e(n,t),n.prototype._next=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(i){return void this.destination.error(i)}this._innerSub(e)},n.prototype._innerSub=function(t){(e=this.innerSubscription)&&e.unsubscribe();var e=new Ze(this),n=this.destination;n.add(e),this.innerSubscription=k(t,e),this.innerSubscription!==e&&n.add(this.innerSubscription)},n.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this),this.unsubscribe()},n.prototype._unsubscribe=function(){this.innerSubscription=void 0},n.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&t.prototype._complete.call(this)},n.prototype.notifyNext=function(t){this.destination.next(t)},n}(We),tr=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){t=new er(t);var n=k(this.notifier,new Ze(t));return n&&!t.seenValue?(t.add(n),e.subscribe(t)):t},t}(),er=function(t){function n(e){return(e=t.call(this,e)||this).seenValue=!1,e}return e(n,t),n.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},n.prototype.notifyComplete=function(){},n}(We),nr=function(){function t(t,e){this.predicate=t,this.inclusive=e}return t.prototype.call=function(t,e){return e.subscribe(new ir(t,this.predicate,this.inclusive))},t}(),ir=function(t){function n(e,n,i){return(e=t.call(this,e)||this).predicate=n,e.inclusive=i,e.index=0,e}return e(n,t),n.prototype._next=function(t){var e,n=this.destination;try{e=this.predicate(t,this.index++)}catch(i){return void n.error(i)}this.nextOrComplete(t,e)},n.prototype.nextOrComplete=function(t,e){var n=this.destination;e?n.next(t):(this.inclusive&&n.next(t),n.complete())},n}(jt),rr=function(){function t(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}return t.prototype.call=function(t,e){return e.subscribe(new or(t,this.nextOrObserver,this.error,this.complete))},t}(),or=function(t){function i(e,i,r,o){return(e=t.call(this,e)||this)._tapNext=I,e._tapError=I,e._tapComplete=I,e._tapError=r||I,e._tapComplete=o||I,n(i)?(e._context=e,e._tapNext=i):i&&(e._context=i,e._tapNext=i.next||I,e._tapError=i.error||I,e._tapComplete=i.complete||I),e}return e(i,t),i.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)},i.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.error(t)},i.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},i}(jt),sr={leading:!0,trailing:!1},ar=function(){function t(t,e,n){this.durationSelector=t,this.leading=e,this.trailing=n}return t.prototype.call=function(t,e){return e.subscribe(new lr(t,this.durationSelector,this.leading,this.trailing))},t}(),lr=function(t){function n(e,n,i,r){var o=t.call(this,e)||this;return o.destination=e,o.durationSelector=n,o._leading=i,o._trailing=r,o._hasValue=!1,o}return e(n,t),n.prototype._next=function(t){this._hasValue=!0,this._sendValue=t,this._throttled||(this._leading?this.send():this.throttle(t))},n.prototype.send=function(){var t=this._sendValue;this._hasValue&&(this.destination.next(t),this.throttle(t)),this._hasValue=!1,this._sendValue=void 0},n.prototype.throttle=function(t){(t=this.tryDurationSelector(t))&&this.add(this._throttled=k(t,new Ze(this)))},n.prototype.tryDurationSelector=function(t){try{return this.durationSelector(t)}catch(e){return this.destination.error(e),null}},n.prototype.throttlingDone=function(){var t=this._throttled,e=this._trailing;t&&t.unsubscribe(),this._throttled=void 0,e&&this.send()},n.prototype.notifyNext=function(){this.throttlingDone()},n.prototype.notifyComplete=function(){this.throttlingDone()},n}(We),cr=function(){function t(t,e,n,i){this.duration=t,this.scheduler=e,this.leading=n,this.trailing=i}return t.prototype.call=function(t,e){return e.subscribe(new ur(t,this.duration,this.scheduler,this.leading,this.trailing))},t}(),ur=function(t){function n(e,n,i,r,o){return(e=t.call(this,e)||this).duration=n,e.scheduler=i,e.leading=r,e.trailing=o,e._hasTrailingValue=!1,e._trailingValue=null,e}return e(n,t),n.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(mt,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))},n.prototype._complete=function(){this._hasTrailingValue&&this.destination.next(this._trailingValue),this.destination.complete()},n.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)},n}(jt),hr=function(t,e){this.value=t,this.interval=e},dr=function(){function t(t,e,n,i){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=n,this.scheduler=i}return t.prototype.call=function(t,e){return e.subscribe(new fr(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},t}(),fr=function(t){function n(e,n,i,r,o){return(e=t.call(this,e)||this).absoluteTimeout=n,e.waitFor=i,e.withObservable=r,e.scheduler=o,e.scheduleTimeout(),e}return e(n,t),n.dispatchTimeout=function(t){var e=t.withObservable;t._unsubscribeAndRecycle(),t.add(k(e,new Ze(t)))},n.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(n.dispatchTimeout,this.waitFor,this))},n.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},n.prototype._unsubscribe=function(){this.action=void 0,this.withObservable=this.scheduler=null},n}(We),pr=function(t,e){this.value=t,this.timestamp=e},gr=function(){function t(t){this.windowBoundaries=t}return t.prototype.call=function(t,e){return t=new mr(t),(e=e.subscribe(t)).closed||t.add(k(this.windowBoundaries,new Ze(t))),e},t}(),mr=function(t){function n(e){var n=t.call(this,e)||this;return n.window=new Wt,e.next(n.window),n}return e(n,t),n.prototype.notifyNext=function(){this.openWindow()},n.prototype.notifyError=function(t){this._error(t)},n.prototype.notifyComplete=function(){this._complete()},n.prototype._next=function(t){this.window.next(t)},n.prototype._error=function(t){this.window.error(t),this.destination.error(t)},n.prototype._complete=function(){this.window.complete(),this.destination.complete()},n.prototype._unsubscribe=function(){this.window=null},n.prototype.openWindow=function(){(t=this.window)&&t.complete();var t=this.destination,e=this.window=new Wt;t.next(e)},n}(We),vr=function(){function t(t,e){this.windowSize=t,this.startWindowEvery=e}return t.prototype.call=function(t,e){return e.subscribe(new yr(t,this.windowSize,this.startWindowEvery))},t}(),yr=function(t){function n(e,n,i){var r=t.call(this,e)||this;return r.destination=e,r.windowSize=n,r.startWindowEvery=i,r.windows=[new Wt],r.count=0,e.next(r.windows[0]),r}return e(n,t),n.prototype._next=function(t){for(var e=0<this.startWindowEvery?this.startWindowEvery:this.windowSize,n=this.destination,i=this.windowSize,r=this.windows,o=r.length,s=0;s<o&&!this.closed;s++)r[s].next(t);0<=(t=this.count-i+1)&&0==t%e&&!this.closed&&r.shift().complete(),0!=++this.count%e||this.closed||(e=new Wt,r.push(e),n.next(e))},n.prototype._error=function(t){var e=this.windows;if(e)for(;0<e.length&&!this.closed;)e.shift().error(t);this.destination.error(t)},n.prototype._complete=function(){var t=this.windows;if(t)for(;0<t.length&&!this.closed;)t.shift().complete();this.destination.complete()},n.prototype._unsubscribe=function(){this.count=0,this.windows=null},n}(jt),br=function(){function t(t,e,n,i){this.windowTimeSpan=t,this.windowCreationInterval=e,this.maxWindowSize=n,this.scheduler=i}return t.prototype.call=function(t,e){return e.subscribe(new Ir(t,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},t}(),Cr=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e._numberOfNextedValues=0,e}return e(n,t),n.prototype.next=function(e){this._numberOfNextedValues++,t.prototype.next.call(this,e)},Object.defineProperty(n.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),n}(Wt),Ir=function(t){function n(e,n,i,r,o){var s=t.call(this,e)||this;return s.destination=e,s.windowTimeSpan=n,s.windowCreationInterval=i,s.maxWindowSize=r,s.scheduler=o,s.windows=[],e=s.openWindow(),null!==i&&0<=i?(r={windowTimeSpan:n,windowCreationInterval:i,subscriber:s,scheduler:o},s.add(o.schedule(It,n,{subscriber:s,window:e,context:null})),s.add(o.schedule(Ct,i,r))):s.add(o.schedule(bt,n,{subscriber:s,window:e,windowTimeSpan:n})),s}return e(n,t),n.prototype._next=function(t){for(var e=this.windows,n=e.length,i=0;i<n;i++){var r=e[i];r.closed||(r.next(t),r.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(r))}},n.prototype._error=function(t){for(var e=this.windows;0<e.length;)e.shift().error(t);this.destination.error(t)},n.prototype._complete=function(){for(var t=this.windows;0<t.length;){var e=t.shift();e.closed||e.complete()}this.destination.complete()},n.prototype.openWindow=function(){var t=new Cr;return this.windows.push(t),this.destination.next(t),t},n.prototype.closeWindow=function(t){t.complete();var e=this.windows;e.splice(e.indexOf(t),1)},n}(jt),Er=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new Tr(t,this.openings,this.closingSelector))},t}(),Tr=function(t){function n(e,n,i){return(e=t.call(this,e)||this).openings=n,e.closingSelector=i,e.contexts=[],e.add(e.openSubscription=O(e,n,n)),e}return e(n,t),n.prototype._next=function(t){var e=this.contexts;if(e)for(var n=e.length,i=0;i<n;i++)e[i].window.next(t)},n.prototype._error=function(e){var n=this.contexts;if(this.contexts=null,n)for(var i=n.length,r=-1;++r<i;){var o=n[r];o.window.error(e),o.subscription.unsubscribe()}t.prototype._error.call(this,e)},n.prototype._complete=function(){var e=this.contexts;if(this.contexts=null,e)for(var n=e.length,i=-1;++i<n;){var r=e[i];r.window.complete(),r.subscription.unsubscribe()}t.prototype._complete.call(this)},n.prototype._unsubscribe=function(){var t=this.contexts;if(this.contexts=null,t)for(var e=t.length,n=-1;++n<e;){var i=t[n];i.window.unsubscribe(),i.subscription.unsubscribe()}},n.prototype.notifyNext=function(t,e,n,i,r){if(t===this.openings){t=void 0;try{var o=this.closingSelector;t=o(e)}catch(s){return this.error(s)}n={window:e=new Wt,subscription:o=new Bt},this.contexts.push(n),(t=O(this,t,n)).closed?this.closeWindow(this.contexts.length-1):(t.context=n,o.add(t)),this.destination.next(e)}else this.closeWindow(this.contexts.indexOf(t))},n.prototype.notifyError=function(t){this.error(t)},n.prototype.notifyComplete=function(t){t!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(t.context))},n.prototype.closeWindow=function(t){if(-1!==t){var e=this.contexts,n=(i=e[t]).window,i=i.subscription;e.splice(t,1),n.complete(),i.unsubscribe()}},n}(ze),wr=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new xr(t,this.closingSelector))},t}(),xr=function(t){function n(e,n){var i=t.call(this,e)||this;return i.destination=e,i.closingSelector=n,i.openWindow(),i}return e(n,t),n.prototype.notifyNext=function(t,e,n,i,r){this.openWindow(r)},n.prototype.notifyError=function(t){this._error(t)},n.prototype.notifyComplete=function(t){this.openWindow(t)},n.prototype._next=function(t){this.window.next(t)},n.prototype._error=function(t){this.window.error(t),this.destination.error(t),this.unsubscribeClosingNotification()},n.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},n.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},n.prototype.openWindow=function(t){var e;void 0===t&&(t=null),t&&(this.remove(t),t.unsubscribe()),(t=this.window)&&t.complete(),t=this.window=new Wt,this.destination.next(t);try{e=(0,this.closingSelector)()}catch(n){return this.destination.error(n),void this.window.error(n)}this.add(this.closingNotification=O(this,e))},n}(ze),_r=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new Dr(t,this.observables,this.project))},t}(),Dr=function(t){function n(e,n,i){(e=t.call(this,e)||this).observables=n,e.project=i,e.toRespond=[],i=n.length,e.values=Array(i);for(var r=0;r<i;r++)e.toRespond.push(r);for(r=0;r<i;r++)e.add(O(e,n[r],void 0,r));return e}return e(n,t),n.prototype.notifyNext=function(t,e,n){this.values[n]=e,0<(t=this.toRespond).length&&(-1!==(n=t.indexOf(n))&&t.splice(n,1))},n.prototype.notifyComplete=function(){},n.prototype._next=function(t){0===this.toRespond.length&&(t=[t].concat(this.values),this.project?this._tryProject(t):this.destination.next(t))},n.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)},n}(ze),Ar=Object.freeze({audit:J,auditTime:function(t,e){return void 0===e&&(e=Oe),J(function(){return Y(t,e)})},buffer:function(t){return function(e){return e.lift(new cn(t))}},bufferCount:function(t,e){return void 0===e&&(e=null),function(n){return n.lift(new hn(t,e))}},bufferTime:function(t){var e=arguments.length,n=Oe;f(arguments[arguments.length-1])&&(n=arguments[arguments.length-1],e--);var i=null;2<=e&&(i=arguments[1]);var r=Number.POSITIVE_INFINITY;return 3<=e&&(r=arguments[2]),function(e){return e.lift(new pn(t,i,r,n))}},bufferToggle:function(t,e){return function(n){return n.lift(new vn(t,e))}},bufferWhen:function(t){return function(e){return e.lift(new bn(t))}},catchError:function(t){return function(e){var n=new In(t);return e=e.lift(n),n.caught=e}},combineAll:function(t){return function(e){return e.lift(new He(t))}},combineLatest:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=null;return"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&Lt(t[0])&&(t=t[0].slice()),function(e){return e.lift.call(R([e].concat(t)),new He(n))}},concat:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(L.apply(void 0,[e].concat(t)))}},concatAll:P,concatMap:nt,concatMapTo:function(t,e){return nt(function(){return t},e)},count:function(t){return function(e){return e.lift(new Tn(t,e))}},debounce:function(t){return function(e){return e.lift(new xn(t))}},debounceTime:function(t,e){return void 0===e&&(e=Oe),function(n){return n.lift(new Dn(t,e))}},defaultIfEmpty:rt,delay:function(t,e){void 0===e&&(e=Oe);var n=t instanceof Date&&!isNaN(+t)?+t-e.now():Math.abs(t);return function(t){return t.lift(new Rn(n,e))}},delayWhen:function(t,e){return e?function(n){return new Ln(n,e).lift(new Mn(t))}:function(e){return e.lift(new Mn(t))}},dematerialize:function(){return function(t){return t.lift(new Bn)}},distinct:function(t,e){return function(n){return n.lift(new jn(t,e))}},distinctUntilChanged:ot,distinctUntilKeyChanged:function(t,e){return ot(function(n,i){return e?e(n[t],i[t]):n[t]===i[t]})},elementAt:function(t,e){if(0>t)throw new Me;var n=2<=arguments.length;return function(i){return i.pipe(Z(function(e,n){return n===t}),lt(1),n?rt(e):st(function(){return new Me}))}},endWith:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return L(e,v.apply(void 0,t))}},every:function(t,e){return function(n){return n.lift(new $n(t,e,n))}},exhaust:function(){return function(t){return t.lift(new Xn)}},exhaustMap:function t(e,n){return n?function(i){return i.pipe(t(function(t,i){return R(e(t,i)).pipe(E(function(e,r){return n(t,e,i,r)}))}))}:function(t){return t.lift(new Jn(e))}},expand:function(t,e,n){return void 0===e&&(e=Number.POSITIVE_INFINITY),e=1>(e||0)?Number.POSITIVE_INFINITY:e,function(i){return i.lift(new ti(t,e,n))}},filter:Z,finalize:function(t){return function(e){return e.lift(new ni(t))}},find:function(t,e){if("function"!=typeof t)throw new TypeError("predicate is not a function");return function(n){return n.lift(new ri(t,n,!1,e))}},findIndex:function(t,e){return function(n){return n.lift(new ri(t,n,!0,e))}},first:function(t,e){var n=2<=arguments.length;return function(i){return i.pipe(t?Z(function(e,n){return t(e,n,i)}):a,lt(1),n?rt(e):st(function(){return new Pe}))}},groupBy:function(t,e,n,i){return function(r){return r.lift(new te(t,e,n,i))}},ignoreElements:function(){return function(t){return t.lift(new si)}},isEmpty:function(){return function(t){return t.lift(new li)}},last:function(t,e){var n=2<=arguments.length;return function(i){return i.pipe(t?Z(function(e,n){return t(e,n,i)}):a,ct(1),n?rt(e):st(function(){return new Pe}))}},map:E,mapTo:function(t){return function(e){return e.lift(new di(t))}},materialize:function(){return function(t){return t.lift(new pi)}},max:function(t){return ht("function"==typeof t?function(e,n){return 0<t(e,n)?e:n}:function(t,e){return t>e?t:e})},merge:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(V.apply(void 0,[e].concat(t)))}},mergeAll:M,mergeMap:N,flatMap:N,mergeMapTo:function(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?N(function(){return t},e,n):("number"==typeof e&&(n=e),N(function(){return t},n))},mergeScan:function(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),function(i){return i.lift(new yi(t,e,n))}},min:function(t){return ht("function"==typeof t?function(e,n){return 0>t(e,n)?e:n}:function(t,e){return t<e?t:e})},multicast:dt,observeOn:function(t,e){return void 0===e&&(e=0),function(n){return n.lift(new ge(t,e))}},onErrorResumeNext:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 1===t.length&&Lt(t[0])&&(t=t[0]),function(e){return e.lift(new Ii(t))}},pairwise:function(){return function(t){return t.lift(new Ti)}},partition:function(t,e){return function(n){return[Z(t,e)(n),Z(U(t,e))(n)]}},pluck:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.length;if(0===n)throw Error("list of properties cannot be empty.");return function(e){return E(function(t,e){return function(n){var i=n;for(n=0;n<e;n++)if(void 0===(i=null!=i?i[t[n]]:void 0))return;return i}}(t,n))(e)}},publish:function(t){return t?dt(function(){return new Wt},t):dt(new Wt)},publishBehavior:function(t){return function(e){return dt(new oe(t))(e)}},publishLast:function(){return function(t){return dt(new Ce)(t)}},publishReplay:function(t,e,n,i){n&&"function"!=typeof n&&(i=n);var r="function"==typeof n?n:void 0,o=new ye(t,e,i);return function(t){return dt(function(){return o},r)(t)}},race:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return 1===t.length&&Lt(t[0])&&(t=t[0]),e.lift.call(W.apply(void 0,[e].concat(t)))}},reduce:ht,repeat:function(t){return void 0===t&&(t=-1),function(e){return 0===t?d():0>t?e.lift(new xi(-1,e)):e.lift(new xi(t-1,e))}},repeatWhen:function(t){return function(e){return e.lift(new Di(t))}},retry:function(t){return void 0===t&&(t=-1),function(e){return e.lift(new Oi(t,e))}},retryWhen:function(t){return function(e){return e.lift(new Ri(t,e))}},refCount:h,sample:function(t){return function(e){return e.lift(new Ni(t))}},sampleTime:function(t,e){return void 0===e&&(e=Oe),function(n){return n.lift(new Pi(t,e))}},scan:ut,sequenceEqual:function(t,e){return function(n){return n.lift(new Ki(t,e))}},share:function(){return function(t){return h()(dt(pt)(t))}},shareReplay:function(t,e,n){var i;return i=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},function(t){return t.lift(function(t){var e,n,i,r=void 0===(e=t.bufferSize)?Number.POSITIVE_INFINITY:e,o=void 0===(e=t.windowTime)?Number.POSITIVE_INFINITY:e,s=t.refCount,a=t.scheduler,l=0,c=!1,u=!1;return function(t){var e;l++,!n||c?(c=!1,n=new ye(r,o,a),e=n.subscribe(this),i=t.subscribe({next:function(t){n.next(t)},error:function(t){c=!0,n.error(t)},complete:function(){u=!0,i=void 0,n.complete()}}),u&&(i=void 0)):e=n.subscribe(this),this.add(function(){l--,e.unsubscribe(),e=void 0,i&&!u&&s&&0===l&&(i.unsubscribe(),n=i=void 0)})}}(i))}},single:function(t){return function(e){return e.lift(new ji(t,e))}},skip:function(t){return function(e){return e.lift(new Fi(t))}},skipLast:function(t){return function(e){return e.lift(new Hi(t))}},skipUntil:function(t){return function(e){return e.lift(new Zi(t))}},skipWhile:function(t){return function(e){return e.lift(new $i(t))}},startWith:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return f(n)?(t.pop(),function(e){return L(t,e,n)}):function(e){return L(t,e)}},subscribeOn:function(t,e){return void 0===e&&(e=0),function(n){return n.lift(new qi(t,e))}},switchAll:function(){return gt(a)},switchMap:gt,switchMapTo:function(t,e){return e?gt(function(){return t},e):gt(function(){return t})},take:lt,takeLast:ct,takeUntil:function(t){return function(e){return e.lift(new tr(t))}},takeWhile:function(t,e){return void 0===e&&(e=!1),function(n){return n.lift(new nr(t,e))}},tap:function(t,e,n){return function(i){return i.lift(new rr(t,e,n))}},throttle:function(t,e){return void 0===e&&(e=sr),function(n){return n.lift(new ar(t,!!e.leading,!!e.trailing))}},throttleTime:function(t,e,n){return void 0===e&&(e=Oe),void 0===n&&(n=sr),function(i){return i.lift(new cr(t,e,n.leading,n.trailing))}},throwIfEmpty:st,timeInterval:function(t){return void 0===t&&(t=Oe),function(e){return K(function(){return e.pipe(ut(function(e,n){return e=e.current,{value:n,current:t.now(),last:e}},{current:t.now(),value:void 0,last:void 0}),E(function(t){return new hr(t.value,t.current-t.last)}))})}},timeout:function(t,e){return void 0===e&&(e=Oe),vt(t,y(new Le),e)},timeoutWith:vt,timestamp:function(t){return void 0===t&&(t=Oe),E(function(e){return new pr(e,t.now())})},toArray:function(){return ht(yt,[])},window:function(t){return function(e){return e.lift(new gr(t))}},windowCount:function(t,e){return void 0===e&&(e=0),function(n){return n.lift(new vr(t,e))}},windowTime:function(t,e,n,i){var r=Oe,o=null,s=Number.POSITIVE_INFINITY;return f(i)&&(r=i),f(n)?r=n:G(n)&&(s=Number(n)),f(e)?r=e:G(e)&&(o=Number(e)),function(e){return e.lift(new br(t,o,s,r))}},windowToggle:function(t,e){return function(n){return n.lift(new Er(t,e))}},windowWhen:function(t){return function(e){return e.lift(new wr(t))}},withLatestFrom:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var n;return"function"==typeof t[t.length-1]&&(n=t.pop()),e.lift(new _r(t,n))}},zip:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(q.apply(void 0,[e].concat(t)))}},zipAll:function(t){return function(e){return e.lift(new en(t))}}}),Or=function(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.subscribedFrame=t,this.unsubscribedFrame=e},Sr=function(){function t(){this.subscriptions=[]}return t.prototype.logSubscribedFrame=function(){return this.subscriptions.push(new Or(this.scheduler.now())),this.subscriptions.length-1},t.prototype.logUnsubscribedFrame=function(t){var e=this.subscriptions;e[t]=new Or(e[t].subscribedFrame,this.scheduler.now())},t}(),Rr=function(t){function n(e,n){var i=t.call(this,function(t){var e=this,n=e.logSubscribedFrame(),i=new Bt;return i.add(new Bt(function(){e.logUnsubscribedFrame(n)})),e.scheduleMessages(t),i})||this;return i.messages=e,i.subscriptions=[],i.scheduler=n,i}return e(n,t),n.prototype.scheduleMessages=function(t){for(var e=this.messages.length,n=0;n<e;n++){var i=this.messages[n];t.add(this.scheduler.schedule(function(t){t.message.notification.observe(t.subscriber)},i.frame,{message:i,subscriber:t}))}},n}(Vt);Et(Rr,[Sr]);var kr=function(t){function n(e,n){var i=t.call(this)||this;return i.messages=e,i.subscriptions=[],i.scheduler=n,i}return e(n,t),n.prototype._subscribe=function(e){var n=this,i=n.logSubscribedFrame(),r=new Bt;return r.add(new Bt(function(){n.logUnsubscribedFrame(i)})),r.add(t.prototype._subscribe.call(this,e)),r},n.prototype.setup=function(){for(var t=this,e=t.messages.length,n=0;n<e;n++)!function(){var e=t.messages[n];t.scheduler.schedule(function(){e.notification.observe(t)},e.frame)}()},n}(Wt);Et(kr,[Sr]);var Nr=function(t){function n(e){var n=t.call(this,Ne,750)||this;return n.assertDeepEqual=e,n.hotObservables=[],n.coldObservables=[],n.flushTests=[],n.runMode=!1,n}return e(n,t),n.prototype.createTime=function(t){if(-1===(t=t.indexOf("|")))throw Error('marble diagram for time should have a completion marker "|"');return t*n.frameTimeFactor},n.prototype.createColdObservable=function(t,e,i){if(-1!==t.indexOf("^"))throw Error('cold observable cannot have subscription offset "^"');if(-1!==t.indexOf("!"))throw Error('cold observable cannot have unsubscription marker "!"');return t=n.parseMarbles(t,e,i,void 0,this.runMode),t=new Rr(t,this),this.coldObservables.push(t),t},n.prototype.createHotObservable=function(t,e,i){if(-1!==t.indexOf("!"))throw Error('hot observable cannot have unsubscription marker "!"');return t=n.parseMarbles(t,e,i,void 0,this.runMode),t=new kr(t,this),this.hotObservables.push(t),t},n.prototype.materializeInnerObservable=function(t,e){var n=this,i=[];return t.subscribe(function(t){i.push({frame:n.frame-e,notification:pe.createNext(t)})},function(t){i.push({frame:n.frame-e,notification:pe.createError(t)})},function(){i.push({frame:n.frame-e,notification:pe.createComplete()})}),i},n.prototype.expectObservable=function(t,e){var i=this;void 0===e&&(e=null);var r,o=[],s={actual:o,ready:!1},a=(e=n.parseMarblesAsSubscriptions(e,this.runMode)).unsubscribedFrame;this.schedule(function(){r=t.subscribe(function(t){var e=t;t instanceof Vt&&(e=i.materializeInnerObservable(e,i.frame)),o.push({frame:i.frame,notification:pe.createNext(e)})},function(t){o.push({frame:i.frame,notification:pe.createError(t)})},function(){o.push({frame:i.frame,notification:pe.createComplete()})})},e.subscribedFrame===Number.POSITIVE_INFINITY?0:e.subscribedFrame),a!==Number.POSITIVE_INFINITY&&this.schedule(function(){return r.unsubscribe()},a),this.flushTests.push(s);var l=this.runMode;return{toBe:function(t,e,i){s.ready=!0,s.expected=n.parseMarbles(t,e,i,!0,l)}}},n.prototype.expectSubscriptions=function(t){var e={actual:t,ready:!1};this.flushTests.push(e);var i=this.runMode;return{toBe:function(t){t="string"==typeof t?[t]:t,e.ready=!0,e.expected=t.map(function(t){return n.parseMarblesAsSubscriptions(t,i)})}}},n.prototype.flush=function(){for(var e=this,n=this.hotObservables;0<n.length;)n.shift().setup();t.prototype.flush.call(this),this.flushTests=this.flushTests.filter(function(t){return!t.ready||(e.assertDeepEqual(t.actual,t.expected),!1)})},n.parseMarblesAsSubscriptions=function(t,e){var n=this;if(void 0===e&&(e=!1),"string"!=typeof t)return new Or(Number.POSITIVE_INFINITY);for(var i,r=t.length,o=-1,s=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,l=0,c=function(r){var c=l,h=function(t){c+=t*n.frameTimeFactor};switch(f=t[r]){case" ":e||h(1);break;case"-":h(1);break;case"(":o=l,h(1);break;case")":o=-1,h(1);break;case"^":if(s!==Number.POSITIVE_INFINITY)throw Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");s=-1<o?o:l,h(1);break;case"!":if(a!==Number.POSITIVE_INFINITY)throw Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");a=-1<o?o:l;break;default:if(e&&f.match(/^[0-9]$/)&&(0===r||" "===t[r-1])){var d=t.slice(r).match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(d){r+=d[0].length-1;var f=parseFloat(d[1]),p=void 0;switch(d[2]){case"ms":p=f;break;case"s":p=1e3*f;break;case"m":p=6e4*f}h(p/u.frameTimeFactor);break}}throw Error("there can only be '^' and '!' markers in a subscription marble diagram. Found instead '"+f+"'.")}l=c,i=r},u=this,h=0;h<r;h++)c(h),h=i;return 0>a?new Or(s):new Or(s,a)},n.parseMarbles=function(t,e,n,i,r){var o=this;if(void 0===i&&(i=!1),void 0===r&&(r=!1),-1!==t.indexOf("!"))throw Error('conventional marble diagrams cannot have the unsubscription marker "!"');for(var s,a=t.length,l=[],c=-1===(d=r?t.replace(/^[ ]+/,"").indexOf("^"):t.indexOf("^"))?0:d*-this.frameTimeFactor,u="object"!=typeof e?function(t){return t}:function(t){return i&&e[t]instanceof Rr?e[t].messages:e[t]},h=-1,d=function(e){var i=c,a=function(t){i+=t*o.frameTimeFactor},d=void 0;switch(g=t[e]){case" ":r||a(1);break;case"-":case"^":a(1);break;case"(":h=c,a(1);break;case")":h=-1,a(1);break;case"|":d=pe.createComplete(),a(1);break;case"#":d=pe.createError(n||"error"),a(1);break;default:if(r&&g.match(/^[0-9]$/)&&(0===e||" "===t[e-1])){var p=t.slice(e).match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(p){e+=p[0].length-1;var g=parseFloat(p[1]),m=void 0;switch(p[2]){case"ms":m=g;break;case"s":m=1e3*g;break;case"m":m=6e4*g}a(m/f.frameTimeFactor);break}}d=pe.createNext(u(g)),a(1)}d&&l.push({frame:-1<h?h:c,notification:d}),c=i,s=e},f=this,p=0;p<a;p++)d(p),p=s;return l},n.prototype.run=function(t){var e=n.frameTimeFactor,i=this.maxFrames;n.frameTimeFactor=1,this.maxFrames=Number.POSITIVE_INFINITY,this.runMode=!0,ce.delegate=this;var r={cold:this.createColdObservable.bind(this),hot:this.createHotObservable.bind(this),flush:this.flush.bind(this),expectObservable:this.expectObservable.bind(this),expectSubscriptions:this.expectSubscriptions.bind(this)};try{var o=t(r);return this.flush(),o}finally{n.frameTimeFactor=e,this.maxFrames=i,this.runMode=!1,ce.delegate=void 0}},n}(ke),Mr=Object.freeze({TestScheduler:Nr}),Pr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Lr="undefined"!=typeof global&&global,Kr="undefined"!=typeof window&&window||Lr||Pr;if(!Kr)throw Error("RxJS could not find any global context (window, self, global)");var Br=E(function(t,e){return t.response}),zr=function(t){function n(e){var n=t.call(this)||this,i={async:!0,createXHR:function(){var t;if(this.crossDomain)if(Kr.XMLHttpRequest)t=new Kr.XMLHttpRequest;else{if(!Kr.XDomainRequest)throw Error("CORS is not supported by your browser");t=new Kr.XDomainRequest}else if(Kr.XMLHttpRequest)t=new Kr.XMLHttpRequest;else{var e=void 0;try{for(var n=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=0;3>i;i++)try{e=n[i],new Kr.ActiveXObject(e);break}catch(r){}t=new Kr.ActiveXObject(e)}catch(r){throw Error("XMLHttpRequest is not supported by your browser")}}return t},crossDomain:!0,withCredentials:!1,headers:{},method:"GET",responseType:"json",timeout:0};if("string"==typeof e)i.url=e;else for(var r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);return n.request=i,n}var i;return e(n,t),n.prototype._subscribe=function(t){return new jr(t,this.request)},n.create=((i=function(t){return new n(t)}).get=Tt,i.post=wt,i.delete=xt,i.put=_t,i.patch=Dt,i.getJSON=At,i),n}(Vt),jr=function(t){function n(e,n){(e=t.call(this,e)||this).request=n,e.done=!1;var i=n.headers=n.headers||{};return n.crossDomain||e.getHeader(i,"X-Requested-With")||(i["X-Requested-With"]="XMLHttpRequest"),e.getHeader(i,"Content-Type")||Kr.FormData&&n.body instanceof Kr.FormData||void 0===n.body||(i["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),n.body=e.serializeBody(n.body,e.getHeader(n.headers,"Content-Type")),e.send(),e}return e(n,t),n.prototype.next=function(t){this.done=!0;var e,n=this.xhr,i=this.request,r=this.destination;try{e=new Gr(t,n,i)}catch(o){return r.error(o)}r.next(e)},n.prototype.send=function(){var t=this.request,e=(a=this.request).user,n=a.method,i=a.url,r=a.async,o=a.password,s=a.headers,a=a.body;try{var l=this.xhr=t.createXHR();this.setupEvents(l,t),e?l.open(n,i,r,e,o):l.open(n,i,r),r&&(l.timeout=t.timeout,l.responseType=t.responseType),"withCredentials"in l&&(l.withCredentials=!!t.withCredentials),this.setHeaders(l,s),a?l.send(a):l.send()}catch(c){this.error(c)}},n.prototype.serializeBody=function(t,e){if(!t||"string"==typeof t||Kr.FormData&&t instanceof Kr.FormData)return t;if(e){var n=e.indexOf(";");-1!==n&&(e=e.substring(0,n))}switch(e){case"application/x-www-form-urlencoded":return Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&");case"application/json":return JSON.stringify(t);default:return t}},n.prototype.setHeaders=function(t,e){for(var n in e)e.hasOwnProperty(n)&&t.setRequestHeader(n,e[n])},n.prototype.getHeader=function(t,e){for(var n in t)if(n.toLowerCase()===e.toLowerCase())return t[n]},n.prototype.setupEvents=function(t,e){function n(t){var e,i=n.subscriber,r=n.progressSubscriber,o=n.request;r&&r.error(t);try{e=new Vr(this,o)}catch(s){e=s}i.error(e)}function i(t){}function r(t){var e=r.subscriber,n=r.progressSubscriber,i=r.request;if(4===this.readyState){var o=1223===this.status?204:this.status,s="text"===this.responseType?this.response||this.responseText:this.response;if(0===o&&(o=s?200:0),400>o)n&&n.complete(),e.next(t),e.complete();else{n&&n.error(t),t=void 0;try{t=new Fr("ajax error "+o,this,i)}catch(a){t=a}e.error(t)}}}var o=e.progressSubscriber;if(t.ontimeout=n,n.request=e,n.subscriber=this,n.progressSubscriber=o,t.upload&&"withCredentials"in t){var s,a;if(o)s=function(t){s.progressSubscriber.next(t)},Kr.XDomainRequest?t.onprogress=s:t.upload.onprogress=s,s.progressSubscriber=o;a=function(t){var e,n=a.progressSubscriber,i=a.subscriber,r=a.request;n&&n.error(t);try{e=new Fr("ajax error",this,r)}catch(o){e=o}i.error(e)},t.onerror=a,a.request=e,a.subscriber=this,a.progressSubscriber=o}t.onreadystatechange=i,i.subscriber=this,i.progressSubscriber=o,i.request=e,t.onload=r,r.subscriber=this,r.progressSubscriber=o,r.request=e},n.prototype.unsubscribe=function(){var e=this.xhr;!this.done&&e&&4!==e.readyState&&"function"==typeof e.abort&&e.abort(),t.prototype.unsubscribe.call(this)},n}(jt),Gr=function(t,e,n){this.originalEvent=t,this.xhr=e,this.request=n,this.status=e.status,this.responseType=e.responseType||n.responseType,this.response=Ot(this.responseType,e)},Fr=function(){function t(t,e,n){return Error.call(this),this.message=t,this.name="AjaxError",this.xhr=e,this.request=n,this.status=e.status,this.responseType=e.responseType||n.responseType,this.response=Ot(this.responseType,e),this}return t.prototype=Object.create(Error.prototype),t}(),Vr=function(t,e){return Fr.call(this,"ajax timeout",t,e),this.name="AjaxTimeoutError",this},Hr=Object.freeze({ajax:zr.create,AjaxResponse:Gr,AjaxError:Fr,AjaxTimeoutError:Vr}),Ur={url:"",deserializer:function(t){return JSON.parse(t.data)},serializer:function(t){return JSON.stringify(t)}},Zr=function(t){function n(e,n){var i=t.call(this)||this;if(e instanceof Vt)i.destination=n,i.source=e;else{if(n=i._config=kt({},Ur),i._output=new Wt,"string"==typeof e)n.url=e;else for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);if(!n.WebSocketCtor&&WebSocket)n.WebSocketCtor=WebSocket;else if(!n.WebSocketCtor)throw Error("no WebSocket constructor can be found");i.destination=new ye}return i}return e(n,t),n.prototype.lift=function(t){var e=new n(this._config,this.destination);return e.operator=t,e.source=this,e},n.prototype._resetState=function(){this._socket=null,this.source||(this.destination=new ye),this._output=new Wt},n.prototype.multiplex=function(t,e,n){var i=this;return new Vt(function(r){try{i.next(t())}catch(s){r.error(s)}var o=i.subscribe(function(t){try{n(t)&&r.next(t)}catch(e){r.error(e)}},function(t){return r.error(t)},function(){return r.complete()});return function(){try{i.next(e())}catch(s){r.error(s)}o.unsubscribe()}})},n.prototype._connectSocket=function(){var t=this,e=(r=this._config).WebSocketCtor,n=r.protocol,i=r.url,r=r.binaryType,o=this._output,s=null;try{this._socket=s=n?new e(i,n):new e(i),r&&(this._socket.binaryType=r)}catch(l){return void o.error(l)}var a=new Bt(function(){t._socket=null,s&&1===s.readyState&&s.close()});s.onopen=function(e){if(t._socket){var n=t._config.openObserver;n&&n.next(e),e=t.destination,t.destination=jt.create(function(e){if(1===s.readyState)try{var n=t._config.serializer;s.send(n(e))}catch(i){t.destination.error(i)}},function(e){var n=t._config.closingObserver;n&&n.next(void 0),e&&e.code?s.close(e.code,e.reason):o.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),t._resetState()},function(){var e=t._config.closingObserver;e&&e.next(void 0),s.close(),t._resetState()}),e&&e instanceof ye&&a.add(e.subscribe(t.destination))}else s.close(),t._resetState()},s.onerror=function(e){t._resetState(),o.error(e)},s.onclose=function(e){t._resetState();var n=t._config.closeObserver;n&&n.next(e),e.wasClean?o.complete():o.error(e)},s.onmessage=function(e){try{var n=t._config.deserializer;o.next(n(e))}catch(i){o.error(i)}}},n.prototype._subscribe=function(t){var e=this,n=this.source;return n?n.subscribe(t):(this._socket||this._connectSocket(),this._output.subscribe(t),t.add(function(){var t=e._socket;0===e._output.observers.length&&(t&&1===t.readyState&&t.close(),e._resetState())}),t)},n.prototype.unsubscribe=function(){var e=this._socket;e&&1===e.readyState&&e.close(),this._resetState(),t.prototype.unsubscribe.call(this)},n}($t),Wr=Object.freeze({webSocket:function(t){return new Zr(t)},WebSocketSubject:Zr}),$r=Object.freeze({fromFetch:function(t,e){void 0===e&&(e={});var n=e.selector,i=function(t,e){var n,i={};for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&(i[n[r]]=t[n[r]])}return i}(e,["selector"]);return new Vt(function(e){var r,o=new AbortController,s=o.signal,a=!0,l=!1,c=new Bt;if(c.add(function(){l=!0,a&&o.abort()}),i){if(i.signal)if(i.signal.aborted)o.abort();else{var u=i.signal,h=function(){s.aborted||o.abort()};u.addEventListener("abort",h),c.add(function(){return u.removeEventListener("abort",h)})}r=kt({},i,{signal:s})}else r={signal:s};return fetch(t,r).then(function(t){n?c.add(R(n(t)).subscribe(function(t){return e.next(t)},function(t){a=!1,l||e.error(t)},function(){a=!1,e.complete()})):(a=!1,e.next(t),e.complete())}).catch(function(t){a=!1,l||e.error(t)}),c})}});t.operators=Ar,t.testing=Mr,t.ajax=Hr,t.webSocket=Wr,t.fetch=$r,t.Observable=Vt,t.ConnectableObservable=qt,t.GroupedObservable=ie,t.observable=Ft,t.Subject=Wt,t.BehaviorSubject=oe,t.ReplaySubject=ye,t.AsyncSubject=Ce,t.asap=De,t.asapScheduler=De,t.async=Oe,t.asyncScheduler=Ae,t.queue=ue,t.queueScheduler=ue,t.animationFrame=Re,t.animationFrameScheduler=Re,t.VirtualTimeScheduler=ke,t.VirtualAction=Ne,t.Scheduler=le,t.Subscription=Bt,t.Subscriber=jt,t.Notification=pe,t.pipe=l,t.noop=I,t.identity=a,t.isObservable=function(t){return!!t&&(t instanceof Vt||"function"==typeof t.lift&&"function"==typeof t.subscribe)},t.ArgumentOutOfRangeError=Me,t.EmptyError=Pe,t.ObjectUnsubscribedError=Ht,t.UnsubscriptionError=Kt,t.TimeoutError=Le,t.bindCallback=function t(e,n,i){if(n){if(!f(n))return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t(e,i).apply(void 0,r).pipe(E(function(t){return Lt(t)?n.apply(void 0,t):n(t)}))};i=n}return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r,o=this,a={context:o,subject:r,callbackFunc:e,scheduler:i};return new Vt(function(n){if(i)return i.schedule(T,0,{args:t,subscriber:n,params:a});if(!r){r=new Ce;try{e.apply(o,t.concat([function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r.next(1>=t.length?t[0]:t),r.complete()}]))}catch(l){s(r)?r.error(l):console.warn(l)}}return r.subscribe(n)})}},t.bindNodeCallback=function t(e,n,i){if(n){if(!f(n))return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t(e,i).apply(void 0,r).pipe(E(function(t){return Lt(t)?n.apply(void 0,t):n(t)}))};i=n}return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r={subject:void 0,args:t,callbackFunc:e,scheduler:i,context:this};return new Vt(function(n){var o=r.context,a=r.subject;if(i)return i.schedule(x,0,{params:r,subscriber:n,context:o});if(!a){a=r.subject=new Ce;try{e.apply(o,t.concat([function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];(e=t.shift())?a.error(e):(a.next(1>=t.length?t[0]:t),a.complete())}]))}catch(l){s(a)?a.error(l):console.warn(l)}}return a.subscribe(n)})}},t.combineLatest=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=e=void 0;return f(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&Lt(t[0])&&(t=t[0]),m(t,n).lift(new He(e))},t.concat=L,t.defer=K,t.empty=d,t.forkJoin=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){var n=t[0];if(Lt(n))return B(n,null);if(r(n)&&Object.getPrototypeOf(n)===Object.prototype)return B((t=Object.keys(n)).map(function(t){return n[t]}),t)}if("function"==typeof t[t.length-1]){var i=t.pop();return B(t=1===t.length&&Lt(t[0])?t[0]:t,null).pipe(E(function(t){return i.apply(void 0,t)}))}return B(t,null)},t.from=R,t.fromEvent=function t(e,i,r,o){return n(r)&&(o=r,r=void 0),o?t(e,i,r).pipe(E(function(t){return Lt(t)?o.apply(void 0,t):o(t)})):new Vt(function(t){z(e,i,function(e){1<arguments.length?t.next(Array.prototype.slice.call(arguments)):t.next(e)},t,r)})},t.fromEventPattern=function t(e,i,r){return r?t(e,i).pipe(E(function(t){return Lt(t)?r.apply(void 0,t):r(t)})):new Vt(function(t){var r,o=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.next(1===e.length?e[0]:e)};try{r=e(o)}catch(g){return void t.error(g)}if(n(i))return function(){return i(o,r)}})},t.generate=function(t,e,n,i,r){var o,s;return 1==arguments.length?(s=t.initialState,e=t.condition,n=t.iterate,o=t.resultSelector||a,r=t.scheduler):void 0===i||f(i)?(s=t,o=a,r=i):(s=t,o=i),new Vt(function(t){var i=s;if(r)return r.schedule(j,0,{subscriber:t,iterate:n,condition:e,resultSelector:o,state:i});for(;;){if(e){var a=void 0;try{a=e(i)}catch(l){t.error(l);break}if(!a){t.complete();break}}a=void 0;try{a=o(i)}catch(l){t.error(l);break}if(t.next(a),t.closed)break;try{i=n(i)}catch(l){t.error(l);break}}})},t.iif=function(t,e,n){return void 0===e&&(e=he),void 0===n&&(n=he),K(function(){return t()?e:n})},t.interval=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=Oe),(!G(t)||0>t)&&(t=0),e&&"function"==typeof e.schedule||(e=Oe),new Vt(function(n){return n.add(e.schedule(F,t,{subscriber:n,counter:0,period:t})),n})},t.merge=V,t.never=function(){return Xe},t.of=v,t.onErrorResumeNext=function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(0===e.length)return he;var i=e[0],r=e.slice(1);return 1===e.length&&Lt(i)?t.apply(void 0,i):new Vt(function(e){var n=function(){return e.add(t.apply(void 0,r).subscribe(e))};return R(i).subscribe({next:function(t){e.next(t)},error:n,complete:n})})},t.pairs=function(t,e){return new Vt(e?function(n){var i=Object.keys(t),r=new Bt;return r.add(e.schedule(H,0,{keys:i,index:0,subscriber:n,subscription:r,obj:t})),r}:function(e){for(var n=Object.keys(t),i=0;i<n.length&&!e.closed;i++){var r=n[i];t.hasOwnProperty(r)&&e.next([r,t[r]])}e.complete()})},t.partition=function(t,e,n){return[Z(e,n)(new Vt(Fe(t))),Z(U(e,n))(new Vt(Fe(t)))]},t.race=W,t.range=function(t,e,n){return void 0===t&&(t=0),new Vt(function(i){void 0===e&&(e=t,t=0);var r=0,o=t;if(n)return n.schedule($,0,{index:r,count:e,start:t,subscriber:i});for(;;){if(r++>=e){i.complete();break}if(i.next(o++),i.closed)break}})},t.throwError=y,t.timer=Y,t.using=function(t,e){return new Vt(function(n){var i,r;try{i=t()}catch(g){return void n.error(g)}try{r=e(i)}catch(g){return void n.error(g)}var o=(r?R(r):he).subscribe(n);return function(){o.unsubscribe(),i&&i.unsubscribe()}})},t.zip=q,t.scheduled=S,t.EMPTY=he,t.NEVER=Xe,t.config=Mt,Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){"use strict";var n=[],i=Object.getPrototypeOf,r=n.slice,o=n.flat?function(t){return n.flat.call(t)}:function(t){return n.concat.apply([],t)},s=n.push,a=n.indexOf,l={},c=l.toString,u=l.hasOwnProperty,h=u.toString,d=h.call(Object),f={},p=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item},g=function(t){return null!=t&&t===t.window},m=t.document,v={type:!0,src:!0,nonce:!0,noModule:!0};function y(t,e,n){var i,r,o=(n=n||m).createElement("script");if(o.text=t,e)for(i in v)(r=e[i]||e.getAttribute&&e.getAttribute(i))&&o.setAttribute(i,r);n.head.appendChild(o).parentNode.removeChild(o)}function b(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?l[c.call(t)]||"object":typeof t}var C="3.6.0",I=function(t,e){return new I.fn.init(t,e)};function E(t){var e=!!t&&"length"in t&&t.length,n=b(t);return!p(t)&&!g(t)&&("array"===n||0===e||"number"==typeof e&&0<e&&e-1 in t)}I.fn=I.prototype={jquery:C,constructor:I,length:0,toArray:function(){return r.call(this)},get:function(t){return null==t?r.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=I.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return I.each(this,t)},map:function(t){return this.pushStack(I.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(I.grep(this,function(t,e){return(e+1)%2}))},odd:function(){return this.pushStack(I.grep(this,function(t,e){return e%2}))},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(0<=n&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},I.extend=I.fn.extend=function(){var t,e,n,i,r,o,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||p(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)i=t[e],"__proto__"!==e&&s!==i&&(c&&i&&(I.isPlainObject(i)||(r=Array.isArray(i)))?(n=s[e],o=r&&!Array.isArray(n)?[]:r||I.isPlainObject(n)?n:{},r=!1,s[e]=I.extend(c,o,i)):void 0!==i&&(s[e]=i));return s},I.extend({expando:"jQuery"+(C+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==c.call(t)||(e=i(t))&&("function"!=typeof(n=u.call(e,"constructor")&&e.constructor)||h.call(n)!==d))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,n){y(t,{nonce:e&&e.nonce},n)},each:function(t,e){var n,i=0;if(E(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},makeArray:function(t,e){var n=e||[];return null!=t&&(E(Object(t))?I.merge(n,"string"==typeof t?[t]:t):s.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:a.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,o=t.length,s=!n;r<o;r++)!e(t[r],r)!==s&&i.push(t[r]);return i},map:function(t,e,n){var i,r,s=0,a=[];if(E(t))for(i=t.length;s<i;s++)null!=(r=e(t[s],s,n))&&a.push(r);else for(s in t)null!=(r=e(t[s],s,n))&&a.push(r);return o(a)},guid:1,support:f}),"function"==typeof Symbol&&(I.fn[Symbol.iterator]=n[Symbol.iterator]),I.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){l["[object "+e+"]"]=e.toLowerCase()});var T=function(t){var e,n,i,r,o,s,a,l,c,u,h,d,f,p,g,m,v,y,b,C="sizzle"+1*new Date,I=t.document,E=0,T=0,w=lt(),x=lt(),_=lt(),D=lt(),A=function(t,e){return t===e&&(h=!0),0},O={}.hasOwnProperty,S=[],R=S.pop,k=S.push,N=S.push,M=S.slice,P=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},L="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",K="[\\x20\\t\\r\\n\\f]",B="(?:\\\\[\\da-fA-F]{1,6}"+K+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",z="\\["+K+"*("+B+")(?:"+K+"*([*^$|!~]?=)"+K+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+K+"*\\]",j=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+z+")*)|.*)\\)|)",G=new RegExp(K+"+","g"),F=new RegExp("^"+K+"+|((?:^|[^\\\\])(?:\\\\.)*)"+K+"+$","g"),V=new RegExp("^"+K+"*,"+K+"*"),H=new RegExp("^"+K+"*([>+~]|"+K+")"+K+"*"),U=new RegExp(K+"|>"),Z=new RegExp(j),W=new RegExp("^"+B+"$"),$={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B+"|[*])"),ATTR:new RegExp("^"+z),PSEUDO:new RegExp("^"+j),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+K+"*(even|odd|(([+-]|)(\\d*)n|)"+K+"*(?:([+-]|)"+K+"*(\\d+)|))"+K+"*\\)|)","i"),bool:new RegExp("^(?:"+L+")$","i"),needsContext:new RegExp("^"+K+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+K+"*((?:-\\d)?\\d*)"+K+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,X=/^(?:input|select|textarea|button)$/i,q=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}"+K+"?|\\\\([^\\r\\n\\f])","g"),nt=function(t,e){var n="0x"+t.slice(1)-65536;return e||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=function(t,e){return e?"\0"===t?"\ufffd":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},ot=function(){d()},st=Ct(function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{N.apply(S=M.call(I.childNodes),I.childNodes),S[I.childNodes.length].nodeType}catch(e){N={apply:S.length?function(t,e){k.apply(t,M.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function at(t,e,i,r){var o,a,c,u,h,p,v,y=e&&e.ownerDocument,I=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==I&&9!==I&&11!==I)return i;if(!r&&(d(e),e=e||f,g)){if(11!==I&&(h=Q.exec(t)))if(o=h[1]){if(9===I){if(!(c=e.getElementById(o)))return i;if(c.id===o)return i.push(c),i}else if(y&&(c=y.getElementById(o))&&b(e,c)&&c.id===o)return i.push(c),i}else{if(h[2])return N.apply(i,e.getElementsByTagName(t)),i;if((o=h[3])&&n.getElementsByClassName&&e.getElementsByClassName)return N.apply(i,e.getElementsByClassName(o)),i}if(n.qsa&&!D[t+" "]&&(!m||!m.test(t))&&(1!==I||"object"!==e.nodeName.toLowerCase())){if(v=t,y=e,1===I&&(U.test(t)||H.test(t))){for((y=tt.test(t)&&vt(e.parentNode)||e)===e&&n.scope||((u=e.getAttribute("id"))?u=u.replace(it,rt):e.setAttribute("id",u=C)),a=(p=s(t)).length;a--;)p[a]=(u?"#"+u:":scope")+" "+bt(p[a]);v=p.join(",")}try{return N.apply(i,y.querySelectorAll(v)),i}catch(e){D(t,!0)}finally{u===C&&e.removeAttribute("id")}}}return l(t.replace(F,"$1"),e,i,r)}function lt(){var t=[];return function e(n,r){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function ct(t){return t[C]=!0,t}function ut(t){var e=f.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var n=t.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=e}function dt(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function ft(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function pt(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function gt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&st(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function mt(t){return ct(function(e){return e=+e,ct(function(n,i){for(var r,o=t([],n.length,e),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))})})}function vt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=at.support={},o=at.isXML=function(t){var e=t&&t.namespaceURI,n=t&&(t.ownerDocument||t).documentElement;return!Y.test(e||n&&n.nodeName||"HTML")},d=at.setDocument=function(t){var e,r,s=t?t.ownerDocument||t:I;return s!=f&&9===s.nodeType&&s.documentElement&&(p=(f=s).documentElement,g=!o(f),I!=f&&(r=f.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",ot,!1):r.attachEvent&&r.attachEvent("onunload",ot)),n.scope=ut(function(t){return p.appendChild(t).appendChild(f.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length}),n.attributes=ut(function(t){return t.className="i",!t.getAttribute("className")}),n.getElementsByTagName=ut(function(t){return t.appendChild(f.createComment("")),!t.getElementsByTagName("*").length}),n.getElementsByClassName=J.test(f.getElementsByClassName),n.getById=ut(function(t){return p.appendChild(t).id=C,!f.getElementsByName||!f.getElementsByName(C).length}),n.getById?(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n=e.getElementById(t);return n?[n]:[]}}):(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n,i,r,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(r=e.getElementsByName(t),i=0;o=r[i++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),i.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},v=[],m=[],(n.qsa=J.test(f.querySelectorAll))&&(ut(function(t){var e;p.appendChild(t).innerHTML="<a id='"+C+"'></a><select id='"+C+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+K+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\["+K+"*(?:value|"+L+")"),t.querySelectorAll("[id~="+C+"-]").length||m.push("~="),(e=f.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||m.push("\\["+K+"*name"+K+"*="+K+"*(?:''|\"\")"),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+C+"+*").length||m.push(".#.+[+~]"),t.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")}),ut(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=f.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name"+K+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),p.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=J.test(y=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ut(function(t){n.disconnectedMatch=y.call(t,"*"),y.call(t,"[s!='']:x"),v.push("!=",j)}),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),e=J.test(p.compareDocumentPosition),b=e||J.test(p.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},A=e?function(t,e){if(t===e)return h=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t==f||t.ownerDocument==I&&b(I,t)?-1:e==f||e.ownerDocument==I&&b(I,e)?1:u?P(u,t)-P(u,e):0:4&i?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,i=0,r=t.parentNode,o=e.parentNode,s=[t],a=[e];if(!r||!o)return t==f?-1:e==f?1:r?-1:o?1:u?P(u,t)-P(u,e):0;if(r===o)return dt(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;s[i]===a[i];)i++;return i?dt(s[i],a[i]):s[i]==I?-1:a[i]==I?1:0}),f},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if(d(t),n.matchesSelector&&g&&!D[e+" "]&&(!v||!v.test(e))&&(!m||!m.test(e)))try{var i=y.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){D(e,!0)}return 0<at(e,f,null,[t]).length},at.contains=function(t,e){return(t.ownerDocument||t)!=f&&d(t),b(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!=f&&d(t);var r=i.attrHandle[e.toLowerCase()],o=r&&O.call(i.attrHandle,e.toLowerCase())?r(t,e,!g):void 0;return void 0!==o?o:n.attributes||!g?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},at.escape=function(t){return(t+"").replace(it,rt)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,i=[],r=0,o=0;if(h=!n.detectDuplicates,u=!n.sortStable&&t.slice(0),t.sort(A),h){for(;e=t[o++];)e===t[o]&&(r=i.push(o));for(;r--;)t.splice(i[r],1)}return u=null,t},r=at.getText=function(t){var e,n="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i++];)n+=r(e);return n},(i=at.selectors={cacheLength:50,createPseudo:ct,match:$,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return $.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&Z.test(n)&&(e=s(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=w[t+" "];return e||(e=new RegExp("(^|"+K+")"+t+"("+K+"|$)"))&&w(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(i){var r=at.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&-1<r.indexOf(n):"$="===e?n&&r.slice(-n.length)===n:"~="===e?-1<(" "+r.replace(G," ")+" ").indexOf(n):"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,l){var c,u,h,d,f,p,g=o!==s?"nextSibling":"previousSibling",m=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!l&&!a,b=!1;if(m){if(o){for(;g;){for(d=e;d=d[g];)if(a?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;p=g="only"===t&&!p&&"nextSibling"}return!0}if(p=[s?m.firstChild:m.lastChild],s&&y){for(b=(f=(c=(u=(h=(d=m)[C]||(d[C]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===E&&c[1])&&c[2],d=f&&m.childNodes[f];d=++f&&d&&d[g]||(b=f=0)||p.pop();)if(1===d.nodeType&&++b&&d===e){u[t]=[E,f,b];break}}else if(y&&(b=f=(c=(u=(h=(d=e)[C]||(d[C]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===E&&c[1]),!1===b)for(;(d=++f&&d&&d[g]||(b=f=0)||p.pop())&&((a?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++b||(y&&((u=(h=d[C]||(d[C]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]=[E,b]),d!==e)););return(b-=r)===i||b%i==0&&0<=b/i}}},PSEUDO:function(t,e){var n,r=i.pseudos[t]||i.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return r[C]?r(e):1<r.length?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?ct(function(t,n){for(var i,o=r(t,e),s=o.length;s--;)t[i=P(t,o[s])]=!(n[i]=o[s])}):function(t){return r(t,0,n)}):r}},pseudos:{not:ct(function(t){var e=[],n=[],i=a(t.replace(F,"$1"));return i[C]?ct(function(t,e,n,r){for(var o,s=i(t,null,r,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))}):function(t,r,o){return e[0]=t,i(e,null,o,n),e[0]=null,!n.pop()}}),has:ct(function(t){return function(e){return 0<at(t,e).length}}),contains:ct(function(t){return t=t.replace(et,nt),function(e){return-1<(e.textContent||r(e)).indexOf(t)}}),lang:ct(function(t){return W.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===p},focus:function(t){return t===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:gt(!1),disabled:gt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return q.test(t.nodeName)},input:function(t){return X.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:mt(function(){return[0]}),last:mt(function(t,e){return[e-1]}),eq:mt(function(t,e,n){return[n<0?n+e:n]}),even:mt(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:mt(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:mt(function(t,e,n){for(var i=n<0?n+e:e<n?e:n;0<=--i;)t.push(i);return t}),gt:mt(function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t})}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=ft(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=pt(e);function yt(){}function bt(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function Ct(t,e,n){var i=e.dir,r=e.next,o=r||i,s=n&&"parentNode"===o,a=T++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||s)return t(e,n,r);return!1}:function(e,n,l){var c,u,h,d=[E,a];if(l){for(;e=e[i];)if((1===e.nodeType||s)&&t(e,n,l))return!0}else for(;e=e[i];)if(1===e.nodeType||s)if(u=(h=e[C]||(e[C]={}))[e.uniqueID]||(h[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((c=u[o])&&c[0]===E&&c[1]===a)return d[2]=c[2];if((u[o]=d)[2]=t(e,n,l))return!0}return!1}}function It(t){return 1<t.length?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function Et(t,e,n,i,r){for(var o,s=[],a=0,l=t.length,c=null!=e;a<l;a++)(o=t[a])&&(n&&!n(o,i,r)||(s.push(o),c&&e.push(a)));return s}function Tt(t,e,n,i,r,o){return i&&!i[C]&&(i=Tt(i)),r&&!r[C]&&(r=Tt(r,o)),ct(function(o,s,a,l){var c,u,h,d=[],f=[],p=s.length,g=o||function(t,e,n){for(var i=0,r=e.length;i<r;i++)at(t,e[i],n);return n}(e||"*",a.nodeType?[a]:a,[]),m=!t||!o&&e?g:Et(g,d,t,a,l),v=n?r||(o?t:p||i)?[]:s:m;if(n&&n(m,v,a,l),i)for(c=Et(v,f),i(c,[],a,l),u=c.length;u--;)(h=c[u])&&(v[f[u]]=!(m[f[u]]=h));if(o){if(r||t){if(r){for(c=[],u=v.length;u--;)(h=v[u])&&c.push(m[u]=h);r(null,v=[],c,l)}for(u=v.length;u--;)(h=v[u])&&-1<(c=r?P(o,h):d[u])&&(o[c]=!(s[c]=h))}}else v=Et(v===s?v.splice(p,v.length):v),r?r(null,s,v,l):N.apply(s,v)})}function wt(t){for(var e,n,r,o=t.length,s=i.relative[t[0].type],a=s||i.relative[" "],l=s?1:0,u=Ct(function(t){return t===e},a,!0),h=Ct(function(t){return-1<P(e,t)},a,!0),d=[function(t,n,i){var r=!s&&(i||n!==c)||((e=n).nodeType?u(t,n,i):h(t,n,i));return e=null,r}];l<o;l++)if(n=i.relative[t[l].type])d=[Ct(It(d),n)];else{if((n=i.filter[t[l].type].apply(null,t[l].matches))[C]){for(r=++l;r<o&&!i.relative[t[r].type];r++);return Tt(1<l&&It(d),1<l&&bt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(F,"$1"),n,l<r&&wt(t.slice(l,r)),r<o&&wt(t=t.slice(r)),r<o&&bt(t))}d.push(n)}return It(d)}return yt.prototype=i.filters=i.pseudos,i.setFilters=new yt,s=at.tokenize=function(t,e){var n,r,o,s,a,l,c,u=x[t+" "];if(u)return e?0:u.slice(0);for(a=t,l=[],c=i.preFilter;a;){for(s in n&&!(r=V.exec(a))||(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),n=!1,(r=H.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(F," ")}),a=a.slice(n.length)),i.filter)!(r=$[s].exec(a))||c[s]&&!(r=c[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return e?a.length:a?at.error(t):x(t,l).slice(0)},a=at.compile=function(t,e){var n,r,o,a,l,u,h=[],p=[],m=_[t+" "];if(!m){for(e||(e=s(t)),n=e.length;n--;)(m=wt(e[n]))[C]?h.push(m):p.push(m);(m=_(t,(r=p,a=0<(o=h).length,l=0<r.length,u=function(t,e,n,s,u){var h,p,m,v=0,y="0",b=t&&[],C=[],I=c,T=t||l&&i.find.TAG("*",u),w=E+=null==I?1:Math.random()||.1,x=T.length;for(u&&(c=e==f||e||u);y!==x&&null!=(h=T[y]);y++){if(l&&h){for(p=0,e||h.ownerDocument==f||(d(h),n=!g);m=r[p++];)if(m(h,e||f,n)){s.push(h);break}u&&(E=w)}a&&((h=!m&&h)&&v--,t&&b.push(h))}if(v+=y,a&&y!==v){for(p=0;m=o[p++];)m(b,C,e,n);if(t){if(0<v)for(;y--;)b[y]||C[y]||(C[y]=R.call(s));C=Et(C)}N.apply(s,C),u&&!t&&0<C.length&&1<v+o.length&&at.uniqueSort(s)}return u&&(E=w,c=I),b},a?ct(u):u))).selector=t}return m},l=at.select=function(t,e,n,r){var o,l,c,u,h,d="function"==typeof t&&t,f=!r&&s(t=d.selector||t);if(n=n||[],1===f.length){if(2<(l=f[0]=f[0].slice(0)).length&&"ID"===(c=l[0]).type&&9===e.nodeType&&g&&i.relative[l[1].type]){if(!(e=(i.find.ID(c.matches[0].replace(et,nt),e)||[])[0]))return n;d&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(o=$.needsContext.test(t)?0:l.length;o--&&(c=l[o],!i.relative[u=c.type]);)if((h=i.find[u])&&(r=h(c.matches[0].replace(et,nt),tt.test(l[0].type)&&vt(e.parentNode)||e))){if(l.splice(o,1),!(t=r.length&&bt(l)))return N.apply(n,r),n;break}}return(d||a(t,f))(r,e,!g,n,!e||tt.test(t)&&vt(e.parentNode)||e),n},n.sortStable=C.split("").sort(A).join("")===C,n.detectDuplicates=!!h,d(),n.sortDetached=ut(function(t){return 1&t.compareDocumentPosition(f.createElement("fieldset"))}),ut(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||ht("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),n.attributes&&ut(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||ht("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),ut(function(t){return null==t.getAttribute("disabled")})||ht(L,function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),at}(t);I.find=T,I.expr=T.selectors,I.expr[":"]=I.expr.pseudos,I.uniqueSort=I.unique=T.uniqueSort,I.text=T.getText,I.isXMLDoc=T.isXML,I.contains=T.contains,I.escapeSelector=T.escape;var w=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&I(t).is(n))break;i.push(t)}return i},x=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},_=I.expr.match.needsContext;function D(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var A=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function O(t,e,n){return p(e)?I.grep(t,function(t,i){return!!e.call(t,i,t)!==n}):e.nodeType?I.grep(t,function(t){return t===e!==n}):"string"!=typeof e?I.grep(t,function(t){return-1<a.call(e,t)!==n}):I.filter(e,t,n)}I.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?I.find.matchesSelector(i,t)?[i]:[]:I.find.matches(t,I.grep(e,function(t){return 1===t.nodeType}))},I.fn.extend({find:function(t){var e,n,i=this.length,r=this;if("string"!=typeof t)return this.pushStack(I(t).filter(function(){for(e=0;e<i;e++)if(I.contains(r[e],this))return!0}));for(n=this.pushStack([]),e=0;e<i;e++)I.find(t,r[e],n);return 1<i?I.uniqueSort(n):n},filter:function(t){return this.pushStack(O(this,t||[],!1))},not:function(t){return this.pushStack(O(this,t||[],!0))},is:function(t){return!!O(this,"string"==typeof t&&_.test(t)?I(t):t||[],!1).length}});var S,R=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(I.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||S,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:R.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof I?e[0]:e,I.merge(this,I.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:m,!0)),A.test(i[1])&&I.isPlainObject(e))for(i in e)p(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(r=m.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):p(t)?void 0!==n.ready?n.ready(t):t(I):I.makeArray(t,this)}).prototype=I.fn,S=I(m);var k=/^(?:parents|prev(?:Until|All))/,N={children:!0,contents:!0,next:!0,prev:!0};function M(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}I.fn.extend({has:function(t){var e=I(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(I.contains(this,e[t]))return!0})},closest:function(t,e){var n,i=0,r=this.length,o=[],s="string"!=typeof t&&I(t);if(!_.test(t))for(;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?-1<s.index(n):1===n.nodeType&&I.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(1<o.length?I.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?a.call(I(t),this[0]):a.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(I.uniqueSort(I.merge(this.get(),I(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),I.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return w(t,"parentNode")},parentsUntil:function(t,e,n){return w(t,"parentNode",n)},next:function(t){return M(t,"nextSibling")},prev:function(t){return M(t,"previousSibling")},nextAll:function(t){return w(t,"nextSibling")},prevAll:function(t){return w(t,"previousSibling")},nextUntil:function(t,e,n){return w(t,"nextSibling",n)},prevUntil:function(t,e,n){return w(t,"previousSibling",n)},siblings:function(t){return x((t.parentNode||{}).firstChild,t)},children:function(t){return x(t.firstChild)},contents:function(t){return null!=t.contentDocument&&i(t.contentDocument)?t.contentDocument:(D(t,"template")&&(t=t.content||t),I.merge([],t.childNodes))}},function(t,e){I.fn[t]=function(n,i){var r=I.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=I.filter(i,r)),1<this.length&&(N[t]||I.uniqueSort(r),k.test(t)&&r.reverse()),this.pushStack(r)}});var P=/[^\x20\t\r\n\f]+/g;function L(t){return t}function K(t){throw t}function B(t,e,n,i){var r;try{t&&p(r=t.promise)?r.call(t).done(e).fail(n):t&&p(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}I.Callbacks=function(t){var e,n;t="string"==typeof t?(e=t,n={},I.each(e.match(P)||[],function(t,e){n[e]=!0}),n):I.extend({},t);var i,r,o,s,a=[],l=[],c=-1,u=function(){for(s=s||t.once,o=i=!0;l.length;c=-1)for(r=l.shift();++c<a.length;)!1===a[c].apply(r[0],r[1])&&t.stopOnFalse&&(c=a.length,r=!1);t.memory||(r=!1),i=!1,s&&(a=r?[]:"")},h={add:function(){return a&&(r&&!i&&(c=a.length-1,l.push(r)),function e(n){I.each(n,function(n,i){p(i)?t.unique&&h.has(i)||a.push(i):i&&i.length&&"string"!==b(i)&&e(i)})}(arguments),r&&!i&&u()),this},remove:function(){return I.each(arguments,function(t,e){for(var n;-1<(n=I.inArray(e,a,n));)a.splice(n,1),n<=c&&c--}),this},has:function(t){return t?-1<I.inArray(t,a):0<a.length},empty:function(){return a&&(a=[]),this},disable:function(){return s=l=[],a=r="",this},disabled:function(){return!a},lock:function(){return s=l=[],r||i||(a=r=""),this},locked:function(){return!!s},fireWith:function(t,e){return s||(e=[t,(e=e||[]).slice?e.slice():e],l.push(e),i||u()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!o}};return h},I.extend({Deferred:function(e){var n=[["notify","progress",I.Callbacks("memory"),I.Callbacks("memory"),2],["resolve","done",I.Callbacks("once memory"),I.Callbacks("once memory"),0,"resolved"],["reject","fail",I.Callbacks("once memory"),I.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return I.Deferred(function(e){I.each(n,function(n,i){var r=p(t[i[4]])&&t[i[4]];o[i[1]](function(){var t=r&&r.apply(this,arguments);t&&p(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[i[0]+"With"](this,r?[t]:arguments)})}),t=null}).promise()},then:function(e,i,r){var o=0;function s(e,n,i,r){return function(){var a=this,l=arguments,c=function(){var t,c;if(!(e<o)){if((t=i.apply(a,l))===n.promise())throw new TypeError("Thenable self-resolution");c=t&&("object"==typeof t||"function"==typeof t)&&t.then,p(c)?r?c.call(t,s(o,n,L,r),s(o,n,K,r)):(o++,c.call(t,s(o,n,L,r),s(o,n,K,r),s(o,n,L,n.notifyWith))):(i!==L&&(a=void 0,l=[t]),(r||n.resolveWith)(a,l))}},u=r?c:function(){try{c()}catch(c){I.Deferred.exceptionHook&&I.Deferred.exceptionHook(c,u.stackTrace),o<=e+1&&(i!==K&&(a=void 0,l=[c]),n.rejectWith(a,l))}};e?u():(I.Deferred.getStackHook&&(u.stackTrace=I.Deferred.getStackHook()),t.setTimeout(u))}}return I.Deferred(function(t){n[0][3].add(s(0,t,p(r)?r:L,t.notifyWith)),n[1][3].add(s(0,t,p(e)?e:L)),n[2][3].add(s(0,t,p(i)?i:K))}).promise()},promise:function(t){return null!=t?I.extend(t,r):r}},o={};return I.each(n,function(t,e){var s=e[2],a=e[5];r[e[1]]=s.add,a&&s.add(function(){i=a},n[3-t][2].disable,n[3-t][3].disable,n[0][2].lock,n[0][3].lock),s.add(e[3].fire),o[e[0]]=function(){return o[e[0]+"With"](this===o?void 0:this,arguments),this},o[e[0]+"With"]=s.fireWith}),r.promise(o),e&&e.call(o,o),o},when:function(t){var e=arguments.length,n=e,i=Array(n),o=r.call(arguments),s=I.Deferred(),a=function(t){return function(n){i[t]=this,o[t]=1<arguments.length?r.call(arguments):n,--e||s.resolveWith(i,o)}};if(e<=1&&(B(t,s.done(a(n)).resolve,s.reject,!e),"pending"===s.state()||p(o[n]&&o[n].then)))return s.then();for(;n--;)B(o[n],a(n),s.reject);return s.promise()}});var z=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;I.Deferred.exceptionHook=function(e,n){t.console&&t.console.warn&&e&&z.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,n)},I.readyException=function(e){t.setTimeout(function(){throw e})};var j=I.Deferred();function G(){m.removeEventListener("DOMContentLoaded",G),t.removeEventListener("load",G),I.ready()}I.fn.ready=function(t){return j.then(t).catch(function(t){I.readyException(t)}),this},I.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--I.readyWait:I.isReady)||(I.isReady=!0)!==t&&0<--I.readyWait||j.resolveWith(m,[I])}}),I.ready.then=j.then,"complete"===m.readyState||"loading"!==m.readyState&&!m.documentElement.doScroll?t.setTimeout(I.ready):(m.addEventListener("DOMContentLoaded",G),t.addEventListener("load",G));var F=function(t,e,n,i,r,o,s){var a=0,l=t.length,c=null==n;if("object"===b(n))for(a in r=!0,n)F(t,e,a,n[a],!0,o,s);else if(void 0!==i&&(r=!0,p(i)||(s=!0),c&&(s?(e.call(t,i),e=null):(c=e,e=function(t,e,n){return c.call(I(t),n)})),e))for(;a<l;a++)e(t[a],n,s?i:i.call(t[a],a,e(t[a],n)));return r?t:c?e.call(t):l?e(t[0],n):o},V=/^-ms-/,H=/-([a-z])/g;function U(t,e){return e.toUpperCase()}function Z(t){return t.replace(V,"ms-").replace(H,U)}var W=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function $(){this.expando=I.expando+$.uid++}$.uid=1,$.prototype={cache:function(t){var e=t[this.expando];return e||(e={},W(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[Z(e)]=n;else for(i in e)r[Z(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][Z(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){n=(e=Array.isArray(e)?e.map(Z):(e=Z(e))in i?[e]:e.match(P)||[]).length;for(;n--;)delete i[e[n]]}(void 0===e||I.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!I.isEmptyObject(e)}};var Y=new $,X=new $,q=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,J=/[A-Z]/g;function Q(t,e,n){var i,r;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(J,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n="true"===(r=n)||"false"!==r&&("null"===r?null:r===+r+""?+r:q.test(r)?JSON.parse(r):r)}catch(t){}X.set(t,e,n)}else n=void 0;return n}I.extend({hasData:function(t){return X.hasData(t)||Y.hasData(t)},data:function(t,e,n){return X.access(t,e,n)},removeData:function(t,e){X.remove(t,e)},_data:function(t,e,n){return Y.access(t,e,n)},_removeData:function(t,e){Y.remove(t,e)}}),I.fn.extend({data:function(t,e){var n,i,r,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(r=X.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(i=s[n].name).indexOf("data-")&&(i=Z(i.slice(5)),Q(o,i,r[i]));Y.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each(function(){X.set(this,t)}):F(this,function(e){var n;if(o&&void 0===e)return void 0!==(n=X.get(o,t))||void 0!==(n=Q(o,t))?n:void 0;this.each(function(){X.set(this,t,e)})},null,e,1<arguments.length,null,!0)},removeData:function(t){return this.each(function(){X.remove(this,t)})}}),I.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=Y.get(t,e),n&&(!i||Array.isArray(n)?i=Y.access(t,e,I.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=I.queue(t,e),i=n.length,r=n.shift(),o=I._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,function(){I.dequeue(t,e)},o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Y.get(t,n)||Y.access(t,n,{empty:I.Callbacks("once memory").add(function(){Y.remove(t,[e+"queue",n])})})}}),I.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?I.queue(this[0],t):void 0===e?this:this.each(function(){var n=I.queue(this,t,e);I._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&I.dequeue(this,t)})},dequeue:function(t){return this.each(function(){I.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=I.Deferred(),o=this,s=this.length,a=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(n=Y.get(o[s],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(e)}});var tt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,et=new RegExp("^(?:([+-])=|)("+tt+")([a-z%]*)$","i"),nt=["Top","Right","Bottom","Left"],it=m.documentElement,rt=function(t){return I.contains(t.ownerDocument,t)},ot={composed:!0};it.getRootNode&&(rt=function(t){return I.contains(t.ownerDocument,t)||t.getRootNode(ot)===t.ownerDocument});var st=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&rt(t)&&"none"===I.css(t,"display")};function at(t,e,n,i){var r,o,s=20,a=i?function(){return i.cur()}:function(){return I.css(t,e,"")},l=a(),c=n&&n[3]||(I.cssNumber[e]?"":"px"),u=t.nodeType&&(I.cssNumber[e]||"px"!==c&&+l)&&et.exec(I.css(t,e));if(u&&u[3]!==c){for(l/=2,c=c||u[3],u=+l||1;s--;)I.style(t,e,u+c),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),u/=o;u*=2,I.style(t,e,u+c),n=n||[]}return n&&(u=+u||+l||0,r=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=u,i.end=r)),r}var lt={};function ct(t,e){for(var n,i,r,o,s,a,l,c=[],u=0,h=t.length;u<h;u++)(i=t[u]).style&&(n=i.style.display,e?("none"===n&&(c[u]=Y.get(i,"display")||null,c[u]||(i.style.display="")),""===i.style.display&&st(i)&&(c[u]=(l=s=o=void 0,s=(r=i).ownerDocument,a=r.nodeName,(l=lt[a])||(o=s.body.appendChild(s.createElement(a)),l=I.css(o,"display"),o.parentNode.removeChild(o),"none"===l&&(l="block"),lt[a]=l)))):"none"!==n&&(c[u]="none",Y.set(i,"display",n)));for(u=0;u<h;u++)null!=c[u]&&(t[u].style.display=c[u]);return t}I.fn.extend({show:function(){return ct(this,!0)},hide:function(){return ct(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){st(this)?I(this).show():I(this).hide()})}});var ut,ht,dt=/^(?:checkbox|radio)$/i,ft=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,pt=/^$|^module$|\/(?:java|ecma)script/i;ut=m.createDocumentFragment().appendChild(m.createElement("div")),(ht=m.createElement("input")).setAttribute("type","radio"),ht.setAttribute("checked","checked"),ht.setAttribute("name","t"),ut.appendChild(ht),f.checkClone=ut.cloneNode(!0).cloneNode(!0).lastChild.checked,ut.innerHTML="<textarea>x</textarea>",f.noCloneChecked=!!ut.cloneNode(!0).lastChild.defaultValue,ut.innerHTML="<option></option>",f.option=!!ut.lastChild;var gt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function mt(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&D(t,e)?I.merge([t],n):n}function vt(t,e){for(var n=0,i=t.length;n<i;n++)Y.set(t[n],"globalEval",!e||Y.get(e[n],"globalEval"))}gt.tbody=gt.tfoot=gt.colgroup=gt.caption=gt.thead,gt.th=gt.td,f.option||(gt.optgroup=gt.option=[1,"<select multiple='multiple'>","</select>"]);var yt=/<|&#?\w+;/;function bt(t,e,n,i,r){for(var o,s,a,l,c,u,h=e.createDocumentFragment(),d=[],f=0,p=t.length;f<p;f++)if((o=t[f])||0===o)if("object"===b(o))I.merge(d,o.nodeType?[o]:o);else if(yt.test(o)){for(s=s||h.appendChild(e.createElement("div")),a=(ft.exec(o)||["",""])[1].toLowerCase(),l=gt[a]||gt._default,s.innerHTML=l[1]+I.htmlPrefilter(o)+l[2],u=l[0];u--;)s=s.lastChild;I.merge(d,s.childNodes),(s=h.firstChild).textContent=""}else d.push(e.createTextNode(o));for(h.textContent="",f=0;o=d[f++];)if(i&&-1<I.inArray(o,i))r&&r.push(o);else if(c=rt(o),s=mt(h.appendChild(o),"script"),c&&vt(s),n)for(u=0;o=s[u++];)pt.test(o.type||"")&&n.push(o);return h}var Ct=/^([^.]*)(?:\.(.+)|)/;function It(){return!0}function Et(){return!1}function Tt(t,e){return t===function(){try{return m.activeElement}catch(t){}}()==("focus"===e)}function wt(t,e,n,i,r,o){var s,a;if("object"==typeof e){for(a in"string"!=typeof n&&(i=i||n,n=void 0),e)wt(t,a,n,i,e[a],o);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=Et;else if(!r)return t;return 1===o&&(s=r,(r=function(t){return I().off(t),s.apply(this,arguments)}).guid=s.guid||(s.guid=I.guid++)),t.each(function(){I.event.add(this,e,r,i,n)})}function xt(t,e,n){n?(Y.set(t,e,!1),I.event.add(t,e,{namespace:!1,handler:function(t){var i,o,s=Y.get(this,e);if(1&t.isTrigger&&this[e]){if(s.length)(I.event.special[e]||{}).delegateType&&t.stopPropagation();else if(s=r.call(arguments),Y.set(this,e,s),i=n(this,e),this[e](),s!==(o=Y.get(this,e))||i?Y.set(this,e,!1):o={},s!==o)return t.stopImmediatePropagation(),t.preventDefault(),o&&o.value}else s.length&&(Y.set(this,e,{value:I.event.trigger(I.extend(s[0],I.Event.prototype),s.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===Y.get(t,e)&&I.event.add(t,e,It)}I.event={global:{},add:function(t,e,n,i,r){var o,s,a,l,c,u,h,d,f,p,g,m=Y.get(t);if(W(t))for(n.handler&&(n=(o=n).handler,r=o.selector),r&&I.find.matchesSelector(it,r),n.guid||(n.guid=I.guid++),(l=m.events)||(l=m.events=Object.create(null)),(s=m.handle)||(s=m.handle=function(e){return void 0!==I&&I.event.triggered!==e.type?I.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(P)||[""]).length;c--;)f=g=(a=Ct.exec(e[c])||[])[1],p=(a[2]||"").split(".").sort(),f&&(h=I.event.special[f]||{},f=(r?h.delegateType:h.bindType)||f,h=I.event.special[f]||{},u=I.extend({type:f,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&I.expr.match.needsContext.test(r),namespace:p.join(".")},o),(d=l[f])||((d=l[f]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,i,p,s)||t.addEventListener&&t.addEventListener(f,s)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,u):d.push(u),I.event.global[f]=!0)},remove:function(t,e,n,i,r){var o,s,a,l,c,u,h,d,f,p,g,m=Y.hasData(t)&&Y.get(t);if(m&&(l=m.events)){for(c=(e=(e||"").match(P)||[""]).length;c--;)if(f=g=(a=Ct.exec(e[c])||[])[1],p=(a[2]||"").split(".").sort(),f){for(h=I.event.special[f]||{},d=l[f=(i?h.delegateType:h.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)u=d[o],!r&&g!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(t,u));s&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,p,m.handle)||I.removeEvent(t,f,m.handle),delete l[f])}else for(f in l)I.event.remove(t,f+e[c],n,i,!0);I.isEmptyObject(l)&&Y.remove(t,"handle events")}},dispatch:function(t){var e,n,i,r,o,s,a=new Array(arguments.length),l=I.event.fix(t),c=(Y.get(this,"events")||Object.create(null))[l.type]||[],u=I.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(s=I.event.handlers.call(this,l,c),e=0;(r=s[e++])&&!l.isPropagationStopped();)for(l.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==o.namespace&&!l.rnamespace.test(o.namespace)||(l.handleObj=o,l.data=o.data,void 0!==(i=((I.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,a))&&!1===(l.result=i)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(t,e){var n,i,r,o,s,a=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&1<=t.button))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(o=[],s={},n=0;n<l;n++)void 0===s[r=(i=e[n]).selector+" "]&&(s[r]=i.needsContext?-1<I(r,this).index(c):I.find(r,this,null,[c]).length),s[r]&&o.push(i);o.length&&a.push({elem:c,handlers:o})}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(I.Event.prototype,t,{enumerable:!0,configurable:!0,get:p(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[I.expando]?t:new I.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return dt.test(e.type)&&e.click&&D(e,"input")&&xt(e,"click",It),!1},trigger:function(t){var e=this||t;return dt.test(e.type)&&e.click&&D(e,"input")&&xt(e,"click"),!0},_default:function(t){var e=t.target;return dt.test(e.type)&&e.click&&D(e,"input")&&Y.get(e,"click")||D(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},I.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},I.Event=function(t,e){if(!(this instanceof I.Event))return new I.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?It:Et,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&I.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[I.expando]=!0},I.Event.prototype={constructor:I.Event,isDefaultPrevented:Et,isPropagationStopped:Et,isImmediatePropagationStopped:Et,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=It,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=It,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=It,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},I.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},I.event.addProp),I.each({focus:"focusin",blur:"focusout"},function(t,e){I.event.special[t]={setup:function(){return xt(this,t,Tt),!1},trigger:function(){return xt(this,t),!0},_default:function(){return!0},delegateType:e}}),I.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){I.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=t.relatedTarget,r=t.handleObj;return i&&(i===this||I.contains(this,i))||(t.type=r.origType,n=r.handler.apply(this,arguments),t.type=e),n}}}),I.fn.extend({on:function(t,e,n,i){return wt(this,t,e,n,i)},one:function(t,e,n,i){return wt(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,I(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=Et),this.each(function(){I.event.remove(this,t,n,e)})}});var _t=/<script|<style|<link/i,Dt=/checked\s*(?:[^=]|=\s*.checked.)/i,At=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ot(t,e){return D(t,"table")&&D(11!==e.nodeType?e:e.firstChild,"tr")&&I(t).children("tbody")[0]||t}function St(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Rt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function kt(t,e){var n,i,r,o,s,a;if(1===e.nodeType){if(Y.hasData(t)&&(a=Y.get(t).events))for(r in Y.remove(e,"handle events"),a)for(n=0,i=a[r].length;n<i;n++)I.event.add(e,r,a[r][n]);X.hasData(t)&&(o=X.access(t),s=I.extend({},o),X.set(e,s))}}function Nt(t,e,n,i){e=o(e);var r,s,a,l,c,u,h=0,d=t.length,g=d-1,m=e[0],v=p(m);if(v||1<d&&"string"==typeof m&&!f.checkClone&&Dt.test(m))return t.each(function(r){var o=t.eq(r);v&&(e[0]=m.call(this,r,o.html())),Nt(o,e,n,i)});if(d&&(s=(r=bt(e,t[0].ownerDocument,!1,t,i)).firstChild,1===r.childNodes.length&&(r=s),s||i)){for(l=(a=I.map(mt(r,"script"),St)).length;h<d;h++)c=r,h!==g&&(c=I.clone(c,!0,!0),l&&I.merge(a,mt(c,"script"))),n.call(t[h],c,h);if(l)for(u=a[a.length-1].ownerDocument,I.map(a,Rt),h=0;h<l;h++)c=a[h],pt.test(c.type||"")&&!Y.access(c,"globalEval")&&I.contains(u,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?I._evalUrl&&!c.noModule&&I._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},u):y(c.textContent.replace(At,""),c,u))}return t}function Mt(t,e,n){for(var i,r=e?I.filter(e,t):t,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||I.cleanData(mt(i)),i.parentNode&&(n&&rt(i)&&vt(mt(i,"script")),i.parentNode.removeChild(i));return t}I.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var i,r,o,s,a,l,c,u=t.cloneNode(!0),h=rt(t);if(!(f.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||I.isXMLDoc(t)))for(s=mt(u),i=0,r=(o=mt(t)).length;i<r;i++)a=o[i],"input"===(c=(l=s[i]).nodeName.toLowerCase())&&dt.test(a.type)?l.checked=a.checked:"input"!==c&&"textarea"!==c||(l.defaultValue=a.defaultValue);if(e)if(n)for(o=o||mt(t),s=s||mt(u),i=0,r=o.length;i<r;i++)kt(o[i],s[i]);else kt(t,u);return 0<(s=mt(u,"script")).length&&vt(s,!h&&mt(t,"script")),u},cleanData:function(t){for(var e,n,i,r=I.event.special,o=0;void 0!==(n=t[o]);o++)if(W(n)){if(e=n[Y.expando]){if(e.events)for(i in e.events)r[i]?I.event.remove(n,i):I.removeEvent(n,i,e.handle);n[Y.expando]=void 0}n[X.expando]&&(n[X.expando]=void 0)}}}),I.fn.extend({detach:function(t){return Mt(this,t,!0)},remove:function(t){return Mt(this,t)},text:function(t){return F(this,function(t){return void 0===t?I.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return Nt(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ot(this,t).appendChild(t)})},prepend:function(){return Nt(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Ot(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return Nt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return Nt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(I.cleanData(mt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return I.clone(this,t,e)})},html:function(t){return F(this,function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!_t.test(t)&&!gt[(ft.exec(t)||["",""])[1].toLowerCase()]){t=I.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(I.cleanData(mt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return Nt(this,arguments,function(e){var n=this.parentNode;I.inArray(this,t)<0&&(I.cleanData(mt(this)),n&&n.replaceChild(e,this))},t)}}),I.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){I.fn[t]=function(t){for(var n,i=[],r=I(t),o=r.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),I(r[a])[e](n),s.apply(i,n.get());return this.pushStack(i)}});var Pt=new RegExp("^("+tt+")(?!px)[a-z%]+$","i"),Lt=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)},Kt=function(t,e,n){var i,r,o={};for(r in e)o[r]=t.style[r],t.style[r]=e[r];for(r in i=n.call(t),e)t.style[r]=o[r];return i},Bt=new RegExp(nt.join("|"),"i");function zt(t,e,n){var i,r,o,s,a=t.style;return(n=n||Lt(t))&&(""!==(s=n.getPropertyValue(e)||n[e])||rt(t)||(s=I.style(t,e)),!f.pixelBoxStyles()&&Pt.test(s)&&Bt.test(e)&&(i=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=i,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function jt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function e(){if(u){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",it.appendChild(c).appendChild(u);var e=t.getComputedStyle(u);i="1%"!==e.top,l=12===n(e.marginLeft),u.style.right="60%",s=36===n(e.right),r=36===n(e.width),u.style.position="absolute",o=12===n(u.offsetWidth/3),it.removeChild(c),u=null}}function n(t){return Math.round(parseFloat(t))}var i,r,o,s,a,l,c=m.createElement("div"),u=m.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",f.clearCloneStyle="content-box"===u.style.backgroundClip,I.extend(f,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),s},pixelPosition:function(){return e(),i},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),o},reliableTrDimensions:function(){var e,n,i,r;return null==a&&(e=m.createElement("table"),n=m.createElement("tr"),i=m.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",n.style.cssText="border:1px solid",n.style.height="1px",i.style.height="9px",i.style.display="block",it.appendChild(e).appendChild(n).appendChild(i),r=t.getComputedStyle(n),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===n.offsetHeight,it.removeChild(e)),a}}))}();var Gt=["Webkit","Moz","ms"],Ft=m.createElement("div").style,Vt={};function Ht(t){return I.cssProps[t]||Vt[t]||(t in Ft?t:Vt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=Gt.length;n--;)if((t=Gt[n]+e)in Ft)return t}(t)||t)}var Ut=/^(none|table(?!-c[ea]).+)/,Zt=/^--/,Wt={position:"absolute",visibility:"hidden",display:"block"},$t={letterSpacing:"0",fontWeight:"400"};function Yt(t,e,n){var i=et.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function Xt(t,e,n,i,r,o){var s="width"===e?1:0,a=0,l=0;if(n===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(l+=I.css(t,n+nt[s],!0,r)),i?("content"===n&&(l-=I.css(t,"padding"+nt[s],!0,r)),"margin"!==n&&(l-=I.css(t,"border"+nt[s]+"Width",!0,r))):(l+=I.css(t,"padding"+nt[s],!0,r),"padding"!==n?l+=I.css(t,"border"+nt[s]+"Width",!0,r):a+=I.css(t,"border"+nt[s]+"Width",!0,r));return!i&&0<=o&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-l-a-.5))||0),l}function qt(t,e,n){var i=Lt(t),r=(!f.boxSizingReliable()||n)&&"border-box"===I.css(t,"boxSizing",!1,i),o=r,s=zt(t,e,i),a="offset"+e[0].toUpperCase()+e.slice(1);if(Pt.test(s)){if(!n)return s;s="auto"}return(!f.boxSizingReliable()&&r||!f.reliableTrDimensions()&&D(t,"tr")||"auto"===s||!parseFloat(s)&&"inline"===I.css(t,"display",!1,i))&&t.getClientRects().length&&(r="border-box"===I.css(t,"boxSizing",!1,i),(o=a in t)&&(s=t[a])),(s=parseFloat(s)||0)+Xt(t,e,n||(r?"border":"content"),o,i,s)+"px"}function Jt(t,e,n,i,r){return new Jt.prototype.init(t,e,n,i,r)}I.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=zt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,s,a=Z(e),l=Zt.test(e),c=t.style;if(l||(e=Ht(a)),s=I.cssHooks[e]||I.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(r=s.get(t,!1,i))?r:c[e];"string"==(o=typeof n)&&(r=et.exec(n))&&r[1]&&(n=at(t,e,r),o="number"),null!=n&&n==n&&("number"!==o||l||(n+=r&&r[3]||(I.cssNumber[a]?"":"px")),f.clearCloneStyle||""!==n||0!==e.indexOf("background")||(c[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,i))||(l?c.setProperty(e,n):c[e]=n))}},css:function(t,e,n,i){var r,o,s,a=Z(e);return Zt.test(e)||(e=Ht(a)),(s=I.cssHooks[e]||I.cssHooks[a])&&"get"in s&&(r=s.get(t,!0,n)),void 0===r&&(r=zt(t,e,i)),"normal"===r&&e in $t&&(r=$t[e]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),I.each(["height","width"],function(t,e){I.cssHooks[e]={get:function(t,n,i){if(n)return!Ut.test(I.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?qt(t,e,i):Kt(t,Wt,function(){return qt(t,e,i)})},set:function(t,n,i){var r,o=Lt(t),s=!f.scrollboxSize()&&"absolute"===o.position,a=(s||i)&&"border-box"===I.css(t,"boxSizing",!1,o),l=i?Xt(t,e,i,a,o):0;return a&&s&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(o[e])-Xt(t,e,"border",!1,o)-.5)),l&&(r=et.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=I.css(t,e)),Yt(0,n,l)}}}),I.cssHooks.marginLeft=jt(f.reliableMarginLeft,function(t,e){if(e)return(parseFloat(zt(t,"marginLeft"))||t.getBoundingClientRect().left-Kt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),I.each({margin:"",padding:"",border:"Width"},function(t,e){I.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+nt[i]+e]=o[i]||o[i-2]||o[0];return r}},"margin"!==t&&(I.cssHooks[t+e].set=Yt)}),I.fn.extend({css:function(t,e){return F(this,function(t,e,n){var i,r,o={},s=0;if(Array.isArray(e)){for(i=Lt(t),r=e.length;s<r;s++)o[e[s]]=I.css(t,e[s],!1,i);return o}return void 0!==n?I.style(t,e,n):I.css(t,e)},t,e,1<arguments.length)}}),((I.Tween=Jt).prototype={constructor:Jt,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||I.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(I.cssNumber[n]?"":"px")},cur:function(){var t=Jt.propHooks[this.prop];return t&&t.get?t.get(this):Jt.propHooks._default.get(this)},run:function(t){var e,n=Jt.propHooks[this.prop];return this.options.duration?this.pos=e=I.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Jt.propHooks._default.set(this),this}}).init.prototype=Jt.prototype,(Jt.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=I.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){I.fx.step[t.prop]?I.fx.step[t.prop](t):1!==t.elem.nodeType||!I.cssHooks[t.prop]&&null==t.elem.style[Ht(t.prop)]?t.elem[t.prop]=t.now:I.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=Jt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},I.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},I.fx=Jt.prototype.init,I.fx.step={};var Qt,te,ee,ne,ie=/^(?:toggle|show|hide)$/,re=/queueHooks$/;function oe(){te&&(!1===m.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(oe):t.setTimeout(oe,I.fx.interval),I.fx.tick())}function se(){return t.setTimeout(function(){Qt=void 0}),Qt=Date.now()}function ae(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)r["margin"+(n=nt[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function le(t,e,n){for(var i,r=(ce.tweeners[e]||[]).concat(ce.tweeners["*"]),o=0,s=r.length;o<s;o++)if(i=r[o].call(n,e,t))return i}function ce(t,e,n){var i,r,o=0,s=ce.prefilters.length,a=I.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var e=Qt||se(),n=Math.max(0,c.startTime+c.duration-e),i=1-(n/c.duration||0),o=0,s=c.tweens.length;o<s;o++)c.tweens[o].run(i);return a.notifyWith(t,[c,i,n]),i<1&&s?n:(s||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:I.extend({},e),opts:I.extend(!0,{specialEasing:{},easing:I.easing._default},n),originalProperties:e,originalOptions:n,startTime:Qt||se(),duration:n.duration,tweens:[],createTween:function(e,n){var i=I.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var n=0,i=e?c.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)c.tweens[n].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),u=c.props;for(function(t,e){var n,i,r,o,s;for(n in t)if(r=e[i=Z(n)],o=t[n],Array.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),(s=I.cssHooks[i])&&"expand"in s)for(n in o=s.expand(o),delete t[i],o)n in t||(t[n]=o[n],e[n]=r);else e[i]=r}(u,c.opts.specialEasing);o<s;o++)if(i=ce.prefilters[o].call(c,t,u,c.opts))return p(i.stop)&&(I._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return I.map(u,le,c),p(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),I.fx.timer(I.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}I.Animation=I.extend(ce,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return at(n.elem,t,et.exec(e),n),n}]},tweener:function(t,e){p(t)?(e=t,t=["*"]):t=t.match(P);for(var n,i=0,r=t.length;i<r;i++)n=t[i],ce.tweeners[n]=ce.tweeners[n]||[],ce.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var i,r,o,s,a,l,c,u,h="width"in e||"height"in e,d=this,f={},p=t.style,g=t.nodeType&&st(t),m=Y.get(t,"fxshow");for(i in n.queue||(null==(s=I._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,I.queue(t,"fx").length||s.empty.fire()})})),e)if(r=e[i],ie.test(r)){if(delete e[i],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;g=!0}f[i]=m&&m[i]||I.style(t,i)}if((l=!I.isEmptyObject(e))||!I.isEmptyObject(f))for(i in h&&1===t.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(c=m&&m.display)&&(c=Y.get(t,"display")),"none"===(u=I.css(t,"display"))&&(c?u=c:(ct([t],!0),c=t.style.display||c,u=I.css(t,"display"),ct([t]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===I.css(t,"float")&&(l||(d.done(function(){p.display=c}),null==c&&(u=p.display,c="none"===u?"":u)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),l=!1,f)l||(m?"hidden"in m&&(g=m.hidden):m=Y.access(t,"fxshow",{display:c}),o&&(m.hidden=!g),g&&ct([t],!0),d.done(function(){for(i in g||ct([t]),Y.remove(t,"fxshow"),f)I.style(t,i,f[i])})),l=le(g?m[i]:0,i,d),i in m||(m[i]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?ce.prefilters.unshift(t):ce.prefilters.push(t)}}),I.speed=function(t,e,n){var i=t&&"object"==typeof t?I.extend({},t):{complete:n||!n&&e||p(t)&&t,duration:t,easing:n&&e||e&&!p(e)&&e};return I.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in I.fx.speeds?i.duration=I.fx.speeds[i.duration]:i.duration=I.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){p(i.old)&&i.old.call(this),i.queue&&I.dequeue(this,i.queue)},i},I.fn.extend({fadeTo:function(t,e,n,i){return this.filter(st).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=I.isEmptyObject(t),o=I.speed(e,n,i),s=function(){var e=ce(this,I.extend({},t),o);(r||Y.get(this,"finish"))&&e.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=I.timers,s=Y.get(this);if(r)s[r]&&s[r].stop&&i(s[r]);else for(r in s)s[r]&&s[r].stop&&re.test(r)&&i(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));!e&&n||I.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,n=Y.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=I.timers,s=i?i.length:0;for(n.finish=!0,I.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),I.each(["toggle","show","hide"],function(t,e){var n=I.fn[e];I.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(ae(e,!0),t,i,r)}}),I.each({slideDown:ae("show"),slideUp:ae("hide"),slideToggle:ae("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){I.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),I.timers=[],I.fx.tick=function(){var t,e=0,n=I.timers;for(Qt=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||I.fx.stop(),Qt=void 0},I.fx.timer=function(t){I.timers.push(t),I.fx.start()},I.fx.interval=13,I.fx.start=function(){te||(te=!0,oe())},I.fx.stop=function(){te=null},I.fx.speeds={slow:600,fast:200,_default:400},I.fn.delay=function(e,n){return e=I.fx&&I.fx.speeds[e]||e,n=n||"fx",this.queue(n,function(n,i){var r=t.setTimeout(n,e);i.stop=function(){t.clearTimeout(r)}})},ee=m.createElement("input"),ne=m.createElement("select").appendChild(m.createElement("option")),ee.type="checkbox",f.checkOn=""!==ee.value,f.optSelected=ne.selected,(ee=m.createElement("input")).value="t",ee.type="radio",f.radioValue="t"===ee.value;var ue,he=I.expr.attrHandle;I.fn.extend({attr:function(t,e){return F(this,I.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){I.removeAttr(this,t)})}}),I.extend({attr:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?I.prop(t,e,n):(1===o&&I.isXMLDoc(t)||(r=I.attrHooks[e.toLowerCase()]||(I.expr.match.bool.test(e)?ue:void 0)),void 0!==n?null===n?void I.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:null==(i=I.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!f.radioValue&&"radio"===e&&D(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,r=e&&e.match(P);if(r&&1===t.nodeType)for(;n=r[i++];)t.removeAttribute(n)}}),ue={set:function(t,e,n){return!1===e?I.removeAttr(t,n):t.setAttribute(n,n),n}},I.each(I.expr.match.bool.source.match(/\w+/g),function(t,e){var n=he[e]||I.find.attr;he[e]=function(t,e,i){var r,o,s=e.toLowerCase();return i||(o=he[s],he[s]=r,r=null!=n(t,e,i)?s:null,he[s]=o),r}});var de=/^(?:input|select|textarea|button)$/i,fe=/^(?:a|area)$/i;function pe(t){return(t.match(P)||[]).join(" ")}function ge(t){return t.getAttribute&&t.getAttribute("class")||""}function me(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(P)||[]}I.fn.extend({prop:function(t,e){return F(this,I.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[I.propFix[t]||t]})}}),I.extend({prop:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&I.isXMLDoc(t)||(e=I.propFix[e]||e,r=I.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=I.find.attr(t,"tabindex");return e?parseInt(e,10):de.test(t.nodeName)||fe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),f.optSelected||(I.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),I.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){I.propFix[this.toLowerCase()]=this}),I.fn.extend({addClass:function(t){var e,n,i,r,o,s,a,l=0;if(p(t))return this.each(function(e){I(this).addClass(t.call(this,e,ge(this)))});if((e=me(t)).length)for(;n=this[l++];)if(r=ge(n),i=1===n.nodeType&&" "+pe(r)+" "){for(s=0;o=e[s++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");r!==(a=pe(i))&&n.setAttribute("class",a)}return this},removeClass:function(t){var e,n,i,r,o,s,a,l=0;if(p(t))return this.each(function(e){I(this).removeClass(t.call(this,e,ge(this)))});if(!arguments.length)return this.attr("class","");if((e=me(t)).length)for(;n=this[l++];)if(r=ge(n),i=1===n.nodeType&&" "+pe(r)+" "){for(s=0;o=e[s++];)for(;-1<i.indexOf(" "+o+" ");)i=i.replace(" "+o+" "," ");r!==(a=pe(i))&&n.setAttribute("class",a)}return this},toggleClass:function(t,e){var n=typeof t,i="string"===n||Array.isArray(t);return"boolean"==typeof e&&i?e?this.addClass(t):this.removeClass(t):p(t)?this.each(function(n){I(this).toggleClass(t.call(this,n,ge(this),e),e)}):this.each(function(){var e,r,o,s;if(i)for(r=0,o=I(this),s=me(t);e=s[r++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==n||((e=ge(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Y.get(this,"__className__")||""))})},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&-1<(" "+pe(ge(n))+" ").indexOf(e))return!0;return!1}});var ve=/\r/g;I.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=p(t),this.each(function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,I(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=I.map(r,function(t){return null==t?"":t+""})),(e=I.valHooks[this.type]||I.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))})):r?(e=I.valHooks[r.type]||I.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(ve,""):null==n?"":n:void 0}}),I.extend({valHooks:{option:{get:function(t){var e=I.find.attr(t,"value");return null!=e?e:pe(I.text(t))}},select:{get:function(t){var e,n,i,r=t.options,o=t.selectedIndex,s="select-one"===t.type,a=s?null:[],l=s?o+1:r.length;for(i=o<0?l:s?o:0;i<l;i++)if(((n=r[i]).selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!D(n.parentNode,"optgroup"))){if(e=I(n).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,o=I.makeArray(e),s=r.length;s--;)((i=r[s]).selected=-1<I.inArray(I.valHooks.option.get(i),o))&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),I.each(["radio","checkbox"],function(){I.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=-1<I.inArray(I(t).val(),e)}},f.checkOn||(I.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),f.focusin="onfocusin"in t;var ye=/^(?:focusinfocus|focusoutblur)$/,be=function(t){t.stopPropagation()};I.extend(I.event,{trigger:function(e,n,i,r){var o,s,a,l,c,h,d,f,v=[i||m],y=u.call(e,"type")?e.type:e,b=u.call(e,"namespace")?e.namespace.split("."):[];if(s=f=a=i=i||m,3!==i.nodeType&&8!==i.nodeType&&!ye.test(y+I.event.triggered)&&(-1<y.indexOf(".")&&(y=(b=y.split(".")).shift(),b.sort()),c=y.indexOf(":")<0&&"on"+y,(e=e[I.expando]?e:new I.Event(y,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=b.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),n=null==n?[e]:I.makeArray(n,[e]),d=I.event.special[y]||{},r||!d.trigger||!1!==d.trigger.apply(i,n))){if(!r&&!d.noBubble&&!g(i)){for(l=d.delegateType||y,ye.test(l+y)||(s=s.parentNode);s;s=s.parentNode)v.push(s),a=s;a===(i.ownerDocument||m)&&v.push(a.defaultView||a.parentWindow||t)}for(o=0;(s=v[o++])&&!e.isPropagationStopped();)f=s,e.type=1<o?l:d.bindType||y,(h=(Y.get(s,"events")||Object.create(null))[e.type]&&Y.get(s,"handle"))&&h.apply(s,n),(h=c&&s[c])&&h.apply&&W(s)&&(e.result=h.apply(s,n),!1===e.result&&e.preventDefault());return e.type=y,r||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(v.pop(),n)||!W(i)||c&&p(i[y])&&!g(i)&&((a=i[c])&&(i[c]=null),I.event.triggered=y,e.isPropagationStopped()&&f.addEventListener(y,be),i[y](),e.isPropagationStopped()&&f.removeEventListener(y,be),I.event.triggered=void 0,a&&(i[c]=a)),e.result}},simulate:function(t,e,n){var i=I.extend(new I.Event,n,{type:t,isSimulated:!0});I.event.trigger(i,null,e)}}),I.fn.extend({trigger:function(t,e){return this.each(function(){I.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return I.event.trigger(t,e,n,!0)}}),f.focusin||I.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){I.event.simulate(e,t.target,I.event.fix(t))};I.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,r=Y.access(i,e);r||i.addEventListener(t,n,!0),Y.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,r=Y.access(i,e)-1;r?Y.access(i,e,r):(i.removeEventListener(t,n,!0),Y.remove(i,e))}}});var Ce=t.location,Ie={guid:Date.now()},Ee=/\?/;I.parseXML=function(e){var n,i;if(!e||"string"!=typeof e)return null;try{n=(new t.DOMParser).parseFromString(e,"text/xml")}catch(e){}return i=n&&n.getElementsByTagName("parsererror")[0],n&&!i||I.error("Invalid XML: "+(i?I.map(i.childNodes,function(t){return t.textContent}).join("\n"):e)),n};var Te=/\[\]$/,we=/\r?\n/g,xe=/^(?:submit|button|image|reset|file)$/i,_e=/^(?:input|select|textarea|keygen)/i;function De(t,e,n,i){var r;if(Array.isArray(e))I.each(e,function(e,r){n||Te.test(t)?i(t,r):De(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,i)});else if(n||"object"!==b(e))i(t,e);else for(r in e)De(t+"["+r+"]",e[r],n,i)}I.param=function(t,e){var n,i=[],r=function(t,e){var n=p(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!I.isPlainObject(t))I.each(t,function(){r(this.name,this.value)});else for(n in t)De(n,t[n],e,r);return i.join("&")},I.fn.extend({serialize:function(){return I.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=I.prop(this,"elements");return t?I.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!I(this).is(":disabled")&&_e.test(this.nodeName)&&!xe.test(t)&&(this.checked||!dt.test(t))}).map(function(t,e){var n=I(this).val();return null==n?null:Array.isArray(n)?I.map(n,function(t){return{name:e.name,value:t.replace(we,"\r\n")}}):{name:e.name,value:n.replace(we,"\r\n")}}).get()}});var Ae=/%20/g,Oe=/#.*$/,Se=/([?&])_=[^&]*/,Re=/^(.*?):[ \t]*([^\r\n]*)$/gm,ke=/^(?:GET|HEAD)$/,Ne=/^\/\//,Me={},Pe={},Le="*/".concat("*"),Ke=m.createElement("a");function Be(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(P)||[];if(p(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function ze(t,e,n,i){var r={},o=t===Pe;function s(a){var l;return r[a]=!0,I.each(t[a]||[],function(t,a){var c=a(e,n,i);return"string"!=typeof c||o||r[c]?o?!(l=c):void 0:(e.dataTypes.unshift(c),s(c),!1)}),l}return s(e.dataTypes[0])||!r["*"]&&s("*")}function je(t,e){var n,i,r=I.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&I.extend(!0,t,i),t}Ke.href=Ce.href,I.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ce.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ce.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Le,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":I.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?je(je(t,I.ajaxSettings),e):je(I.ajaxSettings,t)},ajaxPrefilter:Be(Me),ajaxTransport:Be(Pe),ajax:function(e,n){"object"==typeof e&&(n=e,e=void 0),n=n||{};var i,r,o,s,a,l,c,u,h,d,f=I.ajaxSetup({},n),p=f.context||f,g=f.context&&(p.nodeType||p.jquery)?I(p):I.event,v=I.Deferred(),y=I.Callbacks("once memory"),b=f.statusCode||{},C={},E={},T="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(c){if(!s)for(s={};e=Re.exec(o);)s[e[1].toLowerCase()+" "]=(s[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=s[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return c?o:null},setRequestHeader:function(t,e){return null==c&&(t=E[t.toLowerCase()]=E[t.toLowerCase()]||t,C[t]=e),this},overrideMimeType:function(t){return null==c&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)w.always(t[w.status]);else for(e in t)b[e]=[b[e],t[e]];return this},abort:function(t){var e=t||T;return i&&i.abort(e),x(0,e),this}};if(v.promise(w),f.url=((e||f.url||Ce.href)+"").replace(Ne,Ce.protocol+"//"),f.type=n.method||n.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(P)||[""],null==f.crossDomain){l=m.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=Ke.protocol+"//"+Ke.host!=l.protocol+"//"+l.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=I.param(f.data,f.traditional)),ze(Me,f,n,w),c)return w;for(h in(u=I.event&&f.global)&&0==I.active++&&I.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!ke.test(f.type),r=f.url.replace(Oe,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Ae,"+")):(d=f.url.slice(r.length),f.data&&(f.processData||"string"==typeof f.data)&&(r+=(Ee.test(r)?"&":"?")+f.data,delete f.data),!1===f.cache&&(r=r.replace(Se,"$1"),d=(Ee.test(r)?"&":"?")+"_="+Ie.guid+++d),f.url=r+d),f.ifModified&&(I.lastModified[r]&&w.setRequestHeader("If-Modified-Since",I.lastModified[r]),I.etag[r]&&w.setRequestHeader("If-None-Match",I.etag[r])),(f.data&&f.hasContent&&!1!==f.contentType||n.contentType)&&w.setRequestHeader("Content-Type",f.contentType),w.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Le+"; q=0.01":""):f.accepts["*"]),f.headers)w.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(!1===f.beforeSend.call(p,w,f)||c))return w.abort();if(T="abort",y.add(f.complete),w.done(f.success),w.fail(f.error),i=ze(Pe,f,n,w)){if(w.readyState=1,u&&g.trigger("ajaxSend",[w,f]),c)return w;f.async&&0<f.timeout&&(a=t.setTimeout(function(){w.abort("timeout")},f.timeout));try{c=!1,i.send(C,x)}catch(e){if(c)throw e;x(-1,e)}}else x(-1,"No Transport");function x(e,n,s,l){var h,d,m,C,E,T=n;c||(c=!0,a&&t.clearTimeout(a),i=void 0,o=l||"",w.readyState=0<e?4:0,h=200<=e&&e<300||304===e,s&&(C=function(t,e,n){for(var i,r,o,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||t.converters[r+" "+l[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),n[o]}(f,w,s)),!h&&-1<I.inArray("script",f.dataTypes)&&I.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),C=function(t,e,n,i){var r,o,s,a,l,c={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(o=u.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(s=c[l+" "+o]||c["* "+o]))for(r in c)if((a=r.split(" "))[1]===o&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[r]:!0!==c[r]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}(f,C,w,h),h?(f.ifModified&&((E=w.getResponseHeader("Last-Modified"))&&(I.lastModified[r]=E),(E=w.getResponseHeader("etag"))&&(I.etag[r]=E)),204===e||"HEAD"===f.type?T="nocontent":304===e?T="notmodified":(T=C.state,d=C.data,h=!(m=C.error))):(m=T,!e&&T||(T="error",e<0&&(e=0))),w.status=e,w.statusText=(n||T)+"",h?v.resolveWith(p,[d,T,w]):v.rejectWith(p,[w,T,m]),w.statusCode(b),b=void 0,u&&g.trigger(h?"ajaxSuccess":"ajaxError",[w,f,h?d:m]),y.fireWith(p,[w,T]),u&&(g.trigger("ajaxComplete",[w,f]),--I.active||I.event.trigger("ajaxStop")))}return w},getJSON:function(t,e,n){return I.get(t,e,n,"json")},getScript:function(t,e){return I.get(t,void 0,e,"script")}}),I.each(["get","post"],function(t,e){I[e]=function(t,n,i,r){return p(n)&&(r=r||i,i=n,n=void 0),I.ajax(I.extend({url:t,type:e,dataType:r,data:n,success:i},I.isPlainObject(t)&&t))}}),I.ajaxPrefilter(function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")}),I._evalUrl=function(t,e,n){return I.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){I.globalEval(t,e,n)}})},I.fn.extend({wrapAll:function(t){var e;return this[0]&&(p(t)&&(t=t.call(this[0])),e=I(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return p(t)?this.each(function(e){I(this).wrapInner(t.call(this,e))}):this.each(function(){var e=I(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=p(t);return this.each(function(n){I(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){I(this).replaceWith(this.childNodes)}),this}}),I.expr.pseudos.hidden=function(t){return!I.expr.pseudos.visible(t)},I.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},I.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(e){}};var Ge={0:200,1223:204},Fe=I.ajaxSettings.xhr();f.cors=!!Fe&&"withCredentials"in Fe,f.ajax=Fe=!!Fe,I.ajaxTransport(function(e){var n,i;if(f.cors||Fe&&!e.crossDomain)return{send:function(r,o){var s,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(s in e.xhrFields)a[s]=e.xhrFields[s];for(s in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)a.setRequestHeader(s,r[s]);n=function(t){return function(){n&&(n=i=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Ge[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),i=a.onerror=a.ontimeout=n("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&t.setTimeout(function(){n&&i()})},n=n("abort");try{a.send(e.hasContent&&e.data||null)}catch(r){if(n)throw r}},abort:function(){n&&n()}}}),I.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),I.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return I.globalEval(t),t}}}),I.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),I.ajaxTransport("script",function(t){var e,n;if(t.crossDomain||t.scriptAttrs)return{send:function(i,r){e=I("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),m.head.appendChild(e[0])},abort:function(){n&&n()}}});var Ve,He=[],Ue=/(=)\?(?=&|$)|\?\?/;I.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=He.pop()||I.expando+"_"+Ie.guid++;return this[t]=!0,t}}),I.ajaxPrefilter("json jsonp",function(e,n,i){var r,o,s,a=!1!==e.jsonp&&(Ue.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ue.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=p(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Ue,"$1"+r):!1!==e.jsonp&&(e.url+=(Ee.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return s||I.error(r+" was not called"),s[0]},e.dataTypes[0]="json",o=t[r],t[r]=function(){s=arguments},i.always(function(){void 0===o?I(t).removeProp(r):t[r]=o,e[r]&&(e.jsonpCallback=n.jsonpCallback,He.push(r)),s&&p(o)&&o(s[0]),s=o=void 0}),"script"}),f.createHTMLDocument=((Ve=m.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ve.childNodes.length),I.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(f.createHTMLDocument?((i=(e=m.implementation.createHTMLDocument("")).createElement("base")).href=m.location.href,e.head.appendChild(i)):e=m),o=!n&&[],(r=A.exec(t))?[e.createElement(r[1])]:(r=bt([t],e,o),o&&o.length&&I(o).remove(),I.merge([],r.childNodes)));var i,r,o},I.fn.load=function(t,e,n){var i,r,o,s=this,a=t.indexOf(" ");return-1<a&&(i=pe(t.slice(a)),t=t.slice(0,a)),p(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),0<s.length&&I.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){o=arguments,s.html(i?I("<div>").append(I.parseHTML(t)).find(i):t)}).always(n&&function(t,e){s.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},I.expr.pseudos.animated=function(t){return I.grep(I.timers,function(e){return t===e.elem}).length},I.offset={setOffset:function(t,e,n){var i,r,o,s,a,l,c=I.css(t,"position"),u=I(t),h={};"static"===c&&(t.style.position="relative"),a=u.offset(),o=I.css(t,"top"),l=I.css(t,"left"),("absolute"===c||"fixed"===c)&&-1<(o+l).indexOf("auto")?(s=(i=u.position()).top,r=i.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),p(e)&&(e=e.call(t,n,I.extend({},a))),null!=e.top&&(h.top=e.top-a.top+s),null!=e.left&&(h.left=e.left-a.left+r),"using"in e?e.using.call(t,h):u.css(h)}},I.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){I.offset.setOffset(this,t,e)});var e,n,i=this[0];return i?i.getClientRects().length?(e=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,i=this[0],r={top:0,left:0};if("fixed"===I.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),n=i.ownerDocument,t=i.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===I.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&((r=I(t).offset()).top+=I.css(t,"borderTopWidth",!0),r.left+=I.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-I.css(i,"marginTop",!0),left:e.left-r.left-I.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===I.css(t,"position");)t=t.offsetParent;return t||it})}}),I.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;I.fn[t]=function(i){return F(this,function(t,i,r){var o;if(g(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===r)return o?o[e]:t[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):t[i]=r},t,i,arguments.length)}}),I.each(["top","left"],function(t,e){I.cssHooks[e]=jt(f.pixelPosition,function(t,n){if(n)return n=zt(t,e),Pt.test(n)?I(t).position()[e]+"px":n})}),I.each({Height:"height",Width:"width"},function(t,e){I.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,i){I.fn[i]=function(r,o){var s=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===o?"margin":"border");return F(this,function(e,n,r){var o;return g(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===r?I.css(e,n,a):I.style(e,n,r,a)},e,s?r:void 0,s)}})}),I.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){I.fn[e]=function(t){return this.on(e,t)}}),I.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),I.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){I.fn[e]=function(t,n){return 0<arguments.length?this.on(e,null,t,n):this.trigger(e)}});var Ze=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;I.proxy=function(t,e){var n,i,o;if("string"==typeof e&&(n=t[e],e=t,t=n),p(t))return i=r.call(arguments,2),(o=function(){return t.apply(e||this,i.concat(r.call(arguments)))}).guid=t.guid=t.guid||I.guid++,o},I.holdReady=function(t){t?I.readyWait++:I.ready(!0)},I.isArray=Array.isArray,I.parseJSON=JSON.parse,I.nodeName=D,I.isFunction=p,I.isWindow=g,I.camelCase=Z,I.type=b,I.now=Date.now,I.isNumeric=function(t){var e=I.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},I.trim=function(t){return null==t?"":(t+"").replace(Ze,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return I});var We=t.jQuery,$e=t.$;return I.noConflict=function(e){return t.$===I&&(t.$=$e),e&&t.jQuery===I&&(t.jQuery=We),I},void 0===e&&(t.jQuery=t.$=I),I}),(function(){function t(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function e(t,e,n,i){for(var r=-1,o=null==t?0:t.length;++r<o;){var s=t[r];e(i,s,n(s),t)}return i}function n(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}function i(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function r(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function o(t,e){for(var n=-1,i=null==t?0:t.length,r=0,o=[];++n<i;){var s=t[n];e(s,n,t)&&(o[r++]=s)}return o}function s(t,e){return!(null==t||!t.length)&&m(t,e,0)>-1}function a(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}function l(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}function c(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}function u(t,e,n,i){var r=-1,o=null==t?0:t.length;for(i&&o&&(n=t[++r]);++r<o;)n=e(n,t[r],r,t);return n}function h(t,e,n,i){var r=null==t?0:t.length;for(i&&r&&(n=t[--r]);r--;)n=e(n,t[r],r,t);return n}function d(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function f(t){return t.match(Yt)||[]}function p(t,e,n){var i;return n(t,function(t,n,r){if(e(t,n,r))return i=n,!1}),i}function g(t,e,n,i){for(var r=t.length,o=n+(i?1:-1);i?o--:++o<r;)if(e(t[o],o,t))return o;return-1}function m(t,e,n){return e==e?function(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}(t,e,n):g(t,y,n)}function v(t,e,n,i){for(var r=n-1,o=t.length;++r<o;)if(i(t[r],e))return r;return-1}function y(t){return t!=t}function b(t,e){var n=null==t?0:t.length;return n?T(t,e)/n:Q}function C(t){return function(e){return null==e?F:e[t]}}function I(t){return function(e){return null==t?F:t[e]}}function E(t,e,n,i,r){return r(t,function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)}),n}function T(t,e){for(var n,i=-1,r=t.length;++i<r;){var o=e(t[i]);o!==F&&(n=n===F?o:n+o)}return n}function w(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}function x(t){return t?t.slice(0,j(t)+1).replace(Ht,""):t}function _(t){return function(e){return t(e)}}function D(t,e){return l(e,function(e){return t[e]})}function A(t,e){return t.has(e)}function O(t,e){for(var n=-1,i=t.length;++n<i&&m(e,t[n],0)>-1;);return n}function S(t,e){for(var n=t.length;n--&&m(e,t[n],0)>-1;);return n}function R(t){return"\\"+$e[t]}function k(t){return Fe.test(t)}function N(t){return Ve.test(t)}function M(t){var e=-1,n=Array(t.size);return t.forEach(function(t,i){n[++e]=[i,t]}),n}function P(t,e){return function(n){return t(e(n))}}function L(t,e){for(var n=-1,i=t.length,r=0,o=[];++n<i;){var s=t[n];s!==e&&s!==U||(t[n]=U,o[r++]=n)}return o}function K(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function B(t){return k(t)?function(t){for(var e=je.lastIndex=0;je.test(t);)++e;return e}(t):dn(t)}function z(t){return k(t)?function(t){return t.match(je)||[]}(t):function(t){return t.split("")}(t)}function j(t){for(var e=t.length;e--&&Ut.test(t.charAt(e)););return e}function G(t){return t.match(Ge)||[]}var F,V="Expected a function",H="__lodash_hash_undefined__",U="__lodash_placeholder__",Z=16,W=32,$=64,Y=128,X=256,q=1/0,J=9007199254740991,Q=NaN,tt=4294967295,et=[["ary",Y],["bind",1],["bindKey",2],["curry",8],["curryRight",Z],["flip",512],["partial",W],["partialRight",$],["rearg",X]],nt="[object Arguments]",it="[object Array]",rt="[object Boolean]",ot="[object Date]",st="[object Error]",at="[object Function]",lt="[object GeneratorFunction]",ct="[object Map]",ut="[object Number]",ht="[object Object]",dt="[object Promise]",ft="[object RegExp]",pt="[object Set]",gt="[object String]",mt="[object Symbol]",vt="[object WeakMap]",yt="[object ArrayBuffer]",bt="[object DataView]",Ct="[object Float32Array]",It="[object Float64Array]",Et="[object Int8Array]",Tt="[object Int16Array]",wt="[object Int32Array]",xt="[object Uint8Array]",_t="[object Uint8ClampedArray]",Dt="[object Uint16Array]",At="[object Uint32Array]",Ot=/\b__p \+= '';/g,St=/\b(__p \+=) '' \+/g,Rt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,kt=/&(?:amp|lt|gt|quot|#39);/g,Nt=/[&<>"']/g,Mt=RegExp(kt.source),Pt=RegExp(Nt.source),Lt=/<%-([\s\S]+?)%>/g,Kt=/<%([\s\S]+?)%>/g,Bt=/<%=([\s\S]+?)%>/g,zt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,jt=/^\w*$/,Gt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ft=/[\\^$.*+?()[\]{}|]/g,Vt=RegExp(Ft.source),Ht=/^\s+/,Ut=/\s/,Zt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Wt=/\{\n\/\* \[wrapped with (.+)\] \*/,$t=/,? & /,Yt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Xt=/[()=,{}\[\]\/\s]/,qt=/\\(\\)?/g,Jt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Qt=/\w*$/,te=/^[-+]0x[0-9a-f]+$/i,ee=/^0b[01]+$/i,ne=/^\[object .+?Constructor\]$/,ie=/^0o[0-7]+$/i,re=/^(?:0|[1-9]\d*)$/,oe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,se=/($^)/,ae=/['\n\r\u2028\u2029\\]/g,le="\\ud800-\\udfff",ce="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ue="\\u2700-\\u27bf",he="a-z\\xdf-\\xf6\\xf8-\\xff",de="A-Z\\xc0-\\xd6\\xd8-\\xde",fe="\\ufe0e\\ufe0f",pe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ge="['\u2019]",me="["+le+"]",ve="["+pe+"]",ye="["+ce+"]",be="\\d+",Ce="["+ue+"]",Ie="["+he+"]",Ee="[^"+le+pe+be+ue+he+de+"]",Te="\\ud83c[\\udffb-\\udfff]",we="[^"+le+"]",xe="(?:\\ud83c[\\udde6-\\uddff]){2}",_e="[\\ud800-\\udbff][\\udc00-\\udfff]",De="["+de+"]",Ae="\\u200d",Oe="(?:"+Ie+"|"+Ee+")",Se="(?:"+De+"|"+Ee+")",Re="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ke="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Ne="(?:"+ye+"|"+Te+")"+"?",Me="["+fe+"]?",Pe=Me+Ne+("(?:"+Ae+"(?:"+[we,xe,_e].join("|")+")"+Me+Ne+")*"),Le="(?:"+[Ce,xe,_e].join("|")+")"+Pe,Ke="(?:"+[we+ye+"?",ye,xe,_e,me].join("|")+")",Be=RegExp(ge,"g"),ze=RegExp(ye,"g"),je=RegExp(Te+"(?="+Te+")|"+Ke+Pe,"g"),Ge=RegExp([De+"?"+Ie+"+"+Re+"(?="+[ve,De,"$"].join("|")+")",Se+"+"+ke+"(?="+[ve,De+Oe,"$"].join("|")+")",De+"?"+Oe+"+"+Re,De+"+"+ke,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",be,Le].join("|"),"g"),Fe=RegExp("["+Ae+le+ce+fe+"]"),Ve=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,He=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ue=-1,Ze={};Ze[Ct]=Ze[It]=Ze[Et]=Ze[Tt]=Ze[wt]=Ze[xt]=Ze[_t]=Ze[Dt]=Ze[At]=!0,Ze[nt]=Ze[it]=Ze[yt]=Ze[rt]=Ze[bt]=Ze[ot]=Ze[st]=Ze[at]=Ze[ct]=Ze[ut]=Ze[ht]=Ze[ft]=Ze[pt]=Ze[gt]=Ze[vt]=!1;var We={};We[nt]=We[it]=We[yt]=We[bt]=We[rt]=We[ot]=We[Ct]=We[It]=We[Et]=We[Tt]=We[wt]=We[ct]=We[ut]=We[ht]=We[ft]=We[pt]=We[gt]=We[mt]=We[xt]=We[_t]=We[Dt]=We[At]=!0,We[st]=We[at]=We[vt]=!1;var $e={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ye=parseFloat,Xe=parseInt,qe="object"==typeof global&&global&&global.Object===Object&&global,Je="object"==typeof self&&self&&self.Object===Object&&self,Qe=qe||Je||Function("return this")(),tn="object"==typeof exports&&exports&&!exports.nodeType&&exports,en=tn&&"object"==typeof module&&module&&!module.nodeType&&module,nn=en&&en.exports===tn,rn=nn&&qe.process,on=function(){try{var t=en&&en.require&&en.require("util").types;return t||rn&&rn.binding&&rn.binding("util")}catch(t){}}(),sn=on&&on.isArrayBuffer,an=on&&on.isDate,ln=on&&on.isMap,cn=on&&on.isRegExp,un=on&&on.isSet,hn=on&&on.isTypedArray,dn=C("length"),fn=I({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),pn=I({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),gn=I({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),mn=function I(Ut){function Yt(t){if(Br(t)&&!Aa(t)&&!(t instanceof ue)){if(t instanceof ce)return t;if(Ao.call(t,"__wrapped__"))return ur(t)}return new ce(t)}function le(){}function ce(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=F}function ue(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=tt,this.__views__=[]}function he(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function de(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function fe(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function pe(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new fe;++e<n;)this.add(t[e])}function ge(t){this.size=(this.__data__=new de(t)).size}function me(t,e){var n=Aa(t),i=!n&&Da(t),r=!n&&!i&&Sa(t),o=!n&&!i&&!r&&Pa(t),s=n||i||r||o,a=s?w(t.length,Io):[],l=a.length;for(var c in t)!e&&!Ao.call(t,c)||s&&("length"==c||r&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||$i(c,l))||a.push(c);return a}function ve(t){var e=t.length;return e?t[Rn(0,e-1)]:F}function ye(t,e){return sr(li(t),De(e,0,t.length))}function be(t){return sr(li(t))}function Ce(t,e,n){(n===F||Sr(t[e],n))&&(n!==F||e in t)||xe(t,e,n)}function Ie(t,e,n){var i=t[e];Ao.call(t,e)&&Sr(i,n)&&(n!==F||e in t)||xe(t,e,n)}function Ee(t,e){for(var n=t.length;n--;)if(Sr(t[n][0],e))return n;return-1}function Te(t,e,n,i){return _s(t,function(t,r,o){e(i,t,n(t),o)}),i}function we(t,e){return t&&ci(e,Jr(e),t)}function xe(t,e,n){"__proto__"==e&&Zo?Zo(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function _e(t,e){for(var n=-1,i=e.length,r=po(i),o=null==t;++n<i;)r[n]=o?F:Xr(t,e[n]);return r}function De(t,e,n){return t==t&&(n!==F&&(t=t<=n?t:n),e!==F&&(t=t>=e?t:e)),t}function Ae(t,e,i,r,o,s){var a,l=1&e,c=2&e,u=4&e;if(i&&(a=o?i(t,r,o,s):i(t)),a!==F)return a;if(!Kr(t))return t;var h=Aa(t);if(h){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Ao.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!l)return li(t,a)}else{var d=Bs(t),f=d==at||d==lt;if(Sa(t))return ni(t,l);if(d==ht||d==nt||f&&!o){if(a=c||f?{}:Zi(t),!l)return c?function(t,e){return ci(t,Ks(t),e)}(t,function(t,e){return t&&ci(e,Qr(e),t)}(a,t)):function(t,e){return ci(t,Ls(t),e)}(t,we(a,t))}else{if(!We[d])return o?t:{};a=function(t,e,n){var i=t.constructor;switch(e){case yt:return ii(t);case rt:case ot:return new i(+t);case bt:return function(t,e){return new t.constructor(e?ii(t.buffer):t.buffer,t.byteOffset,t.byteLength)}(t,n);case Ct:case It:case Et:case Tt:case wt:case xt:case _t:case Dt:case At:return ri(t,n);case ct:return new i;case ut:case gt:return new i(t);case ft:return function(t){var e=new t.constructor(t.source,Qt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case pt:return new i;case mt:return function(t){return Ts?bo(Ts.call(t)):{}}(t)}}(t,d,l)}}s||(s=new ge);var p=s.get(t);if(p)return p;s.set(t,a),Ma(t)?t.forEach(function(n){a.add(Ae(n,e,i,n,t,s))}):ka(t)&&t.forEach(function(n,r){a.set(r,Ae(n,e,i,r,t,s))});var g=h?F:(u?c?Bi:Ki:c?Qr:Jr)(t);return n(g||t,function(n,r){g&&(n=t[r=n]),Ie(a,r,Ae(n,e,i,r,t,s))}),a}function Oe(t,e,n){var i=n.length;if(null==t)return!i;for(t=bo(t);i--;){var r=n[i],o=e[r],s=t[r];if(s===F&&!(r in t)||!o(s))return!1}return!0}function Se(t,e,n){if("function"!=typeof t)throw new Eo(V);return Gs(function(){t.apply(F,n)},e)}function Re(t,e,n,i){var r=-1,o=s,c=!0,u=t.length,h=[],d=e.length;if(!u)return h;n&&(e=l(e,_(n))),i?(o=a,c=!1):e.length>=200&&(o=A,c=!1,e=new pe(e));t:for(;++r<u;){var f=t[r],p=null==n?f:n(f);if(f=i||0!==f?f:0,c&&p==p){for(var g=d;g--;)if(e[g]===p)continue t;h.push(f)}else o(e,p,i)||h.push(f)}return h}function ke(t,e){var n=!0;return _s(t,function(t,i,r){return n=!!e(t,i,r)}),n}function Ne(t,e,n){for(var i=-1,r=t.length;++i<r;){var o=t[i],s=e(o);if(null!=s&&(a===F?s==s&&!Fr(s):n(s,a)))var a=s,l=o}return l}function Me(t,e){var n=[];return _s(t,function(t,i,r){e(t,i,r)&&n.push(t)}),n}function Pe(t,e,n,i,r){var o=-1,s=t.length;for(n||(n=Wi),r||(r=[]);++o<s;){var a=t[o];e>0&&n(a)?e>1?Pe(a,e-1,n,i,r):c(r,a):i||(r[r.length]=a)}return r}function Le(t,e){return t&&As(t,e,Jr)}function Ke(t,e){return t&&Os(t,e,Jr)}function je(t,e){return o(e,function(e){return Mr(t[e])})}function Ge(t,e){for(var n=0,i=(e=ti(e,t)).length;null!=t&&n<i;)t=t[ar(e[n++])];return n&&n==i?t:F}function Fe(t,e,n){var i=e(t);return Aa(t)?i:c(i,n(t))}function Ve(t){return null==t?t===F?"[object Undefined]":"[object Null]":Uo&&Uo in bo(t)?function(t){var e=Ao.call(t,Uo),n=t[Uo];try{t[Uo]=F;var i=!0}catch(t){}var r=Ro.call(t);return i&&(e?t[Uo]=n:delete t[Uo]),r}(t):function(t){return Ro.call(t)}(t)}function $e(t,e){return t>e}function qe(t,e){return null!=t&&Ao.call(t,e)}function Je(t,e){return null!=t&&e in bo(t)}function tn(t,e,n){for(var i=n?a:s,r=t[0].length,o=t.length,c=o,u=po(o),h=1/0,d=[];c--;){var f=t[c];c&&e&&(f=l(f,_(e))),h=rs(f.length,h),u[c]=!n&&(e||r>=120&&f.length>=120)?new pe(c&&f):F}f=t[0];var p=-1,g=u[0];t:for(;++p<r&&d.length<h;){var m=f[p],v=e?e(m):m;if(m=n||0!==m?m:0,!(g?A(g,v):i(d,v,n))){for(c=o;--c;){var y=u[c];if(!(y?A(y,v):i(t[c],v,n)))continue t}g&&g.push(v),d.push(m)}}return d}function en(e,n,i){var r=null==(e=nr(e,n=ti(n,e)))?e:e[ar(gr(n))];return null==r?F:t(r,e,i)}function rn(t){return Br(t)&&Ve(t)==nt}function on(t,e,n,i,r){return t===e||(null==t||null==e||!Br(t)&&!Br(e)?t!=t&&e!=e:function(t,e,n,i,r,o){var s=Aa(t),a=Aa(e),l=s?it:Bs(t),c=a?it:Bs(e);l=l==nt?ht:l,c=c==nt?ht:c;var u=l==ht,h=c==ht,d=l==c;if(d&&Sa(t)){if(!Sa(e))return!1;s=!0,u=!1}if(d&&!u)return o||(o=new ge),s||Pa(t)?Pi(t,e,n,i,r,o):function(t,e,n,i,r,o,s){switch(n){case bt:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case yt:return!(t.byteLength!=e.byteLength||!o(new Ko(t),new Ko(e)));case rt:case ot:case ut:return Sr(+t,+e);case st:return t.name==e.name&&t.message==e.message;case ft:case gt:return t==e+"";case ct:var a=M;case pt:var l=1&i;if(a||(a=K),t.size!=e.size&&!l)return!1;var c=s.get(t);if(c)return c==e;i|=2,s.set(t,e);var u=Pi(a(t),a(e),i,r,o,s);return s.delete(t),u;case mt:if(Ts)return Ts.call(t)==Ts.call(e)}return!1}(t,e,l,n,i,r,o);if(!(1&n)){var f=u&&Ao.call(t,"__wrapped__"),p=h&&Ao.call(e,"__wrapped__");if(f||p){var g=f?t.value():t,m=p?e.value():e;return o||(o=new ge),r(g,m,n,i,o)}}return!!d&&(o||(o=new ge),function(t,e,n,i,r,o){var s=1&n,a=Ki(t),l=a.length;if(l!=Ki(e).length&&!s)return!1;for(var c=l;c--;){var u=a[c];if(!(s?u in e:Ao.call(e,u)))return!1}var h=o.get(t),d=o.get(e);if(h&&d)return h==e&&d==t;var f=!0;o.set(t,e),o.set(e,t);for(var p=s;++c<l;){var g=t[u=a[c]],m=e[u];if(i)var v=s?i(m,g,u,e,t,o):i(g,m,u,t,e,o);if(!(v===F?g===m||r(g,m,n,i,o):v)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var y=t.constructor,b=e.constructor;y!=b&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(f=!1)}return o.delete(t),o.delete(e),f}(t,e,n,i,r,o))}(t,e,n,i,on,r))}function dn(t,e,n,i){var r=n.length,o=r,s=!i;if(null==t)return!o;for(t=bo(t);r--;){var a=n[r];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<o;){var l=(a=n[r])[0],c=t[l],u=a[1];if(s&&a[2]){if(c===F&&!(l in t))return!1}else{var h=new ge;if(i)var d=i(c,u,l,t,e,h);if(!(d===F?on(u,c,3,i,h):d))return!1}}return!0}function vn(t){return!(!Kr(t)||function(t){return!!So&&So in t}(t))&&(Mr(t)?Mo:ne).test(lr(t))}function yn(t){return"function"==typeof t?t:null==t?so:"object"==typeof t?Aa(t)?wn(t[0],t[1]):Tn(t):uo(t)}function bn(t){if(!Ji(t))return ns(t);var e=[];for(var n in bo(t))Ao.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Cn(t){if(!Kr(t))return function(t){var e=[];if(null!=t)for(var n in bo(t))e.push(n);return e}(t);var e=Ji(t),n=[];for(var i in t)("constructor"!=i||!e&&Ao.call(t,i))&&n.push(i);return n}function In(t,e){return t<e}function En(t,e){var n=-1,i=Rr(t)?po(t.length):[];return _s(t,function(t,r,o){i[++n]=e(t,r,o)}),i}function Tn(t){var e=Vi(t);return 1==e.length&&e[0][2]?tr(e[0][0],e[0][1]):function(n){return n===t||dn(n,t,e)}}function wn(t,e){return Xi(t)&&Qi(e)?tr(ar(t),e):function(n){var i=Xr(n,t);return i===F&&i===e?qr(n,t):on(e,i,3)}}function xn(t,e,n,i,r){t!==e&&As(e,function(o,s){if(r||(r=new ge),Kr(o))!function(t,e,n,i,r,o,s){var a=ir(t,n),l=ir(e,n),c=s.get(l);if(c)return Ce(t,n,c),F;var u=o?o(a,l,n+"",t,e,s):F,h=u===F;if(h){var d=Aa(l),f=!d&&Sa(l),p=!d&&!f&&Pa(l);u=l,d||f||p?Aa(a)?u=a:kr(a)?u=li(a):f?(h=!1,u=ni(l,!0)):p?(h=!1,u=ri(l,!0)):u=[]:jr(l)||Da(l)?(u=a,Da(a)?u=$r(a):Kr(a)&&!Mr(a)||(u=Zi(l))):h=!1}h&&(s.set(l,u),r(u,l,i,o,s),s.delete(l)),Ce(t,n,u)}(t,e,s,n,xn,i,r);else{var a=i?i(ir(t,s),o,s+"",t,e,r):F;a===F&&(a=o),Ce(t,s,a)}},Qr)}function _n(t,e){var n=t.length;if(n)return $i(e+=e<0?n:0,n)?t[e]:F}function Dn(t,e,n){e=e.length?l(e,function(t){return Aa(t)?function(e){return Ge(e,1===t.length?t[0]:t)}:t}):[so];var i=-1;return e=l(e,_(Gi())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(En(t,function(t,n,r){return{criteria:l(e,function(e){return e(t)}),index:++i,value:t}}),function(t,e){return function(t,e,n){for(var i=-1,r=t.criteria,o=e.criteria,s=r.length,a=n.length;++i<s;){var l=oi(r[i],o[i]);if(l)return i>=a?l:l*("desc"==n[i]?-1:1)}return t.index-e.index}(t,e,n)})}function An(t,e,n){for(var i=-1,r=e.length,o={};++i<r;){var s=e[i],a=Ge(t,s);n(a,s)&&Ln(o,ti(s,t),a)}return o}function On(t,e,n,i){var r=i?v:m,o=-1,s=e.length,a=t;for(t===e&&(e=li(e)),n&&(a=l(t,_(n)));++o<s;)for(var c=0,u=e[o],h=n?n(u):u;(c=r(a,h,c,i))>-1;)a!==t&&Fo.call(a,c,1),Fo.call(t,c,1);return t}function Sn(t,e){for(var n=t?e.length:0,i=n-1;n--;){var r=e[n];if(n==i||r!==o){var o=r;$i(r)?Fo.call(t,r,1):Zn(t,r)}}return t}function Rn(t,e){return t+qo(as()*(e-t+1))}function kn(t,e){var n="";if(!t||e<1||e>J)return n;do{e%2&&(n+=t),(e=qo(e/2))&&(t+=t)}while(e);return n}function Nn(t,e){return Fs(er(t,e,so),t+"")}function Mn(t){return ve(eo(t))}function Pn(t,e){var n=eo(t);return sr(n,De(e,0,n.length))}function Ln(t,e,n,i){if(!Kr(t))return t;for(var r=-1,o=(e=ti(e,t)).length,s=o-1,a=t;null!=a&&++r<o;){var l=ar(e[r]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(r!=s){var u=a[l];(c=i?i(u,l,a):F)===F&&(c=Kr(u)?u:$i(e[r+1])?[]:{})}Ie(a,l,c),a=a[l]}return t}function Kn(t){return sr(eo(t))}function Bn(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),(n=n>r?r:n)<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var o=po(r);++i<r;)o[i]=t[i+e];return o}function zn(t,e){var n;return _s(t,function(t,i,r){return!(n=e(t,i,r))}),!!n}function jn(t,e,n){var i=0,r=null==t?i:t.length;if("number"==typeof e&&e==e&&r<=2147483647){for(;i<r;){var o=i+r>>>1,s=t[o];null!==s&&!Fr(s)&&(n?s<=e:s<e)?i=o+1:r=o}return r}return Gn(t,e,so,n)}function Gn(t,e,n,i){var r=0,o=null==t?0:t.length;if(0===o)return 0;for(var s=(e=n(e))!=e,a=null===e,l=Fr(e),c=e===F;r<o;){var u=qo((r+o)/2),h=n(t[u]),d=h!==F,f=null===h,p=h==h,g=Fr(h);if(s)var m=i||p;else m=c?p&&(i||d):a?p&&d&&(i||!f):l?p&&d&&!f&&(i||!g):!f&&!g&&(i?h<=e:h<e);m?r=u+1:o=u}return rs(o,4294967294)}function Fn(t,e){for(var n=-1,i=t.length,r=0,o=[];++n<i;){var s=t[n],a=e?e(s):s;if(!n||!Sr(a,l)){var l=a;o[r++]=0===s?0:s}}return o}function Vn(t){return"number"==typeof t?t:Fr(t)?Q:+t}function Hn(t){if("string"==typeof t)return t;if(Aa(t))return l(t,Hn)+"";if(Fr(t))return ws?ws.call(t):"";var e=t+"";return"0"==e&&1/t==-q?"-0":e}function Un(t,e,n){var i=-1,r=s,o=t.length,l=!0,c=[],u=c;if(n)l=!1,r=a;else if(o>=200){var h=e?null:Ms(t);if(h)return K(h);l=!1,r=A,u=new pe}else u=e?[]:c;t:for(;++i<o;){var d=t[i],f=e?e(d):d;if(d=n||0!==d?d:0,l&&f==f){for(var p=u.length;p--;)if(u[p]===f)continue t;e&&u.push(f),c.push(d)}else r(u,f,n)||(u!==c&&u.push(f),c.push(d))}return c}function Zn(t,e){return null==(t=nr(t,e=ti(e,t)))||delete t[ar(gr(e))]}function Wn(t,e,n,i){return Ln(t,e,n(Ge(t,e)),i)}function $n(t,e,n,i){for(var r=t.length,o=i?r:-1;(i?o--:++o<r)&&e(t[o],o,t););return n?Bn(t,i?0:o,i?o+1:r):Bn(t,i?o+1:0,i?r:o)}function Yn(t,e){var n=t;return n instanceof ue&&(n=n.value()),u(e,function(t,e){return e.func.apply(e.thisArg,c([t],e.args))},n)}function Xn(t,e,n){var i=t.length;if(i<2)return i?Un(t[0]):[];for(var r=-1,o=po(i);++r<i;)for(var s=t[r],a=-1;++a<i;)a!=r&&(o[r]=Re(o[r]||s,t[a],e,n));return Un(Pe(o,1),e,n)}function qn(t,e,n){for(var i=-1,r=t.length,o=e.length,s={};++i<r;)n(s,t[i],i<o?e[i]:F);return s}function Jn(t){return kr(t)?t:[]}function Qn(t){return"function"==typeof t?t:so}function ti(t,e){return Aa(t)?t:Xi(t,e)?[t]:Vs(Yr(t))}function ei(t,e,n){var i=t.length;return n=n===F?i:n,!e&&n>=i?t:Bn(t,e,n)}function ni(t,e){if(e)return t.slice();var n=t.length,i=Bo?Bo(n):new t.constructor(n);return t.copy(i),i}function ii(t){var e=new t.constructor(t.byteLength);return new Ko(e).set(new Ko(t)),e}function ri(t,e){return new t.constructor(e?ii(t.buffer):t.buffer,t.byteOffset,t.length)}function oi(t,e){if(t!==e){var n=t!==F,i=null===t,r=t==t,o=Fr(t),s=e!==F,a=null===e,l=e==e,c=Fr(e);if(!a&&!c&&!o&&t>e||o&&s&&l&&!a&&!c||i&&s&&l||!n&&l||!r)return 1;if(!i&&!o&&!c&&t<e||c&&n&&r&&!i&&!o||a&&n&&r||!s&&r||!l)return-1}return 0}function si(t,e,n,i){for(var r=-1,o=t.length,s=n.length,a=-1,l=e.length,c=is(o-s,0),u=po(l+c),h=!i;++a<l;)u[a]=e[a];for(;++r<s;)(h||r<o)&&(u[n[r]]=t[r]);for(;c--;)u[a++]=t[r++];return u}function ai(t,e,n,i){for(var r=-1,o=t.length,s=-1,a=n.length,l=-1,c=e.length,u=is(o-a,0),h=po(u+c),d=!i;++r<u;)h[r]=t[r];for(var f=r;++l<c;)h[f+l]=e[l];for(;++s<a;)(d||r<o)&&(h[f+n[s]]=t[r++]);return h}function li(t,e){var n=-1,i=t.length;for(e||(e=po(i));++n<i;)e[n]=t[n];return e}function ci(t,e,n,i){var r=!n;n||(n={});for(var o=-1,s=e.length;++o<s;){var a=e[o],l=i?i(n[a],t[a],a,n,t):F;l===F&&(l=t[a]),r?xe(n,a,l):Ie(n,a,l)}return n}function ui(t,n){return function(i,r){var o=Aa(i)?e:Te,s=n?n():{};return o(i,t,Gi(r,2),s)}}function hi(t){return Nn(function(e,n){var i=-1,r=n.length,o=r>1?n[r-1]:F,s=r>2?n[2]:F;for(o=t.length>3&&"function"==typeof o?(r--,o):F,s&&Yi(n[0],n[1],s)&&(o=r<3?F:o,r=1),e=bo(e);++i<r;){var a=n[i];a&&t(e,a,i,o)}return e})}function di(t,e){return function(n,i){if(null==n)return n;if(!Rr(n))return t(n,i);for(var r=n.length,o=e?r:-1,s=bo(n);(e?o--:++o<r)&&!1!==i(s[o],o,s););return n}}function fi(t){return function(e,n,i){for(var r=-1,o=bo(e),s=i(e),a=s.length;a--;){var l=s[t?a:++r];if(!1===n(o[l],l,o))break}return e}}function pi(t){return function(e){var n=k(e=Yr(e))?z(e):F,i=n?n[0]:e.charAt(0),r=n?ei(n,1).join(""):e.slice(1);return i[t]()+r}}function gi(t){return function(e){return u(ro(io(e).replace(Be,"")),t,"")}}function mi(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=xs(t.prototype),i=t.apply(n,e);return Kr(i)?i:n}}function vi(e,n,i){var r=mi(e);return function o(){for(var s=arguments.length,a=po(s),l=s,c=ji(o);l--;)a[l]=arguments[l];var u=s<3&&a[0]!==c&&a[s-1]!==c?[]:L(a,c);return(s-=u.length)<i?Ai(e,n,Ci,o.placeholder,F,a,u,F,F,i-s):t(this&&this!==Qe&&this instanceof o?r:e,this,a)}}function yi(t){return function(e,n,i){var r=bo(e);if(!Rr(e)){var o=Gi(n,3);e=Jr(e),n=function(t){return o(r[t],t,r)}}var s=t(e,n,i);return s>-1?r[o?e[s]:s]:F}}function bi(t){return Li(function(e){var n=e.length,i=n,r=ce.prototype.thru;for(t&&e.reverse();i--;){var o=e[i];if("function"!=typeof o)throw new Eo(V);if(r&&!s&&"wrapper"==zi(o))var s=new ce([],!0)}for(i=s?i:n;++i<n;){var a=zi(o=e[i]),l="wrapper"==a?Ps(o):F;s=l&&qi(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?s[zi(l[0])].apply(s,l[3]):1==o.length&&qi(o)?s[a]():s.thru(o)}return function(){var t=arguments,i=t[0];if(s&&1==t.length&&Aa(i))return s.plant(i).value();for(var r=0,o=n?e[r].apply(this,t):i;++r<n;)o=e[r].call(this,o);return o}})}function Ci(t,e,n,i,r,o,s,a,l,c){var u=e&Y,h=1&e,d=2&e,f=24&e,p=512&e,g=d?F:mi(t);return function m(){for(var v=arguments.length,y=po(v),b=v;b--;)y[b]=arguments[b];if(f)var C=ji(m),I=function(t,e){for(var n=t.length,i=0;n--;)t[n]===e&&++i;return i}(y,C);if(i&&(y=si(y,i,r,f)),o&&(y=ai(y,o,s,f)),v-=I,f&&v<c)return Ai(t,e,Ci,m.placeholder,n,y,L(y,C),a,l,c-v);var E=h?n:this,T=d?E[t]:t;return v=y.length,a?y=function(t,e){for(var n=t.length,i=rs(e.length,n),r=li(t);i--;){var o=e[i];t[i]=$i(o,n)?r[o]:F}return t}(y,a):p&&v>1&&y.reverse(),u&&l<v&&(y.length=l),this&&this!==Qe&&this instanceof m&&(T=g||mi(T)),T.apply(E,y)}}function Ii(t,e){return function(n,i){return function(t,e,n,i){return Le(t,function(t,r,o){e(i,n(t),r,o)}),i}(n,t,e(i),{})}}function Ei(t,e){return function(n,i){var r;if(n===F&&i===F)return e;if(n!==F&&(r=n),i!==F){if(r===F)return i;"string"==typeof n||"string"==typeof i?(n=Hn(n),i=Hn(i)):(n=Vn(n),i=Vn(i)),r=t(n,i)}return r}}function Ti(e){return Li(function(n){return n=l(n,_(Gi())),Nn(function(i){var r=this;return e(n,function(e){return t(e,r,i)})})})}function wi(t,e){var n=(e=e===F?" ":Hn(e)).length;if(n<2)return n?kn(e,t):e;var i=kn(e,Xo(t/B(e)));return k(e)?ei(z(i),0,t).join(""):i.slice(0,t)}function xi(e,n,i,r){var o=1&n,s=mi(e);return function n(){for(var a=-1,l=arguments.length,c=-1,u=r.length,h=po(u+l),d=this&&this!==Qe&&this instanceof n?s:e;++c<u;)h[c]=r[c];for(;l--;)h[c++]=arguments[++a];return t(d,o?i:this,h)}}function _i(t){return function(e,n,i){return i&&"number"!=typeof i&&Yi(e,n,i)&&(n=i=F),e=Hr(e),n===F?(n=e,e=0):n=Hr(n),function(t,e,n,i){for(var r=-1,o=is(Xo((e-t)/(n||1)),0),s=po(o);o--;)s[i?o:++r]=t,t+=n;return s}(e,n,i=i===F?e<n?1:-1:Hr(i),t)}}function Di(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=Wr(e),n=Wr(n)),t(e,n)}}function Ai(t,e,n,i,r,o,s,a,l,c){var u=8&e;e|=u?W:$,4&(e&=~(u?$:W))||(e&=-4);var h=[t,e,r,u?o:F,u?s:F,u?F:o,u?F:s,a,l,c],d=n.apply(F,h);return qi(t)&&js(d,h),d.placeholder=i,rr(d,t,e)}function Oi(t){var e=yo[t];return function(t,n){if(t=Wr(t),(n=null==n?0:rs(Ur(n),292))&&ts(t)){var i=(Yr(t)+"e").split("e");return+((i=(Yr(e(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return e(t)}}function Si(t){return function(e){var n=Bs(e);return n==ct?M(e):n==pt?function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}(e):function(t,e){return l(e,function(e){return[e,t[e]]})}(e,t(e))}}function Ri(t,e,n,i,r,o,s,a){var l=2&e;if(!l&&"function"!=typeof t)throw new Eo(V);var c=i?i.length:0;if(c||(e&=-97,i=r=F),s=s===F?s:is(Ur(s),0),a=a===F?a:Ur(a),c-=r?r.length:0,e&$){var u=i,h=r;i=r=F}var d=l?F:Ps(t),f=[t,e,n,i,r,u,h,o,s,a];if(d&&function(t,e){var n=t[1],i=e[1],r=n|i,o=r<131,s=i==Y&&8==n||i==Y&&n==X&&t[7].length<=e[8]||384==i&&e[7].length<=e[8]&&8==n;if(!o&&!s)return t;1&i&&(t[2]=e[2],r|=1&n?0:4);var a=e[3];if(a){var l=t[3];t[3]=l?si(l,a,e[4]):a,t[4]=l?L(t[3],U):e[4]}a=e[5],a&&(l=t[5],t[5]=l?ai(l,a,e[6]):a,t[6]=l?L(t[5],U):e[6]),a=e[7],a&&(t[7]=a),i&Y&&(t[8]=null==t[8]?e[8]:rs(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=r}(f,d),t=f[0],e=f[1],n=f[2],i=f[3],r=f[4],!(a=f[9]=f[9]===F?l?0:t.length:is(f[9]-c,0))&&24&e&&(e&=-25),e&&1!=e)p=8==e||e==Z?vi(t,e,a):e!=W&&33!=e||r.length?Ci.apply(F,f):xi(t,e,n,i);else var p=function(t,e,n){var i=1&e,r=mi(t);return function e(){return(this&&this!==Qe&&this instanceof e?r:t).apply(i?n:this,arguments)}}(t,e,n);return rr((d?Ss:js)(p,f),t,e)}function ki(t,e,n,i){return t===F||Sr(t,xo[n])&&!Ao.call(i,n)?e:t}function Ni(t,e,n,i,r,o){return Kr(t)&&Kr(e)&&(o.set(e,t),xn(t,e,F,Ni,o),o.delete(e)),t}function Mi(t){return jr(t)?F:t}function Pi(t,e,n,i,r,o){var s=1&n,a=t.length,l=e.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(t),u=o.get(e);if(c&&u)return c==e&&u==t;var h=-1,f=!0,p=2&n?new pe:F;for(o.set(t,e),o.set(e,t);++h<a;){var g=t[h],m=e[h];if(i)var v=s?i(m,g,h,e,t,o):i(g,m,h,t,e,o);if(v!==F){if(v)continue;f=!1;break}if(p){if(!d(e,function(t,e){if(!A(p,e)&&(g===t||r(g,t,n,i,o)))return p.push(e)})){f=!1;break}}else if(g!==m&&!r(g,m,n,i,o)){f=!1;break}}return o.delete(t),o.delete(e),f}function Li(t){return Fs(er(t,F,fr),t+"")}function Ki(t){return Fe(t,Jr,Ls)}function Bi(t){return Fe(t,Qr,Ks)}function zi(t){for(var e=t.name+"",n=ms[e],i=Ao.call(ms,e)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==t)return r.name}return e}function ji(t){return(Ao.call(Yt,"placeholder")?Yt:t).placeholder}function Gi(){var t=Yt.iteratee||ao;return t=t===ao?yn:t,arguments.length?t(arguments[0],arguments[1]):t}function Fi(t,e){var n=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?n["string"==typeof e?"string":"hash"]:n.map}function Vi(t){for(var e=Jr(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,Qi(r)]}return e}function Hi(t,e){var n=function(t,e){return null==t?F:t[e]}(t,e);return vn(n)?n:F}function Ui(t,e,n){for(var i=-1,r=(e=ti(e,t)).length,o=!1;++i<r;){var s=ar(e[i]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++i!=r?o:!!(r=null==t?0:t.length)&&Lr(r)&&$i(s,r)&&(Aa(t)||Da(t))}function Zi(t){return"function"!=typeof t.constructor||Ji(t)?{}:xs(zo(t))}function Wi(t){return Aa(t)||Da(t)||!!(Vo&&t&&t[Vo])}function $i(t,e){var n=typeof t;return!!(e=null==e?J:e)&&("number"==n||"symbol"!=n&&re.test(t))&&t>-1&&t%1==0&&t<e}function Yi(t,e,n){if(!Kr(n))return!1;var i=typeof e;return!!("number"==i?Rr(n)&&$i(e,n.length):"string"==i&&e in n)&&Sr(n[e],t)}function Xi(t,e){if(Aa(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Fr(t))||jt.test(t)||!zt.test(t)||null!=e&&t in bo(e)}function qi(t){var e=zi(t),n=Yt[e];if("function"!=typeof n||!(e in ue.prototype))return!1;if(t===n)return!0;var i=Ps(n);return!!i&&t===i[0]}function Ji(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||xo)}function Qi(t){return t==t&&!Kr(t)}function tr(t,e){return function(n){return null!=n&&n[t]===e&&(e!==F||t in bo(n))}}function er(e,n,i){return n=is(n===F?e.length-1:n,0),function(){for(var r=arguments,o=-1,s=is(r.length-n,0),a=po(s);++o<s;)a[o]=r[n+o];o=-1;for(var l=po(n+1);++o<n;)l[o]=r[o];return l[n]=i(a),t(e,this,l)}}function nr(t,e){return e.length<2?t:Ge(t,Bn(e,0,-1))}function ir(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}function rr(t,e,n){var i=e+"";return Fs(t,function(t,e){var n=e.length;if(!n)return t;var i=n-1;return e[i]=(n>1?"& ":"")+e[i],e=e.join(n>2?", ":" "),t.replace(Zt,"{\n/* [wrapped with "+e+"] */\n")}(i,cr(function(t){var e=t.match(Wt);return e?e[1].split($t):[]}(i),n)))}function or(t){var e=0,n=0;return function(){var i=os(),r=16-(i-n);if(n=i,r>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(F,arguments)}}function sr(t,e){var n=-1,i=t.length,r=i-1;for(e=e===F?i:e;++n<e;){var o=Rn(n,r),s=t[o];t[o]=t[n],t[n]=s}return t.length=e,t}function ar(t){if("string"==typeof t||Fr(t))return t;var e=t+"";return"0"==e&&1/t==-q?"-0":e}function lr(t){if(null!=t){try{return Do.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function cr(t,e){return n(et,function(n){var i="_."+n[0];e&n[1]&&!s(t,i)&&t.push(i)}),t.sort()}function ur(t){if(t instanceof ue)return t.clone();var e=new ce(t.__wrapped__,t.__chain__);return e.__actions__=li(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function hr(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:Ur(n);return r<0&&(r=is(i+r,0)),g(t,Gi(e,3),r)}function dr(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=i-1;return n!==F&&(r=Ur(n),r=n<0?is(i+r,0):rs(r,i-1)),g(t,Gi(e,3),r,!0)}function fr(t){return null!=t&&t.length?Pe(t,1):[]}function pr(t){return t&&t.length?t[0]:F}function gr(t){var e=null==t?0:t.length;return e?t[e-1]:F}function mr(t,e){return t&&t.length&&e&&e.length?On(t,e):t}function vr(t){return null==t?t:ls.call(t)}function yr(t){if(!t||!t.length)return[];var e=0;return t=o(t,function(t){if(kr(t))return e=is(t.length,e),!0}),w(e,function(e){return l(t,C(e))})}function br(e,n){if(!e||!e.length)return[];var i=yr(e);return null==n?i:l(i,function(e){return t(n,F,e)})}function Cr(t){var e=Yt(t);return e.__chain__=!0,e}function Ir(t,e){return e(t)}function Er(t,e){return(Aa(t)?n:_s)(t,Gi(e,3))}function Tr(t,e){return(Aa(t)?i:Ds)(t,Gi(e,3))}function wr(t,e){return(Aa(t)?l:En)(t,Gi(e,3))}function xr(t,e,n){return e=n?F:e,e=t&&null==e?t.length:e,Ri(t,Y,F,F,F,F,e)}function _r(t,e){var n;if("function"!=typeof e)throw new Eo(V);return t=Ur(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=F),n}}function Dr(t,e,n){function i(e){var n=l,i=c;return l=c=F,p=e,h=t.apply(i,n)}function r(t){var n=t-f;return f===F||n>=e||n<0||m&&t-p>=u}function o(){var t=ma();return r(t)?s(t):(d=Gs(o,function(t){var n=e-(t-f);return m?rs(n,u-(t-p)):n}(t)),F)}function s(t){return d=F,v&&l?i(t):(l=c=F,h)}function a(){var t=ma(),n=r(t);if(l=arguments,c=this,f=t,n){if(d===F)return function(t){return p=t,d=Gs(o,e),g?i(t):h}(f);if(m)return Ns(d),d=Gs(o,e),i(f)}return d===F&&(d=Gs(o,e)),h}var l,c,u,h,d,f,p=0,g=!1,m=!1,v=!0;if("function"!=typeof t)throw new Eo(V);return e=Wr(e)||0,Kr(n)&&(g=!!n.leading,u=(m="maxWait"in n)?is(Wr(n.maxWait)||0,e):u,v="trailing"in n?!!n.trailing:v),a.cancel=function(){d!==F&&Ns(d),p=0,l=f=c=d=F},a.flush=function(){return d===F?h:s(ma())},a}function Ar(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Eo(V);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var s=t.apply(this,i);return n.cache=o.set(r,s)||o,s};return n.cache=new(Ar.Cache||fe),n}function Or(t){if("function"!=typeof t)throw new Eo(V);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Sr(t,e){return t===e||t!=t&&e!=e}function Rr(t){return null!=t&&Lr(t.length)&&!Mr(t)}function kr(t){return Br(t)&&Rr(t)}function Nr(t){if(!Br(t))return!1;var e=Ve(t);return e==st||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!jr(t)}function Mr(t){if(!Kr(t))return!1;var e=Ve(t);return e==at||e==lt||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Pr(t){return"number"==typeof t&&t==Ur(t)}function Lr(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=J}function Kr(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Br(t){return null!=t&&"object"==typeof t}function zr(t){return"number"==typeof t||Br(t)&&Ve(t)==ut}function jr(t){if(!Br(t)||Ve(t)!=ht)return!1;var e=zo(t);if(null===e)return!0;var n=Ao.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Do.call(n)==ko}function Gr(t){return"string"==typeof t||!Aa(t)&&Br(t)&&Ve(t)==gt}function Fr(t){return"symbol"==typeof t||Br(t)&&Ve(t)==mt}function Vr(t){if(!t)return[];if(Rr(t))return Gr(t)?z(t):li(t);if(Ho&&t[Ho])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Ho]());var e=Bs(t);return(e==ct?M:e==pt?K:eo)(t)}function Hr(t){return t?(t=Wr(t))===q||t===-q?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function Ur(t){var e=Hr(t),n=e%1;return e==e?n?e-n:e:0}function Zr(t){return t?De(Ur(t),0,tt):0}function Wr(t){if("number"==typeof t)return t;if(Fr(t))return Q;if(Kr(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Kr(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=x(t);var n=ee.test(t);return n||ie.test(t)?Xe(t.slice(2),n?2:8):te.test(t)?Q:+t}function $r(t){return ci(t,Qr(t))}function Yr(t){return null==t?"":Hn(t)}function Xr(t,e,n){var i=null==t?F:Ge(t,e);return i===F?n:i}function qr(t,e){return null!=t&&Ui(t,e,Je)}function Jr(t){return Rr(t)?me(t):bn(t)}function Qr(t){return Rr(t)?me(t,!0):Cn(t)}function to(t,e){if(null==t)return{};var n=l(Bi(t),function(t){return[t]});return e=Gi(e),An(t,n,function(t,n){return e(t,n[0])})}function eo(t){return null==t?[]:D(t,Jr(t))}function no(t){return al(Yr(t).toLowerCase())}function io(t){return(t=Yr(t))&&t.replace(oe,fn).replace(ze,"")}function ro(t,e,n){return t=Yr(t),(e=n?F:e)===F?N(t)?G(t):f(t):t.match(e)||[]}function oo(t){return function(){return t}}function so(t){return t}function ao(t){return yn("function"==typeof t?t:Ae(t,1))}function lo(t,e,i){var r=Jr(e),o=je(e,r);null!=i||Kr(e)&&(o.length||!r.length)||(i=e,e=t,t=this,o=je(e,Jr(e)));var s=!(Kr(i)&&"chain"in i&&!i.chain),a=Mr(t);return n(o,function(n){var i=e[n];t[n]=i,a&&(t.prototype[n]=function(){var e=this.__chain__;if(s||e){var n=t(this.__wrapped__);return(n.__actions__=li(this.__actions__)).push({func:i,args:arguments,thisArg:t}),n.__chain__=e,n}return i.apply(t,c([this.value()],arguments))})}),t}function co(){}function uo(t){return Xi(t)?C(ar(t)):function(t){return function(e){return Ge(e,t)}}(t)}function ho(){return[]}function fo(){return!1}var po=(Ut=null==Ut?Qe:mn.defaults(Qe.Object(),Ut,mn.pick(Qe,He))).Array,go=Ut.Date,mo=Ut.Error,vo=Ut.Function,yo=Ut.Math,bo=Ut.Object,Co=Ut.RegExp,Io=Ut.String,Eo=Ut.TypeError,To=po.prototype,wo=vo.prototype,xo=bo.prototype,_o=Ut["__core-js_shared__"],Do=wo.toString,Ao=xo.hasOwnProperty,Oo=0,So=function(){var t=/[^.]+$/.exec(_o&&_o.keys&&_o.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Ro=xo.toString,ko=Do.call(bo),No=Qe._,Mo=Co("^"+Do.call(Ao).replace(Ft,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Po=nn?Ut.Buffer:F,Lo=Ut.Symbol,Ko=Ut.Uint8Array,Bo=Po?Po.allocUnsafe:F,zo=P(bo.getPrototypeOf,bo),jo=bo.create,Go=xo.propertyIsEnumerable,Fo=To.splice,Vo=Lo?Lo.isConcatSpreadable:F,Ho=Lo?Lo.iterator:F,Uo=Lo?Lo.toStringTag:F,Zo=function(){try{var t=Hi(bo,"defineProperty");return t({},"",{}),t}catch(t){}}(),Wo=Ut.clearTimeout!==Qe.clearTimeout&&Ut.clearTimeout,$o=go&&go.now!==Qe.Date.now&&go.now,Yo=Ut.setTimeout!==Qe.setTimeout&&Ut.setTimeout,Xo=yo.ceil,qo=yo.floor,Jo=bo.getOwnPropertySymbols,Qo=Po?Po.isBuffer:F,ts=Ut.isFinite,es=To.join,ns=P(bo.keys,bo),is=yo.max,rs=yo.min,os=go.now,ss=Ut.parseInt,as=yo.random,ls=To.reverse,cs=Hi(Ut,"DataView"),us=Hi(Ut,"Map"),hs=Hi(Ut,"Promise"),ds=Hi(Ut,"Set"),fs=Hi(Ut,"WeakMap"),ps=Hi(bo,"create"),gs=fs&&new fs,ms={},vs=lr(cs),ys=lr(us),bs=lr(hs),Cs=lr(ds),Is=lr(fs),Es=Lo?Lo.prototype:F,Ts=Es?Es.valueOf:F,ws=Es?Es.toString:F,xs=function(){function t(){}return function(e){if(!Kr(e))return{};if(jo)return jo(e);t.prototype=e;var n=new t;return t.prototype=F,n}}();Yt.templateSettings={escape:Lt,evaluate:Kt,interpolate:Bt,variable:"",imports:{_:Yt}},Yt.prototype=le.prototype,Yt.prototype.constructor=Yt,ce.prototype=xs(le.prototype),ce.prototype.constructor=ce,ue.prototype=xs(le.prototype),ue.prototype.constructor=ue,he.prototype.clear=function(){this.__data__=ps?ps(null):{},this.size=0},he.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},he.prototype.get=function(t){var e=this.__data__;if(ps){var n=e[t];return n===H?F:n}return Ao.call(e,t)?e[t]:F},he.prototype.has=function(t){var e=this.__data__;return ps?e[t]!==F:Ao.call(e,t)},he.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=ps&&e===F?H:e,this},de.prototype.clear=function(){this.__data__=[],this.size=0},de.prototype.delete=function(t){var e=this.__data__,n=Ee(e,t);return!(n<0||(n==e.length-1?e.pop():Fo.call(e,n,1),--this.size,0))},de.prototype.get=function(t){var e=this.__data__,n=Ee(e,t);return n<0?F:e[n][1]},de.prototype.has=function(t){return Ee(this.__data__,t)>-1},de.prototype.set=function(t,e){var n=this.__data__,i=Ee(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},fe.prototype.clear=function(){this.size=0,this.__data__={hash:new he,map:new(us||de),string:new he}},fe.prototype.delete=function(t){var e=Fi(this,t).delete(t);return this.size-=e?1:0,e},fe.prototype.get=function(t){return Fi(this,t).get(t)},fe.prototype.has=function(t){return Fi(this,t).has(t)},fe.prototype.set=function(t,e){var n=Fi(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},pe.prototype.add=pe.prototype.push=function(t){return this.__data__.set(t,H),this},pe.prototype.has=function(t){return this.__data__.has(t)},ge.prototype.clear=function(){this.__data__=new de,this.size=0},ge.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},ge.prototype.get=function(t){return this.__data__.get(t)},ge.prototype.has=function(t){return this.__data__.has(t)},ge.prototype.set=function(t,e){var n=this.__data__;if(n instanceof de){var i=n.__data__;if(!us||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new fe(i)}return n.set(t,e),this.size=n.size,this};var _s=di(Le),Ds=di(Ke,!0),As=fi(),Os=fi(!0),Ss=gs?function(t,e){return gs.set(t,e),t}:so,Rs=Zo?function(t,e){return Zo(t,"toString",{configurable:!0,enumerable:!1,value:oo(e),writable:!0})}:so,ks=Nn,Ns=Wo||function(t){return Qe.clearTimeout(t)},Ms=ds&&1/K(new ds([,-0]))[1]==q?function(t){return new ds(t)}:co,Ps=gs?function(t){return gs.get(t)}:co,Ls=Jo?function(t){return null==t?[]:(t=bo(t),o(Jo(t),function(e){return Go.call(t,e)}))}:ho,Ks=Jo?function(t){for(var e=[];t;)c(e,Ls(t)),t=zo(t);return e}:ho,Bs=Ve;(cs&&Bs(new cs(new ArrayBuffer(1)))!=bt||us&&Bs(new us)!=ct||hs&&Bs(hs.resolve())!=dt||ds&&Bs(new ds)!=pt||fs&&Bs(new fs)!=vt)&&(Bs=function(t){var e=Ve(t),n=e==ht?t.constructor:F,i=n?lr(n):"";if(i)switch(i){case vs:return bt;case ys:return ct;case bs:return dt;case Cs:return pt;case Is:return vt}return e});var zs=_o?Mr:fo,js=or(Ss),Gs=Yo||function(t,e){return Qe.setTimeout(t,e)},Fs=or(Rs),Vs=function(t){var e=Ar(t,function(t){return 500===n.size&&n.clear(),t}),n=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Gt,function(t,n,i,r){e.push(i?r.replace(qt,"$1"):n||t)}),e}),Hs=Nn(function(t,e){return kr(t)?Re(t,Pe(e,1,kr,!0)):[]}),Us=Nn(function(t,e){var n=gr(e);return kr(n)&&(n=F),kr(t)?Re(t,Pe(e,1,kr,!0),Gi(n,2)):[]}),Zs=Nn(function(t,e){var n=gr(e);return kr(n)&&(n=F),kr(t)?Re(t,Pe(e,1,kr,!0),F,n):[]}),Ws=Nn(function(t){var e=l(t,Jn);return e.length&&e[0]===t[0]?tn(e):[]}),$s=Nn(function(t){var e=gr(t),n=l(t,Jn);return e===gr(n)?e=F:n.pop(),n.length&&n[0]===t[0]?tn(n,Gi(e,2)):[]}),Ys=Nn(function(t){var e=gr(t),n=l(t,Jn);return(e="function"==typeof e?e:F)&&n.pop(),n.length&&n[0]===t[0]?tn(n,F,e):[]}),Xs=Nn(mr),qs=Li(function(t,e){var n=null==t?0:t.length,i=_e(t,e);return Sn(t,l(e,function(t){return $i(t,n)?+t:t}).sort(oi)),i}),Js=Nn(function(t){return Un(Pe(t,1,kr,!0))}),Qs=Nn(function(t){var e=gr(t);return kr(e)&&(e=F),Un(Pe(t,1,kr,!0),Gi(e,2))}),ta=Nn(function(t){var e=gr(t);return e="function"==typeof e?e:F,Un(Pe(t,1,kr,!0),F,e)}),ea=Nn(function(t,e){return kr(t)?Re(t,e):[]}),na=Nn(function(t){return Xn(o(t,kr))}),ia=Nn(function(t){var e=gr(t);return kr(e)&&(e=F),Xn(o(t,kr),Gi(e,2))}),ra=Nn(function(t){var e=gr(t);return e="function"==typeof e?e:F,Xn(o(t,kr),F,e)}),oa=Nn(yr),sa=Nn(function(t){var e=t.length,n=e>1?t[e-1]:F;return n="function"==typeof n?(t.pop(),n):F,br(t,n)}),aa=Li(function(t){var e=t.length,n=e?t[0]:0,i=this.__wrapped__,r=function(e){return _e(e,t)};return!(e>1||this.__actions__.length)&&i instanceof ue&&$i(n)?((i=i.slice(n,+n+(e?1:0))).__actions__.push({func:Ir,args:[r],thisArg:F}),new ce(i,this.__chain__).thru(function(t){return e&&!t.length&&t.push(F),t})):this.thru(r)}),la=ui(function(t,e,n){Ao.call(t,n)?++t[n]:xe(t,n,1)}),ca=yi(hr),ua=yi(dr),ha=ui(function(t,e,n){Ao.call(t,n)?t[n].push(e):xe(t,n,[e])}),da=Nn(function(e,n,i){var r=-1,o="function"==typeof n,s=Rr(e)?po(e.length):[];return _s(e,function(e){s[++r]=o?t(n,e,i):en(e,n,i)}),s}),fa=ui(function(t,e,n){xe(t,n,e)}),pa=ui(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),ga=Nn(function(t,e){if(null==t)return[];var n=e.length;return n>1&&Yi(t,e[0],e[1])?e=[]:n>2&&Yi(e[0],e[1],e[2])&&(e=[e[0]]),Dn(t,Pe(e,1),[])}),ma=$o||function(){return Qe.Date.now()},va=Nn(function(t,e,n){var i=1;if(n.length){var r=L(n,ji(va));i|=W}return Ri(t,i,e,n,r)}),ya=Nn(function(t,e,n){var i=3;if(n.length){var r=L(n,ji(ya));i|=W}return Ri(e,i,t,n,r)}),ba=Nn(function(t,e){return Se(t,1,e)}),Ca=Nn(function(t,e,n){return Se(t,Wr(e)||0,n)});Ar.Cache=fe;var Ia=ks(function(e,n){var i=(n=1==n.length&&Aa(n[0])?l(n[0],_(Gi())):l(Pe(n,1),_(Gi()))).length;return Nn(function(r){for(var o=-1,s=rs(r.length,i);++o<s;)r[o]=n[o].call(this,r[o]);return t(e,this,r)})}),Ea=Nn(function(t,e){return Ri(t,W,F,e,L(e,ji(Ea)))}),Ta=Nn(function(t,e){return Ri(t,$,F,e,L(e,ji(Ta)))}),wa=Li(function(t,e){return Ri(t,X,F,F,F,e)}),xa=Di($e),_a=Di(function(t,e){return t>=e}),Da=rn(function(){return arguments}())?rn:function(t){return Br(t)&&Ao.call(t,"callee")&&!Go.call(t,"callee")},Aa=po.isArray,Oa=sn?_(sn):function(t){return Br(t)&&Ve(t)==yt},Sa=Qo||fo,Ra=an?_(an):function(t){return Br(t)&&Ve(t)==ot},ka=ln?_(ln):function(t){return Br(t)&&Bs(t)==ct},Na=cn?_(cn):function(t){return Br(t)&&Ve(t)==ft},Ma=un?_(un):function(t){return Br(t)&&Bs(t)==pt},Pa=hn?_(hn):function(t){return Br(t)&&Lr(t.length)&&!!Ze[Ve(t)]},La=Di(In),Ka=Di(function(t,e){return t<=e}),Ba=hi(function(t,e){if(Ji(e)||Rr(e))return ci(e,Jr(e),t),F;for(var n in e)Ao.call(e,n)&&Ie(t,n,e[n])}),za=hi(function(t,e){ci(e,Qr(e),t)}),ja=hi(function(t,e,n,i){ci(e,Qr(e),t,i)}),Ga=hi(function(t,e,n,i){ci(e,Jr(e),t,i)}),Fa=Li(_e),Va=Nn(function(t,e){t=bo(t);var n=-1,i=e.length,r=i>2?e[2]:F;for(r&&Yi(e[0],e[1],r)&&(i=1);++n<i;)for(var o=e[n],s=Qr(o),a=-1,l=s.length;++a<l;){var c=s[a],u=t[c];(u===F||Sr(u,xo[c])&&!Ao.call(t,c))&&(t[c]=o[c])}return t}),Ha=Nn(function(e){return e.push(F,Ni),t(Ya,F,e)}),Ua=Ii(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Ro.call(e)),t[e]=n},oo(so)),Za=Ii(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Ro.call(e)),Ao.call(t,e)?t[e].push(n):t[e]=[n]},Gi),Wa=Nn(en),$a=hi(function(t,e,n){xn(t,e,n)}),Ya=hi(function(t,e,n,i){xn(t,e,n,i)}),Xa=Li(function(t,e){var n={};if(null==t)return n;var i=!1;e=l(e,function(e){return e=ti(e,t),i||(i=e.length>1),e}),ci(t,Bi(t),n),i&&(n=Ae(n,7,Mi));for(var r=e.length;r--;)Zn(n,e[r]);return n}),qa=Li(function(t,e){return null==t?{}:function(t,e){return An(t,e,function(e,n){return qr(t,n)})}(t,e)}),Ja=Si(Jr),Qa=Si(Qr),tl=gi(function(t,e,n){return e=e.toLowerCase(),t+(n?no(e):e)}),el=gi(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),nl=gi(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),il=pi("toLowerCase"),rl=gi(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),ol=gi(function(t,e,n){return t+(n?" ":"")+al(e)}),sl=gi(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),al=pi("toUpperCase"),ll=Nn(function(e,n){try{return t(e,F,n)}catch(t){return Nr(t)?t:new mo(t)}}),cl=Li(function(t,e){return n(e,function(e){e=ar(e),xe(t,e,va(t[e],t))}),t}),ul=bi(),hl=bi(!0),dl=Nn(function(t,e){return function(n){return en(n,t,e)}}),fl=Nn(function(t,e){return function(n){return en(t,n,e)}}),pl=Ti(l),gl=Ti(r),ml=Ti(d),vl=_i(),yl=_i(!0),bl=Ei(function(t,e){return t+e},0),Cl=Oi("ceil"),Il=Ei(function(t,e){return t/e},1),El=Oi("floor"),Tl=Ei(function(t,e){return t*e},1),wl=Oi("round"),xl=Ei(function(t,e){return t-e},0);return Yt.after=function(t,e){if("function"!=typeof e)throw new Eo(V);return t=Ur(t),function(){if(--t<1)return e.apply(this,arguments)}},Yt.ary=xr,Yt.assign=Ba,Yt.assignIn=za,Yt.assignInWith=ja,Yt.assignWith=Ga,Yt.at=Fa,Yt.before=_r,Yt.bind=va,Yt.bindAll=cl,Yt.bindKey=ya,Yt.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Aa(t)?t:[t]},Yt.chain=Cr,Yt.chunk=function(t,e,n){e=(n?Yi(t,e,n):e===F)?1:is(Ur(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var r=0,o=0,s=po(Xo(i/e));r<i;)s[o++]=Bn(t,r,r+=e);return s},Yt.compact=function(t){for(var e=-1,n=null==t?0:t.length,i=0,r=[];++e<n;){var o=t[e];o&&(r[i++]=o)}return r},Yt.concat=function(){var t=arguments.length;if(!t)return[];for(var e=po(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return c(Aa(n)?li(n):[n],Pe(e,1))},Yt.cond=function(e){var n=null==e?0:e.length,i=Gi();return e=n?l(e,function(t){if("function"!=typeof t[1])throw new Eo(V);return[i(t[0]),t[1]]}):[],Nn(function(i){for(var r=-1;++r<n;){var o=e[r];if(t(o[0],this,i))return t(o[1],this,i)}})},Yt.conforms=function(t){return function(t){var e=Jr(t);return function(n){return Oe(n,t,e)}}(Ae(t,1))},Yt.constant=oo,Yt.countBy=la,Yt.create=function(t,e){var n=xs(t);return null==e?n:we(n,e)},Yt.curry=function t(e,n,i){var r=Ri(e,8,F,F,F,F,F,n=i?F:n);return r.placeholder=t.placeholder,r},Yt.curryRight=function t(e,n,i){var r=Ri(e,Z,F,F,F,F,F,n=i?F:n);return r.placeholder=t.placeholder,r},Yt.debounce=Dr,Yt.defaults=Va,Yt.defaultsDeep=Ha,Yt.defer=ba,Yt.delay=Ca,Yt.difference=Hs,Yt.differenceBy=Us,Yt.differenceWith=Zs,Yt.drop=function(t,e,n){var i=null==t?0:t.length;return i?Bn(t,(e=n||e===F?1:Ur(e))<0?0:e,i):[]},Yt.dropRight=function(t,e,n){var i=null==t?0:t.length;return i?Bn(t,0,(e=i-(e=n||e===F?1:Ur(e)))<0?0:e):[]},Yt.dropRightWhile=function(t,e){return t&&t.length?$n(t,Gi(e,3),!0,!0):[]},Yt.dropWhile=function(t,e){return t&&t.length?$n(t,Gi(e,3),!0):[]},Yt.fill=function(t,e,n,i){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&Yi(t,e,n)&&(n=0,i=r),function(t,e,n,i){var r=t.length;for((n=Ur(n))<0&&(n=-n>r?0:r+n),(i=i===F||i>r?r:Ur(i))<0&&(i+=r),i=n>i?0:Zr(i);n<i;)t[n++]=e;return t}(t,e,n,i)):[]},Yt.filter=function(t,e){return(Aa(t)?o:Me)(t,Gi(e,3))},Yt.flatMap=function(t,e){return Pe(wr(t,e),1)},Yt.flatMapDeep=function(t,e){return Pe(wr(t,e),q)},Yt.flatMapDepth=function(t,e,n){return n=n===F?1:Ur(n),Pe(wr(t,e),n)},Yt.flatten=fr,Yt.flattenDeep=function(t){return null!=t&&t.length?Pe(t,q):[]},Yt.flattenDepth=function(t,e){return null!=t&&t.length?Pe(t,e=e===F?1:Ur(e)):[]},Yt.flip=function(t){return Ri(t,512)},Yt.flow=ul,Yt.flowRight=hl,Yt.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,i={};++e<n;){var r=t[e];i[r[0]]=r[1]}return i},Yt.functions=function(t){return null==t?[]:je(t,Jr(t))},Yt.functionsIn=function(t){return null==t?[]:je(t,Qr(t))},Yt.groupBy=ha,Yt.initial=function(t){return null!=t&&t.length?Bn(t,0,-1):[]},Yt.intersection=Ws,Yt.intersectionBy=$s,Yt.intersectionWith=Ys,Yt.invert=Ua,Yt.invertBy=Za,Yt.invokeMap=da,Yt.iteratee=ao,Yt.keyBy=fa,Yt.keys=Jr,Yt.keysIn=Qr,Yt.map=wr,Yt.mapKeys=function(t,e){var n={};return e=Gi(e,3),Le(t,function(t,i,r){xe(n,e(t,i,r),t)}),n},Yt.mapValues=function(t,e){var n={};return e=Gi(e,3),Le(t,function(t,i,r){xe(n,i,e(t,i,r))}),n},Yt.matches=function(t){return Tn(Ae(t,1))},Yt.matchesProperty=function(t,e){return wn(t,Ae(e,1))},Yt.memoize=Ar,Yt.merge=$a,Yt.mergeWith=Ya,Yt.method=dl,Yt.methodOf=fl,Yt.mixin=lo,Yt.negate=Or,Yt.nthArg=function(t){return t=Ur(t),Nn(function(e){return _n(e,t)})},Yt.omit=Xa,Yt.omitBy=function(t,e){return to(t,Or(Gi(e)))},Yt.once=function(t){return _r(2,t)},Yt.orderBy=function(t,e,n,i){return null==t?[]:(Aa(e)||(e=null==e?[]:[e]),Aa(n=i?F:n)||(n=null==n?[]:[n]),Dn(t,e,n))},Yt.over=pl,Yt.overArgs=Ia,Yt.overEvery=gl,Yt.overSome=ml,Yt.partial=Ea,Yt.partialRight=Ta,Yt.partition=pa,Yt.pick=qa,Yt.pickBy=to,Yt.property=uo,Yt.propertyOf=function(t){return function(e){return null==t?F:Ge(t,e)}},Yt.pull=Xs,Yt.pullAll=mr,Yt.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?On(t,e,Gi(n,2)):t},Yt.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?On(t,e,F,n):t},Yt.pullAt=qs,Yt.range=vl,Yt.rangeRight=yl,Yt.rearg=wa,Yt.reject=function(t,e){return(Aa(t)?o:Me)(t,Or(Gi(e,3)))},Yt.remove=function(t,e){var n=[];if(!t||!t.length)return n;var i=-1,r=[],o=t.length;for(e=Gi(e,3);++i<o;){var s=t[i];e(s,i,t)&&(n.push(s),r.push(i))}return Sn(t,r),n},Yt.rest=function(t,e){if("function"!=typeof t)throw new Eo(V);return Nn(t,e=e===F?e:Ur(e))},Yt.reverse=vr,Yt.sampleSize=function(t,e,n){return e=(n?Yi(t,e,n):e===F)?1:Ur(e),(Aa(t)?ye:Pn)(t,e)},Yt.set=function(t,e,n){return null==t?t:Ln(t,e,n)},Yt.setWith=function(t,e,n,i){return i="function"==typeof i?i:F,null==t?t:Ln(t,e,n,i)},Yt.shuffle=function(t){return(Aa(t)?be:Kn)(t)},Yt.slice=function(t,e,n){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&Yi(t,e,n)?(e=0,n=i):(e=null==e?0:Ur(e),n=n===F?i:Ur(n)),Bn(t,e,n)):[]},Yt.sortBy=ga,Yt.sortedUniq=function(t){return t&&t.length?Fn(t):[]},Yt.sortedUniqBy=function(t,e){return t&&t.length?Fn(t,Gi(e,2)):[]},Yt.split=function(t,e,n){return n&&"number"!=typeof n&&Yi(t,e,n)&&(e=n=F),(n=n===F?tt:n>>>0)?(t=Yr(t))&&("string"==typeof e||null!=e&&!Na(e))&&(!(e=Hn(e))&&k(t))?ei(z(t),0,n):t.split(e,n):[]},Yt.spread=function(e,n){if("function"!=typeof e)throw new Eo(V);return n=null==n?0:is(Ur(n),0),Nn(function(i){var r=i[n],o=ei(i,0,n);return r&&c(o,r),t(e,this,o)})},Yt.tail=function(t){var e=null==t?0:t.length;return e?Bn(t,1,e):[]},Yt.take=function(t,e,n){return t&&t.length?Bn(t,0,(e=n||e===F?1:Ur(e))<0?0:e):[]},Yt.takeRight=function(t,e,n){var i=null==t?0:t.length;return i?Bn(t,(e=i-(e=n||e===F?1:Ur(e)))<0?0:e,i):[]},Yt.takeRightWhile=function(t,e){return t&&t.length?$n(t,Gi(e,3),!1,!0):[]},Yt.takeWhile=function(t,e){return t&&t.length?$n(t,Gi(e,3)):[]},Yt.tap=function(t,e){return e(t),t},Yt.throttle=function(t,e,n){var i=!0,r=!0;if("function"!=typeof t)throw new Eo(V);return Kr(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),Dr(t,e,{leading:i,maxWait:e,trailing:r})},Yt.thru=Ir,Yt.toArray=Vr,Yt.toPairs=Ja,Yt.toPairsIn=Qa,Yt.toPath=function(t){return Aa(t)?l(t,ar):Fr(t)?[t]:li(Vs(Yr(t)))},Yt.toPlainObject=$r,Yt.transform=function(t,e,i){var r=Aa(t),o=r||Sa(t)||Pa(t);if(e=Gi(e,4),null==i){var s=t&&t.constructor;i=o?r?new s:[]:Kr(t)&&Mr(s)?xs(zo(t)):{}}return(o?n:Le)(t,function(t,n,r){return e(i,t,n,r)}),i},Yt.unary=function(t){return xr(t,1)},Yt.union=Js,Yt.unionBy=Qs,Yt.unionWith=ta,Yt.uniq=function(t){return t&&t.length?Un(t):[]},Yt.uniqBy=function(t,e){return t&&t.length?Un(t,Gi(e,2)):[]},Yt.uniqWith=function(t,e){return e="function"==typeof e?e:F,t&&t.length?Un(t,F,e):[]},Yt.unset=function(t,e){return null==t||Zn(t,e)},Yt.unzip=yr,Yt.unzipWith=br,Yt.update=function(t,e,n){return null==t?t:Wn(t,e,Qn(n))},Yt.updateWith=function(t,e,n,i){return i="function"==typeof i?i:F,null==t?t:Wn(t,e,Qn(n),i)},Yt.values=eo,Yt.valuesIn=function(t){return null==t?[]:D(t,Qr(t))},Yt.without=ea,Yt.words=ro,Yt.wrap=function(t,e){return Ea(Qn(e),t)},Yt.xor=na,Yt.xorBy=ia,Yt.xorWith=ra,Yt.zip=oa,Yt.zipObject=function(t,e){return qn(t||[],e||[],Ie)},Yt.zipObjectDeep=function(t,e){return qn(t||[],e||[],Ln)},Yt.zipWith=sa,Yt.entries=Ja,Yt.entriesIn=Qa,Yt.extend=za,Yt.extendWith=ja,lo(Yt,Yt),Yt.add=bl,Yt.attempt=ll,Yt.camelCase=tl,Yt.capitalize=no,Yt.ceil=Cl,Yt.clamp=function(t,e,n){return n===F&&(n=e,e=F),n!==F&&(n=(n=Wr(n))==n?n:0),e!==F&&(e=(e=Wr(e))==e?e:0),De(Wr(t),e,n)},Yt.clone=function(t){return Ae(t,4)},Yt.cloneDeep=function(t){return Ae(t,5)},Yt.cloneDeepWith=function(t,e){return Ae(t,5,e="function"==typeof e?e:F)},Yt.cloneWith=function(t,e){return Ae(t,4,e="function"==typeof e?e:F)},Yt.conformsTo=function(t,e){return null==e||Oe(t,e,Jr(e))},Yt.deburr=io,Yt.defaultTo=function(t,e){return null==t||t!=t?e:t},Yt.divide=Il,Yt.endsWith=function(t,e,n){t=Yr(t),e=Hn(e);var i=t.length,r=n=n===F?i:De(Ur(n),0,i);return(n-=e.length)>=0&&t.slice(n,r)==e},Yt.eq=Sr,Yt.escape=function(t){return(t=Yr(t))&&Pt.test(t)?t.replace(Nt,pn):t},Yt.escapeRegExp=function(t){return(t=Yr(t))&&Vt.test(t)?t.replace(Ft,"\\$&"):t},Yt.every=function(t,e,n){var i=Aa(t)?r:ke;return n&&Yi(t,e,n)&&(e=F),i(t,Gi(e,3))},Yt.find=ca,Yt.findIndex=hr,Yt.findKey=function(t,e){return p(t,Gi(e,3),Le)},Yt.findLast=ua,Yt.findLastIndex=dr,Yt.findLastKey=function(t,e){return p(t,Gi(e,3),Ke)},Yt.floor=El,Yt.forEach=Er,Yt.forEachRight=Tr,Yt.forIn=function(t,e){return null==t?t:As(t,Gi(e,3),Qr)},Yt.forInRight=function(t,e){return null==t?t:Os(t,Gi(e,3),Qr)},Yt.forOwn=function(t,e){return t&&Le(t,Gi(e,3))},Yt.forOwnRight=function(t,e){return t&&Ke(t,Gi(e,3))},Yt.get=Xr,Yt.gt=xa,Yt.gte=_a,Yt.has=function(t,e){return null!=t&&Ui(t,e,qe)},Yt.hasIn=qr,Yt.head=pr,Yt.identity=so,Yt.includes=function(t,e,n,i){t=Rr(t)?t:eo(t),n=n&&!i?Ur(n):0;var r=t.length;return n<0&&(n=is(r+n,0)),Gr(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&m(t,e,n)>-1},Yt.indexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:Ur(n);return r<0&&(r=is(i+r,0)),m(t,e,r)},Yt.inRange=function(t,e,n){return e=Hr(e),n===F?(n=e,e=0):n=Hr(n),function(t,e,n){return t>=rs(e,n)&&t<is(e,n)}(t=Wr(t),e,n)},Yt.invoke=Wa,Yt.isArguments=Da,Yt.isArray=Aa,Yt.isArrayBuffer=Oa,Yt.isArrayLike=Rr,Yt.isArrayLikeObject=kr,Yt.isBoolean=function(t){return!0===t||!1===t||Br(t)&&Ve(t)==rt},Yt.isBuffer=Sa,Yt.isDate=Ra,Yt.isElement=function(t){return Br(t)&&1===t.nodeType&&!jr(t)},Yt.isEmpty=function(t){if(null==t)return!0;if(Rr(t)&&(Aa(t)||"string"==typeof t||"function"==typeof t.splice||Sa(t)||Pa(t)||Da(t)))return!t.length;var e=Bs(t);if(e==ct||e==pt)return!t.size;if(Ji(t))return!bn(t).length;for(var n in t)if(Ao.call(t,n))return!1;return!0},Yt.isEqual=function(t,e){return on(t,e)},Yt.isEqualWith=function(t,e,n){var i=(n="function"==typeof n?n:F)?n(t,e):F;return i===F?on(t,e,F,n):!!i},Yt.isError=Nr,Yt.isFinite=function(t){return"number"==typeof t&&ts(t)},Yt.isFunction=Mr,Yt.isInteger=Pr,Yt.isLength=Lr,Yt.isMap=ka,Yt.isMatch=function(t,e){return t===e||dn(t,e,Vi(e))},Yt.isMatchWith=function(t,e,n){return n="function"==typeof n?n:F,dn(t,e,Vi(e),n)},Yt.isNaN=function(t){return zr(t)&&t!=+t},Yt.isNative=function(t){if(zs(t))throw new mo("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return vn(t)},Yt.isNil=function(t){return null==t},Yt.isNull=function(t){return null===t},Yt.isNumber=zr,Yt.isObject=Kr,Yt.isObjectLike=Br,Yt.isPlainObject=jr,Yt.isRegExp=Na,Yt.isSafeInteger=function(t){return Pr(t)&&t>=-J&&t<=J},Yt.isSet=Ma,Yt.isString=Gr,Yt.isSymbol=Fr,Yt.isTypedArray=Pa,Yt.isUndefined=function(t){return t===F},Yt.isWeakMap=function(t){return Br(t)&&Bs(t)==vt},Yt.isWeakSet=function(t){return Br(t)&&"[object WeakSet]"==Ve(t)},Yt.join=function(t,e){return null==t?"":es.call(t,e)},Yt.kebabCase=el,Yt.last=gr,Yt.lastIndexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=i;return n!==F&&(r=(r=Ur(n))<0?is(i+r,0):rs(r,i-1)),e==e?function(t,e,n){for(var i=n+1;i--;)if(t[i]===e)return i;return i}(t,e,r):g(t,y,r,!0)},Yt.lowerCase=nl,Yt.lowerFirst=il,Yt.lt=La,Yt.lte=Ka,Yt.max=function(t){return t&&t.length?Ne(t,so,$e):F},Yt.maxBy=function(t,e){return t&&t.length?Ne(t,Gi(e,2),$e):F},Yt.mean=function(t){return b(t,so)},Yt.meanBy=function(t,e){return b(t,Gi(e,2))},Yt.min=function(t){return t&&t.length?Ne(t,so,In):F},Yt.minBy=function(t,e){return t&&t.length?Ne(t,Gi(e,2),In):F},Yt.stubArray=ho,Yt.stubFalse=fo,Yt.stubObject=function(){return{}},Yt.stubString=function(){return""},Yt.stubTrue=function(){return!0},Yt.multiply=Tl,Yt.nth=function(t,e){return t&&t.length?_n(t,Ur(e)):F},Yt.noConflict=function(){return Qe._===this&&(Qe._=No),this},Yt.noop=co,Yt.now=ma,Yt.pad=function(t,e,n){t=Yr(t);var i=(e=Ur(e))?B(t):0;if(!e||i>=e)return t;var r=(e-i)/2;return wi(qo(r),n)+t+wi(Xo(r),n)},Yt.padEnd=function(t,e,n){t=Yr(t);var i=(e=Ur(e))?B(t):0;return e&&i<e?t+wi(e-i,n):t},Yt.padStart=function(t,e,n){t=Yr(t);var i=(e=Ur(e))?B(t):0;return e&&i<e?wi(e-i,n)+t:t},Yt.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),ss(Yr(t).replace(Ht,""),e||0)},Yt.random=function(t,e,n){if(n&&"boolean"!=typeof n&&Yi(t,e,n)&&(e=n=F),n===F&&("boolean"==typeof e?(n=e,e=F):"boolean"==typeof t&&(n=t,t=F)),t===F&&e===F?(t=0,e=1):(t=Hr(t),e===F?(e=t,t=0):e=Hr(e)),t>e){var i=t;t=e,e=i}if(n||t%1||e%1){var r=as();return rs(t+r*(e-t+Ye("1e-"+((r+"").length-1))),e)}return Rn(t,e)},Yt.reduce=function(t,e,n){var i=Aa(t)?u:E,r=arguments.length<3;return i(t,Gi(e,4),n,r,_s)},Yt.reduceRight=function(t,e,n){var i=Aa(t)?h:E,r=arguments.length<3;return i(t,Gi(e,4),n,r,Ds)},Yt.repeat=function(t,e,n){return e=(n?Yi(t,e,n):e===F)?1:Ur(e),kn(Yr(t),e)},Yt.replace=function(){var t=arguments,e=Yr(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Yt.result=function(t,e,n){var i=-1,r=(e=ti(e,t)).length;for(r||(r=1,t=F);++i<r;){var o=null==t?F:t[ar(e[i])];o===F&&(i=r,o=n),t=Mr(o)?o.call(t):o}return t},Yt.round=wl,Yt.runInContext=I,Yt.sample=function(t){return(Aa(t)?ve:Mn)(t)},Yt.size=function(t){if(null==t)return 0;if(Rr(t))return Gr(t)?B(t):t.length;var e=Bs(t);return e==ct||e==pt?t.size:bn(t).length},Yt.snakeCase=rl,Yt.some=function(t,e,n){var i=Aa(t)?d:zn;return n&&Yi(t,e,n)&&(e=F),i(t,Gi(e,3))},Yt.sortedIndex=function(t,e){return jn(t,e)},Yt.sortedIndexBy=function(t,e,n){return Gn(t,e,Gi(n,2))},Yt.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var i=jn(t,e);if(i<n&&Sr(t[i],e))return i}return-1},Yt.sortedLastIndex=function(t,e){return jn(t,e,!0)},Yt.sortedLastIndexBy=function(t,e,n){return Gn(t,e,Gi(n,2),!0)},Yt.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=jn(t,e,!0)-1;if(Sr(t[n],e))return n}return-1},Yt.startCase=ol,Yt.startsWith=function(t,e,n){return t=Yr(t),n=null==n?0:De(Ur(n),0,t.length),e=Hn(e),t.slice(n,n+e.length)==e},Yt.subtract=xl,Yt.sum=function(t){return t&&t.length?T(t,so):0},Yt.sumBy=function(t,e){return t&&t.length?T(t,Gi(e,2)):0},Yt.template=function(t,e,n){var i=Yt.templateSettings;n&&Yi(t,e,n)&&(e=F),t=Yr(t),e=ja({},e,i,ki);var r,o,s=ja({},e.imports,i.imports,ki),a=Jr(s),l=D(s,a),c=0,u=e.interpolate||se,h="__p += '",d=Co((e.escape||se).source+"|"+u.source+"|"+(u===Bt?Jt:se).source+"|"+(e.evaluate||se).source+"|$","g"),f="//# sourceURL="+(Ao.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ue+"]")+"\n";t.replace(d,function(e,n,i,s,a,l){return i||(i=s),h+=t.slice(c,l).replace(ae,R),n&&(r=!0,h+="' +\n__e("+n+") +\n'"),a&&(o=!0,h+="';\n"+a+";\n__p += '"),i&&(h+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),c=l+e.length,e}),h+="';\n";var p=Ao.call(e,"variable")&&e.variable;if(p){if(Xt.test(p))throw new mo("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(o?h.replace(Ot,""):h).replace(St,"$1").replace(Rt,"$1;"),h="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g=ll(function(){return vo(a,f+"return "+h).apply(F,l)});if(g.source=h,Nr(g))throw g;return g},Yt.times=function(t,e){if((t=Ur(t))<1||t>J)return[];var n=tt,i=rs(t,tt);e=Gi(e),t-=tt;for(var r=w(i,e);++n<t;)e(n);return r},Yt.toFinite=Hr,Yt.toInteger=Ur,Yt.toLength=Zr,Yt.toLower=function(t){return Yr(t).toLowerCase()},Yt.toNumber=Wr,Yt.toSafeInteger=function(t){return t?De(Ur(t),-J,J):0===t?t:0},Yt.toString=Yr,Yt.toUpper=function(t){return Yr(t).toUpperCase()},Yt.trim=function(t,e,n){if((t=Yr(t))&&(n||e===F))return x(t);if(!t||!(e=Hn(e)))return t;var i=z(t),r=z(e);return ei(i,O(i,r),S(i,r)+1).join("")},Yt.trimEnd=function(t,e,n){if((t=Yr(t))&&(n||e===F))return t.slice(0,j(t)+1);if(!t||!(e=Hn(e)))return t;var i=z(t);return ei(i,0,S(i,z(e))+1).join("")},Yt.trimStart=function(t,e,n){if((t=Yr(t))&&(n||e===F))return t.replace(Ht,"");if(!t||!(e=Hn(e)))return t;var i=z(t);return ei(i,O(i,z(e))).join("")},Yt.truncate=function(t,e){var n=30,i="...";if(Kr(e)){var r="separator"in e?e.separator:r;n="length"in e?Ur(e.length):n,i="omission"in e?Hn(e.omission):i}var o=(t=Yr(t)).length;if(k(t)){var s=z(t);o=s.length}if(n>=o)return t;var a=n-B(i);if(a<1)return i;var l=s?ei(s,0,a).join(""):t.slice(0,a);if(r===F)return l+i;if(s&&(a+=l.length-a),Na(r)){if(t.slice(a).search(r)){var c,u=l;for(r.global||(r=Co(r.source,Yr(Qt.exec(r))+"g")),r.lastIndex=0;c=r.exec(u);)var h=c.index;l=l.slice(0,h===F?a:h)}}else if(t.indexOf(Hn(r),a)!=a){var d=l.lastIndexOf(r);d>-1&&(l=l.slice(0,d))}return l+i},Yt.unescape=function(t){return(t=Yr(t))&&Mt.test(t)?t.replace(kt,gn):t},Yt.uniqueId=function(t){var e=++Oo;return Yr(t)+e},Yt.upperCase=sl,Yt.upperFirst=al,Yt.each=Er,Yt.eachRight=Tr,Yt.first=pr,lo(Yt,function(){var t={};return Le(Yt,function(e,n){Ao.call(Yt.prototype,n)||(t[n]=e)}),t}(),{chain:!1}),Yt.VERSION="4.17.21",n(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){Yt[t].placeholder=Yt}),n(["drop","take"],function(t,e){ue.prototype[t]=function(n){n=n===F?1:is(Ur(n),0);var i=this.__filtered__&&!e?new ue(this):this.clone();return i.__filtered__?i.__takeCount__=rs(n,i.__takeCount__):i.__views__.push({size:rs(n,tt),type:t+(i.__dir__<0?"Right":"")}),i},ue.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),n(["filter","map","takeWhile"],function(t,e){var n=e+1,i=1==n||3==n;ue.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Gi(t,3),type:n}),e.__filtered__=e.__filtered__||i,e}}),n(["head","last"],function(t,e){var n="take"+(e?"Right":"");ue.prototype[t]=function(){return this[n](1).value()[0]}}),n(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");ue.prototype[t]=function(){return this.__filtered__?new ue(this):this[n](1)}}),ue.prototype.compact=function(){return this.filter(so)},ue.prototype.find=function(t){return this.filter(t).head()},ue.prototype.findLast=function(t){return this.reverse().find(t)},ue.prototype.invokeMap=Nn(function(t,e){return"function"==typeof t?new ue(this):this.map(function(n){return en(n,t,e)})}),ue.prototype.reject=function(t){return this.filter(Or(Gi(t)))},ue.prototype.slice=function(t,e){t=Ur(t);var n=this;return n.__filtered__&&(t>0||e<0)?new ue(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==F&&(n=(e=Ur(e))<0?n.dropRight(-e):n.take(e-t)),n)},ue.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},ue.prototype.toArray=function(){return this.take(tt)},Le(ue.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),r=Yt[i?"take"+("last"==e?"Right":""):e],o=i||/^find/.test(e);r&&(Yt.prototype[e]=function(){var e=this.__wrapped__,s=i?[1]:arguments,a=e instanceof ue,l=s[0],u=a||Aa(e),h=function(t){var e=r.apply(Yt,c([t],s));return i&&d?e[0]:e};u&&n&&"function"==typeof l&&1!=l.length&&(a=u=!1);var d=this.__chain__,f=!!this.__actions__.length,p=o&&!d,g=a&&!f;if(!o&&u){e=g?e:new ue(this);var m=t.apply(e,s);return m.__actions__.push({func:Ir,args:[h],thisArg:F}),new ce(m,d)}return p&&g?t.apply(this,s):(m=this.thru(h),p?i?m.value()[0]:m.value():m)})}),n(["pop","push","shift","sort","splice","unshift"],function(t){var e=To[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);Yt.prototype[t]=function(){var t=arguments;if(i&&!this.__chain__){var r=this.value();return e.apply(Aa(r)?r:[],t)}return this[n](function(n){return e.apply(Aa(n)?n:[],t)})}}),Le(ue.prototype,function(t,e){var n=Yt[e];if(n){var i=n.name+"";Ao.call(ms,i)||(ms[i]=[]),ms[i].push({name:e,func:n})}}),ms[Ci(F,2).name]=[{name:"wrapper",func:F}],ue.prototype.clone=function(){var t=new ue(this.__wrapped__);return t.__actions__=li(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=li(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=li(this.__views__),t},ue.prototype.reverse=function(){if(this.__filtered__){var t=new ue(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},ue.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Aa(t),i=e<0,r=n?t.length:0,o=function(t,e,n){for(var i=-1,r=n.length;++i<r;){var o=n[i],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=rs(e,t+s);break;case"takeRight":t=is(t,e-s)}}return{start:t,end:e}}(0,r,this.__views__),s=o.start,a=o.end,l=a-s,c=i?a:s-1,u=this.__iteratees__,h=u.length,d=0,f=rs(l,this.__takeCount__);if(!n||!i&&r==l&&f==l)return Yn(t,this.__actions__);var p=[];t:for(;l--&&d<f;){for(var g=-1,m=t[c+=e];++g<h;){var v=u[g],y=v.iteratee,b=v.type,C=y(m);if(2==b)m=C;else if(!C){if(1==b)continue t;break t}}p[d++]=m}return p},Yt.prototype.at=aa,Yt.prototype.chain=function(){return Cr(this)},Yt.prototype.commit=function(){return new ce(this.value(),this.__chain__)},Yt.prototype.next=function(){this.__values__===F&&(this.__values__=Vr(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?F:this.__values__[this.__index__++]}},Yt.prototype.plant=function(t){for(var e,n=this;n instanceof le;){var i=ur(n);i.__index__=0,i.__values__=F,e?r.__wrapped__=i:e=i;var r=i;n=n.__wrapped__}return r.__wrapped__=t,e},Yt.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof ue){var e=t;return this.__actions__.length&&(e=new ue(this)),(e=e.reverse()).__actions__.push({func:Ir,args:[vr],thisArg:F}),new ce(e,this.__chain__)}return this.thru(vr)},Yt.prototype.toJSON=Yt.prototype.valueOf=Yt.prototype.value=function(){return Yn(this.__wrapped__,this.__actions__)},Yt.prototype.first=Yt.prototype.head,Ho&&(Yt.prototype[Ho]=function(){return this}),Yt}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Qe._=mn,define(function(){return mn})):en?((en.exports=mn)._=mn,tn._=mn):Qe._=mn}).call(this),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).d3=t.d3||{})}(this,function(t){"use strict";function e(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function n(t){var n;return 1===t.length&&(n=t,t=function(t,i){return e(n(t),i)}),{left:function(e,n,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)<0?i=o+1:r=o}return i},right:function(e,n,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)>0?r=o:i=o+1}return i}}}var i=n(e),r=i.right,o=i.left;function s(t,e){return[t,e]}function a(t){return null===t?NaN:+t}function l(t,e){var n,i,r=t.length,o=0,s=-1,l=0,c=0;if(null==e)for(;++s<r;)isNaN(n=a(t[s]))||(c+=(i=n-l)*(n-(l+=i/++o)));else for(;++s<r;)isNaN(n=a(e(t[s],s,t)))||(c+=(i=n-l)*(n-(l+=i/++o)));if(o>1)return c/(o-1)}function c(t,e){var n=l(t,e);return n?Math.sqrt(n):n}function u(t,e){var n,i,r,o=t.length,s=-1;if(null==e){for(;++s<o;)if(null!=(n=t[s])&&n>=n)for(i=r=n;++s<o;)null!=(n=t[s])&&(i>n&&(i=n),r<n&&(r=n))}else for(;++s<o;)if(null!=(n=e(t[s],s,t))&&n>=n)for(i=r=n;++s<o;)null!=(n=e(t[s],s,t))&&(i>n&&(i=n),r<n&&(r=n));return[i,r]}var h=Array.prototype,d=h.slice,f=h.map;function p(t){return function(){return t}}function g(t){return t}function m(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(r);++i<r;)o[i]=t+i*n;return o}var v=Math.sqrt(50),y=Math.sqrt(10),b=Math.sqrt(2);function C(t,e,n){var i,r,o,s,a=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(s=I(t,e,n))||!isFinite(s))return[];if(s>0)for(t=Math.ceil(t/s),e=Math.floor(e/s),o=new Array(r=Math.ceil(e-t+1));++a<r;)o[a]=(t+a)*s;else for(t=Math.floor(t*s),e=Math.ceil(e*s),o=new Array(r=Math.ceil(t-e+1));++a<r;)o[a]=(t-a)/s;return i&&o.reverse(),o}function I(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=v?10:o>=y?5:o>=b?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=v?10:o>=y?5:o>=b?2:1)}function E(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=v?r*=10:o>=y?r*=5:o>=b&&(r*=2),e<t?-r:r}function T(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function w(t,e,n){if(null==n&&(n=a),i=t.length){if((e=+e)<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,r=(i-1)*e,o=Math.floor(r),s=+n(t[o],o,t);return s+(+n(t[o+1],o+1,t)-s)*(r-o)}}function x(t,e){var n,i,r=t.length,o=-1;if(null==e){for(;++o<r;)if(null!=(n=t[o])&&n>=n)for(i=n;++o<r;)null!=(n=t[o])&&n>i&&(i=n)}else for(;++o<r;)if(null!=(n=e(t[o],o,t))&&n>=n)for(i=n;++o<r;)null!=(n=e(t[o],o,t))&&n>i&&(i=n);return i}function _(t){for(var e,n,i,r=t.length,o=-1,s=0;++o<r;)s+=t[o].length;for(n=new Array(s);--r>=0;)for(e=(i=t[r]).length;--e>=0;)n[--s]=i[e];return n}function D(t,e){var n,i,r=t.length,o=-1;if(null==e){for(;++o<r;)if(null!=(n=t[o])&&n>=n)for(i=n;++o<r;)null!=(n=t[o])&&i>n&&(i=n)}else for(;++o<r;)if(null!=(n=e(t[o],o,t))&&n>=n)for(i=n;++o<r;)null!=(n=e(t[o],o,t))&&i>n&&(i=n);return i}function A(t){if(!(r=t.length))return[];for(var e=-1,n=D(t,O),i=new Array(n);++e<n;)for(var r,o=-1,s=i[e]=new Array(r);++o<r;)s[o]=t[o][e];return i}function O(t){return t.length}var S=Array.prototype.slice;function R(t){return t}var k=1e-6;function N(t){return"translate("+(t+.5)+",0)"}function M(t){return"translate(0,"+(t+.5)+")"}function P(){return!this.__axis}function L(t,e){var n=[],i=null,r=null,o=6,s=6,a=3,l=1===t||4===t?-1:1,c=4===t||2===t?"x":"y",u=1===t||3===t?N:M;function h(h){var d=null==i?e.ticks?e.ticks.apply(e,n):e.domain():i,f=null==r?e.tickFormat?e.tickFormat.apply(e,n):R:r,p=Math.max(o,0)+a,g=e.range(),m=+g[0]+.5,v=+g[g.length-1]+.5,y=(e.bandwidth?function(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}:function(t){return function(e){return+t(e)}})(e.copy()),b=h.selection?h.selection():h,C=b.selectAll(".domain").data([null]),I=b.selectAll(".tick").data(d,e).order(),E=I.exit(),T=I.enter().append("g").attr("class","tick"),w=I.select("line"),x=I.select("text");C=C.merge(C.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),I=I.merge(T),w=w.merge(T.append("line").attr("stroke","currentColor").attr(c+"2",l*o)),x=x.merge(T.append("text").attr("fill","currentColor").attr(c,l*p).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),h!==b&&(C=C.transition(h),I=I.transition(h),w=w.transition(h),x=x.transition(h),E=E.transition(h).attr("opacity",k).attr("transform",function(t){return isFinite(t=y(t))?u(t):this.getAttribute("transform")}),T.attr("opacity",k).attr("transform",function(t){var e=this.parentNode.__axis;return u(e&&isFinite(e=e(t))?e:y(t))})),E.remove(),C.attr("d",4===t||2==t?s?"M"+l*s+","+m+"H0.5V"+v+"H"+l*s:"M0.5,"+m+"V"+v:s?"M"+m+","+l*s+"V0.5H"+v+"V"+l*s:"M"+m+",0.5H"+v),I.attr("opacity",1).attr("transform",function(t){return u(y(t))}),w.attr(c+"2",l*o),x.attr(c,l*p).text(f),b.filter(P).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),b.each(function(){this.__axis=y})}return h.scale=function(t){return arguments.length?(e=t,h):e},h.ticks=function(){return n=S.call(arguments),h},h.tickArguments=function(t){return arguments.length?(n=null==t?[]:S.call(t),h):n.slice()},h.tickValues=function(t){return arguments.length?(i=null==t?null:S.call(t),h):i&&i.slice()},h.tickFormat=function(t){return arguments.length?(r=t,h):r},h.tickSize=function(t){return arguments.length?(o=s=+t,h):o},h.tickSizeInner=function(t){return arguments.length?(o=+t,h):o},h.tickSizeOuter=function(t){return arguments.length?(s=+t,h):s},h.tickPadding=function(t){return arguments.length?(a=+t,h):a},h}var K={value:function(){}};function B(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new z(i)}function z(t){this._=t}function j(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function G(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=K,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}z.prototype=B.prototype={constructor:z,on:function(t,e){var n,i=this._,r=function(t,e){return t.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}(t+"",i),o=-1,s=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=r[o]).type)i[n]=G(i[n],t.name,e);else if(null==e)for(n in i)i[n]=G(i[n],t.name,null);return this}for(;++o<s;)if((n=(t=r[o]).type)&&(n=j(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new z(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(i=this._[t]).length;o<n;++o)i[o].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};var F="http://www.w3.org/1999/xhtml",V={svg:"http://www.w3.org/2000/svg",xhtml:F,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function H(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),V.hasOwnProperty(e)?{space:V[e],local:t}:t}function U(t){var e=H(t);return(e.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===F&&e.documentElement.namespaceURI===F?e.createElement(t):e.createElementNS(n,t)}})(e)}function Z(){}function W(t){return null==t?Z:function(){return this.querySelector(t)}}function $(){return[]}function Y(t){return null==t?$:function(){return this.querySelectorAll(t)}}function X(t){return function(){return this.matches(t)}}function q(t){return new Array(t.length)}function J(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}J.prototype={constructor:J,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Q(t,e,n,i,r,o){for(var s,a=0,l=e.length,c=o.length;a<c;++a)(s=e[a])?(s.__data__=o[a],i[a]=s):n[a]=new J(t,o[a]);for(;a<l;++a)(s=e[a])&&(r[a]=s)}function tt(t,e,n,i,r,o,s){var a,l,c,u={},h=e.length,d=o.length,f=new Array(h);for(a=0;a<h;++a)(l=e[a])&&(f[a]=c="$"+s.call(l,l.__data__,a,e),c in u?r[a]=l:u[c]=l);for(a=0;a<d;++a)(l=u[c="$"+s.call(t,o[a],a,o)])?(i[a]=l,l.__data__=o[a],u[c]=null):n[a]=new J(t,o[a]);for(a=0;a<h;++a)(l=e[a])&&u[f[a]]===l&&(r[a]=l)}function et(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function nt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function it(t,e){return t.style.getPropertyValue(e)||nt(t).getComputedStyle(t,null).getPropertyValue(e)}function rt(t){return t.trim().split(/^|\s+/)}function ot(t){return t.classList||new st(t)}function st(t){this._node=t,this._names=rt(t.getAttribute("class")||"")}function at(t,e){for(var n=ot(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function lt(t,e){for(var n=ot(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function ct(){this.textContent=""}function ut(){this.innerHTML=""}function ht(){this.nextSibling&&this.parentNode.appendChild(this)}function dt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ft(){return null}function pt(){var t=this.parentNode;t&&t.removeChild(this)}function gt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function mt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}st.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var vt={};function yt(t,e,n){return t=bt(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function bt(e,n,i){return function(r){var o=t.event;t.event=r;try{e.call(this,this.__data__,n,i)}finally{t.event=o}}}function Ct(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,o=e.length;i<o;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.capture);++r?e.length=r:delete this.__on}}}function It(t,e,n){var i=vt.hasOwnProperty(t.type)?yt:bt;return function(r,o,s){var a,l=this.__on,c=i(e,o,s);if(l)for(var u=0,h=l.length;u<h;++u)if((a=l[u]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=c,a.capture=n),void(a.value=e);this.addEventListener(t.type,c,n),a={type:t.type,name:t.name,value:e,listener:c,capture:n},l?l.push(a):this.__on=[a]}}function Et(e,n,i,r){var o=t.event;e.sourceEvent=t.event,t.event=e;try{return n.apply(i,r)}finally{t.event=o}}function Tt(t,e,n){var i=nt(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}t.event=null,"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(vt={mouseenter:"mouseover",mouseleave:"mouseout"}));var wt=[null];function xt(t,e){this._groups=t,this._parents=e}function _t(){return new xt([[document.documentElement]],wt)}function Dt(t){return"string"==typeof t?new xt([[document.querySelector(t)]],[document.documentElement]):new xt([[t]],wt)}xt.prototype=_t.prototype={constructor:xt,select:function(t){"function"!=typeof t&&(t=W(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s,a=e[r],l=a.length,c=i[r]=new Array(l),u=0;u<l;++u)(o=a[u])&&(s=t.call(o,o.__data__,u,a))&&("__data__"in o&&(s.__data__=o.__data__),c[u]=s);return new xt(i,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=Y(t));for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var s,a=e[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(i.push(t.call(s,s.__data__,c,a)),r.push(s));return new xt(i,r)},filter:function(t){"function"!=typeof t&&(t=X(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s=e[r],a=s.length,l=i[r]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new xt(i,this._parents)},data:function(t,e){if(!t)return f=new Array(this.size()),c=-1,this.each(function(t){f[++c]=t}),f;var n=e?tt:Q,i=this._parents,r=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var o=r.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=i[c],h=r[c],d=h.length,f=t.call(u,u&&u.__data__,c,i),p=f.length,g=a[c]=new Array(p),m=s[c]=new Array(p);n(u,h,g,m,l[c]=new Array(d),f,e);for(var v,y,b=0,C=0;b<p;++b)if(v=g[b]){for(b>=C&&(C=b+1);!(y=m[C])&&++C<p;);v._next=y||null}}return(s=new xt(s,i))._enter=a,s._exit=l,s},enter:function(){return new xt(this._enter||this._groups.map(q),this._parents)},exit:function(){return new xt(this._exit||this._groups.map(q),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,o=this.exit();return i="function"==typeof t?t(i):i.append(t+""),null!=e&&(r=e(r)),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(t){for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var l,c=e[a],u=n[a],h=c.length,d=s[a]=new Array(h),f=0;f<h;++f)(l=c[f]||u[f])&&(d[f]=l);for(;a<i;++a)s[a]=e[a];return new xt(s,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],o=r.length-1,s=r[o];--o>=0;)(i=r[o])&&(s&&4^i.compareDocumentPosition(s)&&s.parentNode.insertBefore(i,s),s=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=et);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var s,a=n[o],l=a.length,c=r[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(e)}return new xt(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,o=e[n],s=0,a=o.length;s<a;++s)(r=o[s])&&t.call(r,r.__data__,s,o);return this},attr:function(t,e){var n=H(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}:function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):it(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=rt(t+"");if(arguments.length<2){for(var i=ot(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?at:lt)(this,t)}}:e?function(t){return function(){at(this,t)}}:function(t){return function(){lt(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?ct:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?ut:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(ht)},lower:function(){return this.each(dt)},append:function(t){var e="function"==typeof t?t:U(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:U(t),i=null==e?ft:"function"==typeof e?e:W(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(pt)},clone:function(t){return this.select(t?mt:gt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,o=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?It:Ct,null==n&&(n=!1),i=0;i<s;++i)this.each(a(o[i],e,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(i=0,l=a[c];i<s;++i)if((r=o[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return Tt(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return Tt(this,t,e)}})(t,e))}};var At=0;function Ot(){return new St}function St(){this._="@"+(++At).toString(36)}function Rt(){for(var e,n=t.event;e=n.sourceEvent;)n=e;return n}function kt(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}function Nt(t){var e=Rt();return e.changedTouches&&(e=e.changedTouches[0]),kt(t,e)}function Mt(t,e,n){arguments.length<3&&(n=e,e=Rt().changedTouches);for(var i,r=0,o=e?e.length:0;r<o;++r)if((i=e[r]).identifier===n)return kt(t,i);return null}function Pt(){t.event.stopImmediatePropagation()}function Lt(){t.event.preventDefault(),t.event.stopImmediatePropagation()}function Kt(t){var e=t.document.documentElement,n=Dt(t).on("dragstart.drag",Lt,!0);"onselectstart"in e?n.on("selectstart.drag",Lt,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Bt(t,e){var n=t.document.documentElement,i=Dt(t).on("dragstart.drag",null);e&&(i.on("click.drag",Lt,!0),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function zt(t){return function(){return t}}function jt(t,e,n,i,r,o,s,a,l,c){this.target=t,this.type=e,this.subject=n,this.identifier=i,this.active=r,this.x=o,this.y=s,this.dx=a,this.dy=l,this._=c}function Gt(){return!t.event.ctrlKey&&!t.event.button}function Ft(){return this.parentNode}function Vt(e){return null==e?{x:t.event.x,y:t.event.y}:e}function Ht(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ut(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Zt(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Wt(){}St.prototype=Ot.prototype={constructor:St,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}},jt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var $t="\\s*([+-]?\\d+)\\s*",Yt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qt=/^#([0-9a-f]{3,8})$/,Jt=new RegExp("^rgb\\("+[$t,$t,$t]+"\\)$"),Qt=new RegExp("^rgb\\("+[Xt,Xt,Xt]+"\\)$"),te=new RegExp("^rgba\\("+[$t,$t,$t,Yt]+"\\)$"),ee=new RegExp("^rgba\\("+[Xt,Xt,Xt,Yt]+"\\)$"),ne=new RegExp("^hsl\\("+[Yt,Xt,Xt]+"\\)$"),ie=new RegExp("^hsla\\("+[Yt,Xt,Xt,Yt]+"\\)$"),re={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function oe(){return this.rgb().formatHex()}function se(){return this.rgb().formatRgb()}function ae(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=qt.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?le(e):3===n?new de(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?new de(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?new de(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Jt.exec(t))?new de(e[1],e[2],e[3],1):(e=Qt.exec(t))?new de(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=te.exec(t))?ce(e[1],e[2],e[3],e[4]):(e=ee.exec(t))?ce(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ne.exec(t))?me(e[1],e[2]/100,e[3]/100,1):(e=ie.exec(t))?me(e[1],e[2]/100,e[3]/100,e[4]):re.hasOwnProperty(t)?le(re[t]):"transparent"===t?new de(NaN,NaN,NaN,0):null}function le(t){return new de(t>>16&255,t>>8&255,255&t,1)}function ce(t,e,n,i){return i<=0&&(t=e=n=NaN),new de(t,e,n,i)}function ue(t){return t instanceof Wt||(t=ae(t)),t?new de((t=t.rgb()).r,t.g,t.b,t.opacity):new de}function he(t,e,n,i){return 1===arguments.length?ue(t):new de(t,e,n,null==i?1:i)}function de(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function fe(){return"#"+ge(this.r)+ge(this.g)+ge(this.b)}function pe(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function ge(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function me(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new be(t,e,n,i)}function ve(t){if(t instanceof be)return new be(t.h,t.s,t.l,t.opacity);if(t instanceof Wt||(t=ae(t)),!t)return new be;if(t instanceof be)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),s=NaN,a=o-r,l=(o+r)/2;return a?(s=e===o?(n-i)/a+6*(n<i):n===o?(i-e)/a+2:(e-n)/a+4,a/=l<.5?o+r:2-o-r,s*=60):a=l>0&&l<1?0:s,new be(s,a,l,t.opacity)}function ye(t,e,n,i){return 1===arguments.length?ve(t):new be(t,e,n,null==i?1:i)}function be(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Ce(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Ut(Wt,ae,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:oe,formatHex:oe,formatHsl:function(){return ve(this).formatHsl()},formatRgb:se,toString:se}),Ut(de,he,Zt(Wt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new de(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new de(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fe,formatHex:fe,formatRgb:pe,toString:pe})),Ut(be,ye,Zt(Wt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new be(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new be(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new de(Ce(t>=240?t-240:t+120,r,i),Ce(t,r,i),Ce(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Ie=Math.PI/180,Ee=180/Math.PI,Te=.96422,we=1,xe=.82521,_e=4/29,De=6/29,Ae=3*De*De,Oe=De*De*De;function Se(t){if(t instanceof ke)return new ke(t.l,t.a,t.b,t.opacity);if(t instanceof ze)return je(t);t instanceof de||(t=ue(t));var e,n,i=Le(t.r),r=Le(t.g),o=Le(t.b),s=Ne((.2225045*i+.7168786*r+.0606169*o)/we);return i===r&&r===o?e=n=s:(e=Ne((.4360747*i+.3850649*r+.1430804*o)/Te),n=Ne((.0139322*i+.0971045*r+.7141733*o)/xe)),new ke(116*s-16,500*(e-s),200*(s-n),t.opacity)}function Re(t,e,n,i){return 1===arguments.length?Se(t):new ke(t,e,n,null==i?1:i)}function ke(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}function Ne(t){return t>Oe?Math.pow(t,1/3):t/Ae+_e}function Me(t){return t>De?t*t*t:Ae*(t-_e)}function Pe(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Le(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ke(t){if(t instanceof ze)return new ze(t.h,t.c,t.l,t.opacity);if(t instanceof ke||(t=Se(t)),0===t.a&&0===t.b)return new ze(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Ee;return new ze(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Be(t,e,n,i){return 1===arguments.length?Ke(t):new ze(t,e,n,null==i?1:i)}function ze(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function je(t){if(isNaN(t.h))return new ke(t.l,0,0,t.opacity);var e=t.h*Ie;return new ke(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Ut(ke,Re,Zt(Wt,{brighter:function(t){return new ke(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new ke(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new de(Pe(3.1338561*(e=Te*Me(e))-1.6168667*(t=we*Me(t))-.4906146*(n=xe*Me(n))),Pe(-.9787684*e+1.9161415*t+.033454*n),Pe(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Ut(ze,Be,Zt(Wt,{brighter:function(t){return new ze(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new ze(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return je(this).rgb()}}));var Ge=-.14861,Fe=1.78277,Ve=-.29227,He=-.90649,Ue=1.97294,Ze=Ue*He,We=Ue*Fe,$e=Fe*Ve-He*Ge;function Ye(t,e,n,i){return 1===arguments.length?function(t){if(t instanceof Xe)return new Xe(t.h,t.s,t.l,t.opacity);t instanceof de||(t=ue(t));var e=t.r/255,n=t.g/255,i=t.b/255,r=($e*i+Ze*e-We*n)/($e+Ze-We),o=i-r,s=(Ue*(n-r)-Ve*o)/He,a=Math.sqrt(s*s+o*o)/(Ue*r*(1-r)),l=a?Math.atan2(s,o)*Ee-120:NaN;return new Xe(l<0?l+360:l,a,r,t.opacity)}(t):new Xe(t,e,n,null==i?1:i)}function Xe(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function qe(t,e,n,i,r){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*n+(1+3*t+3*o-3*s)*i+s*r)/6}function Je(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],o=t[i+1],s=i>0?t[i-1]:2*r-o,a=i<e-1?t[i+2]:2*o-r;return qe((n-i/e)*e,s,r,o,a)}}function Qe(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],o=t[i%e],s=t[(i+1)%e],a=t[(i+2)%e];return qe((n-i/e)*e,r,o,s,a)}}function tn(t){return function(){return t}}function en(t,e){return function(n){return t+n*e}}function nn(t,e){var n=e-t;return n?en(t,n>180||n<-180?n-360*Math.round(n/360):n):tn(isNaN(t)?e:t)}function rn(t,e){var n=e-t;return n?en(t,n):tn(isNaN(t)?e:t)}Ut(Xe,Ye,Zt(Wt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Xe(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Xe(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Ie,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),r=Math.sin(t);return new de(255*(e+n*(Ge*i+Fe*r)),255*(e+n*(Ve*i+He*r)),255*(e+n*(Ue*i)),this.opacity)}}));var on=function t(e){var n=function(t){return 1==(t=+t)?rn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):tn(isNaN(e)?n:e)}}(e);function i(t,e){var i=n((t=he(t)).r,(e=he(e)).r),r=n(t.g,e.g),o=n(t.b,e.b),s=rn(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=o(e),t.opacity=s(e),t+""}}return i.gamma=t,i}(1);function sn(t){return function(e){var n,i,r=e.length,o=new Array(r),s=new Array(r),a=new Array(r);for(n=0;n<r;++n)i=he(e[n]),o[n]=i.r||0,s[n]=i.g||0,a[n]=i.b||0;return o=t(o),s=t(s),a=t(a),i.opacity=1,function(t){return i.r=o(t),i.g=s(t),i.b=a(t),i+""}}}var an=sn(Je),ln=sn(Qe);function cn(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(o){for(n=0;n<i;++n)r[n]=t[n]*(1-o)+e[n]*o;return r}}function un(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function hn(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,o=new Array(r),s=new Array(i);for(n=0;n<r;++n)o[n]=yn(t[n],e[n]);for(;n<i;++n)s[n]=e[n];return function(t){for(n=0;n<r;++n)s[n]=o[n](t);return s}}function dn(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function fn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function pn(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=yn(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var gn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mn=new RegExp(gn.source,"g");function vn(t,e){var n,i,r,o=gn.lastIndex=mn.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(n=gn.exec(t))&&(i=mn.exec(e));)(r=i.index)>o&&(r=e.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:fn(n,i)})),o=mn.lastIndex;return o<e.length&&(r=e.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)a[(n=l[i]).i]=n.x(t);return a.join("")})}function yn(t,e){var n,i=typeof e;return null==e||"boolean"===i?tn(e):("number"===i?fn:"string"===i?(n=ae(e))?(e=n,on):vn:e instanceof ae?on:e instanceof Date?dn:un(e)?cn:Array.isArray(e)?hn:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?pn:fn)(t,e)}function bn(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Cn,In,En,Tn,wn=180/Math.PI,xn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _n(t,e,n,i,r,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),t*i<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*wn,skewX:Math.atan(l)*wn,scaleX:s,scaleY:a}}function Dn(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,i,r,o,s,a){if(t!==r||i!==o){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:fn(t,r)},{i:l-2,x:fn(i,o)})}else(r||o)&&s.push("translate("+r+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:fn(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(o.rotate,s.rotate,a,l),function(t,e,n,o){t!==e?o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:fn(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(o.skewX,s.skewX,a,l),function(t,e,n,i,o,s){if(t!==n||e!==i){var a=o.push(r(o)+"scale(",null,",",null,")");s.push({i:a-4,x:fn(t,n)},{i:a-2,x:fn(e,i)})}else 1===n&&1===i||o.push(r(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,n=-1,i=l.length;++n<i;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var An=Dn(function(t){return"none"===t?xn:(Cn||(Cn=document.createElement("DIV"),In=document.documentElement,En=document.defaultView),Cn.style.transform=t,t=En.getComputedStyle(In.appendChild(Cn),null).getPropertyValue("transform"),In.removeChild(Cn),_n(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),On=Dn(function(t){return null==t?xn:(Tn||(Tn=document.createElementNS("http://www.w3.org/2000/svg","g")),Tn.setAttribute("transform",t),(t=Tn.transform.baseVal.consolidate())?_n((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):xn)},", ",")",")"),Sn=Math.SQRT2;function Rn(t){return((t=Math.exp(t))+1/t)/2}function kn(t,e){var n,i,r=t[0],o=t[1],s=t[2],a=e[0],l=e[1],c=e[2],u=a-r,h=l-o,d=u*u+h*h;if(d<1e-12)i=Math.log(c/s)/Sn,n=function(t){return[r+t*u,o+t*h,s*Math.exp(Sn*t*i)]};else{var f=Math.sqrt(d),p=(c*c-s*s+4*d)/(2*s*2*f),g=(c*c-s*s-4*d)/(2*c*2*f),m=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(g*g+1)-g);i=(v-m)/Sn,n=function(t){var e=t*i,n=Rn(m),a=s/(2*f)*(n*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(Sn*e+m)-function(t){return((t=Math.exp(t))-1/t)/2}(m));return[r+a*u,o+a*h,s*n/Rn(Sn*e+m)]}}return n.duration=1e3*i,n}function Nn(t){return function(e,n){var i=t((e=ye(e)).h,(n=ye(n)).h),r=rn(e.s,n.s),o=rn(e.l,n.l),s=rn(e.opacity,n.opacity);return function(t){return e.h=i(t),e.s=r(t),e.l=o(t),e.opacity=s(t),e+""}}}var Mn=Nn(nn),Pn=Nn(rn);function Ln(t){return function(e,n){var i=t((e=Be(e)).h,(n=Be(n)).h),r=rn(e.c,n.c),o=rn(e.l,n.l),s=rn(e.opacity,n.opacity);return function(t){return e.h=i(t),e.c=r(t),e.l=o(t),e.opacity=s(t),e+""}}}var Kn=Ln(nn),Bn=Ln(rn);function zn(t){return function e(n){function i(e,i){var r=t((e=Ye(e)).h,(i=Ye(i)).h),o=rn(e.s,i.s),s=rn(e.l,i.l),a=rn(e.opacity,i.opacity);return function(t){return e.h=r(t),e.s=o(t),e.l=s(Math.pow(t,n)),e.opacity=a(t),e+""}}return n=+n,i.gamma=e,i}(1)}var jn,Gn,Fn=zn(nn),Vn=zn(rn),Hn=0,Un=0,Zn=0,Wn=1e3,$n=0,Yn=0,Xn=0,qn="object"==typeof performance&&performance.now?performance:Date,Jn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Qn(){return Yn||(Jn(ti),Yn=qn.now()+Xn)}function ti(){Yn=0}function ei(){this._call=this._time=this._next=null}function ni(t,e,n){var i=new ei;return i.restart(t,e,n),i}function ii(){Qn(),++Hn;for(var t,e=jn;e;)(t=Yn-e._time)>=0&&e._call.call(null,t),e=e._next;--Hn}function ri(){Yn=($n=qn.now())+Xn,Hn=Un=0;try{ii()}finally{Hn=0,function(){for(var t,e,n=jn,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:jn=e);Gn=t,si(i)}(),Yn=0}}function oi(){var t=qn.now(),e=t-$n;e>Wn&&(Xn-=e,$n=t)}function si(t){Hn||(Un&&(Un=clearTimeout(Un)),t-Yn>24?(t<1/0&&(Un=setTimeout(ri,t-qn.now()-Xn)),Zn&&(Zn=clearInterval(Zn))):(Zn||($n=qn.now(),Zn=setInterval(oi,Wn)),Hn=1,Jn(ri)))}function ai(t,e,n){var i=new ei;return e=null==e?0:+e,i.restart(function(n){i.stop(),t(n+e)},e,n),i}ei.prototype=ni.prototype={constructor:ei,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Qn():+n)+(null==e?0:+e),this._next||Gn===this||(Gn?Gn._next=this:jn=this,Gn=this),this._call=t,this._time=n,si()},stop:function(){this._call&&(this._call=null,this._time=1/0,si())}};var li=B("start","end","cancel","interrupt"),ci=[],ui=2,hi=3,di=5,fi=6;function pi(t,e,n,i,r,o){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function o(l){var c,u,h,d;if(1!==n.state)return a();for(c in r)if((d=r[c]).name===n.name){if(d.state===hi)return ai(o);4===d.state?(d.state=fi,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=fi,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(ai(function(){n.state===hi&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=ui,n.on.call("start",t,t.__data__,n.index,n.group),n.state===ui){for(n.state=hi,i=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=d);i.length=u+1}}function s(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=di,1),o=-1,s=i.length;++o<s;)i[o].call(t,r);n.state===di&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var i in n.state=fi,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=ni(function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)},0,n.time)}(t,n,{name:e,index:i,group:r,on:li,tween:ci,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function gi(t,e){var n=vi(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function mi(t,e){var n=vi(t,e);if(n.state>hi)throw new Error("too late; already running");return n}function vi(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function yi(t,e){var n,i,r,o=t.__transition,s=!0;if(o){for(r in e=null==e?null:e+"",o)(n=o[r]).name===e?(i=n.state>ui&&n.state<di,n.state=fi,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[r]):s=!1;s&&delete t.__transition}}function bi(t,e,n){var i=t._id;return t.each(function(){var t=mi(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return vi(t,i).value[e]}}function Ci(t,e){var n;return("number"==typeof e?fn:e instanceof ae?on:(n=ae(e))?(e=n,on):vn)(t,e)}var Ii=_t.prototype.constructor;function Ei(t){return function(){this.style.removeProperty(t)}}var Ti=0;function wi(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function xi(t){return _t().transition(t)}function _i(){return++Ti}var Di=_t.prototype;function Ai(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function Oi(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}wi.prototype=xi.prototype={constructor:wi,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=W(t));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a,l,c=i[s],u=c.length,h=o[s]=new Array(u),d=0;d<u;++d)(a=c[d])&&(l=t.call(a,a.__data__,d,c))&&("__data__"in a&&(l.__data__=a.__data__),h[d]=l,pi(h[d],e,n,d,h,vi(a,n)));return new wi(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Y(t));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var l,c=i[a],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,f=t.call(l,l.__data__,h,c),p=vi(l,n),g=0,m=f.length;g<m;++g)(d=f[g])&&pi(d,e,n,g,f,p);o.push(f),s.push(l)}return new wi(o,s,e,n)},filter:function(t){"function"!=typeof t&&(t=X(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s=e[r],a=s.length,l=i[r]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new wi(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var l,c=e[a],u=n[a],h=c.length,d=s[a]=new Array(h),f=0;f<h;++f)(l=c[f]||u[f])&&(d[f]=l);for(;a<i;++a)s[a]=e[a];return new wi(s,this._parents,this._name,this._id)},selection:function(){return new Ii(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=_i(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=vi(s,e);pi(s,t,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new wi(i,this._parents,t,n)},call:Di.call,nodes:Di.nodes,node:Di.node,size:Di.size,empty:Di.empty,each:Di.each,on:function(t,e){var n=this._id;return arguments.length<2?vi(this.node(),n).on.on(t):this.each(function(t,e,n){var i,r,o=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?gi:mi;return function(){var s=o(this,t),a=s.on;a!==i&&(r=(i=a).copy()).on(e,n),s.on=r}}(n,t,e))},attr:function(t,e){var n=H(t),i="transform"===n?On:Ci;return this.attrTween(t,"function"==typeof e?(n.local?function(t,e,n){var i,r,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===i&&a===r?o:(r=a,o=e(i=s,l));this.removeAttributeNS(t.space,t.local)}}:function(t,e,n){var i,r,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===i&&a===r?o:(r=a,o=e(i=s,l));this.removeAttribute(t)}})(n,i,bi(this,"attr."+t,e)):null==e?(n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(n):(n.local?function(t,e,n){var i,r,o=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===i?r:r=e(i=s,n)}}:function(t,e,n){var i,r,o=n+"";return function(){var s=this.getAttribute(t);return s===o?null:s===i?r:r=e(i=s,n)}})(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=H(t);return this.tween(n,(i.local?function(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,r)),n}return r._value=e,r}:function(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,r)),n}return r._value=e,r})(i,e))},style:function(t,e,n){var i="transform"==(t+="")?An:Ci;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var o=it(this,t),s=(this.style.removeProperty(t),it(this,t));return o===s?null:o===n&&s===i?r:r=e(n=o,i=s)}}(t,i)).on("end.style."+t,Ei(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,o;return function(){var s=it(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=it(this,t)),s===l?null:s===i&&l===r?o:(r=l,o=e(i=s,a))}}(t,i,bi(this,"style."+t,e))).each(function(t,e){var n,i,r,o,s="style."+e,a="end."+s;return function(){var l=mi(this,t),c=l.on,u=null==l.value[s]?o||(o=Ei(e)):void 0;c===n&&r===u||(i=(n=c).copy()).on(a,r=u),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,o=n+"";return function(){var s=it(this,t);return s===o?null:s===i?r:r=e(i=s,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,function(t,e,n){var i,r;function o(){var o=e.apply(this,arguments);return o!==r&&(i=(r=o)&&function(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}(t,o,n)),i}return o._value=e,o}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(bi(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&function(t){return function(e){this.textContent=t.call(this,e)}}(i)),e}return i._value=t,i}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=vi(this.node(),n).tween,o=0,s=r.length;o<s;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((null==e?function(t,e){var n,i;return function(){var r=mi(this,t),o=r.tween;if(o!==n)for(var s=0,a=(i=n=o).length;s<a;++s)if(i[s].name===e){(i=i.slice()).splice(s,1);break}r.tween=i}}:function(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var o=mi(this,t),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=a;break}l===c&&r.push(a)}o.tween=r}})(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){gi(this,t).delay=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){gi(this,t).delay=e}})(e,t)):vi(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){mi(this,t).duration=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){mi(this,t).duration=e}})(e,t)):vi(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){mi(this,t).ease=e}}(e,t)):vi(this.node(),e).ease},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(o,s){var a={value:s},l={value:function(){0==--r&&o()}};n.each(function(){var n=mi(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})})}};var Si=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(3),Ri=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),ki=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),Ni=Math.PI,Mi=Ni/2;function Pi(t){return(1-Math.cos(Ni*t))/2}function Li(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function Ki(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var Bi=4/11,zi=7.5625;function ji(t){return(t=+t)<Bi?zi*t*t:t<.7272727272727273?zi*(t-=.5454545454545454)*t+.75:t<.9090909090909091?zi*(t-=.8181818181818182)*t+.9375:zi*(t-=.9545454545454546)*t+.984375}var Gi=function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n}(1.70158),Fi=function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(1.70158),Vi=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(1.70158),Hi=2*Math.PI,Ui=function t(e,n){var i=Math.asin(1/(e=Math.max(1,e)))*(n/=Hi);function r(t){return e*Math.pow(2,10*--t)*Math.sin((i-t)/n)}return r.amplitude=function(e){return t(e,n*Hi)},r.period=function(n){return t(e,n)},r}(1,.3),Zi=function t(e,n){var i=Math.asin(1/(e=Math.max(1,e)))*(n/=Hi);function r(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+i)/n)}return r.amplitude=function(e){return t(e,n*Hi)},r.period=function(n){return t(e,n)},r}(1,.3),Wi=function t(e,n){var i=Math.asin(1/(e=Math.max(1,e)))*(n/=Hi);function r(t){return((t=2*t-1)<0?e*Math.pow(2,10*t)*Math.sin((i-t)/n):2-e*Math.pow(2,-10*t)*Math.sin((i+t)/n))/2}return r.amplitude=function(e){return t(e,n*Hi)},r.period=function(n){return t(e,n)},r}(1,.3),$i={time:null,delay:0,duration:250,ease:Oi};function Yi(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return $i.time=Qn(),$i;return n}_t.prototype.interrupt=function(t){return this.each(function(){yi(this,t)})},_t.prototype.transition=function(t){var e,n;t instanceof wi?(e=t._id,t=t._name):(e=_i(),(n=$i).time=Qn(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],l=a.length,c=0;c<l;++c)(s=a[c])&&pi(s,t,e,c,a,n||Yi(s,e));return new wi(i,this._parents,t,e)};var Xi=[null];function qi(t){return function(){return t}}function Ji(t,e,n){this.target=t,this.type=e,this.selection=n}function Qi(){t.event.stopImmediatePropagation()}function tr(){t.event.preventDefault(),t.event.stopImmediatePropagation()}var er={name:"drag"},nr={name:"space"},ir={name:"handle"},rr={name:"center"};function or(t){return[+t[0],+t[1]]}function sr(t){return[or(t[0]),or(t[1])]}var ar={name:"x",handles:["w","e"].map(gr),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},lr={name:"y",handles:["n","s"].map(gr),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},cr={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(gr),input:function(t){return null==t?null:sr(t)},output:function(t){return t}},ur={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},hr={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},dr={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},fr={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},pr={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function gr(t){return{type:t}}function mr(){return!t.event.ctrlKey&&!t.event.button}function vr(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function yr(){return navigator.maxTouchPoints||"ontouchstart"in this}function br(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Cr(e){var n,i=vr,r=mr,o=yr,s=!0,a=B("start","brush","end"),l=6;function c(t){var n=t.property("__brush",m).selectAll(".overlay").data([gr("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",ur.overlay).merge(n).each(function(){var t=br(this).extent;Dt(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),t.selectAll(".selection").data([gr("selection")]).enter().append("rect").attr("class","selection").attr("cursor",ur.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var i=t.selectAll(".handle").data(e.handles,function(t){return t.type});i.exit().remove(),i.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return ur[t.type]}),t.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",f).filter(o).on("touchstart.brush",f).on("touchmove.brush",p).on("touchend.brush touchcancel.brush",g).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function u(){var t=Dt(this),e=br(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?e[1][0]-l/2:e[0][0]-l/2}).attr("y",function(t){return"s"===t.type[0]?e[1][1]-l/2:e[0][1]-l/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+l:l}).attr("height",function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+l:l})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function h(t,e,n){return!n&&t.__brush.emitter||new d(t,e)}function d(t,e){this.that=t,this.args=e,this.state=t.__brush,this.active=0}function f(){if((!n||t.event.touches)&&r.apply(this,arguments)){var i,o,a,l,c,d,f,p,g,m,v,y,b=this,C=t.event.target.__data__.type,I="selection"===(s&&t.event.metaKey?C="overlay":C)?er:s&&t.event.altKey?rr:ir,E=e===lr?null:fr[C],T=e===ar?null:pr[C],w=br(b),x=w.extent,_=w.selection,D=x[0][0],A=x[0][1],O=x[1][0],S=x[1][1],R=0,k=0,N=E&&T&&s&&t.event.shiftKey,M=t.event.touches?(y=t.event.changedTouches[0].identifier,function(e){return Mt(e,t.event.touches,y)}):Nt,P=M(b),L=P,K=h(b,arguments,!0).beforestart();"overlay"===C?(_&&(g=!0),w.selection=_=[[i=e===lr?D:P[0],a=e===ar?A:P[1]],[c=e===lr?O:i,f=e===ar?S:a]]):(i=_[0][0],a=_[0][1],c=_[1][0],f=_[1][1]),o=i,l=a,d=c,p=f;var B=Dt(b).attr("pointer-events","none"),z=B.selectAll(".overlay").attr("cursor",ur[C]);if(t.event.touches)K.moved=G,K.ended=V;else{var j=Dt(t.event.view).on("mousemove.brush",G,!0).on("mouseup.brush",V,!0);s&&j.on("keydown.brush",function(){switch(t.event.keyCode){case 16:N=E&&T;break;case 18:I===ir&&(E&&(c=d-R*E,i=o+R*E),T&&(f=p-k*T,a=l+k*T),I=rr,F());break;case 32:I!==ir&&I!==rr||(E<0?c=d-R:E>0&&(i=o-R),T<0?f=p-k:T>0&&(a=l-k),I=nr,z.attr("cursor",ur.selection),F());break;default:return}tr()},!0).on("keyup.brush",function(){switch(t.event.keyCode){case 16:N&&(m=v=N=!1,F());break;case 18:I===rr&&(E<0?c=d:E>0&&(i=o),T<0?f=p:T>0&&(a=l),I=ir,F());break;case 32:I===nr&&(t.event.altKey?(E&&(c=d-R*E,i=o+R*E),T&&(f=p-k*T,a=l+k*T),I=rr):(E<0?c=d:E>0&&(i=o),T<0?f=p:T>0&&(a=l),I=ir),z.attr("cursor",ur[C]),F());break;default:return}tr()},!0),Kt(t.event.view)}Qi(),yi(b),u.call(b),K.start()}function G(){var t=M(b);!N||m||v||(Math.abs(t[0]-L[0])>Math.abs(t[1]-L[1])?v=!0:m=!0),L=t,g=!0,tr(),F()}function F(){var t;switch(R=L[0]-P[0],k=L[1]-P[1],I){case nr:case er:E&&(R=Math.max(D-i,Math.min(O-c,R)),o=i+R,d=c+R),T&&(k=Math.max(A-a,Math.min(S-f,k)),l=a+k,p=f+k);break;case ir:E<0?(R=Math.max(D-i,Math.min(O-i,R)),o=i+R,d=c):E>0&&(R=Math.max(D-c,Math.min(O-c,R)),o=i,d=c+R),T<0?(k=Math.max(A-a,Math.min(S-a,k)),l=a+k,p=f):T>0&&(k=Math.max(A-f,Math.min(S-f,k)),l=a,p=f+k);break;case rr:E&&(o=Math.max(D,Math.min(O,i-R*E)),d=Math.max(D,Math.min(O,c+R*E))),T&&(l=Math.max(A,Math.min(S,a-k*T)),p=Math.max(A,Math.min(S,f+k*T)))}d<o&&(E*=-1,t=i,i=c,c=t,t=o,o=d,d=t,C in hr&&z.attr("cursor",ur[C=hr[C]])),p<l&&(T*=-1,t=a,a=f,f=t,t=l,l=p,p=t,C in dr&&z.attr("cursor",ur[C=dr[C]])),w.selection&&(_=w.selection),m&&(o=_[0][0],d=_[1][0]),v&&(l=_[0][1],p=_[1][1]),_[0][0]===o&&_[0][1]===l&&_[1][0]===d&&_[1][1]===p||(w.selection=[[o,l],[d,p]],u.call(b),K.brush())}function V(){if(Qi(),t.event.touches){if(t.event.touches.length)return;n&&clearTimeout(n),n=setTimeout(function(){n=null},500)}else Bt(t.event.view,g),j.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);B.attr("pointer-events","all"),z.attr("cursor",ur.overlay),w.selection&&(_=w.selection),function(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}(_)&&(w.selection=null,u.call(b)),K.end()}}function p(){h(this,arguments).moved()}function g(){h(this,arguments).ended()}function m(){var t=this.__brush||{selection:null};return t.extent=sr(i.apply(this,arguments)),t.dim=e,t}return c.move=function(t,n){t.selection?t.on("start.brush",function(){h(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){h(this,arguments).end()}).tween("brush",function(){var t=this,i=t.__brush,r=h(t,arguments),o=i.selection,s=e.input("function"==typeof n?n.apply(this,arguments):n,i.extent),a=yn(o,s);function l(e){i.selection=1===e&&null===s?null:a(e),u.call(t),r.brush()}return null!==o&&null!==s?l:l(1)}):t.each(function(){var t=this,i=arguments,r=t.__brush,o=e.input("function"==typeof n?n.apply(t,i):n,r.extent),s=h(t,i).beforestart();yi(t),r.selection=null===o?null:o,u.call(t),s.start().brush().end()})},c.clear=function(t){c.move(t,null)},d.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(t){Et(new Ji(c,t,e.output(this.state.selection)),a.apply,a,[t,this.that,this.args])}},c.extent=function(t){return arguments.length?(i="function"==typeof t?t:qi(sr(t)),c):i},c.filter=function(t){return arguments.length?(r="function"==typeof t?t:qi(!!t),c):r},c.touchable=function(t){return arguments.length?(o="function"==typeof t?t:qi(!!t),c):o},c.handleSize=function(t){return arguments.length?(l=+t,c):l},c.keyModifiers=function(t){return arguments.length?(s=!!t,c):s},c.on=function(){var t=a.on.apply(a,arguments);return t===a?c:t},c}var Ir=Math.cos,Er=Math.sin,Tr=Math.PI,wr=Tr/2,xr=2*Tr,_r=Math.max;var Dr=Array.prototype.slice;function Ar(t){return function(){return t}}var Or=Math.PI,Sr=2*Or,Rr=Sr-1e-6;function kr(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Nr(){return new kr}function Mr(t){return t.source}function Pr(t){return t.target}function Lr(t){return t.radius}function Kr(t){return t.startAngle}function Br(t){return t.endAngle}function zr(){}function jr(t,e){var n=new zr;if(t instanceof zr)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var i,r=-1,o=t.length;if(null==e)for(;++r<o;)n.set(r,t[r]);else for(;++r<o;)n.set(e(i=t[r],r,t),i)}else if(t)for(var s in t)n.set(s,t[s]);return n}function Gr(){return{}}function Fr(t,e,n){t[e]=n}function Vr(){return jr()}function Hr(t,e,n){t.set(e,n)}function Ur(){}kr.prototype=Nr.prototype={constructor:kr,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var o=this._x1,s=this._y1,a=n-t,l=i-e,c=o-t,u=s-e,h=c*c+u*u;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>1e-6)if(Math.abs(u*a-l*c)>1e-6&&r){var d=n-o,f=i-s,p=a*a+l*l,g=d*d+f*f,m=Math.sqrt(p),v=Math.sqrt(h),y=r*Math.tan((Or-Math.acos((p+h-g)/(2*m*v)))/2),b=y/v,C=y/m;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*c)+","+(e+b*u)),this._+="A"+r+","+r+",0,0,"+ +(u*d>c*f)+","+(this._x1=t+C*a)+","+(this._y1=e+C*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,i,r,o){t=+t,e=+e,o=!!o;var s=(n=+n)*Math.cos(i),a=n*Math.sin(i),l=t+s,c=e+a,u=1^o,h=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+l+","+c),n&&(h<0&&(h=h%Sr+Sr),h>Rr?this._+="A"+n+","+n+",0,1,"+u+","+(t-s)+","+(e-a)+"A"+n+","+n+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=Or)+","+u+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}},zr.prototype=jr.prototype={constructor:zr,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var Zr=jr.prototype;function Wr(t,e){var n=new Ur;if(t instanceof Ur)t.each(function(t){n.add(t)});else if(t){var i=-1,r=t.length;if(null==e)for(;++i<r;)n.add(t[i]);else for(;++i<r;)n.add(e(t[i],i,t))}return n}Ur.prototype=Wr.prototype={constructor:Ur,has:Zr.has,add:function(t){return this["$"+(t+="")]=t,this},remove:Zr.remove,clear:Zr.clear,values:Zr.keys,size:Zr.size,empty:Zr.empty,each:Zr.each};var $r=Array.prototype.slice;function Yr(t,e){return t-e}function Xr(t){return function(){return t}}function qr(t,e){for(var n,i=-1,r=e.length;++i<r;)if(n=Jr(t,e[i]))return n;return 0}function Jr(t,e){for(var n=e[0],i=e[1],r=-1,o=0,s=t.length,a=s-1;o<s;a=o++){var l=t[o],c=l[0],u=l[1],h=t[a],d=h[0],f=h[1];if(Qr(l,h,e))return 0;u>i!=f>i&&n<(d-c)*(i-u)/(f-u)+c&&(r=-r)}return r}function Qr(t,e,n){var i,r,o,s;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(r=t[i=+(t[0]===e[0])],o=n[i],s=e[i],r<=o&&o<=s||s<=o&&o<=r)}function to(){}var eo=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function no(){var t=1,e=1,n=T,i=a;function r(t){var e=n(t);if(Array.isArray(e))e=e.slice().sort(Yr);else{var i=u(t),r=i[0],s=i[1];e=E(r,s,e),e=m(Math.floor(r/e)*e,Math.floor(s/e)*e,e)}return e.map(function(e){return o(t,e)})}function o(n,r){var o=[],a=[];return function(n,i,r){var o,a,l,c,u,h,d=new Array,f=new Array;for(o=a=-1,c=n[0]>=i,eo[c<<1].forEach(p);++o<t-1;)l=c,c=n[o+1]>=i,eo[l|c<<1].forEach(p);for(eo[c<<0].forEach(p);++a<e-1;){for(o=-1,c=n[a*t+t]>=i,u=n[a*t]>=i,eo[c<<1|u<<2].forEach(p);++o<t-1;)l=c,c=n[a*t+t+o+1]>=i,h=u,u=n[a*t+o+1]>=i,eo[l|c<<1|u<<2|h<<3].forEach(p);eo[c|u<<3].forEach(p)}for(o=-1,u=n[a*t]>=i,eo[u<<2].forEach(p);++o<t-1;)h=u,u=n[a*t+o+1]>=i,eo[u<<2|h<<3].forEach(p);function p(t){var e,n,i=[t[0][0]+o,t[0][1]+a],l=[t[1][0]+o,t[1][1]+a],c=s(i),u=s(l);(e=f[c])?(n=d[u])?(delete f[e.end],delete d[n.start],e===n?(e.ring.push(l),r(e.ring)):d[e.start]=f[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete f[e.end],e.ring.push(l),f[e.end=u]=e):(e=d[u])?(n=f[c])?(delete d[e.start],delete f[n.end],e===n?(e.ring.push(l),r(e.ring)):d[n.start]=f[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[e.start],e.ring.unshift(i),d[e.start=c]=e):d[c]=f[u]={start:c,end:u,ring:[i,l]}}eo[u<<3].forEach(p)}(n,r,function(t){i(t,n,r),function(t){for(var e=0,n=t.length,i=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)i+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return i}(t)>0?o.push([t]):a.push(t)}),a.forEach(function(t){for(var e,n=0,i=o.length;n<i;++n)if(-1!==qr((e=o[n])[0],t))return void e.push(t)}),{type:"MultiPolygon",value:r,coordinates:o}}function s(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,i,r){n.forEach(function(n){var o,s=n[0],a=n[1],l=0|s,c=0|a,u=i[c*t+l];s>0&&s<t&&l===s&&(o=i[c*t+l-1],n[0]=s+(r-o)/(u-o)-.5),a>0&&a<e&&c===a&&(o=i[(c-1)*t+l],n[1]=a+(r-o)/(u-o)-.5)})}return r.contour=o,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.ceil(n[0]),o=Math.ceil(n[1]);if(!(i>0&&o>0))throw new Error("invalid size");return t=i,e=o,r},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?Xr($r.call(t)):Xr(t),r):n},r.smooth=function(t){return arguments.length?(i=t?a:to,r):i===a},r}function io(t,e,n){for(var i=t.width,r=t.height,o=1+(n<<1),s=0;s<r;++s)for(var a=0,l=0;a<i+n;++a)a<i&&(l+=t.data[a+s*i]),a>=n&&(a>=o&&(l-=t.data[a-o+s*i]),e.data[a-n+s*i]=l/Math.min(a+1,i-1+o-a,o))}function ro(t,e,n){for(var i=t.width,r=t.height,o=1+(n<<1),s=0;s<i;++s)for(var a=0,l=0;a<r+n;++a)a<r&&(l+=t.data[s+a*i]),a>=n&&(a>=o&&(l-=t.data[s+(a-o)*i]),e.data[s+(a-n)*i]=l/Math.min(a+1,r-1+o-a,o))}function oo(t){return t[0]}function so(t){return t[1]}function ao(){return 1}var lo={},co={};function uo(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'}).join(",")+"}")}function ho(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var i in t)i in e||n.push(e[i]=i)}),n}function fo(t,e){var n=t+"",i=n.length;return i<e?new Array(e-i+1).join(0)+n:n}function po(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function i(t,e){var i,r=[],o=t.length,s=0,a=0,l=o<=0,c=!1;function u(){if(l)return co;if(c)return c=!1,lo;var e,i,r=s;if(34===t.charCodeAt(r)){for(;s++<o&&34!==t.charCodeAt(s)||34===t.charCodeAt(++s););return(e=s)>=o?l=!0:10===(i=t.charCodeAt(s++))?c=!0:13===i&&(c=!0,10===t.charCodeAt(s)&&++s),t.slice(r+1,e-1).replace(/""/g,'"')}for(;s<o;){if(10===(i=t.charCodeAt(e=s++)))c=!0;else if(13===i)c=!0,10===t.charCodeAt(s)&&++s;else if(i!==n)continue;return t.slice(r,e)}return l=!0,t.slice(r,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(i=u())!==co;){for(var h=[];i!==lo&&i!==co;)h.push(i),i=u();e&&null==(h=e(h,a++))||r.push(h)}return r}function r(e,n){return e.map(function(e){return n.map(function(t){return s(e[t])}).join(t)})}function o(e){return e.map(s).join(t)}function s(t){return null==t?"":t instanceof Date?function(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),i=t.getUTCSeconds(),r=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":function(t){return t<0?"-"+fo(-t,6):t>9999?"+"+fo(t,6):fo(t,4)}(t.getUTCFullYear())+"-"+fo(t.getUTCMonth()+1,2)+"-"+fo(t.getUTCDate(),2)+(r?"T"+fo(e,2)+":"+fo(n,2)+":"+fo(i,2)+"."+fo(r,3)+"Z":i?"T"+fo(e,2)+":"+fo(n,2)+":"+fo(i,2)+"Z":n||e?"T"+fo(e,2)+":"+fo(n,2)+"Z":"")}(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,r,o=i(t,function(t,i){if(n)return n(t,i-1);r=t,n=e?function(t,e){var n=uo(t);return function(i,r){return e(n(i),r,t)}}(t,e):uo(t)});return o.columns=r||[],o},parseRows:i,format:function(e,n){return null==n&&(n=ho(e)),[n.map(s).join(t)].concat(r(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=ho(t)),r(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:s}}var go=po(","),mo=go.parse,vo=go.parseRows,yo=go.format,bo=go.formatBody,Co=go.formatRows,Io=go.formatRow,Eo=go.formatValue,To=po("\t"),wo=To.parse,xo=To.parseRows,_o=To.format,Do=To.formatBody,Ao=To.formatRows,Oo=To.formatRow,So=To.formatValue,Ro=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function ko(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}function No(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}function Mo(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Po(t,e){return fetch(t,e).then(Mo)}function Lo(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=void 0),Po(e,n).then(function(e){return t(e,i)})}}var Ko=Lo(mo),Bo=Lo(wo);function zo(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.json()}function jo(t){return function(e,n){return Po(e,n).then(function(e){return(new DOMParser).parseFromString(e,t)})}}var Go=jo("application/xml"),Fo=jo("text/html"),Vo=jo("image/svg+xml");function Ho(t){return function(){return t}}function Uo(){return 1e-6*(Math.random()-.5)}function Zo(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,o,s,a,l,c,u,h,d,f=t._root,p={data:i},g=t._x0,m=t._y0,v=t._x1,y=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((c=e>=(o=(g+v)/2))?g=o:v=o,(u=n>=(s=(m+y)/2))?m=s:y=s,r=f,!(f=f[h=u<<1|c]))return r[h]=p,t;if(a=+t._x.call(null,f.data),l=+t._y.call(null,f.data),e===a&&n===l)return p.next=f,r?r[h]=p:t._root=p,t;do{r=r?r[h]=new Array(4):t._root=new Array(4),(c=e>=(o=(g+v)/2))?g=o:v=o,(u=n>=(s=(m+y)/2))?m=s:y=s}while((h=u<<1|c)==(d=(l>=s)<<1|a>=o));return r[d]=f,r[h]=p,t}function Wo(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function $o(t){return t[0]}function Yo(t){return t[1]}function Xo(t,e,n){var i=new qo(null==e?$o:e,null==n?Yo:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function qo(t,e,n,i,r,o){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function Jo(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Qo=Xo.prototype=qo.prototype;function ts(t){return t.x+t.vx}function es(t){return t.y+t.vy}function ns(t){return t.index}function is(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function rs(t){return t.x}function os(t){return t.y}Qo.copy=function(){var t,e,n=new qo(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=Jo(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=Jo(e));return n},Qo.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return Zo(this.cover(e,n),e,n,t)},Qo.addAll=function(t){var e,n,i,r,o=t.length,s=new Array(o),a=new Array(o),l=1/0,c=1/0,u=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(r=+this._y.call(null,e))||(s[n]=i,a[n]=r,i<l&&(l=i),i>u&&(u=i),r<c&&(c=r),r>h&&(h=r));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),n=0;n<o;++n)Zo(this,s[n],a[n],t[n]);return this},Qo.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,o=(i=Math.floor(e))+1;else{for(var s,a,l=r-n,c=this._root;n>t||t>=r||i>e||e>=o;)switch(a=(e<i)<<1|t<n,(s=new Array(4))[a]=c,c=s,l*=2,a){case 0:r=n+l,o=i+l;break;case 1:n=r-l,o=i+l;break;case 2:r=n+l,i=o-l;break;case 3:n=r-l,i=o-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this},Qo.data=function(){var t=[];return this.visit(function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}),t},Qo.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Qo.find=function(t,e,n){var i,r,o,s,a,l,c,u=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],g=this._root;for(g&&p.push(new Wo(g,u,h,d,f)),null==n?n=1/0:(u=t-n,h=e-n,d=t+n,f=e+n,n*=n);l=p.pop();)if(!(!(g=l.node)||(r=l.x0)>d||(o=l.y0)>f||(s=l.x1)<u||(a=l.y1)<h))if(g.length){var m=(r+s)/2,v=(o+a)/2;p.push(new Wo(g[3],m,v,s,a),new Wo(g[2],r,v,m,a),new Wo(g[1],m,o,s,v),new Wo(g[0],r,o,m,v)),(c=(e>=v)<<1|t>=m)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=l)}else{var y=t-+this._x.call(null,g.data),b=e-+this._y.call(null,g.data),C=y*y+b*b;if(C<n){var I=Math.sqrt(n=C);u=t-I,h=e-I,d=t+I,f=e+I,i=g.data}}return i},Qo.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(s=+this._y.call(null,t)))return this;var e,n,i,r,o,s,a,l,c,u,h,d,f=this._root,p=this._x0,g=this._y0,m=this._x1,v=this._y1;if(!f)return this;if(f.length)for(;;){if((c=o>=(a=(p+m)/2))?p=a:m=a,(u=s>=(l=(g+v)/2))?g=l:v=l,e=f,!(f=f[h=u<<1|c]))return this;if(!f.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;f.data!==t;)if(i=f,!(f=f.next))return this;return(r=f.next)&&delete f.next,i?(r?i.next=r:delete i.next,this):e?(r?e[h]=r:delete e[h],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=r,this)},Qo.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Qo.root=function(){return this._root},Qo.size=function(){var t=0;return this.visit(function(e){if(!e.length)do{++t}while(e=e.next)}),t},Qo.visit=function(t){var e,n,i,r,o,s,a=[],l=this._root;for(l&&a.push(new Wo(l,this._x0,this._y0,this._x1,this._y1));e=a.pop();)if(!t(l=e.node,i=e.x0,r=e.y0,o=e.x1,s=e.y1)&&l.length){var c=(i+o)/2,u=(r+s)/2;(n=l[3])&&a.push(new Wo(n,c,u,o,s)),(n=l[2])&&a.push(new Wo(n,i,u,c,s)),(n=l[1])&&a.push(new Wo(n,c,r,o,u)),(n=l[0])&&a.push(new Wo(n,i,r,c,u))}return this},Qo.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new Wo(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r=e.node;if(r.length){var o,s=e.x0,a=e.y0,l=e.x1,c=e.y1,u=(s+l)/2,h=(a+c)/2;(o=r[0])&&n.push(new Wo(o,s,a,u,h)),(o=r[1])&&n.push(new Wo(o,u,a,l,h)),(o=r[2])&&n.push(new Wo(o,s,h,u,c)),(o=r[3])&&n.push(new Wo(o,u,h,l,c))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Qo.x=function(t){return arguments.length?(this._x=t,this):this._x},Qo.y=function(t){return arguments.length?(this._y=t,this):this._y};var ss=Math.PI*(3-Math.sqrt(5));function as(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function ls(t){return(t=as(Math.abs(t)))?t[1]:NaN}var cs,us=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function hs(t){if(!(e=us.exec(t)))throw new Error("invalid format: "+t);var e;return new ds({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function ds(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function fs(t,e){var n=as(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}hs.prototype=ds.prototype,ds.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var ps={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return fs(100*t,e)},r:fs,s:function(t,e){var n=as(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(cs=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+as(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function gs(t){return t}var ms,vs=Array.prototype.map,ys=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function bs(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?gs:(e=vs.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,o=[],s=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),o.push(t.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[s=(s+1)%e.length];return o.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?gs:function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(vs.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"-":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=hs(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,m=t.precision,v=t.trim,y=t.type;"n"===y?(g=!0,y="g"):ps[y]||(void 0===m&&(m=12),v=!0,y="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?r:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",C="$"===d?o:/[%p]/.test(y)?l:"",I=ps[y],E=/[defgprs%]/.test(y);function T(t){var r,o,l,d=b,T=C;if("c"===y)T=I(t)+T,t="";else{var w=(t=+t)<0;if(t=isNaN(t)?u:I(Math.abs(t),m),v&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),w&&0==+t&&(w=!1),d=(w?"("===h?h:c:"-"===h||"("===h?"":h)+d,T=("s"===y?ys[8+cs/3]:"")+T+(w&&"("===h?")":""),E)for(r=-1,o=t.length;++r<o;)if(48>(l=t.charCodeAt(r))||l>57){T=(46===l?s+t.slice(r+1):t.slice(r))+T,t=t.slice(0,r);break}}g&&!f&&(t=i(t,1/0));var x=d.length+t.length+T.length,_=x<p?new Array(p-x+1).join(e):"";switch(g&&f&&(t=i(_+t,_.length?p-T.length:1/0),_=""),n){case"<":t=d+t+T+_;break;case"=":t=d+_+t+T;break;case"^":t=_.slice(0,x=_.length>>1)+d+t+T+_.slice(x);break;default:t=_+d+t+T}return a(t)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),T.toString=function(){return t+""},T}return{format:h,formatPrefix:function(t,e){var n=h(((t=hs(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(ls(e)/3))),r=Math.pow(10,-i),o=ys[8+i/3];return function(t){return n(r*t)+o}}}}function Cs(e){return ms=bs(e),t.format=ms.format,t.formatPrefix=ms.formatPrefix,ms}function Is(t){return Math.max(0,-ls(Math.abs(t)))}function Es(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ls(e)/3)))-ls(Math.abs(t)))}function Ts(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ls(e)-ls(t))+1}function ws(){return new xs}function xs(){this.reset()}Cs({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),xs.prototype={constructor:xs,reset:function(){this.s=this.t=0},add:function(t){Ds(_s,t,this.t),Ds(this,_s.s,this.s),this.s?this.t+=_s.t:this.s=_s.t},valueOf:function(){return this.s}};var _s=new xs;function Ds(t,e,n){var i=t.s=e+n,r=i-e,o=i-r;t.t=e-o+(n-r)}var As=1e-6,Os=1e-12,Ss=Math.PI,Rs=Ss/2,ks=Ss/4,Ns=2*Ss,Ms=180/Ss,Ps=Ss/180,Ls=Math.abs,Ks=Math.atan,Bs=Math.atan2,zs=Math.cos,js=Math.ceil,Gs=Math.exp,Fs=Math.log,Vs=Math.pow,Hs=Math.sin,Us=Math.sign||function(t){return t>0?1:t<0?-1:0},Zs=Math.sqrt,Ws=Math.tan;function $s(t){return t>1?0:t<-1?Ss:Math.acos(t)}function Ys(t){return t>1?Rs:t<-1?-Rs:Math.asin(t)}function Xs(t){return(t=Hs(t/2))*t}function qs(){}function Js(t,e){t&&ta.hasOwnProperty(t.type)&&ta[t.type](t,e)}var Qs={Feature:function(t,e){Js(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)Js(n[i].geometry,e)}},ta={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){ea(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)ea(n[i],e,0)},Polygon:function(t,e){na(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)na(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)Js(n[i],e)}};function ea(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function na(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)ea(t[n],e,1);e.polygonEnd()}function ia(t,e){t&&Qs.hasOwnProperty(t.type)?Qs[t.type](t,e):Js(t,e)}var ra,oa,sa,aa,la,ca=ws(),ua=ws(),ha={point:qs,lineStart:qs,lineEnd:qs,polygonStart:function(){ca.reset(),ha.lineStart=da,ha.lineEnd=fa},polygonEnd:function(){var t=+ca;ua.add(t<0?Ns+t:t),this.lineStart=this.lineEnd=this.point=qs},sphere:function(){ua.add(Ns)}};function da(){ha.point=pa}function fa(){ga(ra,oa)}function pa(t,e){ha.point=ga,ra=t,oa=e,sa=t*=Ps,aa=zs(e=(e*=Ps)/2+ks),la=Hs(e)}function ga(t,e){var n=(t*=Ps)-sa,i=n>=0?1:-1,r=i*n,o=zs(e=(e*=Ps)/2+ks),s=Hs(e),a=la*s,l=aa*o+a*zs(r),c=a*i*Hs(r);ca.add(Bs(c,l)),sa=t,aa=o,la=s}function ma(t){return[Bs(t[1],t[0]),Ys(t[2])]}function va(t){var e=t[0],n=t[1],i=zs(n);return[i*zs(e),i*Hs(e),Hs(n)]}function ya(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ba(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Ca(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ia(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Ea(t){var e=Zs(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var Ta,wa,xa,_a,Da,Aa,Oa,Sa,Ra,ka,Na,Ma,Pa,La,Ka,Ba,za,ja,Ga,Fa,Va,Ha,Ua,Za,Wa,$a,Ya=ws(),Xa={point:qa,lineStart:Qa,lineEnd:tl,polygonStart:function(){Xa.point=el,Xa.lineStart=nl,Xa.lineEnd=il,Ya.reset(),ha.polygonStart()},polygonEnd:function(){ha.polygonEnd(),Xa.point=qa,Xa.lineStart=Qa,Xa.lineEnd=tl,ca<0?(Ta=-(xa=180),wa=-(_a=90)):Ya>As?_a=90:Ya<-As&&(wa=-90),ka[0]=Ta,ka[1]=xa},sphere:function(){Ta=-(xa=180),wa=-(_a=90)}};function qa(t,e){Ra.push(ka=[Ta=t,xa=t]),e<wa&&(wa=e),e>_a&&(_a=e)}function Ja(t,e){var n=va([t*Ps,e*Ps]);if(Sa){var i=ba(Sa,n),r=ba([i[1],-i[0],0],i);Ea(r),r=ma(r);var o,s=t-Da,a=s>0?1:-1,l=r[0]*Ms*a,c=Ls(s)>180;c^(a*Da<l&&l<a*t)?(o=r[1]*Ms)>_a&&(_a=o):c^(a*Da<(l=(l+360)%360-180)&&l<a*t)?(o=-r[1]*Ms)<wa&&(wa=o):(e<wa&&(wa=e),e>_a&&(_a=e)),c?t<Da?rl(Ta,t)>rl(Ta,xa)&&(xa=t):rl(t,xa)>rl(Ta,xa)&&(Ta=t):xa>=Ta?(t<Ta&&(Ta=t),t>xa&&(xa=t)):t>Da?rl(Ta,t)>rl(Ta,xa)&&(xa=t):rl(t,xa)>rl(Ta,xa)&&(Ta=t)}else Ra.push(ka=[Ta=t,xa=t]);e<wa&&(wa=e),e>_a&&(_a=e),Sa=n,Da=t}function Qa(){Xa.point=Ja}function tl(){ka[0]=Ta,ka[1]=xa,Xa.point=qa,Sa=null}function el(t,e){if(Sa){var n=t-Da;Ya.add(Ls(n)>180?n+(n>0?360:-360):n)}else Aa=t,Oa=e;ha.point(t,e),Ja(t,e)}function nl(){ha.lineStart()}function il(){el(Aa,Oa),ha.lineEnd(),Ls(Ya)>As&&(Ta=-(xa=180)),ka[0]=Ta,ka[1]=xa,Sa=null}function rl(t,e){return(e-=t)<0?e+360:e}function ol(t,e){return t[0]-e[0]}function sl(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var al={sphere:qs,point:ll,lineStart:ul,lineEnd:fl,polygonStart:function(){al.lineStart=pl,al.lineEnd=gl},polygonEnd:function(){al.lineStart=ul,al.lineEnd=fl}};function ll(t,e){t*=Ps;var n=zs(e*=Ps);cl(n*zs(t),n*Hs(t),Hs(e))}function cl(t,e,n){Pa+=(t-Pa)/++Na,La+=(e-La)/Na,Ka+=(n-Ka)/Na}function ul(){al.point=hl}function hl(t,e){t*=Ps;var n=zs(e*=Ps);Za=n*zs(t),Wa=n*Hs(t),$a=Hs(e),al.point=dl,cl(Za,Wa,$a)}function dl(t,e){t*=Ps;var n=zs(e*=Ps),i=n*zs(t),r=n*Hs(t),o=Hs(e),s=Bs(Zs((s=Wa*o-$a*r)*s+(s=$a*i-Za*o)*s+(s=Za*r-Wa*i)*s),Za*i+Wa*r+$a*o);Ma+=s,Ba+=s*(Za+(Za=i)),za+=s*(Wa+(Wa=r)),ja+=s*($a+($a=o)),cl(Za,Wa,$a)}function fl(){al.point=ll}function pl(){al.point=ml}function gl(){vl(Ha,Ua),al.point=ll}function ml(t,e){Ha=t,Ua=e,t*=Ps,e*=Ps,al.point=vl;var n=zs(e);Za=n*zs(t),Wa=n*Hs(t),$a=Hs(e),cl(Za,Wa,$a)}function vl(t,e){t*=Ps;var n=zs(e*=Ps),i=n*zs(t),r=n*Hs(t),o=Hs(e),s=Wa*o-$a*r,a=$a*i-Za*o,l=Za*r-Wa*i,c=Zs(s*s+a*a+l*l),u=Ys(c),h=c&&-u/c;Ga+=h*s,Fa+=h*a,Va+=h*l,Ma+=u,Ba+=u*(Za+(Za=i)),za+=u*(Wa+(Wa=r)),ja+=u*($a+($a=o)),cl(Za,Wa,$a)}function yl(t){return function(){return t}}function bl(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function Cl(t,e){return[Ls(t)>Ss?t+Math.round(-t/Ns)*Ns:t,e]}function Il(t,e,n){return(t%=Ns)?e||n?bl(Tl(t),wl(e,n)):Tl(t):e||n?wl(e,n):Cl}function El(t){return function(e,n){return[(e+=t)>Ss?e-Ns:e<-Ss?e+Ns:e,n]}}function Tl(t){var e=El(t);return e.invert=El(-t),e}function wl(t,e){var n=zs(t),i=Hs(t),r=zs(e),o=Hs(e);function s(t,e){var s=zs(e),a=zs(t)*s,l=Hs(t)*s,c=Hs(e),u=c*n+a*i;return[Bs(l*r-u*o,a*n-c*i),Ys(u*r+l*o)]}return s.invert=function(t,e){var s=zs(e),a=zs(t)*s,l=Hs(t)*s,c=Hs(e),u=c*r-l*o;return[Bs(l*r+c*o,a*n+u*i),Ys(u*n-a*i)]},s}function xl(t){function e(e){return(e=t(e[0]*Ps,e[1]*Ps))[0]*=Ms,e[1]*=Ms,e}return t=Il(t[0]*Ps,t[1]*Ps,t.length>2?t[2]*Ps:0),e.invert=function(e){return(e=t.invert(e[0]*Ps,e[1]*Ps))[0]*=Ms,e[1]*=Ms,e},e}function _l(t,e,n,i,r,o){if(n){var s=zs(e),a=Hs(e),l=i*n;null==r?(r=e+i*Ns,o=e-l/2):(r=Dl(s,r),o=Dl(s,o),(i>0?r<o:r>o)&&(r+=i*Ns));for(var c,u=r;i>0?u>o:u<o;u-=l)c=ma([s,-a*zs(u),-a*Hs(u)]),t.point(c[0],c[1])}}function Dl(t,e){(e=va(e))[0]-=t,Ea(e);var n=$s(-e[1]);return((-e[2]<0?-n:n)+Ns-As)%Ns}function Al(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:qs,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Ol(t,e){return Ls(t[0]-e[0])<As&&Ls(t[1]-e[1])<As}function Sl(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Rl(t,e,n,i,r){var o,s,a=[],l=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],s=t[e];if(Ol(i,s)){for(r.lineStart(),o=0;o<e;++o)r.point((i=t[o])[0],i[1]);r.lineEnd()}else a.push(n=new Sl(i,t,null,!0)),l.push(n.o=new Sl(i,null,n,!1)),a.push(n=new Sl(s,t,null,!1)),l.push(n.o=new Sl(s,null,n,!0))}}),a.length){for(l.sort(e),kl(a),kl(l),o=0,s=l.length;o<s;++o)l[o].e=n=!n;for(var c,u,h=a[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(o=0,s=c.length;o<s;++o)r.point((u=c[o])[0],u[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(f)for(c=d.p.z,o=c.length-1;o>=0;--o)r.point((u=c[o])[0],u[1]);else i(d.x,d.p.x,-1,r);d=d.p}c=(d=d.o).z,f=!f}while(!d.v);r.lineEnd()}}}function kl(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}Cl.invert=Cl;var Nl=ws();function Ml(t){return Ls(t[0])<=Ss?t[0]:Us(t[0])*((Ls(t[0])+Ss)%Ns-Ss)}function Pl(t,e){var n=Ml(e),i=e[1],r=Hs(i),o=[Hs(n),-zs(n),0],s=0,a=0;Nl.reset(),1===r?i=Rs+As:-1===r&&(i=-Rs-As);for(var l=0,c=t.length;l<c;++l)if(h=(u=t[l]).length)for(var u,h,d=u[h-1],f=Ml(d),p=d[1]/2+ks,g=Hs(p),m=zs(p),v=0;v<h;++v,f=b,g=I,m=E,d=y){var y=u[v],b=Ml(y),C=y[1]/2+ks,I=Hs(C),E=zs(C),T=b-f,w=T>=0?1:-1,x=w*T,_=x>Ss,D=g*I;if(Nl.add(Bs(D*w*Hs(x),m*E+D*zs(x))),s+=_?T+w*Ns:T,_^f>=n^b>=n){var A=ba(va(d),va(y));Ea(A);var O=ba(o,A);Ea(O);var S=(_^T>=0?-1:1)*Ys(O[2]);(i>S||i===S&&(A[0]||A[1]))&&(a+=_^T>=0?1:-1)}}return(s<-As||s<As&&Nl<-As)^1&a}function Ll(t,e,n,i){return function(r){var o,s,a,l=e(r),c=Al(),u=e(c),h=!1,d={point:f,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=y,d.lineEnd=b,s=[],o=[]},polygonEnd:function(){d.point=f,d.lineStart=g,d.lineEnd=m,s=_(s);var t=Pl(o,i);s.length?(h||(r.polygonStart(),h=!0),Rl(s,Bl,t,n,r)):t&&(h||(r.polygonStart(),h=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),h&&(r.polygonEnd(),h=!1),s=o=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function f(e,n){t(e,n)&&r.point(e,n)}function p(t,e){l.point(t,e)}function g(){d.point=p,l.lineStart()}function m(){d.point=f,l.lineEnd()}function v(t,e){a.push([t,e]),u.point(t,e)}function y(){u.lineStart(),a=[]}function b(){v(a[0][0],a[0][1]),u.lineEnd();var t,e,n,i,l=u.clean(),d=c.result(),f=d.length;if(a.pop(),o.push(a),a=null,f)if(1&l){if((e=(n=d[0]).length-1)>0){for(h||(r.polygonStart(),h=!0),r.lineStart(),t=0;t<e;++t)r.point((i=n[t])[0],i[1]);r.lineEnd()}}else f>1&&2&l&&d.push(d.pop().concat(d.shift())),s.push(d.filter(Kl))}return d}}function Kl(t){return t.length>1}function Bl(t,e){return((t=t.x)[0]<0?t[1]-Rs-As:Rs-t[1])-((e=e.x)[0]<0?e[1]-Rs-As:Rs-e[1])}var zl=Ll(function(){return!0},function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?Ss:-Ss,l=Ls(o-n);Ls(l-Ss)<As?(t.point(n,i=(i+s)/2>0?Rs:-Rs),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),t.point(o,i),e=0):r!==a&&l>=Ss&&(Ls(n-r)<As&&(n-=r*As),Ls(o-a)<As&&(o-=a*As),i=function(t,e,n,i){var r,o,s=Hs(t-n);return Ls(s)>As?Ks((Hs(e)*(o=zs(i))*Hs(n)-Hs(i)*(r=zs(e))*Hs(t))/(r*o*s)):(e+i)/2}(n,i,o,s),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),e=0),t.point(n=o,i=s),r=a},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}},function(t,e,n,i){var r;if(null==t)r=n*Rs,i.point(-Ss,r),i.point(0,r),i.point(Ss,r),i.point(Ss,0),i.point(Ss,-r),i.point(0,-r),i.point(-Ss,-r),i.point(-Ss,0),i.point(-Ss,r);else if(Ls(t[0]-e[0])>As){var o=t[0]<e[0]?Ss:-Ss;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])},[-Ss,-Rs]);function jl(t){var e=zs(t),n=6*Ps,i=e>0,r=Ls(e)>As;function o(t,n){return zs(t)*zs(n)>e}function s(t,n,i){var r=[1,0,0],o=ba(va(t),va(n)),s=ya(o,o),a=o[0],l=s-a*a;if(!l)return!i&&t;var c=e*s/l,u=-e*a/l,h=ba(r,o),d=Ia(r,c);Ca(d,Ia(o,u));var f=h,p=ya(d,f),g=ya(f,f),m=p*p-g*(ya(d,d)-1);if(!(m<0)){var v=Zs(m),y=Ia(f,(-p-v)/g);if(Ca(y,d),y=ma(y),!i)return y;var b,C=t[0],I=n[0],E=t[1],T=n[1];I<C&&(b=C,C=I,I=b);var w=I-C,x=Ls(w-Ss)<As;if(!x&&T<E&&(b=E,E=T,T=b),x||w<As?x?E+T>0^y[1]<(Ls(y[0]-C)<As?E:T):E<=y[1]&&y[1]<=T:w>Ss^(C<=y[0]&&y[0]<=I)){var _=Ia(f,(-p+v)/g);return Ca(_,d),[y,ma(_)]}}}function a(e,n){var r=i?t:Ss-t,o=0;return e<-r?o|=1:e>r&&(o|=2),n<-r?o|=4:n>r&&(o|=8),o}return Ll(o,function(t){var e,n,l,c,u;return{lineStart:function(){c=l=!1,u=1},point:function(h,d){var f,p=[h,d],g=o(h,d),m=i?g?0:a(h,d):g?a(h+(h<0?Ss:-Ss),d):0;if(!e&&(c=l=g)&&t.lineStart(),g!==l&&(!(f=s(e,p))||Ol(e,f)||Ol(p,f))&&(p[0]+=As,p[1]+=As,g=o(p[0],p[1])),g!==l)u=0,g?(t.lineStart(),f=s(p,e),t.point(f[0],f[1])):(f=s(e,p),t.point(f[0],f[1]),t.lineEnd()),e=f;else if(r&&e&&i^g){var v;m&n||!(v=s(p,e,!0))||(u=0,i?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!g||e&&Ol(e,p)||t.point(p[0],p[1]),e=p,l=g,n=m},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return u|(c&&l)<<1}}},function(e,i,r,o){_l(o,t,n,r,e,i)},i?[0,-t]:[-Ss,t-Ss])}var Gl=1e9,Fl=-Gl;function Vl(t,e,n,i){function r(r,o){return t<=r&&r<=n&&e<=o&&o<=i}function o(r,o,a,c){var u=0,h=0;if(null==r||(u=s(r,a))!==(h=s(o,a))||l(r,o)<0^a>0)do{c.point(0===u||3===u?t:n,u>1?i:e)}while((u=(u+a+4)%4)!==h);else c.point(o[0],o[1])}function s(i,r){return Ls(i[0]-t)<As?r>0?0:3:Ls(i[0]-n)<As?r>0?2:1:Ls(i[1]-e)<As?r>0?1:0:r>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var n=s(t,1),i=s(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var l,c,u,h,d,f,p,g,m,v,y,b=s,C=Al(),I={point:E,lineStart:function(){I.point=T,c&&c.push(u=[]),v=!0,m=!1,p=g=NaN},lineEnd:function(){l&&(T(h,d),f&&m&&C.rejoin(),l.push(C.result())),I.point=E,m&&b.lineEnd()},polygonStart:function(){b=C,l=[],c=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,r=c.length;n<r;++n)for(var o,s,a=c[n],l=1,u=a.length,h=a[0],d=h[0],f=h[1];l<u;++l)o=d,s=f,d=(h=a[l])[0],f=h[1],s<=i?f>i&&(d-o)*(i-s)>(f-s)*(t-o)&&++e:f<=i&&(d-o)*(i-s)<(f-s)*(t-o)&&--e;return e}(),n=y&&e,r=(l=_(l)).length;(n||r)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),r&&Rl(l,a,e,o,s),s.polygonEnd()),b=s,l=c=u=null}};function E(t,e){r(t,e)&&b.point(t,e)}function T(o,s){var a=r(o,s);if(c&&u.push([o,s]),v)h=o,d=s,f=a,v=!1,a&&(b.lineStart(),b.point(o,s));else if(a&&m)b.point(o,s);else{var l=[p=Math.max(Fl,Math.min(Gl,p)),g=Math.max(Fl,Math.min(Gl,g))],C=[o=Math.max(Fl,Math.min(Gl,o)),s=Math.max(Fl,Math.min(Gl,s))];!function(t,e,n,i,r,o){var s,a=t[0],l=t[1],c=0,u=1,h=e[0]-a,d=e[1]-l;if(s=n-a,h||!(s>0)){if(s/=h,h<0){if(s<c)return;s<u&&(u=s)}else if(h>0){if(s>u)return;s>c&&(c=s)}if(s=r-a,h||!(s<0)){if(s/=h,h<0){if(s>u)return;s>c&&(c=s)}else if(h>0){if(s<c)return;s<u&&(u=s)}if(s=i-l,d||!(s>0)){if(s/=d,d<0){if(s<c)return;s<u&&(u=s)}else if(d>0){if(s>u)return;s>c&&(c=s)}if(s=o-l,d||!(s<0)){if(s/=d,d<0){if(s>u)return;s>c&&(c=s)}else if(d>0){if(s<c)return;s<u&&(u=s)}return c>0&&(t[0]=a+c*h,t[1]=l+c*d),u<1&&(e[0]=a+u*h,e[1]=l+u*d),!0}}}}}(l,C,t,e,n,i)?a&&(b.lineStart(),b.point(o,s),y=!1):(m||(b.lineStart(),b.point(l[0],l[1])),b.point(C[0],C[1]),a||b.lineEnd(),y=!1)}p=o,g=s,m=a}return I}}var Hl,Ul,Zl,Wl=ws(),$l={sphere:qs,point:qs,lineStart:function(){$l.point=Xl,$l.lineEnd=Yl},lineEnd:qs,polygonStart:qs,polygonEnd:qs};function Yl(){$l.point=$l.lineEnd=qs}function Xl(t,e){Hl=t*=Ps,Ul=Hs(e*=Ps),Zl=zs(e),$l.point=ql}function ql(t,e){t*=Ps;var n=Hs(e*=Ps),i=zs(e),r=Ls(t-Hl),o=zs(r),s=i*Hs(r),a=Zl*n-Ul*i*o,l=Ul*n+Zl*i*o;Wl.add(Bs(Zs(s*s+a*a),l)),Hl=t,Ul=n,Zl=i}function Jl(t){return Wl.reset(),ia(t,$l),+Wl}var Ql=[null,null],tc={type:"LineString",coordinates:Ql};function ec(t,e){return Ql[0]=t,Ql[1]=e,Jl(tc)}var nc={Feature:function(t,e){return rc(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)if(rc(n[i].geometry,e))return!0;return!1}},ic={Sphere:function(){return!0},Point:function(t,e){return oc(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(oc(n[i],e))return!0;return!1},LineString:function(t,e){return sc(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(sc(n[i],e))return!0;return!1},Polygon:function(t,e){return ac(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(ac(n[i],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)if(rc(n[i],e))return!0;return!1}};function rc(t,e){return!(!t||!ic.hasOwnProperty(t.type))&&ic[t.type](t,e)}function oc(t,e){return 0===ec(t,e)}function sc(t,e){for(var n,i,r,o=0,s=t.length;o<s;o++){if(0===(i=ec(t[o],e)))return!0;if(o>0&&(r=ec(t[o],t[o-1]))>0&&n<=r&&i<=r&&(n+i-r)*(1-Math.pow((n-i)/r,2))<Os*r)return!0;n=i}return!1}function ac(t,e){return!!Pl(t.map(lc),cc(e))}function lc(t){return(t=t.map(cc)).pop(),t}function cc(t){return[t[0]*Ps,t[1]*Ps]}function uc(t,e,n){var i=m(t,e-As,n).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function hc(t,e,n){var i=m(t,e-As,n).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function dc(){var t,e,n,i,r,o,s,a,l,c,u,h,d=10,f=d,p=90,g=360,v=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return m(js(i/p)*p,n,p).map(u).concat(m(js(a/g)*g,s,g).map(h)).concat(m(js(e/d)*d,t,d).filter(function(t){return Ls(t%p)>As}).map(l)).concat(m(js(o/f)*f,r,f).filter(function(t){return Ls(t%g)>As}).map(c))}return y.lines=function(){return b().map(function(t){return{type:"LineString",coordinates:t}})},y.outline=function(){return{type:"Polygon",coordinates:[u(i).concat(h(s).slice(1),u(n).reverse().slice(1),h(a).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(i=+t[0][0],n=+t[1][0],a=+t[0][1],s=+t[1][1],i>n&&(t=i,i=n,n=t),a>s&&(t=a,a=s,s=t),y.precision(v)):[[i,a],[n,s]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],r=+n[1][1],e>t&&(n=e,e=t,t=n),o>r&&(n=o,o=r,r=n),y.precision(v)):[[e,o],[t,r]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],g=+t[1],y):[p,g]},y.stepMinor=function(t){return arguments.length?(d=+t[0],f=+t[1],y):[d,f]},y.precision=function(d){return arguments.length?(v=+d,l=uc(o,r,90),c=hc(e,t,v),u=uc(a,s,90),h=hc(i,n,v),y):v},y.extentMajor([[-180,-90+As],[180,90-As]]).extentMinor([[-180,-80-As],[180,80+As]])}function fc(t){return t}var pc,gc,mc,vc,yc=ws(),bc=ws(),Cc={point:qs,lineStart:qs,lineEnd:qs,polygonStart:function(){Cc.lineStart=Ic,Cc.lineEnd=wc},polygonEnd:function(){Cc.lineStart=Cc.lineEnd=Cc.point=qs,yc.add(Ls(bc)),bc.reset()},result:function(){var t=yc/2;return yc.reset(),t}};function Ic(){Cc.point=Ec}function Ec(t,e){Cc.point=Tc,pc=mc=t,gc=vc=e}function Tc(t,e){bc.add(vc*t-mc*e),mc=t,vc=e}function wc(){Tc(pc,gc)}var xc,_c,Dc,Ac,Oc=1/0,Sc=Oc,Rc=-Oc,kc=Rc,Nc={point:function(t,e){t<Oc&&(Oc=t),t>Rc&&(Rc=t),e<Sc&&(Sc=e),e>kc&&(kc=e)},lineStart:qs,lineEnd:qs,polygonStart:qs,polygonEnd:qs,result:function(){var t=[[Oc,Sc],[Rc,kc]];return Rc=kc=-(Sc=Oc=1/0),t}},Mc=0,Pc=0,Lc=0,Kc=0,Bc=0,zc=0,jc=0,Gc=0,Fc=0,Vc={point:Hc,lineStart:Uc,lineEnd:$c,polygonStart:function(){Vc.lineStart=Yc,Vc.lineEnd=Xc},polygonEnd:function(){Vc.point=Hc,Vc.lineStart=Uc,Vc.lineEnd=$c},result:function(){var t=Fc?[jc/Fc,Gc/Fc]:zc?[Kc/zc,Bc/zc]:Lc?[Mc/Lc,Pc/Lc]:[NaN,NaN];return Mc=Pc=Lc=Kc=Bc=zc=jc=Gc=Fc=0,t}};function Hc(t,e){Mc+=t,Pc+=e,++Lc}function Uc(){Vc.point=Zc}function Zc(t,e){Vc.point=Wc,Hc(Dc=t,Ac=e)}function Wc(t,e){var n=t-Dc,i=e-Ac,r=Zs(n*n+i*i);Kc+=r*(Dc+t)/2,Bc+=r*(Ac+e)/2,zc+=r,Hc(Dc=t,Ac=e)}function $c(){Vc.point=Hc}function Yc(){Vc.point=qc}function Xc(){Jc(xc,_c)}function qc(t,e){Vc.point=Jc,Hc(xc=Dc=t,_c=Ac=e)}function Jc(t,e){var n=t-Dc,i=e-Ac,r=Zs(n*n+i*i);Kc+=r*(Dc+t)/2,Bc+=r*(Ac+e)/2,zc+=r,jc+=(r=Ac*t-Dc*e)*(Dc+t),Gc+=r*(Ac+e),Fc+=3*r,Hc(Dc=t,Ac=e)}function Qc(t){this._context=t}Qc.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Ns)}},result:qs};var tu,eu,nu,iu,ru,ou=ws(),su={point:qs,lineStart:function(){su.point=au},lineEnd:function(){tu&&lu(eu,nu),su.point=qs},polygonStart:function(){tu=!0},polygonEnd:function(){tu=null},result:function(){var t=+ou;return ou.reset(),t}};function au(t,e){su.point=lu,eu=iu=t,nu=ru=e}function lu(t,e){iu-=t,ru-=e,ou.add(Zs(iu*iu+ru*ru)),iu=t,ru=e}function cu(){this._string=[]}function uu(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function hu(t){return function(e){var n=new du;for(var i in t)n[i]=t[i];return n.stream=e,n}}function du(){}function fu(t,e,n){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=i&&t.clipExtent(null),ia(n,t.stream(Nc)),e(Nc.result()),null!=i&&t.clipExtent(i),t}function pu(t,e,n){return fu(t,function(n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),s=+e[0][0]+(i-o*(n[1][0]+n[0][0]))/2,a=+e[0][1]+(r-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([s,a])},n)}function gu(t,e,n){return pu(t,[[0,0],e],n)}function mu(t,e,n){return fu(t,function(n){var i=+e,r=i/(n[1][0]-n[0][0]),o=(i-r*(n[1][0]+n[0][0]))/2,s=-r*n[0][1];t.scale(150*r).translate([o,s])},n)}function vu(t,e,n){return fu(t,function(n){var i=+e,r=i/(n[1][1]-n[0][1]),o=-r*n[0][0],s=(i-r*(n[1][1]+n[0][1]))/2;t.scale(150*r).translate([o,s])},n)}cu.prototype={_radius:4.5,_circle:uu(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=uu(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},du.prototype={constructor:du,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var yu=16,bu=zs(30*Ps);function Cu(t,e){return+e?function(t,e){function n(i,r,o,s,a,l,c,u,h,d,f,p,g,m){var v=c-i,y=u-r,b=v*v+y*y;if(b>4*e&&g--){var C=s+d,I=a+f,E=l+p,T=Zs(C*C+I*I+E*E),w=Ys(E/=T),x=Ls(Ls(E)-1)<As||Ls(o-h)<As?(o+h)/2:Bs(I,C),_=t(x,w),D=_[0],A=_[1],O=D-i,S=A-r,R=y*O-v*S;(R*R/b>e||Ls((v*O+y*S)/b-.5)>.3||s*d+a*f+l*p<bu)&&(n(i,r,o,s,a,l,D,A,x,C/=T,I/=T,E,g,m),m.point(D,A),n(D,A,x,C,I,E,c,u,h,d,f,p,g,m))}}return function(e){var i,r,o,s,a,l,c,u,h,d,f,p,g={point:m,lineStart:v,lineEnd:b,polygonStart:function(){e.polygonStart(),g.lineStart=C},polygonEnd:function(){e.polygonEnd(),g.lineStart=v}};function m(n,i){n=t(n,i),e.point(n[0],n[1])}function v(){u=NaN,g.point=y,e.lineStart()}function y(i,r){var o=va([i,r]),s=t(i,r);n(u,h,c,d,f,p,u=s[0],h=s[1],c=i,d=o[0],f=o[1],p=o[2],yu,e),e.point(u,h)}function b(){g.point=m,e.lineEnd()}function C(){v(),g.point=I,g.lineEnd=E}function I(t,e){y(i=t,e),r=u,o=h,s=d,a=f,l=p,g.point=y}function E(){n(u,h,c,d,f,p,r,o,i,s,a,l,yu,e),g.lineEnd=b,b()}return g}}(t,e):function(t){return hu({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var Iu=hu({point:function(t,e){this.stream.point(t*Ps,e*Ps)}});function Eu(t,e,n,i){var r=zs(i),o=Hs(i),s=r*t,a=o*t,l=r/t,c=o/t,u=(o*n-r*e)/t,h=(o*e+r*n)/t;function d(t,i){return[s*t-a*i+e,n-a*t-s*i]}return d.invert=function(t,e){return[l*t-c*e+u,h-c*t-l*e]},d}function Tu(t){return wu(function(){return t})()}function wu(t){var e,n,i,r,o,s,a,l,c,u,h=150,d=480,f=250,p=0,g=0,m=0,v=0,y=0,b=0,C=null,I=zl,E=null,T=fc,w=.5;function x(t){return l(t[0]*Ps,t[1]*Ps)}function _(t){return(t=l.invert(t[0],t[1]))&&[t[0]*Ms,t[1]*Ms]}function D(){var t=Eu(h,0,0,b).apply(null,e(p,g)),i=(b?Eu:function(t,e,n){function i(i,r){return[e+t*i,n-t*r]}return i.invert=function(i,r){return[(i-e)/t,(n-r)/t]},i})(h,d-t[0],f-t[1],b);return n=Il(m,v,y),a=bl(e,i),l=bl(n,a),s=Cu(a,w),A()}function A(){return c=u=null,x}return x.stream=function(t){return c&&u===t?c:c=Iu(function(t){return hu({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}(n)(I(s(T(u=t)))))},x.preclip=function(t){return arguments.length?(I=t,C=void 0,A()):I},x.postclip=function(t){return arguments.length?(T=t,E=i=r=o=null,A()):T},x.clipAngle=function(t){return arguments.length?(I=+t?jl(C=t*Ps):(C=null,zl),A()):C*Ms},x.clipExtent=function(t){return arguments.length?(T=null==t?(E=i=r=o=null,fc):Vl(E=+t[0][0],i=+t[0][1],r=+t[1][0],o=+t[1][1]),A()):null==E?null:[[E,i],[r,o]]},x.scale=function(t){return arguments.length?(h=+t,D()):h},x.translate=function(t){return arguments.length?(d=+t[0],f=+t[1],D()):[d,f]},x.center=function(t){return arguments.length?(p=t[0]%360*Ps,g=t[1]%360*Ps,D()):[p*Ms,g*Ms]},x.rotate=function(t){return arguments.length?(m=t[0]%360*Ps,v=t[1]%360*Ps,y=t.length>2?t[2]%360*Ps:0,D()):[m*Ms,v*Ms,y*Ms]},x.angle=function(t){return arguments.length?(b=t%360*Ps,D()):b*Ms},x.precision=function(t){return arguments.length?(s=Cu(a,w=t*t),A()):Zs(w)},x.fitExtent=function(t,e){return pu(x,t,e)},x.fitSize=function(t,e){return gu(x,t,e)},x.fitWidth=function(t,e){return mu(x,t,e)},x.fitHeight=function(t,e){return vu(x,t,e)},function(){return e=t.apply(this,arguments),x.invert=e.invert&&_,D()}}function xu(t){var e=0,n=Ss/3,i=wu(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*Ps,n=t[1]*Ps):[e*Ms,n*Ms]},r}function _u(t,e){var n=Hs(t),i=(n+Hs(e))/2;if(Ls(i)<As)return function(t){var e=zs(t);function n(t,n){return[t*e,Hs(n)/e]}return n.invert=function(t,n){return[t/e,Ys(n*e)]},n}(t);var r=1+n*(2*i-n),o=Zs(r)/i;function s(t,e){var n=Zs(r-2*i*Hs(e))/i;return[n*Hs(t*=i),o-n*zs(t)]}return s.invert=function(t,e){var n=o-e;return[Bs(t,Ls(n))/i*Us(n),Ys((r-(t*t+n*n)*i*i)/(2*i))]},s}function Du(){return xu(_u).scale(155.424).center([0,33.6442])}function Au(){return Du().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Ou(t){return function(e,n){var i=zs(e),r=zs(n),o=t(i*r);return[o*r*Hs(e),o*Hs(n)]}}function Su(t){return function(e,n){var i=Zs(e*e+n*n),r=t(i),o=Hs(r),s=zs(r);return[Bs(e*o,i*s),Ys(i&&n*o/i)]}}var Ru=Ou(function(t){return Zs(2/(1+t))});Ru.invert=Su(function(t){return 2*Ys(t/2)});var ku=Ou(function(t){return(t=$s(t))&&t/Hs(t)});function Nu(t,e){return[t,Fs(Ws((Rs+e)/2))]}function Mu(t){var e,n,i,r=Tu(t),o=r.center,s=r.scale,a=r.translate,l=r.clipExtent,c=null;function u(){var o=Ss*s(),a=r(xl(r.rotate()).invert([0,0]));return l(null==c?[[a[0]-o,a[1]-o],[a[0]+o,a[1]+o]]:t===Nu?[[Math.max(a[0]-o,c),e],[Math.min(a[0]+o,n),i]]:[[c,Math.max(a[1]-o,e)],[n,Math.min(a[1]+o,i)]])}return r.scale=function(t){return arguments.length?(s(t),u()):s()},r.translate=function(t){return arguments.length?(a(t),u()):a()},r.center=function(t){return arguments.length?(o(t),u()):o()},r.clipExtent=function(t){return arguments.length?(null==t?c=e=n=i=null:(c=+t[0][0],e=+t[0][1],n=+t[1][0],i=+t[1][1]),u()):null==c?null:[[c,e],[n,i]]},u()}function Pu(t){return Ws((Rs+t)/2)}function Lu(t,e){var n=zs(t),i=t===e?Hs(t):Fs(n/zs(e))/Fs(Pu(e)/Pu(t)),r=n*Vs(Pu(t),i)/i;if(!i)return Nu;function o(t,e){r>0?e<-Rs+As&&(e=-Rs+As):e>Rs-As&&(e=Rs-As);var n=r/Vs(Pu(e),i);return[n*Hs(i*t),r-n*zs(i*t)]}return o.invert=function(t,e){var n=r-e,o=Us(i)*Zs(t*t+n*n);return[Bs(t,Ls(n))/i*Us(n),2*Ks(Vs(r/o,1/i))-Rs]},o}function Ku(t,e){return[t,e]}function Bu(t,e){var n=zs(t),i=t===e?Hs(t):(n-zs(e))/(e-t),r=n/i+t;if(Ls(i)<As)return Ku;function o(t,e){var n=r-e,o=i*t;return[n*Hs(o),r-n*zs(o)]}return o.invert=function(t,e){var n=r-e;return[Bs(t,Ls(n))/i*Us(n),r-Us(i)*Zs(t*t+n*n)]},o}ku.invert=Su(function(t){return t}),Nu.invert=function(t,e){return[t,2*Ks(Gs(e))-Rs]},Ku.invert=Ku;var zu=1.340264,ju=-.081106,Gu=893e-6,Fu=.003796,Vu=Zs(3)/2;function Hu(t,e){var n=Ys(Vu*Hs(e)),i=n*n,r=i*i*i;return[t*zs(n)/(Vu*(zu+3*ju*i+r*(7*Gu+9*Fu*i))),n*(zu+ju*i+r*(Gu+Fu*i))]}function Uu(t,e){var n=zs(e),i=zs(t)*n;return[n*Hs(t)/i,Hs(e)/i]}function Zu(t,e,n,i){return 1===t&&1===e&&0===n&&0===i?fc:hu({point:function(r,o){this.stream.point(r*t+n,o*e+i)}})}function Wu(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),e*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}function $u(t,e){return[zs(e)*Hs(t),Hs(e)]}function Yu(t,e){var n=zs(e),i=1+zs(t)*n;return[n*Hs(t)/i,Hs(e)/i]}function Xu(t,e){return[Fs(Ws((Rs+e)/2)),-t]}function qu(t,e){return t.parent===e.parent?1:2}function Ju(t,e){return t+e.x}function Qu(t,e){return Math.max(t,e.y)}function th(t){var e=0,n=t.children,i=n&&n.length;if(i)for(;--i>=0;)e+=n[i].value;else e=1;t.value=e}function eh(t,e){var n,i,r,o,s,a=new oh(t),l=+t.value&&(a.value=t.value),c=[a];for(null==e&&(e=nh);n=c.pop();)if(l&&(n.value=+n.data.value),(r=e(n.data))&&(s=r.length))for(n.children=new Array(s),o=s-1;o>=0;--o)c.push(i=n.children[o]=new oh(r[o])),i.parent=n,i.depth=n.depth+1;return a.eachBefore(rh)}function nh(t){return t.children}function ih(t){t.data=t.data.data}function rh(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function oh(t){this.data=t,this.depth=this.height=0,this.parent=null}Hu.invert=function(t,e){for(var n,i=e,r=i*i,o=r*r*r,s=0;s<12&&(o=(r=(i-=n=(i*(zu+ju*r+o*(Gu+Fu*r))-e)/(zu+3*ju*r+o*(7*Gu+9*Fu*r)))*i)*r*r,!(Ls(n)<Os));++s);return[Vu*t*(zu+3*ju*r+o*(7*Gu+9*Fu*r))/zs(i),Ys(Hs(i)/Vu)]},Uu.invert=Su(Ks),Wu.invert=function(t,e){var n,i=e,r=25;do{var o=i*i,s=o*o;i-=n=(i*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-e)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(Ls(n)>As&&--r>0);return[t/(.8707+(o=i*i)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),i]},$u.invert=Su(Ys),Yu.invert=Su(function(t){return 2*Ks(t)}),Xu.invert=function(t,e){return[-e,2*Ks(Gs(t))-Rs]},oh.prototype=eh.prototype={constructor:oh,count:function(){return this.eachAfter(th)},each:function(t){var e,n,i,r,o=this,s=[o];do{for(e=s.reverse(),s=[];o=e.pop();)if(t(o),n=o.children)for(i=0,r=n.length;i<r;++i)s.push(n[i])}while(s.length);return this},eachAfter:function(t){for(var e,n,i,r=this,o=[r],s=[];r=o.pop();)if(s.push(r),e=r.children)for(n=0,i=e.length;n<i;++n)o.push(e[n]);for(;r=s.pop();)t(r);return this},eachBefore:function(t){for(var e,n,i=this,r=[i];i=r.pop();)if(t(i),e=i.children)for(n=e.length-1;n>=0;--n)r.push(e[n]);return this},sum:function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;for(t=n.pop(),e=i.pop();t===e;)r=t,t=n.pop(),e=i.pop();return r}(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each(function(e){t.push(e)}),t},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e},copy:function(){return eh(this).eachBefore(ih)}};var sh=Array.prototype.slice;function ah(t){for(var e,n,i=0,r=(t=function(t){for(var e,n,i=t.length;i;)n=Math.random()*i--|0,e=t[i],t[i]=t[n],t[n]=e;return t}(sh.call(t))).length,o=[];i<r;)e=t[i],n&&uh(n,e)?++i:(n=dh(o=lh(o,e)),i=0);return n}function lh(t,e){var n,i;if(hh(e,t))return[e];for(n=0;n<t.length;++n)if(ch(e,t[n])&&hh(fh(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(i=n+1;i<t.length;++i)if(ch(fh(t[n],t[i]),e)&&ch(fh(t[n],e),t[i])&&ch(fh(t[i],e),t[n])&&hh(ph(t[n],t[i],e),t))return[t[n],t[i],e];throw new Error}function ch(t,e){var n=t.r-e.r,i=e.x-t.x,r=e.y-t.y;return n<0||n*n<i*i+r*r}function uh(t,e){var n=t.r-e.r+1e-6,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function hh(t,e){for(var n=0;n<e.length;++n)if(!uh(t,e[n]))return!1;return!0}function dh(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return fh(t[0],t[1]);case 3:return ph(t[0],t[1],t[2])}}function fh(t,e){var n=t.x,i=t.y,r=t.r,o=e.x,s=e.y,a=e.r,l=o-n,c=s-i,u=a-r,h=Math.sqrt(l*l+c*c);return{x:(n+o+l/h*u)/2,y:(i+s+c/h*u)/2,r:(h+r+a)/2}}function ph(t,e,n){var i=t.x,r=t.y,o=t.r,s=e.x,a=e.y,l=e.r,c=n.x,u=n.y,h=n.r,d=i-s,f=i-c,p=r-a,g=r-u,m=l-o,v=h-o,y=i*i+r*r-o*o,b=y-s*s-a*a+l*l,C=y-c*c-u*u+h*h,I=f*p-d*g,E=(p*C-g*b)/(2*I)-i,T=(g*m-p*v)/I,w=(f*b-d*C)/(2*I)-r,x=(d*v-f*m)/I,_=T*T+x*x-1,D=2*(o+E*T+w*x),A=E*E+w*w-o*o,O=-(_?(D+Math.sqrt(D*D-4*_*A))/(2*_):A/D);return{x:i+E+T*O,y:r+w+x*O,r:O}}function gh(t,e,n){var i,r,o,s,a=t.x-e.x,l=t.y-e.y,c=a*a+l*l;c?(r=e.r+n.r,r*=r,s=t.r+n.r,r>(s*=s)?(i=(c+s-r)/(2*c),o=Math.sqrt(Math.max(0,s/c-i*i)),n.x=t.x-i*a-o*l,n.y=t.y-i*l+o*a):(i=(c+r-s)/(2*c),o=Math.sqrt(Math.max(0,r/c-i*i)),n.x=e.x+i*a-o*l,n.y=e.y+i*l+o*a)):(n.x=e.x+n.r,n.y=e.y)}function mh(t,e){var n=t.r+e.r-1e-6,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function vh(t){var e=t._,n=t.next._,i=e.r+n.r,r=(e.x*n.r+n.x*e.r)/i,o=(e.y*n.r+n.y*e.r)/i;return r*r+o*o}function yh(t){this._=t,this.next=null,this.previous=null}function bh(t){if(!(r=t.length))return 0;var e,n,i,r,o,s,a,l,c,u,h;if((e=t[0]).x=0,e.y=0,!(r>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(r>2))return e.r+n.r;gh(n,e,i=t[2]),e=new yh(e),n=new yh(n),i=new yh(i),e.next=i.previous=n,n.next=e.previous=i,i.next=n.previous=e;t:for(a=3;a<r;++a){gh(e._,n._,i=t[a]),i=new yh(i),l=n.next,c=e.previous,u=n._.r,h=e._.r;do{if(u<=h){if(mh(l._,i._)){n=l,e.next=n,n.previous=e,--a;continue t}u+=l._.r,l=l.next}else{if(mh(c._,i._)){(e=c).next=n,n.previous=e,--a;continue t}h+=c._.r,c=c.previous}}while(l!==c.next);for(i.previous=e,i.next=n,e.next=n.previous=n=i,o=vh(e);(i=i.next)!==n;)(s=vh(i))<o&&(e=i,o=s);n=e.next}for(e=[n._],i=n;(i=i.next)!==n;)e.push(i._);for(i=ah(e),a=0;a<r;++a)(e=t[a]).x-=i.x,e.y-=i.y;return i.r}function Ch(t){if("function"!=typeof t)throw new Error;return t}function Ih(){return 0}function Eh(t){return function(){return t}}function Th(t){return Math.sqrt(t.value)}function wh(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function xh(t,e){return function(n){if(i=n.children){var i,r,o,s=i.length,a=t(n)*e||0;if(a)for(r=0;r<s;++r)i[r].r+=a;if(o=bh(i),a)for(r=0;r<s;++r)i[r].r-=a;n.r=o+a}}}function _h(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function Dh(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Ah(t,e,n,i,r){for(var o,s=t.children,a=-1,l=s.length,c=t.value&&(i-e)/t.value;++a<l;)(o=s[a]).y0=n,o.y1=r,o.x0=e,o.x1=e+=o.value*c}var Oh={depth:-1},Sh={};function Rh(t){return t.id}function kh(t){return t.parentId}function Nh(t,e){return t.parent===e.parent?1:2}function Mh(t){var e=t.children;return e?e[0]:t.t}function Ph(t){var e=t.children;return e?e[e.length-1]:t.t}function Lh(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function Kh(t,e,n){return t.a.parent===e.parent?t.a:n}function Bh(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function zh(t,e,n,i,r){for(var o,s=t.children,a=-1,l=s.length,c=t.value&&(r-n)/t.value;++a<l;)(o=s[a]).x0=e,o.x1=i,o.y0=n,o.y1=n+=o.value*c}Bh.prototype=Object.create(oh.prototype);var jh=(1+Math.sqrt(5))/2;function Gh(t,e,n,i,r,o){for(var s,a,l,c,u,h,d,f,p,g,m,v=[],y=e.children,b=0,C=0,I=y.length,E=e.value;b<I;){l=r-n,c=o-i;do{u=y[C++].value}while(!u&&C<I);for(h=d=u,m=u*u*(g=Math.max(c/l,l/c)/(E*t)),p=Math.max(d/m,m/h);C<I;++C){if(u+=a=y[C].value,a<h&&(h=a),a>d&&(d=a),m=u*u*g,(f=Math.max(d/m,m/h))>p){u-=a;break}p=f}v.push(s={value:u,dice:l<c,children:y.slice(b,C)}),s.dice?Ah(s,n,i,r,E?i+=c*u/E:o):zh(s,n,i,E?n+=l*u/E:r,o),E-=u,b=C}return v}var Fh=function t(e){function n(t,n,i,r,o){Gh(e,t,n,i,r,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(jh),Vh=function t(e){function n(t,n,i,r,o){if((s=t._squarify)&&s.ratio===e)for(var s,a,l,c,u,h=-1,d=s.length,f=t.value;++h<d;){for(l=(a=s[h]).children,c=a.value=0,u=l.length;c<u;++c)a.value+=l[c].value;a.dice?Ah(a,n,i,r,i+=(o-i)*a.value/f):zh(a,n,i,n+=(r-n)*a.value/f,o),f-=a.value}else t._squarify=s=Gh(e,t,n,i,r,o),s.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(jh);function Hh(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function Uh(t,e){return t[0]-e[0]||t[1]-e[1]}function Zh(t){for(var e=t.length,n=[0,1],i=2,r=2;r<e;++r){for(;i>1&&Hh(t[n[i-2]],t[n[i-1]],t[r])<=0;)--i;n[i++]=r}return n.slice(0,i)}function Wh(){return Math.random()}var $h=function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(Wh),Yh=function t(e){function n(t,n){var i,r;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=i)o=i,i=null;else do{i=2*e()-1,o=2*e()-1,r=i*i+o*o}while(!r||r>1);return t+n*o*Math.sqrt(-2*Math.log(r)/r)}}return n.source=t,n}(Wh),Xh=function t(e){function n(){var t=Yh.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(Wh),qh=function t(e){function n(t){return function(){for(var n=0,i=0;i<t;++i)n+=e();return n}}return n.source=t,n}(Wh),Jh=function t(e){function n(t){var n=qh.source(e)(t);return function(){return n()/t}}return n.source=t,n}(Wh),Qh=function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(Wh);function td(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function ed(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t)}return this}var nd=Array.prototype,id=nd.map,rd=nd.slice,od={name:"implicit"};function sd(){var t=jr(),e=[],n=[],i=od;function r(r){var o=r+"",s=t.get(o);if(!s){if(i!==od)return i;t.set(o,s=e.push(r))}return n[(s-1)%n.length]}return r.domain=function(n){if(!arguments.length)return e.slice();e=[],t=jr();for(var i,o,s=-1,a=n.length;++s<a;)t.has(o=(i=n[s])+"")||t.set(o,e.push(i));return r},r.range=function(t){return arguments.length?(n=rd.call(t),r):n.slice()},r.unknown=function(t){return arguments.length?(i=t,r):i},r.copy=function(){return sd(e,n).unknown(i)},td.apply(r,arguments),r}function ad(){var t,e,n=sd().unknown(void 0),i=n.domain,r=n.range,o=[0,1],s=!1,a=0,l=0,c=.5;function u(){var n=i().length,u=o[1]<o[0],h=o[u-0],d=o[1-u];t=(d-h)/Math.max(1,n-a+2*l),s&&(t=Math.floor(t)),h+=(d-h-t*(n-a))*c,e=t*(1-a),s&&(h=Math.round(h),e=Math.round(e));var f=m(n).map(function(e){return h+t*e});return r(u?f.reverse():f)}return delete n.unknown,n.domain=function(t){return arguments.length?(i(t),u()):i()},n.range=function(t){return arguments.length?(o=[+t[0],+t[1]],u()):o.slice()},n.rangeRound=function(t){return o=[+t[0],+t[1]],s=!0,u()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(s=!!t,u()):s},n.padding=function(t){return arguments.length?(a=Math.min(1,l=+t),u()):a},n.paddingInner=function(t){return arguments.length?(a=Math.min(1,t),u()):a},n.paddingOuter=function(t){return arguments.length?(l=+t,u()):l},n.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),u()):c},n.copy=function(){return ad(i(),o).round(s).paddingInner(a).paddingOuter(l).align(c)},td.apply(u(),arguments)}function ld(t){return+t}var cd=[0,1];function ud(t){return t}function hd(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function dd(t){var e,n=t[0],i=t[t.length-1];return n>i&&(e=n,n=i,i=e),function(t){return Math.max(n,Math.min(i,t))}}function fd(t,e,n){var i=t[0],r=t[1],o=e[0],s=e[1];return r<i?(i=hd(r,i),o=n(s,o)):(i=hd(i,r),o=n(o,s)),function(t){return o(i(t))}}function pd(t,e,n){var i=Math.min(t.length,e.length)-1,o=new Array(i),s=new Array(i),a=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<i;)o[a]=hd(t[a],t[a+1]),s[a]=n(e[a],e[a+1]);return function(e){var n=r(t,e,1,i)-1;return s[n](o[n](e))}}function gd(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function md(){var t,e,n,i,r,o,s=cd,a=cd,l=yn,c=ud;function u(){return i=Math.min(s.length,a.length)>2?pd:fd,r=o=null,h}function h(e){return isNaN(e=+e)?n:(r||(r=i(s.map(t),a,l)))(t(c(e)))}return h.invert=function(n){return c(e((o||(o=i(a,s.map(t),fn)))(n)))},h.domain=function(t){return arguments.length?(s=id.call(t,ld),c===ud||(c=dd(s)),u()):s.slice()},h.range=function(t){return arguments.length?(a=rd.call(t),u()):a.slice()},h.rangeRound=function(t){return a=rd.call(t),l=bn,u()},h.clamp=function(t){return arguments.length?(c=t?dd(s):ud,h):c!==ud},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,i){return t=n,e=i,u()}}function vd(t,e){return md()(t,e)}function yd(e,n,i,r){var o,s=E(e,n,i);switch((r=hs(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(n));return null!=r.precision||isNaN(o=Es(s,a))||(r.precision=o),t.formatPrefix(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=Ts(s,Math.max(Math.abs(e),Math.abs(n))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=Is(s))||(r.precision=o-2*("%"===r.type))}return t.format(r)}function bd(t){var e=t.domain;return t.ticks=function(t){var n=e();return C(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return yd(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r=e(),o=0,s=r.length-1,a=r[o],l=r[s];return l<a&&(i=a,a=l,l=i,i=o,o=s,s=i),(i=I(a,l,n))>0?i=I(a=Math.floor(a/i)*i,l=Math.ceil(l/i)*i,n):i<0&&(i=I(a=Math.ceil(a*i)/i,l=Math.floor(l*i)/i,n)),i>0?(r[o]=Math.floor(a/i)*i,r[s]=Math.ceil(l/i)*i,e(r)):i<0&&(r[o]=Math.ceil(a*i)/i,r[s]=Math.floor(l*i)/i,e(r)),t},t}function Cd(t,e){var n,i=0,r=(t=t.slice()).length-1,o=t[i],s=t[r];return s<o&&(n=i,i=r,r=n,n=o,o=s,s=n),t[i]=e.floor(o),t[r]=e.ceil(s),t}function Id(t){return Math.log(t)}function Ed(t){return Math.exp(t)}function Td(t){return-Math.log(-t)}function wd(t){return-Math.exp(-t)}function xd(t){return isFinite(t)?+("1e"+t):t<0?0:t}function _d(t){return function(e){return-t(-e)}}function Dd(e){var n,i,r=e(Id,Ed),o=r.domain,s=10;function a(){return n=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(s),i=function(t){return 10===t?xd:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(s),o()[0]<0?(n=_d(n),i=_d(i),e(Td,wd)):e(Id,Ed),r}return r.base=function(t){return arguments.length?(s=+t,a()):s},r.domain=function(t){return arguments.length?(o(t),a()):o()},r.ticks=function(t){var e,r=o(),a=r[0],l=r[r.length-1];(e=l<a)&&(d=a,a=l,l=d);var c,u,h,d=n(a),f=n(l),p=null==t?10:+t,g=[];if(!(s%1)&&f-d<p){if(d=Math.round(d)-1,f=Math.round(f)+1,a>0){for(;d<f;++d)for(u=1,c=i(d);u<s;++u)if(!((h=c*u)<a)){if(h>l)break;g.push(h)}}else for(;d<f;++d)for(u=s-1,c=i(d);u>=1;--u)if(!((h=c*u)<a)){if(h>l)break;g.push(h)}}else g=C(d,f,Math.min(f-d,p)).map(i);return e?g.reverse():g},r.tickFormat=function(e,o){if(null==o&&(o=10===s?".0e":","),"function"!=typeof o&&(o=t.format(o)),e===1/0)return o;null==e&&(e=10);var a=Math.max(1,s*e/r.ticks().length);return function(t){var e=t/i(Math.round(n(t)));return e*s<s-.5&&(e*=s),e<=a?o(t):""}},r.nice=function(){return o(Cd(o(),{floor:function(t){return i(Math.floor(n(t)))},ceil:function(t){return i(Math.ceil(n(t)))}}))},r}function Ad(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Od(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Sd(t){var e=1,n=t(Ad(e),Od(e));return n.constant=function(n){return arguments.length?t(Ad(e=+n),Od(e)):e},bd(n)}function Rd(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function kd(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Nd(t){return t<0?-t*t:t*t}function Md(t){var e=t(ud,ud),n=1;function i(){return 1===n?t(ud,ud):.5===n?t(kd,Nd):t(Rd(n),Rd(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,i()):n},bd(e)}function Pd(){var t=Md(md());return t.copy=function(){return gd(t,Pd()).exponent(t.exponent())},td.apply(t,arguments),t}var Ld=new Date,Kd=new Date;function Bd(t,e,n,i){function r(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return r.floor=function(e){return t(e=new Date(+e)),e},r.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},r.round=function(t){var e=r(t),n=r.ceil(t);return t-e<n-t?e:n},r.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},r.range=function(n,i,o){var s,a=[];if(n=r.ceil(n),o=null==o?1:Math.floor(o),!(n<i&&o>0))return a;do{a.push(s=new Date(+n)),e(n,o),t(n)}while(s<n&&n<i);return a},r.filter=function(n){return Bd(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,i){if(t>=t)if(i<0)for(;++i<=0;)for(;e(t,-1),!n(t););else for(;--i>=0;)for(;e(t,1),!n(t););})},n&&(r.count=function(e,i){return Ld.setTime(+e),Kd.setTime(+i),t(Ld),t(Kd),Math.floor(n(Ld,Kd))},r.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?r.filter(i?function(e){return i(e)%t==0}:function(e){return r.count(0,e)%t==0}):r:null}),r}var zd=Bd(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});zd.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Bd(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):zd:null};var jd=zd.range,Gd=6e4,Fd=6048e5,Vd=Bd(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),Hd=Vd.range,Ud=Bd(function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())},function(t,e){t.setTime(+t+e*Gd)},function(t,e){return(e-t)/Gd},function(t){return t.getMinutes()}),Zd=Ud.range,Wd=Bd(function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-t.getMinutes()*Gd)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()}),$d=Wd.range,Yd=Bd(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Gd)/864e5},function(t){return t.getDate()-1}),Xd=Yd.range;function qd(t){return Bd(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Gd)/Fd})}var Jd=qd(0),Qd=qd(1),tf=qd(2),ef=qd(3),nf=qd(4),rf=qd(5),of=qd(6),sf=Jd.range,af=Qd.range,lf=tf.range,cf=ef.range,uf=nf.range,hf=rf.range,df=of.range,ff=Bd(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),pf=ff.range,gf=Bd(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});gf.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Bd(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var mf=gf.range,vf=Bd(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Gd)},function(t,e){return(e-t)/Gd},function(t){return t.getUTCMinutes()}),yf=vf.range,bf=Bd(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()}),Cf=bf.range,If=Bd(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1}),Ef=If.range;function Tf(t){return Bd(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/Fd})}var wf=Tf(0),xf=Tf(1),_f=Tf(2),Df=Tf(3),Af=Tf(4),Of=Tf(5),Sf=Tf(6),Rf=wf.range,kf=xf.range,Nf=_f.range,Mf=Df.range,Pf=Af.range,Lf=Of.range,Kf=Sf.range,Bf=Bd(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),zf=Bf.range,jf=Bd(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});jf.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Bd(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var Gf=jf.range;function Ff(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Vf(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Hf(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Uf(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,o=t.days,s=t.shortDays,a=t.months,l=t.shortMonths,c=Qf(r),u=tp(r),h=Qf(o),d=tp(o),f=Qf(s),p=tp(s),g=Qf(a),m=tp(a),v=Qf(l),y=tp(l),b={a:function(t){return s[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return a[t.getMonth()]},c:null,d:Ip,e:Ip,f:_p,H:Ep,I:Tp,j:wp,L:xp,m:Dp,M:Ap,p:function(t){return r[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:ng,s:ig,S:Op,u:Sp,U:Rp,V:kp,w:Np,W:Mp,x:null,X:null,y:Pp,Y:Lp,Z:Kp,"%":eg},C={a:function(t){return s[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return a[t.getUTCMonth()]},c:null,d:Bp,e:Bp,f:Vp,H:zp,I:jp,j:Gp,L:Fp,m:Hp,M:Up,p:function(t){return r[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:ng,s:ig,S:Zp,u:Wp,U:$p,V:Yp,w:Xp,W:qp,x:null,X:null,y:Jp,Y:Qp,Z:tg,"%":eg},I={a:function(t,e,n){var i=f.exec(e.slice(n));return i?(t.w=p[i[0].toLowerCase()],n+i[0].length):-1},A:function(t,e,n){var i=h.exec(e.slice(n));return i?(t.w=d[i[0].toLowerCase()],n+i[0].length):-1},b:function(t,e,n){var i=v.exec(e.slice(n));return i?(t.m=y[i[0].toLowerCase()],n+i[0].length):-1},B:function(t,e,n){var i=g.exec(e.slice(n));return i?(t.m=m[i[0].toLowerCase()],n+i[0].length):-1},c:function(t,n,i){return w(t,e,n,i)},d:hp,e:hp,f:vp,H:fp,I:fp,j:dp,L:mp,m:up,M:pp,p:function(t,e,n){var i=c.exec(e.slice(n));return i?(t.p=u[i[0].toLowerCase()],n+i[0].length):-1},q:cp,Q:bp,s:Cp,S:gp,u:np,U:ip,V:rp,w:ep,W:op,x:function(t,e,i){return w(t,n,e,i)},X:function(t,e,n){return w(t,i,e,n)},y:ap,Y:sp,Z:lp,"%":yp};function E(t,e){return function(n){var i,r,o,s=[],a=-1,l=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++a<c;)37===t.charCodeAt(a)&&(s.push(t.slice(l,a)),null!=(r=Wf[i=t.charAt(++a)])?i=t.charAt(++a):r="e"===i?" ":"0",(o=e[i])&&(i=o(n,r)),s.push(i),l=a+1);return s.push(t.slice(l,a)),s.join("")}}function T(t,e){return function(n){var i,r,o=Hf(1900,void 0,1);if(w(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(!e||"Z"in o||(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(r=(i=Vf(Hf(o.y,0,1))).getUTCDay(),i=r>4||0===r?xf.ceil(i):xf(i),i=If.offset(i,7*(o.V-1)),o.y=i.getUTCFullYear(),o.m=i.getUTCMonth(),o.d=i.getUTCDate()+(o.w+6)%7):(r=(i=Ff(Hf(o.y,0,1))).getDay(),i=r>4||0===r?Qd.ceil(i):Qd(i),i=Yd.offset(i,7*(o.V-1)),o.y=i.getFullYear(),o.m=i.getMonth(),o.d=i.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),r="Z"in o?Vf(Hf(o.y,0,1)).getUTCDay():Ff(Hf(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(r+5)%7:o.w+7*o.U-(r+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Vf(o)):Ff(o)}}function w(t,e,n,i){for(var r,o,s=0,a=e.length,l=n.length;s<a;){if(i>=l)return-1;if(37===(r=e.charCodeAt(s++))){if(r=e.charAt(s++),!(o=I[r in Wf?e.charAt(s++):r])||(i=o(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return b.x=E(n,b),b.X=E(i,b),b.c=E(e,b),C.x=E(n,C),C.X=E(i,C),C.c=E(e,C),{format:function(t){var e=E(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=T(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=E(t+="",C);return e.toString=function(){return t},e},utcParse:function(t){var e=T(t+="",!0);return e.toString=function(){return t},e}}}var Zf,Wf={"-":"",_:" ",0:"0"},$f=/^\s*\d+/,Yf=/^%/,Xf=/[\\^$*+?|[\]().{}]/g;function qf(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(e)+r:r)}function Jf(t){return t.replace(Xf,"\\$&")}function Qf(t){return new RegExp("^(?:"+t.map(Jf).join("|")+")","i")}function tp(t){for(var e={},n=-1,i=t.length;++n<i;)e[t[n].toLowerCase()]=n;return e}function ep(t,e,n){var i=$f.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function np(t,e,n){var i=$f.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function ip(t,e,n){var i=$f.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function rp(t,e,n){var i=$f.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function op(t,e,n){var i=$f.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function sp(t,e,n){var i=$f.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function ap(t,e,n){var i=$f.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function lp(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function cp(t,e,n){var i=$f.exec(e.slice(n,n+1));return i?(t.q=3*i[0]-3,n+i[0].length):-1}function up(t,e,n){var i=$f.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function hp(t,e,n){var i=$f.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function dp(t,e,n){var i=$f.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function fp(t,e,n){var i=$f.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function pp(t,e,n){var i=$f.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function gp(t,e,n){var i=$f.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function mp(t,e,n){var i=$f.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function vp(t,e,n){var i=$f.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function yp(t,e,n){var i=Yf.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function bp(t,e,n){var i=$f.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function Cp(t,e,n){var i=$f.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function Ip(t,e){return qf(t.getDate(),e,2)}function Ep(t,e){return qf(t.getHours(),e,2)}function Tp(t,e){return qf(t.getHours()%12||12,e,2)}function wp(t,e){return qf(1+Yd.count(gf(t),t),e,3)}function xp(t,e){return qf(t.getMilliseconds(),e,3)}function _p(t,e){return xp(t,e)+"000"}function Dp(t,e){return qf(t.getMonth()+1,e,2)}function Ap(t,e){return qf(t.getMinutes(),e,2)}function Op(t,e){return qf(t.getSeconds(),e,2)}function Sp(t){var e=t.getDay();return 0===e?7:e}function Rp(t,e){return qf(Jd.count(gf(t)-1,t),e,2)}function kp(t,e){var n=t.getDay();return t=n>=4||0===n?nf(t):nf.ceil(t),qf(nf.count(gf(t),t)+(4===gf(t).getDay()),e,2)}function Np(t){return t.getDay()}function Mp(t,e){return qf(Qd.count(gf(t)-1,t),e,2)}function Pp(t,e){return qf(t.getFullYear()%100,e,2)}function Lp(t,e){return qf(t.getFullYear()%1e4,e,4)}function Kp(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+qf(e/60|0,"0",2)+qf(e%60,"0",2)}function Bp(t,e){return qf(t.getUTCDate(),e,2)}function zp(t,e){return qf(t.getUTCHours(),e,2)}function jp(t,e){return qf(t.getUTCHours()%12||12,e,2)}function Gp(t,e){return qf(1+If.count(jf(t),t),e,3)}function Fp(t,e){return qf(t.getUTCMilliseconds(),e,3)}function Vp(t,e){return Fp(t,e)+"000"}function Hp(t,e){return qf(t.getUTCMonth()+1,e,2)}function Up(t,e){return qf(t.getUTCMinutes(),e,2)}function Zp(t,e){return qf(t.getUTCSeconds(),e,2)}function Wp(t){var e=t.getUTCDay();return 0===e?7:e}function $p(t,e){return qf(wf.count(jf(t)-1,t),e,2)}function Yp(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Af(t):Af.ceil(t),qf(Af.count(jf(t),t)+(4===jf(t).getUTCDay()),e,2)}function Xp(t){return t.getUTCDay()}function qp(t,e){return qf(xf.count(jf(t)-1,t),e,2)}function Jp(t,e){return qf(t.getUTCFullYear()%100,e,2)}function Qp(t,e){return qf(t.getUTCFullYear()%1e4,e,4)}function tg(){return"+0000"}function eg(){return"%"}function ng(t){return+t}function ig(t){return Math.floor(+t/1e3)}function rg(e){return Zf=Uf(e),t.timeFormat=Zf.format,t.timeParse=Zf.parse,t.utcFormat=Zf.utcFormat,t.utcParse=Zf.utcParse,Zf}rg({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var og=Date.prototype.toISOString?function(t){return t.toISOString()}:t.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),sg=+new Date("2000-01-01T00:00:00.000Z")?function(t){var e=new Date(t);return isNaN(e)?null:e}:t.utcParse("%Y-%m-%dT%H:%M:%S.%LZ"),ag=1e3,lg=6e4,cg=60*lg,ug=24*cg,hg=30*ug,dg=365*ug;function fg(t){return new Date(t)}function pg(t){return t instanceof Date?+t:+new Date(+t)}function gg(t,e,i,r,o,s,a,l,c){var u=vd(ud,ud),h=u.invert,d=u.domain,f=c(".%L"),p=c(":%S"),g=c("%I:%M"),m=c("%I %p"),v=c("%a %d"),y=c("%b %d"),b=c("%B"),C=c("%Y"),I=[[a,1,ag],[a,5,5e3],[a,15,15e3],[a,30,3e4],[s,1,lg],[s,5,5*lg],[s,15,15*lg],[s,30,30*lg],[o,1,cg],[o,3,3*cg],[o,6,6*cg],[o,12,12*cg],[r,1,ug],[r,2,2*ug],[i,1,6048e5],[e,1,hg],[e,3,3*hg],[t,1,dg]];function T(n){return(a(n)<n?f:s(n)<n?p:o(n)<n?g:r(n)<n?m:e(n)<n?i(n)<n?v:y:t(n)<n?b:C)(n)}function w(e,i,r,o){if(null==e&&(e=10),"number"==typeof e){var s=Math.abs(r-i)/e,a=n(function(t){return t[2]}).right(I,s);a===I.length?(o=E(i/dg,r/dg,e),e=t):a?(o=(a=I[s/I[a-1][2]<I[a][2]/s?a-1:a])[1],e=a[0]):(o=Math.max(E(i,r,e),1),e=l)}return null==o?e:e.every(o)}return u.invert=function(t){return new Date(h(t))},u.domain=function(t){return arguments.length?d(id.call(t,pg)):d().map(fg)},u.ticks=function(t,e){var n,i=d(),r=i[0],o=i[i.length-1],s=o<r;return s&&(n=r,r=o,o=n),n=(n=w(t,r,o,e))?n.range(r,o+1):[],s?n.reverse():n},u.tickFormat=function(t,e){return null==e?T:c(e)},u.nice=function(t,e){var n=d();return(t=w(t,n[0],n[n.length-1],e))?d(Cd(n,t)):u},u.copy=function(){return gd(u,gg(t,e,i,r,o,s,a,l,c))},u}function mg(){var t,e,n,i,r,o=0,s=1,a=ud,l=!1;function c(e){return isNaN(e=+e)?r:a(0===n?.5:(e=(i(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}return c.domain=function(r){return arguments.length?(t=i(o=+r[0]),e=i(s=+r[1]),n=t===e?0:1/(e-t),c):[o,s]},c.clamp=function(t){return arguments.length?(l=!!t,c):l},c.interpolator=function(t){return arguments.length?(a=t,c):a},c.unknown=function(t){return arguments.length?(r=t,c):r},function(r){return i=r,t=r(o),e=r(s),n=t===e?0:1/(e-t),c}}function vg(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function yg(){var t=Md(mg());return t.copy=function(){return vg(t,yg()).exponent(t.exponent())},ed.apply(t,arguments)}function bg(){var t,e,n,i,r,o,s,a=0,l=.5,c=1,u=ud,h=!1;function d(t){return isNaN(t=+t)?s:(t=.5+((t=+o(t))-e)*(t<e?i:r),u(h?Math.max(0,Math.min(1,t)):t))}return d.domain=function(s){return arguments.length?(t=o(a=+s[0]),e=o(l=+s[1]),n=o(c=+s[2]),i=t===e?0:.5/(e-t),r=e===n?0:.5/(n-e),d):[a,l,c]},d.clamp=function(t){return arguments.length?(h=!!t,d):h},d.interpolator=function(t){return arguments.length?(u=t,d):u},d.unknown=function(t){return arguments.length?(s=t,d):s},function(s){return o=s,t=s(a),e=s(l),n=s(c),i=t===e?0:.5/(e-t),r=e===n?0:.5/(n-e),d}}function Cg(){var t=Md(bg());return t.copy=function(){return vg(t,Cg()).exponent(t.exponent())},ed.apply(t,arguments)}function Ig(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(6*i,6*++i);return n}var Eg=Ig("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Tg=Ig("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),wg=Ig("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),xg=Ig("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),_g=Ig("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Dg=Ig("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Ag=Ig("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Og=Ig("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Sg=Ig("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),Rg=Ig("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function kg(t){return an(t[t.length-1])}var Ng=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Ig),Mg=kg(Ng),Pg=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Ig),Lg=kg(Pg),Kg=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Ig),Bg=kg(Kg),zg=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Ig),jg=kg(zg),Gg=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Ig),Fg=kg(Gg),Vg=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Ig),Hg=kg(Vg),Ug=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Ig),Zg=kg(Ug),Wg=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Ig),$g=kg(Wg),Yg=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Ig),Xg=kg(Yg),qg=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Ig),Jg=kg(qg),Qg=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Ig),tm=kg(Qg),em=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Ig),nm=kg(em),im=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Ig),rm=kg(im),om=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Ig),sm=kg(om),am=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Ig),lm=kg(am),cm=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Ig),um=kg(cm),hm=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Ig),dm=kg(hm),fm=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Ig),pm=kg(fm),gm=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Ig),mm=kg(gm),vm=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Ig),ym=kg(vm),bm=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Ig),Cm=kg(bm),Im=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Ig),Em=kg(Im),Tm=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Ig),wm=kg(Tm),xm=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Ig),_m=kg(xm),Dm=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Ig),Am=kg(Dm),Om=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Ig),Sm=kg(Om),Rm=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Ig),km=kg(Rm),Nm=Vn(Ye(300,.5,0),Ye(-240,.5,1)),Mm=Vn(Ye(-100,.75,.35),Ye(80,1.5,.8)),Pm=Vn(Ye(260,.75,.35),Ye(80,1.5,.8)),Lm=Ye(),Km=he(),Bm=Math.PI/3,zm=2*Math.PI/3;function jm(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var Gm=jm(Ig("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Fm=jm(Ig("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Vm=jm(Ig("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Hm=jm(Ig("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Um(t){return function(){return t}}var Zm=Math.abs,Wm=Math.atan2,$m=Math.cos,Ym=Math.max,Xm=Math.min,qm=Math.sin,Jm=Math.sqrt,Qm=1e-12,tv=Math.PI,ev=tv/2,nv=2*tv;function iv(t){return t>=1?ev:t<=-1?-ev:Math.asin(t)}function rv(t){return t.innerRadius}function ov(t){return t.outerRadius}function sv(t){return t.startAngle}function av(t){return t.endAngle}function lv(t){return t&&t.padAngle}function cv(t,e,n,i,r,o,s){var a=t-n,l=e-i,c=(s?o:-o)/Jm(a*a+l*l),u=c*l,h=-c*a,d=t+u,f=e+h,p=n+u,g=i+h,m=(d+p)/2,v=(f+g)/2,y=p-d,b=g-f,C=y*y+b*b,I=r-o,E=d*g-p*f,T=(b<0?-1:1)*Jm(Ym(0,I*I*C-E*E)),w=(E*b-y*T)/C,x=(-E*y-b*T)/C,_=(E*b+y*T)/C,D=(-E*y+b*T)/C,A=w-m,O=x-v,S=_-m,R=D-v;return A*A+O*O>S*S+R*R&&(w=_,x=D),{cx:w,cy:x,x01:-u,y01:-h,x11:w*(r/I-1),y11:x*(r/I-1)}}function uv(t){this._context=t}function hv(t){return new uv(t)}function dv(t){return t[0]}function fv(t){return t[1]}function pv(){var t=dv,e=fv,n=Um(!0),i=null,r=hv,o=null;function s(s){var a,l,c,u=s.length,h=!1;for(null==i&&(o=r(c=Nr())),a=0;a<=u;++a)!(a<u&&n(l=s[a],a,s))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+t(l,a,s),+e(l,a,s));if(c)return o=null,c+""||null}return s.x=function(e){return arguments.length?(t="function"==typeof e?e:Um(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:Um(+t),s):e},s.defined=function(t){return arguments.length?(n="function"==typeof t?t:Um(!!t),s):n},s.curve=function(t){return arguments.length?(r=t,null!=i&&(o=r(i)),s):r},s.context=function(t){return arguments.length?(null==t?i=o=null:o=r(i=t),s):i},s}function gv(){var t=dv,e=null,n=Um(0),i=fv,r=Um(!0),o=null,s=hv,a=null;function l(l){var c,u,h,d,f,p=l.length,g=!1,m=new Array(p),v=new Array(p);for(null==o&&(a=s(f=Nr())),c=0;c<=p;++c){if(!(c<p&&r(d=l[c],c,l))===g)if(g=!g)u=c,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=c-1;h>=u;--h)a.point(m[h],v[h]);a.lineEnd(),a.areaEnd()}g&&(m[c]=+t(d,c,l),v[c]=+n(d,c,l),a.point(e?+e(d,c,l):m[c],i?+i(d,c,l):v[c]))}if(f)return a=null,f+""||null}function c(){return pv().defined(r).curve(s).context(o)}return l.x=function(n){return arguments.length?(t="function"==typeof n?n:Um(+n),e=null,l):t},l.x0=function(e){return arguments.length?(t="function"==typeof e?e:Um(+e),l):t},l.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:Um(+t),l):e},l.y=function(t){return arguments.length?(n="function"==typeof t?t:Um(+t),i=null,l):n},l.y0=function(t){return arguments.length?(n="function"==typeof t?t:Um(+t),l):n},l.y1=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:Um(+t),l):i},l.lineX0=l.lineY0=function(){return c().x(t).y(n)},l.lineY1=function(){return c().x(t).y(i)},l.lineX1=function(){return c().x(e).y(n)},l.defined=function(t){return arguments.length?(r="function"==typeof t?t:Um(!!t),l):r},l.curve=function(t){return arguments.length?(s=t,null!=o&&(a=s(o)),l):s},l.context=function(t){return arguments.length?(null==t?o=a=null:a=s(o=t),l):o},l}function mv(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function vv(t){return t}uv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var yv=Cv(hv);function bv(t){this._curve=t}function Cv(t){function e(e){return new bv(t(e))}return e._curve=t,e}function Iv(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(Cv(t)):e()._curve},t}function Ev(){return Iv(pv().curve(yv))}function Tv(){var t=gv().curve(yv),e=t.curve,n=t.lineX0,i=t.lineX1,r=t.lineY0,o=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return Iv(n())},delete t.lineX0,t.lineEndAngle=function(){return Iv(i())},delete t.lineX1,t.lineInnerRadius=function(){return Iv(r())},delete t.lineY0,t.lineOuterRadius=function(){return Iv(o())},delete t.lineY1,t.curve=function(t){return arguments.length?e(Cv(t)):e()._curve},t}function wv(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}bv.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var xv=Array.prototype.slice;function _v(t){return t.source}function Dv(t){return t.target}function Av(t){var e=_v,n=Dv,i=dv,r=fv,o=null;function s(){var s,a=xv.call(arguments),l=e.apply(this,a),c=n.apply(this,a);if(o||(o=s=Nr()),t(o,+i.apply(this,(a[0]=l,a)),+r.apply(this,a),+i.apply(this,(a[0]=c,a)),+r.apply(this,a)),s)return o=null,s+""||null}return s.source=function(t){return arguments.length?(e=t,s):e},s.target=function(t){return arguments.length?(n=t,s):n},s.x=function(t){return arguments.length?(i="function"==typeof t?t:Um(+t),s):i},s.y=function(t){return arguments.length?(r="function"==typeof t?t:Um(+t),s):r},s.context=function(t){return arguments.length?(o=null==t?null:t,s):o},s}function Ov(t,e,n,i,r){t.moveTo(e,n),t.bezierCurveTo(e=(e+i)/2,n,e,r,i,r)}function Sv(t,e,n,i,r){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+r)/2,i,n,i,r)}function Rv(t,e,n,i,r){var o=wv(e,n),s=wv(e,n=(n+r)/2),a=wv(i,n),l=wv(i,r);t.moveTo(o[0],o[1]),t.bezierCurveTo(s[0],s[1],a[0],a[1],l[0],l[1])}var kv={draw:function(t,e){var n=Math.sqrt(e/tv);t.moveTo(n,0),t.arc(0,0,n,0,nv)}},Nv={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},Mv=Math.sqrt(1/3),Pv=2*Mv,Lv={draw:function(t,e){var n=Math.sqrt(e/Pv),i=n*Mv;t.moveTo(0,-n),t.lineTo(i,0),t.lineTo(0,n),t.lineTo(-i,0),t.closePath()}},Kv=Math.sin(tv/10)/Math.sin(7*tv/10),Bv=Math.sin(nv/10)*Kv,zv=-Math.cos(nv/10)*Kv,jv={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),i=Bv*n,r=zv*n;t.moveTo(0,-n),t.lineTo(i,r);for(var o=1;o<5;++o){var s=nv*o/5,a=Math.cos(s),l=Math.sin(s);t.lineTo(l*n,-a*n),t.lineTo(a*i-l*r,l*i+a*r)}t.closePath()}},Gv={draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n)}},Fv=Math.sqrt(3),Vv={draw:function(t,e){var n=-Math.sqrt(e/(3*Fv));t.moveTo(0,2*n),t.lineTo(-Fv*n,-n),t.lineTo(Fv*n,-n),t.closePath()}},Hv=Math.sqrt(3)/2,Uv=1/Math.sqrt(12),Zv=3*(Uv/2+1),Wv={draw:function(t,e){var n=Math.sqrt(e/Zv),i=n/2,r=n*Uv,o=i,s=n*Uv+n,a=-o,l=s;t.moveTo(i,r),t.lineTo(o,s),t.lineTo(a,l),t.lineTo(-.5*i-Hv*r,Hv*i+-.5*r),t.lineTo(-.5*o-Hv*s,Hv*o+-.5*s),t.lineTo(-.5*a-Hv*l,Hv*a+-.5*l),t.lineTo(-.5*i+Hv*r,-.5*r-Hv*i),t.lineTo(-.5*o+Hv*s,-.5*s-Hv*o),t.lineTo(-.5*a+Hv*l,-.5*l-Hv*a),t.closePath()}},$v=[kv,Nv,Lv,Gv,jv,Vv,Wv];function Yv(){}function Xv(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function qv(t){this._context=t}function Jv(t){this._context=t}function Qv(t){this._context=t}function ty(t,e){this._basis=new qv(t),this._beta=e}qv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Xv(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Xv(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Jv.prototype={areaStart:Yv,areaEnd:Yv,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Xv(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Qv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Xv(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ty.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var i,r=t[0],o=e[0],s=t[n]-r,a=e[n]-o,l=-1;++l<=n;)i=l/n,this._basis.point(this._beta*t[l]+(1-this._beta)*(r+i*s),this._beta*e[l]+(1-this._beta)*(o+i*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var ey=function t(e){function n(t){return 1===e?new qv(t):new ty(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function ny(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function iy(t,e){this._context=t,this._k=(1-e)/6}iy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ny(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:ny(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var ry=function t(e){function n(t){return new iy(t,e)}return n.tension=function(e){return t(+e)},n}(0);function oy(t,e){this._context=t,this._k=(1-e)/6}oy.prototype={areaStart:Yv,areaEnd:Yv,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:ny(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var sy=function t(e){function n(t){return new oy(t,e)}return n.tension=function(e){return t(+e)},n}(0);function ay(t,e){this._context=t,this._k=(1-e)/6}ay.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ny(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var ly=function t(e){function n(t){return new ay(t,e)}return n.tension=function(e){return t(+e)},n}(0);function cy(t,e,n){var i=t._x1,r=t._y1,o=t._x2,s=t._y2;if(t._l01_a>Qm){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,r=(r*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>Qm){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,u=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*c+t._x1*t._l23_2a-e*t._l12_2a)/u,s=(s*c+t._y1*t._l23_2a-n*t._l12_2a)/u}t._context.bezierCurveTo(i,r,o,s,t._x2,t._y2)}function uy(t,e){this._context=t,this._alpha=e}uy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:cy(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var hy=function t(e){function n(t){return e?new uy(t,e):new iy(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function dy(t,e){this._context=t,this._alpha=e}dy.prototype={areaStart:Yv,areaEnd:Yv,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:cy(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var fy=function t(e){function n(t){return e?new dy(t,e):new oy(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function py(t,e){this._context=t,this._alpha=e}py.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:cy(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var gy=function t(e){function n(t){return e?new py(t,e):new ay(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function my(t){this._context=t}function vy(t){return t<0?-1:1}function yy(t,e,n){var i=t._x1-t._x0,r=e-t._x1,o=(t._y1-t._y0)/(i||r<0&&-0),s=(n-t._y1)/(r||i<0&&-0),a=(o*r+s*i)/(i+r);return(vy(o)+vy(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function by(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Cy(t,e,n){var i=t._x0,r=t._y0,o=t._x1,s=t._y1,a=(o-i)/3;t._context.bezierCurveTo(i+a,r+a*e,o-a,s-a*n,o,s)}function Iy(t){this._context=t}function Ey(t){this._context=new Ty(t)}function Ty(t){this._context=t}function wy(t){this._context=t}function xy(t){var e,n,i=t.length-1,r=new Array(i),o=new Array(i),s=new Array(i);for(r[0]=0,o[0]=2,s[0]=t[0]+2*t[1],e=1;e<i-1;++e)r[e]=1,o[e]=4,s[e]=4*t[e]+2*t[e+1];for(r[i-1]=2,o[i-1]=7,s[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=r[e]/o[e-1],o[e]-=n,s[e]-=n*s[e-1];for(r[i-1]=s[i-1]/o[i-1],e=i-2;e>=0;--e)r[e]=(s[e]-r[e+1])/o[e];for(o[i-1]=(t[i]+r[i-1])/2,e=0;e<i-1;++e)o[e]=2*t[e+1]-r[e+1];return[r,o]}function _y(t,e){this._context=t,this._t=e}function Dy(t,e){if((r=t.length)>1)for(var n,i,r,o=1,s=t[e[0]],a=s.length;o<r;++o)for(i=s,s=t[e[o]],n=0;n<a;++n)s[n][1]+=s[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function Ay(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function Oy(t,e){return t[e]}function Sy(t){var e=t.map(Ry);return Ay(t).sort(function(t,n){return e[t]-e[n]})}function Ry(t){for(var e,n=-1,i=0,r=t.length,o=-1/0;++n<r;)(e=+t[n][1])>o&&(o=e,i=n);return i}function ky(t){var e=t.map(Ny);return Ay(t).sort(function(t,n){return e[t]-e[n]})}function Ny(t){for(var e,n=0,i=-1,r=t.length;++i<r;)(e=+t[i][1])&&(n+=e);return n}function My(t){return function(){return t}}function Py(t){return t[0]}function Ly(t){return t[1]}function Ky(){this._=null}function By(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function zy(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function jy(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function Gy(t){for(;t.L;)t=t.L;return t}function Fy(t,e,n,i){var r=[null,null],o=db.push(r)-1;return r.left=t,r.right=e,n&&Hy(r,t,e,n),i&&Hy(r,e,t,i),ub[t.index].halfedges.push(o),ub[e.index].halfedges.push(o),r}function Vy(t,e,n){var i=[e,n];return i.left=t,i}function Hy(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function Uy(t,e,n,i,r){var o,s=t[0],a=t[1],l=s[0],c=s[1],u=0,h=1,d=a[0]-l,f=a[1]-c;if(o=e-l,d||!(o>0)){if(o/=d,d<0){if(o<u)return;o<h&&(h=o)}else if(d>0){if(o>h)return;o>u&&(u=o)}if(o=i-l,d||!(o<0)){if(o/=d,d<0){if(o>h)return;o>u&&(u=o)}else if(d>0){if(o<u)return;o<h&&(h=o)}if(o=n-c,f||!(o>0)){if(o/=f,f<0){if(o<u)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>u&&(u=o)}if(o=r-c,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>u&&(u=o)}else if(f>0){if(o<u)return;o<h&&(h=o)}return!(u>0||h<1)||(u>0&&(t[0]=[l+u*d,c+u*f]),h<1&&(t[1]=[l+h*d,c+h*f]),!0)}}}}}function Zy(t,e,n,i,r){var o=t[1];if(o)return!0;var s,a,l=t[0],c=t.left,u=t.right,h=c[0],d=c[1],f=u[0],p=u[1],g=(h+f)/2,m=(d+p)/2;if(p===d){if(g<e||g>=i)return;if(h>f){if(l){if(l[1]>=r)return}else l=[g,n];o=[g,r]}else{if(l){if(l[1]<n)return}else l=[g,r];o=[g,n]}}else if(a=m-(s=(h-f)/(p-d))*g,s<-1||s>1)if(h>f){if(l){if(l[1]>=r)return}else l=[(n-a)/s,n];o=[(r-a)/s,r]}else{if(l){if(l[1]<n)return}else l=[(r-a)/s,r];o=[(n-a)/s,n]}else if(d<p){if(l){if(l[0]>=i)return}else l=[e,s*e+a];o=[i,s*i+a]}else{if(l){if(l[0]<e)return}else l=[i,s*i+a];o=[e,s*e+a]}return t[0]=l,t[1]=o,!0}function Wy(t,e){var n=t.site,i=e.left,r=e.right;return n===r&&(r=i,i=n),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(n===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function $y(t,e){return e[+(e.left!==t.site)]}function Yy(t,e){return e[+(e.left===t.site)]}my.prototype={areaStart:Yv,areaEnd:Yv,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},Iy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Cy(this,this._t0,by(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Cy(this,by(this,n=yy(this,t,e)),n);break;default:Cy(this,this._t0,n=yy(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Ey.prototype=Object.create(Iy.prototype)).point=function(t,e){Iy.prototype.point.call(this,e,t)},Ty.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,o){this._context.bezierCurveTo(e,t,i,n,o,r)}},wy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var i=xy(t),r=xy(e),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(i[0][o],r[0][o],i[1][o],r[1][o],t[s],e[s]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},_y.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}},Ky.prototype={constructor:Ky,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Gy(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(zy(this,n),n=(t=n).U),n.C=!1,i.C=!0,jy(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(jy(this,n),n=(t=n).U),n.C=!1,i.C=!0,zy(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,s=t.R;if(n=o?s?Gy(s):o:s,r?r.L===t?r.L=n:r.R=n:this._=n,o&&s?(i=n.C,n.C=t.C,n.L=o,o.U=n,n!==s?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=s,s.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,zy(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,jy(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,zy(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,jy(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,zy(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,jy(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}};var Xy,qy=[];function Jy(){By(this),this.x=this.y=this.arc=this.site=this.cy=null}function Qy(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var s=r[0],a=r[1],l=i[0]-s,c=i[1]-a,u=o[0]-s,h=o[1]-a,d=2*(l*h-c*u);if(!(d>=-pb)){var f=l*l+c*c,p=u*u+h*h,g=(h*f-c*p)/d,m=(l*p-u*f)/d,v=qy.pop()||new Jy;v.arc=t,v.site=r,v.x=g+s,v.y=(v.cy=m+a)+Math.sqrt(g*g+m*m),t.circle=v;for(var y=null,b=hb._;b;)if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}hb.insert(y,v),y||(Xy=v)}}}}function tb(t){var e=t.circle;e&&(e.P||(Xy=e.N),hb.remove(e),qy.push(e),By(e),t.circle=null)}var eb=[];function nb(){By(this),this.edge=this.site=this.circle=null}function ib(t){var e=eb.pop()||new nb;return e.site=t,e}function rb(t){tb(t),cb.remove(t),eb.push(t),By(t)}function ob(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],o=t.P,s=t.N,a=[t];rb(t);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<fb&&Math.abs(i-l.circle.cy)<fb;)o=l.P,a.unshift(l),rb(l),l=o;a.unshift(l),tb(l);for(var c=s;c.circle&&Math.abs(n-c.circle.x)<fb&&Math.abs(i-c.circle.cy)<fb;)s=c.N,a.push(c),rb(c),c=s;a.push(c),tb(c);var u,h=a.length;for(u=1;u<h;++u)c=a[u],l=a[u-1],Hy(c.edge,l.site,c.site,r);l=a[0],(c=a[h-1]).edge=Fy(l.site,c.site,null,r),Qy(l),Qy(c)}function sb(t){for(var e,n,i,r,o=t[0],s=t[1],a=cb._;a;)if((i=ab(a,s)-o)>fb)a=a.L;else{if(!((r=o-lb(a,s))>fb)){i>-fb?(e=a.P,n=a):r>-fb?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}!function(t){ub[t.index]={site:t,halfedges:[]}}(t);var l=ib(t);if(cb.insert(e,l),e||n){if(e===n)return tb(e),n=ib(e.site),cb.insert(l,n),l.edge=n.edge=Fy(e.site,l.site),Qy(e),void Qy(n);if(n){tb(e),tb(n);var c=e.site,u=c[0],h=c[1],d=t[0]-u,f=t[1]-h,p=n.site,g=p[0]-u,m=p[1]-h,v=2*(d*m-f*g),y=d*d+f*f,b=g*g+m*m,C=[(m*y-f*b)/v+u,(d*b-g*y)/v+h];Hy(n.edge,c,p,C),l.edge=Fy(c,t,null,C),n.edge=Fy(t,p,null,C),Qy(e),Qy(n)}else l.edge=Fy(e.site,l.site)}}function ab(t,e){var n=t.site,i=n[0],r=n[1],o=r-e;if(!o)return i;var s=t.P;if(!s)return-1/0;var a=(n=s.site)[0],l=n[1],c=l-e;if(!c)return a;var u=a-i,h=1/o-1/c,d=u/c;return h?(-d+Math.sqrt(d*d-2*h*(u*u/(-2*c)-l+c/2+r-o/2)))/h+i:(i+a)/2}function lb(t,e){var n=t.N;if(n)return ab(n,e);var i=t.site;return i[1]===e?i[0]:1/0}var cb,ub,hb,db,fb=1e-6,pb=1e-12;function gb(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function mb(t,e){return e[1]-t[1]||e[0]-t[0]}function vb(t,e){var n,i,r,o=t.sort(mb).pop();for(db=[],ub=new Array(t.length),cb=new Ky,hb=new Ky;;)if(r=Xy,o&&(!r||o[1]<r.y||o[1]===r.y&&o[0]<r.x))o[0]===n&&o[1]===i||(sb(o),n=o[0],i=o[1]),o=t.pop();else{if(!r)break;ob(r.arc)}if(function(){for(var t,e,n,i,r=0,o=ub.length;r<o;++r)if((t=ub[r])&&(i=(e=t.halfedges).length)){var s=new Array(i),a=new Array(i);for(n=0;n<i;++n)s[n]=n,a[n]=Wy(t,db[e[n]]);for(s.sort(function(t,e){return a[e]-a[t]}),n=0;n<i;++n)a[n]=e[s[n]];for(n=0;n<i;++n)e[n]=a[n]}}(),e){var s=+e[0][0],a=+e[0][1],l=+e[1][0],c=+e[1][1];!function(t,e,n,i){for(var r,o=db.length;o--;)Zy(r=db[o],t,e,n,i)&&Uy(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>fb||Math.abs(r[0][1]-r[1][1])>fb)||delete db[o]}(s,a,l,c),function(t,e,n,i){var r,o,s,a,l,c,u,h,d,f,p,g,m=ub.length,v=!0;for(r=0;r<m;++r)if(o=ub[r]){for(s=o.site,a=(l=o.halfedges).length;a--;)db[l[a]]||l.splice(a,1);for(a=0,c=l.length;a<c;)p=(f=Yy(o,db[l[a]]))[0],g=f[1],h=(u=$y(o,db[l[++a%c]]))[0],d=u[1],(Math.abs(p-h)>fb||Math.abs(g-d)>fb)&&(l.splice(a,0,db.push(Vy(s,f,Math.abs(p-t)<fb&&i-g>fb?[t,Math.abs(h-t)<fb?d:i]:Math.abs(g-i)<fb&&n-p>fb?[Math.abs(d-i)<fb?h:n,i]:Math.abs(p-n)<fb&&g-e>fb?[n,Math.abs(h-n)<fb?d:e]:Math.abs(g-e)<fb&&p-t>fb?[Math.abs(d-e)<fb?h:t,e]:null))-1),++c);c&&(v=!1)}if(v){var y,b,C,I=1/0;for(r=0,v=null;r<m;++r)(o=ub[r])&&(C=(y=(s=o.site)[0]-t)*y+(b=s[1]-e)*b)<I&&(I=C,v=o);if(v){var E=[t,e],T=[t,i],w=[n,i],x=[n,e];v.halfedges.push(db.push(Vy(s=v.site,E,T))-1,db.push(Vy(s,T,w))-1,db.push(Vy(s,w,x))-1,db.push(Vy(s,x,E))-1)}}for(r=0;r<m;++r)(o=ub[r])&&(o.halfedges.length||delete ub[r])}(s,a,l,c)}this.edges=db,this.cells=ub,cb=hb=db=ub=null}function yb(t){return function(){return t}}function bb(t,e,n){this.target=t,this.type=e,this.transform=n}function Cb(t,e,n){this.k=t,this.x=e,this.y=n}vb.prototype={constructor:vb,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(n){return $y(e,t[n])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,i){if(o=(r=n.halfedges).length)for(var r,o,s,a=n.site,l=-1,c=e[r[o-1]],u=c.left===a?c.right:c.left;++l<o;)s=u,u=(c=e[r[l]]).left===a?c.right:c.left,s&&u&&i<s.index&&i<u.index&&gb(a,s,u)<0&&t.push([a.data,s.data,u.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var i,r,o=this,s=o._found||0,a=o.cells.length;!(r=o.cells[s]);)if(++s>=a)return null;var l=t-r.site[0],c=e-r.site[1],u=l*l+c*c;do{r=o.cells[i=s],s=null,r.halfedges.forEach(function(n){var i=o.edges[n],a=i.left;if(a!==r.site&&a||(a=i.right)){var l=t-a[0],c=e-a[1],h=l*l+c*c;h<u&&(u=h,s=a.index)}})}while(null!==s);return o._found=i,null==n||u<=n*n?r.site:null}},Cb.prototype={constructor:Cb,scale:function(t){return 1===t?this:new Cb(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Cb(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ib=new Cb(1,0,0);function Eb(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Ib;return t.__zoom}function Tb(){t.event.stopImmediatePropagation()}function wb(){t.event.preventDefault(),t.event.stopImmediatePropagation()}function xb(){return!t.event.ctrlKey&&!t.event.button}function _b(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Db(){return this.__zoom||Ib}function Ab(){return-t.event.deltaY*(1===t.event.deltaMode?.05:t.event.deltaMode?1:.002)}function Ob(){return navigator.maxTouchPoints||"ontouchstart"in this}function Sb(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}Eb.prototype=Cb.prototype,t.FormatSpecifier=ds,t.active=function(t,e){var n,i,r=t.__transition;if(r)for(i in e=null==e?null:e+"",r)if((n=r[i]).state>1&&n.name===e)return new wi([[t]],Xi,e,+i);return null},t.arc=function(){var t=rv,e=ov,n=Um(0),i=null,r=sv,o=av,s=lv,a=null;function l(){var l,c,u=+t.apply(this,arguments),h=+e.apply(this,arguments),d=r.apply(this,arguments)-ev,f=o.apply(this,arguments)-ev,p=Zm(f-d),g=f>d;if(a||(a=l=Nr()),h<u&&(c=h,h=u,u=c),h>Qm)if(p>nv-Qm)a.moveTo(h*$m(d),h*qm(d)),a.arc(0,0,h,d,f,!g),u>Qm&&(a.moveTo(u*$m(f),u*qm(f)),a.arc(0,0,u,f,d,g));else{var m,v,y=d,b=f,C=d,I=f,E=p,T=p,w=s.apply(this,arguments)/2,x=w>Qm&&(i?+i.apply(this,arguments):Jm(u*u+h*h)),_=Xm(Zm(h-u)/2,+n.apply(this,arguments)),D=_,A=_;if(x>Qm){var O=iv(x/u*qm(w)),S=iv(x/h*qm(w));(E-=2*O)>Qm?(C+=O*=g?1:-1,I-=O):(E=0,C=I=(d+f)/2),(T-=2*S)>Qm?(y+=S*=g?1:-1,b-=S):(T=0,y=b=(d+f)/2)}var R=h*$m(y),k=h*qm(y),N=u*$m(I),M=u*qm(I);if(_>Qm){var P,L=h*$m(b),K=h*qm(b),B=u*$m(C),z=u*qm(C);if(p<tv&&(P=function(t,e,n,i,r,o,s,a){var l=n-t,c=i-e,u=s-r,h=a-o,d=h*l-u*c;if(!(d*d<Qm))return[t+(d=(u*(e-o)-h*(t-r))/d)*l,e+d*c]}(R,k,B,z,L,K,N,M))){var j=R-P[0],G=k-P[1],F=L-P[0],V=K-P[1],H=1/qm(function(t){return t>1?0:t<-1?tv:Math.acos(t)}((j*F+G*V)/(Jm(j*j+G*G)*Jm(F*F+V*V)))/2),U=Jm(P[0]*P[0]+P[1]*P[1]);D=Xm(_,(u-U)/(H-1)),A=Xm(_,(h-U)/(H+1))}}T>Qm?A>Qm?(m=cv(B,z,R,k,h,A,g),v=cv(L,K,N,M,h,A,g),a.moveTo(m.cx+m.x01,m.cy+m.y01),A<_?a.arc(m.cx,m.cy,A,Wm(m.y01,m.x01),Wm(v.y01,v.x01),!g):(a.arc(m.cx,m.cy,A,Wm(m.y01,m.x01),Wm(m.y11,m.x11),!g),a.arc(0,0,h,Wm(m.cy+m.y11,m.cx+m.x11),Wm(v.cy+v.y11,v.cx+v.x11),!g),a.arc(v.cx,v.cy,A,Wm(v.y11,v.x11),Wm(v.y01,v.x01),!g))):(a.moveTo(R,k),a.arc(0,0,h,y,b,!g)):a.moveTo(R,k),u>Qm&&E>Qm?D>Qm?(m=cv(N,M,L,K,u,-D,g),v=cv(R,k,B,z,u,-D,g),a.lineTo(m.cx+m.x01,m.cy+m.y01),D<_?a.arc(m.cx,m.cy,D,Wm(m.y01,m.x01),Wm(v.y01,v.x01),!g):(a.arc(m.cx,m.cy,D,Wm(m.y01,m.x01),Wm(m.y11,m.x11),!g),a.arc(0,0,u,Wm(m.cy+m.y11,m.cx+m.x11),Wm(v.cy+v.y11,v.cx+v.x11),g),a.arc(v.cx,v.cy,D,Wm(v.y11,v.x11),Wm(v.y01,v.x01),!g))):a.arc(0,0,u,I,C,g):a.lineTo(N,M)}else a.moveTo(0,0);if(a.closePath(),l)return a=null,l+""||null}return l.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-tv/2;return[$m(i)*n,qm(i)*n]},l.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:Um(+e),l):t},l.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:Um(+t),l):e},l.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:Um(+t),l):n},l.padRadius=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:Um(+t),l):i},l.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:Um(+t),l):r},l.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:Um(+t),l):o},l.padAngle=function(t){return arguments.length?(s="function"==typeof t?t:Um(+t),l):s},l.context=function(t){return arguments.length?(a=null==t?null:t,l):a},l},t.area=gv,t.areaRadial=Tv,t.ascending=e,t.autoType=function(t){for(var e in t){var n,i,r=t[e].trim();if(r)if("true"===r)r=!0;else if("false"===r)r=!1;else if("NaN"===r)r=NaN;else if(isNaN(n=+r)){if(!(i=r.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;Ro&&i[4]&&!i[7]&&(r=r.replace(/-/g,"/").replace(/T/," ")),r=new Date(r)}else r=n;else r=null;t[e]=r}return t},t.axisBottom=function(t){return L(3,t)},t.axisLeft=function(t){return L(4,t)},t.axisRight=function(t){return L(2,t)},t.axisTop=function(t){return L(1,t)},t.bisect=r,t.bisectLeft=o,t.bisectRight=r,t.bisector=n,t.blob=function(t,e){return fetch(t,e).then(ko)},t.brush=function(){return Cr(cr)},t.brushSelection=function(t){var e=t.__brush;return e?e.dim.output(e.selection):null},t.brushX=function(){return Cr(ar)},t.brushY=function(){return Cr(lr)},t.buffer=function(t,e){return fetch(t,e).then(No)},t.chord=function(){var t=0,e=null,n=null,i=null;function r(r){var o,s,a,l,c,u,h=r.length,d=[],f=m(h),p=[],g=[],v=g.groups=new Array(h),y=new Array(h*h);for(o=0,c=-1;++c<h;){for(s=0,u=-1;++u<h;)s+=r[c][u];d.push(s),p.push(m(h)),o+=s}for(e&&f.sort(function(t,n){return e(d[t],d[n])}),n&&p.forEach(function(t,e){t.sort(function(t,i){return n(r[e][t],r[e][i])})}),l=(o=_r(0,xr-t*h)/o)?t:xr/h,s=0,c=-1;++c<h;){for(a=s,u=-1;++u<h;){var b=f[c],C=p[b][u],I=r[b][C],E=s,T=s+=I*o;y[C*h+b]={index:b,subindex:C,startAngle:E,endAngle:T,value:I}}v[b]={index:b,startAngle:a,endAngle:s,value:d[b]},s+=l}for(c=-1;++c<h;)for(u=c-1;++u<h;){var w=y[u*h+c],x=y[c*h+u];(w.value||x.value)&&g.push(w.value<x.value?{source:x,target:w}:{source:w,target:x})}return i?g.sort(i):g}return r.padAngle=function(e){return arguments.length?(t=_r(0,e),r):t},r.sortGroups=function(t){return arguments.length?(e=t,r):e},r.sortSubgroups=function(t){return arguments.length?(n=t,r):n},r.sortChords=function(t){return arguments.length?(null==t?i=null:(i=function(t){return function(e,n){return t(e.source.value+e.target.value,n.source.value+n.target.value)}}(t))._=t,r):i&&i._},r},t.clientPoint=kt,t.cluster=function(){var t=qu,e=1,n=1,i=!1;function r(r){var o,s=0;r.eachAfter(function(e){var n=e.children;n?(e.x=function(t){return t.reduce(Ju,0)/t.length}(n),e.y=function(t){return 1+t.reduce(Qu,0)}(n)):(e.x=o?s+=t(e,o):0,e.y=0,o=e)});var a=function(t){for(var e;e=t.children;)t=e[0];return t}(r),l=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(r),c=a.x-t(a,l)/2,u=l.x+t(l,a)/2;return r.eachAfter(i?function(t){t.x=(t.x-r.x)*e,t.y=(r.y-t.y)*n}:function(t){t.x=(t.x-c)/(u-c)*e,t.y=(1-(r.y?t.y/r.y:1))*n})}return r.separation=function(e){return arguments.length?(t=e,r):t},r.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],r):i?null:[e,n]},r.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],r):i?[e,n]:null},r},t.color=ae,t.contourDensity=function(){var t=oo,e=so,n=ao,i=960,r=500,o=20,s=2,a=3*o,l=i+2*a>>s,c=r+2*a>>s,u=Xr(20);function h(i){var r=new Float32Array(l*c),h=new Float32Array(l*c);i.forEach(function(i,o,u){var h=+t(i,o,u)+a>>s,d=+e(i,o,u)+a>>s,f=+n(i,o,u);h>=0&&h<l&&d>=0&&d<c&&(r[h+d*l]+=f)}),io({width:l,height:c,data:r},{width:l,height:c,data:h},o>>s),ro({width:l,height:c,data:h},{width:l,height:c,data:r},o>>s),io({width:l,height:c,data:r},{width:l,height:c,data:h},o>>s),ro({width:l,height:c,data:h},{width:l,height:c,data:r},o>>s),io({width:l,height:c,data:r},{width:l,height:c,data:h},o>>s),ro({width:l,height:c,data:h},{width:l,height:c,data:r},o>>s);var f=u(r);if(!Array.isArray(f)){var p=x(r);f=E(0,p,f),(f=m(0,Math.floor(p/f)*f,f)).shift()}return no().thresholds(f).size([l,c])(r).map(d)}function d(t){return t.value*=Math.pow(2,-2*s),t.coordinates.forEach(f),t}function f(t){t.forEach(p)}function p(t){t.forEach(g)}function g(t){t[0]=t[0]*Math.pow(2,s)-a,t[1]=t[1]*Math.pow(2,s)-a}function v(){return l=i+2*(a=3*o)>>s,c=r+2*a>>s,h}return h.x=function(e){return arguments.length?(t="function"==typeof e?e:Xr(+e),h):t},h.y=function(t){return arguments.length?(e="function"==typeof t?t:Xr(+t),h):e},h.weight=function(t){return arguments.length?(n="function"==typeof t?t:Xr(+t),h):n},h.size=function(t){if(!arguments.length)return[i,r];var e=Math.ceil(t[0]),n=Math.ceil(t[1]);if(!(e>=0||e>=0))throw new Error("invalid size");return i=e,r=n,v()},h.cellSize=function(t){if(!arguments.length)return 1<<s;if(!((t=+t)>=1))throw new Error("invalid cell size");return s=Math.floor(Math.log(t)/Math.LN2),v()},h.thresholds=function(t){return arguments.length?(u="function"==typeof t?t:Array.isArray(t)?Xr($r.call(t)):Xr(t),h):u},h.bandwidth=function(t){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return o=Math.round((Math.sqrt(4*t*t+1)-1)/2),v()},h},t.contours=no,t.create=function(t){return Dt(U(t).call(document.documentElement))},t.creator=U,t.cross=function(t,e,n){var i,r,o,a,l=t.length,c=e.length,u=new Array(l*c);for(null==n&&(n=s),i=o=0;i<l;++i)for(a=t[i],r=0;r<c;++r,++o)u[o]=n(a,e[r]);return u},t.csv=Ko,t.csvFormat=yo,t.csvFormatBody=bo,t.csvFormatRow=Io,t.csvFormatRows=Co,t.csvFormatValue=Eo,t.csvParse=mo,t.csvParseRows=vo,t.cubehelix=Ye,t.curveBasis=function(t){return new qv(t)},t.curveBasisClosed=function(t){return new Jv(t)},t.curveBasisOpen=function(t){return new Qv(t)},t.curveBundle=ey,t.curveCardinal=ry,t.curveCardinalClosed=sy,t.curveCardinalOpen=ly,t.curveCatmullRom=hy,t.curveCatmullRomClosed=fy,t.curveCatmullRomOpen=gy,t.curveLinear=hv,t.curveLinearClosed=function(t){return new my(t)},t.curveMonotoneX=function(t){return new Iy(t)},t.curveMonotoneY=function(t){return new Ey(t)},t.curveNatural=function(t){return new wy(t)},t.curveStep=function(t){return new _y(t,.5)},t.curveStepAfter=function(t){return new _y(t,1)},t.curveStepBefore=function(t){return new _y(t,0)},t.customEvent=Et,t.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},t.deviation=c,t.dispatch=B,t.drag=function(){var e,n,i,r,o=Gt,s=Ft,a=Vt,l=Ht,c={},u=B("start","drag","end"),h=0,d=0;function f(t){t.on("mousedown.drag",p).filter(l).on("touchstart.drag",v).on("touchmove.drag",y).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(){if(!r&&o.apply(this,arguments)){var a=C("mouse",s.apply(this,arguments),Nt,this,arguments);a&&(Dt(t.event.view).on("mousemove.drag",g,!0).on("mouseup.drag",m,!0),Kt(t.event.view),Pt(),i=!1,e=t.event.clientX,n=t.event.clientY,a("start"))}}function g(){if(Lt(),!i){var r=t.event.clientX-e,o=t.event.clientY-n;i=r*r+o*o>d}c.mouse("drag")}function m(){Dt(t.event.view).on("mousemove.drag mouseup.drag",null),Bt(t.event.view,i),Lt(),c.mouse("end")}function v(){if(o.apply(this,arguments)){var e,n,i=t.event.changedTouches,r=s.apply(this,arguments),a=i.length;for(e=0;e<a;++e)(n=C(i[e].identifier,r,Mt,this,arguments))&&(Pt(),n("start"))}}function y(){var e,n,i=t.event.changedTouches,r=i.length;for(e=0;e<r;++e)(n=c[i[e].identifier])&&(Lt(),n("drag"))}function b(){var e,n,i=t.event.changedTouches,o=i.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),e=0;e<o;++e)(n=c[i[e].identifier])&&(Pt(),n("end"))}function C(e,n,i,r,o){var s,l,d,p=i(n,e),g=u.copy();if(Et(new jt(f,"beforestart",s,e,h,p[0],p[1],0,0,g),function(){return null!=(t.event.subject=s=a.apply(r,o))&&(l=s.x-p[0]||0,d=s.y-p[1]||0,!0)}))return function t(a){var u,m=p;switch(a){case"start":c[e]=t,u=h++;break;case"end":delete c[e],--h;case"drag":p=i(n,e),u=h}Et(new jt(f,a,s,e,u,p[0]+l,p[1]+d,p[0]-m[0],p[1]-m[1],g),g.apply,g,[a,r,o])}}return f.filter=function(t){return arguments.length?(o="function"==typeof t?t:zt(!!t),f):o},f.container=function(t){return arguments.length?(s="function"==typeof t?t:zt(t),f):s},f.subject=function(t){return arguments.length?(a="function"==typeof t?t:zt(t),f):a},f.touchable=function(t){return arguments.length?(l="function"==typeof t?t:zt(!!t),f):l},f.on=function(){var t=u.on.apply(u,arguments);return t===u?f:t},f.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,f):Math.sqrt(d)},f},t.dragDisable=Kt,t.dragEnable=Bt,t.dsv=function(t,e,n,i){3===arguments.length&&"function"==typeof n&&(i=n,n=void 0);var r=po(t);return Po(e,n).then(function(t){return r.parse(t,i)})},t.dsvFormat=po,t.easeBack=Vi,t.easeBackIn=Gi,t.easeBackInOut=Vi,t.easeBackOut=Fi,t.easeBounce=ji,t.easeBounceIn=function(t){return 1-ji(1-t)},t.easeBounceInOut=function(t){return((t*=2)<=1?1-ji(1-t):ji(t-1)+1)/2},t.easeBounceOut=ji,t.easeCircle=Ki,t.easeCircleIn=function(t){return 1-Math.sqrt(1-t*t)},t.easeCircleInOut=Ki,t.easeCircleOut=function(t){return Math.sqrt(1- --t*t)},t.easeCubic=Oi,t.easeCubicIn=function(t){return t*t*t},t.easeCubicInOut=Oi,t.easeCubicOut=function(t){return--t*t*t+1},t.easeElastic=Zi,t.easeElasticIn=Ui,t.easeElasticInOut=Wi,t.easeElasticOut=Zi,t.easeExp=Li,t.easeExpIn=function(t){return Math.pow(2,10*t-10)},t.easeExpInOut=Li,t.easeExpOut=function(t){return 1-Math.pow(2,-10*t)},t.easeLinear=function(t){return+t},t.easePoly=ki,t.easePolyIn=Si,t.easePolyInOut=ki,t.easePolyOut=Ri,t.easeQuad=Ai,t.easeQuadIn=function(t){return t*t},t.easeQuadInOut=Ai,t.easeQuadOut=function(t){return t*(2-t)},t.easeSin=Pi,t.easeSinIn=function(t){return 1-Math.cos(t*Mi)},t.easeSinInOut=Pi,t.easeSinOut=function(t){return Math.sin(t*Mi)},t.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},t.extent=u,t.forceCenter=function(t,e){var n;function i(){var i,r,o=n.length,s=0,a=0;for(i=0;i<o;++i)s+=(r=n[i]).x,a+=r.y;for(s=s/o-t,a=a/o-e,i=0;i<o;++i)(r=n[i]).x-=s,r.y-=a}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i},t.forceCollide=function(t){var e,n,i=1,r=1;function o(){for(var t,o,a,l,c,u,h,d=e.length,f=0;f<r;++f)for(o=Xo(e,ts,es).visitAfter(s),t=0;t<d;++t)a=e[t],u=n[a.index],h=u*u,l=a.x+a.vx,c=a.y+a.vy,o.visit(p);function p(t,e,n,r,o){var s=t.data,d=t.r,f=u+d;if(!s)return e>l+f||r<l-f||n>c+f||o<c-f;if(s.index>a.index){var p=l-s.x-s.vx,g=c-s.y-s.vy,m=p*p+g*g;m<f*f&&(0===p&&(m+=(p=Uo())*p),0===g&&(m+=(g=Uo())*g),m=(f-(m=Math.sqrt(m)))/m*i,a.vx+=(p*=m)*(f=(d*=d)/(h+d)),a.vy+=(g*=m)*f,s.vx-=p*(f=1-f),s.vy-=g*f)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function a(){if(e){var i,r,o=e.length;for(n=new Array(o),i=0;i<o;++i)r=e[i],n[r.index]=+t(r,i,e)}}return"function"!=typeof t&&(t=Ho(null==t?1:+t)),o.initialize=function(t){e=t,a()},o.iterations=function(t){return arguments.length?(r=+t,o):r},o.strength=function(t){return arguments.length?(i=+t,o):i},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:Ho(+e),a(),o):t},o},t.forceLink=function(t){var e,n,i,r,o,s=ns,a=function(t){return 1/Math.min(r[t.source.index],r[t.target.index])},l=Ho(30),c=1;function u(i){for(var r=0,s=t.length;r<c;++r)for(var a,l,u,h,d,f,p,g=0;g<s;++g)l=(a=t[g]).source,h=(u=a.target).x+u.vx-l.x-l.vx||Uo(),d=u.y+u.vy-l.y-l.vy||Uo(),h*=f=((f=Math.sqrt(h*h+d*d))-n[g])/f*i*e[g],d*=f,u.vx-=h*(p=o[g]),u.vy-=d*p,l.vx+=h*(p=1-p),l.vy+=d*p}function h(){if(i){var a,l,c=i.length,u=t.length,h=jr(i,s);for(a=0,r=new Array(c);a<u;++a)(l=t[a]).index=a,"object"!=typeof l.source&&(l.source=is(h,l.source)),"object"!=typeof l.target&&(l.target=is(h,l.target)),r[l.source.index]=(r[l.source.index]||0)+1,r[l.target.index]=(r[l.target.index]||0)+1;for(a=0,o=new Array(u);a<u;++a)l=t[a],o[a]=r[l.source.index]/(r[l.source.index]+r[l.target.index]);e=new Array(u),d(),n=new Array(u),f()}}function d(){if(i)for(var n=0,r=t.length;n<r;++n)e[n]=+a(t[n],n,t)}function f(){if(i)for(var e=0,r=t.length;e<r;++e)n[e]=+l(t[e],e,t)}return null==t&&(t=[]),u.initialize=function(t){i=t,h()},u.links=function(e){return arguments.length?(t=e,h(),u):t},u.id=function(t){return arguments.length?(s=t,u):s},u.iterations=function(t){return arguments.length?(c=+t,u):c},u.strength=function(t){return arguments.length?(a="function"==typeof t?t:Ho(+t),d(),u):a},u.distance=function(t){return arguments.length?(l="function"==typeof t?t:Ho(+t),f(),u):l},u},t.forceManyBody=function(){var t,e,n,i,r=Ho(-30),o=1,s=1/0,a=.81;function l(i){var r,o=t.length,s=Xo(t,rs,os).visitAfter(u);for(n=i,r=0;r<o;++r)e=t[r],s.visit(h)}function c(){if(t){var e,n,o=t.length;for(i=new Array(o),e=0;e<o;++e)n=t[e],i[n.index]=+r(n,e,t)}}function u(t){var e,n,r,o,s,a=0,l=0;if(t.length){for(r=o=s=0;s<4;++s)(e=t[s])&&(n=Math.abs(e.value))&&(a+=e.value,l+=n,r+=n*e.x,o+=n*e.y);t.x=r/l,t.y=o/l}else{(e=t).x=e.data.x,e.y=e.data.y;do{a+=i[e.data.index]}while(e=e.next)}t.value=a}function h(t,r,l,c){if(!t.value)return!0;var u=t.x-e.x,h=t.y-e.y,d=c-r,f=u*u+h*h;if(d*d/a<f)return f<s&&(0===u&&(f+=(u=Uo())*u),0===h&&(f+=(h=Uo())*h),f<o&&(f=Math.sqrt(o*f)),e.vx+=u*t.value*n/f,e.vy+=h*t.value*n/f),!0;if(!(t.length||f>=s)){(t.data!==e||t.next)&&(0===u&&(f+=(u=Uo())*u),0===h&&(f+=(h=Uo())*h),f<o&&(f=Math.sqrt(o*f)));do{t.data!==e&&(d=i[t.data.index]*n/f,e.vx+=u*d,e.vy+=h*d)}while(t=t.next)}}return l.initialize=function(e){t=e,c()},l.strength=function(t){return arguments.length?(r="function"==typeof t?t:Ho(+t),c(),l):r},l.distanceMin=function(t){return arguments.length?(o=t*t,l):Math.sqrt(o)},l.distanceMax=function(t){return arguments.length?(s=t*t,l):Math.sqrt(s)},l.theta=function(t){return arguments.length?(a=t*t,l):Math.sqrt(a)},l},t.forceRadial=function(t,e,n){var i,r,o,s=Ho(.1);function a(t){for(var s=0,a=i.length;s<a;++s){var l=i[s],c=l.x-e||1e-6,u=l.y-n||1e-6,h=Math.sqrt(c*c+u*u),d=(o[s]-h)*r[s]*t/h;l.vx+=c*d,l.vy+=u*d}}function l(){if(i){var e,n=i.length;for(r=new Array(n),o=new Array(n),e=0;e<n;++e)o[e]=+t(i[e],e,i),r[e]=isNaN(o[e])?0:+s(i[e],e,i)}}return"function"!=typeof t&&(t=Ho(+t)),null==e&&(e=0),null==n&&(n=0),a.initialize=function(t){i=t,l()},a.strength=function(t){return arguments.length?(s="function"==typeof t?t:Ho(+t),l(),a):s},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:Ho(+e),l(),a):t},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(t){return arguments.length?(n=+t,a):n},a},t.forceSimulation=function(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,s=.6,a=jr(),l=ni(u),c=B("tick","end");function u(){h(),c.call("tick",e),n<i&&(l.stop(),c.call("end",e))}function h(i){var l,c,u=t.length;void 0===i&&(i=1);for(var h=0;h<i;++h)for(n+=(o-n)*r,a.each(function(t){t(n)}),l=0;l<u;++l)null==(c=t[l]).fx?c.x+=c.vx*=s:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=s:(c.y=c.fy,c.vy=0);return e}function d(){for(var e,n=0,i=t.length;n<i;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var r=10*Math.sqrt(n),o=n*ss;e.x=r*Math.cos(o),e.y=r*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function f(e){return e.initialize&&e.initialize(t),e}return null==t&&(t=[]),d(),e={tick:h,restart:function(){return l.restart(u),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,d(),a.each(f),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(i=+t,e):i},alphaDecay:function(t){return arguments.length?(r=+t,e):+r},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},force:function(t,n){return arguments.length>1?(null==n?a.remove(t):a.set(t,f(n)),e):a.get(t)},find:function(e,n,i){var r,o,s,a,l,c=0,u=t.length;for(null==i?i=1/0:i*=i,c=0;c<u;++c)(s=(r=e-(a=t[c]).x)*r+(o=n-a.y)*o)<i&&(l=a,i=s);return l},on:function(t,n){return arguments.length>1?(c.on(t,n),e):c.on(t)}}},t.forceX=function(t){var e,n,i,r=Ho(.1);function o(t){for(var r,o=0,s=e.length;o<s;++o)(r=e[o]).vx+=(i[o]-r.x)*n[o]*t}function s(){if(e){var o,s=e.length;for(n=new Array(s),i=new Array(s),o=0;o<s;++o)n[o]=isNaN(i[o]=+t(e[o],o,e))?0:+r(e[o],o,e)}}return"function"!=typeof t&&(t=Ho(null==t?0:+t)),o.initialize=function(t){e=t,s()},o.strength=function(t){return arguments.length?(r="function"==typeof t?t:Ho(+t),s(),o):r},o.x=function(e){return arguments.length?(t="function"==typeof e?e:Ho(+e),s(),o):t},o},t.forceY=function(t){var e,n,i,r=Ho(.1);function o(t){for(var r,o=0,s=e.length;o<s;++o)(r=e[o]).vy+=(i[o]-r.y)*n[o]*t}function s(){if(e){var o,s=e.length;for(n=new Array(s),i=new Array(s),o=0;o<s;++o)n[o]=isNaN(i[o]=+t(e[o],o,e))?0:+r(e[o],o,e)}}return"function"!=typeof t&&(t=Ho(null==t?0:+t)),o.initialize=function(t){e=t,s()},o.strength=function(t){return arguments.length?(r="function"==typeof t?t:Ho(+t),s(),o):r},o.y=function(e){return arguments.length?(t="function"==typeof e?e:Ho(+e),s(),o):t},o},t.formatDefaultLocale=Cs,t.formatLocale=bs,t.formatSpecifier=hs,t.geoAlbers=Au,t.geoAlbersUsa=function(){var t,e,n,i,r,o,s=Au(),a=Du().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=Du().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){o=[t,e]}};function u(t){var e=t[0],s=t[1];return o=null,n.point(e,s),o||(i.point(e,s),o)||(r.point(e,s),o)}function h(){return t=e=null,u}return u.invert=function(t){var e=s.scale(),n=s.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&r<.234&&i>=-.425&&i<-.214?a:r>=.166&&r<.234&&i>=-.214&&i<-.115?l:s).invert(t)},u.stream=function(n){return t&&e===n?t:(i=[s.stream(e=n),a.stream(n),l.stream(n)],r=i.length,t={point:function(t,e){for(var n=-1;++n<r;)i[n].point(t,e)},sphere:function(){for(var t=-1;++t<r;)i[t].sphere()},lineStart:function(){for(var t=-1;++t<r;)i[t].lineStart()},lineEnd:function(){for(var t=-1;++t<r;)i[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<r;)i[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<r;)i[t].polygonEnd()}});var i,r},u.precision=function(t){return arguments.length?(s.precision(t),a.precision(t),l.precision(t),h()):s.precision()},u.scale=function(t){return arguments.length?(s.scale(t),a.scale(.35*t),l.scale(t),u.translate(s.translate())):s.scale()},u.translate=function(t){if(!arguments.length)return s.translate();var e=s.scale(),o=+t[0],u=+t[1];return n=s.translate(t).clipExtent([[o-.455*e,u-.238*e],[o+.455*e,u+.238*e]]).stream(c),i=a.translate([o-.307*e,u+.201*e]).clipExtent([[o-.425*e+As,u+.12*e+As],[o-.214*e-As,u+.234*e-As]]).stream(c),r=l.translate([o-.205*e,u+.212*e]).clipExtent([[o-.214*e+As,u+.166*e+As],[o-.115*e-As,u+.234*e-As]]).stream(c),h()},u.fitExtent=function(t,e){return pu(u,t,e)},u.fitSize=function(t,e){return gu(u,t,e)},u.fitWidth=function(t,e){return mu(u,t,e)},u.fitHeight=function(t,e){return vu(u,t,e)},u.scale(1070)},t.geoArea=function(t){return ua.reset(),ia(t,ha),2*ua},t.geoAzimuthalEqualArea=function(){return Tu(Ru).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=Ru,t.geoAzimuthalEquidistant=function(){return Tu(ku).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=ku,t.geoBounds=function(t){var e,n,i,r,o,s,a;if(_a=xa=-(Ta=wa=1/0),Ra=[],ia(t,Xa),n=Ra.length){for(Ra.sort(ol),e=1,o=[i=Ra[0]];e<n;++e)sl(i,(r=Ra[e])[0])||sl(i,r[1])?(rl(i[0],r[1])>rl(i[0],i[1])&&(i[1]=r[1]),rl(r[0],i[1])>rl(i[0],i[1])&&(i[0]=r[0])):o.push(i=r);for(s=-1/0,e=0,i=o[n=o.length-1];e<=n;i=r,++e)r=o[e],(a=rl(i[1],r[0]))>s&&(s=a,Ta=r[0],xa=i[1])}return Ra=ka=null,Ta===1/0||wa===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ta,wa],[xa,_a]]},t.geoCentroid=function(t){Na=Ma=Pa=La=Ka=Ba=za=ja=Ga=Fa=Va=0,ia(t,al);var e=Ga,n=Fa,i=Va,r=e*e+n*n+i*i;return r<Os&&(e=Ba,n=za,i=ja,Ma<As&&(e=Pa,n=La,i=Ka),(r=e*e+n*n+i*i)<Os)?[NaN,NaN]:[Bs(n,e)*Ms,Ys(i/Zs(r))*Ms]},t.geoCircle=function(){var t,e,n=yl([0,0]),i=yl(90),r=yl(6),o={point:function(n,i){t.push(n=e(n,i)),n[0]*=Ms,n[1]*=Ms}};function s(){var s=n.apply(this,arguments),a=i.apply(this,arguments)*Ps,l=r.apply(this,arguments)*Ps;return t=[],e=Il(-s[0]*Ps,-s[1]*Ps,0).invert,_l(o,a,l,1),s={type:"Polygon",coordinates:[t]},t=e=null,s}return s.center=function(t){return arguments.length?(n="function"==typeof t?t:yl([+t[0],+t[1]]),s):n},s.radius=function(t){return arguments.length?(i="function"==typeof t?t:yl(+t),s):i},s.precision=function(t){return arguments.length?(r="function"==typeof t?t:yl(+t),s):r},s},t.geoClipAntimeridian=zl,t.geoClipCircle=jl,t.geoClipExtent=function(){var t,e,n,i=0,r=0,o=960,s=500;return n={stream:function(n){return t&&e===n?t:t=Vl(i,r,o,s)(e=n)},extent:function(a){return arguments.length?(i=+a[0][0],r=+a[0][1],o=+a[1][0],s=+a[1][1],t=e=null,n):[[i,r],[o,s]]}}},t.geoClipRectangle=Vl,t.geoConicConformal=function(){return xu(Lu).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=Lu,t.geoConicEqualArea=Du,t.geoConicEqualAreaRaw=_u,t.geoConicEquidistant=function(){return xu(Bu).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=Bu,t.geoContains=function(t,e){return(t&&nc.hasOwnProperty(t.type)?nc[t.type]:rc)(t,e)},t.geoDistance=ec,t.geoEqualEarth=function(){return Tu(Hu).scale(177.158)},t.geoEqualEarthRaw=Hu,t.geoEquirectangular=function(){return Tu(Ku).scale(152.63)},t.geoEquirectangularRaw=Ku,t.geoGnomonic=function(){return Tu(Uu).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=Uu,t.geoGraticule=dc,t.geoGraticule10=function(){return dc()()},t.geoIdentity=function(){var t,e,n,i,r,o,s=1,a=0,l=0,c=1,u=1,h=fc,d=null,f=fc;function p(){return i=r=null,o}return o={stream:function(t){return i&&r===t?i:i=h(f(r=t))},postclip:function(i){return arguments.length?(f=i,d=t=e=n=null,p()):f},clipExtent:function(i){return arguments.length?(f=null==i?(d=t=e=n=null,fc):Vl(d=+i[0][0],t=+i[0][1],e=+i[1][0],n=+i[1][1]),p()):null==d?null:[[d,t],[e,n]]},scale:function(t){return arguments.length?(h=Zu((s=+t)*c,s*u,a,l),p()):s},translate:function(t){return arguments.length?(h=Zu(s*c,s*u,a=+t[0],l=+t[1]),p()):[a,l]},reflectX:function(t){return arguments.length?(h=Zu(s*(c=t?-1:1),s*u,a,l),p()):c<0},reflectY:function(t){return arguments.length?(h=Zu(s*c,s*(u=t?-1:1),a,l),p()):u<0},fitExtent:function(t,e){return pu(o,t,e)},fitSize:function(t,e){return gu(o,t,e)},fitWidth:function(t,e){return mu(o,t,e)},fitHeight:function(t,e){return vu(o,t,e)}}},t.geoInterpolate=function(t,e){var n=t[0]*Ps,i=t[1]*Ps,r=e[0]*Ps,o=e[1]*Ps,s=zs(i),a=Hs(i),l=zs(o),c=Hs(o),u=s*zs(n),h=s*Hs(n),d=l*zs(r),f=l*Hs(r),p=2*Ys(Zs(Xs(o-i)+s*l*Xs(r-n))),g=Hs(p),m=p?function(t){var e=Hs(t*=p)/g,n=Hs(p-t)/g,i=n*u+e*d,r=n*h+e*f,o=n*a+e*c;return[Bs(r,i)*Ms,Bs(o,Zs(i*i+r*r))*Ms]}:function(){return[n*Ms,i*Ms]};return m.distance=p,m},t.geoLength=Jl,t.geoMercator=function(){return Mu(Nu).scale(961/Ns)},t.geoMercatorRaw=Nu,t.geoNaturalEarth1=function(){return Tu(Wu).scale(175.295)},t.geoNaturalEarth1Raw=Wu,t.geoOrthographic=function(){return Tu($u).scale(249.5).clipAngle(90+As)},t.geoOrthographicRaw=$u,t.geoPath=function(t,e){var n,i,r=4.5;function o(t){return t&&("function"==typeof r&&i.pointRadius(+r.apply(this,arguments)),ia(t,n(i))),i.result()}return o.area=function(t){return ia(t,n(Cc)),Cc.result()},o.measure=function(t){return ia(t,n(su)),su.result()},o.bounds=function(t){return ia(t,n(Nc)),Nc.result()},o.centroid=function(t){return ia(t,n(Vc)),Vc.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,fc):(t=e).stream,o):t},o.context=function(t){return arguments.length?(i=null==t?(e=null,new cu):new Qc(e=t),"function"!=typeof r&&i.pointRadius(r),o):e},o.pointRadius=function(t){return arguments.length?(r="function"==typeof t?t:(i.pointRadius(+t),+t),o):r},o.projection(t).context(e)},t.geoProjection=Tu,t.geoProjectionMutator=wu,t.geoRotation=xl,t.geoStereographic=function(){return Tu(Yu).scale(250).clipAngle(142)},t.geoStereographicRaw=Yu,t.geoStream=ia,t.geoTransform=function(t){return{stream:hu(t)}},t.geoTransverseMercator=function(){var t=Mu(Xu),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=Xu,t.gray=function(t,e){return new ke(t,0,0,null==e?1:e)},t.hcl=Be,t.hierarchy=eh,t.histogram=function(){var t=g,e=u,n=T;function i(i){var o,s,a=i.length,l=new Array(a);for(o=0;o<a;++o)l[o]=t(i[o],o,i);var c=e(l),u=c[0],h=c[1],d=n(l,u,h);Array.isArray(d)||(d=E(u,h,d),d=m(Math.ceil(u/d)*d,h,d));for(var f=d.length;d[0]<=u;)d.shift(),--f;for(;d[f-1]>h;)d.pop(),--f;var p,g=new Array(f+1);for(o=0;o<=f;++o)(p=g[o]=[]).x0=o>0?d[o-1]:u,p.x1=o<f?d[o]:h;for(o=0;o<a;++o)u<=(s=l[o])&&s<=h&&g[r(d,s,0,f)].push(i[o]);return g}return i.value=function(e){return arguments.length?(t="function"==typeof e?e:p(e),i):t},i.domain=function(t){return arguments.length?(e="function"==typeof t?t:p([t[0],t[1]]),i):e},i.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?p(d.call(t)):p(t),i):n},i},t.hsl=ye,t.html=Fo,t.image=function(t,e){return new Promise(function(n,i){var r=new Image;for(var o in e)r[o]=e[o];r.onerror=i,r.onload=function(){n(r)},r.src=t})},t.interpolate=yn,t.interpolateArray=function(t,e){return(un(e)?cn:hn)(t,e)},t.interpolateBasis=Je,t.interpolateBasisClosed=Qe,t.interpolateBlues=Em,t.interpolateBrBG=Mg,t.interpolateBuGn=Jg,t.interpolateBuPu=tm,t.interpolateCividis=function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"},t.interpolateCool=Pm,t.interpolateCubehelix=Fn,t.interpolateCubehelixDefault=Nm,t.interpolateCubehelixLong=Vn,t.interpolateDate=dn,t.interpolateDiscrete=function(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}},t.interpolateGnBu=nm,t.interpolateGreens=wm,t.interpolateGreys=_m,t.interpolateHcl=Kn,t.interpolateHclLong=Bn,t.interpolateHsl=Mn,t.interpolateHslLong=Pn,t.interpolateHue=function(t,e){var n=nn(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}},t.interpolateInferno=Vm,t.interpolateLab=function(t,e){var n=rn((t=Re(t)).l,(e=Re(e)).l),i=rn(t.a,e.a),r=rn(t.b,e.b),o=rn(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=i(e),t.b=r(e),t.opacity=o(e),t+""}},t.interpolateMagma=Fm,t.interpolateNumber=fn,t.interpolateNumberArray=cn,t.interpolateObject=pn,t.interpolateOrRd=rm,t.interpolateOranges=km,t.interpolatePRGn=Lg,t.interpolatePiYG=Bg,t.interpolatePlasma=Hm,t.interpolatePuBu=lm,t.interpolatePuBuGn=sm,t.interpolatePuOr=jg,t.interpolatePuRd=um,t.interpolatePurples=Am,t.interpolateRainbow=function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return Lm.h=360*t-100,Lm.s=1.5-1.5*e,Lm.l=.8-.9*e,Lm+""},t.interpolateRdBu=Fg,t.interpolateRdGy=Hg,t.interpolateRdPu=dm,t.interpolateRdYlBu=Zg,t.interpolateRdYlGn=$g,t.interpolateReds=Sm,t.interpolateRgb=on,t.interpolateRgbBasis=an,t.interpolateRgbBasisClosed=ln,t.interpolateRound=bn,t.interpolateSinebow=function(t){var e;return t=(.5-t)*Math.PI,Km.r=255*(e=Math.sin(t))*e,Km.g=255*(e=Math.sin(t+Bm))*e,Km.b=255*(e=Math.sin(t+zm))*e,Km+""},t.interpolateSpectral=Xg,t.interpolateString=vn,t.interpolateTransformCss=An,t.interpolateTransformSvg=On,t.interpolateTurbo=function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"},t.interpolateViridis=Gm,t.interpolateWarm=Mm,t.interpolateYlGn=mm,t.interpolateYlGnBu=pm,t.interpolateYlOrBr=ym,t.interpolateYlOrRd=Cm,t.interpolateZoom=kn,t.interrupt=yi,t.interval=function(t,e,n){var i=new ei,r=e;return null==e?(i.restart(t,e,n),i):(e=+e,n=null==n?Qn():+n,i.restart(function o(s){s+=r,i.restart(o,r+=e,n),t(s)},e,n),i)},t.isoFormat=og,t.isoParse=sg,t.json=function(t,e){return fetch(t,e).then(zo)},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e},t.lab=Re,t.lch=function(t,e,n,i){return 1===arguments.length?Ke(t):new ze(n,e,t,null==i?1:i)},t.line=pv,t.lineRadial=Ev,t.linkHorizontal=function(){return Av(Ov)},t.linkRadial=function(){var t=Av(Rv);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t},t.linkVertical=function(){return Av(Sv)},t.local=Ot,t.map=jr,t.matcher=X,t.max=x,t.mean=function(t,e){var n,i=t.length,r=i,o=-1,s=0;if(null==e)for(;++o<i;)isNaN(n=a(t[o]))?--r:s+=n;else for(;++o<i;)isNaN(n=a(e(t[o],o,t)))?--r:s+=n;if(r)return s/r},t.median=function(t,n){var i,r=t.length,o=-1,s=[];if(null==n)for(;++o<r;)isNaN(i=a(t[o]))||s.push(i);else for(;++o<r;)isNaN(i=a(n(t[o],o,t)))||s.push(i);return w(s.sort(e),.5)},t.merge=_,t.min=D,t.mouse=Nt,t.namespace=H,t.namespaces=V,t.nest=function(){var t,e,n,i=[],r=[];function o(n,r,s,a){if(r>=i.length)return null!=t&&n.sort(t),null!=e?e(n):n;for(var l,c,u,h=-1,d=n.length,f=i[r++],p=jr(),g=s();++h<d;)(u=p.get(l=f(c=n[h])+""))?u.push(c):p.set(l,[c]);return p.each(function(t,e){a(g,e,o(t,r,s,a))}),g}return n={object:function(t){return o(t,0,Gr,Fr)},map:function(t){return o(t,0,Vr,Hr)},entries:function(t){return function t(n,o){if(++o>i.length)return n;var s,a=r[o-1];return null!=e&&o>=i.length?s=n.entries():(s=[],n.each(function(e,n){s.push({key:n,values:t(e,o)})})),null!=a?s.sort(function(t,e){return a(t.key,e.key)}):s}(o(t,0,Vr,Hr),0)},key:function(t){return i.push(t),n},sortKeys:function(t){return r[i.length-1]=t,n},sortValues:function(e){return t=e,n},rollup:function(t){return e=t,n}}},t.now=Qn,t.pack=function(){var t=null,e=1,n=1,i=Ih;function r(r){return r.x=e/2,r.y=n/2,t?r.eachBefore(wh(t)).eachAfter(xh(i,.5)).eachBefore(_h(1)):r.eachBefore(wh(Th)).eachAfter(xh(Ih,1)).eachAfter(xh(i,r.r/Math.min(e,n))).eachBefore(_h(Math.min(e,n)/(2*r.r))),r}return r.radius=function(e){return arguments.length?(t=function(t){return null==t?null:Ch(t)}(e),r):t},r.size=function(t){return arguments.length?(e=+t[0],n=+t[1],r):[e,n]},r.padding=function(t){return arguments.length?(i="function"==typeof t?t:Eh(+t),r):i},r},t.packEnclose=ah,t.packSiblings=function(t){return bh(t),t},t.pairs=function(t,e){null==e&&(e=s);for(var n=0,i=t.length-1,r=t[0],o=new Array(i<0?0:i);n<i;)o[n]=e(r,r=t[++n]);return o},t.partition=function(){var t=1,e=1,n=0,i=!1;function r(r){var o=r.height+1;return r.x0=r.y0=n,r.x1=t,r.y1=e/o,r.eachBefore(function(t,e){return function(i){i.children&&Ah(i,i.x0,t*(i.depth+1)/e,i.x1,t*(i.depth+2)/e);var r=i.x0,o=i.y0,s=i.x1-n,a=i.y1-n;s<r&&(r=s=(r+s)/2),a<o&&(o=a=(o+a)/2),i.x0=r,i.y0=o,i.x1=s,i.y1=a}}(e,o)),i&&r.eachBefore(Dh),r}return r.round=function(t){return arguments.length?(i=!!t,r):i},r.size=function(n){return arguments.length?(t=+n[0],e=+n[1],r):[t,e]},r.padding=function(t){return arguments.length?(n=+t,r):n},r},t.path=Nr,t.permute=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},t.pie=function(){var t=vv,e=mv,n=null,i=Um(0),r=Um(nv),o=Um(0);function s(s){var a,l,c,u,h,d=s.length,f=0,p=new Array(d),g=new Array(d),m=+i.apply(this,arguments),v=Math.min(nv,Math.max(-nv,r.apply(this,arguments)-m)),y=Math.min(Math.abs(v)/d,o.apply(this,arguments)),b=y*(v<0?-1:1);for(a=0;a<d;++a)(h=g[p[a]=a]=+t(s[a],a,s))>0&&(f+=h);for(null!=e?p.sort(function(t,n){return e(g[t],g[n])}):null!=n&&p.sort(function(t,e){return n(s[t],s[e])}),a=0,c=f?(v-d*b)/f:0;a<d;++a,m=u)l=p[a],u=m+((h=g[l])>0?h*c:0)+b,g[l]={data:s[l],index:a,value:h,startAngle:m,endAngle:u,padAngle:y};return g}return s.value=function(e){return arguments.length?(t="function"==typeof e?e:Um(+e),s):t},s.sortValues=function(t){return arguments.length?(e=t,n=null,s):e},s.sort=function(t){return arguments.length?(n=t,e=null,s):n},s.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:Um(+t),s):i},s.endAngle=function(t){return arguments.length?(r="function"==typeof t?t:Um(+t),s):r},s.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:Um(+t),s):o},s},t.piecewise=function(t,e){for(var n=0,i=e.length-1,r=e[0],o=new Array(i<0?0:i);n<i;)o[n]=t(r,r=e[++n]);return function(t){var e=Math.max(0,Math.min(i-1,Math.floor(t*=i)));return o[e](t-e)}},t.pointRadial=wv,t.polygonArea=function(t){for(var e,n=-1,i=t.length,r=t[i-1],o=0;++n<i;)e=r,r=t[n],o+=e[1]*r[0]-e[0]*r[1];return o/2},t.polygonCentroid=function(t){for(var e,n,i=-1,r=t.length,o=0,s=0,a=t[r-1],l=0;++i<r;)e=a,a=t[i],l+=n=e[0]*a[1]-a[0]*e[1],o+=(e[0]+a[0])*n,s+=(e[1]+a[1])*n;return[o/(l*=3),s/l]},t.polygonContains=function(t,e){for(var n,i,r=t.length,o=t[r-1],s=e[0],a=e[1],l=o[0],c=o[1],u=!1,h=0;h<r;++h)n=(o=t[h])[0],(i=o[1])>a!=c>a&&s<(l-n)*(a-i)/(c-i)+n&&(u=!u),l=n,c=i;return u},t.polygonHull=function(t){if((n=t.length)<3)return null;var e,n,i=new Array(n),r=new Array(n);for(e=0;e<n;++e)i[e]=[+t[e][0],+t[e][1],e];for(i.sort(Uh),e=0;e<n;++e)r[e]=[i[e][0],-i[e][1]];var o=Zh(i),s=Zh(r),a=s[0]===o[0],l=s[s.length-1]===o[o.length-1],c=[];for(e=o.length-1;e>=0;--e)c.push(t[i[o[e]][2]]);for(e=+a;e<s.length-l;++e)c.push(t[i[s[e]][2]]);return c},t.polygonLength=function(t){for(var e,n,i=-1,r=t.length,o=t[r-1],s=o[0],a=o[1],l=0;++i<r;)e=s,n=a,e-=s=(o=t[i])[0],n-=a=o[1],l+=Math.sqrt(e*e+n*n);return l},t.precisionFixed=Is,t.precisionPrefix=Es,t.precisionRound=Ts,t.quadtree=Xo,t.quantile=w,t.quantize=function(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t(i/(e-1));return n},t.radialArea=Tv,t.radialLine=Ev,t.randomBates=Jh,t.randomExponential=Qh,t.randomIrwinHall=qh,t.randomLogNormal=Xh,t.randomNormal=Yh,t.randomUniform=$h,t.range=m,t.rgb=he,t.ribbon=function(){var t=Mr,e=Pr,n=Lr,i=Kr,r=Br,o=null;function s(){var s,a=Dr.call(arguments),l=t.apply(this,a),c=e.apply(this,a),u=+n.apply(this,(a[0]=l,a)),h=i.apply(this,a)-wr,d=r.apply(this,a)-wr,f=u*Ir(h),p=u*Er(h),g=+n.apply(this,(a[0]=c,a)),m=i.apply(this,a)-wr,v=r.apply(this,a)-wr;if(o||(o=s=Nr()),o.moveTo(f,p),o.arc(0,0,u,h,d),h===m&&d===v||(o.quadraticCurveTo(0,0,g*Ir(m),g*Er(m)),o.arc(0,0,g,m,v)),o.quadraticCurveTo(0,0,f,p),o.closePath(),s)return o=null,s+""||null}return s.radius=function(t){return arguments.length?(n="function"==typeof t?t:Ar(+t),s):n},s.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:Ar(+t),s):i},s.endAngle=function(t){return arguments.length?(r="function"==typeof t?t:Ar(+t),s):r},s.source=function(e){return arguments.length?(t=e,s):t},s.target=function(t){return arguments.length?(e=t,s):e},s.context=function(t){return arguments.length?(o=null==t?null:t,s):o},s},t.scaleBand=ad,t.scaleDiverging=function t(){var e=bd(bg()(ud));return e.copy=function(){return vg(e,t())},ed.apply(e,arguments)},t.scaleDivergingLog=function t(){var e=Dd(bg()).domain([.1,1,10]);return e.copy=function(){return vg(e,t()).base(e.base())},ed.apply(e,arguments)},t.scaleDivergingPow=Cg,t.scaleDivergingSqrt=function(){return Cg.apply(null,arguments).exponent(.5)},t.scaleDivergingSymlog=function t(){var e=Sd(bg());return e.copy=function(){return vg(e,t()).constant(e.constant())},ed.apply(e,arguments)},t.scaleIdentity=function t(e){var n;function i(t){return isNaN(t=+t)?n:t}return i.invert=i,i.domain=i.range=function(t){return arguments.length?(e=id.call(t,ld),i):e.slice()},i.unknown=function(t){return arguments.length?(n=t,i):n},i.copy=function(){return t(e).unknown(n)},e=arguments.length?id.call(e,ld):[0,1],bd(i)},t.scaleImplicit=od,t.scaleLinear=function t(){var e=vd(ud,ud);return e.copy=function(){return gd(e,t())},td.apply(e,arguments),bd(e)},t.scaleLog=function t(){var e=Dd(md()).domain([1,10]);return e.copy=function(){return gd(e,t()).base(e.base())},td.apply(e,arguments),e},t.scaleOrdinal=sd,t.scalePoint=function(){return function t(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return t(n())},e}(ad.apply(null,arguments).paddingInner(1))},t.scalePow=Pd,t.scaleQuantile=function t(){var n,i=[],o=[],s=[];function a(){var t=0,e=Math.max(1,o.length);for(s=new Array(e-1);++t<e;)s[t-1]=w(i,t/e);return l}function l(t){return isNaN(t=+t)?n:o[r(s,t)]}return l.invertExtent=function(t){var e=o.indexOf(t);return e<0?[NaN,NaN]:[e>0?s[e-1]:i[0],e<s.length?s[e]:i[i.length-1]]},l.domain=function(t){if(!arguments.length)return i.slice();i=[];for(var n,r=0,o=t.length;r<o;++r)null==(n=t[r])||isNaN(n=+n)||i.push(n);return i.sort(e),a()},l.range=function(t){return arguments.length?(o=rd.call(t),a()):o.slice()},l.unknown=function(t){return arguments.length?(n=t,l):n},l.quantiles=function(){return s.slice()},l.copy=function(){return t().domain(i).range(o).unknown(n)},td.apply(l,arguments)},t.scaleQuantize=function t(){var e,n=0,i=1,o=1,s=[.5],a=[0,1];function l(t){return t<=t?a[r(s,t,0,o)]:e}function c(){var t=-1;for(s=new Array(o);++t<o;)s[t]=((t+1)*i-(t-o)*n)/(o+1);return l}return l.domain=function(t){return arguments.length?(n=+t[0],i=+t[1],c()):[n,i]},l.range=function(t){return arguments.length?(o=(a=rd.call(t)).length-1,c()):a.slice()},l.invertExtent=function(t){var e=a.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,s[0]]:e>=o?[s[o-1],i]:[s[e-1],s[e]]},l.unknown=function(t){return arguments.length?(e=t,l):l},l.thresholds=function(){return s.slice()},l.copy=function(){return t().domain([n,i]).range(a).unknown(e)},td.apply(bd(l),arguments)},t.scaleSequential=function t(){var e=bd(mg()(ud));return e.copy=function(){return vg(e,t())},ed.apply(e,arguments)},t.scaleSequentialLog=function t(){var e=Dd(mg()).domain([1,10]);return e.copy=function(){return vg(e,t()).base(e.base())},ed.apply(e,arguments)},t.scaleSequentialPow=yg,t.scaleSequentialQuantile=function t(){var n=[],i=ud;function o(t){if(!isNaN(t=+t))return i((r(n,t)-1)/(n.length-1))}return o.domain=function(t){if(!arguments.length)return n.slice();n=[];for(var i,r=0,s=t.length;r<s;++r)null==(i=t[r])||isNaN(i=+i)||n.push(i);return n.sort(e),o},o.interpolator=function(t){return arguments.length?(i=t,o):i},o.copy=function(){return t(i).domain(n)},ed.apply(o,arguments)},t.scaleSequentialSqrt=function(){return yg.apply(null,arguments).exponent(.5)},t.scaleSequentialSymlog=function t(){var e=Sd(mg());return e.copy=function(){return vg(e,t()).constant(e.constant())},ed.apply(e,arguments)},t.scaleSqrt=function(){return Pd.apply(null,arguments).exponent(.5)},t.scaleSymlog=function t(){var e=Sd(md());return e.copy=function(){return gd(e,t()).constant(e.constant())},td.apply(e,arguments)},t.scaleThreshold=function t(){var e,n=[.5],i=[0,1],o=1;function s(t){return t<=t?i[r(n,t,0,o)]:e}return s.domain=function(t){return arguments.length?(n=rd.call(t),o=Math.min(n.length,i.length-1),s):n.slice()},s.range=function(t){return arguments.length?(i=rd.call(t),o=Math.min(n.length,i.length-1),s):i.slice()},s.invertExtent=function(t){var e=i.indexOf(t);return[n[e-1],n[e]]},s.unknown=function(t){return arguments.length?(e=t,s):e},s.copy=function(){return t().domain(n).range(i).unknown(e)},td.apply(s,arguments)},t.scaleTime=function(){return td.apply(gg(gf,ff,Jd,Yd,Wd,Ud,Vd,zd,t.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},t.scaleUtc=function(){return td.apply(gg(jf,Bf,wf,If,bf,vf,Vd,zd,t.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},t.scan=function(t,n){if(i=t.length){var i,r,o=0,s=0,a=t[s];for(null==n&&(n=e);++o<i;)(n(r=t[o],a)<0||0!==n(a,a))&&(a=r,s=o);return 0===n(a,a)?s:void 0}},t.schemeAccent=Tg,t.schemeBlues=Im,t.schemeBrBG=Ng,t.schemeBuGn=qg,t.schemeBuPu=Qg,t.schemeCategory10=Eg,t.schemeDark2=wg,t.schemeGnBu=em,t.schemeGreens=Tm,t.schemeGreys=xm,t.schemeOrRd=im,t.schemeOranges=Rm,t.schemePRGn=Pg,t.schemePaired=xg,t.schemePastel1=_g,t.schemePastel2=Dg,t.schemePiYG=Kg,t.schemePuBu=am,t.schemePuBuGn=om,t.schemePuOr=zg,t.schemePuRd=cm,t.schemePurples=Dm,t.schemeRdBu=Gg,t.schemeRdGy=Vg,t.schemeRdPu=hm,t.schemeRdYlBu=Ug,t.schemeRdYlGn=Wg,t.schemeReds=Om,t.schemeSet1=Ag,t.schemeSet2=Og,t.schemeSet3=Sg,t.schemeSpectral=Yg,t.schemeTableau10=Rg,t.schemeYlGn=gm,t.schemeYlGnBu=fm,t.schemeYlOrBr=vm,t.schemeYlOrRd=bm,t.select=Dt,t.selectAll=function(t){return"string"==typeof t?new xt([document.querySelectorAll(t)],[document.documentElement]):new xt([null==t?[]:t],wt)},t.selection=_t,t.selector=W,t.selectorAll=Y,t.set=Wr,t.shuffle=function(t,e,n){for(var i,r,o=(null==n?t.length:n)-(e=null==e?0:+e);o;)r=Math.random()*o--|0,i=t[o+e],t[o+e]=t[r+e],t[r+e]=i;return t},t.stack=function(){var t=Um([]),e=Ay,n=Dy,i=Oy;function r(r){var o,s,a=t.apply(this,arguments),l=r.length,c=a.length,u=new Array(c);for(o=0;o<c;++o){for(var h,d=a[o],f=u[o]=new Array(l),p=0;p<l;++p)f[p]=h=[0,+i(r[p],d,p,r)],h.data=r[p];f.key=d}for(o=0,s=e(u);o<c;++o)u[s[o]].index=o;return n(u,s),u}return r.keys=function(e){return arguments.length?(t="function"==typeof e?e:Um(xv.call(e)),r):t},r.value=function(t){return arguments.length?(i="function"==typeof t?t:Um(+t),r):i},r.order=function(t){return arguments.length?(e=null==t?Ay:"function"==typeof t?t:Um(xv.call(t)),r):e},r.offset=function(t){return arguments.length?(n=null==t?Dy:t,r):n},r},t.stackOffsetDiverging=function(t,e){if((a=t.length)>0)for(var n,i,r,o,s,a,l=0,c=t[e[0]].length;l<c;++l)for(o=s=0,n=0;n<a;++n)(r=(i=t[e[n]][l])[1]-i[0])>0?(i[0]=o,i[1]=o+=r):r<0?(i[1]=s,i[0]=s+=r):(i[0]=0,i[1]=r)},t.stackOffsetExpand=function(t,e){if((i=t.length)>0){for(var n,i,r,o=0,s=t[0].length;o<s;++o){for(r=n=0;n<i;++n)r+=t[n][o][1]||0;if(r)for(n=0;n<i;++n)t[n][o][1]/=r}Dy(t,e)}},t.stackOffsetNone=Dy,t.stackOffsetSilhouette=function(t,e){if((n=t.length)>0){for(var n,i=0,r=t[e[0]],o=r.length;i<o;++i){for(var s=0,a=0;s<n;++s)a+=t[s][i][1]||0;r[i][1]+=r[i][0]=-a/2}Dy(t,e)}},t.stackOffsetWiggle=function(t,e){if((r=t.length)>0&&(i=(n=t[e[0]]).length)>0){for(var n,i,r,o=0,s=1;s<i;++s){for(var a=0,l=0,c=0;a<r;++a){for(var u=t[e[a]],h=u[s][1]||0,d=(h-(u[s-1][1]||0))/2,f=0;f<a;++f){var p=t[e[f]];d+=(p[s][1]||0)-(p[s-1][1]||0)}l+=h,c+=d*h}n[s-1][1]+=n[s-1][0]=o,l&&(o-=c/l)}n[s-1][1]+=n[s-1][0]=o,Dy(t,e)}},t.stackOrderAppearance=Sy,t.stackOrderAscending=ky,t.stackOrderDescending=function(t){return ky(t).reverse()},t.stackOrderInsideOut=function(t){var e,n,i=t.length,r=t.map(Ny),o=Sy(t),s=0,a=0,l=[],c=[];for(e=0;e<i;++e)n=o[e],s<a?(s+=r[n],l.push(n)):(a+=r[n],c.push(n));return c.reverse().concat(l)},t.stackOrderNone=Ay,t.stackOrderReverse=function(t){return Ay(t).reverse()},t.stratify=function(){var t=Rh,e=kh;function n(n){var i,r,o,s,a,l,c,u=n.length,h=new Array(u),d={};for(r=0;r<u;++r)i=n[r],a=h[r]=new oh(i),null!=(l=t(i,r,n))&&(l+="")&&(d[c="$"+(a.id=l)]=c in d?Sh:a);for(r=0;r<u;++r)if(a=h[r],null!=(l=e(n[r],r,n))&&(l+="")){if(!(s=d["$"+l]))throw new Error("missing: "+l);if(s===Sh)throw new Error("ambiguous: "+l);s.children?s.children.push(a):s.children=[a],a.parent=s}else{if(o)throw new Error("multiple roots");o=a}if(!o)throw new Error("no root");if(o.parent=Oh,o.eachBefore(function(t){t.depth=t.parent.depth+1,--u}).eachBefore(rh),o.parent=null,u>0)throw new Error("cycle");return o}return n.id=function(e){return arguments.length?(t=Ch(e),n):t},n.parentId=function(t){return arguments.length?(e=Ch(t),n):e},n},t.style=it,t.sum=function(t,e){var n,i=t.length,r=-1,o=0;if(null==e)for(;++r<i;)(n=+t[r])&&(o+=n);else for(;++r<i;)(n=+e(t[r],r,t))&&(o+=n);return o},t.svg=Vo,t.symbol=function(){var t=Um(kv),e=Um(64),n=null;function i(){var i;if(n||(n=i=Nr()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return i.type=function(e){return arguments.length?(t="function"==typeof e?e:Um(e),i):t},i.size=function(t){return arguments.length?(e="function"==typeof t?t:Um(+t),i):e},i.context=function(t){return arguments.length?(n=null==t?null:t,i):n},i},t.symbolCircle=kv,t.symbolCross=Nv,t.symbolDiamond=Lv,t.symbolSquare=Gv,t.symbolStar=jv,t.symbolTriangle=Vv,t.symbolWye=Wv,t.symbols=$v,t.text=Po,t.thresholdFreedmanDiaconis=function(t,n,i){return t=f.call(t,a).sort(e),Math.ceil((i-n)/(2*(w(t,.75)-w(t,.25))*Math.pow(t.length,-1/3)))},t.thresholdScott=function(t,e,n){return Math.ceil((n-e)/(3.5*c(t)*Math.pow(t.length,-1/3)))},t.thresholdSturges=T,t.tickFormat=yd,t.tickIncrement=I,t.tickStep=E,t.ticks=C,t.timeDay=Yd,t.timeDays=Xd,t.timeFormatDefaultLocale=rg,t.timeFormatLocale=Uf,t.timeFriday=rf,t.timeFridays=hf,t.timeHour=Wd,t.timeHours=$d,t.timeInterval=Bd,t.timeMillisecond=zd,t.timeMilliseconds=jd,t.timeMinute=Ud,t.timeMinutes=Zd,t.timeMonday=Qd,t.timeMondays=af,t.timeMonth=ff,t.timeMonths=pf,t.timeSaturday=of,t.timeSaturdays=df,t.timeSecond=Vd,t.timeSeconds=Hd,t.timeSunday=Jd,t.timeSundays=sf,t.timeThursday=nf,t.timeThursdays=uf,t.timeTuesday=tf,t.timeTuesdays=lf,t.timeWednesday=ef,t.timeWednesdays=cf,t.timeWeek=Jd,t.timeWeeks=sf,t.timeYear=gf,t.timeYears=mf,t.timeout=ai,t.timer=ni,t.timerFlush=ii,t.touch=Mt,t.touches=function(t,e){null==e&&(e=Rt().touches);for(var n=0,i=e?e.length:0,r=new Array(i);n<i;++n)r[n]=kt(t,e[n]);return r},t.transition=xi,t.transpose=A,t.tree=function(){var t=Nh,e=1,n=1,i=null;function r(r){var l=function(t){for(var e,n,i,r,o,s=new Bh(t,0),a=[s];e=a.pop();)if(i=e._.children)for(e.children=new Array(o=i.length),r=o-1;r>=0;--r)a.push(n=e.children[r]=new Bh(i[r],r)),n.parent=e;return(s.parent=new Bh(null,0)).children=[s],s}(r);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(s),i)r.eachBefore(a);else{var c=r,u=r,h=r;r.eachBefore(function(t){t.x<c.x&&(c=t),t.x>u.x&&(u=t),t.depth>h.depth&&(h=t)});var d=c===u?1:t(c,u)/2,f=d-c.x,p=e/(u.x+d+f),g=n/(h.depth||1);r.eachBefore(function(t){t.x=(t.x+f)*p,t.y=t.depth*g})}return r}function o(e){var n=e.children,i=e.parent.children,r=e.i?i[e.i-1]:null;if(n){!function(t){for(var e,n=0,i=0,r=t.children,o=r.length;--o>=0;)(e=r[o]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;r?(e.z=r.z+t(e._,r._),e.m=e.z-o):e.z=o}else r&&(e.z=r.z+t(e._,r._));e.parent.A=function(e,n,i){if(n){for(var r,o=e,s=e,a=n,l=o.parent.children[0],c=o.m,u=s.m,h=a.m,d=l.m;a=Ph(a),o=Mh(o),a&&o;)l=Mh(l),(s=Ph(s)).a=e,(r=a.z+h-o.z-c+t(a._,o._))>0&&(Lh(Kh(a,e,i),e,r),c+=r,u+=r),h+=a.m,c+=o.m,d+=l.m,u+=s.m;a&&!Ph(s)&&(s.t=a,s.m+=h-u),o&&!Mh(l)&&(l.t=o,l.m+=c-d,i=e)}return i}(e,r,e.parent.A||i[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function a(t){t.x*=e,t.y=t.depth*n}return r.separation=function(e){return arguments.length?(t=e,r):t},r.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],r):i?null:[e,n]},r.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],r):i?[e,n]:null},r},t.treemap=function(){var t=Fh,e=!1,n=1,i=1,r=[0],o=Ih,s=Ih,a=Ih,l=Ih,c=Ih;function u(t){return t.x0=t.y0=0,t.x1=n,t.y1=i,t.eachBefore(h),r=[0],e&&t.eachBefore(Dh),t}function h(e){var n=r[e.depth],i=e.x0+n,u=e.y0+n,h=e.x1-n,d=e.y1-n;h<i&&(i=h=(i+h)/2),d<u&&(u=d=(u+d)/2),e.x0=i,e.y0=u,e.x1=h,e.y1=d,e.children&&(n=r[e.depth+1]=o(e)/2,i+=c(e)-n,u+=s(e)-n,(h-=a(e)-n)<i&&(i=h=(i+h)/2),(d-=l(e)-n)<u&&(u=d=(u+d)/2),t(e,i,u,h,d))}return u.round=function(t){return arguments.length?(e=!!t,u):e},u.size=function(t){return arguments.length?(n=+t[0],i=+t[1],u):[n,i]},u.tile=function(e){return arguments.length?(t=Ch(e),u):t},u.padding=function(t){return arguments.length?u.paddingInner(t).paddingOuter(t):u.paddingInner()},u.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:Eh(+t),u):o},u.paddingOuter=function(t){return arguments.length?u.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):u.paddingTop()},u.paddingTop=function(t){return arguments.length?(s="function"==typeof t?t:Eh(+t),u):s},u.paddingRight=function(t){return arguments.length?(a="function"==typeof t?t:Eh(+t),u):a},u.paddingBottom=function(t){return arguments.length?(l="function"==typeof t?t:Eh(+t),u):l},u.paddingLeft=function(t){return arguments.length?(c="function"==typeof t?t:Eh(+t),u):c},u},t.treemapBinary=function(t,e,n,i,r){var o,s,a=t.children,l=a.length,c=new Array(l+1);for(c[0]=s=o=0;o<l;++o)c[o+1]=s+=a[o].value;!function t(e,n,i,r,o,s,l){if(e>=n-1){var u=a[e];return u.x0=r,u.y0=o,u.x1=s,void(u.y1=l)}for(var h=c[e],d=i/2+h,f=e+1,p=n-1;f<p;){var g=f+p>>>1;c[g]<d?f=g+1:p=g}d-c[f-1]<c[f]-d&&e+1<f&&--f;var m=c[f]-h,v=i-m;if(s-r>l-o){var y=(r*v+s*m)/i;t(e,f,m,r,o,y,l),t(f,n,v,y,o,s,l)}else{var b=(o*v+l*m)/i;t(e,f,m,r,o,s,b),t(f,n,v,r,b,s,l)}}(0,l,t.value,e,n,i,r)},t.treemapDice=Ah,t.treemapResquarify=Vh,t.treemapSlice=zh,t.treemapSliceDice=function(t,e,n,i,r){(1&t.depth?zh:Ah)(t,e,n,i,r)},t.treemapSquarify=Fh,t.tsv=Bo,t.tsvFormat=_o,t.tsvFormatBody=Do,t.tsvFormatRow=Oo,t.tsvFormatRows=Ao,t.tsvFormatValue=So,t.tsvParse=wo,t.tsvParseRows=xo,t.utcDay=If,t.utcDays=Ef,t.utcFriday=Of,t.utcFridays=Lf,t.utcHour=bf,t.utcHours=Cf,t.utcMillisecond=zd,t.utcMilliseconds=jd,t.utcMinute=vf,t.utcMinutes=yf,t.utcMonday=xf,t.utcMondays=kf,t.utcMonth=Bf,t.utcMonths=zf,t.utcSaturday=Sf,t.utcSaturdays=Kf,t.utcSecond=Vd,t.utcSeconds=Hd,t.utcSunday=wf,t.utcSundays=Rf,t.utcThursday=Af,t.utcThursdays=Pf,t.utcTuesday=_f,t.utcTuesdays=Nf,t.utcWednesday=Df,t.utcWednesdays=Mf,t.utcWeek=wf,t.utcWeeks=Rf,t.utcYear=jf,t.utcYears=Gf,t.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.variance=l,t.version="5.15.0",t.voronoi=function(){var t=Py,e=Ly,n=null;function i(i){return new vb(i.map(function(n,r){var o=[Math.round(t(n,r,i)/fb)*fb,Math.round(e(n,r,i)/fb)*fb];return o.index=r,o.data=n,o}),n)}return i.polygons=function(t){return i(t).polygons()},i.links=function(t){return i(t).links()},i.triangles=function(t){return i(t).triangles()},i.x=function(e){return arguments.length?(t="function"==typeof e?e:My(+e),i):t},i.y=function(t){return arguments.length?(e="function"==typeof t?t:My(+t),i):e},i.extent=function(t){return arguments.length?(n=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],i):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},i.size=function(t){return arguments.length?(n=null==t?null:[[0,0],[+t[0],+t[1]]],i):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},i},t.window=nt,t.xml=Go,t.zip=function(){return A(arguments)},t.zoom=function(){var e,n,i=xb,r=_b,o=Sb,s=Ab,a=Ob,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,h=kn,d=B("start","zoom","end"),f=500,p=150,g=0;function m(t){t.property("__zoom",Db).on("wheel.zoom",T).on("mousedown.zoom",w).on("dblclick.zoom",x).filter(a).on("touchstart.zoom",_).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",A).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(t,e){return(e=Math.max(l[0],Math.min(l[1],e)))===t.k?t:new Cb(e,t.x,t.y)}function y(t,e,n){var i=e[0]-n[0]*t.k,r=e[1]-n[1]*t.k;return i===t.x&&r===t.y?t:new Cb(t.k,i,r)}function b(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function C(t,e,n){t.on("start.zoom",function(){I(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){I(this,arguments).end()}).tween("zoom",function(){var t=this,i=arguments,o=I(t,i),s=r.apply(t,i),a=null==n?b(s):"function"==typeof n?n.apply(t,i):n,l=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),c=t.__zoom,u="function"==typeof e?e.apply(t,i):e,d=h(c.invert(a).concat(l/c.k),u.invert(a).concat(l/u.k));return function(t){if(1===t)t=u;else{var e=d(t),n=l/e[2];t=new Cb(n,a[0]-e[0]*n,a[1]-e[1]*n)}o.zoom(null,t)}})}function I(t,e,n){return!n&&t.__zooming||new E(t,e)}function E(t,e){this.that=t,this.args=e,this.active=0,this.extent=r.apply(t,e),this.taps=0}function T(){if(i.apply(this,arguments)){var t=I(this,arguments),e=this.__zoom,n=Math.max(l[0],Math.min(l[1],e.k*Math.pow(2,s.apply(this,arguments)))),r=Nt(this);if(t.wheel)t.mouse[0][0]===r[0]&&t.mouse[0][1]===r[1]||(t.mouse[1]=e.invert(t.mouse[0]=r)),clearTimeout(t.wheel);else{if(e.k===n)return;t.mouse=[r,e.invert(r)],yi(this),t.start()}wb(),t.wheel=setTimeout(function(){t.wheel=null,t.end()},p),t.zoom("mouse",o(y(v(e,n),t.mouse[0],t.mouse[1]),t.extent,c))}}function w(){if(!n&&i.apply(this,arguments)){var e=I(this,arguments,!0),r=Dt(t.event.view).on("mousemove.zoom",function(){if(wb(),!e.moved){var n=t.event.clientX-a,i=t.event.clientY-l;e.moved=n*n+i*i>g}e.zoom("mouse",o(y(e.that.__zoom,e.mouse[0]=Nt(e.that),e.mouse[1]),e.extent,c))},!0).on("mouseup.zoom",function(){r.on("mousemove.zoom mouseup.zoom",null),Bt(t.event.view,e.moved),wb(),e.end()},!0),s=Nt(this),a=t.event.clientX,l=t.event.clientY;Kt(t.event.view),Tb(),e.mouse=[s,this.__zoom.invert(s)],yi(this),e.start()}}function x(){if(i.apply(this,arguments)){var e=this.__zoom,n=Nt(this),s=e.invert(n),a=e.k*(t.event.shiftKey?.5:2),l=o(y(v(e,a),n,s),r.apply(this,arguments),c);wb(),u>0?Dt(this).transition().duration(u).call(C,l,n):Dt(this).call(m.transform,l)}}function _(){if(i.apply(this,arguments)){var n,r,o,s,a=t.event.touches,l=a.length,c=I(this,arguments,t.event.changedTouches.length===l);for(Tb(),r=0;r<l;++r)s=[s=Mt(this,a,(o=a[r]).identifier),this.__zoom.invert(s),o.identifier],c.touch0?c.touch1||c.touch0[2]===s[2]||(c.touch1=s,c.taps=0):(c.touch0=s,n=!0,c.taps=1+!!e);e&&(e=clearTimeout(e)),n&&(c.taps<2&&(e=setTimeout(function(){e=null},f)),yi(this),c.start())}}function D(){if(this.__zooming){var n,i,r,s,a=I(this,arguments),l=t.event.changedTouches,u=l.length;for(wb(),e&&(e=clearTimeout(e)),a.taps=0,n=0;n<u;++n)r=Mt(this,l,(i=l[n]).identifier),a.touch0&&a.touch0[2]===i.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===i.identifier&&(a.touch1[0]=r);if(i=a.that.__zoom,a.touch1){var h=a.touch0[0],d=a.touch0[1],f=a.touch1[0],p=a.touch1[1],g=(g=f[0]-h[0])*g+(g=f[1]-h[1])*g,m=(m=p[0]-d[0])*m+(m=p[1]-d[1])*m;i=v(i,Math.sqrt(g/m)),r=[(h[0]+f[0])/2,(h[1]+f[1])/2],s=[(d[0]+p[0])/2,(d[1]+p[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],s=a.touch0[1]}a.zoom("touch",o(y(i,r,s),a.extent,c))}}function A(){if(this.__zooming){var e,i,r=I(this,arguments),o=t.event.changedTouches,s=o.length;for(Tb(),n&&clearTimeout(n),n=setTimeout(function(){n=null},f),e=0;e<s;++e)i=o[e],r.touch0&&r.touch0[2]===i.identifier?delete r.touch0:r.touch1&&r.touch1[2]===i.identifier&&delete r.touch1;if(r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0)r.touch0[1]=this.__zoom.invert(r.touch0[0]);else if(r.end(),2===r.taps){var a=Dt(this).on("dblclick.zoom");a&&a.apply(this,arguments)}}}return m.transform=function(t,e,n){var i=t.selection?t.selection():t;i.property("__zoom",Db),t!==i?C(t,e,n):i.interrupt().each(function(){I(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},m.scaleBy=function(t,e,n){m.scaleTo(t,function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)},n)},m.scaleTo=function(t,e,n){m.transform(t,function(){var t=r.apply(this,arguments),i=this.__zoom,s=null==n?b(t):"function"==typeof n?n.apply(this,arguments):n,a=i.invert(s),l="function"==typeof e?e.apply(this,arguments):e;return o(y(v(i,l),s,a),t,c)},n)},m.translateBy=function(t,e,n){m.transform(t,function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),c)})},m.translateTo=function(t,e,n,i){m.transform(t,function(){var t=r.apply(this,arguments),s=this.__zoom,a=null==i?b(t):"function"==typeof i?i.apply(this,arguments):i;return o(Ib.translate(a[0],a[1]).scale(s.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,c)},i)},E.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){Et(new bb(m,t,this.that.__zoom),d.apply,d,[t,this.that,this.args])}},m.wheelDelta=function(t){return arguments.length?(s="function"==typeof t?t:yb(+t),m):s},m.filter=function(t){return arguments.length?(i="function"==typeof t?t:yb(!!t),m):i},m.touchable=function(t){return arguments.length?(a="function"==typeof t?t:yb(!!t),m):a},m.extent=function(t){return arguments.length?(r="function"==typeof t?t:yb([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),m):r},m.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],m):[l[0],l[1]]},m.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],m):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},m.constrain=function(t){return arguments.length?(o=t,m):o},m.duration=function(t){return arguments.length?(u=+t,m):u},m.interpolate=function(t){return arguments.length?(h=t,m):h},m.on=function(){var t=d.on.apply(d,arguments);return t===d?m:t},m.clickDistance=function(t){return arguments.length?(g=(t=+t)*t,m):Math.sqrt(g)},m},t.zoomIdentity=Ib,t.zoomTransform=Eb,Object.defineProperty(t,"__esModule",{value:!0})}),function(t){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(n,i,r){e.Backbone=t(e,r,n,i)});else if("undefined"!=typeof exports){var n,i=require("underscore");try{n=require("jquery")}catch(r){}t(e,exports,i,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(function(t,e,n,i){var r=t.Backbone,o=Array.prototype.slice;e.VERSION="1.4.0",e.$=i,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s,a=e.Events={},l=/\s+/,c=function(t,e,i,r,o){var s,a=0;if(i&&"object"==typeof i){void 0!==r&&"context"in o&&void 0===o.context&&(o.context=r);for(s=n.keys(i);a<s.length;a++)e=c(t,e,s[a],i[s[a]],o)}else if(i&&l.test(i))for(s=i.split(l);a<s.length;a++)e=t(e,s[a],r,o);else e=t(e,i,r,o);return e};a.on=function(t,e,n){(this._events=c(u,this._events||{},t,e,{context:n,ctx:this,listening:s}),s)&&((this._listeners||(this._listeners={}))[s.id]=s,s.interop=!1);return this},a.listenTo=function(t,e,i){if(!t)return this;var r=t._listenId||(t._listenId=n.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),a=s=o[r];a||(this._listenId||(this._listenId=n.uniqueId("l")),a=s=o[r]=new m(this,t));var l=h(t,e,i,this);if(s=void 0,l)throw l;return a.interop&&a.on(e,i),this};var u=function(t,e,n,i){if(n){var r=t[e]||(t[e]=[]),o=i.context,s=i.ctx,a=i.listening;a&&a.count++,r.push({callback:n,context:o,ctx:o||s,listening:a})}return t},h=function(t,e,n,i){try{t.on(e,n,i)}catch(r){return r}};a.off=function(t,e,n){return this._events?(this._events=c(d,this._events,t,e,{context:n,listeners:this._listeners}),this):this},a.stopListening=function(t,e,i){var r=this._listeningTo;if(!r)return this;for(var o=t?[t._listenId]:n.keys(r),s=0;s<o.length;s++){var a=r[o[s]];if(!a)break;a.obj.off(e,i,this),a.interop&&a.off(e,i)}return n.isEmpty(r)&&(this._listeningTo=void 0),this};var d=function(t,e,i,r){if(t){var o,s=r.context,a=r.listeners,l=0;if(e||s||i){for(o=e?[e]:n.keys(t);l<o.length;l++){var c=t[e=o[l]];if(!c)break;for(var u=[],h=0;h<c.length;h++){var d=c[h];if(i&&i!==d.callback&&i!==d.callback._callback||s&&s!==d.context)u.push(d);else{var f=d.listening;f&&f.off(e,i)}}u.length?t[e]=u:delete t[e]}return t}for(o=n.keys(a);l<o.length;l++)a[o[l]].cleanup()}};a.once=function(t,e,n){var i=c(f,{},t,e,this.off.bind(this));return"string"==typeof t&&null==n&&(e=void 0),this.on(i,e,n)},a.listenToOnce=function(t,e,n){var i=c(f,{},e,n,this.stopListening.bind(this,t));return this.listenTo(t,i)};var f=function(t,e,i,r){if(i){var o=t[e]=n.once(function(){r(e,o),i.apply(this,arguments)});o._callback=i}return t};a.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),n=Array(e),i=0;i<e;i++)n[i]=arguments[i+1];return c(p,this._events,t,void 0,n),this};var p=function(t,e,n,i){if(t){var r=t[e],o=t.all;r&&o&&(o=o.slice()),r&&g(r,i),o&&g(o,[e].concat(i))}return t},g=function(t,e){var n,i=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s,a);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e);return}},m=function(t,e){this.id=t._listenId,this.listener=t,this.obj=e,this.interop=!0,this.count=0,this._events=void 0};m.prototype.on=a.on,m.prototype.off=function(t,e){var n;this.interop?(this._events=c(d,this._events,t,e,{context:void 0,listeners:void 0}),n=!this._events):(this.count--,n=0===this.count),n&&this.cleanup()},m.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},a.bind=a.on,a.unbind=a.off,n.extend(e,a);var v=e.Model=function(t,e){var i=t||{};e||(e={}),this.preinitialize.apply(this,arguments),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{});var r=n.result(this,"defaults");i=n.defaults(n.extend({},r,i),r),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(v.prototype,a,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!n.iteratee(t,this)(this.attributes)},set:function(t,e,i){if(null==t)return this;var r;if("object"==typeof t?(r=t,i=e):(r={})[t]=e,i||(i={}),!this._validate(r,i))return!1;var o=i.unset,s=i.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=n.clone(this.attributes),this.changed={});var c=this.attributes,u=this.changed,h=this._previousAttributes;for(var d in r)e=r[d],n.isEqual(c[d],e)||a.push(d),n.isEqual(h[d],e)?delete u[d]:u[d]=e,o?delete c[d]:c[d]=e;if(this.idAttribute in r&&(this.id=this.get(this.idAttribute)),!s){a.length&&(this._pending=i);for(var f=0;f<a.length;f++)this.trigger("change:"+a[f],this,c[a[f]],i)}if(l)return this;if(!s)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&n.clone(this.changed);var e,i=this._changing?this._previousAttributes:this.attributes,r={};for(var o in t){var s=t[o];n.isEqual(i[o],s)||(r[o]=s,e=!0)}return!!e&&r},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=n.extend({parse:!0},t);var e=this,i=t.success;return t.success=function(n){var r=t.parse?e.parse(n,t):n;if(!e.set(r,t))return!1;i&&i.call(t.context,e,n,t),e.trigger("sync",e,n,t)},H(this,t),this.sync("read",this,t)},save:function(t,e,i){var r;null==t||"object"==typeof t?(r=t,i=e):(r={})[t]=e;var o=(i=n.extend({validate:!0,parse:!0},i)).wait;if(r&&!o){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;var s=this,a=i.success,l=this.attributes;i.success=function(t){s.attributes=l;var e=i.parse?s.parse(t,i):t;if(o&&(e=n.extend({},r,e)),e&&!s.set(e,i))return!1;a&&a.call(i.context,s,t,i),s.trigger("sync",s,t,i)},H(this,i),r&&o&&(this.attributes=n.extend({},l,r));var c=this.isNew()?"create":i.patch?"patch":"update";"patch"!==c||i.attrs||(i.attrs=r);var u=this.sync(c,this,i);return this.attributes=l,u},destroy:function(t){t=t?n.clone(t):{};var e=this,i=t.success,r=t.wait,o=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(n){r&&o(),i&&i.call(t.context,e,n,t),e.isNew()||e.trigger("sync",e,n,t)};var s=!1;return this.isNew()?n.defer(t.success):(H(this,t),s=this.sync("delete",this,t)),r||o(),s},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||V();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1)}});var y=e.Collection=function(t,e){e||(e={}),this.preinitialize.apply(this,arguments),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},b={add:!0,remove:!0,merge:!0},C={add:!0,remove:!1},I=function(t,e,n){n=Math.min(Math.max(n,0),t.length);var i,r=Array(t.length-n),o=e.length;for(i=0;i<r.length;i++)r[i]=t[i+n];for(i=0;i<o;i++)t[i+n]=e[i];for(i=0;i<r.length;i++)t[i+o+n]=r[i]};n.extend(y.prototype,a,{model:v,preinitialize:function(){},initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,C))},remove:function(t,e){e=n.extend({},e);var i=!n.isArray(t);t=i?[t]:t.slice();var r=this._removeModels(t,e);return!e.silent&&r.length&&(e.changes={added:[],merged:[],removed:r},this.trigger("update",this,e)),i?r[0]:r},set:function(t,e){if(null!=t){(e=n.extend({},b,e)).parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var i=!n.isArray(t);t=i?[t]:t.slice();var r=e.at;null!=r&&(r=+r),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);var o,s,a=[],l=[],c=[],u=[],h={},d=e.add,f=e.merge,p=e.remove,g=!1,m=this.comparator&&null==r&&!1!==e.sort,v=n.isString(this.comparator)?this.comparator:null;for(s=0;s<t.length;s++){o=t[s];var y=this.get(o);if(y){if(f&&o!==y){var C=this._isModel(o)?o.attributes:o;e.parse&&(C=y.parse(C,e)),y.set(C,e),c.push(y),m&&!g&&(g=y.hasChanged(v))}h[y.cid]||(h[y.cid]=!0,a.push(y)),t[s]=y}else d&&(o=t[s]=this._prepareModel(o,e))&&(l.push(o),this._addReference(o,e),h[o.cid]=!0,a.push(o))}if(p){for(s=0;s<this.length;s++)h[(o=this.models[s]).cid]||u.push(o);u.length&&this._removeModels(u,e)}var E=!1,T=!m&&d&&p;if(a.length&&T?(E=this.length!==a.length||n.some(this.models,function(t,e){return t!==a[e]}),this.models.length=0,I(this.models,a,0),this.length=this.models.length):l.length&&(m&&(g=!0),I(this.models,l,null==r?this.length:r),this.length=this.models.length),g&&this.sort({silent:!0}),!e.silent){for(s=0;s<l.length;s++)null!=r&&(e.index=r+s),(o=l[s]).trigger("add",o,this,e);(g||E)&&this.trigger("sort",this,e),(l.length||u.length||c.length)&&(e.changes={added:l,removed:u,merged:c},this.trigger("update",this,e))}return i?t[0]:t}},reset:function(t,e){e=e?n.clone(e):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(this._isModel(t)?t.attributes:t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var i=e.length;return n.isFunction(e)&&(e=e.bind(this)),1===i||n.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(t){var e=(t=n.extend({parse:!0},t)).success,i=this;return t.success=function(n){var r=t.reset?"reset":"set";i[r](n,t),e&&e.call(t.context,i,n,t),i.trigger("sync",i,n,t)},H(this,t),this.sync("read",this,t)},create:function(t,e){var i=(e=e?n.clone(e):{}).wait;if(!(t=this._prepareModel(t,e)))return!1;i||this.add(t,e);var r=this,o=e.success;return e.success=function(t,e,n){i&&r.add(t,n),o&&o.call(n.context,t,e,n)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},values:function(){return new T(this,w)},keys:function(){return new T(this,x)},entries:function(){return new T(this,_)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;(e=e?n.clone(e):{}).collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeModels:function(t,e){for(var n=[],i=0;i<t.length;i++){var r=this.get(t[i]);if(r){var o=this.indexOf(r);this.models.splice(o,1),this.length--,delete this._byId[r.cid];var s=this.modelId(r.attributes);null!=s&&delete this._byId[s],e.silent||(e.index=o,r.trigger("remove",r,this,e)),n.push(r),this._removeReference(r,e)}}return n},_isModel:function(t){return t instanceof v},_addReference:function(t,e){this._byId[t.cid]=t;var n=this.modelId(t.attributes);null!=n&&(this._byId[n]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var n=this.modelId(t.attributes);null!=n&&delete this._byId[n],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){if(e){if(("add"===t||"remove"===t)&&n!==this)return;if("destroy"===t&&this.remove(e,i),"change"===t){var r=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes);r!==o&&(null!=r&&delete this._byId[r],null!=o&&(this._byId[o]=e))}}this.trigger.apply(this,arguments)}});var E="function"==typeof Symbol&&Symbol.iterator;E&&(y.prototype[E]=y.prototype.values);var T=function(t,e){this._collection=t,this._kind=e,this._index=0},w=1,x=2,_=3;E&&(T.prototype[E]=function(){return this}),T.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var t,e=this._collection.at(this._index);if(this._index++,this._kind===w)t=e;else{var n=this._collection.modelId(e.attributes);t=this._kind===x?n:[n,e]}return{value:t,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var D=e.View=function(t){this.cid=n.uniqueId("view"),this.preinitialize.apply(this,arguments),n.extend(this,n.pick(t,O)),this._ensureElement(),this.initialize.apply(this,arguments)},A=/^(\S+)\s*(.*)$/,O=["model","collection","el","id","attributes","className","tagName","events"];n.extend(D.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=n.result(this,"events")),!t)return this;for(var e in this.undelegateEvents(),t){var i=t[e];if(n.isFunction(i)||(i=this[i]),i){var r=e.match(A);this.delegate(r[1],r[2],i.bind(this))}}return this},delegate:function(t,e,n){return this.$el.on(t+".delegateEvents"+this.cid,e,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){return this.$el.off(t+".delegateEvents"+this.cid,e,n),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t.class=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}});var S=function(t,e,i,r){n.each(i,function(n,i){e[i]&&(t.prototype[i]=function(t,e,n,i){switch(e){case 1:return function(){return t[n](this[i])};case 2:return function(e){return t[n](this[i],e)};case 3:return function(e,r){return t[n](this[i],R(e,this),r)};case 4:return function(e,r,o){return t[n](this[i],R(e,this),r,o)};default:return function(){var e=o.call(arguments);return e.unshift(this[i]),t[n].apply(t,e)}}}(e,n,i,r))})},R=function(t,e){return n.isFunction(t)?t:n.isObject(t)&&!e._isModel(t)?k(t):n.isString(t)?function(e){return e.get(t)}:t},k=function(t){var e=n.matches(t);return function(t){return e(t.attributes)}};n.each([[y,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models"],[v,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes"]],function(t){var e=t[0],i=t[1],r=t[2];e.mixin=function(t){var i=n.reduce(n.functions(t),function(t,e){return t[e]=0,t},{});S(e,t,i,r)},S(e,n,i,r)}),e.sync=function(t,i,r){var o=N[t];n.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:o,dataType:"json"};if(r.url||(s.url=n.result(i,"url")||V()),null!=r.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",r.emulateJSON&&(s.data._method=o);var a=r.beforeSend;r.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===s.type||r.emulateJSON||(s.processData=!1);var l=r.error;r.error=function(t,e,n){r.textStatus=e,r.errorThrown=n,l&&l.call(r.context,t,e,n)};var c=r.xhr=e.ajax(n.extend(s,r));return i.trigger("request",i,c,r),c};var N={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var M=e.Router=function(t){t||(t={}),this.preinitialize.apply(this,arguments),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},P=/\((.*?)\)/g,L=/(\(\?)?:\w+/g,K=/\*\w+/g,B=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(M.prototype,a,{preinitialize:function(){},initialize:function(){},route:function(t,i,r){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var o=this;return e.history.route(t,function(n){var s=o._extractParameters(t,n);!1!==o.execute(r,s,i)&&(o.trigger.apply(o,["route:"+i].concat(s)),o.trigger("route",i,s),e.history.trigger("route",o,i,s))}),this},execute:function(t,e,n){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(B,"\\$&").replace(P,"(?:$1)?").replace(L,function(t,e){return e?t:"([^/?]+)"}).replace(K,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}});var z=e.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},j=/^[#\/]|\s+$/g,G=/^\/+|\/+$/g,F=/#.*$/;z.started=!1,n.extend(z.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(j,"")},start:function(t){if(z.started)throw new Error("Backbone.history has already been started");if(z.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(G,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,r=i.insertBefore(this.iframe,i.firstChild).contentWindow;r.document.open(),r.document.close(),r.location.hash="#"+this.fragment}var o=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),z.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),n.some(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0}))},navigate:function(t,e){if(!z.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var n=this.root;""!==t&&"?"!==t.charAt(0)||(n=n.slice(0,-1)||"/");var i=n+t;t=t.replace(F,"");var r=this.decodeFragment(t);if(this.fragment!==r){if(this.fragment=r,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var o=this.iframe.contentWindow;e.replace||(o.document.open(),o.document.close()),this._updateHash(o.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new z;v.extend=y.extend=M.extend=D.extend=z.extend=function(t,e){var i,r=this;return i=t&&n.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,e),i.prototype=n.create(r.prototype,t),i.prototype.constructor=i,i.__super__=r.prototype,i};var V=function(){throw new Error('A "url" property or function must be specified')},H=function(t,e){var n=e.error;e.error=function(i){n&&n.call(e.context,t,i,e),t.trigger("error",t,i,e)}};return e}),function(){var t,e;window.CKEDITOR&&window.CKEDITOR.dom||(window.CKEDITOR||(window.CKEDITOR=function(){var t=/(^|.*[\\\/])ckeditor\.js(?:\?.*|;.*)?$/i,e={timestamp:"M9CJ",version:"4.20.0",revision:"cb4a59c665",rnd:Math.floor(900*Math.random())+100,_:{pending:[],basePathSrcPattern:t},status:"unloaded",basePath:function(){var e=window.CKEDITOR_BASEPATH||"";if(!e)for(var n=document.getElementsByTagName("script"),i=0;i<n.length;i++){var r=n[i].src.match(t);if(r){e=r[1];break}}if(-1==e.indexOf(":/")&&"//"!=e.slice(0,2)&&(e=0===e.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+e:location.href.match(/^[^\?]*\/(?:)/)[0]+e),!e)throw'The CKEditor installation path could not be automatically detected. Please set the global variable "CKEDITOR_BASEPATH" before creating editor instances.';return e}(),getUrl:function(t){return-1==t.indexOf(":/")&&0!==t.indexOf("/")&&(t=this.basePath+t),this.appendTimestamp(t)},appendTimestamp:function(t){if(!this.timestamp||"/"===t.charAt(t.length-1)||/[&?]t=/.test(t))return t;var e=0<=t.indexOf("?")?"&":"?";return t+e+"t="+this.timestamp},domReady:function(){function t(){try{document.addEventListener?(document.removeEventListener("DOMContentLoaded",t,!1),window.removeEventListener("load",t,!1),e()):document.attachEvent&&"complete"===document.readyState&&(document.detachEvent("onreadystatechange",t),window.detachEvent("onload",t),e())}catch(n){}}function e(){for(var t;t=n.shift();)t()}var n=[];return function(e){if(n.push(e),"complete"===document.readyState&&setTimeout(t,1),1==n.length)if(document.addEventListener)document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",t),window.attachEvent("onload",t),e=!1;try{e=!window.frameElement}catch(i){}document.documentElement.doScroll&&e&&function e(){try{document.documentElement.doScroll("left")}catch(n){return void setTimeout(e,1)}t()}()}}}()},n=window.CKEDITOR_GETURL;if(n){var i=e.getUrl;e.getUrl=function(t){return n.call(e,t)||i.call(e,t)}}return e}()),e={},CKEDITOR.event||(CKEDITOR.event=function(){},CKEDITOR.event.implementOn=function(t){var e,n=CKEDITOR.event.prototype;for(e in n)null==t[e]&&(t[e]=n[e])},CKEDITOR.event.prototype=function(){function t(t){var e=n(this);return e[t]||(e[t]=new i(t))}var n=function(t){return(t=t.getPrivate&&t.getPrivate()||t._||(t._={})).events||(t.events={})},i=function(t){this.name=t,this.listeners=[]};return i.prototype={getListenerIndex:function(t){for(var e=0,n=this.listeners;e<n.length;e++)if(n[e].fn==t)return e;return-1}},{define:function(e,n){var i=t.call(this,e);CKEDITOR.tools.extend(i,n,!0)},on:function(n,i,r,o,s){function a(t,s,a,c){return t={name:n,sender:this,editor:t,data:s,listenerData:o,stop:a,cancel:c,removeListener:l},!1===i.call(r,t)?e:t.data}function l(){c.removeListener(n,i)}var c=this,u=t.call(this,n);if(0>u.getListenerIndex(i)){u=u.listeners,r||(r=this),isNaN(s)&&(s=10),a.fn=i,a.priority=s;for(var h=u.length-1;0<=h;h--)if(u[h].priority<=s)return u.splice(h+1,0,a),{removeListener:l};u.unshift(a)}return{removeListener:l}},once:function(){var t=Array.prototype.slice.call(arguments),e=t[1];return t[1]=function(t){return t.removeListener(),e.apply(this,arguments)},this.on.apply(this,t)},capture:function(){CKEDITOR.event.useCapture=1;var t=this.on.apply(this,arguments);return CKEDITOR.event.useCapture=0,t},fire:function(){var t=0,i=function(){t=1},r=0,o=function(){r=1};return function(s,a,l){var c=n(this)[s];s=t;var u=r;if(t=r=0,c&&(d=c.listeners).length)for(var h,d=d.slice(0),f=0;f<d.length;f++){if(c.errorProof)try{h=d[f].call(this,l,a,i,o)}catch(p){}else h=d[f].call(this,l,a,i,o);if(h===e?r=1:void 0!==h&&(a=h),t||r)break}return a=!r&&(void 0===a||a),t=s,r=u,a}}(),fireOnce:function(t,e,i){return e=this.fire(t,e,i),delete n(this)[t],e},removeListener:function(t,e){var i=n(this)[t];if(i){var r=i.getListenerIndex(e);0<=r&&i.listeners.splice(r,1)}},removeAllListeners:function(){var t,e=n(this);for(t in e)delete e[t]},hasListeners:function(t){return(t=n(this)[t])&&0<t.listeners.length}}}()),CKEDITOR.editor||(CKEDITOR.editor=function(){CKEDITOR._.pending.push([this,arguments]),CKEDITOR.event.call(this)},CKEDITOR.editor.prototype.fire=function(t,e){return t in{instanceReady:1,loaded:1}&&(this[t]=!0),CKEDITOR.event.prototype.fire.call(this,t,e,this)},CKEDITOR.editor.prototype.fireOnce=function(t,e){return t in{instanceReady:1,loaded:1}&&(this[t]=!0),CKEDITOR.event.prototype.fireOnce.call(this,t,e,this)},CKEDITOR.event.implementOn(CKEDITOR.editor.prototype)),CKEDITOR.env||(CKEDITOR.env=function(){var t=navigator.userAgent.toLowerCase(),e=t.match(/edge[ \/](\d+.?\d*)/),n=-1<t.indexOf("trident/");n={ie:n=!(!e&&!n),edge:!!e,webkit:!n&&-1<t.indexOf(" applewebkit/"),air:-1<t.indexOf(" adobeair/"),mac:-1<t.indexOf("macintosh"),quirks:"BackCompat"==document.compatMode&&(!document.documentMode||10>document.documentMode),mobile:-1<t.indexOf("mobile"),iOS:/(ipad|iphone|ipod)/.test(t),isCustomDomain:function(){if(!this.ie)return!1;var t=document.domain,e=window.location.hostname;return t!=e&&t!="["+e+"]"},secure:"https:"==location.protocol};n.gecko="Gecko"==navigator.product&&!n.webkit&&!n.ie,n.webkit&&(-1<t.indexOf("chrome")?n.chrome=!0:n.safari=!0);var i=0;return n.ie&&(i=e?parseFloat(e[1]):n.quirks||!document.documentMode?parseFloat(t.match(/msie (\d+)/)[1]):document.documentMode,n.ie9Compat=9==i,n.ie8Compat=8==i,n.ie7Compat=7==i,n.ie6Compat=7>i||n.quirks),n.gecko&&(e=t.match(/rv:([\d\.]+)/))&&(i=1e4*(e=e[1].split("."))[0]+100*(e[1]||0)+1*(e[2]||0)),n.air&&(i=parseFloat(t.match(/ adobeair\/(\d+)/)[1])),n.webkit&&(i=parseFloat(t.match(/ applewebkit\/(\d+)/)[1])),n.version=i,n.isCompatible=!(n.ie&&7>i||n.gecko&&4e4>i||n.webkit&&534>i),n.hidpi=2<=window.devicePixelRatio,n.needsBrFiller=n.gecko||n.webkit||n.ie&&10<i,n.needsNbspFiller=n.ie&&11>i,n.cssClass="cke_browser_"+(n.ie?"ie":n.gecko?"gecko":n.webkit?"webkit":"unknown"),n.quirks&&(n.cssClass+=" cke_browser_quirks"),n.ie&&(n.cssClass+=" cke_browser_ie"+(n.quirks?"6 cke_browser_iequirks":n.version)),n.air&&(n.cssClass+=" cke_browser_air"),n.iOS&&(n.cssClass+=" cke_browser_ios"),n.hidpi&&(n.cssClass+=" cke_hidpi"),n}()),"unloaded"==CKEDITOR.status&&(CKEDITOR.event.implementOn(CKEDITOR),CKEDITOR.loadFullCore=function(){if("basic_ready"!=CKEDITOR.status)CKEDITOR.loadFullCore._load=1;else{delete CKEDITOR.loadFullCore;var t=document.createElement("script");t.type="text/javascript",t.src=CKEDITOR.basePath+"ckeditor.js",document.getElementsByTagName("head")[0].appendChild(t)}},CKEDITOR.loadFullCoreTimeout=0,CKEDITOR.add=function(t){(this._.pending||(this._.pending=[])).push(t)},CKEDITOR.domReady(function(){var t=CKEDITOR.loadFullCore,e=CKEDITOR.loadFullCoreTimeout;t&&(CKEDITOR.status="basic_ready",t&&t._load?t():e&&setTimeout(function(){CKEDITOR.loadFullCore&&CKEDITOR.loadFullCore()},1e3*e))}),CKEDITOR.status="basic_loaded"),CKEDITOR.VERBOSITY_WARN=1,CKEDITOR.VERBOSITY_ERROR=2,CKEDITOR.verbosity=CKEDITOR.VERBOSITY_WARN|CKEDITOR.VERBOSITY_ERROR,CKEDITOR.warn=function(t,e){CKEDITOR.verbosity&CKEDITOR.VERBOSITY_WARN&&CKEDITOR.fire("log",{type:"warn",errorCode:t,additionalData:e})},CKEDITOR.error=function(t,e){CKEDITOR.verbosity&CKEDITOR.VERBOSITY_ERROR&&CKEDITOR.fire("log",{type:"error",errorCode:t,additionalData:e})},CKEDITOR.on("log",function(t){if(window.console&&window.console.log){var e=console[t.data.type]?t.data.type:"log",n=t.data.errorCode;(t=t.data.additionalData)?console[e]("[CKEDITOR] Error code: "+n+".",t):console[e]("[CKEDITOR] Error code: "+n+"."),console[e]("[CKEDITOR] For more information about this error go to https://ckeditor.com/docs/ckeditor4/latest/guide/dev_errors.html#"+n)}},null,null,999),CKEDITOR.dom={},function(){function t(t,e,n){this._minInterval=t,this._context=n,this._lastOutput=this._scheduledTimer=0,this._output=CKEDITOR.tools.bind(e,n||{});var i=this;this.input=function(){function t(){i._lastOutput=(new Date).getTime(),i._scheduledTimer=0,i._call()}if(!i._scheduledTimer||!1!==i._reschedule()){var e=(new Date).getTime()-i._lastOutput;e<i._minInterval?i._scheduledTimer=setTimeout(t,i._minInterval-e):t()}}}function e(e,n,i){t.call(this,e,n,i),this._args=[];var r=this;this.input=CKEDITOR.tools.override(this.input,function(t){return function(){r._args=Array.prototype.slice.call(arguments),t.call(this)}})}var n=[],i=CKEDITOR.env.gecko?"-moz-":CKEDITOR.env.webkit?"-webkit-":CKEDITOR.env.ie?"-ms-":"",r=/&/g,o=/>/g,s=/</g,a=/"/g,l=/&(lt|gt|amp|quot|nbsp|shy|#\d{1,5});/g,c={lt:"<",gt:">",amp:"&",quot:'"',nbsp:"\xa0",shy:"\xad"},u=function(t,e){return"#"==e[0]?String.fromCharCode(parseInt(e.slice(1),10)):c[e]};CKEDITOR.on("reset",function(){n=[]}),CKEDITOR.tools={arrayCompare:function(t,e){if(!t&&!e)return!0;if(!t||!e||t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!=e[n])return!1;return!0},getIndex:function(t,e){for(var n=0;n<t.length;++n)if(e(t[n]))return n;return-1},clone:function(t){var e;if(t&&t instanceof Array){e=[];for(var n=0;n<t.length;n++)e[n]=CKEDITOR.tools.clone(t[n]);return e}if(null===t||"object"!=typeof t||t instanceof String||t instanceof Number||t instanceof Boolean||t instanceof Date||t instanceof RegExp||t.nodeType||t.window===t)return t;for(n in e=new t.constructor,t)e[n]=CKEDITOR.tools.clone(t[n]);return e},capitalize:function(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())},extend:function(t){var e,n,i=arguments.length;"boolean"==typeof(e=arguments[i-1])?i--:"boolean"==typeof(e=arguments[i-2])&&(n=arguments[i-1],i-=2);for(var r=1;r<i;r++){var o=arguments[r]||{};CKEDITOR.tools.array.forEach(CKEDITOR.tools.object.keys(o),function(i){!0!==e&&null!=t[i]||n&&!(i in n)||(t[i]=o[i])})}return t},prototypedCopy:function(t){var e=function(){};return e.prototype=t,new e},copy:function(t){var e,n={};for(e in t)n[e]=t[e];return n},isArray:function(t){return"[object Array]"==Object.prototype.toString.call(t)},isEmpty:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},cssVendorPrefix:function(t,e,n){return n?i+t+":"+e+";"+t+":"+e:((n={})[t]=e,n[i+t]=e,n)},cssStyleToDomStyle:function(){var t=document.createElement("div").style,e=void 0!==t.cssFloat?"cssFloat":void 0!==t.styleFloat?"styleFloat":"float";return function(t){return"float"==t?e:t.replace(/-./g,function(t){return t.substr(1).toUpperCase()})}}(),buildStyleHtml:function(t){t=[].concat(t);for(var e,n=[],i=0;i<t.length;i++)(e=t[i])&&(/@import|[{}]/.test(e)?n.push("<style>"+e+"</style>"):(e=CKEDITOR.appendTimestamp(e),n.push('<link type="text/css" rel=stylesheet href="'+e+'">')));return n.join("")},htmlEncode:function(t){return null==t?"":String(t).replace(r,"&amp;").replace(o,"&gt;").replace(s,"&lt;")},htmlDecode:function(t){return t.replace(l,u)},htmlEncodeAttr:function(t){return CKEDITOR.tools.htmlEncode(t).replace(a,"&quot;")},htmlDecodeAttr:function(t){return CKEDITOR.tools.htmlDecode(t)},transformPlainTextToHtml:function(t,e){var n=e==CKEDITOR.ENTER_BR,i=(i=this.htmlEncode(t.replace(/\r\n/g,"\n"))).replace(/\t/g,"&nbsp;&nbsp; &nbsp;"),r=e==CKEDITOR.ENTER_P?"p":"div";if(!n){var o=/\n{2}/g;if(o.test(i)){var s="<"+r+">",a="</"+r+">";i=s+i.replace(o,function(){return a+s})+a}}return i=i.replace(/\n/g,"<br>"),n||(i=i.replace(new RegExp("<br>(?=</"+r+">)"),function(t){return CKEDITOR.tools.repeat(t,2)})),(i=i.replace(/^ | $/g,"&nbsp;")).replace(/(>|\s) /g,function(t,e){return e+"&nbsp;"}).replace(/ (?=<)/g,"&nbsp;")},getNextNumber:function(){var t=0;return function(){return++t}}(),getNextId:function(){return"cke_"+this.getNextNumber()},getUniqueId:function(){for(var t="e",e=0;8>e;e++)t+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return t},override:function(t,e){var n=e(t);return n.prototype=t.prototype,n},setTimeout:function(t,e,n,i,r){return r||(r=window),n||(n=r),r.setTimeout(function(){i?t.apply(n,[].concat(i)):t.apply(n)},e||0)},debounce:function(t,e){var n;return function(){var i=this,r=arguments;clearTimeout(n),n=setTimeout(function(){n=null,t.apply(i,r)},e)}},throttle:function(t,e,n){return new this.buffers.throttle(t,e,n)},trim:function(){var t=/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g;return function(e){return e.replace(t,"")}}(),ltrim:function(){var t=/^[ \t\n\r]+/g;return function(e){return e.replace(t,"")}}(),rtrim:function(){var t=/[ \t\n\r]+$/g;return function(e){return e.replace(t,"")}}(),indexOf:function(t,e){if("function"==typeof e){for(var n=0,i=t.length;n<i;n++)if(e(t[n]))return n}else{if(t.indexOf)return t.indexOf(e);for(n=0,i=t.length;n<i;n++)if(t[n]===e)return n}return-1},search:function(t,e){var n=CKEDITOR.tools.indexOf(t,e);return 0<=n?t[n]:null},bind:function(t,e){var n=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}},createClass:function(t){var e=t.$,n=t.base,i=t.privates||t._,r=t.proto;if(t=t.statics,!e&&(e=function(){n&&this.base.apply(this,arguments)}),i){var o=e;e=function(){var t,e=this._||(this._={});for(t in i){var n=i[t];e[t]="function"==typeof n?CKEDITOR.tools.bind(n,this):n}o.apply(this,arguments)}}return n&&(e.prototype=this.prototypedCopy(n.prototype),e.prototype.constructor=e,e.base=n,e.baseProto=n.prototype,e.prototype.base=function t(){this.base=n.prototype.base,n.apply(this,arguments),this.base=t}),r&&this.extend(e.prototype,r,!0),t&&this.extend(e,t,!0),e},addFunction:function(t,e){return n.push(function(){return t.apply(e||this,arguments)})-1},removeFunction:function(t){n[t]=null},callFunction:function(t){var e=n[t];return e&&e.apply(window,Array.prototype.slice.call(arguments,1))},cssLength:function(){var t,e=/^-?\d+\.?\d*px$/;return function(n){return t=CKEDITOR.tools.trim(n+"")+"px",e.test(t)?t:n||""}}(),convertToPx:function(){var t,e;return function(n){if(t&&!t.isDetached()||(t=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;margin:0px;padding:0px;border:0px;"></div>',CKEDITOR.document),CKEDITOR.document.getBody().append(t)),!/%$/.test(n)){var i=0>parseFloat(n);return i&&(n=n.replace("-","")),t.setStyle("width",n),e=t.getClientRect(),n=Math.round(e.width),i?-n:n}return n}}(),repeat:function(t,e){return Array(e+1).join(t)},tryThese:function(){for(var t,e=0,n=arguments.length;e<n;e++){var i=arguments[e];try{t=i();break}catch(a){}}return t},genKey:function(){return Array.prototype.slice.call(arguments).join("-")},defer:function(t){return function(){var e=arguments,n=this;window.setTimeout(function(){t.apply(n,e)},0)}},normalizeCssText:function(t,e){var n,i=[],r=CKEDITOR.tools.parseCssText(t,!0,e);for(n in r)i.push(n+":"+r[n]);return i.sort(),i.length?i.join(";")+";":""},convertRgbToHex:function(t){return t.replace(/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi,function(t,e,n,i){for(t=[e,n,i],e=0;3>e;e++)t[e]=("0"+parseInt(t[e],10).toString(16)).slice(-2);return"#"+t.join("")})},normalizeHex:function(t){return t.replace(/#(([0-9a-f]{3}){1,2})($|;|\s+)/gi,function(t,e,n,i){return 3==(t=e.toLowerCase()).length&&(t=[(t=t.split(""))[0],t[0],t[1],t[1],t[2],t[2]].join("")),"#"+t+i})},_isValidColorFormat:function(t){return!!t&&(t=t.replace(/\s+/g,""),/^[a-z0-9()#%,./]+$/i.test(t))},parseCssText:function(t,e,n){var i={};return n&&(t=new CKEDITOR.dom.element("span").setAttribute("style",t).getAttribute("style")||""),t&&(t=CKEDITOR.tools.normalizeHex(CKEDITOR.tools.convertRgbToHex(t))),t&&";"!=t?(t.replace(/&quot;/g,'"').replace(/\s*([^:;\s]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(t,n,r){e&&("font-family"==(n=n.toLowerCase())&&(r=r.replace(/\s*,\s*/g,",")),r=CKEDITOR.tools.trim(r)),i[n]=r}),i):i},writeCssText:function(t,e){var n,i=[];for(n in t)i.push(n+":"+t[n]);return e&&i.sort(),i.join("; ")},objectCompare:function(t,e,n){var i;if(!t&&!e)return!0;if(!t||!e)return!1;for(i in t)if(t[i]!=e[i])return!1;if(!n)for(i in e)if(t[i]!=e[i])return!1;return!0},objectKeys:function(t){return CKEDITOR.tools.object.keys(t)},convertArrayToObject:function(t,e){var n={};1==arguments.length&&(e=!0);for(var i=0,r=t.length;i<r;++i)n[t[i]]=e;return n},getStyledSpans:function(t,e){var n=CKEDITOR.env.ie&&8==CKEDITOR.env.version?t.toUpperCase():t;n=e.find("span[style*="+n+"]").toArray();return CKEDITOR.tools.array.filter(n,function(e){return!!e.getStyle(t)})},fixDomain:function(){for(var t;;)try{t=window.parent.document.domain;break}catch(l){if(!(t=t?t.replace(/.+?(?:\.|$)/,""):document.domain))break;document.domain=t}return!!t},eventsBuffer:function(t,e,n){return new this.buffers.event(t,e,n)},enableHtml5Elements:function(t,e){for(var n,i="abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup main mark meter nav output progress section summary time video".split(" "),r=i.length;r--;)n=t.createElement(i[r]),e&&t.appendChild(n)},checkIfAnyArrayItemMatches:function(t,e){for(var n=0,i=t.length;n<i;++n)if(t[n].match(e))return!0;return!1},checkIfAnyObjectPropertyMatches:function(t,e){for(var n in t)if(n.match(e))return!0;return!1},keystrokeToString:function(t,e){var n=this.keystrokeToArray(t,e);return n.display=n.display.join("+"),n.aria=n.aria.join("+"),n},keystrokeToArray:function(t,e){var n=16711680&e,i=65535&e,r=CKEDITOR.env.mac,o=[],s=[];return n&CKEDITOR.CTRL&&(o.push(r?"\u2318":t[17]),s.push(r?t[224]:t[17])),n&CKEDITOR.ALT&&(o.push(r?"\u2325":t[18]),s.push(t[18])),n&CKEDITOR.SHIFT&&(o.push(r?"\u21e7":t[16]),s.push(t[16])),i&&(t[i]?(o.push(t[i]),s.push(t[i])):(o.push(String.fromCharCode(i)),s.push(String.fromCharCode(i)))),{display:o,aria:s}},transparentImageData:"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==",getCookie:function(t){t=t.toLowerCase();for(var e,n=document.cookie.split(";"),i=0;i<n.length;i++)if(e=n[i].split("="),decodeURIComponent(CKEDITOR.tools.trim(e[0]).toLowerCase())===t)return decodeURIComponent(1<e.length?e[1]:"");return null},setCookie:function(t,e){document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)+";path=/"},getCsrfToken:function(){if(!(t=CKEDITOR.tools.getCookie("ckCsrfToken"))||40!=t.length){var t=[],e="";if(window.crypto&&window.crypto.getRandomValues)t=new Uint8Array(40),window.crypto.getRandomValues(t);else for(var n=0;40>n;n++)t.push(Math.floor(256*Math.random()));for(n=0;n<t.length;n++){var i="abcdefghijklmnopqrstuvwxyz0123456789".charAt(t[n]%36);e=e+(.5<Math.random()?i.toUpperCase():i)}t=e,CKEDITOR.tools.setCookie("ckCsrfToken",t)}return t},escapeCss:function(t){if(t)if(window.CSS&&CSS.escape)t=CSS.escape(t);else{for(var e,n=(t=String(t)).length,i=-1,r="",o=t.charCodeAt(0);++i<n;)r=0==(e=t.charCodeAt(i))?r+"\ufffd":127==e||1<=e&&31>=e||0==i&&48<=e&&57>=e||1==i&&48<=e&&57>=e&&45==o?r+"\\"+e.toString(16)+" ":0==i&&1==n&&45==e?r+"\\"+t.charAt(i):128<=e||45==e||95==e||48<=e&&57>=e||65<=e&&90>=e||97<=e&&122>=e?r+t.charAt(i):r+"\\"+t.charAt(i);t=r}else t="";return t},getMouseButton:function(t){return!!(t=t&&t.data?t.data.$:t)&&CKEDITOR.tools.normalizeMouseButton(t.button)},normalizeMouseButton:function(t,e){if(!CKEDITOR.env.ie||9<=CKEDITOR.env.version&&!CKEDITOR.env.ie6Compat)return t;for(var n=[[CKEDITOR.MOUSE_BUTTON_LEFT,1],[CKEDITOR.MOUSE_BUTTON_MIDDLE,4],[CKEDITOR.MOUSE_BUTTON_RIGHT,2]],i=0;i<n.length;i++){var r=n[i];if(r[0]===t&&e)return r[1];if(!e&&r[1]===t)return r[0]}},convertHexStringToBytes:function(t){var e,n=[],i=t.length/2;for(e=0;e<i;e++)n.push(parseInt(t.substr(2*e,2),16));return n},convertBytesToBase64:function(t){var e,n="",i=t.length;for(e=0;e<i;e+=3){var r,o=t.slice(e,e+3),s=o.length,a=[];if(3>s)for(r=s;3>r;r++)o[r]=0;for(a[0]=(252&o[0])>>2,a[1]=(3&o[0])<<4|o[1]>>4,a[2]=(15&o[1])<<2|(192&o[2])>>6,a[3]=63&o[2],r=0;4>r;r++)n=r<=s?n+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a[r]):n+"="}return n},style:{parse:{_borderStyle:"none hidden dotted dashed solid double groove ridge inset outset".split(" "),_widthRegExp:/^(thin|medium|thick|[\+-]?\d+(\.\d+)?[a-z%]+|[\+-]?0+(\.0+)?|\.\d+[a-z%]+)$/,_rgbaRegExp:/rgba?\(\s*\d+%?\s*,\s*\d+%?\s*,\s*\d+%?\s*(?:,\s*[0-9.]+\s*)?\)/gi,_hslaRegExp:/hsla?\(\s*[0-9.]+\s*,\s*\d+%\s*,\s*\d+%\s*(?:,\s*[0-9.]+\s*)?\)/gi,background:function(t){var e={},n=this._findColor(t);return n.length&&(e.color=n[0],CKEDITOR.tools.array.forEach(n,function(e){t=t.replace(e,"")})),(t=CKEDITOR.tools.trim(t))&&(e.unprocessed=t),e},margin:function(t){return CKEDITOR.tools.style.parse.sideShorthand(t,function(t){return t.match(/(?:\-?[\.\d]+(?:%|\w*)|auto|inherit|initial|unset|revert)/g)||["0px"]})},sideShorthand:function(t,e){function n(t){i.top=r[t[0]],i.right=r[t[1]],i.bottom=r[t[2]],i.left=r[t[3]]}var i={},r=e?e(t):t.split(/\s+/);switch(r.length){case 1:n([0,0,0,0]);break;case 2:n([0,1,0,1]);break;case 3:n([0,1,2,1]);break;case 4:n([0,1,2,3])}return i},border:function(t){return CKEDITOR.tools.style.border.fromCssRule(t)},_findColor:function(t){var e=[],n=CKEDITOR.tools.array;return(e=(e=e.concat(t.match(this._rgbaRegExp)||[])).concat(t.match(this._hslaRegExp)||[])).concat(n.filter(t.split(/\s+/),function(t){return!!t.match(/^\#[a-f0-9]{3}(?:[a-f0-9]{3})?$/gi)||t.toLowerCase()in CKEDITOR.tools.style.parse._colors}))}}},array:{filter:function(t,e,n){var i=[];return this.forEach(t,function(r,o){e.call(n,r,o,t)&&i.push(r)}),i},find:function(t,e,n){for(var i=t.length,r=0;r<i;){if(e.call(n,t[r],r,t))return t[r];r++}},forEach:function(t,e,n){var i,r=t.length;for(i=0;i<r;i++)e.call(n,t[i],i,t)},map:function(t,e,n){for(var i=[],r=0;r<t.length;r++)i.push(e.call(n,t[r],r,t));return i},reduce:function(t,e,n,i){for(var r=0;r<t.length;r++)n=e.call(i,n,t[r],r,t);return n},every:function(t,e,n){return!t.length||(e=this.filter(t,e,n),t.length===e.length)},some:function(t,e,n){for(var i=0;i<t.length;i++)if(e.call(n,t[i],i,t))return!0;return!1},zip:function(t,e){return CKEDITOR.tools.array.map(t,function(t,n){return[t,e[n]]})},unique:function(t){return this.filter(t,function(e,n){return n===CKEDITOR.tools.array.indexOf(t,e)})}},object:{DONT_ENUMS:"toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),entries:function(t){return CKEDITOR.tools.array.map(CKEDITOR.tools.object.keys(t),function(e){return[e,t[e]]})},values:function(t){return CKEDITOR.tools.array.map(CKEDITOR.tools.object.keys(t),function(e){return t[e]})},keys:function(t){var e=Object.prototype.hasOwnProperty,n=[],i=CKEDITOR.tools.object.DONT_ENUMS;if(CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(!t||"object"!=typeof t)){if(e=[],"string"==typeof t)for(n=0;n<t.length;n++)e.push(String(n));return e}for(var r in t)n.push(r);if(CKEDITOR.env.ie&&9>CKEDITOR.env.version)for(r=0;r<i.length;r++)e.call(t,i[r])&&n.push(i[r]);return n},findKey:function(t,e){if("object"!=typeof t)return null;for(var n in t)if(t[n]===e)return n;return null},merge:function(t,e){var n=CKEDITOR.tools,i=n.clone(t),r=n.clone(e);return n.array.forEach(n.object.keys(r),function(t){i[t]="object"==typeof r[t]&&"object"==typeof i[t]?n.object.merge(i[t],r[t]):r[t]}),i}},getAbsoluteRectPosition:function(t,e){var n=CKEDITOR.tools.copy(e);!function t(e){if(e){var i=e.getClientRect();n.top+=i.top,n.left+=i.left,"x"in n&&"y"in n&&(n.x+=i.x,n.y+=i.y),t(e.getWindow().getFrame())}}(t.getFrame());var i=CKEDITOR.document.getWindow().getScrollPosition();return n.top+=i.y,n.left+=i.x,"x"in n&&"y"in n&&(n.y+=i.y,n.x+=i.x),n.right=n.left+n.width,n.bottom=n.top+n.height,n}},t.prototype={reset:function(){this._lastOutput=0,this._clearTimer()},_reschedule:function(){return!1},_call:function(){this._output()},_clearTimer:function(){this._scheduledTimer&&clearTimeout(this._scheduledTimer),this._scheduledTimer=0}},e.prototype=CKEDITOR.tools.prototypedCopy(t.prototype),e.prototype._reschedule=function(){this._scheduledTimer&&this._clearTimer()},e.prototype._call=function(){this._output.apply(this._context,this._args)},CKEDITOR.tools.buffers={},CKEDITOR.tools.buffers.event=t,CKEDITOR.tools.buffers.throttle=e,CKEDITOR.tools.style.border=CKEDITOR.tools.createClass({$:function(t){t=t||{},this.width=t.width,this.style=t.style,this.color=t.color,this._.normalize()},_:{normalizeMap:{color:[[/windowtext/g,"black"]]},normalize:function(){for(var t in this._.normalizeMap){var e=this[t];e&&(this[t]=CKEDITOR.tools.array.reduce(this._.normalizeMap[t],function(t,e){return t.replace(e[0],e[1])},e))}}},proto:{toString:function(){return CKEDITOR.tools.array.filter([this.width,this.style,this.color],function(t){return!!t}).join(" ")}},statics:{fromCssRule:function(t){var e={},n=t.split(/\s+/g);return(t=CKEDITOR.tools.style.parse._findColor(t)).length&&(e.color=t[0]),CKEDITOR.tools.array.forEach(n,function(t){e.style||-1===CKEDITOR.tools.indexOf(CKEDITOR.tools.style.parse._borderStyle,t)?!e.width&&CKEDITOR.tools.style.parse._widthRegExp.test(t)&&(e.width=t):e.style=t}),new CKEDITOR.tools.style.border(e)},splitCssValues:function(t,e){e=e||{};var n=CKEDITOR.tools.array.reduce(["width","style","color"],function(n,i){var r=t["border-"+i]||e[i];return n[i]=r?CKEDITOR.tools.style.parse.sideShorthand(r):null,n},{});return CKEDITOR.tools.array.reduce(["top","right","bottom","left"],function(e,i){var r,o={};for(r in n){var s=t["border-"+i+"-"+r];o[r]=s||n[r]&&n[r][i]}return e["border-"+i]=new CKEDITOR.tools.style.border(o),e},{})}}}),CKEDITOR.tools.array.indexOf=CKEDITOR.tools.indexOf,CKEDITOR.tools.array.isArray=CKEDITOR.tools.isArray,CKEDITOR.MOUSE_BUTTON_LEFT=0,CKEDITOR.MOUSE_BUTTON_MIDDLE=1,CKEDITOR.MOUSE_BUTTON_RIGHT=2}(),CKEDITOR.dtd=function(){var t=CKEDITOR.tools.extend,e=function(t,e){for(var n=CKEDITOR.tools.clone(t),i=1;i<arguments.length;i++)for(var r in e=arguments[i])delete n[r];return n},n={},i={},r={address:1,article:1,aside:1,blockquote:1,details:1,div:1,dl:1,fieldset:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,menu:1,nav:1,ol:1,p:1,pre:1,section:1,table:1,ul:1},o={command:1,link:1,meta:1,noscript:1,script:1,style:1},s={},a={"#":1},l={center:1,dir:1,noframes:1};return t(n,{a:1,abbr:1,area:1,audio:1,b:1,bdi:1,bdo:1,br:1,button:1,canvas:1,cite:1,code:1,command:1,datalist:1,del:1,dfn:1,em:1,embed:1,i:1,iframe:1,img:1,input:1,ins:1,kbd:1,keygen:1,label:1,map:1,mark:1,meter:1,noscript:1,object:1,output:1,progress:1,q:1,ruby:1,s:1,samp:1,script:1,select:1,small:1,span:1,strong:1,sub:1,sup:1,textarea:1,time:1,u:1,var:1,video:1,wbr:1},a,{acronym:1,applet:1,basefont:1,big:1,font:1,isindex:1,strike:1,style:1,tt:1}),t(i,r,n,l),e={a:e(n,{a:1,button:1}),abbr:n,address:i,area:s,article:i,aside:i,audio:t({source:1,track:1},i),b:n,base:s,bdi:n,bdo:n,blockquote:i,body:i,br:s,button:e(n,{a:1,button:1}),canvas:n,caption:i,cite:n,code:n,col:s,colgroup:{col:1},command:s,datalist:t({option:1},n),dd:i,del:n,details:t({summary:1},i),dfn:n,div:i,dl:{dt:1,dd:1},dt:i,em:n,embed:s,fieldset:t({legend:1},i),figcaption:i,figure:t({figcaption:1},i),footer:i,form:i,h1:n,h2:n,h3:n,h4:n,h5:n,h6:n,head:t({title:1,base:1},o),header:i,hgroup:{h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},hr:s,html:t({head:1,body:1},i,o),i:n,iframe:a,img:s,input:s,ins:n,kbd:n,keygen:s,label:n,legend:n,li:i,link:s,main:i,map:i,mark:n,menu:t({li:1},i),meta:s,meter:e(n,{meter:1}),nav:i,noscript:t({link:1,meta:1,style:1},n),object:t({param:1},n),ol:{li:1},optgroup:{option:1},option:a,output:n,p:n,param:s,pre:n,progress:e(n,{progress:1}),q:n,rp:n,rt:n,ruby:t({rp:1,rt:1},n),s:n,samp:n,script:a,section:i,select:{optgroup:1,option:1},small:n,source:s,span:n,strong:n,style:a,sub:n,summary:t({h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},n),sup:n,table:{caption:1,colgroup:1,thead:1,tfoot:1,tbody:1,tr:1},tbody:{tr:1},td:i,textarea:a,tfoot:{tr:1},th:i,thead:{tr:1},time:e(n,{time:1}),title:a,tr:{th:1,td:1},track:s,u:n,ul:{li:1},var:n,video:t({source:1,track:1},i),wbr:s,acronym:n,applet:t({param:1},i),basefont:s,big:n,center:i,dialog:s,dir:{li:1},font:n,isindex:s,noframes:i,strike:n,tt:n},t(e,{$block:t({audio:1,dd:1,dt:1,figcaption:1,li:1,video:1},r,l),$blockLimit:{article:1,aside:1,audio:1,body:1,caption:1,details:1,dir:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,header:1,hgroup:1,main:1,menu:1,nav:1,ol:1,section:1,table:1,td:1,th:1,tr:1,ul:1,video:1},$cdata:{script:1,style:1},$editable:{address:1,article:1,aside:1,blockquote:1,body:1,details:1,div:1,fieldset:1,figcaption:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,main:1,nav:1,p:1,pre:1,section:1},$empty:{area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},$inline:n,$list:{dl:1,ol:1,ul:1},$listItem:{dd:1,dt:1,li:1},$nonBodyContent:t({body:1,head:1,html:1},e.head),$nonEditable:{applet:1,audio:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,param:1,script:1,textarea:1,video:1},$object:{applet:1,audio:1,button:1,hr:1,iframe:1,img:1,input:1,object:1,select:1,table:1,textarea:1,video:1},$removeEmpty:{abbr:1,acronym:1,b:1,bdi:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,mark:1,meter:1,output:1,q:1,ruby:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,time:1,tt:1,u:1,var:1},$tabIndex:{a:1,area:1,button:1,input:1,object:1,select:1,textarea:1},$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},$transparent:{a:1,audio:1,canvas:1,del:1,ins:1,map:1,noscript:1,object:1,video:1},$intermediate:{caption:1,colgroup:1,dd:1,dt:1,figcaption:1,legend:1,li:1,optgroup:1,option:1,rp:1,rt:1,summary:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1}}),e}(),CKEDITOR.dom.event=function(t){this.$=t},CKEDITOR.dom.event.prototype={getKey:function(){return this.$.keyCode||this.$.which},getKeystroke:function(){var t=this.getKey();return(this.$.ctrlKey||this.$.metaKey)&&(t+=CKEDITOR.CTRL),this.$.shiftKey&&(t+=CKEDITOR.SHIFT),this.$.altKey&&(t+=CKEDITOR.ALT),t},preventDefault:function(t){var e=this.$;e.preventDefault?e.preventDefault():e.returnValue=!1,t&&this.stopPropagation()},stopPropagation:function(){var t=this.$;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},getTarget:function(){var t=this.$.target||this.$.srcElement;return t?new CKEDITOR.dom.node(t):null},getPhase:function(){return this.$.eventPhase||2},getPageOffset:function(){var t=this.getTarget().getDocument().$;return{x:this.$.pageX||this.$.clientX+(t.documentElement.scrollLeft||t.body.scrollLeft),y:this.$.pageY||this.$.clientY+(t.documentElement.scrollTop||t.body.scrollTop)}}},CKEDITOR.CTRL=1114112,CKEDITOR.SHIFT=2228224,CKEDITOR.ALT=4456448,CKEDITOR.EVENT_PHASE_CAPTURING=1,CKEDITOR.EVENT_PHASE_AT_TARGET=2,CKEDITOR.EVENT_PHASE_BUBBLING=3,CKEDITOR.HISTORY_NATIVE=1,CKEDITOR.HISTORY_HASH=2,CKEDITOR.HISTORY_OFF=0,CKEDITOR.dom.domObject=function(t){t&&(this.$=t)},CKEDITOR.dom.domObject.prototype={getPrivate:function(){var t;return(t=this.getCustomData("_"))||this.setCustomData("_",t={}),t},on:function(t){var e=this.getCustomData("_cke_nativeListeners");return e||(e={},this.setCustomData("_cke_nativeListeners",e)),e[t]||(e=e[t]=function(t,e){return function(n){"undefined"!=typeof CKEDITOR&&t.fire(e,new CKEDITOR.dom.event(n))}}(this,t),this.$.addEventListener?this.$.addEventListener(t,e,!!CKEDITOR.event.useCapture):this.$.attachEvent&&this.$.attachEvent("on"+t,e)),CKEDITOR.event.prototype.on.apply(this,arguments)},removeListener:function(t){if(CKEDITOR.event.prototype.removeListener.apply(this,arguments),!this.hasListeners(t)){var e=this.getCustomData("_cke_nativeListeners"),n=e&&e[t];n&&(this.$.removeEventListener?this.$.removeEventListener(t,n,!1):this.$.detachEvent&&this.$.detachEvent("on"+t,n),delete e[t])}},removeAllListeners:function(){try{var t,e=this.getCustomData("_cke_nativeListeners");for(t in e){var n=e[t];this.$.detachEvent?this.$.detachEvent("on"+t,n):this.$.removeEventListener&&this.$.removeEventListener(t,n,!1),delete e[t]}}catch(i){if(!CKEDITOR.env.edge||-2146828218!==i.number)throw i}CKEDITOR.event.prototype.removeAllListeners.call(this)}},function(t){var e={};CKEDITOR.on("reset",function(){e={}}),t.equals=function(t){try{return t&&t.$===this.$}catch(e){return!1}},t.setCustomData=function(t,n){var i=this.getUniqueId();return(e[i]||(e[i]={}))[t]=n,this},t.getCustomData=function(t){var n=this.$["data-cke-expando"];return(n=n&&e[n])&&t in n?n[t]:null},t.removeCustomData=function(t){var n,i,r;return(n=(n=this.$["data-cke-expando"])&&e[n])&&(i=n[t],r=t in n,delete n[t]),r?i:null},t.clearCustomData=function(){this.removeAllListeners();var t=this.getUniqueId();t&&delete e[t]},t.getUniqueId=function(){return this.$["data-cke-expando"]||(this.$["data-cke-expando"]=CKEDITOR.tools.getNextNumber())},CKEDITOR.event.implementOn(t)}(CKEDITOR.dom.domObject.prototype),CKEDITOR.dom.node=function(t){return t?new CKEDITOR.dom[t.nodeType==CKEDITOR.NODE_DOCUMENT?"document":t.nodeType==CKEDITOR.NODE_ELEMENT?"element":t.nodeType==CKEDITOR.NODE_TEXT?"text":t.nodeType==CKEDITOR.NODE_COMMENT?"comment":t.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT?"documentFragment":"domObject"](t):this},CKEDITOR.dom.node.prototype=new CKEDITOR.dom.domObject,CKEDITOR.NODE_ELEMENT=1,CKEDITOR.NODE_DOCUMENT=9,CKEDITOR.NODE_TEXT=3,CKEDITOR.NODE_COMMENT=8,CKEDITOR.NODE_DOCUMENT_FRAGMENT=11,CKEDITOR.POSITION_IDENTICAL=0,CKEDITOR.POSITION_DISCONNECTED=1,CKEDITOR.POSITION_FOLLOWING=2,CKEDITOR.POSITION_PRECEDING=4,CKEDITOR.POSITION_IS_CONTAINED=8,CKEDITOR.POSITION_CONTAINS=16,CKEDITOR.tools.extend(CKEDITOR.dom.node.prototype,{appendTo:function(t,e){return t.append(this,e),t},clone:function(t,e){var n=this.$.cloneNode(t);return function n(i){if(i["data-cke-expando"]&&(i["data-cke-expando"]=!1),(i.nodeType==CKEDITOR.NODE_ELEMENT||i.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)&&(e||i.nodeType!=CKEDITOR.NODE_ELEMENT||i.removeAttribute("id",!1),t)){i=i.childNodes;for(var r=0;r<i.length;r++)n(i[r])}}(n),n=new CKEDITOR.dom.node(n),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(this.type==CKEDITOR.NODE_ELEMENT||this.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)&&function e(n){if(n.type==CKEDITOR.NODE_ELEMENT||n.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT){if(n.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var i=n.getName();":"==i[0]&&n.renameNode(i.substring(1))}if(t)for(i=0;i<n.getChildCount();i++)e(n.getChild(i))}}(n),n},hasPrevious:function(){return!!this.$.previousSibling},hasNext:function(){return!!this.$.nextSibling},insertAfter:function(t){return t.$.parentNode.insertBefore(this.$,t.$.nextSibling),t},insertBefore:function(t){return t.$.parentNode.insertBefore(this.$,t.$),t},insertBeforeMe:function(t){return this.$.parentNode.insertBefore(t.$,this.$),t},getAddress:function(t){for(var e=[],n=this.getDocument().$.documentElement,i=this;i&&i!=n;){var r=i.getParent();r&&e.unshift(this.getIndex.call(i,t)),i=r}return e},getDocument:function(){return new CKEDITOR.dom.document(this.$.ownerDocument||this.$.parentNode.ownerDocument)},getIndex:function(t){function e(t,n){var i=n?t.getNext():t.getPrevious();return i&&i.type==CKEDITOR.NODE_TEXT?i.isEmpty()?e(i,n):i:null}var n,i=this,r=-1;if(!this.getParent()||t&&i.type==CKEDITOR.NODE_TEXT&&i.isEmpty()&&!e(i)&&!e(i,!0))return-1;do{t&&!i.equals(this)&&i.type==CKEDITOR.NODE_TEXT&&(n||i.isEmpty())||(r++,n=i.type==CKEDITOR.NODE_TEXT)}while(i=i.getPrevious());return r},getNextSourceNode:function(t,e,n){if(n&&!n.call){var i=n;n=function(t){return!t.equals(i)}}var r;if(!(t=!t&&this.getFirst&&this.getFirst())){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&!1===n(this,!0))return null;t=this.getNext()}for(;!t&&(r=(r||this).getParent());){if(n&&!1===n(r,!0))return null;t=r.getNext()}return!t||n&&!1===n(t)?null:e&&e!=t.type?t.getNextSourceNode(!1,e,n):t},getPreviousSourceNode:function(t,e,n){if(n&&!n.call){var i=n;n=function(t){return!t.equals(i)}}var r;if(!(t=!t&&this.getLast&&this.getLast())){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&!1===n(this,!0))return null;t=this.getPrevious()}for(;!t&&(r=(r||this).getParent());){if(n&&!1===n(r,!0))return null;t=r.getPrevious()}return!t||n&&!1===n(t)?null:e&&t.type!=e?t.getPreviousSourceNode(!1,e,n):t},getPrevious:function(t){var e,n=this.$;do{e=(n=n.previousSibling)&&10!=n.nodeType&&new CKEDITOR.dom.node(n)}while(e&&t&&!t(e));return e},getNext:function(t){var e,n=this.$;do{e=(n=n.nextSibling)&&new CKEDITOR.dom.node(n)}while(e&&t&&!t(e));return e},getParent:function(t){var e=this.$.parentNode;return e&&(e.nodeType==CKEDITOR.NODE_ELEMENT||t&&e.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)?new CKEDITOR.dom.node(e):null},getParents:function(t){var e=this,n=[];do{n[t?"push":"unshift"](e)}while(e=e.getParent());return n},getCommonAncestor:function(t){if(t.equals(this))return this;if(t.contains&&t.contains(this))return t;var e=this.contains?this:this.getParent();do{if(e.contains(t))return e}while(e=e.getParent());return null},getPosition:function(t){var e=this.$,n=t.$;if(e.compareDocumentPosition)return e.compareDocumentPosition(n);if(e==n)return CKEDITOR.POSITION_IDENTICAL;if(this.type==CKEDITOR.NODE_ELEMENT&&t.type==CKEDITOR.NODE_ELEMENT){if(e.contains){if(e.contains(n))return CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING;if(n.contains(e))return CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING}if("sourceIndex"in e)return 0>e.sourceIndex||0>n.sourceIndex?CKEDITOR.POSITION_DISCONNECTED:e.sourceIndex<n.sourceIndex?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING}e=this.getAddress(),t=t.getAddress();n=Math.min(e.length,t.length);for(var i=0;i<n;i++)if(e[i]!=t[i])return e[i]<t[i]?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING;return e.length<t.length?CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING},getAscendant:function(t,e){var n,i,r=this.$;for(e||(r=r.parentNode),"function"==typeof t?(i=!0,n=t):(i=!1,n=function(e){return e="string"==typeof e.nodeName?e.nodeName.toLowerCase():"","string"==typeof t?e==t:e in t});r;){if(n(i?new CKEDITOR.dom.node(r):r))return new CKEDITOR.dom.node(r);try{r=r.parentNode}catch(o){r=null}}return null},hasAscendant:function(t,e){var n=this.$;for(e||(n=n.parentNode);n;){if(n.nodeName&&n.nodeName.toLowerCase()==t)return!0;n=n.parentNode}return!1},move:function(t,e){t.append(this.remove(),e)},remove:function(t){var e=this.$,n=e.parentNode;if(n){if(t)for(;t=e.firstChild;)n.insertBefore(e.removeChild(t),e);n.removeChild(e)}return this},replace:function(t){this.insertBefore(t),t.remove()},trim:function(){this.ltrim(),this.rtrim()},ltrim:function(){for(var t;this.getFirst&&(t=this.getFirst());){if(t.type==CKEDITOR.NODE_TEXT){var e=CKEDITOR.tools.ltrim(t.getText()),n=t.getLength();if(!e){t.remove();continue}e.length<n&&(t.split(n-e.length),this.$.removeChild(this.$.firstChild))}break}},rtrim:function(){for(var t;this.getLast&&(t=this.getLast());){if(t.type==CKEDITOR.NODE_TEXT){var e=CKEDITOR.tools.rtrim(t.getText()),n=t.getLength();if(!e){t.remove();continue}e.length<n&&(t.split(e.length),this.$.lastChild.parentNode.removeChild(this.$.lastChild))}break}CKEDITOR.env.needsBrFiller&&(t=this.$.lastChild)&&1==t.type&&"br"==t.nodeName.toLowerCase()&&t.parentNode.removeChild(t)},isReadOnly:function(t){var e=this;if(this.type!=CKEDITOR.NODE_ELEMENT&&(e=this.getParent()),CKEDITOR.env.edge&&e&&e.is("textarea","input")&&(t=!0),!t&&e&&void 0!==e.$.isContentEditable)return!(e.$.isContentEditable||e.data("cke-editable"));for(;e;){if(e.data("cke-editable"))return!1;if(e.hasAttribute("contenteditable"))return"false"==e.getAttribute("contenteditable");e=e.getParent()}return!0}}),CKEDITOR.dom.window=function(t){CKEDITOR.dom.domObject.call(this,t)},CKEDITOR.dom.window.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.window.prototype,{focus:function(){this.$.focus()},getViewPaneSize:function(){var t=this.$.document,e="CSS1Compat"==t.compatMode;return{width:(e?t.documentElement.clientWidth:t.body.clientWidth)||0,height:(e?t.documentElement.clientHeight:t.body.clientHeight)||0}},getScrollPosition:function(){var t=this.$;return"pageXOffset"in t?{x:t.pageXOffset||0,y:t.pageYOffset||0}:{x:(t=t.document).documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}},getFrame:function(){var t=this.$.frameElement;return t?new CKEDITOR.dom.element.get(t):null}}),CKEDITOR.dom.document=function(t){CKEDITOR.dom.domObject.call(this,t)},CKEDITOR.dom.document.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.document.prototype,{type:CKEDITOR.NODE_DOCUMENT,appendStyleSheet:function(t){if(t=CKEDITOR.appendTimestamp(t),this.$.createStyleSheet)this.$.createStyleSheet(t);else{var e=new CKEDITOR.dom.element("link");e.setAttributes({rel:"stylesheet",type:"text/css",href:t}),this.getHead().append(e)}},appendStyleText:function(t){if(this.$.createStyleSheet){var e=this.$.createStyleSheet("");e.cssText=t}else{var n=new CKEDITOR.dom.element("style",this);n.append(new CKEDITOR.dom.text(t,this)),this.getHead().append(n)}return e||n.$.sheet},createElement:function(t,e){var n=new CKEDITOR.dom.element(t,this);return e&&(e.attributes&&n.setAttributes(e.attributes),e.styles&&n.setStyles(e.styles)),n},createText:function(t){return new CKEDITOR.dom.text(t,this)},focus:function(){this.getWindow().focus()},getActive:function(){var e;try{e=this.$.activeElement}catch(t){return null}return new CKEDITOR.dom.element(e)},getById:function(t){return(t=this.$.getElementById(t))?new CKEDITOR.dom.element(t):null},getByAddress:function(t,e){for(var n=this.$.documentElement,i=0;n&&i<t.length;i++){var r=t[i];if(e)for(var o=-1,s=0;s<n.childNodes.length;s++){var a=n.childNodes[s];if((!0!==e||3!=a.nodeType||!a.previousSibling||3!=a.previousSibling.nodeType)&&++o==r){n=a;break}}else n=n.childNodes[r]}return n?new CKEDITOR.dom.node(n):null},getElementsByTag:function(t,e){return CKEDITOR.env.ie&&8>=document.documentMode||!e||(t=e+":"+t),new CKEDITOR.dom.nodeList(this.$.getElementsByTagName(t))},getHead:function(){var t=this.$.getElementsByTagName("head")[0];return t?new CKEDITOR.dom.element(t):this.getDocumentElement().append(new CKEDITOR.dom.element("head"),!0)},getBody:function(){return new CKEDITOR.dom.element(this.$.body)},getDocumentElement:function(){return new CKEDITOR.dom.element(this.$.documentElement)},getWindow:function(){return new CKEDITOR.dom.window(this.$.parentWindow||this.$.defaultView)},write:function(t){this.$.open("text/html","replace"),CKEDITOR.env.ie&&(t=t.replace(/(?:^\s*<!DOCTYPE[^>]*?>)|^/i,'$&\n<script data-cke-temp="1">('+CKEDITOR.tools.fixDomain+")();<\/script>")),this.$.write(t),this.$.close()},find:function(t){return new CKEDITOR.dom.nodeList(this.$.querySelectorAll(t))},findOne:function(t){return(t=this.$.querySelector(t))?new CKEDITOR.dom.element(t):null},_getHtml5ShivFrag:function(){var t=this.getCustomData("html5ShivFrag");return t||(t=this.$.createDocumentFragment(),CKEDITOR.tools.enableHtml5Elements(t,!0),this.setCustomData("html5ShivFrag",t)),t}}),CKEDITOR.dom.nodeList=function(t){this.$=t},CKEDITOR.dom.nodeList.prototype={count:function(){return this.$.length},getItem:function(t){return 0>t||t>=this.$.length?null:(t=this.$[t])?new CKEDITOR.dom.node(t):null},toArray:function(){return CKEDITOR.tools.array.map(this.$,function(t){return new CKEDITOR.dom.node(t)})}},CKEDITOR.dom.element=function(t,e){"string"==typeof t&&(t=(e?e.$:document).createElement(t)),CKEDITOR.dom.domObject.call(this,t)},CKEDITOR.dom.element.get=function(t){return(t="string"==typeof t?document.getElementById(t)||document.getElementsByName(t)[0]:t)&&(t.$?t:new CKEDITOR.dom.element(t))},CKEDITOR.dom.element.prototype=new CKEDITOR.dom.node,CKEDITOR.dom.element.createFromHtml=function(t,e){var n=new CKEDITOR.dom.element("div",e);return n.setHtml(t),n.getFirst().remove()},CKEDITOR.dom.element.setMarker=function(t,e,n,i){var r=e.getCustomData("list_marker_id")||e.setCustomData("list_marker_id",CKEDITOR.tools.getNextNumber()).getCustomData("list_marker_id"),o=e.getCustomData("list_marker_names")||e.setCustomData("list_marker_names",{}).getCustomData("list_marker_names");return t[r]=e,o[n]=1,e.setCustomData(n,i)},CKEDITOR.dom.element.clearAllMarkers=function(t){for(var e in t)CKEDITOR.dom.element.clearMarkers(t,t[e],1)},CKEDITOR.dom.element.clearMarkers=function(t,e,n){var i,r=e.getCustomData("list_marker_names"),o=e.getCustomData("list_marker_id");for(i in r)e.removeCustomData(i);e.removeCustomData("list_marker_names"),n&&(e.removeCustomData("list_marker_id"),delete t[o])},function(){function t(t,e){return-1<(" "+t+" ").replace(o," ").indexOf(" "+e+" ")}function e(t){var e=!0;return t.$.id||(t.$.id="cke_tmp_"+CKEDITOR.tools.getNextNumber(),e=!1),function(){e||t.removeAttribute("id")}}function n(t,e){var n=CKEDITOR.tools.escapeCss(t.$.id);return"#"+n+" "+e.split(/,\s*/).join(", #"+n+" ")}function i(t){for(var e=0,n=0,i=s[t].length;n<i;n++)e+=parseFloat(this.getComputedStyle(s[t][n])||0,10)||0;return e}var r=void 0!==(r=document.createElement("_").classList)&&null!==String(r.add).match(/\[Native code\]/gi),o=/[\n\t\r]/g;CKEDITOR.tools.extend(CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_ELEMENT,addClass:r?function(t){return this.$.classList.add(t),this}:function(e){var n=this.$.className;return n&&(t(n,e)||(n+=" "+e)),this.$.className=n||e,this},removeClass:r?function(t){var e=this.$;return e.classList.remove(t),e.className||e.removeAttribute("class"),this}:function(e){var n=this.getAttribute("class");return n&&t(n,e)&&((n=n.replace(new RegExp("(?:^|\\s+)"+e+"(?=\\s|$)"),"").replace(/^\s+/,""))?this.setAttribute("class",n):this.removeAttribute("class")),this},hasClass:function(e){return t(this.$.className,e)},append:function(t,e){return"string"==typeof t&&(t=this.getDocument().createElement(t)),e?this.$.insertBefore(t.$,this.$.firstChild):this.$.appendChild(t.$),t},appendHtml:function(t){if(this.$.childNodes.length){var e=new CKEDITOR.dom.element("div",this.getDocument());e.setHtml(t),e.moveChildren(this)}else this.setHtml(t)},appendText:function(t){null!=this.$.text&&CKEDITOR.env.ie&&9>CKEDITOR.env.version?this.$.text+=t:this.append(new CKEDITOR.dom.text(t))},appendBogus:function(t){if(t||CKEDITOR.env.needsBrFiller){for(t=this.getLast();t&&t.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.rtrim(t.getText());)t=t.getPrevious();t&&t.is&&t.is("br")||(t=this.getDocument().createElement("br"),CKEDITOR.env.gecko&&t.setAttribute("type","_moz"),this.append(t))}},breakParent:function(t,e){var n=new CKEDITOR.dom.range(this.getDocument());n.setStartAfter(this),n.setEndAfter(t);var i,r=n.extractContents(!1,e||!1);if(n.insertNode(this.remove()),CKEDITOR.env.ie&&!CKEDITOR.env.edge){for(n=new CKEDITOR.dom.element("div");i=r.getFirst();)i.$.style.backgroundColor&&(i.$.style.backgroundColor=i.$.style.backgroundColor),n.append(i);n.insertAfter(this),n.remove(!0)}else r.insertAfterNode(this)},contains:document.compareDocumentPosition?function(t){return!!(16&this.$.compareDocumentPosition(t.$))}:function(t){var e=this.$;return t.type!=CKEDITOR.NODE_ELEMENT?e.contains(t.getParent().$):e!=t.$&&e.contains(t.$)},focus:function(){function t(){try{this.$.focus()}catch(t){}}return function(e){e?CKEDITOR.tools.setTimeout(t,100,this):t.call(this)}}(),getHtml:function(){var t=this.$.innerHTML;return CKEDITOR.env.ie?t.replace(/<\?[^>]*>/g,""):t},getOuterHtml:function(){if(this.$.outerHTML)return this.$.outerHTML.replace(/<\?[^>]*>/,"");var t=this.$.ownerDocument.createElement("div");return t.appendChild(this.$.cloneNode(!0)),t.innerHTML},getClientRect:function(t){var e=CKEDITOR.tools.extend({},this.$.getBoundingClientRect());return!e.width&&(e.width=e.right-e.left),!e.height&&(e.height=e.bottom-e.top),t?CKEDITOR.tools.getAbsoluteRectPosition(this.getWindow(),e):e},setHtml:CKEDITOR.env.ie&&9>CKEDITOR.env.version?function(t){try{var e=this.$;if(this.getParent())return e.innerHTML=t;var n=this.getDocument()._getHtml5ShivFrag();return n.appendChild(e),e.innerHTML=t,n.removeChild(e),t}catch(i){for(this.$.innerHTML="",(e=new CKEDITOR.dom.element("body",this.getDocument())).$.innerHTML=t,e=e.getChildren();e.count();)this.append(e.getItem(0));return t}}:function(t){return this.$.innerHTML=t},setText:function(){var t=document.createElement("p");return t.innerHTML="x",t=t.textContent,function(e){this.$[t?"textContent":"innerText"]=e}}(),getAttribute:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(t){switch(t){case"class":t="className";break;case"http-equiv":t="httpEquiv";break;case"name":return this.$.name;case"tabindex":return 0!==(t=this.$.getAttribute(t,2))&&0===this.$.tabIndex&&(t=null),t;case"checked":return((t=this.$.attributes.getNamedItem(t)).specified?t.nodeValue:this.$.checked)?"checked":null;case"hspace":case"value":return this.$[t];case"style":return this.$.style.cssText;case"contenteditable":case"contentEditable":return this.$.attributes.getNamedItem("contentEditable").specified?this.$.getAttribute("contentEditable"):null}return this.$.getAttribute(t,2)}:function(t){return this.$.getAttribute(t,2)},getAttributes:function(t){var e,n={},i=this.$.attributes;for(t=CKEDITOR.tools.isArray(t)?t:[],e=0;e<i.length;e++)-1===CKEDITOR.tools.indexOf(t,i[e].name)&&(n[i[e].name]=i[e].value);return n},getChildren:function(){return new CKEDITOR.dom.nodeList(this.$.childNodes)},getClientSize:function(){return{width:this.$.clientWidth,height:this.$.clientHeight}},getComputedStyle:document.defaultView&&document.defaultView.getComputedStyle?function(t){var e=this.getWindow().$.getComputedStyle(this.$,null);return e?e.getPropertyValue(t):""}:function(t){return this.$.currentStyle[CKEDITOR.tools.cssStyleToDomStyle(t)]},getDtd:function(){var t=CKEDITOR.dtd[this.getName()];return this.getDtd=function(){return t},t},getElementsByTag:CKEDITOR.dom.document.prototype.getElementsByTag,getTabIndex:function(){var t=this.$.tabIndex;return 0!==t||CKEDITOR.dtd.$tabIndex[this.getName()]||0===parseInt(this.getAttribute("tabindex"),10)?t:-1},getText:function(){return this.$.textContent||this.$.innerText||""},getWindow:function(){return this.getDocument().getWindow()},getId:function(){return this.$.id||null},getNameAtt:function(){return this.$.name||null},getName:function(){var t=this.$.nodeName.toLowerCase();if(CKEDITOR.env.ie&&8>=document.documentMode){var e=this.$.scopeName;"HTML"!=e&&(t=e.toLowerCase()+":"+t)}return this.getName=function(){return t},this.getName()},getValue:function(){return this.$.value},getFirst:function(t){var e=this.$.firstChild;return(e=e&&new CKEDITOR.dom.node(e))&&t&&!t(e)&&(e=e.getNext(t)),e},getLast:function(t){var e=this.$.lastChild;return(e=e&&new CKEDITOR.dom.node(e))&&t&&!t(e)&&(e=e.getPrevious(t)),e},getStyle:function(t){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(t)]},is:function(){var t=this.getName();if("object"==typeof arguments[0])return!!arguments[0][t];for(var e=0;e<arguments.length;e++)if(arguments[e]==t)return!0;return!1},isEditable:function(t){var e=this.getName();return!(this.isReadOnly()||"none"==this.getComputedStyle("display")||"hidden"==this.getComputedStyle("visibility")||CKEDITOR.dtd.$nonEditable[e]||CKEDITOR.dtd.$empty[e]||this.is("a")&&(this.data("cke-saved-name")||this.hasAttribute("name"))&&!this.getChildCount())&&(!1===t||!(!(t=CKEDITOR.dtd[e]||CKEDITOR.dtd.span)||!t["#"]))},isIdentical:function(t){var e=this.clone(0,1);if(t=t.clone(0,1),e.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),t.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),e.$.isEqualNode)return e.$.style.cssText=CKEDITOR.tools.normalizeCssText(e.$.style.cssText),t.$.style.cssText=CKEDITOR.tools.normalizeCssText(t.$.style.cssText),e.$.isEqualNode(t.$);if(e=e.getOuterHtml(),t=t.getOuterHtml(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&this.is("a")){var n=this.getParent();n.type==CKEDITOR.NODE_ELEMENT&&((n=n.clone()).setHtml(e),e=n.getHtml(),n.setHtml(t),t=n.getHtml())}return e==t},isVisible:function(){var t,e,n=(this.$.offsetHeight||this.$.offsetWidth)&&"hidden"!=this.getComputedStyle("visibility");return n&&CKEDITOR.env.webkit&&(!(t=this.getWindow()).equals(CKEDITOR.document.getWindow())&&(e=t.$.frameElement)&&(n=new CKEDITOR.dom.element(e).isVisible())),!!n},isEmptyInlineRemoveable:function(){if(!CKEDITOR.dtd.$removeEmpty[this.getName()])return!1;for(var t=this.getChildren(),e=0,n=t.count();e<n;e++){var i=t.getItem(e);if((i.type!=CKEDITOR.NODE_ELEMENT||!i.data("cke-bookmark"))&&(i.type==CKEDITOR.NODE_ELEMENT&&!i.isEmptyInlineRemoveable()||i.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(i.getText())))return!1}return!0},hasAttributes:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(){for(var t=this.$.attributes,e=0;e<t.length;e++){var n=t[e];switch(n.nodeName){case"class":if(this.getAttribute("class"))return!0;case"data-cke-expando":continue;default:if(n.specified)return!0}}return!1}:function(){var t=this.$.attributes,e=t.length,n={"data-cke-expando":1,_moz_dirty:1};return 0<e&&(2<e||!n[t[0].nodeName]||2==e&&!n[t[1].nodeName])},hasAttribute:function(){function t(t){var e=this.$.attributes.getNamedItem(t);if("input"==this.getName())switch(t){case"class":return 0<this.$.className.length;case"checked":return!!this.$.checked;case"value":return"checkbox"==(t=this.getAttribute("type"))||"radio"==t?"on"!=this.$.value:!!this.$.value}return!!e&&e.specified}return CKEDITOR.env.ie?8>CKEDITOR.env.version?function(e){return"name"==e?!!this.$.name:t.call(this,e)}:t:function(t){return!!this.$.attributes.getNamedItem(t)}}(),hide:function(){this.setStyle("display","none")},moveChildren:function(t,e){var n,i=this.$;if(i!=(t=t.$))if(e)for(;n=i.lastChild;)t.insertBefore(i.removeChild(n),t.firstChild);else for(;n=i.firstChild;)t.appendChild(i.removeChild(n))},mergeSiblings:function(){function t(t,e,n){if(e&&e.type==CKEDITOR.NODE_ELEMENT){for(var i=[];e.data("cke-bookmark")||e.isEmptyInlineRemoveable();)if(i.push(e),!(e=n?e.getNext():e.getPrevious())||e.type!=CKEDITOR.NODE_ELEMENT)return;if(t.isIdentical(e)){for(var r=n?t.getLast():t.getFirst();i.length;)i.shift().move(t,!n);e.moveChildren(t,!n),e.remove(),r&&r.type==CKEDITOR.NODE_ELEMENT&&r.mergeSiblings()}}}return function(e){(!1===e||CKEDITOR.dtd.$removeEmpty[this.getName()]||this.is("a"))&&(t(this,this.getNext(),!0),t(this,this.getPrevious()))}}(),show:function(){this.setStyles({display:"",visibility:""})},setAttribute:function(){var t=function(t,e){return this.$.setAttribute(t,e),this};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(e,n){return"class"==e?this.$.className=n:"style"==e?this.$.style.cssText=n:"tabindex"==e?this.$.tabIndex=n:"checked"==e?this.$.checked=n:"contenteditable"==e?t.call(this,"contentEditable",n):t.apply(this,arguments),this}:CKEDITOR.env.ie8Compat&&CKEDITOR.env.secure?function(e,n){if("src"==e&&n.match(/^http:\/\//))try{t.apply(this,arguments)}catch(i){}else t.apply(this,arguments);return this}:t}(),setAttributes:function(t){for(var e in t)this.setAttribute(e,t[e]);return this},setValue:function(t){return this.$.value=t,this},removeAttribute:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(t){"class"==t?t="className":"tabindex"==t?t="tabIndex":"contenteditable"==t&&(t="contentEditable"),this.$.removeAttribute(t)}:function(t){this.$.removeAttribute(t)},removeAttributes:function(t){if(CKEDITOR.tools.isArray(t))for(var e=0;e<t.length;e++)this.removeAttribute(t[e]);else for(e in t=t||this.getAttributes())t.hasOwnProperty(e)&&this.removeAttribute(e)},removeStyle:function(t){if((i=this.$.style).removeProperty||"border"!=t&&"margin"!=t&&"padding"!=t)i.removeProperty?i.removeProperty(t):i.removeAttribute(CKEDITOR.tools.cssStyleToDomStyle(t)),this.$.style.cssText||this.removeAttribute("style");else{var e,n=["top","left","right","bottom"];"border"==t&&(e=["color","style","width"]);for(var i=[],r=0;r<n.length;r++)if(e)for(var o=0;o<e.length;o++)i.push([t,n[r],e[o]].join("-"));else i.push([t,n[r]].join("-"));for(t=0;t<i.length;t++)this.removeStyle(i[t])}},setStyle:function(t,e){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(t)]=e,this},setStyles:function(t){for(var e in t)this.setStyle(e,t[e]);return this},setOpacity:function(t){CKEDITOR.env.ie&&9>CKEDITOR.env.version?(t=Math.round(100*t),this.setStyle("filter",100<=t?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+t+")")):this.setStyle("opacity",t)},unselectable:function(){if(this.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","none")),CKEDITOR.env.ie){this.setAttribute("unselectable","on");for(var t=this.getElementsByTag("*"),e=0,n=t.count();e<n;e++)t.getItem(e).setAttribute("unselectable","on")}},getPositionedAncestor:function(){for(var t=this;"html"!=t.getName();){if("static"!=t.getComputedStyle("position"))return t;t=t.getParent()}return null},getDocumentPosition:function(t){var e=0,n=0,i=this.getDocument(),r=i.getBody(),o="BackCompat"==i.$.compatMode;if(!document.documentElement.getBoundingClientRect||CKEDITOR.env.ie&&8===CKEDITOR.env.version)for(l=this,c=null;l&&"body"!=l.getName()&&"html"!=l.getName();){for(e+=l.$.offsetLeft-l.$.scrollLeft,n+=l.$.offsetTop-l.$.scrollTop,l.equals(this)||(e+=l.$.clientLeft||0,n+=l.$.clientTop||0);c&&!c.equals(l);)e-=c.$.scrollLeft,n-=c.$.scrollTop,c=c.getParent();c=l,l=(s=l.$.offsetParent)?new CKEDITOR.dom.element(s):null}else{var s=this.$.getBoundingClientRect(),a=i.$.documentElement,l=a.clientTop||r.$.clientTop||0,c=a.clientLeft||r.$.clientLeft||0,u=!0;CKEDITOR.env.ie&&(u=i.getDocumentElement().contains(this),i=i.getBody().contains(this),u=o&&i||!o&&u),u&&(CKEDITOR.env.webkit||CKEDITOR.env.ie&&12<=CKEDITOR.env.version?(e=r.$.scrollLeft||a.scrollLeft,n=r.$.scrollTop||a.scrollTop):(e=(n=o?r.$:a).scrollLeft,n=n.scrollTop),e=s.left+e-c,n=s.top+n-l)}return t&&(s=this.getWindow(),l=t.getWindow(),!s.equals(l)&&s.$.frameElement&&(e+=(t=new CKEDITOR.dom.element(s.$.frameElement).getDocumentPosition(t)).x,n+=t.y)),document.documentElement.getBoundingClientRect||!CKEDITOR.env.gecko||o||(e+=this.$.clientLeft?1:0,n+=this.$.clientTop?1:0),{x:e,y:n}},scrollIntoView:function(e){var n=this.getParent();if(n)do{if((n.$.clientWidth&&n.$.clientWidth<n.$.scrollWidth||n.$.clientHeight&&n.$.clientHeight<n.$.scrollHeight)&&!n.is("body")&&this.scrollIntoParent(n,e,1),n.is("html")){var i=n.getWindow();try{var r=i.$.frameElement;r&&(n=new CKEDITOR.dom.element(r))}catch(t){}}}while(n=n.getParent())},scrollIntoParent:function(t,e,n){var i,r,o,s;function a(e,n){/body|html/.test(t.getName())?t.getWindow().$.scrollBy(e,n):(t.$.scrollLeft+=e,t.$.scrollTop+=n)}function l(t,e){var n={x:0,y:0};if(!t.is(u?"body":"html")){var i=t.$.getBoundingClientRect();n.x=i.left,n.y=i.top}return(i=t.getWindow()).equals(e)||(i=l(CKEDITOR.dom.element.get(i.$.frameElement),e),n.x+=i.x,n.y+=i.y),n}function c(t,e){return parseInt(t.getComputedStyle("margin-"+e)||0,10)||0}!t&&(t=this.getWindow());var u="BackCompat"==(o=t.getDocument()).$.compatMode;t instanceof CKEDITOR.dom.window&&(t=u?o.getBody():o.getDocumentElement()),CKEDITOR.env.webkit&&(o=this.getEditor(!1))&&(o._.previousScrollTop=null),r=l(this,o=t.getWindow());var h=l(t,o),d=this.$.offsetHeight;i=this.$.offsetWidth;var f=t.$.clientHeight,p=t.$.clientWidth;o=r.x-c(this,"left")-h.x||0,s=r.y-c(this,"top")-h.y||0,i=r.x+i+c(this,"right")-(h.x+p)||0,r=r.y+d+c(this,"bottom")-(h.y+f)||0,(0>s||0<r)&&a(0,!0===e?s:!1===e?r:0>s?s:r),n&&(0>o||0<i)&&a(0>o?o:i,0)},setState:function(t,e,n){switch(e=e||"cke",t){case CKEDITOR.TRISTATE_ON:this.addClass(e+"_on"),this.removeClass(e+"_off"),this.removeClass(e+"_disabled"),n&&this.setAttribute("aria-pressed",!0),n&&this.removeAttribute("aria-disabled");break;case CKEDITOR.TRISTATE_DISABLED:this.addClass(e+"_disabled"),this.removeClass(e+"_off"),this.removeClass(e+"_on"),n&&this.setAttribute("aria-disabled",!0),n&&this.removeAttribute("aria-pressed");break;default:this.addClass(e+"_off"),this.removeClass(e+"_on"),this.removeClass(e+"_disabled"),n&&this.removeAttribute("aria-pressed"),n&&this.removeAttribute("aria-disabled")}},getFrameDocument:function(){var t=this.$;try{t.contentWindow.document}catch(e){t.src=t.src}return t&&new CKEDITOR.dom.document(t.contentWindow.document)},copyAttributes:function(t,e){var n=this.$.attributes;e=e||{};for(var i=0;i<n.length;i++){var r,o=n[i],s=o.nodeName.toLowerCase();s in e||("checked"==s&&(r=this.getAttribute(s))?t.setAttribute(s,r):CKEDITOR.env.ie&&!this.hasAttribute(s)||(null===(r=this.getAttribute(s))&&(r=o.nodeValue),t.setAttribute(s,r)))}""!==this.$.style.cssText&&(t.$.style.cssText=this.$.style.cssText)},renameNode:function(t){if(this.getName()!=t){var e=this.getDocument();t=new CKEDITOR.dom.element(t,e),this.copyAttributes(t),this.moveChildren(t),this.getParent(!0)&&this.$.parentNode.replaceChild(t.$,this.$),t.$["data-cke-expando"]=this.$["data-cke-expando"],this.$=t.$,delete this.getName}},getChild:function(){function t(t,e){var n=t.childNodes;if(0<=e&&e<n.length)return n[e]}return function(e){var n=this.$;if(e.slice)for(e=e.slice();0<e.length&&n;)n=t(n,e.shift());else n=t(n,e);return n?new CKEDITOR.dom.node(n):null}}(),getChildCount:function(){return this.$.childNodes.length},disableContextMenu:function(){function t(t){return t.type==CKEDITOR.NODE_ELEMENT&&t.hasClass("cke_enable_context_menu")}this.on("contextmenu",function(e){e.data.getTarget().getAscendant(t,!0)||e.data.preventDefault()})},getDirection:function(t){return t?this.getComputedStyle("direction")||this.getDirection()||this.getParent()&&this.getParent().getDirection(1)||this.getDocument().$.dir||"ltr":this.getStyle("direction")||this.getAttribute("dir")},data:function(t,e){return t="data-"+t,void 0===e?this.getAttribute(t):(!1===e?this.removeAttribute(t):this.setAttribute(t,e),null)},getEditor:function(t){var e,n,i,r=CKEDITOR.instances;for(e in t=t||void 0===t,r)if((n=r[e]).element.equals(this)&&n.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO||!t&&(i=n.editable())&&(i.equals(this)||i.contains(this)))return n;return null},find:function(t){var i=e(this);return t=new CKEDITOR.dom.nodeList(this.$.querySelectorAll(n(this,t))),i(),t},findOne:function(t){var i=e(this);return t=this.$.querySelector(n(this,t)),i(),t?new CKEDITOR.dom.element(t):null},forEach:function(t,e,n){if(!(n||e&&this.type!=e))var i=t(this);if(!1!==i){n=this.getChildren();for(var r=0;r<n.count();r++)(i=n.getItem(r)).type==CKEDITOR.NODE_ELEMENT?i.forEach(t,e):e&&i.type!=e||t(i)}},fireEventHandler:function(t,e){var n="on"+t,i=this.$;if(CKEDITOR.env.ie&&9>CKEDITOR.env.version){var r,o=i.ownerDocument.createEventObject();for(r in e)o[r]=e[r];i.fireEvent(n,o)}else i[i[t]?t:n](e)},isDetached:function(){var t=this.getDocument(),e=t.getDocumentElement();return!e.equals(this)&&!e.contains(this)||(!CKEDITOR.env.ie||8<CKEDITOR.env.version&&!CKEDITOR.env.quirks)&&!t.$.defaultView}});var s={width:["border-left-width","border-right-width","padding-left","padding-right"],height:["border-top-width","border-bottom-width","padding-top","padding-bottom"]};CKEDITOR.dom.element.prototype.setSize=function(t,e,n){"number"==typeof e&&(!n||CKEDITOR.env.ie&&CKEDITOR.env.quirks||(e-=i.call(this,t)),this.setStyle(t,e+"px"))},CKEDITOR.dom.element.prototype.getSize=function(t,e){var n=Math.max(this.$["offset"+CKEDITOR.tools.capitalize(t)],this.$["client"+CKEDITOR.tools.capitalize(t)])||0;return e&&(n-=i.call(this,t)),n}}(),CKEDITOR.dom.documentFragment=function(t){t=t||CKEDITOR.document,this.$=t.type==CKEDITOR.NODE_DOCUMENT?t.$.createDocumentFragment():t},CKEDITOR.tools.extend(CKEDITOR.dom.documentFragment.prototype,CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,insertAfterNode:function(t){(t=t.$).parentNode.insertBefore(this.$,t.nextSibling)},getHtml:function(){var t=new CKEDITOR.dom.element("div");return this.clone(1,1).appendTo(t),t.getHtml().replace(/\s*data-cke-expando=".*?"/g,"")}},!0,{append:1,appendBogus:1,clone:1,getFirst:1,getHtml:1,getLast:1,getParent:1,getNext:1,getPrevious:1,appendTo:1,moveChildren:1,insertBefore:1,insertAfterNode:1,replace:1,trim:1,type:1,ltrim:1,rtrim:1,getDocument:1,getChildCount:1,getChild:1,getChildren:1}),CKEDITOR.tools.extend(CKEDITOR.dom.documentFragment.prototype,CKEDITOR.dom.document.prototype,!0,{find:1,findOne:1}),function(){function t(t,e){var n=this.range;if(this._.end)return null;if(!this._.start){if(this._.start=1,n.collapsed)return this.end(),null;n.optimize()}var i,r=n.startContainer;i=n.endContainer;var o,s=n.startOffset,a=n.endOffset,l=this.guard,c=this.type,u=t?"getPreviousSourceNode":"getNextSourceNode";if(!t&&!this._.guardLTR){var h=i.type==CKEDITOR.NODE_ELEMENT?i:i.getParent(),d=i.type==CKEDITOR.NODE_ELEMENT?i.getChild(a):i.getNext();this._.guardLTR=function(t,e){return!(e&&h.equals(t)||d&&t.equals(d)||t.type==CKEDITOR.NODE_ELEMENT&&e&&t.equals(n.root))}}if(t&&!this._.guardRTL){var f=r.type==CKEDITOR.NODE_ELEMENT?r:r.getParent(),p=r.type==CKEDITOR.NODE_ELEMENT?s?r.getChild(s-1):null:r.getPrevious();this._.guardRTL=function(t,e){return!(e&&f.equals(t)||p&&t.equals(p)||t.type==CKEDITOR.NODE_ELEMENT&&e&&t.equals(n.root))}}var g=t?this._.guardRTL:this._.guardLTR;for(o=l?function(t,e){return!1!==g(t,e)&&l(t,e)}:g,this.current?i=this.current[u](!1,c,o):(t?i.type==CKEDITOR.NODE_ELEMENT&&(i=0<a?i.getChild(a-1):!1===o(i,!0)?null:i.getPreviousSourceNode(!0,c,o)):(i=r).type==CKEDITOR.NODE_ELEMENT&&((i=i.getChild(s))||(i=!1===o(r,!0)?null:r.getNextSourceNode(!0,c,o))),i&&!1===o(i)&&(i=null));i&&!this._.end;){if(this.current=i,this.evaluator&&!1===this.evaluator(i)){if(e&&this.evaluator)return!1}else if(!e)return i;i=i[u](!1,c,o)}return this.end(),this.current=null}function e(e){for(var n,i=null;n=t.call(this,e);)i=n;return i}CKEDITOR.dom.walker=CKEDITOR.tools.createClass({$:function(t){this.range=t,this._={}},proto:{end:function(){this._.end=1},next:function(){return t.call(this)},previous:function(){return t.call(this,1)},checkForward:function(){return!1!==t.call(this,0,1)},checkBackward:function(){return!1!==t.call(this,1,1)},lastForward:function(){return e.call(this)},lastBackward:function(){return e.call(this,1)},reset:function(){delete this.current,this._={}}}});var n={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},i={absolute:1,fixed:1};CKEDITOR.dom.element.prototype.isBlockBoundary=function(t){return!("none"!=this.getComputedStyle("float")||this.getComputedStyle("position")in i||!n[this.getComputedStyle("display")])||!!(this.is(CKEDITOR.dtd.$block)||t&&this.is(t))},CKEDITOR.dom.walker.blockBoundary=function(t){return function(e){return!(e.type==CKEDITOR.NODE_ELEMENT&&e.isBlockBoundary(t))}},CKEDITOR.dom.walker.listItemBoundary=function(){return this.blockBoundary({br:1})},CKEDITOR.dom.walker.bookmark=function(t,e){function n(t){return t&&t.getName&&"span"==t.getName()&&t.data("cke-bookmark")}return function(i){var r,o;return r=i&&i.type!=CKEDITOR.NODE_ELEMENT&&(o=i.getParent())&&n(o),r=t?r:r||n(i),!!(e^r)}},CKEDITOR.dom.walker.whitespaces=function(t){return function(e){var n;return e&&e.type==CKEDITOR.NODE_TEXT&&(n=!CKEDITOR.tools.trim(e.getText())||CKEDITOR.env.webkit&&e.getText()==CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE),!!(t^n)}},CKEDITOR.dom.walker.invisible=function(t){var e=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.env.webkit?1:0;return function(i){return e(i)?i=1:(i.type==CKEDITOR.NODE_TEXT&&(i=i.getParent()),i=i.$.offsetWidth<=n),!!(t^i)}},CKEDITOR.dom.walker.nodeType=function(t,e){return function(n){return!!(e^n.type==t)}},CKEDITOR.dom.walker.bogus=function(t){function e(t){return!o(t)&&!s(t)}return function(n){var i=CKEDITOR.env.needsBrFiller?n.is&&n.is("br"):n.getText&&r.test(n.getText());return i&&(i=n.getParent(),n=n.getNext(e),i=i.isBlockBoundary()&&(!n||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary())),!!(t^i)}},CKEDITOR.dom.walker.temp=function(t){return function(e){return e.type!=CKEDITOR.NODE_ELEMENT&&(e=e.getParent()),e=e&&e.hasAttribute("data-cke-temp"),!!(t^e)}};var r=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,o=CKEDITOR.dom.walker.whitespaces(),s=CKEDITOR.dom.walker.bookmark(),a=CKEDITOR.dom.walker.temp(),l=function(t){return s(t)||o(t)||t.type==CKEDITOR.NODE_ELEMENT&&t.is(CKEDITOR.dtd.$inline)&&!t.is(CKEDITOR.dtd.$empty)};CKEDITOR.dom.walker.ignored=function(t){return function(e){return e=o(e)||s(e)||a(e),!!(t^e)}};var c=CKEDITOR.dom.walker.ignored();CKEDITOR.dom.walker.empty=function(t){return function(e){for(var n=0,i=e.getChildCount();n<i;++n)if(!c(e.getChild(n)))return!!t;return!t}};var u=CKEDITOR.dom.walker.empty(),h=CKEDITOR.dom.walker.validEmptyBlockContainers=CKEDITOR.tools.extend(function(t){var e,n={};for(e in t)CKEDITOR.dtd[e]["#"]&&(n[e]=1);return n}(CKEDITOR.dtd.$block),{caption:1,td:1,th:1});CKEDITOR.dom.walker.editable=function(t){return function(e){return e=!c(e)&&!!(e.type==CKEDITOR.NODE_TEXT||e.type==CKEDITOR.NODE_ELEMENT&&(e.is(CKEDITOR.dtd.$inline)||e.is("hr")||"false"==e.getAttribute("contenteditable")||!CKEDITOR.env.needsBrFiller&&e.is(h)&&u(e))),!!(t^e)}},CKEDITOR.dom.element.prototype.getBogus=function(){var t=this;do{t=t.getPreviousSourceNode()}while(l(t));return!(!t||!(CKEDITOR.env.needsBrFiller?t.is&&t.is("br"):t.getText&&r.test(t.getText())))&&t}}(),CKEDITOR.dom.range=function(t){this.endOffset=this.endContainer=this.startOffset=this.startContainer=null,this.collapsed=!0;var e=t instanceof CKEDITOR.dom.document;this.document=e?t:t.getDocument(),this.root=e?t.getBody():t},function(){function t(t){t.collapsed=t.startContainer&&t.endContainer&&t.startContainer.equals(t.endContainer)&&t.startOffset==t.endOffset}function e(t,e,n,i,r){function o(t,e,n,i){var o=n?t.getPrevious():t.getNext();return i&&s||(l||i?e.append(t.clone(!0,r),n):(t.remove(),a&&e.append(t,n))),o}t.optimizeBookmark();var s=0===e,a=1==e,l=2==e;e=l||a;var c,u,h,d,f,p,g=t.startContainer,m=t.endContainer,v=t.startOffset,y=t.endOffset;if(l&&m.type==CKEDITOR.NODE_TEXT&&(g.equals(m)||g.type===CKEDITOR.NODE_ELEMENT&&g.getFirst().equals(m)))n.append(t.document.createText(m.substring(v,y)));else{m.type==CKEDITOR.NODE_TEXT?l?p=!0:m=m.split(y):0<m.getChildCount()?y>=m.getChildCount()?(m=m.getChild(y-1),u=!0):m=m.getChild(y):d=u=!0,g.type==CKEDITOR.NODE_TEXT?l?f=!0:g.split(v):0<g.getChildCount()?0===v?(g=g.getChild(v),c=!0):g=g.getChild(v-1):h=c=!0;for(var b,C,I,E=g.getParents(),T=m.getParents(),w=function(){var t,e,n,i=Math.min(E.length,T.length);for(t=0;t<i;t++)if(e=E[t],n=T[t],!e.equals(n))return t;return t-1}(),x=E.length-1,_=T.length-1,D=n,A=-1,O=w;O<=x;O++){for(I=(C=E[O]).getNext(),O!=x||C.equals(T[O])&&x<_?e&&(b=D.append(C.clone(0,r))):c?o(C,D,!1,h):f&&D.append(t.document.createText(C.substring(v)));I;){if(I.equals(T[O])){A=O;break}I=o(I,D)}D=b}for(D=n,O=w;O<=_;O++)if(I=(n=T[O]).getPrevious(),n.equals(E[O]))e&&(D=D.getChild(0));else{if(O!=_||n.equals(E[O])&&_<x?e&&(b=D.append(n.clone(0,r))):u?o(n,D,!1,d):p&&D.append(t.document.createText(n.substring(0,y))),O>A)for(;I;)I=o(I,D,!0);D=b}l||function(){var e=w-1,n=h&&d&&!g.equals(m);e<x-1||e<_-1||n?(n?t.moveToPosition(m,CKEDITOR.POSITION_BEFORE_START):_==e+1&&u?t.moveToPosition(T[e],CKEDITOR.POSITION_BEFORE_END):t.moveToPosition(T[e+1],CKEDITOR.POSITION_BEFORE_START),i&&(e=E[e+1])&&e.type==CKEDITOR.NODE_ELEMENT&&((n=CKEDITOR.dom.element.createFromHtml('<span data-cke-bookmark="1" style="display:none">&nbsp;</span>',t.document)).insertAfter(e),e.mergeSiblings(!1),t.moveToBookmark({startNode:n}))):t.collapse(!0)}()}}function n(){var t=!1,e=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!0),i=CKEDITOR.dom.walker.bogus();return function(o){return!(!n(o)&&!e(o))||(i(o)&&!t?t=!0:!(o.type==CKEDITOR.NODE_TEXT&&(o.hasAscendant("pre")||CKEDITOR.tools.trim(o.getText()).length)||o.type==CKEDITOR.NODE_ELEMENT&&!o.is(r)))}}function i(t){return function(){var e;return this[t?"getPreviousNode":"getNextNode"](function(t){return!e&&l(t)&&(e=t),a(t)&&!(o(t)&&t.equals(e))})}}var r={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1},o=CKEDITOR.dom.walker.bogus(),s=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,a=CKEDITOR.dom.walker.editable(),l=CKEDITOR.dom.walker.ignored(!0);CKEDITOR.dom.range.prototype={clone:function(){var t=new CKEDITOR.dom.range(this.root);return t._setStartContainer(this.startContainer),t.startOffset=this.startOffset,t._setEndContainer(this.endContainer),t.endOffset=this.endOffset,t.collapsed=this.collapsed,t},collapse:function(t){t?(this._setEndContainer(this.startContainer),this.endOffset=this.startOffset):(this._setStartContainer(this.endContainer),this.startOffset=this.endOffset),this.collapsed=!0},cloneContents:function(t){var n=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||e(this,2,n,!1,void 0===t||t),n},deleteContents:function(t){this.collapsed||e(this,0,null,t)},extractContents:function(t,n){var i=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||e(this,1,i,t,void 0===n||n),i},equals:function(t){return this.startOffset===t.startOffset&&this.endOffset===t.endOffset&&this.startContainer.equals(t.startContainer)&&this.endContainer.equals(t.endContainer)},createBookmark:function(t){function e(t){return t.getAscendant(function(t){var e;return(e=t.data&&t.data("cke-temp"))&&(e=-1===CKEDITOR.tools.array.indexOf(["cke_copybin","cke_pastebin"],t.getAttribute("id"))),e},!0)}var n,i,r,o,s=this.startContainer,a=this.endContainer,l=this.collapsed;return(n=this.document.createElement("span")).data("cke-bookmark",1),n.setStyle("display","none"),n.setHtml("&nbsp;"),t&&(r="cke_bm_"+CKEDITOR.tools.getNextNumber(),n.setAttribute("id",r+(l?"C":"S"))),l||((i=n.clone()).setHtml("&nbsp;"),t&&i.setAttribute("id",r+"E"),o=this.clone(),e(a)&&(a=e(a),o.moveToPosition(a,CKEDITOR.POSITION_AFTER_END)),o.collapse(),o.insertNode(i)),o=this.clone(),e(s)&&(a=e(s),o.moveToPosition(a,CKEDITOR.POSITION_BEFORE_START)),o.collapse(!0),o.insertNode(n),i?(this.setStartAfter(n),this.setEndBefore(i)):this.moveToPosition(n,CKEDITOR.POSITION_AFTER_END),{startNode:t?r+(l?"C":"S"):n,endNode:t?r+"E":i,serializable:t,collapsed:l}},createBookmark2:function(){function t(t){var e,i=t.container,r=t.offset,o=r;if((e=(e=i).type!=CKEDITOR.NODE_ELEMENT||0===o||o==e.getChildCount()?0:e.getChild(o-1).type==CKEDITOR.NODE_TEXT&&e.getChild(o).type==CKEDITOR.NODE_TEXT)&&(r=(i=i.getChild(r-1)).getLength()),i.type==CKEDITOR.NODE_ELEMENT&&0<r){t:{for(e=i;r--;)if(0<=(o=e.getChild(r).getIndex(!0))){r=o;break t}r=-1}r+=1}if(i.type==CKEDITOR.NODE_TEXT){for(e=i,o=0;(e=e.getPrevious())&&e.type==CKEDITOR.NODE_TEXT;)o+=e.getText().replace(CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE,"").length;e=o,i.isEmpty()?(o=i.getPrevious(n),e?(r=e,i=o?o.getNext():i.getParent().getFirst()):(i=i.getParent(),r=o?o.getIndex(!0)+1:0)):r+=e}t.container=i,t.offset=r}function e(t,e){var n=e.getCustomData("cke-fillingChar");if(n){var i=t.container;n.equals(i)&&(t.offset-=CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE.length,0>=t.offset&&(t.offset=i.getIndex(),t.container=i.getParent()))}}var n=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_TEXT,!0);return function(n){var i=this.collapsed,r={container:this.startContainer,offset:this.startOffset},o={container:this.endContainer,offset:this.endOffset};return n&&(t(r),e(r,this.root),i||(t(o),e(o,this.root))),{start:r.container.getAddress(n),end:i?null:o.container.getAddress(n),startOffset:r.offset,endOffset:o.offset,normalized:n,collapsed:i,is2:!0}}}(),moveToBookmark:function(t){if(t.is2){var e=this.document.getByAddress(t.start,t.normalized),n=t.startOffset,i=t.end&&this.document.getByAddress(t.end,t.normalized);t=t.endOffset,this.setStart(e,n),i?this.setEnd(i,t):this.collapse(!0)}else e=(n=t.serializable)?this.document.getById(t.startNode):t.startNode,t=n?this.document.getById(t.endNode):t.endNode,this.setStartBefore(e),e.remove(),t?(this.setEndBefore(t),t.remove()):this.collapse(!0)},getBoundaryNodes:function(){var t,e=this.startContainer,n=this.endContainer,i=this.startOffset,r=this.endOffset;if(e.type==CKEDITOR.NODE_ELEMENT)if((t=e.getChildCount())>i)e=e.getChild(i);else if(1>t)e=e.getPreviousSourceNode();else{for(e=e.$;e.lastChild;)e=e.lastChild;e=(e=new CKEDITOR.dom.node(e)).getNextSourceNode()||e}if(n.type==CKEDITOR.NODE_ELEMENT)if((t=n.getChildCount())>r)n=n.getChild(r).getPreviousSourceNode(!0);else if(1>t)n=n.getPreviousSourceNode();else{for(n=n.$;n.lastChild;)n=n.lastChild;n=new CKEDITOR.dom.node(n)}return e.getPosition(n)&CKEDITOR.POSITION_FOLLOWING&&(e=n),{startNode:e,endNode:n}},getCommonAncestor:function(t,e){var n=this.startContainer,i=this.endContainer;n=n.equals(i)?t&&n.type==CKEDITOR.NODE_ELEMENT&&this.startOffset==this.endOffset-1?n.getChild(this.startOffset):n:n.getCommonAncestor(i);return e&&!n.is?n.getParent():n},optimize:function(){var t=this.startContainer,e=this.startOffset;t.type!=CKEDITOR.NODE_ELEMENT&&(e?e>=t.getLength()&&this.setStartAfter(t):this.setStartBefore(t)),t=this.endContainer,e=this.endOffset,t.type!=CKEDITOR.NODE_ELEMENT&&(e?e>=t.getLength()&&this.setEndAfter(t):this.setEndBefore(t))},optimizeBookmark:function(){var t=this.startContainer,e=this.endContainer;t.is&&t.is("span")&&t.data("cke-bookmark")&&this.setStartAt(t,CKEDITOR.POSITION_BEFORE_START),e&&e.is&&e.is("span")&&e.data("cke-bookmark")&&this.setEndAt(e,CKEDITOR.POSITION_AFTER_END)},trim:function(t,e){var n=this.startContainer,i=this.startOffset,r=this.collapsed;if((!t||r)&&n&&n.type==CKEDITOR.NODE_TEXT){if(i)if(i>=n.getLength())i=n.getIndex()+1,n=n.getParent();else{var o=n.split(i);i=n.getIndex()+1,n=n.getParent();this.startContainer.equals(this.endContainer)?this.setEnd(o,this.endOffset-this.startOffset):n.equals(this.endContainer)&&(this.endOffset+=1)}else i=n.getIndex(),n=n.getParent();if(this.setStart(n,i),r)return void this.collapse(!0)}n=this.endContainer,i=this.endOffset,e||r||!n||n.type!=CKEDITOR.NODE_TEXT||(i?(i>=n.getLength()||n.split(i),i=n.getIndex()+1):i=n.getIndex(),n=n.getParent(),this.setEnd(n,i))},enlarge:function(t,e){function n(t){return t&&t.type==CKEDITOR.NODE_ELEMENT&&t.hasAttribute("contenteditable")?null:t}function i(t,e,n){var i=new CKEDITOR.dom.range(n);for(i.setStart(t,e),i.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),(n=new CKEDITOR.dom.walker(i)).guard=function(t){return!(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary())};i=n.next();){if(i.type!=CKEDITOR.NODE_TEXT)return!1;if(r=i!=t?i.getText():i.substring(e),s.test(r))return!1}return!0}var r,o,s=new RegExp(/[^\s\ufeff]/);switch(t){case CKEDITOR.ENLARGE_INLINE:var a=1;case CKEDITOR.ENLARGE_ELEMENT:if(this.collapsed)break;var l=this.getCommonAncestor();o=this.root;var c,u,h,d,f,p,g=!1;p=this.startContainer;var m=this.startOffset;for(p.type==CKEDITOR.NODE_TEXT?(m&&(g=!!(p=!CKEDITOR.tools.trim(p.substring(0,m)).length&&p)),p&&((d=p.getPrevious())||(h=p.getParent()))):(m&&(d=p.getChild(m-1)||p.getLast()),d||(h=p)),h=n(h);h||d;){if(h&&!d){if(!f&&h.equals(l)&&(f=!0),a?h.isBlockBoundary():!o.contains(h))break;g&&"inline"==h.getComputedStyle("display")||(g=!1,f?c=h:this.setStartBefore(h)),d=h.getPrevious()}for(;d;)if(p=!1,d.type==CKEDITOR.NODE_COMMENT)d=d.getPrevious();else{if(d.type==CKEDITOR.NODE_TEXT)r=d.getText(),s.test(r)&&(d=null),p=/[\s\ufeff]$/.test(r);else if((d.$.offsetWidth>(CKEDITOR.env.webkit?1:0)||e&&d.is("br"))&&!d.data("cke-bookmark"))if(g&&CKEDITOR.dtd.$removeEmpty[d.getName()]){if(r=d.getText(),s.test(r))d=null;else{m=d.$.getElementsByTagName("*");for(var v,y=0;v=m[y++];)if(!CKEDITOR.dtd.$removeEmpty[v.nodeName.toLowerCase()]){d=null;break}}d&&(p=!!r.length)}else d=null;if(p&&(g?f?c=h:h&&this.setStartBefore(h):g=!0),d){if(p=d.getPrevious(),!h&&!p){h=d,d=null;break}d=p}else h=null}h&&(h=n(h.getParent()))}for(p=this.endContainer,m=this.endOffset,h=d=null,f=g=!1,p.type==CKEDITOR.NODE_TEXT?CKEDITOR.tools.trim(p.substring(m)).length?g=!0:(g=!p.getLength(),m==p.getLength()?(d=p.getNext())||(h=p.getParent()):i(p,m,o)&&(h=p.getParent())):(d=p.getChild(m))||(h=p);h||d;){if(h&&!d){if(!f&&h.equals(l)&&(f=!0),a?h.isBlockBoundary():!o.contains(h))break;g&&"inline"==h.getComputedStyle("display")||(g=!1,f?u=h:h&&this.setEndAfter(h)),d=h.getNext()}for(;d;){if(p=!1,d.type==CKEDITOR.NODE_TEXT)r=d.getText(),i(d,0,o)||(d=null),p=/^[\s\ufeff]/.test(r);else if(d.type==CKEDITOR.NODE_ELEMENT){if((0<d.$.offsetWidth||e&&d.is("br"))&&!d.data("cke-bookmark"))if(g&&CKEDITOR.dtd.$removeEmpty[d.getName()]){if(r=d.getText(),s.test(r))d=null;else for(m=d.$.getElementsByTagName("*"),y=0;v=m[y++];)if(!CKEDITOR.dtd.$removeEmpty[v.nodeName.toLowerCase()]){d=null;break}d&&(p=!!r.length)}else d=null}else p=1;if(p&&g&&(f?u=h:this.setEndAfter(h)),d){if(p=d.getNext(),!h&&!p){h=d,d=null;break}d=p}else h=null}h&&(h=n(h.getParent()))}c&&u&&(l=c.contains(u)?u:c,this.setStartBefore(l),this.setEndAfter(l));break;case CKEDITOR.ENLARGE_BLOCK_CONTENTS:case CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:h=new CKEDITOR.dom.range(this.root),o=this.root,h.setStartAt(o,CKEDITOR.POSITION_AFTER_START),h.setEnd(this.startContainer,this.startOffset),h=new CKEDITOR.dom.walker(h);var b,C,I=CKEDITOR.dom.walker.blockBoundary(t==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?{br:1}:null),E=null,T=function(t){if(t.type==CKEDITOR.NODE_ELEMENT&&"false"==t.getAttribute("contenteditable"))if(E){if(E.equals(t))return void(E=null)}else E=t;else if(E)return;var e=I(t);return e||(b=t),e};a=function(t){var e=T(t);return!e&&t.is&&t.is("br")&&(C=t),e};if(h.guard=T,h=h.lastBackward(),b=b||o,this.setStartAt(b,!b.is("br")&&(!h&&this.checkStartOfBlock()||h&&b.contains(h))?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_AFTER_END),t==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS){h=this.clone(),h=new CKEDITOR.dom.walker(h);var w=CKEDITOR.dom.walker.whitespaces(),x=CKEDITOR.dom.walker.bookmark();if(h.evaluator=function(t){return!w(t)&&!x(t)},(h=h.previous())&&h.type==CKEDITOR.NODE_ELEMENT&&h.is("br"))break}(h=this.clone()).collapse(),h.setEndAt(o,CKEDITOR.POSITION_BEFORE_END),(h=new CKEDITOR.dom.walker(h)).guard=t==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?a:T,b=E=C=null,h=h.lastForward(),b=b||o,this.setEndAt(b,!h&&this.checkEndOfBlock()||h&&b.contains(h)?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_BEFORE_START),C&&this.setEndAfter(C)}},shrink:function(t,e,n){var i="boolean"==typeof n?n:!n||"boolean"!=typeof n.shrinkOnBlockBoundary||n.shrinkOnBlockBoundary,r=n&&n.skipBogus;if(!this.collapsed){t=t||CKEDITOR.SHRINK_TEXT;var o=this.clone(),s=this.startContainer,a=this.endContainer,l=this.startOffset,c=this.endOffset,u=n=1;s&&s.type==CKEDITOR.NODE_TEXT&&(l?l>=s.getLength()?o.setStartAfter(s):(o.setStartBefore(s),n=0):o.setStartBefore(s)),a&&a.type==CKEDITOR.NODE_TEXT&&(c?c>=a.getLength()?o.setEndAfter(a):(o.setEndAfter(a),u=0):o.setEndBefore(a));o=new CKEDITOR.dom.walker(o);var h,d=CKEDITOR.dom.walker.bookmark(),f=CKEDITOR.dom.walker.bogus();return o.evaluator=function(e){return e.type==(t==CKEDITOR.SHRINK_ELEMENT?CKEDITOR.NODE_ELEMENT:CKEDITOR.NODE_TEXT)},o.guard=function(e,n){return!!(r&&f(e)||d(e))||!(t==CKEDITOR.SHRINK_ELEMENT&&e.type==CKEDITOR.NODE_TEXT||n&&e.equals(h)||!1===i&&e.type==CKEDITOR.NODE_ELEMENT&&e.isBlockBoundary()||e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("contenteditable"))&&(n||e.type!=CKEDITOR.NODE_ELEMENT||(h=e),!0)},n&&(s=o[t==CKEDITOR.SHRINK_ELEMENT?"lastForward":"next"]())&&this.setStartAt(s,e?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_START),u&&(o.reset(),(o=o[t==CKEDITOR.SHRINK_ELEMENT?"lastBackward":"previous"]())&&this.setEndAt(o,e?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_END)),!(!n&&!u)}},insertNode:function(t){this.optimizeBookmark(),this.trim(!1,!0);var e=this.startContainer,n=e.getChild(this.startOffset);n?t.insertBefore(n):e.append(t),t.getParent()&&t.getParent().equals(this.endContainer)&&this.endOffset++,this.setStartBefore(t)},moveToPosition:function(t,e){this.setStartAt(t,e),this.collapse(!0)},moveToRange:function(t){this.setStart(t.startContainer,t.startOffset),this.setEnd(t.endContainer,t.endOffset)},selectNodeContents:function(t){this.setStart(t,0),this.setEnd(t,t.type==CKEDITOR.NODE_TEXT?t.getLength():t.getChildCount())},setStart:function(e,n){e.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[e.getName()]&&(n=e.getIndex(),e=e.getParent()),this._setStartContainer(e),this.startOffset=n,this.endContainer||(this._setEndContainer(e),this.endOffset=n),t(this)},setEnd:function(e,n){e.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[e.getName()]&&(n=e.getIndex()+1,e=e.getParent()),this._setEndContainer(e),this.endOffset=n,this.startContainer||(this._setStartContainer(e),this.startOffset=n),t(this)},setStartAfter:function(t){this.setStart(t.getParent(),t.getIndex()+1)},setStartBefore:function(t){this.setStart(t.getParent(),t.getIndex())},setEndAfter:function(t){this.setEnd(t.getParent(),t.getIndex()+1)},setEndBefore:function(t){this.setEnd(t.getParent(),t.getIndex())},setStartAt:function(e,n){switch(n){case CKEDITOR.POSITION_AFTER_START:this.setStart(e,0);break;case CKEDITOR.POSITION_BEFORE_END:e.type==CKEDITOR.NODE_TEXT?this.setStart(e,e.getLength()):this.setStart(e,e.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setStartBefore(e);break;case CKEDITOR.POSITION_AFTER_END:this.setStartAfter(e)}t(this)},setEndAt:function(e,n){switch(n){case CKEDITOR.POSITION_AFTER_START:this.setEnd(e,0);break;case CKEDITOR.POSITION_BEFORE_END:e.type==CKEDITOR.NODE_TEXT?this.setEnd(e,e.getLength()):this.setEnd(e,e.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setEndBefore(e);break;case CKEDITOR.POSITION_AFTER_END:this.setEndAfter(e)}t(this)},fixBlock:function(t,e){var n=this.createBookmark(),i=this.document.createElement(e);this.collapse(t),this.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),this.extractContents().appendTo(i),i.trim(),this.insertNode(i);var r=i.getBogus();return r&&r.remove(),i.appendBogus(),this.moveToBookmark(n),i},splitBlock:function(t,e){var n=new CKEDITOR.dom.elementPath(this.startContainer,this.root),i=new CKEDITOR.dom.elementPath(this.endContainer,this.root),r=n.block,o=i.block,s=null;return n.blockLimit.equals(i.blockLimit)?("br"!=t&&(r||(r=this.fixBlock(!0,t),o=new CKEDITOR.dom.elementPath(this.endContainer,this.root).block),o||(o=this.fixBlock(!1,t))),n=r&&this.checkStartOfBlock(),i=o&&this.checkEndOfBlock(),this.deleteContents(),r&&r.equals(o)&&(i?(s=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(o,CKEDITOR.POSITION_AFTER_END),o=null):n?(s=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(r,CKEDITOR.POSITION_BEFORE_START),r=null):(o=this.splitElement(r,e||!1),r.is("ul","ol")||r.appendBogus())),{previousBlock:r,nextBlock:o,wasStartOfBlock:n,wasEndOfBlock:i,elementPath:s}):null},splitElement:function(t,e){if(!this.collapsed)return null;this.setEndAt(t,CKEDITOR.POSITION_BEFORE_END);var n=this.extractContents(!1,e||!1),i=t.clone(!1,e||!1);return n.appendTo(i),i.insertAfter(t),this.moveToPosition(t,CKEDITOR.POSITION_AFTER_END),i},removeEmptyBlocksAtEnd:function(){function t(t){return function(i){return!(e(i)||n(i)||i.type==CKEDITOR.NODE_ELEMENT&&i.isEmptyInlineRemoveable()||t.is("table")&&i.is("caption"))}}var e=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!1);return function(e){for(var n,i=this.createBookmark(),r=this[e?"endPath":"startPath"](),o=r.block||r.blockLimit;o&&!o.equals(r.root)&&!o.getFirst(t(o));)n=o.getParent(),this[e?"setEndAt":"setStartAt"](o,CKEDITOR.POSITION_AFTER_END),o.remove(1),o=n;this.moveToBookmark(i)}}(),startPath:function(){return new CKEDITOR.dom.elementPath(this.startContainer,this.root)},endPath:function(){return new CKEDITOR.dom.elementPath(this.endContainer,this.root)},checkBoundaryOfElement:function(t,e){var n=e==CKEDITOR.START,i=this.clone();return i.collapse(n),i[n?"setStartAt":"setEndAt"](t,n?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END),(i=new CKEDITOR.dom.walker(i)).evaluator=function(t){var e=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(1);return function(i){return!(!n(i)&&!e(i))||!t&&o(i)||i.type==CKEDITOR.NODE_ELEMENT&&i.is(CKEDITOR.dtd.$removeEmpty)}}(n),i[n?"checkBackward":"checkForward"]()},checkStartOfBlock:function(t){var e=this.startContainer,i=this.startOffset;return CKEDITOR.env.ie&&i&&e.type==CKEDITOR.NODE_TEXT&&(e=CKEDITOR.tools.ltrim(e.substring(0,i)),s.test(e)&&this.trim(0,1)),t||this.trim(),t=new CKEDITOR.dom.elementPath(this.startContainer,this.root),(e=this.clone()).collapse(!0),e.setStartAt(t.block||t.blockLimit,CKEDITOR.POSITION_AFTER_START),(t=new CKEDITOR.dom.walker(e)).evaluator=n(),t.checkBackward()},checkEndOfBlock:function(t){var e=this.endContainer,i=this.endOffset;return CKEDITOR.env.ie&&e.type==CKEDITOR.NODE_TEXT&&(e=CKEDITOR.tools.rtrim(e.substring(i)),s.test(e)&&this.trim(1,0)),t||this.trim(),t=new CKEDITOR.dom.elementPath(this.endContainer,this.root),(e=this.clone()).collapse(!1),e.setEndAt(t.block||t.blockLimit,CKEDITOR.POSITION_BEFORE_END),(t=new CKEDITOR.dom.walker(e)).evaluator=n(),t.checkForward()},getPreviousNode:function(t,e,n){var i=this.clone();return i.collapse(1),i.setStartAt(n||this.root,CKEDITOR.POSITION_AFTER_START),(n=new CKEDITOR.dom.walker(i)).evaluator=t,n.guard=e,n.previous()},getNextNode:function(t,e,n){var i=this.clone();return i.collapse(),i.setEndAt(n||this.root,CKEDITOR.POSITION_BEFORE_END),(n=new CKEDITOR.dom.walker(i)).evaluator=t,n.guard=e,n.next()},checkReadOnly:function(){function t(t,e){for(;t;){if(t.type==CKEDITOR.NODE_ELEMENT){if("false"==t.getAttribute("contentEditable")&&!t.data("cke-editable"))return 0;if(t.is("html")||"true"==t.getAttribute("contentEditable")&&(t.contains(e)||t.equals(e)))break}t=t.getParent()}return 1}return function(){var e=this.startContainer,n=this.endContainer;return!(t(e,n)&&t(n,e))}}(),moveToElementEditablePosition:function(t,e){if(t.type==CKEDITOR.NODE_ELEMENT&&!t.isEditable(!1))return this.moveToPosition(t,e?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),!0;for(var n=0;t;){if(t.type==CKEDITOR.NODE_TEXT){e&&this.endContainer&&this.checkEndOfBlock()&&s.test(t.getText())?this.moveToPosition(t,CKEDITOR.POSITION_BEFORE_START):this.moveToPosition(t,e?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),n=1;break}if(t.type==CKEDITOR.NODE_ELEMENT)if(t.isEditable())this.moveToPosition(t,e?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_START),n=1;else if(e&&t.is("br")&&this.endContainer&&this.checkEndOfBlock())this.moveToPosition(t,CKEDITOR.POSITION_BEFORE_START);else if("false"==t.getAttribute("contenteditable")&&t.is(CKEDITOR.dtd.$block))return this.setStartBefore(t),this.setEndAfter(t),!0;var i=t,r=n,o=void 0;i.type==CKEDITOR.NODE_ELEMENT&&i.isEditable(!1)&&(o=i[e?"getLast":"getFirst"](l)),r||o||(o=i[e?"getPrevious":"getNext"](l)),t=o}return!!n},moveToClosestEditablePosition:function(t,e){var n,i,r,o=0,s=[CKEDITOR.POSITION_AFTER_END,CKEDITOR.POSITION_BEFORE_START];return t?(n=new CKEDITOR.dom.range(this.root)).moveToPosition(t,s[e?0:1]):n=this.clone(),t&&!t.is(CKEDITOR.dtd.$block)?o=1:(i=n[e?"getNextEditableNode":"getPreviousEditableNode"]())&&(o=1,(r=i.type==CKEDITOR.NODE_ELEMENT)&&i.is(CKEDITOR.dtd.$block)&&"false"==i.getAttribute("contenteditable")?(n.setStartAt(i,CKEDITOR.POSITION_BEFORE_START),n.setEndAt(i,CKEDITOR.POSITION_AFTER_END)):!CKEDITOR.env.needsBrFiller&&r&&i.is(CKEDITOR.dom.walker.validEmptyBlockContainers)?(n.setEnd(i,0),n.collapse()):n.moveToPosition(i,s[e?1:0])),o&&this.moveToRange(n),!!o},moveToElementEditStart:function(t){return this.moveToElementEditablePosition(t)},moveToElementEditEnd:function(t){return this.moveToElementEditablePosition(t,!0)},getEnclosedNode:function(){if((t=this.clone()).optimize(),t.startContainer.type!=CKEDITOR.NODE_ELEMENT||t.endContainer.type!=CKEDITOR.NODE_ELEMENT)return null;var t=new CKEDITOR.dom.walker(t),e=CKEDITOR.dom.walker.bookmark(!1,!0),n=CKEDITOR.dom.walker.whitespaces(!0);t.evaluator=function(t){return n(t)&&e(t)};var i=t.next();return t.reset(),i&&i.equals(t.previous())?i:null},getTouchedStartNode:function(){var t=this.startContainer;return this.collapsed||t.type!=CKEDITOR.NODE_ELEMENT?t:t.getChild(this.startOffset)||t},getTouchedEndNode:function(){var t=this.endContainer;return this.collapsed||t.type!=CKEDITOR.NODE_ELEMENT?t:t.getChild(this.endOffset-1)||t},getNextEditableNode:i(),getPreviousEditableNode:i(1),_getTableElement:function(t){t=t||{td:1,th:1,tr:1,tbody:1,thead:1,tfoot:1,table:1};var e=this.getTouchedStartNode(),n=this.getTouchedEndNode(),i=e.getAscendant("table",!0);n=n.getAscendant("table",!0);return i&&!this.root.contains(i)?null:this.getEnclosedNode()?this.getEnclosedNode().getAscendant(t,!0):i&&n&&(i.equals(n)||i.contains(n)||n.contains(i))?e.getAscendant(t,!0):null},scrollIntoView:function(){var t,e,n,i=new CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",this.document),r=this.clone();r.optimize(),(n=r.startContainer.type==CKEDITOR.NODE_TEXT)?(e=r.startContainer.getText(),t=r.startContainer.split(r.startOffset),i.insertAfter(r.startContainer)):r.insertNode(i),i.scrollIntoView(),n&&(r.startContainer.setText(e),t.remove()),i.remove()},getClientRects:function(){function t(t,e,i){var r;return e.collapsed?i.startContainer instanceof CKEDITOR.dom.element?(t=i.checkStartOfBlock(),r=new CKEDITOR.dom.text("\u200b"),t?i.startContainer.append(r,!0):0===i.startOffset?r.insertBefore(i.startContainer.getFirst()):(i=i.startContainer.getChildren().getItem(i.startOffset-1),r.insertAfter(i)),e.setStart(r.$,0),e.setEnd(r.$,0),t=e.getClientRects(),r.remove()):i.startContainer instanceof CKEDITOR.dom.text&&(""===i.startContainer.getText()?(i.startContainer.setText("\u200b"),t=e.getClientRects(),i.startContainer.setText("")):t=[n(i.createBookmark())]):t=[n(i.createBookmark())],t}function e(t,e,n){return t=CKEDITOR.tools.extend({},t),e&&(t=CKEDITOR.tools.getAbsoluteRectPosition(n.document.getWindow(),t)),!t.width&&(t.width=t.right-t.left),!t.height&&(t.height=t.bottom-t.top),t}function n(t){var e,n=t.startNode;return t=t.endNode,n.setText("\u200b"),n.removeStyle("display"),t?(t.setText("\u200b"),t.removeStyle("display"),e=[n.getClientRect(),t.getClientRect()],t.remove()):e=[n.getClientRect(),n.getClientRect()],n.remove(),{right:Math.max(e[0].right,e[1].right),bottom:Math.max(e[0].bottom,e[1].bottom),left:Math.min(e[0].left,e[1].left),top:Math.min(e[0].top,e[1].top),width:Math.abs(e[0].left-e[1].left),height:Math.max(e[0].bottom,e[1].bottom)-Math.min(e[0].top,e[1].top)}}return void 0!==document.getSelection?function(n){var i,r=this.root.getDocument().$.createRange();return r.setStart(this.startContainer.$,this.startOffset),r.setEnd(this.endContainer.$,this.endOffset),i=function(t,e){var n,i,r,o=CKEDITOR.tools.array.map(t,function(t){return t}),s=new CKEDITOR.dom.range(e.root);if(e.startContainer instanceof CKEDITOR.dom.element&&(i=0===e.startOffset&&e.startContainer.hasAttribute("data-widget")),e.endContainer instanceof CKEDITOR.dom.element&&(r=(r=e.endOffset===(e.endContainer.getChildCount?e.endContainer.getChildCount():e.endContainer.length))&&e.endContainer.hasAttribute("data-widget")),i&&s.setStart(e.startContainer.getParent(),e.startContainer.getIndex()),r&&s.setEnd(e.endContainer.getParent(),e.endContainer.getIndex()+1),(i||r)&&(e=s),s=e.cloneContents().find("[data-cke-widget-id]").toArray(),s=CKEDITOR.tools.array.map(s,function(t){var n=e.root.editor;return t=t.getAttribute("data-cke-widget-id"),n.widgets.instances[t].element}))return s=CKEDITOR.tools.array.map(s,function(t){var e;return e=t.getParent().hasClass("cke_widget_wrapper")?t.getParent():t,(n=this.root.getDocument().$.createRange()).setStart(e.getParent().$,e.getIndex()),n.setEnd(e.getParent().$,e.getIndex()+1),(e=n.getClientRects()).widgetRect=t.getClientRect(),e},e),CKEDITOR.tools.array.forEach(s,function(t){var e;!function n(i){CKEDITOR.tools.array.forEach(o,function(n,r){var s=CKEDITOR.tools.objectCompare(t[i],n);s||(s=CKEDITOR.tools.objectCompare(t.widgetRect,n)),s&&(Array.prototype.splice.call(o,r,t.length-i,t.widgetRect),e=!0)}),e||(i<o.length-1?n(i+1):o.push(t.widgetRect))}(0)}),o}(i=r.getClientRects(),this),i.length||(i=t(i,r,this)),CKEDITOR.tools.array.map(i,function(t){return e(t,n,this)},this)}:function(t){return[e(n(this.createBookmark()),t,this)]}}(),_setStartContainer:function(t){this.startContainer=t},_setEndContainer:function(t){this.endContainer=t},_find:function(t,e){var n,i,r,o,s=this.getCommonAncestor(),a=this.getBoundaryNodes(),l=[];if(s&&s.find)for(i=s.find(t),n=0;n<i.count();n++)s=i.getItem(n),(e||!s.isReadOnly())&&(r=s.getPosition(a.startNode)&CKEDITOR.POSITION_FOLLOWING||a.startNode.equals(s),o=s.getPosition(a.endNode)&CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_IS_CONTAINED||a.endNode.equals(s),r&&o&&l.push(s));return l}},CKEDITOR.dom.range.mergeRanges=function(t){return CKEDITOR.tools.array.reduce(t,function(t,e){var n=t[t.length-1],i=!1;if((e=e.clone()).enlarge(CKEDITOR.ENLARGE_ELEMENT),n){var r=new CKEDITOR.dom.range(e.root),o=(i=new CKEDITOR.dom.walker(r),CKEDITOR.dom.walker.whitespaces());for(r.setStart(n.endContainer,n.endOffset),r.setEnd(e.startContainer,e.startOffset),r=i.next();o(r)||e.endContainer.equals(r);)r=i.next();i=!r}return i?n.setEnd(e.endContainer,e.endOffset):t.push(e),t},[])}}(),CKEDITOR.POSITION_AFTER_START=1,CKEDITOR.POSITION_BEFORE_END=2,CKEDITOR.POSITION_BEFORE_START=3,CKEDITOR.POSITION_AFTER_END=4,CKEDITOR.ENLARGE_ELEMENT=1,CKEDITOR.ENLARGE_BLOCK_CONTENTS=2,CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS=3,CKEDITOR.ENLARGE_INLINE=4,CKEDITOR.START=1,CKEDITOR.END=2,CKEDITOR.SHRINK_ELEMENT=1,CKEDITOR.SHRINK_TEXT=2,function(){function t(t){1>arguments.length||(this.range=t,this.forceBrBreak=0,this.enlargeBr=1,this.enforceRealBlocks=0,this._||(this._={}))}function e(t,n,i,r){t:{null==r&&(r=function(t){var e=[];return t.forEach(function(t){if("true"==t.getAttribute("contenteditable"))return e.push(t),!1},CKEDITOR.NODE_ELEMENT,!0),e}(i));for(var o;o=r.shift();)if(o.getDtd().p){r={element:o,remaining:r};break t}r=null}return r?(o=CKEDITOR.filter.instances[r.element.data("cke-filter")])&&!o.check(n)?e(t,n,i,r.remaining):((n=new CKEDITOR.dom.range(r.element)).selectNodeContents(r.element),(n=n.createIterator()).enlargeBr=t.enlargeBr,n.enforceRealBlocks=t.enforceRealBlocks,n.activeFilter=n.filter=o,t._.nestedEditable={element:r.element,container:i,remaining:r.remaining,iterator:n},1):0}function n(t,e,n){return!!e&&((t=t.clone()).collapse(!n),t.checkBoundaryOfElement(e,n?CKEDITOR.START:CKEDITOR.END))}var i=/^[\r\n\t ]+$/,r=CKEDITOR.dom.walker.bookmark(!1,!0),o=CKEDITOR.dom.walker.whitespaces(!0),s=function(t){return r(t)&&o(t)},a={dd:1,dt:1,li:1};t.prototype={getNextParagraph:function(t){var o,l,c,u,h;if(t=t||"p",this._.nestedEditable){if(o=this._.nestedEditable.iterator.getNextParagraph(t))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,o;if(this.activeFilter=this.filter,e(this,t,this._.nestedEditable.container,this._.nestedEditable.remaining))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,this._.nestedEditable.iterator.getNextParagraph(t);this._.nestedEditable=null}if(!this.range.root.getDtd()[t])return null;if(!this._.started){var d=this.range.clone();l=d.startPath();var f=d.endPath(),p=!d.collapsed&&n(d,l.block),g=!d.collapsed&&n(d,f.block,1);d.shrink(CKEDITOR.SHRINK_ELEMENT,!0),p&&d.setStartAt(l.block,CKEDITOR.POSITION_BEFORE_END),g&&d.setEndAt(f.block,CKEDITOR.POSITION_AFTER_START),l=d.endContainer.hasAscendant("pre",!0)||d.startContainer.hasAscendant("pre",!0),d.enlarge(this.forceBrBreak&&!l||!this.enlargeBr?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS),d.collapsed||(l=new CKEDITOR.dom.walker(d.clone()),f=CKEDITOR.dom.walker.bookmark(!0,!0),l.evaluator=f,this._.nextNode=l.next(),(l=new CKEDITOR.dom.walker(d.clone())).evaluator=f,l=l.previous(),this._.lastNode=l.getNextSourceNode(!0,null,d.root),this._.lastNode&&this._.lastNode.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(this._.lastNode.getText())&&this._.lastNode.getParent().isBlockBoundary()&&((f=this.range.clone()).moveToPosition(this._.lastNode,CKEDITOR.POSITION_AFTER_END),f.checkEndOfBlock()&&(f=new CKEDITOR.dom.elementPath(f.endContainer,f.root),this._.lastNode=(f.block||f.blockLimit).getNextSourceNode(!0))),this._.lastNode&&d.root.contains(this._.lastNode)||(this._.lastNode=this._.docEndMarker=d.document.createText(""),this._.lastNode.insertAfter(l)),d=null),this._.started=1,l=d}for(f=this._.nextNode,d=this._.lastNode,this._.nextNode=null;f;){p=0,g=f.hasAscendant("pre");var m=f.type!=CKEDITOR.NODE_ELEMENT,v=0;if(m)f.type==CKEDITOR.NODE_TEXT&&i.test(f.getText())&&(m=0);else{var y=f.getName();if(CKEDITOR.dtd.$block[y]&&"false"==f.getAttribute("contenteditable")){e(this,t,o=f);break}if(f.isBlockBoundary(this.forceBrBreak&&!g&&{br:1})){if("br"==y)m=1;else if(!l&&!f.getChildCount()&&"hr"!=y){o=f,c=f.equals(d);break}l&&(l.setEndAt(f,CKEDITOR.POSITION_BEFORE_START),"br"!=y&&(this._.nextNode=f)),p=1}else{if(f.getFirst()){l||(l=this.range.clone()).setStartAt(f,CKEDITOR.POSITION_BEFORE_START),f=f.getFirst();continue}m=1}}if(m&&!l&&(l=this.range.clone()).setStartAt(f,CKEDITOR.POSITION_BEFORE_START),c=(!p||m)&&f.equals(d),l&&!p)for(;!f.getNext(s)&&!c;){if((y=f.getParent()).isBlockBoundary(this.forceBrBreak&&!g&&{br:1})){p=1,m=0,c||y.equals(d),l.setEndAt(y,CKEDITOR.POSITION_BEFORE_END);break}m=1,c=(f=y).equals(d),v=1}if(m&&l.setEndAt(f,CKEDITOR.POSITION_AFTER_END),(c=!(f=this._getNextSourceNode(f,v,d)))||p&&l)break}if(!o){if(!l)return this._.docEndMarker&&this._.docEndMarker.remove(),this._.nextNode=null;f=(o=new CKEDITOR.dom.elementPath(l.startContainer,l.root)).blockLimit,p={div:1,th:1,td:1},!(o=o.block)&&f&&!this.enforceRealBlocks&&p[f.getName()]&&l.checkStartOfBlock()&&l.checkEndOfBlock()&&!f.equals(l.root)?o=f:!o||this.enforceRealBlocks&&o.is(a)?(o=this.range.document.createElement(t),l.extractContents().appendTo(o),o.trim(),l.insertNode(o),u=h=!0):"li"!=o.getName()?l.checkStartOfBlock()&&l.checkEndOfBlock()||(o=o.clone(!1),l.extractContents().appendTo(o),o.trim(),u=!(h=l.splitBlock()).wasStartOfBlock,h=!h.wasEndOfBlock,l.insertNode(o)):c||(this._.nextNode=o.equals(d)?null:this._getNextSourceNode(l.getBoundaryNodes().endNode,1,d))}return u&&(u=o.getPrevious())&&u.type==CKEDITOR.NODE_ELEMENT&&("br"==u.getName()?u.remove():u.getLast()&&"br"==u.getLast().$.nodeName.toLowerCase()&&u.getLast().remove()),h&&(u=o.getLast())&&u.type==CKEDITOR.NODE_ELEMENT&&"br"==u.getName()&&(!CKEDITOR.env.needsBrFiller||u.getPrevious(r)||u.getNext(r))&&u.remove(),this._.nextNode||(this._.nextNode=c||o.equals(d)||!d?null:this._getNextSourceNode(o,1,d)),o},_getNextSourceNode:function(t,e,n){function i(t){return!(t.equals(n)||t.equals(o))}var o=this.range.root;for(t=t.getNextSourceNode(e,null,i);!r(t);)t=t.getNextSourceNode(e,null,i);return t}},CKEDITOR.dom.range.prototype.createIterator=function(){return new t(this)}}(),CKEDITOR.command=function(t,e){var n;this.uiItems=[],this.exec=function(n){return!(this.state==CKEDITOR.TRISTATE_DISABLED||!this.checkAllowed())&&(this.editorFocus&&t.focus(),!1===this.fire("exec")||!1!==e.exec.call(this,t,n))},this.refresh=function(t,n){return!(this.readOnly||!t.readOnly)||(this.context&&!n.isContextFor(this.context)||!this.checkAllowed(!0)?(this.disable(),!0):(this.startDisabled||this.enable(),this.modes&&!this.modes[t.mode]&&this.disable(),!1===this.fire("refresh",{editor:t,path:n})||e.refresh&&!1!==e.refresh.apply(this,arguments)))},this.checkAllowed=function(e){return e||"boolean"!=typeof n?n=t.activeFilter.checkFeature(this):n},CKEDITOR.tools.extend(this,e,{modes:{wysiwyg:1},editorFocus:1,contextSensitive:!!e.context,state:CKEDITOR.TRISTATE_DISABLED}),CKEDITOR.event.call(this)},CKEDITOR.command.prototype={enable:function(){this.state==CKEDITOR.TRISTATE_DISABLED&&this.checkAllowed()&&this.setState(this.preserveState&&void 0!==this.previousState?this.previousState:CKEDITOR.TRISTATE_OFF)},disable:function(){this.setState(CKEDITOR.TRISTATE_DISABLED)},setState:function(t){return!(this.state==t||t!=CKEDITOR.TRISTATE_DISABLED&&!this.checkAllowed())&&(this.previousState=this.state,this.state=t,this.fire("state"),!0)},toggleState:function(){this.state==CKEDITOR.TRISTATE_OFF?this.setState(CKEDITOR.TRISTATE_ON):this.state==CKEDITOR.TRISTATE_ON&&this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.event.implementOn(CKEDITOR.command.prototype),CKEDITOR.ENTER_P=1,CKEDITOR.ENTER_BR=2,CKEDITOR.ENTER_DIV=3,CKEDITOR.config={customConfig:"config.js",autoUpdateElement:!0,language:"",defaultLanguage:"en",contentsLangDirection:"",enterMode:CKEDITOR.ENTER_P,forceEnterMode:!1,shiftEnterMode:CKEDITOR.ENTER_BR,docType:"<!DOCTYPE html>",bodyId:"",bodyClass:"",fullPage:!1,height:200,contentsCss:CKEDITOR.getUrl("contents.css"),extraPlugins:"",removePlugins:"",protectedSource:[],tabIndex:0,useComputedState:!0,width:"",baseFloatZIndex:1e4,blockedKeystrokes:[CKEDITOR.CTRL+66,CKEDITOR.CTRL+73,CKEDITOR.CTRL+85]},function(){function t(t,e,n,i,r){var o,a,l;for(o in t=[],e){a="boolean"==typeof(a=e[o])?{}:"function"==typeof a?{match:a}:_(a),"$"!=o.charAt(0)&&(a.elements=o),n&&(a.featureName=n.toLowerCase());var c=a;c.elements=s(c.elements,/\s+/)||null,c.propertiesOnly=c.propertiesOnly||!0===c.elements;var u=/\s*,\s*/,h=void 0;for(h in S){c[h]=s(c[h],u)||null;var d=c,f=R[h],p=s(c[R[h]],u),g=c[h],v=[],y=!0,b=void 0;for(b in p?y=!1:p={},g)"!"==b.charAt(0)&&(b=b.slice(1),v.push(b),p[b]=!0,y=!1);for(;b=v.pop();)g[b]=g["!"+b],delete g["!"+b];d[f]=!y&&p||null}c.match=c.match||null,i.push(a),t.push(a)}for(e=r.elements,r=r.generic,n=0,i=t.length;n<i;++n){for(u in a=!0===(o=_(t[n])).classes||!0===o.styles||!0===o.attributes,c=o,h=f=u=void 0,S)c[u]=m(c[u]);for(h in d=!0,R){for(g in p=[],g=void 0,f=c[u=R[h]])-1<g.indexOf("*")?p.push(new RegExp("^"+g.replace(/\*/g,".*")+"$")):p.push(g);(f=p).length&&(c[u]=f,d=!1)}if(c.nothingRequired=d,c.noProperties=!(c.attributes||c.classes||c.styles),!0===o.elements||null===o.elements)r[a?"unshift":"push"](o);else for(l in c=o.elements,delete o.elements,c)e[l]?e[l][a?"unshift":"push"](o):e[l]=[o]}}function e(t,e,i,r){if((!t.match||t.match(e))&&(r||a(t,e))&&(t.propertiesOnly||(i.valid=!0),i.allAttributes||(i.allAttributes=n(t.attributes,e.attributes,i.validAttributes)),i.allStyles||(i.allStyles=n(t.styles,e.styles,i.validStyles)),!i.allClasses)){if(t=t.classes,e=e.classes,r=i.validClasses,t)if(!0===t)t=!0;else{for(var o,s=0,l=e.length;s<l;++s)r[o=e[s]]||(r[o]=t(o));t=!1}else t=!1;i.allClasses=t}}function n(t,e,n){if(!t)return!1;if(!0===t)return!0;for(var i in e)n[i]||(n[i]=t(i));return!1}function i(t,e,n){if(!t.match||t.match(e)){if(t.noProperties)return!1;if(n.hadInvalidAttribute=r(t.attributes,e.attributes)||n.hadInvalidAttribute,n.hadInvalidStyle=r(t.styles,e.styles)||n.hadInvalidStyle,t=t.classes,e=e.classes,t){for(var i=!1,o=!0===t,s=e.length;s--;)(o||t(e[s]))&&(e.splice(s,1),i=!0);t=i}else t=!1;n.hadInvalidClass=t||n.hadInvalidClass}}function r(t,e){if(!t)return!1;var n,i=!1,r=!0===t;for(n in e)(r||t(n))&&(delete e[n],i=!0);return i}function o(t,e,n){return!(t.disabled||t.customConfig&&!n||!e)&&(t._.cachedChecks={},!0)}function s(t,e){if(!t)return!1;if(!0===t)return t;if("string"==typeof t)return"*"==(t=D(t))||CKEDITOR.tools.convertArrayToObject(t.split(e));if(CKEDITOR.tools.isArray(t))return!!t.length&&CKEDITOR.tools.convertArrayToObject(t);var n,i={},r=0;for(n in t)i[n]=t[n],r++;return!!r&&i}function a(t,e){if(t.nothingRequired)return!0;var n,i,r,o;if(r=t.requiredClasses)for(o=e.classes,n=0;n<r.length;++n)if("string"==typeof(i=r[n])){if(-1==CKEDITOR.tools.indexOf(o,i))return!1}else if(!CKEDITOR.tools.checkIfAnyArrayItemMatches(o,i))return!1;return l(e.styles,t.requiredStyles)&&l(e.attributes,t.requiredAttributes)}function l(t,e){if(!e)return!0;for(var n,i=0;i<e.length;++i)if("string"==typeof(n=e[i])){if(!(n in t))return!1}else if(!CKEDITOR.tools.checkIfAnyObjectPropertyMatches(t,n))return!1;return!0}function c(t){if(!t)return{};t=t.split(/\s*,\s*/).sort();for(var e={};t.length;)e[t.shift()]="cke-test";return e}function u(t){var e,n,i,r,o={},s=1;for(t=D(t);e=t.match(k);)(n=e[2])?(i=h(n,"styles"),r=h(n,"attrs"),n=h(n,"classes")):i=r=n=null,o["$"+s++]={elements:e[1],classes:n,styles:i,attributes:r},t=t.slice(e[0].length);return o}function h(t,e){var n=t.match(N[e]);return n?D(n[1]):null}function d(t){var e=t.styleBackup=t.attributes.style,n=t.classBackup=t.attributes.class;t.styles||(t.styles=CKEDITOR.tools.parseCssText(e||"",1)),t.classes||(t.classes=n?n.split(/\s+/):[])}function f(t,n,r,o){var s,a=0;if(o.toHtml&&(n.name=n.name.replace(M,"$1")),o.doCallbacks&&t.elementCallbacks){t:{for(var l,c=0,u=(s=t.elementCallbacks).length;c<u;++c)if(l=s[c](n)){s=l;break t}s=void 0}if(s)return s}if(o.doTransform&&(s=t._.transformations[n.name])){for(d(n),c=0;c<s.length;++c)C(t,n,s[c]);p(n)}if(o.doFilter){t:{c=n.name,t=(u=t._).allowedRules.elements[c],s=u.allowedRules.generic,c=u.disallowedRules.elements[c],u=u.disallowedRules.generic,l=o.skipRequired;var h,f,m={valid:!1,validAttributes:{},validClasses:{},validStyles:{},allAttributes:!1,allClasses:!1,allStyles:!1,hadInvalidAttribute:!1,hadInvalidClass:!1,hadInvalidStyle:!1};if(t||s){if(d(n),c)for(h=0,f=c.length;h<f;++h)if(!1===i(c[h],n,m)){t=null;break t}if(u)for(h=0,f=u.length;h<f;++h)i(u[h],n,m);if(t)for(h=0,f=t.length;h<f;++h)e(t[h],n,m,l);if(s)for(h=0,f=s.length;h<f;++h)e(s[h],n,m,l);t=m}else t=null}if(!t||!t.valid)return r.push(n),1;f=t.validAttributes;var v=t.validStyles;s=t.validClasses;c=n.attributes;var y=n.styles;u=n.classes;l=n.classBackup;var b,I,E=n.styleBackup,T=[],w=(m=[],/^data-cke-/);if(h=!1,delete c.style,delete c.class,delete n.classBackup,delete n.styleBackup,!t.allAttributes)for(b in c)f[b]||w.test(b)&&(b==(I=b.replace(/^data-cke-saved-/,""))||f[I])||(delete c[b],h=!0);if(!t.allStyles||t.hadInvalidStyle){for(b in y)t.allStyles||v[b]?T.push(b+":"+y[b]):h=!0;T.length&&(c.style=T.sort().join("; "))}else E&&(c.style=E);if(!t.allClasses||t.hadInvalidClass){for(b=0;b<u.length;++b)(t.allClasses||s[u[b]])&&m.push(u[b]);m.length&&(c.class=m.sort().join(" ")),l&&m.length<l.split(/\s+/).length&&(h=!0)}else l&&(c.class=l);if(h&&(a=1),!o.skipFinalValidation&&!g(n))return r.push(n),1}return o.toHtml&&(n.name=n.name.replace(P,"cke:$1")),a}function p(t){var e,n=t.attributes;delete n.style,delete n.class,(e=CKEDITOR.tools.writeCssText(t.styles,!0))&&(n.style=e),t.classes.length&&(n.class=t.classes.sort().join(" "))}function g(t){switch(t.name){case"a":if(!(t.children.length||t.attributes.name||t.attributes.id))return!1;break;case"img":if(!t.attributes.src)return!1}return!0}function m(t){if(!t)return!1;if(!0===t)return!0;var e=function(t){var e,n=[];for(e in t)-1<e.indexOf("*")&&n.push(e.replace(/\*/g,".*"));return n.length?new RegExp("^(?:"+n.join("|")+")$"):null}(t);return function(n){return n in t||e&&n.match(e)}}function v(){return new CKEDITOR.htmlParser.element("br")}function y(t){return t.type==CKEDITOR.NODE_ELEMENT&&("br"==t.name||x.$block[t.name])}function b(t,e,n){var i=t.name;if(x.$empty[i]||!t.children.length)"hr"==i&&"br"==e?t.replaceWith(v()):(t.parent&&n.push({check:"it",el:t.parent}),t.remove());else if(x.$block[i]||"tr"==i)if("br"==e)t.previous&&!y(t.previous)&&(e=v()).insertBefore(t),t.next&&!y(t.next)&&(e=v()).insertAfter(t),t.replaceWithChildren();else{var r;i=t.children;t:{r=x[e];for(var o,s=0,a=i.length;s<a;++s)if((o=i[s]).type==CKEDITOR.NODE_ELEMENT&&!r[o.name]){r=!1;break t}r=!0}if(r)t.name=e,t.attributes={},n.push({check:"parent-down",el:t});else{var l,c;for(s=(r=t.parent).type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||"body"==r.name,a=i.length;0<a;)o=i[--a],s&&(o.type==CKEDITOR.NODE_TEXT||o.type==CKEDITOR.NODE_ELEMENT&&x.$inline[o.name])?(l||((l=new CKEDITOR.htmlParser.element(e)).insertAfter(t),n.push({check:"parent-down",el:l})),l.add(o,0)):(l=null,c=x[r.name]||x.span,o.insertAfter(t),r.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||o.type!=CKEDITOR.NODE_ELEMENT||c[o.name]||n.push({check:"el-up",el:o}));t.remove()}}else i in{style:1,script:1}?t.remove():(t.parent&&n.push({check:"it",el:t.parent}),t.replaceWithChildren())}function C(t,e,n){var i,r;for(i=0;i<n.length;++i)if(!((r=n[i]).check&&!t.check(r.check,!1)||r.left&&!r.left(e))){r.right(e,O);break}}function I(t,e){var n,i,r,o,s=e.getDefinition(),a=s.attributes,l=s.styles;if(t.name!=s.element)return!1;for(n in a)if("class"==n){for(s=a[n].split(/\s+/),r=t.classes.join("|");o=s.pop();)if(-1==r.indexOf(o))return!1}else if(t.attributes[n]!=a[n])return!1;for(i in l)if(t.styles[i]!=l[i])return!1;return!0}function E(t,e){var n,i;return"string"==typeof t?n=t:t instanceof CKEDITOR.style?i=t:(n=t[0],i=t[1]),[{element:n,left:i,right:function(t,n){n.transform(t,e)}}]}function T(t){return function(e){return I(e,t)}}function w(t){return function(e,n){n[t](e)}}var x=CKEDITOR.dtd,_=CKEDITOR.tools.copy,D=CKEDITOR.tools.trim,A=["","p","br","div"];CKEDITOR.FILTER_SKIP_TREE=2,CKEDITOR.filter=function(t,e){this.allowedContent=[],this.disallowedContent=[],this.elementCallbacks=null,this.disabled=!1,this.editor=null,this.id=CKEDITOR.tools.getNextNumber(),this._={allowedRules:{elements:{},generic:[]},disallowedRules:{elements:{},generic:[]},transformations:{},cachedTests:{},cachedChecks:{}},CKEDITOR.filter.instances[this.id]=this;var n=this.editor=t instanceof CKEDITOR.editor?t:null;if(n&&!e){this.customConfig=!0;var i=n.config.allowedContent;!0===i?this.disabled=!0:(i||(this.customConfig=!1),this.allow(i,"config",1),this.allow(n.config.extraAllowedContent,"extra",1),this.allow(A[n.enterMode]+" "+A[n.shiftEnterMode],"default",1),this.disallow(n.config.disallowedContent))}else this.customConfig=!1,this.allow(e||t,"default",1)},CKEDITOR.filter.instances={},CKEDITOR.filter.prototype={allow:function(e,n,i){if(!o(this,e,i))return!1;var r,s;if("string"==typeof e)e=u(e);else if(e instanceof CKEDITOR.style){if(e.toAllowedContentRules)return this.allow(e.toAllowedContentRules(this.editor),n,i);r=e.getDefinition(),e={},i=r.attributes,e[r.element]=r={styles:r.styles,requiredStyles:r.styles&&CKEDITOR.tools.object.keys(r.styles)},i&&(i=_(i),r.classes=i.class?i.class.split(/\s+/):null,r.requiredClasses=r.classes,delete i.class,r.attributes=i,r.requiredAttributes=i&&CKEDITOR.tools.object.keys(i))}else if(CKEDITOR.tools.isArray(e)){for(r=0;r<e.length;++r)s=this.allow(e[r],n,i);return s}return t(this,e,n,this.allowedContent,this._.allowedRules),!0},applyTo:function(t,e,n,i){if(this.disabled)return!1;var r,o,s,a=this,l=[],c=this.editor&&this.editor.config.protectedSource,u=!1,h={doFilter:!n,doTransform:!0,doCallbacks:!0,toHtml:e};for(t.forEach(function(t){if(t.type==CKEDITOR.NODE_ELEMENT){if("off"==t.attributes["data-cke-filter"])return!1;if(!e||"span"!=t.name||!~CKEDITOR.tools.object.keys(t.attributes).join("|").indexOf("data-cke-"))if(1&(r=f(a,t,l,h)))u=!0;else if(2&r)return!1}else if(t.type==CKEDITOR.NODE_COMMENT&&t.value.match(/^\{cke_protected\}(?!\{C\})/)){var n;t:{var i,o,s,d=decodeURIComponent(t.value.replace(/^\{cke_protected\}/,""));if(n=[],c)for(o=0;o<c.length;++o)if((s=d.match(c[o]))&&s[0].length==d.length){n=!0;break t}1==(d=CKEDITOR.htmlParser.fragment.fromHtml(d)).children.length&&(i=d.children[0]).type==CKEDITOR.NODE_ELEMENT&&f(a,i,n,h),n=!n.length}n||l.push(t)}},null,!0),l.length&&(u=!0),t=[],i=A[i||(this.editor?this.editor.enterMode:CKEDITOR.ENTER_P)];n=l.pop();)n.type==CKEDITOR.NODE_ELEMENT?b(n,i,t):n.remove();for(;o=t.pop();)if((n=o.el).parent)switch(s=x[n.parent.name]||x.span,o.check){case"it":x.$removeEmpty[n.name]&&!n.children.length?b(n,i,t):g(n)||b(n,i,t);break;case"el-up":n.parent.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||s[n.name]||b(n,i,t);break;case"parent-down":n.parent.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||s[n.name]||b(n.parent,i,t)}return u},checkFeature:function(t){return!(!this.disabled&&t)||(t.toFeature&&(t=t.toFeature(this.editor)),!t.requiredContent||this.check(t.requiredContent))},disable:function(){this.disabled=!0},disallow:function(e){return!!o(this,e,!0)&&("string"==typeof e&&(e=u(e)),t(this,e,null,this.disallowedContent,this._.disallowedRules),!0)},addContentForms:function(t){if(!this.disabled&&t){var e,n,i,r=[];for(e=0;e<t.length&&!i;++e)("string"==typeof(n=t[e])||n instanceof CKEDITOR.style)&&this.check(n)&&(i=n);if(i){for(e=0;e<t.length;++e)r.push(E(t[e],i));this.addTransformations(r)}}},addElementCallback:function(t){this.elementCallbacks||(this.elementCallbacks=[]),this.elementCallbacks.push(t)},addFeature:function(t){return!(!this.disabled&&t)||(t.toFeature&&(t=t.toFeature(this.editor)),this.allow(t.allowedContent,t.name),this.addTransformations(t.contentTransformations),this.addContentForms(t.contentForms),!t.requiredContent||!this.customConfig&&!this.disallowedContent.length||this.check(t.requiredContent))},addTransformations:function(t){var e,n;if(!this.disabled&&t){var i,r=this._.transformations;for(i=0;i<t.length;++i){e=t[i];var o=void 0,s=void 0,a=void 0,l=void 0,c=void 0,u=void 0;for(n=[],s=0;s<e.length;++s)"string"==typeof(a=e[s])?(l=(a=a.split(/\s*:\s*/))[0],c=null,u=a[1]):(l=a.check,c=a.left,u=a.right),o||(o=(o=a).element?o.element:l?l.match(/^([a-z0-9]+)/i)[0]:o.left.getDefinition().element),c instanceof CKEDITOR.style&&(c=T(c)),n.push({check:l==o?null:l,left:c,right:"string"==typeof u?w(u):u});r[e=o]||(r[e]=[]),r[e].push(n)}}},check:function(t,e,n){if(this.disabled)return!0;if(CKEDITOR.tools.isArray(t)){for(var i=t.length;i--;)if(this.check(t[i],e,n))return!0;return!1}var r,o;if("string"==typeof t){if((o=t+"<"+(!1===e?"0":"1")+(n?"1":"0")+">")in this._.cachedChecks)return this._.cachedChecks[o];var s=(r=u(t).$1).styles;i=r.classes;r.name=r.elements,r.classes=i=i?i.split(/\s*,\s*/):[],r.styles=c(s),r.attributes=c(r.attributes),r.children=[],i.length&&(r.attributes.class=i.join(" ")),s&&(r.attributes.style=CKEDITOR.tools.writeCssText(r.styles))}else s=(r=t.getDefinition()).styles,i=r.attributes||{},s&&!CKEDITOR.tools.isEmpty(s)?(s=_(s),i.style=CKEDITOR.tools.writeCssText(s,!0)):s={},r={name:r.element,attributes:i,classes:i.class?i.class.split(/\s+/):[],styles:s,children:[]};s=CKEDITOR.tools.clone(r);var a,l=[];if(!1!==e&&(a=this._.transformations[r.name])){for(i=0;i<a.length;++i)C(this,r,a[i]);p(r)}return f(this,s,l,{doFilter:!0,doTransform:!1!==e,skipRequired:!n,skipFinalValidation:!n}),0<l.length?n=!1:((e=r.attributes.class)&&(r.attributes.class=r.attributes.class.split(" ").sort().join(" ")),n=CKEDITOR.tools.objectCompare(r.attributes,s.attributes,!0),e&&(r.attributes.class=e)),"string"==typeof t&&(this._.cachedChecks[o]=n),n},getAllowedEnterMode:function(){var t=["p","div","br"],e={p:CKEDITOR.ENTER_P,div:CKEDITOR.ENTER_DIV,br:CKEDITOR.ENTER_BR};return function(n,i){var r,o=t.slice();if(this.check(A[n]))return n;for(i||(o=o.reverse());r=o.pop();)if(this.check(r))return e[r];return CKEDITOR.ENTER_BR}}(),clone:function(){var t=new CKEDITOR.filter,e=CKEDITOR.tools.clone;return t.allowedContent=e(this.allowedContent),t._.allowedRules=e(this._.allowedRules),t.disallowedContent=e(this.disallowedContent),t._.disallowedRules=e(this._.disallowedRules),t._.transformations=e(this._.transformations),t.disabled=this.disabled,t.editor=this.editor,t},destroy:function(){delete CKEDITOR.filter.instances[this.id],delete this._,delete this.allowedContent,delete this.disallowedContent}};var O,S={styles:1,attributes:1,classes:1},R={styles:"requiredStyles",attributes:"requiredAttributes",classes:"requiredClasses"},k=/^([a-z0-9\-*\s]+)((?:\s*\{[!\w\-,\s\*]+\}\s*|\s*\[[!\w\-,\s\*]+\]\s*|\s*\([!\w\-,\s\*]+\)\s*){0,3})(?:;\s*|$)/i,N={styles:/{([^}]+)}/,attrs:/\[([^\]]+)\]/,classes:/\(([^\)]+)\)/},M=/^cke:(object|embed|param)$/,P=/^(object|embed|param)$/;O=CKEDITOR.filter.transformationsTools={sizeToStyle:function(t){this.lengthToStyle(t,"width"),this.lengthToStyle(t,"height")},sizeToAttribute:function(t){this.lengthToAttribute(t,"width"),this.lengthToAttribute(t,"height")},lengthToStyle:function(t,e,n){if(!((n=n||e)in t.styles)){var i=t.attributes[e];i&&(/^\d+$/.test(i)&&(i+="px"),t.styles[n]=i)}delete t.attributes[e]},lengthToAttribute:function(t,e,n){if(!((n=n||e)in t.attributes)){var i=t.styles[e],r=i&&i.match(/^(\d+)(?:\.\d*)?px$/);r?t.attributes[n]=r[1]:"cke-test"==i&&(t.attributes[n]="cke-test")}delete t.styles[e]},alignmentToStyle:function(t){if(!("float"in t.styles)){var e=t.attributes.align;"left"!=e&&"right"!=e||(t.styles.float=e)}delete t.attributes.align},alignmentToAttribute:function(t){if(!("align"in t.attributes)){var e=t.styles.float;"left"!=e&&"right"!=e||(t.attributes.align=e)}delete t.styles.float},splitBorderShorthand:function(t){if(t.styles.border){var e=CKEDITOR.tools.style.parse.border(t.styles.border);e.color&&(t.styles["border-color"]=e.color),e.style&&(t.styles["border-style"]=e.style),e.width&&(t.styles["border-width"]=e.width),delete t.styles.border}},listTypeToStyle:function(t){if(t.attributes.type)switch(t.attributes.type){case"a":t.styles["list-style-type"]="lower-alpha";break;case"A":t.styles["list-style-type"]="upper-alpha";break;case"i":t.styles["list-style-type"]="lower-roman";break;case"I":t.styles["list-style-type"]="upper-roman";break;case"1":t.styles["list-style-type"]="decimal";break;default:t.styles["list-style-type"]=t.attributes.type}},splitMarginShorthand:function(t){function e(e){t.styles["margin-top"]=n[e[0]],t.styles["margin-right"]=n[e[1]],t.styles["margin-bottom"]=n[e[2]],t.styles["margin-left"]=n[e[3]]}if(t.styles.margin){var n=t.styles.margin.match(/(auto|0|(?:\-?[\.\d]+(?:\w+|%)))/g)||["0px"];switch(n.length){case 1:e([0,0,0,0]);break;case 2:e([0,1,0,1]);break;case 3:e([0,1,2,1]);break;case 4:e([0,1,2,3])}delete t.styles.margin}},matchesStyle:I,transform:function(t,e){if("string"==typeof e)t.name=e;else{var n,i,r,o,s=e.getDefinition(),a=s.styles,l=s.attributes;for(n in t.name=s.element,l)if("class"==n)for(s=t.classes.join("|"),r=l[n].split(/\s+/);o=r.pop();)-1==s.indexOf(o)&&t.classes.push(o);else t.attributes[n]=l[n];for(i in a)t.styles[i]=a[i]}}}}(),CKEDITOR.focusManager=function(t){return t.focusManager?t.focusManager:(this.hasFocus=!1,this.currentActive=null,this._={editor:t},this)},CKEDITOR.focusManager._={blurDelay:200},CKEDITOR.focusManager.prototype={focus:function(t){this._.timer&&clearTimeout(this._.timer),t&&(this.currentActive=t),this.hasFocus||this._.locked||((t=CKEDITOR.currentInstance)&&t.focusManager.blur(1),this.hasFocus=!0,(t=this._.editor.container)&&t.addClass("cke_focus"),this._.editor.fire("focus"))},lock:function(){this._.locked=1},unlock:function(){delete this._.locked},blur:function(t){function e(){if(this.hasFocus){this.hasFocus=!1;var t=this._.editor.container;t&&t.removeClass("cke_focus"),this._.editor.fire("blur")}}if(!this._.locked){this._.timer&&clearTimeout(this._.timer);var n=CKEDITOR.focusManager._.blurDelay;t||!n?e.call(this):this._.timer=CKEDITOR.tools.setTimeout(function(){delete this._.timer,e.call(this)},n,this)}},add:function(t,e){if(!(n=t.getCustomData("focusmanager"))||n!=this){n&&n.remove(t);var n="focus",i="blur";e&&(CKEDITOR.env.ie?(n="focusin",i="focusout"):CKEDITOR.event.useCapture=1);var r={blur:function(){t.equals(this.currentActive)&&this.blur()},focus:function(){this.focus(t)}};t.on(n,r.focus,this),t.on(i,r.blur,this),e&&(CKEDITOR.event.useCapture=0),t.setCustomData("focusmanager",this),t.setCustomData("focusmanager_handlers",r)}},remove:function(t){t.removeCustomData("focusmanager");var e=t.removeCustomData("focusmanager_handlers");t.removeListener("blur",e.blur),t.removeListener("focus",e.focus)}},CKEDITOR.keystrokeHandler=function(t){return t.keystrokeHandler?t.keystrokeHandler:(this.keystrokes={},this.blockedKeystrokes={},this._={editor:t},this)},function(){var t,e=function(e){var n=(e=e.data).getKeystroke(),i=this.keystrokes[n],r=this._.editor;return(t=!1===r.fire("key",{keyCode:n,domEvent:e}))||(i&&(t=!1!==r.execCommand(i,{from:"keystrokeHandler"})),t||(t=!!this.blockedKeystrokes[n])),t&&e.preventDefault(!0),!t},n=function(e){t&&(t=!1,e.data.preventDefault(!0))};CKEDITOR.keystrokeHandler.prototype={attach:function(t){t.on("keydown",e,this),CKEDITOR.env.gecko&&CKEDITOR.env.mac&&t.on("keypress",n,this)}}}(),CKEDITOR.lang={languages:{af:1,ar:1,az:1,bg:1,bn:1,bs:1,ca:1,cs:1,cy:1,da:1,de:1,"de-ch":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,en:1,eo:1,es:1,"es-mx":1,et:1,eu:1,fa:1,fi:1,fo:1,"fr-ca":1,fr:1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,is:1,it:1,ja:1,ka:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,ms:1,nb:1,nl:1,no:1,oc:1,pl:1,"pt-br":1,pt:1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,"sr-latn":1,sr:1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,"zh-cn":1,zh:1},rtl:{ar:1,fa:1,he:1,ku:1,ug:1},load:function(t,e,n){t&&CKEDITOR.lang.languages[t]||(t=this.detect(e,t));var i=this;e=function(){i[t].dir=i.rtl[t]?"rtl":"ltr",n(t,i[t])},this[t]?e():CKEDITOR.scriptLoader.load(CKEDITOR.getUrl("lang/"+t+".js"),e,this)},detect:function(t,e){var n=this.languages,i=(r=(e=e||navigator.userLanguage||navigator.language||t).toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/))[1],r=r[2];return n[i+"-"+r]?i=i+"-"+r:n[i]||(i=null),CKEDITOR.lang.detect=i?function(){return i}:function(t){return t},i||t}},CKEDITOR.scriptLoader=function(){var t={},e={};return{load:function(n,i,r,o){var s="string"==typeof n;s&&(n=[n]),r||(r=CKEDITOR);var a=n.length,l=a,c=[],u=[],h=function(t){i&&(s?i.call(r,t):i.call(r,c,u))};if(0===l)h(!0);else{var d=function(t,e){(e?c:u).push(t),0>=--l&&(o&&CKEDITOR.document.getDocumentElement().removeStyle("cursor"),h(e))},f=function(n,i){t[n]=1;var r=e[n];delete e[n];for(var o=0;o<r.length;o++)r[o](n,i)},p=function(n){if(t[n])d(n,!0);else{var r=e[n]||(e[n]=[]);if(r.push(d),!(1<r.length)){var o=new CKEDITOR.dom.element("script");o.setAttributes({type:"text/javascript",src:n}),i&&(CKEDITOR.env.ie&&(8>=CKEDITOR.env.version||CKEDITOR.env.ie9Compat)?o.$.onreadystatechange=function(){"loaded"!=o.$.readyState&&"complete"!=o.$.readyState||(o.$.onreadystatechange=null,f(n,!0))}:(o.$.onload=function(){setTimeout(function(){o.$.onload=null,o.$.onerror=null,f(n,!0)},0)},o.$.onerror=function(){o.$.onload=null,o.$.onerror=null,f(n,!1)})),o.appendTo(CKEDITOR.document.getHead())}}};o&&CKEDITOR.document.getDocumentElement().setStyle("cursor","wait");for(var g=0;g<a;g++)p(n[g])}},queue:function(){function t(){var t;(t=e[0])&&this.load(t.scriptUrl,t.callback,CKEDITOR,0)}var e=[];return function(n,i){var r=this;e.push({scriptUrl:n,callback:function(){i&&i.apply(this,arguments),e.shift(),t.call(r)}}),1==e.length&&t.call(this)}}()}}(),CKEDITOR.resourceManager=function(t,e){this.basePath=t,this.fileName=e,this.registered={},this.loaded={},this.externals={},this._={waitingList:{}}},CKEDITOR.resourceManager.prototype={add:function(t,e){if(this.registered[t])throw Error('[CKEDITOR.resourceManager.add] The resource name "'+t+'" is already registered.');var n=this.registered[t]=e||{};return n.name=t,n.path=this.getPath(t),CKEDITOR.fire(t+CKEDITOR.tools.capitalize(this.fileName)+"Ready",n),this.get(t)},get:function(t){return this.registered[t]||null},getPath:function(t){var e=this.externals[t];return CKEDITOR.getUrl(e&&e.dir||this.basePath+t+"/")},getFilePath:function(t){var e=this.externals[t];return CKEDITOR.getUrl(this.getPath(t)+(e?e.file:this.fileName+".js"))},addExternal:function(t,e,n){n||(e=e.replace(/[^\/]+$/,function(t){return n=t,""})),n=n||this.fileName+".js",t=t.split(",");for(var i=0;i<t.length;i++)this.externals[t[i]]={dir:e,file:n}},load:function(t,e,n){CKEDITOR.tools.isArray(t)||(t=t?[t]:[]);for(var i=this.loaded,r=this.registered,o=[],s={},a={},l=0;l<t.length;l++){var c=t[l];if(c)if(i[c]||r[c])a[c]=this.get(c);else{var u=this.getFilePath(c);o.push(u),u in s||(s[u]=[]),s[u].push(c)}}CKEDITOR.scriptLoader.load(o,function(t,r){if(r.length)throw Error('[CKEDITOR.resourceManager.load] Resource name "'+s[r[0]].join(",")+'" was not found at "'+r[0]+'".');for(var o=0;o<t.length;o++)for(var l=s[t[o]],c=0;c<l.length;c++){var u=l[c];a[u]=this.get(u),i[u]=1}e.call(n,a)},this)}},CKEDITOR.plugins=new CKEDITOR.resourceManager("plugins/","plugin"),CKEDITOR.plugins.load=CKEDITOR.tools.override(CKEDITOR.plugins.load,function(t){var e={};return function(n,i,r){var o={},s=function(n){t.call(this,n,function(t){CKEDITOR.tools.extend(o,t);var n,a=[];for(n in t){var l=t[n],c=l&&l.requires;if(!e[n]){if(l.icons)for(var u=l.icons.split(","),h=u.length;h--;)CKEDITOR.skin.addIcon(u[h],l.path+"icons/"+(CKEDITOR.env.hidpi&&l.hidpi?"hidpi/":"")+u[h]+".png");l.isSupportedEnvironment=l.isSupportedEnvironment||function(){return!0},e[n]=1}if(c)for(c.split&&(c=c.split(",")),l=0;l<c.length;l++)o[c[l]]||a.push(c[l])}if(a.length)s.call(this,a);else{for(n in o)(l=o[n]).onLoad&&!l.onLoad._called&&(!1===l.onLoad()&&delete o[n],l.onLoad._called=1);i&&i.call(r||window,o)}},this)};s.call(this,n)}}),CKEDITOR.plugins.setLang=function(t,e,n){var i=this.get(t);t=i.langEntries||(i.langEntries={}),(i=i.lang||(i.lang=[])).split&&(i=i.split(",")),-1==CKEDITOR.tools.indexOf(i,e)&&i.push(e),t[e]=n},CKEDITOR.ui=function(t){return t.ui?t.ui:(this.items={},this.instances={},this.editor=t,this._={handlers:{}},this)},CKEDITOR.ui.prototype={add:function(t,e,n){n.name=t.toLowerCase();var i=this.items[t]={type:e,command:n.command||null,args:Array.prototype.slice.call(arguments,2)};CKEDITOR.tools.extend(i,n)},get:function(t){return this.instances[t]},create:function(t){var e=this.items[t],n=e&&this._.handlers[e.type],i=e&&e.command&&this.editor.getCommand(e.command);n=n&&n.create.apply(this,e.args);return this.instances[t]=n,i&&i.uiItems.push(n),n&&!n.type&&(n.type=e.type),n},addHandler:function(t,e){this._.handlers[t]=e},space:function(t){return CKEDITOR.document.getById(this.spaceId(t))},spaceId:function(t){return this.editor.id+"_"+t}},CKEDITOR.event.implementOn(CKEDITOR.ui),function(){function t(t,n,r){if(CKEDITOR.event.call(this),t=t&&CKEDITOR.tools.clone(t),void 0!==n){if(!(n instanceof CKEDITOR.dom.element))throw Error("Expect element of type CKEDITOR.dom.element.");if(!r)throw Error("One of the element modes must be specified.");if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&r==CKEDITOR.ELEMENT_MODE_INLINE)throw Error("Inline element mode is not supported on IE quirks.");if(!function(t,e){return e==CKEDITOR.ELEMENT_MODE_INLINE?t.is(CKEDITOR.dtd.$editable)||t.is("textarea"):e==CKEDITOR.ELEMENT_MODE_REPLACE?!t.is(CKEDITOR.dtd.$nonBodyContent):1}(n,r))throw Error('The specified element mode is not supported on element: "'+n.getName()+'".');this.element=n,this.elementMode=r,this.name=this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO&&(n.getId()||n.getNameAtt())}else this.elementMode=CKEDITOR.ELEMENT_MODE_NONE;this._={},this.commands={},this.templates={},this.name=this.name||function(){do{var t="editor"+ ++l}while(CKEDITOR.instances[t]);return t}(),this.id=CKEDITOR.tools.getNextId(),this.status="unloaded",this.config=CKEDITOR.tools.prototypedCopy(CKEDITOR.config),this.ui=new CKEDITOR.ui(this),this.focusManager=new CKEDITOR.focusManager(this),this.keystrokeHandler=new CKEDITOR.keystrokeHandler(this),this.on("readOnly",e),this.on("selectionChange",function(t){i(this,t.data.path)}),this.on("activeFilterChange",function(){i(this,this.elementPath(),!0)}),this.on("mode",e),CKEDITOR.dom.selection.setupEditorOptimization(this),this.on("instanceReady",function(){if(this.config.startupFocus){if("end"===this.config.startupFocus){var t=this.createRange();t.selectNodeContents(this.editable()),t.shrink(CKEDITOR.SHRINK_ELEMENT,!0),t.collapse(),this.getSelection().selectRanges([t])}this.focus()}}),CKEDITOR.fire("instanceCreated",null,this),CKEDITOR.add(this),CKEDITOR.tools.setTimeout(function(){this.isDestroyed()||this.isDetached()||o(this,t)},0,this)}function e(){var t,e=this.commands;for(t in e)n(this,e[t])}function n(t,e){e[e.startDisabled||t.readOnly&&!e.readOnly?"disable":e.modes[t.mode]?"enable":"disable"]()}function i(t,e,n){if(e){var i,r,o=t.commands;for(r in o)i=o[r],(n||i.contextSensitive)&&i.refresh(t,e)}}function r(t){if(!(e=t.config.customConfig))return!1;var e=CKEDITOR.getUrl(e),n=c[e]||(c[e]={});return n.fn?(n.fn.call(t,t.config),CKEDITOR.getUrl(t.config.customConfig)!=e&&r(t)||t.fireOnce("customConfigLoaded")):CKEDITOR.scriptLoader.queue(e,function(){n.fn=n.fn||CKEDITOR.editorConfig||function(){},r(t)}),!0}function o(t,e){t.on("customConfigLoaded",function(){if(e){if(e.on)for(var n in e.on)t.on(n,e.on[n]);CKEDITOR.tools.extend(t.config,e,!0),delete t.config.on}n=t.config,t.readOnly=!!n.readOnly||(t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?t.element.is("textarea")?t.element.hasAttribute("disabled")||t.element.hasAttribute("readonly"):t.element.isReadOnly():t.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(t.element.hasAttribute("disabled")||t.element.hasAttribute("readonly"))),t.blockless=t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&!(t.element.is("textarea")||CKEDITOR.dtd[t.element.getName()].p),t.tabIndex=n.tabIndex||t.element&&t.element.getAttribute("tabindex")||0,t.activeEnterMode=t.enterMode=t.blockless?CKEDITOR.ENTER_BR:n.enterMode,t.activeShiftEnterMode=t.shiftEnterMode=t.blockless?CKEDITOR.ENTER_BR:n.shiftEnterMode,n.skin&&(CKEDITOR.skinName=n.skin),t.fireOnce("configLoaded"),t.dataProcessor=new CKEDITOR.htmlDataProcessor(t),t.filter=t.activeFilter=new CKEDITOR.filter(t),s(t)}),e&&null!=e.customConfig&&(t.config.customConfig=e.customConfig),r(t)||t.fireOnce("customConfigLoaded")}function s(t){CKEDITOR.skin.loadPart("editor",function(){!function(t){CKEDITOR.lang.load(t.config.language,t.config.defaultLanguage,function(e,n){var i=t.config.title,r=t.config.applicationTitle;t.langCode=e,t.lang=CKEDITOR.tools.prototypedCopy(n),t.title="string"==typeof i||!1===i?i:[t.lang.editor,t.name].join(", "),t.applicationTitle="string"==typeof r||!1===r?r:[t.lang.application,t.name].join(", "),t.config.contentsLangDirection||(t.config.contentsLangDirection=t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?t.element.getDirection(1):t.lang.dir),t.fire("langLoaded"),function(t){t.getStylesSet(function(e){t.once("loaded",function(){t.fire("stylesSet",{styles:e})},null,null,1),function(t){function e(t){return t?(CKEDITOR.tools.isArray(t)&&(t=t.join(",")),t.replace(/\s/g,"")):""}var n=t.config,i=e(n.plugins),r=e(n.extraPlugins),o=e(n.removePlugins);if(r){var s=new RegExp("(?:^|,)(?:"+r.replace(/,/g,"|")+")(?=,|$)","g");i=i.replace(s,""),i=i+","+r}if(o){var a=new RegExp("(?:^|,)(?:"+o.replace(/,/g,"|")+")(?=,|$)","g");i=i.replace(a,"")}CKEDITOR.env.air&&(i+=",adobeair"),CKEDITOR.plugins.load(i.split(","),function(e){var i=[],r=[],o=[];for(var s in t.plugins=CKEDITOR.tools.extend({},t.plugins,e),e){var l,c=e[s],u=c.lang,h=null,d=c.requires;if(CKEDITOR.tools.isArray(d)&&(d=d.join(",")),d&&(l=d.match(a)))for(;d=l.pop();)CKEDITOR.error("editor-plugin-required",{plugin:d.replace(",",""),requiredBy:s});u&&!t.lang[s]&&(u.split&&(u=u.split(",")),0<=CKEDITOR.tools.indexOf(u,t.langCode)?h=t.langCode:h=(h=t.langCode.replace(/-.*/,""))!=t.langCode&&0<=CKEDITOR.tools.indexOf(u,h)?h:0<=CKEDITOR.tools.indexOf(u,"en")?"en":u[0],c.langEntries&&c.langEntries[h]?(t.lang[s]=c.langEntries[h],h=null):o.push(CKEDITOR.getUrl(c.path+"lang/"+h+".js"))),r.push(h),i.push(c)}CKEDITOR.scriptLoader.load(o,function(){if(!t.isDestroyed()&&!t.isDetached()){for(var e=["beforeInit","init","afterInit"],o=0;o<e.length;o++)for(var s=0;s<i.length;s++){var a=i[s];0===o&&r[s]&&a.lang&&a.langEntries&&(t.lang[a.name]=a.langEntries[r[s]]),a[e[o]]&&a[e[o]](t)}for(t.fireOnce("pluginsLoaded"),n.keystrokes&&t.setKeystroke(t.config.keystrokes),s=0;s<t.config.blockedKeystrokes.length;s++)t.keystrokeHandler.blockedKeystrokes[t.config.blockedKeystrokes[s]]=1;t.status="loaded",t.fireOnce("loaded"),CKEDITOR.fire("instanceLoaded",null,t)}})})}(t)})}(t)})}(t)})}function a(){var t=this.element;if(t&&this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO){var e=this.getData();return this.config.htmlEncodeOutput&&(e=CKEDITOR.tools.htmlEncode(e)),t.is("textarea")?t.setValue(e):t.setHtml(e),!0}return!1}t.prototype=CKEDITOR.editor.prototype,CKEDITOR.editor=t;var l=0,c={};CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{plugins:{detectConflict:function(t,e){for(var n=0;n<e.length;n++){var i=e[n];if(this[i])return CKEDITOR.warn("editor-plugin-conflict",{plugin:t,replacedWith:i}),!0}return!1}},addCommand:function(t,e){e.name=t.toLowerCase();var i=e instanceof CKEDITOR.command?e:new CKEDITOR.command(this,e);return this.mode&&n(this,i),this.commands[t]=i},_attachToForm:function(){function t(t){e.updateElement(),e._.required&&!n.getValue()&&!1===e.fire("required")&&t.data.preventDefault()}var e=this,n=e.element,i=new CKEDITOR.dom.element(n.$.form);n.is("textarea")&&i&&(i.on("submit",t),function(t){return!!(t&&t.call&&t.apply)}(i.$.submit)&&(i.$.submit=CKEDITOR.tools.override(i.$.submit,function(e){return function(){t(),e.apply?e.apply(this):e()}})),e.on("destroy",function(){i.removeListener("submit",t)}))},destroy:function(t){var e=CKEDITOR.filter.instances,n=this;this.fire("beforeDestroy"),!t&&a.call(this),this.editable(null),this.filter&&delete this.filter,CKEDITOR.tools.array.forEach(CKEDITOR.tools.object.keys(e),function(t){t=e[t],n===t.editor&&t.destroy()}),delete this.activeFilter,this.status="destroyed",this.fire("destroy"),this.removeAllListeners(),CKEDITOR.remove(this),CKEDITOR.fire("instanceDestroyed",null,this)},elementPath:function(t){if(!t){if(!(t=this.getSelection()))return null;t=t.getStartElement()}return t?new CKEDITOR.dom.elementPath(t,this.editable()):null},createRange:function(){var t=this.editable();return t?new CKEDITOR.dom.range(t):null},execCommand:function(t,e){var n=this.getCommand(t),i={name:t,commandData:e||{},command:n};return!(!n||n.state==CKEDITOR.TRISTATE_DISABLED||!1===this.fire("beforeCommandExec",i)||(i.returnValue=n.exec(i.commandData),n.async||!1===this.fire("afterCommandExec",i)))&&i.returnValue},getCommand:function(t){return this.commands[t]},getData:function(t){!t&&this.fire("beforeGetData");var e=this._.data;return"string"!=typeof e&&(e=(e=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?e.is("textarea")?e.getValue():e.getHtml():""),e={dataValue:e},!t&&this.fire("getData",e),e.dataValue},getSnapshot:function(){var t=this.fire("getSnapshot");return"string"!=typeof t&&(t=(t=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?t.is("textarea")?t.getValue():t.getHtml():""),t},loadSnapshot:function(t){this.fire("loadSnapshot",t)},setData:function(t,e,n){var i=!0,r=e;e&&"object"==typeof e&&(n=e.internal,r=e.callback,i=!e.noSnapshot),!n&&i&&this.fire("saveSnapshot"),!r&&n||this.once("dataReady",function(t){!n&&i&&this.fire("saveSnapshot"),r&&r.call(t.editor)}),t={dataValue:t},!n&&this.fire("setData",t),this._.data=t.dataValue,!n&&this.fire("afterSetData",t)},setReadOnly:function(t){t=null==t||t,this.readOnly!=t&&(this.readOnly=t,this.keystrokeHandler.blockedKeystrokes[8]=+t,this.editable().setReadOnly(t),this.fire("readOnly"))},insertHtml:function(t,e,n){this.fire("insertHtml",{dataValue:t,mode:e,range:n})},insertText:function(t){this.fire("insertText",t)},insertElement:function(t){this.fire("insertElement",t)},getSelectedHtml:function(t){var e=this.editable(),n=(n=this.getSelection())&&n.getRanges();return e&&n&&0!==n.length?(e=function(t,e){function n(t){var e=t.startContainer,n=t.endContainer,i=e.is&&e.is("tr"),r=e.is&&e.is("td");return t=r&&e.equals(n)&&t.endOffset===e.getChildCount(),e=r&&1===e.getChildCount()&&"img"===e.getChildren().getItem(0).getName(),!!(i||t&&!e)}function i(t){var e=t.startContainer;return e.is("tr")?t.cloneContents():e.clone(!0)}for(var r,o,s,a=new CKEDITOR.dom.documentFragment,l=0;l<t.length;l++){var c=t[l],u=c.startContainer.getAscendant("tr",!0);n(c)?(r||((r=u.getAscendant("table").clone()).append(u.getAscendant({thead:1,tbody:1,tfoot:1}).clone()),a.append(r),r=r.findOne("thead, tbody, tfoot")),o&&o.equals(u)||(o=u,s=u.clone(),r.append(s)),s.append(i(c))):a.append(c.cloneContents())}return r?a:e.getHtmlFromRange(t[0])}(n,e),t?e.getHtml():e):null},extractSelectedHtml:function(t,e){var n,i=this.editable(),r=this.getSelection().getRanges(),o=new CKEDITOR.dom.documentFragment;if(!i||0===r.length)return null;for(n=0;n<r.length;n++)o.append(i.extractHtmlFromRange(r[n],e));return e||this.getSelection().selectRanges([r[0]]),t?o.getHtml():o},focus:function(){this.fire("beforeFocus")},checkDirty:function(){return"ready"==this.status&&this._.previousValue!==this.getSnapshot()},resetDirty:function(){this._.previousValue=this.getSnapshot()},updateElement:function(){return a.call(this)},setKeystroke:function(){for(var t,e,n=this.keystrokeHandler.keystrokes,i=CKEDITOR.tools.isArray(arguments[0])?arguments[0]:[[].slice.call(arguments,0)],r=i.length;r--;)t=i[r],e=0,CKEDITOR.tools.isArray(t)&&(e=t[1],t=t[0]),e?n[t]=e:delete n[t]},getCommandKeystroke:function(t,e){var n="string"==typeof t?this.getCommand(t):t,i=[];if(n){var r=CKEDITOR.tools.object.findKey(this.commands,n),o=this.keystrokeHandler.keystrokes;if(n.fakeKeystroke)i.push(n.fakeKeystroke);else for(var s in o)o[s]===r&&i.push(s)}return e?i:i[0]||null},addFeature:function(t){return this.filter.addFeature(t)},setActiveFilter:function(t){t||(t=this.filter),this.activeFilter!==t&&(this.activeFilter=t,this.fire("activeFilterChange"),t===this.filter?this.setActiveEnterMode(null,null):this.setActiveEnterMode(t.getAllowedEnterMode(this.enterMode),t.getAllowedEnterMode(this.shiftEnterMode,!0)))},setActiveEnterMode:function(t,e){t=t?this.blockless?CKEDITOR.ENTER_BR:t:this.enterMode,e=e?this.blockless?CKEDITOR.ENTER_BR:e:this.shiftEnterMode,this.activeEnterMode==t&&this.activeShiftEnterMode==e||(this.activeEnterMode=t,this.activeShiftEnterMode=e,this.fire("activeEnterModeChange"))},showNotification:function(t){alert(t)},isDetached:function(){return!!this.container&&this.container.isDetached()},isDestroyed:function(){return"destroyed"===this.status}}),CKEDITOR.editor._getEditorElement=function(t){if(!CKEDITOR.env.isCompatible)return null;var e=CKEDITOR.dom.element.get(t);return e?e.getEditor()?(CKEDITOR.error("editor-element-conflict",{editorName:e.getEditor().name}),null):e:(CKEDITOR.error("editor-incorrect-element",{element:t}),null)},CKEDITOR.editor.initializeDelayedEditorCreation=function(t,e,n){if(e.delayIfDetached_callback)return CKEDITOR.warn("editor-delayed-creation",{method:"callback"}),e.delayIfDetached_callback(function(){CKEDITOR[n](t,e),CKEDITOR.warn("editor-delayed-creation-success",{method:"callback"})}),null;var i=void 0===e.delayIfDetached_interval?CKEDITOR.config.delayIfDetached_interval:e.delayIfDetached_interval;CKEDITOR.warn("editor-delayed-creation",{method:"interval - "+i+" ms"});var r=setInterval(function(){t.isDetached()||(clearInterval(r),CKEDITOR[n](t,e),CKEDITOR.warn("editor-delayed-creation-success",{method:"interval - "+i+" ms"}))},i);return function(){clearInterval(r)}},CKEDITOR.editor.shouldDelayEditorCreation=function(t,e){return CKEDITOR.editor.mergeDelayedCreationConfigs(e),e&&e.delayIfDetached&&t.isDetached()},CKEDITOR.editor.mergeDelayedCreationConfigs=function(t){t&&(t.delayIfDetached="boolean"==typeof t.delayIfDetached?t.delayIfDetached:CKEDITOR.config.delayIfDetached,t.delayIfDetached_interval=isNaN(t.delayIfDetached_interval)?CKEDITOR.config.delayIfDetached_interval:t.delayIfDetached_interval,t.delayIfDetached_callback=t.delayIfDetached_callback||CKEDITOR.config.delayIfDetached_callback)}}(),CKEDITOR.ELEMENT_MODE_NONE=0,CKEDITOR.ELEMENT_MODE_REPLACE=1,CKEDITOR.ELEMENT_MODE_APPENDTO=2,CKEDITOR.ELEMENT_MODE_INLINE=3,CKEDITOR.config.delayIfDetached=!1,CKEDITOR.config.delayIfDetached_callback=void 0,CKEDITOR.config.delayIfDetached_interval=50,CKEDITOR.htmlParser=function(){this._={htmlPartsRegex:/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--!?>)|(?:([^\/\s>]+)((?:\s+[\w\-:.]+(?:\s*=\s*?(?:(?:"[^"]*")|(?:'[^']*')|[^\s"'\/>]+))?)*)[\S\s]*?(\/?)>))/g}},function(){var t=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,e={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1};CKEDITOR.htmlParser.prototype={onTagOpen:function(){},onTagClose:function(){},onText:function(){},onCDATA:function(){},onComment:function(){},parse:function(n){for(var i,r,o,s=0;i=this._.htmlPartsRegex.exec(n);)if((r=i.index)>s&&(s=n.substring(s,r),o?o.push(s):this.onText(s)),s=this._.htmlPartsRegex.lastIndex,!(r=i[1])||(r=r.toLowerCase(),o&&CKEDITOR.dtd.$cdata[r]&&(this.onCDATA(o.join("")),o=null),o))if(o)o.push(i[0]);else if(r=i[3]){if(r=r.toLowerCase(),!/="/.test(r)){var a,l={},c=i[4];if(i=!!i[5],c)for(;a=t.exec(c);){var u=a[1].toLowerCase();a=a[2]||a[3]||a[4]||"",l[u]=!a&&e[u]?u:CKEDITOR.tools.htmlDecodeAttr(a)}this.onTagOpen(r,l,i),!o&&CKEDITOR.dtd.$cdata[r]&&(o=[])}}else(r=i[2])&&this.onComment(r);else this.onTagClose(r);n.length>s&&this.onText(n.substring(s,n.length))}}}(),CKEDITOR.htmlParser.basicWriter=CKEDITOR.tools.createClass({$:function(){this._={output:[]}},proto:{openTag:function(t){this._.output.push("<",t)},openTagClose:function(t,e){e?this._.output.push(" />"):this._.output.push(">")},attribute:function(t,e){"string"==typeof e&&(e=CKEDITOR.tools.htmlEncodeAttr(e)),this._.output.push(" ",t,'="',e,'"')},closeTag:function(t){this._.output.push("</",t,">")},text:function(t){this._.output.push(t)},comment:function(t){this._.output.push("\x3c!--",t,"--\x3e")},write:function(t){this._.output.push(t)},reset:function(){this._.output=[],this._.indent=!1},getHtml:function(t){var e=this._.output.join("");return t&&this.reset(),e}}}),CKEDITOR.htmlParser.node=function(){},CKEDITOR.htmlParser.node.prototype={remove:function(){var t=this.parent.children,e=CKEDITOR.tools.indexOf(t,this),n=this.previous,i=this.next;n&&(n.next=i),i&&(i.previous=n),t.splice(e,1),this.parent=null},replaceWith:function(t){var e=this.parent.children,n=CKEDITOR.tools.indexOf(e,this),i=t.previous=this.previous,r=t.next=this.next;i&&(i.next=t),r&&(r.previous=t),e[n]=t,t.parent=this.parent,this.parent=null},insertAfter:function(t){var e=t.parent.children,n=CKEDITOR.tools.indexOf(e,t),i=t.next;e.splice(n+1,0,this),this.next=t.next,this.previous=t,t.next=this,i&&(i.previous=this),this.parent=t.parent},insertBefore:function(t){var e=t.parent.children,n=CKEDITOR.tools.indexOf(e,t);e.splice(n,0,this),this.next=t,(this.previous=t.previous)&&(t.previous.next=this),t.previous=this,this.parent=t.parent},getAscendant:function(t){for(var e="function"==typeof t?t:"string"==typeof t?function(e){return e.name==t}:function(e){return e.name in t},n=this.parent;n&&n.type==CKEDITOR.NODE_ELEMENT;){if(e(n))return n;n=n.parent}return null},wrapWith:function(t){return this.replaceWith(t),t.add(this),t},getIndex:function(){return CKEDITOR.tools.indexOf(this.parent.children,this)},getFilterContext:function(t){return t||{}}},CKEDITOR.htmlParser.comment=function(t){this.value=t,this._={isBlockLike:!1}},CKEDITOR.htmlParser.comment.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_COMMENT,filter:function(t,e){var n=this.value;return(n=t.onComment(e,n,this))?"string"!=typeof n?(this.replaceWith(n),!1):(this.value=n,!0):(this.remove(),!1)},writeHtml:function(t,e){e&&this.filter(e),t.comment(this.value)}}),CKEDITOR.htmlParser.text=function(t){this.value=t,this._={isBlockLike:!1}},CKEDITOR.htmlParser.text.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(t,e){if(!(this.value=t.onText(e,this.value,this)))return this.remove(),!1},writeHtml:function(t,e){e&&this.filter(e),t.text(this.value)}}),CKEDITOR.htmlParser.cdata=function(t){this.value=t},CKEDITOR.htmlParser.cdata.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(t){if((e=this.getAscendant("style"))&&e.getAscendant({math:1,svg:1})){var e=CKEDITOR.htmlParser.fragment.fromHtml(this.value),n=new CKEDITOR.htmlParser.basicWriter;t.applyTo(e),e.writeHtml(n),this.value=n.getHtml()}},writeHtml:function(t){t.write(this.value)}}),CKEDITOR.htmlParser.fragment=function(){this.children=[],this.parent=null,this._={isBlockLike:!0,hasInlineStarted:!1}},function(){function t(t){return!t.attributes["data-cke-survive"]&&("a"==t.name&&t.attributes.href||CKEDITOR.dtd.$removeEmpty[t.name])}var e=CKEDITOR.tools.extend({table:1,ul:1,ol:1,dl:1},CKEDITOR.dtd.table,CKEDITOR.dtd.ul,CKEDITOR.dtd.ol,CKEDITOR.dtd.dl),n={ol:1,ul:1},i=CKEDITOR.tools.extend({},{html:1},CKEDITOR.dtd.html,CKEDITOR.dtd.body,CKEDITOR.dtd.head,{style:1,script:1}),r={ul:"li",ol:"li",dl:"dd",table:"tbody",tbody:"tr",thead:"tr",tfoot:"tr",tr:"td"};CKEDITOR.htmlParser.fragment.fromHtml=function(o,s,a){function l(t){var e;if(0<m.length)for(var n=0;n<m.length;n++){var i=m[n],r=i.name,o=CKEDITOR.dtd[r],s=y.name&&CKEDITOR.dtd[y.name];s&&!s[r]||t&&o&&!o[t]&&CKEDITOR.dtd[t]?r==y.name&&(h(y,y.parent,1),n--):(e||(c(),e=1),(i=i.clone()).parent=y,y=i,m.splice(n,1),n--)}}function c(){for(;v.length;)h(v.shift(),y)}function u(t){if(t._.isBlockLike&&"pre"!=t.name&&"textarea"!=t.name){var e,n=t.children.length,i=t.children[n-1];i&&i.type==CKEDITOR.NODE_TEXT&&((e=CKEDITOR.tools.rtrim(i.value))?i.value=e:t.children.length=n-1)}}function h(e,n,i){n=n||y||g;var r=y;void 0===e.previous&&(d(n,e)&&(y=n,p.onTagOpen(a,{}),e.returnPoint=n=y),u(e),t(e)&&!e.children.length||n.add(e),"pre"==e.name&&(C=!1),"textarea"==e.name&&(b=!1)),e.returnPoint?(y=e.returnPoint,delete e.returnPoint):y=i?n:r}function d(t,e){var n,i;if((t==g||"body"==t.name)&&a&&(!t.name||CKEDITOR.dtd[t.name][a]))return(n=e.attributes&&(i=e.attributes["data-cke-real-element-type"])?i:e.name)&&n in CKEDITOR.dtd.$inline&&!(n in CKEDITOR.dtd.head)&&!e.isOrphan||e.type==CKEDITOR.NODE_TEXT}function f(t,e){return(t in CKEDITOR.dtd.$listItem||t in CKEDITOR.dtd.$tableContent)&&(t==e||"dt"==t&&"dd"==e||"dd"==t&&"dt"==e)}var p=new CKEDITOR.htmlParser,g=s instanceof CKEDITOR.htmlParser.element?s:"string"==typeof s?new CKEDITOR.htmlParser.element(s):new CKEDITOR.htmlParser.fragment,m=[],v=[],y=g,b="textarea"==g.name,C="pre"==g.name;for(p.onTagOpen=function(r,o,s,a){if((o=new CKEDITOR.htmlParser.element(r,o)).isUnknown&&s&&(o.isEmpty=!0),o.isOptionalClose=a,t(o))m.push(o);else{if("pre"==r)C=!0;else{if("br"==r&&C)return void y.add(new CKEDITOR.htmlParser.text("\n"));"textarea"==r&&(b=!0)}if("br"==r)v.push(o);else{for(;a=(s=y.name)?CKEDITOR.dtd[s]||(y._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):i,!(o.isUnknown||y.isUnknown||a[r]);)if(y.isOptionalClose)p.onTagClose(s);else if(r in n&&s in n)(s=(s=y.children)[s.length-1])&&"li"==s.name||h(s=new CKEDITOR.htmlParser.element("li"),y),!o.returnPoint&&(o.returnPoint=y),y=s;else if(r in CKEDITOR.dtd.$listItem&&!f(r,s))p.onTagOpen("li"==r?"ul":"dl",{},0,1);else if(s in e&&!f(r,s))!o.returnPoint&&(o.returnPoint=y),y=y.parent;else{if(s in CKEDITOR.dtd.$inline&&m.unshift(y),!y.parent){o.isOrphan=1;break}h(y,y.parent,1)}l(r),c(),o.parent=y,o.isEmpty?h(o):y=o}}},p.onTagClose=function(t){for(var e=m.length-1;0<=e;e--)if(t==m[e].name)return void m.splice(e,1);for(var n=[],i=[],r=y;r!=g&&r.name!=t;)r._.isBlockLike||i.unshift(r),n.push(r),r=r.returnPoint||r.parent;if(r!=g){for(e=0;e<n.length;e++){var o=n[e];h(o,o.parent)}y=r,r._.isBlockLike?c():!0!==(e=CKEDITOR.config.shiftLineBreaks)&&v.length&&("function"!=typeof e?c():!0!==(e=e(v[v.length-1]))&&(c(),e instanceof CKEDITOR.htmlParser.text&&y.add(e),e instanceof CKEDITOR.htmlParser.element&&h(e,y))),h(r,r.parent),r==y&&(y=y.parent),m=m.concat(i)}"body"==t&&(a=!1)},p.onText=function(t){if(y._.hasInlineStarted&&!v.length||C||b||0!==(t=CKEDITOR.tools.ltrim(t)).length){var n=y.name,o=n?CKEDITOR.dtd[n]||(y._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):i;b||o["#"]||!(n in e)?(c(),l(),C||b||(t=t.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," ")),t=new CKEDITOR.htmlParser.text(t),d(y,t)&&this.onTagOpen(a,{},0,1),y.add(t)):(p.onTagOpen(r[n]||""),p.onText(t))}},p.onCDATA=function(t){y.add(new CKEDITOR.htmlParser.cdata(t))},p.onComment=function(t){c(),l(),y.add(new CKEDITOR.htmlParser.comment(t))},p.parse(o),c();y!=g;)h(y,y.parent,1);return u(g),g},CKEDITOR.htmlParser.fragment.prototype={type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,add:function(t,e){isNaN(e)&&(e=this.children.length);var n=0<e?this.children[e-1]:null;if(n){if(t._.isBlockLike&&n.type==CKEDITOR.NODE_TEXT&&(n.value=CKEDITOR.tools.rtrim(n.value),0===n.value.length))return this.children.pop(),void this.add(t);n.next=t}t.previous=n,t.parent=this,this.children.splice(e,0,t),this._.hasInlineStarted||(this._.hasInlineStarted=t.type==CKEDITOR.NODE_TEXT||t.type==CKEDITOR.NODE_ELEMENT&&!t._.isBlockLike)},filter:function(t,e){e=this.getFilterContext(e),t.onRoot(e,this),this.filterChildren(t,!1,e)},filterChildren:function(t,e,n){if(this.childrenFilteredBy!=t.id)for(n=this.getFilterContext(n),e&&!this.parent&&t.onRoot(n,this),this.childrenFilteredBy=t.id,e=0;e<this.children.length;e++)!1===this.children[e].filter(t,n)&&e--},writeHtml:function(t,e){e&&this.filter(e),this.writeChildrenHtml(t)},writeChildrenHtml:function(t,e,n){var i=this.getFilterContext();for(n&&!this.parent&&e&&e.onRoot(i,this),e&&this.filterChildren(e,!1,i),e=0,i=(n=this.children).length;e<i;e++)n[e].writeHtml(t)},forEach:function(t,e,n){if(!(n||e&&this.type!=e))var i=t(this);if(!1!==i){n=this.children;for(var r=0;r<n.length;r++)(i=n[r]).type==CKEDITOR.NODE_ELEMENT?i.forEach(t,e):e&&i.type!=e||t(i)}},getFilterContext:function(t){return t||{}}},CKEDITOR.config.shiftLineBreaks=!0}(),function(){function t(){this.rules=[]}function e(e,n,i,r){var o,s;for(o in n)(s=e[o])||(s=e[o]=new t),s.add(n[o],i,r)}CKEDITOR.htmlParser.filter=CKEDITOR.tools.createClass({$:function(e){this.id=CKEDITOR.tools.getNextNumber(),this.elementNameRules=new t,this.attributeNameRules=new t,this.elementsRules={},this.attributesRules={},this.textRules=new t,this.commentRules=new t,this.rootRules=new t,e&&this.addRules(e,10)},proto:{addRules:function(t,n){var i;"number"==typeof n?i=n:n&&"priority"in n&&(i=n.priority),"number"!=typeof i&&(i=10),"object"!=typeof n&&(n={}),t.elementNames&&this.elementNameRules.addMany(t.elementNames,i,n),t.attributeNames&&this.attributeNameRules.addMany(t.attributeNames,i,n),t.elements&&e(this.elementsRules,t.elements,i,n),t.attributes&&e(this.attributesRules,t.attributes,i,n),t.text&&this.textRules.add(t.text,i,n),t.comment&&this.commentRules.add(t.comment,i,n),t.root&&this.rootRules.add(t.root,i,n)},applyTo:function(t){t.filter(this)},onElementName:function(t,e){return this.elementNameRules.execOnName(t,e)},onAttributeName:function(t,e){return this.attributeNameRules.execOnName(t,e)},onText:function(t,e,n){return this.textRules.exec(t,e,n)},onComment:function(t,e,n){return this.commentRules.exec(t,e,n)},onRoot:function(t,e){return this.rootRules.exec(t,e)},onElement:function(t,e){for(var n,i=[this.elementsRules["^"],this.elementsRules[e.name],this.elementsRules.$],r=0;3>r;r++)if(n=i[r]){if(!1===(n=n.exec(t,e,this)))return null;if(n&&n!=e)return this.onNode(t,n);if(e.parent&&!e.name)break}return e},onNode:function(t,e){var n=e.type;return n==CKEDITOR.NODE_ELEMENT?this.onElement(t,e):n==CKEDITOR.NODE_TEXT?new CKEDITOR.htmlParser.text(this.onText(t,e.value,e)):n==CKEDITOR.NODE_COMMENT?new CKEDITOR.htmlParser.comment(this.onComment(t,e.value,e)):null},onAttribute:function(t,e,n,i){return(n=this.attributesRules[n])?n.exec(t,i,e,this):i}}}),CKEDITOR.htmlParser.filterRulesGroup=t,t.prototype={add:function(t,e,n){this.rules.splice(this.findIndex(e),0,{value:t,priority:e,options:n})},addMany:function(t,e,n){for(var i=[this.findIndex(e),0],r=0,o=t.length;r<o;r++)i.push({value:t[r],priority:e,options:n});this.rules.splice.apply(this.rules,i)},findIndex:function(t){for(var e=this.rules,n=e.length-1;0<=n&&t<e[n].priority;)n--;return n+1},exec:function(t,e){var n,i,r,o,s=e instanceof CKEDITOR.htmlParser.node||e instanceof CKEDITOR.htmlParser.fragment,a=Array.prototype.slice.call(arguments,1),l=this.rules,c=l.length;for(o=0;o<c;o++)if(s&&(n=e.type,i=e.name),r=l[o],!(t.nonEditable&&!r.options.applyToAll||t.nestedEditable&&r.options.excludeNestedEditable)){if(!1===(r=r.value.apply(null,a))||s&&r&&(r.name!=i||r.type!=n))return r;null!=r&&(a[0]=e=r)}return e},execOnName:function(t,e){for(var n,i=0,r=this.rules,o=r.length;e&&i<o;i++)n=r[i],t.nonEditable&&!n.options.applyToAll||t.nestedEditable&&n.options.excludeNestedEditable||(e=e.replace(n.value[0],n.value[1]));return e}}}(),function(){function t(t,e){function a(t){return t||CKEDITOR.env.needsNbspFiller?new CKEDITOR.htmlParser.text("\xa0"):new CKEDITOR.htmlParser.element("br",{"data-cke-bogus":1})}function l(t,e){return function(r){if(r.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var s,l,u=[],h=n(r);if(h)for(c(h,1)&&u.push(h);h;)o(h)&&(s=i(h))&&c(s)&&((l=i(s))&&!o(l)?u.push(s):(a(d).insertAfter(s),s.remove())),h=h.previous;for(h=0;h<u.length;h++)u[h].remove();(u=!t||!1!==("function"==typeof e?e(r):e))&&((d||CKEDITOR.env.needsBrFiller||r.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT)&&(d||CKEDITOR.env.needsBrFiller||!(7<document.documentMode||r.name in CKEDITOR.dtd.tr||r.name in CKEDITOR.dtd.$listItem))?u=!(u=n(r))||"form"==r.name&&"input"==u.name:u=!1),u&&r.add(a(t))}}}function c(t,e){return!(d&&!CKEDITOR.env.needsBrFiller||t.type!=CKEDITOR.NODE_ELEMENT||"br"!=t.name||t.attributes["data-cke-eol"])||!!(t.type==CKEDITOR.NODE_TEXT&&(n=t.value.match(p))&&(n.index&&(new CKEDITOR.htmlParser.text(t.value.substring(0,n.index)).insertBefore(t),t.value=n[0]),!CKEDITOR.env.needsBrFiller&&d&&(!e||t.parent.name in f)||!d&&((n=t.previous)&&"br"==n.name||!n||o(n))));var n}var u,h={elements:{}},d="html"==e,f=CKEDITOR.tools.extend({},y);for(u in f)"#"in m[u]||delete f[u];for(u in f)h.elements[u]=l(d,t.config.fillEmptyBlocks);return h.root=l(d,!1),h.elements.br=function(t){return function(e){if(e.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var n=e.attributes;if("data-cke-bogus"in n||"data-cke-eol"in n)delete n["data-cke-bogus"];else{for(n=e.next;n&&r(n);)n=n.next;var l=i(e);!n&&o(e.parent)?s(e.parent,a(t)):o(n)&&l&&!o(l)&&a(t).insertBefore(n)}}}}(d),h}function e(t,e){return t!=CKEDITOR.ENTER_BR&&!1!==e&&(t==CKEDITOR.ENTER_DIV?"div":"p")}function n(t){for(t=t.children[t.children.length-1];t&&r(t);)t=t.previous;return t}function i(t){for(t=t.previous;t&&r(t);)t=t.previous;return t}function r(t){return t.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(t.value)||t.type==CKEDITOR.NODE_ELEMENT&&t.attributes["data-cke-bookmark"]}function o(t){return t&&(t.type==CKEDITOR.NODE_ELEMENT&&t.name in y||t.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)}function s(t,e){var n=t.children[t.children.length-1];t.children.push(e),e.parent=t,n&&(n.next=e,e.previous=n)}function a(t){"false"!=(t=t.attributes).contenteditable&&(t["data-cke-editable"]=t.contenteditable?"true":1),t.contenteditable="false"}function l(t){switch((t=t.attributes)["data-cke-editable"]){case"true":t.contenteditable="true";break;case"1":delete t.contenteditable}}function c(t,e){return t.replace(e,function(t,e,n){return 0===t.indexOf("<textarea")&&(t=e+u(n).replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</textarea>"),"<cke:encoded>"+encodeURIComponent(t)+"</cke:encoded>"})}function u(t){return t.replace(/\x3c!--\{cke_protected\}\{C\}([\s\S]+?)--\x3e/g,function(t,e){return decodeURIComponent(e)})}function h(t,e){var n=e._.dataStore;return t.replace(/\x3c!--\{cke_protected\}([\s\S]+?)--\x3e/g,function(t,e){return decodeURIComponent(e)}).replace(/\{cke_protected_(\d+)\}/g,function(t,e){return n&&n[e]||""})}function d(t,e,n){var i=[],r=e.config.protectedSource,o=e._.dataStore||(e._.dataStore={id:1}),s=new RegExp("<\\!--\\{cke_temp_"+n+"(comment)?\\}(\\d*?)--\x3e","g");r=[/<script[\s\S]*?(<\/script>|$)/gi,/<noscript[\s\S]*?<\/noscript>/gi,/<meta[\s\S]*?\/?>/gi].concat(r);t=t.replace(/\x3c!--[\s\S]*?--\x3e/g,function(t){return"\x3c!--{cke_temp_"+n+"comment}"+(i.push(t)-1)+"--\x3e"});for(var a=0;a<r.length;a++)t=t.replace(r[a],function(t){return t=t.replace(s,function(t,e,n){return i[n]}),s.test(t)?t:"\x3c!--{cke_temp_"+n+"}"+(i.push(t)-1)+"--\x3e"});return t=t.replace(s,function(t,e,n){return"\x3c!--"+g+(e?"{C}":"")+encodeURIComponent(i[n]).replace(/--/g,"%2D%2D")+"--\x3e"}),t=t.replace(/<\w+(?:\s+(?:(?:[^\s=>]+\s*=\s*(?:[^'"\s>]+|'[^']*'|"[^"]*"))|[^\s=\/>]+))+\s*\/?>/g,function(t){return t.replace(/\x3c!--\{cke_protected\}([^>]*)--\x3e/g,function(t,e){return o[o.id]=decodeURIComponent(e),"{cke_protected_"+o.id+++"}"})}),t.replace(/<(title|iframe|textarea)([^>]*)>([\s\S]*?)<\/\1>/g,function(t,n,i,r){return"<"+n+i+">"+h(u(r),e)+"</"+n+">"})}var f;CKEDITOR.htmlDataProcessor=function(n){var i,r,o=this;this.editor=n,this.dataFilter=i=new CKEDITOR.htmlParser.filter,this.htmlFilter=r=new CKEDITOR.htmlParser.filter,this.writer=new CKEDITOR.htmlParser.basicWriter,i.addRules(b),i.addRules(C,{applyToAll:!0}),i.addRules(t(n,"data"),{applyToAll:!0}),r.addRules(I),r.addRules(E,{applyToAll:!0}),r.addRules(t(n,"html"),{applyToAll:!0}),n.on("toHtml",function(t){var i;i=(o=window.crypto||window.msCrypto)?o.getRandomValues(new Uint32Array(1))[0]:Math.floor(9e9*Math.random()+1e9);var r,o=(t=t.data).dataValue,s=(o=function(t,e){return t.replace(T,function(t,n,i){return"<"+n+i.replace(w,function(t,n){return x.test(n)&&-1==i.indexOf("data-cke-saved-"+n)?" data-cke-saved-"+t+" data-cke-"+e+"-"+t:t})+">"})}(o=c(o=d(o=f(o),n,i),D),i),o=(o=(o=(o=(o=c(o,_)).replace(O,"$1cke:$2")).replace(R,"<cke:$1$2></cke:$1>")).replace(/(<pre\b[^>]*>)(\r\n|\n)/g,"$1$2$2")).replace(/([^a-z0-9<\-])(on\w{3,})(?!>)/gi,"$1data-cke-"+i+"-$2"),t.context||n.editable().getName());CKEDITOR.env.ie&&9>CKEDITOR.env.version&&"pre"==s&&(s="div",o="<pre>"+o+"</pre>",r=1),(s=n.document.createElement(s)).setHtml("a"+o),o=(o=s.getHtml().substr(1)).replace(new RegExp("data-cke-"+i+"-","ig"),""),r&&(o=o.replace(/^<pre>|<\/pre>$/gi,"")),o=function(t){return t.replace(A,function(t,e){return decodeURIComponent(e)})}(o=o.replace(S,"$1$2")),o=u(o),i=!1!==t.fixForBody&&e(t.enterMode,n.config.autoParagraph),o=CKEDITOR.htmlParser.fragment.fromHtml(o,t.context,i),i&&(!(r=o).children.length&&CKEDITOR.dtd[r.name][i]&&(i=new CKEDITOR.htmlParser.element(i),r.add(i))),t.dataValue=o},null,null,5),n.on("toHtml",function(t){t.data.filter.applyTo(t.data.dataValue,!0,t.data.dontFilter,t.data.enterMode)&&n.fire("dataFiltered")},null,null,6),n.on("toHtml",function(t){t.data.dataValue.filterChildren(o.dataFilter,!0)},null,null,10),n.on("toHtml",function(t){var e=(t=t.data).dataValue,n=new CKEDITOR.htmlParser.basicWriter;e.writeChildrenHtml(n),e=n.getHtml(!0),t.dataValue=function(t){return t.replace(/\x3c!--(?!{cke_protected})[\s\S]+?--\x3e/g,function(t){return"\x3c!--"+g+"{C}"+encodeURIComponent(t).replace(/--/g,"%2D%2D")+"--\x3e"})}(e)},null,null,15),n.on("toDataFormat",function(t){var i=t.data.dataValue;t.data.enterMode!=CKEDITOR.ENTER_BR&&(i=i.replace(/^<br *\/?>/i,"")),t.data.dataValue=CKEDITOR.htmlParser.fragment.fromHtml(i,t.data.context,e(t.data.enterMode,n.config.autoParagraph))},null,null,5),n.on("toDataFormat",function(t){t.data.dataValue.filterChildren(o.htmlFilter,!0)},null,null,10),n.on("toDataFormat",function(t){t.data.filter.applyTo(t.data.dataValue,!1,!0)},null,null,11),n.on("toDataFormat",function(t){var e=t.data.dataValue,i=o.writer;i.reset(),e.writeChildrenHtml(i),e=h(e=u(e=i.getHtml(!0)),n),t.data.dataValue=e},null,null,15)},CKEDITOR.htmlDataProcessor.prototype={toHtml:function(t,e,n,i){var r,o,s,a,l=this.editor;return e&&"object"==typeof e?(r=e.context,n=e.fixForBody,i=e.dontFilter,o=e.filter,s=e.enterMode,a=e.protectedWhitespaces):r=e,r||null===r||(r=l.editable().getName()),l.fire("toHtml",{dataValue:t,context:r,fixForBody:n,dontFilter:i,filter:o||l.filter,enterMode:s||l.enterMode,protectedWhitespaces:a}).dataValue},toDataFormat:function(t,e){var n,i,r;return e&&(n=e.context,i=e.filter,r=e.enterMode),n||null===n||(n=this.editor.editable().getName()),this.editor.fire("toDataFormat",{dataValue:t,filter:i||this.editor.filter,context:n,enterMode:r||this.editor.enterMode}).dataValue},protectSource:function(t){return d(t,this.editor)},unprotectSource:function(t){return h(t,this.editor)},unprotectRealComments:function(t){return u(t)}};var p=/(?:&nbsp;|\xa0)$/,g="{cke_protected}",m=CKEDITOR.dtd,v="caption colgroup col thead tfoot tbody".split(" "),y=CKEDITOR.tools.extend({},m.$blockLimit,m.$block),b={elements:{input:a,textarea:a}},C={attributeNames:[[/^on/,"data-cke-pa-on"],[/^srcdoc/,"data-cke-pa-srcdoc"],[/^data-cke-expando$/,""]],elements:{iframe:function(t){if(t.attributes&&t.attributes.src){var e=t.attributes.src.toLowerCase().replace(/[^a-z]/gi,"");0!==e.indexOf("javascript")&&0!==e.indexOf("data")||(t.attributes["data-cke-pa-src"]=t.attributes.src,delete t.attributes.src)}}}},I={elements:{embed:function(t){if((n=t.parent)&&"object"==n.name){var e=n.attributes.width,n=n.attributes.height;e&&(t.attributes.width=e),n&&(t.attributes.height=n)}},a:function(t){var e=t.attributes;if(!(t.children.length||e.name||e.id||t.attributes["data-cke-saved-name"]))return!1}}},E={elementNames:[[/^cke:/,""],[/^\?xml:namespace$/,""]],attributeNames:[[/^data-cke-(saved|pa)-/,""],[/^data-cke-.*/,""],["hidefocus",""]],elements:{$:function(t){var e=t.attributes;if(e){if(e["data-cke-temp"])return!1;for(var n=["name","href","src"],i=0;i<n.length;i++)"data-cke-saved-"+n[i]in e&&delete e[n[i]]}return t},table:function(t){t.children.slice(0).sort(function(t,e){var n,i;return t.type==CKEDITOR.NODE_ELEMENT&&e.type==t.type&&(n=CKEDITOR.tools.indexOf(v,t.name),i=CKEDITOR.tools.indexOf(v,e.name)),-1<n&&-1<i&&n!=i||(n=t.parent?t.getIndex():-1,i=e.parent?e.getIndex():-1),n>i?1:-1})},param:function(t){return t.children=[],t.isEmpty=!0,t},span:function(t){"Apple-style-span"==t.attributes.class&&delete t.name},html:function(t){delete t.attributes.contenteditable,delete t.attributes.class},body:function(t){delete t.attributes.spellcheck,delete t.attributes.contenteditable},style:function(t){var e=t.children[0];e&&e.value&&(e.value=CKEDITOR.tools.trim(e.value)),t.attributes.type||(t.attributes.type="text/css")},title:function(t){var e=t.children[0];!e&&s(t,e=new CKEDITOR.htmlParser.text),e.value=t.attributes["data-cke-title"]||""},input:l,textarea:l},attributes:{class:function(t){return CKEDITOR.tools.ltrim(t.replace(/(?:^|\s+)cke_[^\s]*/g,""))||!1}}};CKEDITOR.env.ie&&(E.attributes.style=function(t){return t.replace(/(^|;)([^\:]+)/g,function(t){return t.toLowerCase()})});var T=/<(a|area|img|input|source)\b([^>]*)>/gi,w=/([\w-:]+)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+))/gi,x=/^(href|src|name)$/i,_=/(?:<style(?=[ >])[^>]*>[\s\S]*?<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,D=/(<textarea(?=[ >])[^>]*>)([\s\S]*?)(?:<\/textarea>)/gi,A=/<cke:encoded>([^<]*)<\/cke:encoded>/gi,O=/(<\/?)((?:object|embed|param|html|body|head|title)([\s][^>]*)?>)/gi,S=/(<\/?)cke:((?:html|body|head|title)[^>]*>)/gi,R=/<cke:(param|embed)([^>]*?)\/?>(?!\s*<\/cke:\1)/gi;f=function(){function t(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(i.lastIndex=0,i.test(e))return!0}return!1}function e(t){return CKEDITOR.tools.array.reduce(t.split(""),function(t,e){var i=e.toLowerCase(),r=e.toUpperCase(),o=n(i);return i!==r&&(o+="|"+n(r)),t+"("+o+")"},"")}function n(t){var e,n=(e=t.charCodeAt(0)).toString(16);for(var i in e={htmlCode:"&#"+e+";?",hex:"&#x0*"+n+";?",entity:{"<":"&lt;",">":"&gt;",":":"&colon;"}[t]})e[i]&&(t+="|"+e[i]);return t}var i=[new RegExp("("+e("<cke:encoded>")+"(.*?)"+e("</cke:encoded>")+")|("+e("<")+e("/")+"?"+e("cke:encoded>")+")","gi"),new RegExp("(("+e("{cke_protected")+")(_[0-9]*)?"+e("}")+")","gi"),/<!(?:\s*-\s*){2,3}!?\s*>/g];return function(e){for(;t(i,e);)for(var n=i,r=0;r<n.length;r++)e=e.replace(n[r],"");return e}}()}(),CKEDITOR.htmlParser.element=function(t,e){this.name=t,this.attributes=e||{},this.children=[];var n=t||"",i=n.match(/^cke:(.*)/);i&&(n=i[1]),n=!!(CKEDITOR.dtd.$nonBodyContent[n]||CKEDITOR.dtd.$block[n]||CKEDITOR.dtd.$listItem[n]||CKEDITOR.dtd.$tableContent[n]||CKEDITOR.dtd.$nonEditable[n]||"br"==n),this.isEmpty=!!CKEDITOR.dtd.$empty[t],this.isUnknown=!CKEDITOR.dtd[t],this._={isBlockLike:n,hasInlineStarted:this.isEmpty||!n}},CKEDITOR.htmlParser.cssStyle=function(t){var e={};return((t instanceof CKEDITOR.htmlParser.element?t.attributes.style:t)||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(t,n,i){"font-family"==n&&(i=i.replace(/["']/g,"")),e[n.toLowerCase()]=i}),{rules:e,populate:function(t){var e=this.toString();e&&(t instanceof CKEDITOR.dom.element?t.setAttribute("style",e):t instanceof CKEDITOR.htmlParser.element?t.attributes.style=e:t.style=e)},toString:function(){var t,n=[];for(t in e)e[t]&&n.push(t,":",e[t],";");return n.join("")}}},function(){var t=function(t,e){return(t=t[0])<(e=e[0])?-1:t>e?1:0},e=CKEDITOR.htmlParser.fragment.prototype;CKEDITOR.htmlParser.element.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_ELEMENT,add:e.add,clone:function(){return new CKEDITOR.htmlParser.element(this.name,this.attributes)},filter:function(t,e){var n,i,r,o,s=this;for(e=s.getFilterContext(e),s.parent||t.onRoot(e,s);;){if(n=s.name,!(i=t.onElementName(e,n)))return this.remove(),!1;if(s.name=i,!(s=t.onElement(e,s)))return this.remove(),!1;if(s!==this)return this.replaceWith(s),!1;if(s.name==n)break;if(s.type!=CKEDITOR.NODE_ELEMENT)return this.replaceWith(s),!1;if(!s.name)return this.replaceWithChildren(),!1}for(r in n=s.attributes){for(i=n[r];;){if(!(o=t.onAttributeName(e,r))){delete n[r];break}if(o==r)break;delete n[r],r=o}o&&(!1===(i=t.onAttribute(e,s,o,i))?delete n[o]:n[o]=i)}return s.isEmpty||this.filterChildren(t,!1,e),!0},filterChildren:e.filterChildren,writeHtml:function(e,n){n&&this.filter(n);var i,r,o=this.name,s=[],a=this.attributes;for(i in e.openTag(o,a),a)s.push([i,a[i]]);for(e.sortAttributes&&s.sort(t),i=0,r=s.length;i<r;i++)a=s[i],e.attribute(a[0],a[1]);e.openTagClose(o,this.isEmpty),this.writeChildrenHtml(e),this.isEmpty||e.closeTag(o)},writeChildrenHtml:e.writeChildrenHtml,replaceWithChildren:function(){for(var t=this.children,e=t.length;e;)t[--e].insertAfter(this);this.remove()},forEach:e.forEach,getFirst:function(t){if(!t)return this.children.length?this.children[0]:null;"function"!=typeof t&&(t=function(t){return function(e){return e.type==CKEDITOR.NODE_ELEMENT&&("string"==typeof t?e.name==t:e.name in t)}}(t));for(var e=0,n=this.children.length;e<n;++e)if(t(this.children[e]))return this.children[e];return null},getHtml:function(){var t=new CKEDITOR.htmlParser.basicWriter;return this.writeChildrenHtml(t),t.getHtml()},setHtml:function(t){for(var e=0,n=(t=this.children=CKEDITOR.htmlParser.fragment.fromHtml(t).children).length;e<n;++e)t[e].parent=this},getOuterHtml:function(){var t=new CKEDITOR.htmlParser.basicWriter;return this.writeHtml(t),t.getHtml()},split:function(t){for(var e=this.children.splice(t,this.children.length-t),n=this.clone(),i=0;i<e.length;++i)e[i].parent=n;return n.children=e,e[0]&&(e[0].previous=null),0<t&&(this.children[t-1].next=null),this.parent.add(n,this.getIndex()+1),n},find:function(t,e){void 0===e&&(e=!1);var n,i=[];for(n=0;n<this.children.length;n++){var r=this.children[n];("function"==typeof t&&t(r)||"string"==typeof t&&r.name===t)&&i.push(r),e&&r.find&&(i=i.concat(r.find(t,e)))}return i},findOne:function(t,e){var n=null,i=CKEDITOR.tools.array.find(this.children,function(i){var r="function"==typeof t?t(i):i.name===t;return r||!e?r:(i.children&&i.findOne&&(n=i.findOne(t,!0)),!!n)});return n||i||null},addClass:function(t){if(!this.hasClass(t)){var e=this.attributes.class||"";this.attributes.class=e+(e?" ":"")+t}},removeClass:function(t){var e=this.attributes.class;e&&((e=CKEDITOR.tools.trim(e.replace(new RegExp("(?:\\s+|^)"+t+"(?:\\s+|$)")," ")))?this.attributes.class=e:delete this.attributes.class)},hasClass:function(t){var e=this.attributes.class;return!!e&&new RegExp("(?:^|\\s)"+t+"(?=\\s|$)").test(e)},getFilterContext:function(t){var e=[];if(t||(t={nonEditable:!1,nestedEditable:!1}),t.nonEditable||"false"!=this.attributes.contenteditable?t.nonEditable&&!t.nestedEditable&&"true"==this.attributes.contenteditable&&e.push("nestedEditable",!0):e.push("nonEditable",!0),e.length){t=CKEDITOR.tools.copy(t);for(var n=0;n<e.length;n+=2)t[e[n]]=e[n+1]}return t}},!0)}(),function(){var t=/{([^}]+)}/g;CKEDITOR.template=function(t){this.source="function"==typeof t?t:String(t)},CKEDITOR.template.prototype.output=function(e,n){var i=("function"==typeof this.source?this.source(e):this.source).replace(t,function(t,n){return void 0!==e[n]?e[n]:t});return n?n.push(i):i}}(),delete CKEDITOR.loadFullCore,CKEDITOR.instances={},CKEDITOR.document=new CKEDITOR.dom.document(document),CKEDITOR.add=function(t){function e(){CKEDITOR.currentInstance==t&&(CKEDITOR.currentInstance=null,CKEDITOR.fire("currentInstance"))}CKEDITOR.instances[t.name]=t,t.on("focus",function(){CKEDITOR.currentInstance!=t&&(CKEDITOR.currentInstance=t,CKEDITOR.fire("currentInstance"))}),t.on("blur",e),t.on("destroy",e),CKEDITOR.fire("instance",null,t)},CKEDITOR.remove=function(t){delete CKEDITOR.instances[t.name]},function(){var t={};CKEDITOR.addTemplate=function(e,n){var i=t[e];return i||(i={name:e,source:n},CKEDITOR.fire("template",i),t[e]=new CKEDITOR.template(i.source))},CKEDITOR.getTemplate=function(e){return t[e]}}(),function(){var t=[];CKEDITOR.addCss=function(e){t.push(e)},CKEDITOR.getCss=function(){return t.join("\n")}}(),CKEDITOR.on("instanceDestroyed",function(){CKEDITOR.tools.isEmpty(this.instances)&&CKEDITOR.fire("reset")}),CKEDITOR.TRISTATE_ON=1,CKEDITOR.TRISTATE_OFF=2,CKEDITOR.TRISTATE_DISABLED=0,CKEDITOR.inline=function(t,e){if(!(t=CKEDITOR.editor._getEditorElement(t)))return null;if(CKEDITOR.editor.shouldDelayEditorCreation(t,e))return CKEDITOR.editor.initializeDelayedEditorCreation(t,e,"inline");var n=t.is("textarea")?t:null,i=n?n.getValue():t.getHtml(),r=new CKEDITOR.editor(e,t,CKEDITOR.ELEMENT_MODE_INLINE);return n?(r.setData(i,null,!0),(t=CKEDITOR.dom.element.createFromHtml('<div contenteditable="'+!!r.readOnly+'" class="cke_textarea_inline">'+n.getValue()+"</div>",CKEDITOR.document)).insertAfter(n),n.hide(),n.$.form&&r._attachToForm()):(e&&void 0!==e.readOnly&&!e.readOnly&&t.setAttribute("contenteditable","true"),r.setData(i,null,!0)),r.on("loaded",function(){r.fire("uiReady"),r.editable(t),r.container=t,r.ui.contentsElement=t,r.setData(r.getData(1)),r.resetDirty(),r.fire("contentDom"),r.mode="wysiwyg",r.fire("mode"),r.status="ready",r.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,r)},null,null,1e4),r.on("destroy",function(){var t=r.container;n&&t&&(t.clearCustomData(),t.remove()),n&&n.show(),r.element.clearCustomData(),delete r.element}),r},CKEDITOR.inlineAll=function(){var t,e,n;for(n in CKEDITOR.dtd.$editable)for(var i=CKEDITOR.document.getElementsByTag(n),r=0,o=i.count();r<o;r++)"true"!=(t=i.getItem(r)).getAttribute("contenteditable")||t.getEditor()||(e={element:t,config:{}},!1!==CKEDITOR.fire("inline",e)&&CKEDITOR.inline(t,e.config))},CKEDITOR.domReady(function(){!CKEDITOR.disableAutoInline&&CKEDITOR.inlineAll()}),CKEDITOR.replaceClass="ckeditor",function(){function t(t,n,i,r){if(!(t=CKEDITOR.editor._getEditorElement(t)))return null;if(CKEDITOR.editor.shouldDelayEditorCreation(t,n))return CKEDITOR.editor.initializeDelayedEditorCreation(t,n,"replace");var o=new CKEDITOR.editor(n,t,r);return r==CKEDITOR.ELEMENT_MODE_REPLACE&&(t.setStyle("visibility","hidden"),o._.required=t.hasAttribute("required"),t.removeAttribute("required")),i&&o.setData(i,null,!0),o.on("loaded",function(){o.isDestroyed()||o.isDetached()||(function(t){var e=t.name,n=t.element,i=t.elementMode,r=t.fire("uiSpace",{space:"top",html:""}).html,o=t.fire("uiSpace",{space:"bottom",html:""}).html,s=new CKEDITOR.template('<{outerEl} id="cke_{name}" class="{id} cke cke_reset cke_chrome cke_editor_{name} cke_{langDir} '+CKEDITOR.env.cssClass+'"  dir="{langDir}" lang="{langCode}" role="application"'+(t.applicationTitle?' aria-labelledby="cke_{name}_arialbl"':"")+">"+(t.applicationTitle?'<span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span>':"")+'<{outerEl} class="cke_inner cke_reset" role="presentation">{topHtml}<{outerEl} id="{contentId}" class="cke_contents cke_reset" role="presentation"></{outerEl}>{bottomHtml}</{outerEl}></{outerEl}>');e=CKEDITOR.dom.element.createFromHtml(s.output({id:t.id,name:e,langDir:t.lang.dir,langCode:t.langCode,voiceLabel:t.applicationTitle,topHtml:r?'<span id="'+t.ui.spaceId("top")+'" class="cke_top cke_reset_all" role="presentation" style="height:auto">'+r+"</span>":"",contentId:t.ui.spaceId("contents"),bottomHtml:o?'<span id="'+t.ui.spaceId("bottom")+'" class="cke_bottom cke_reset_all" role="presentation">'+o+"</span>":"",outerEl:CKEDITOR.env.ie?"span":"div"}));i==CKEDITOR.ELEMENT_MODE_REPLACE?(n.hide(),e.insertAfter(n)):n.append(e),t.container=e,t.ui.contentsElement=t.ui.space("contents"),r&&t.ui.space("top").unselectable(),o&&t.ui.space("bottom").unselectable(),n=t.config.width,i=t.config.height,n&&e.setStyle("width",CKEDITOR.tools.cssLength(n)),i&&t.ui.space("contents").setStyle("height",CKEDITOR.tools.cssLength(i)),e.disableContextMenu(),CKEDITOR.env.webkit&&e.on("focus",function(){t.focus()}),t.fireOnce("uiReady")}(o),r==CKEDITOR.ELEMENT_MODE_REPLACE&&o.config.autoUpdateElement&&t.$.form&&o._attachToForm(),o.setMode(o.config.startupMode,function(){o.resetDirty(),o.status="ready",o.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,o)}))}),o.on("destroy",e),o}function e(){var t=this.container,e=this.element;t&&(t.clearCustomData(),t.remove()),e&&(e.clearCustomData(),this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(e.show(),this._.required&&e.setAttribute("required","required")),delete this.element)}CKEDITOR.replace=function(e,n){return t(e,n,null,CKEDITOR.ELEMENT_MODE_REPLACE)},CKEDITOR.appendTo=function(e,n,i){return t(e,n,i,CKEDITOR.ELEMENT_MODE_APPENDTO)},CKEDITOR.replaceAll=function(){for(var t=document.getElementsByTagName("textarea"),e=0;e<t.length;e++){var n=null,i=t[e];if(i.name||i.id){if("string"==typeof arguments[0]){if(!new RegExp("(?:^|\\s)"+arguments[0]+"(?:$|\\s)").test(i.className))continue}else if("function"==typeof arguments[0]&&(n={},!1===arguments[0](i,n)))continue;this.replace(i,n)}}},CKEDITOR.editor.prototype.addMode=function(t,e){(this._.modes||(this._.modes={}))[t]=e},CKEDITOR.editor.prototype.setMode=function(t,e){var n=this,i=this._.modes;if(t!=n.mode&&i&&i[t]){if(n.fire("beforeSetMode",t),n.mode){var r,o=n.checkDirty(),s=(i=n._.previousModeData,0);n.fire("beforeModeUnload"),n.editable(0),n._.previousMode=n.mode,n._.previousModeData=r=n.getData(1),"source"==n.mode&&i==r&&(n.fire("lockSnapshot",{forceUpdate:!0}),s=1),n.ui.space("contents").setHtml(""),n.mode=""}else n._.previousModeData=n.getData(1);this._.modes[t](function(){n.mode=t,void 0!==o&&!o&&n.resetDirty(),s?n.fire("unlockSnapshot"):"wysiwyg"==t&&n.fire("saveSnapshot"),setTimeout(function(){n.isDestroyed()||n.isDetached()||(n.fire("mode"),e&&e.call(n))},0)})}},CKEDITOR.editor.prototype.resize=function(t,e,n,i){var r=this.container,o=this.ui.space("contents"),s=CKEDITOR.env.webkit&&this.document&&this.document.getWindow().$.frameElement;i=i?this.container.getFirst(function(t){return t.type==CKEDITOR.NODE_ELEMENT&&t.hasClass("cke_inner")}):r,(t||0===t)&&(t=CKEDITOR.tools.convertToPx(CKEDITOR.tools.cssLength(t))),i.setSize("width",t,!0),s&&(s.style.width="1%"),e=CKEDITOR.tools.convertToPx(CKEDITOR.tools.cssLength(e));var a=(i.$.offsetHeight||0)-(o.$.clientHeight||0);r=Math.max(e-(n?0:a),0);e=n?e+a:e,o.setStyle("height",CKEDITOR.tools.cssLength(r)),s&&(s.style.width="100%"),this.fire("resize",{outerHeight:e,contentsHeight:r,outerWidth:t||i.getSize("width")})},CKEDITOR.editor.prototype.getResizable=function(t){return t?this.ui.space("contents"):this.container},CKEDITOR.domReady(function(){CKEDITOR.replaceClass&&CKEDITOR.replaceAll(CKEDITOR.replaceClass)})}(),CKEDITOR.config.startupMode="wysiwyg",function(){function t(t){var e,i=t.editor,r=t.data.path,o=r.blockLimit,a=t.data.selection,l=a.getRanges()[0];(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller)&&(a=function(t,e){if(t.isFake)return 0;var i=e.block||e.blockLimit,r=i&&i.getLast(n);if(!(!i||!i.isBlockBoundary()||r&&r.type==CKEDITOR.NODE_ELEMENT&&r.isBlockBoundary()||i.is("pre")||i.getBogus()))return i}(a,r))&&(a.appendBogus(),e=CKEDITOR.env.ie&&!CKEDITOR.env.edge||CKEDITOR.env.edge&&i._.previousActive),s(i,r.block,o)&&l.collapsed&&!l.getCommonAncestor().isReadOnly()&&((r=l.clone()).enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),(o=new CKEDITOR.dom.walker(r)).guard=function(t){return!n(t)||t.type==CKEDITOR.NODE_COMMENT||t.isReadOnly()},!o.checkForward()||r.checkStartOfBlock()&&r.checkEndOfBlock())&&(i=l.fixBlock(!0,i.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p"),CKEDITOR.env.needsBrFiller||(i=i.getFirst(n))&&i.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(i.getText()).match(/^(?:&nbsp;|\xa0)$/)&&i.remove(),e=1,t.cancel()),e&&l.select()}function e(t){var e=t.data.getTarget();e.is("input")&&("submit"!=(e=e.getAttribute("type"))&&"reset"!=e||t.data.preventDefault())}function n(t){return h(t)&&d(t)}function i(t){return!!t.getRanges()[0].startPath().contains({table:1,ul:1,ol:1,dl:1})}function r(t){function e(t){var e={table:1,ul:1,ol:1,dl:1};return function(i,o){if(o&&i.type==CKEDITOR.NODE_ELEMENT&&i.is(e)&&(r=i),!(o||!n(i)||t&&p(i)))return!1}}var r,o=t.getRanges()[0],s=t.root;return i(t)&&((t=o.clone()).collapse(1),t.setStartAt(s,CKEDITOR.POSITION_AFTER_START),(s=new CKEDITOR.dom.walker(t)).guard=e(),s.checkBackward(),r)?((t=o.clone()).collapse(),t.setEndAt(r,CKEDITOR.POSITION_AFTER_END),(s=new CKEDITOR.dom.walker(t)).guard=e(!0),r=!1,s.checkForward(),r):null}function o(t){return t.block.getParent().getChildCount()}function s(t,e,n){return!1!==t.config.autoParagraph&&t.activeEnterMode!=CKEDITOR.ENTER_BR&&(t.editable().equals(n)&&!e||e&&"true"==e.getAttribute("contenteditable"))}function a(t){return t.activeEnterMode!=CKEDITOR.ENTER_BR&&!1!==t.config.autoParagraph&&(t.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p")}function l(t){t&&t.isEmptyInlineRemoveable()&&t.remove()}function c(t){var e=t.editor;e.getSelection().scrollIntoView(),setTimeout(function(){e.fire("saveSnapshot")},0)}function u(t,e,n){var i=t.getCommonAncestor(e);for(e=t=n?e:t;(t=t.getParent())&&!i.equals(t)&&1==t.getChildCount();)e=t;e.remove()}var h,d,f,p,g,m,v,y,b,C,I={ul:1,ol:1,dl:1};CKEDITOR.editable=CKEDITOR.tools.createClass({base:CKEDITOR.dom.element,$:function(t,e){this.base(e.$||e),this.editor=t,this.status="unloaded",this.hasFocus=!1,this.setup()},proto:{focus:function(){var t;if(CKEDITOR.env.webkit&&!this.hasFocus&&(t=this.editor._.previousActive||this.getDocument().getActive(),this.contains(t)))t.focus();else{CKEDITOR.env.edge&&14<CKEDITOR.env.version&&!this.hasFocus&&this.getDocument().equals(CKEDITOR.document)&&(this.editor._.previousScrollTop=this.$.scrollTop);try{if(!CKEDITOR.env.ie||CKEDITOR.env.edge&&14<CKEDITOR.env.version||!this.getDocument().equals(CKEDITOR.document))if(CKEDITOR.env.chrome){var e=this.$.scrollTop;this.$.focus(),this.$.scrollTop=e}else this.$.focus();else this.$.setActive()}catch(s){if(!CKEDITOR.env.ie)throw s}CKEDITOR.env.safari&&!this.isInline()&&((t=CKEDITOR.document.getActive()).equals(this.getWindow().getFrame())||this.getWindow().focus())}},on:function(t,e){var n=Array.prototype.slice.call(arguments,0);return CKEDITOR.env.ie&&/^focus|blur$/.exec(t)&&(t="focus"==t?"focusin":"focusout",e=function(t,e){return function(n){var i=n.data.$.toElement||n.data.$.fromElement||n.data.$.relatedTarget;(i=i&&i.nodeType==CKEDITOR.NODE_ELEMENT?new CKEDITOR.dom.element(i):null)&&(e.equals(i)||e.contains(i))||t.call(this,n)}}(e,this),n[0]=t,n[1]=e),CKEDITOR.dom.element.prototype.on.apply(this,n)},attachListener:function(t){!this._.listeners&&(this._.listeners=[]);var e=Array.prototype.slice.call(arguments,1);e=t.on.apply(t,e);return this._.listeners.push(e),e},clearListeners:function(){var t=this._.listeners;try{for(;t.length;)t.pop().removeListener()}catch(l){}},restoreAttrs:function(){var t,e,n=this._.attrChanges;for(e in n)n.hasOwnProperty(e)&&(null!==(t=n[e])?this.setAttribute(e,t):this.removeAttribute(e))},attachClass:function(t){var e=this.getCustomData("classes");this.hasClass(t)||(!e&&(e=[]),e.push(t),this.setCustomData("classes",e),this.addClass(t))},changeAttr:function(t,e){var n=this.getAttribute(t);e!==n&&(!this._.attrChanges&&(this._.attrChanges={}),t in this._.attrChanges||(this._.attrChanges[t]=n),this.setAttribute(t,e))},insertText:function(t){this.editor.focus(),this.insertHtml(this.transformPlainTextToHtml(t),"text")},transformPlainTextToHtml:function(t){var e=this.editor.getSelection().getStartElement().hasAscendant("pre",!0)?CKEDITOR.ENTER_BR:this.editor.activeEnterMode;return CKEDITOR.tools.transformPlainTextToHtml(t,e)},insertHtml:function(t,e,n){var i=this.editor;i.focus(),i.fire("saveSnapshot"),n||(n=i.getSelection().getRanges()[0]),m(this,e||"html",t,n),n.select(),c(this),this.editor.fire("afterInsertHtml",{})},insertHtmlIntoRange:function(t,e,n){m(this,n||"html",t,e),this.editor.fire("afterInsertHtml",{intoRange:e})},insertElement:function(t,e){(r=this.editor).focus(),r.fire("saveSnapshot");var i=r.activeEnterMode,r=r.getSelection(),o=t.getName();o=CKEDITOR.dtd.$block[o];e||(e=r.getRanges()[0]),this.insertElementIntoRange(t,e)&&(e.moveToPosition(t,CKEDITOR.POSITION_AFTER_END),o&&((o=t.getNext(function(t){return n(t)&&!p(t)}))&&o.type==CKEDITOR.NODE_ELEMENT&&o.is(CKEDITOR.dtd.$block)?o.getDtd()["#"]?e.moveToElementEditStart(o):e.moveToElementEditEnd(t):o||i==CKEDITOR.ENTER_BR||(o=e.fixBlock(!0,i==CKEDITOR.ENTER_DIV?"div":"p"),e.moveToElementEditStart(o)))),r.selectRanges([e]),c(this)},insertElementIntoSelection:function(t){this.insertElement(t)},insertElementIntoRange:function(t,e){var n,i,r=this.editor,o=r.config.enterMode,s=t.getName(),a=CKEDITOR.dtd.$block[s];if(e.checkReadOnly())return!1;if(e.deleteContents(1),e.startContainer.type==CKEDITOR.NODE_ELEMENT&&(e.startContainer.is({tr:1,table:1,tbody:1,thead:1,tfoot:1})?v(e):e.startContainer.is(CKEDITOR.dtd.$list)&&y(e)),a)for(;(n=e.getCommonAncestor(0,1))&&(i=CKEDITOR.dtd[n.getName()])&&(!i||!i[s]);)if(n.getName()in CKEDITOR.dtd.span){a=e.splitElement(n);var c=e.createBookmark();l(n),l(a),e.moveToBookmark(c)}else e.checkStartOfBlock()&&e.checkEndOfBlock()?(e.setStartBefore(n),e.collapse(!0),n.remove()):e.splitBlock(o==CKEDITOR.ENTER_DIV?"div":"p",r.editable());return e.insertNode(t),!0},setData:function(t,e){e||(t=this.editor.dataProcessor.toHtml(t)),this.setHtml(t),this.fixInitialSelection(),"unloaded"==this.status&&(this.status="ready"),this.editor.fire("dataReady")},getData:function(t){var e=this.getHtml();return t||(e=this.editor.dataProcessor.toDataFormat(e)),e},setReadOnly:function(t){this.setAttribute("contenteditable",String(!t)),this.setAttribute("aria-readonly",String(t))},detach:function(){this.status="detached",this.editor.setData(this.editor.getData(),{internal:!0}),this.clearListeners();try{this._.cleanCustomData()}catch(n){if(!CKEDITOR.env.ie||-2146828218!==n.number)throw n}this.editor.fire("contentDomUnload"),delete this.editor.document,delete this.editor.window,delete this.editor},isInline:function(){return this.getDocument().equals(CKEDITOR.document)},fixInitialSelection:function(){function t(){var t,n=e.getDocument().$,i=n.getSelection();t:if(i.anchorNode&&i.anchorNode==e.$)t=!0;else{if(CKEDITOR.env.webkit&&(t=e.getDocument().getActive())&&t.equals(e)&&!i.anchorNode){t=!0;break t}t=void 0}t&&((t=new CKEDITOR.dom.range(e)).moveToElementEditStart(e),(n=n.createRange()).setStart(t.startContainer.$,t.startOffset),n.collapse(!0),i.removeAllRanges(),i.addRange(n))}var e=this;CKEDITOR.env.ie&&(9>CKEDITOR.env.version||CKEDITOR.env.quirks)?this.hasFocus&&(this.focus(),function(){var t=e.getDocument().$,n=t.selection,i=e.getDocument().getActive();"None"==n.type&&i.equals(e)&&(n=new CKEDITOR.dom.range(e),t=t.body.createTextRange(),n.moveToElementEditStart(e),(n=n.startContainer).type!=CKEDITOR.NODE_ELEMENT&&(n=n.getParent()),t.moveToElementText(n.$),t.collapse(!0),t.select())}()):this.hasFocus?(this.focus(),t()):this.once("focus",function(){t()},null,null,-999)},getHtmlFromRange:function(t){return t.collapsed?new CKEDITOR.dom.documentFragment(t.document):(t={doc:this.getDocument(),range:t.clone()},b.eol.detect(t,this),b.bogus.exclude(t),b.cell.shrink(t),t.fragment=t.range.cloneContents(),b.tree.rebuild(t,this),b.eol.fix(t,this),new CKEDITOR.dom.documentFragment(t.fragment.$))},extractHtmlFromRange:function(t,e){var n=C,i={range:t,doc:t.document},r=this.getHtmlFromRange(t);if(t.collapsed)return t.optimize(),r;if(t.enlarge(CKEDITOR.ENLARGE_INLINE,1),n.table.detectPurge(i),i.bookmark=t.createBookmark(),delete i.range,(s=this.editor.createRange()).moveToPosition(i.bookmark.startNode,CKEDITOR.POSITION_BEFORE_START),i.targetBookmark=s.createBookmark(),n.list.detectMerge(i,this),n.table.detectRanges(i,this),n.block.detectMerge(i,this),i.tableContentsRanges?(n.table.deleteRanges(i),t.moveToBookmark(i.bookmark),i.range=t):(t.moveToBookmark(i.bookmark),i.range=t,t.extractContents(n.detectExtractMerge(i))),t.moveToBookmark(i.targetBookmark),t.optimize(),n.fixUneditableRangePosition(t),n.list.merge(i,this),n.table.purge(i,this),n.block.merge(i,this),e){if(n=t.startPath(),i=t.checkStartOfBlock()&&t.checkEndOfBlock()&&n.block&&!t.root.equals(n.block)){t:{var o,s=0;if(i=n.block.getElementsByTag("span"))for(;o=i.getItem(s++);)if(!d(o)){i=!0;break t}i=!1}i=!i}i&&(t.moveToPosition(n.block,CKEDITOR.POSITION_BEFORE_START),n.block.remove())}else n.autoParagraph(this.editor,t),f(t.startContainer)&&t.startContainer.appendBogus();return t.startContainer.mergeSiblings(),r},setup:function(){var t=this.editor;if(this.attachListener(t,"beforeGetData",function(){var e=this.getData();this.is("textarea")||!1!==t.config.ignoreEmptyParagraph&&(e=e.replace(g,function(t,e){return e})),t.setData(e,null,1)},this),this.attachListener(t,"getSnapshot",function(t){t.data=this.getData(1)},this),this.attachListener(t,"afterSetData",function(){this.setData(t.getData(1))},this),this.attachListener(t,"loadSnapshot",function(t){this.setData(t.data,1)},this),this.attachListener(t,"beforeFocus",function(){var e=t.getSelection();(e=e&&e.getNative())&&"Control"==e.type||this.focus()},this),this.attachListener(t,"insertHtml",function(t){this.insertHtml(t.data.dataValue,t.data.mode,t.data.range)},this),this.attachListener(t,"insertElement",function(t){this.insertElement(t.data)},this),this.attachListener(t,"insertText",function(t){this.insertText(t.data)},this),this.setReadOnly(t.readOnly),this.attachClass("cke_editable"),t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?this.attachClass("cke_editable_inline"):t.elementMode!=CKEDITOR.ELEMENT_MODE_REPLACE&&t.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO||this.attachClass("cke_editable_themed"),this.attachClass("cke_contents_"+t.config.contentsLangDirection),t.keystrokeHandler.blockedKeystrokes[8]=+t.readOnly,t.keystrokeHandler.attach(this),this.on("blur",function(){this.hasFocus=!1},null,null,-1),this.on("focus",function(){this.hasFocus=!0},null,null,-1),CKEDITOR.env.webkit&&this.on("scroll",function(){t._.previousScrollTop=t.editable().$.scrollTop},null,null,-1),CKEDITOR.env.edge&&14<CKEDITOR.env.version){var s=function(){var e=t.editable();null!=t._.previousScrollTop&&e.getDocument().equals(CKEDITOR.document)&&(e.$.scrollTop=t._.previousScrollTop,t._.previousScrollTop=null,this.removeListener("scroll",s))};this.on("scroll",s)}if(t.focusManager.add(this),this.equals(CKEDITOR.document.getActive())&&(this.hasFocus=!0,t.once("contentDom",function(){t.focusManager.focus(this)},this)),this.isInline()&&this.changeAttr("tabindex",t.tabIndex),!this.is("textarea")){t.document=this.getDocument(),t.window=this.getWindow();var a=t.document;this.changeAttr("spellcheck",!t.config.disableNativeSpellChecker);var l=t.config.contentsLangDirection;this.getDirection(1)!=l&&this.changeAttr("dir",l);var c=CKEDITOR.getCss();if(c){var d=(l=a.getHead()).getCustomData("stylesheet");d?c!=d.getText()&&(CKEDITOR.env.ie&&9>CKEDITOR.env.version?d.$.styleSheet.cssText=c:d.setText(c)):(c=a.appendStyleText(c),c=new CKEDITOR.dom.element(c.ownerNode||c.owningElement),l.setCustomData("stylesheet",c),c.data("cke-temp",1))}l=a.getCustomData("stylesheet_ref")||0,a.setCustomData("stylesheet_ref",l+1),this.setCustomData("cke_includeReadonly",!t.config.disableReadonlyStyling),this.attachListener(this,"click",function(t){t=t.data;var e=new CKEDITOR.dom.elementPath(t.getTarget(),this).contains("a");e&&2!=t.$.button&&e.isReadOnly()&&t.preventDefault()});var f={8:1,46:1};this.attachListener(t,"key",function(e){if(t.readOnly)return!0;var n,s=e.data.domEvent.getKey(),a=t.getSelection();if(0!==a.getRanges().length){if(s in f){var l,c,u,d,p=(e=a.getRanges()[0]).startPath(),g=(s=8==s,!1);if(CKEDITOR.env.ie&&11>CKEDITOR.env.version&&a.getSelectedElement())l=a.getSelectedElement();else if(i(a)){var m,v=new CKEDITOR.dom.walker(e),y=e.collapsed?e.startContainer:v.next();g=!1;if(e.checkStartOfBlock()){var b=(m=e.startPath().block||e.startPath().blockLimit).getName();m=-1!==CKEDITOR.tools.array.indexOf(["dd","dt","li"],b)&&null===m.getPrevious()}else m=!1;if(m){for(;y&&!g;)g=y.$.nodeName.toLowerCase(),g=!!I[g],y=v.next();v=o(e.startPath()),y=o(e.endPath()),g=g||v!==y}else g=void 0;g||(l=r(a))}l||g?(t.fire("saveSnapshot"),g?((n=e.startContainer.getAscendant(I,!0))?(e.setStart(n,0),e.enlarge(CKEDITOR.ENLARGE_ELEMENT),l=e):l=null,l.deleteContents()):(e.moveToPosition(l,CKEDITOR.POSITION_BEFORE_START),l.remove()),e.select(),t.fire("saveSnapshot"),n=1):e.collapsed&&((c=p.block)&&(d=c[s?"getPrevious":"getNext"](h))&&d.type==CKEDITOR.NODE_ELEMENT&&d.is("table")&&e[s?"checkStartOfBlock":"checkEndOfBlock"]()?(t.fire("saveSnapshot"),e[s?"checkEndOfBlock":"checkStartOfBlock"]()&&c.remove(),e["moveToElementEdit"+(s?"End":"Start")](d),e.select(),t.fire("saveSnapshot"),n=1):p.blockLimit&&p.blockLimit.is("td")&&(u=p.blockLimit.getAscendant("table"))&&e.checkBoundaryOfElement(u,s?CKEDITOR.START:CKEDITOR.END)&&(d=u[s?"getPrevious":"getNext"](h))?(t.fire("saveSnapshot"),e["moveToElementEdit"+(s?"End":"Start")](d),e.checkStartOfBlock()&&e.checkEndOfBlock()?d.remove():e.select(),t.fire("saveSnapshot"),n=1):(u=p.contains(["td","th","caption"]))&&e.checkBoundaryOfElement(u,s?CKEDITOR.START:CKEDITOR.END)&&(n=1))}return!n}}),t.blockless&&CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller&&this.attachListener(this,"keyup",function(e){e.data.getKeystroke()in f&&!this.getFirst(n)&&(this.appendBogus(),(e=t.createRange()).moveToPosition(this,CKEDITOR.POSITION_AFTER_START),e.select())}),this.attachListener(this,"dblclick",function(e){if(t.readOnly)return!1;e={element:e.data.getTarget()},t.fire("doubleclick",e)}),CKEDITOR.env.ie&&this.attachListener(this,"click",e),CKEDITOR.env.ie&&!CKEDITOR.env.edge||this.attachListener(this,"mousedown",function(e){var n=e.data.getTarget();n.is("img","hr","input","textarea","select")&&!n.isReadOnly()&&(t.getSelection().selectElement(n),n.is("input","textarea","select")&&e.data.preventDefault())}),CKEDITOR.env.edge&&this.attachListener(this,"mouseup",function(e){(e=e.data.getTarget())&&e.is("img")&&!e.isReadOnly()&&t.getSelection().selectElement(e)}),CKEDITOR.env.gecko&&this.attachListener(this,"mouseup",function(e){if(2==e.data.$.button&&(!(e=e.data.getTarget()).getAscendant("table")&&!e.getOuterHtml().replace(g,""))){var n=t.createRange();n.moveToElementEditStart(e),n.select(!0)}}),CKEDITOR.env.webkit&&(this.attachListener(this,"click",function(t){t.data.getTarget().is("input","select")&&t.data.preventDefault()}),this.attachListener(this,"mouseup",function(t){t.data.getTarget().is("input","textarea")&&t.data.preventDefault()})),CKEDITOR.env.webkit&&this.attachListener(t,"key",function(e){if(t.readOnly)return!0;if((n=e.data.domEvent.getKey())in f&&0!==(e=t.getSelection()).getRanges().length){var n=8==n,i=e.getRanges()[0];if(e=i.startPath(),i.collapsed)t:{var r=e.block;if(r&&i[n?"checkStartOfBlock":"checkEndOfBlock"](!0)&&i.moveToClosestEditablePosition(r,!n)&&i.collapsed){if(i.startContainer.type==CKEDITOR.NODE_ELEMENT){var o=i.startContainer.getChild(i.startOffset-(n?1:0));if(o&&o.type==CKEDITOR.NODE_ELEMENT&&o.is("hr")){t.fire("saveSnapshot"),o.remove(),e=!0;break t}}var s;if(!(i=i.startPath().block)||i&&i.contains(r))e=void 0;else t.fire("saveSnapshot"),(s=(n?i:r).getBogus())&&s.remove(),o=(s=t.getSelection()).createBookmarks(),(n?r:i).moveChildren(n?i:r,!1),e.lastElement.mergeSiblings(),u(r,i,!n),s.selectBookmarks(o),e=!0}else e=!1}else n=i,s=e.block,i=n.endPath().block,s&&i&&!s.equals(i)?(t.fire("saveSnapshot"),(r=s.getBogus())&&r.remove(),n.enlarge(CKEDITOR.ENLARGE_INLINE),n.deleteContents(),i.getParent()&&(i.moveChildren(s,!1),e.lastElement.mergeSiblings(),u(s,i,!0)),(n=t.getSelection().getRanges()[0]).collapse(1),n.optimize(),""===n.startContainer.getHtml()&&n.startContainer.appendBogus(),n.select(),e=!0):e=!1;if(!e)return;return t.getSelection().scrollIntoView(),t.fire("saveSnapshot"),!1}},this,null,100)}},getUniqueId:function(){var t;try{this._.expandoNumber=t=CKEDITOR.dom.domObject.prototype.getUniqueId.call(this)}catch(l){t=this._&&this._.expandoNumber}return t}},_:{cleanCustomData:function(){this.removeClass("cke_editable"),this.restoreAttrs();for(var t=this.removeCustomData("classes");t&&t.length;)this.removeClass(t.pop());if(!this.is("textarea")){var e=(t=this.getDocument()).getHead();if(e.getCustomData("stylesheet")){var n=t.getCustomData("stylesheet_ref");--n?t.setCustomData("stylesheet_ref",n):(t.removeCustomData("stylesheet_ref"),e.removeCustomData("stylesheet").remove())}}}}}),CKEDITOR.editor.prototype.editable=function(t){var e=this._.editable;return e&&t?0:arguments.length?(t?e=t instanceof CKEDITOR.editable?t:new CKEDITOR.editable(this,t):(e&&e.detach(),e=null),this._.editable=e):e},CKEDITOR.on("instanceLoaded",function(e){var n=e.editor;n.on("insertElement",function(t){(t=t.data).type==CKEDITOR.NODE_ELEMENT&&(t.is("input")||t.is("textarea"))&&("false"!=t.getAttribute("contentEditable")&&t.data("cke-editable",t.hasAttribute("contenteditable")?"true":"1"),t.setAttribute("contentEditable",!1))}),n.on("selectionChange",function(e){if(!n.readOnly){var i=n.getSelection();i&&!i.isLocked&&(i=n.checkDirty(),n.fire("lockSnapshot"),t(e),n.fire("unlockSnapshot"),!i&&n.resetDirty())}})}),CKEDITOR.on("instanceCreated",function(t){var e=t.editor;e.on("mode",function(){var t=e.editable();if(t&&t.isInline()){var n=e.title;if(t.changeAttr("role","textbox"),t.changeAttr("aria-multiline","true"),n&&t.changeAttr("aria-label",n),n&&t.changeAttr("title",n),(r=e.fire("ariaEditorHelpLabel",{}).label)&&(n=this.ui.space(this.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?"top":"contents"))){var i=CKEDITOR.tools.getNextId(),r=CKEDITOR.dom.element.createFromHtml('<span id="'+i+'" class="cke_voice_label">'+r+"</span>");n.append(r),t.changeAttr("aria-describedby",i)}}})}),CKEDITOR.addCss(".cke_editable{cursor:text}.cke_editable img,.cke_editable input,.cke_editable textarea{cursor:default}"),h=CKEDITOR.dom.walker.whitespaces(!0),d=CKEDITOR.dom.walker.bookmark(!1,!0),f=CKEDITOR.dom.walker.empty(),p=CKEDITOR.dom.walker.bogus(),g=/(^|<body\b[^>]*>)\s*<(p|div|address|h\d|center|pre)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\2>)?\s*(?=$|<\/body>)/gi,m=function(){function t(t){return t.type==CKEDITOR.NODE_ELEMENT}function e(n,i){var r,o,s,a,l=[],c=i.range.startContainer;r=i.range.startPath();c=u[c.getName()];for(var h=0,d=n.getChildren(),f=d.count(),p=-1,g=-1,m=0,v=r.contains(u.$list);h<f;++h)t(r=d.getItem(h))?(s=r.getName(),v&&s in CKEDITOR.dtd.$list?l=l.concat(e(r,i)):(a=!!c[s],"br"!=s||!r.data("cke-eol")||h&&h!=f-1||(m=(o=h?l[h-1].node:d.getItem(h+1))&&(!t(o)||!o.is("br")),o=o&&t(o)&&u.$block[o.getName()]),-1!=p||a||(p=h),a||(g=h),l.push({isElement:1,isLineBreak:m,isBlock:r.isBlockBoundary(),hasBlockSibling:o,node:r,name:s,allowed:a}),o=m=0)):l.push({isElement:0,node:r,allowed:1});return-1<p&&(l[p].firstNotAllowed=1),-1<g&&(l[g].lastNotAllowed=1),l}function i(e,n){var r,o=[],s=e.getChildren(),a=s.count(),l=0,c=u[n],h=!e.is(u.$inline)||e.is("br");for(h&&o.push(" ");l<a;l++)t(r=s.getItem(l))&&!r.is(c)?o=o.concat(i(r,n)):o.push(r);return h&&o.push(" "),o}function r(e){return t(e.startContainer)&&e.startContainer.getChild(e.startOffset-1)}function o(e){return e&&t(e)&&(e.is(u.$removeEmpty)||e.is("a")&&!e.isBlockBoundary())}function c(e,n,i,r){var o,s,a=e.clone();a.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),(o=new CKEDITOR.dom.walker(a).next())&&t(o)&&h[o.getName()]&&(s=o.getPrevious())&&t(s)&&!s.getParent().equals(e.startContainer)&&i.contains(s)&&r.contains(o)&&o.isIdentical(s)&&(o.moveChildren(s),o.remove(),c(e,n,i,r))}var u=CKEDITOR.dtd,h={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,li:1,pre:1,dl:1,blockquote:1},d={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},f=CKEDITOR.tools.extend({},u.$inline);return delete f.br,function(h,p,m,v){var y,b=h.editor,C=!1;if("unfiltered_html"==p&&(p="html",C=!0),!v.checkReadOnly()){C=(p={type:p,dontFilter:C,editable:h,editor:b,range:v,blockLimit:D=new CKEDITOR.dom.elementPath(v.startContainer,v.root).blockLimit||v.root,mergeCandidates:[],zombies:[]}).range;var I,E,T,w,x,_,D=p.mergeCandidates,A="html"===p.type;if("text"==p.type&&C.shrink(CKEDITOR.SHRINK_ELEMENT,!0,!1)&&(E=CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",C.document),C.insertNode(E),C.setStartAfter(E)),T=new CKEDITOR.dom.elementPath(C.startContainer),p.endPath=w=new CKEDITOR.dom.elementPath(C.endContainer),!C.collapsed){I=w.block||w.blockLimit;var O=C.getCommonAncestor();I&&!I.equals(O)&&!I.contains(O)&&C.checkEndOfBlock()&&p.zombies.push(I),C.deleteContents()}for(;(x=r(C))&&t(x)&&x.isBlockBoundary()&&T.contains(x);)C.moveToPosition(x,CKEDITOR.POSITION_BEFORE_END);for(c(C,p.blockLimit,T,w),E&&(C.setEndBefore(E),C.collapse(),E.remove()),(I=(E=C.startPath()).contains(o,!1,1))&&(y=C.splitElement(I),p.inlineStylesRoot=I,p.inlineStylesPeak=E.lastElement),E=C.createBookmark(),A&&(l(I),l(y)),(I=E.startNode.getPrevious(n))&&t(I)&&o(I)&&D.push(I),(I=E.startNode.getNext(n))&&t(I)&&o(I)&&D.push(I),I=E.startNode;(I=I.getParent())&&o(I);)D.push(I);if(C.moveToBookmark(E),y=""===(y=h.getHtml())||y.match(g),b.enterMode===CKEDITOR.ENTER_DIV&&y&&((b=h.getFirst())&&b.remove(),v.setStartAt(h,CKEDITOR.POSITION_AFTER_START),v.collapse(!0)),h=m){if(h=p.range,"text"==p.type&&p.inlineStylesRoot){for(b=(v=p.inlineStylesPeak).getDocument().createText("{cke-peak}"),y=p.inlineStylesRoot.getParent();!v.equals(y);)b=b.appendTo(v.clone()),v=v.getParent();m=b.getOuterHtml().split("{cke-peak}").join(m)}if(v=p.blockLimit.getName(),/^\s+|\s+$/.test(m)&&"span"in CKEDITOR.dtd[v])m=(M='<span data-cke-marker="1">&nbsp;</span>')+m+M;if(m=p.editor.dataProcessor.toHtml(m,{context:null,fixForBody:!1,protectedWhitespaces:!!M,dontFilter:p.dontFilter,filter:p.editor.activeFilter,enterMode:p.editor.activeEnterMode}),(v=h.document.createElement("body")).setHtml(m),M&&(v.getFirst().remove(),v.getLast().remove()),(M=h.startPath().block)&&(1!=M.getChildCount()||!M.getBogus()))t:{var S;if(1==v.getChildCount()&&t(S=v.getFirst())&&S.is(d)&&!S.hasAttribute("contenteditable")){for(h=0,y=(M=S.getElementsByTag("*")).count();h<y;h++)if(!(b=M.getItem(h)).is(f))break t;S.moveChildren(S.getParent(1)),S.remove()}}p.dataWrapper=v,h=m}if(h){h=(S=p.range).document,v=p.blockLimit,y=0;var R,k,N,M=[];m=E=0;var P,L;b=S.startContainer,C=(x=p.endPath.elements[0]).getPosition(b),D=!(!x.getCommonAncestor(b)||C==CKEDITOR.POSITION_IDENTICAL||C&CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED),b=e(p.dataWrapper,p);for(p.editor.enterMode!==CKEDITOR.ENTER_BR&&function(e,n){function i(e,n){if(n.isBlock&&n.isElement&&!n.node.is("br")&&t(e)&&e.is("br"))return e.remove(),1}var r=n.endContainer.getChild(n.endOffset),o=n.endContainer.getChild(n.endOffset-1);r&&i(r,e[e.length-1]),o&&i(o,e[0])&&(n.setEnd(n.endContainer,n.endOffset-1),n.collapse())}(b,S);y<b.length;y++)if((A=(C=b[y]).isLineBreak)&&(A=S,I=v,w=T=void 0,C.hasBlockSibling?A=1:(T=A.startContainer.getAscendant(u.$block,1))&&T.is({div:1,p:1})?(w=T.getPosition(I))==CKEDITOR.POSITION_IDENTICAL||w==CKEDITOR.POSITION_CONTAINS?A=0:(I=A.splitElement(T),A.moveToPosition(I,CKEDITOR.POSITION_AFTER_START),A=1):A=0),A)m=0<y;else{if(A=S.startPath(),!C.isBlock&&s(p.editor,A.block,A.blockLimit)&&(N=a(p.editor))&&((N=h.createElement(N)).appendBogus(),S.insertNode(N),CKEDITOR.env.needsBrFiller&&(R=N.getBogus())&&R.remove(),S.moveToPosition(N,CKEDITOR.POSITION_BEFORE_END)),(A=S.startPath().block)&&!A.equals(k)&&((R=A.getBogus())&&(R.remove(),M.push(A)),k=A),C.firstNotAllowed&&(E=1),E&&C.isElement){for(A=S.startContainer,I=null;A&&!u[A.getName()][C.name];){if(A.equals(v)){A=null;break}I=A,A=A.getParent()}if(A)I&&(P=S.splitElement(I),p.zombies.push(P),p.zombies.push(I));else{I=v.getName(),L=!y,A=y==b.length-1,T=[],w=(I=i(C.node,I)).length;O=0;for(var K=void 0,B=0,z=-1;O<w;O++)" "==(K=I[O])?(B||L&&!O||(T.push(new CKEDITOR.dom.text(" ")),z=T.length),B=1):(T.push(K),B=0);A&&z==T.length&&T.pop(),L=T}}if(L){for(;A=L.pop();)S.insertNode(A);L=0}else S.insertNode(C.node);C.lastNotAllowed&&y<b.length-1&&((P=D?x:P)&&S.setEndAt(P,CKEDITOR.POSITION_AFTER_START),E=0),S.collapse()}1!=b.length?R=!1:R=(R=b[0]).isElement&&"false"==R.node.getAttribute("contenteditable"),R&&(m=!0,A=b[0].node,S.setStartAt(A,CKEDITOR.POSITION_BEFORE_START),S.setEndAt(A,CKEDITOR.POSITION_AFTER_END)),p.dontMoveCaret=m,p.bogusNeededBlocks=M}for(R=p.range,L=p.bogusNeededBlocks,k=R.createBookmark();N=p.zombies.pop();)N.getParent()&&((P=R.clone()).moveToElementEditStart(N),P.removeEmptyBlocksAtEnd());if(L)for(;N=L.pop();)CKEDITOR.env.needsBrFiller?N.appendBogus():N.append(R.document.createText("\xa0"));for(;N=p.mergeCandidates.pop();)N.mergeSiblings();if(CKEDITOR.env.webkit&&R.startPath()&&((N=R.startPath()).block?N.block.$.normalize():N.blockLimit&&N.blockLimit.$.normalize()),R.moveToBookmark(k),!p.dontMoveCaret){for(N=r(R);N&&t(N)&&!N.is(u.$empty);){if(N.isBlockBoundary())R.moveToPosition(N,CKEDITOR.POSITION_BEFORE_END);else{if(o(N)&&N.getHtml().match(/(\s|&nbsp;)$/g)){_=null;break}(_=R.clone()).moveToPosition(N,CKEDITOR.POSITION_BEFORE_END)}N=N.getLast(n)}_&&R.moveToRange(_)}}}}(),v=function(){function t(t){return(t=new CKEDITOR.dom.walker(t)).guard=function(t,e){return!e&&(t.type==CKEDITOR.NODE_ELEMENT?t.is(CKEDITOR.dtd.$tableContent):void 0)},t.evaluator=function(t){return t.type==CKEDITOR.NODE_ELEMENT},t}function e(t,e,n){return e=t.getDocument().createElement(e),t.append(e,n),e}function n(t){for(var e,n=t.count();0<n--;)e=t.getItem(n),CKEDITOR.tools.trim(e.getHtml())||(e.appendBogus(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&e.getChildCount()&&e.getFirst().remove())}return function(i){var r=i.startContainer,o=r.getAscendant("table",1),s=!1;n(o.getElementsByTag("td")),n(o.getElementsByTag("th")),(o=i.clone()).setStart(r,0),(o=t(o).lastBackward())||((o=i.clone()).setEndAt(r,CKEDITOR.POSITION_BEFORE_END),o=t(o).lastForward(),s=!0),o||(o=r),o.is("table")?(i.setStartAt(o,CKEDITOR.POSITION_BEFORE_START),i.collapse(!0),o.remove()):(o.is({tbody:1,thead:1,tfoot:1})&&(o=e(o,"tr",s)),o.is("tr")&&(o=e(o,o.getParent().is("thead")?"th":"td",s)),(r=o.getBogus())&&r.remove(),i.moveToPosition(o,s?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END))}}(),y=function(){function t(t){return(t=new CKEDITOR.dom.walker(t)).guard=function(t,e){return!e&&(t.type==CKEDITOR.NODE_ELEMENT?t.is(CKEDITOR.dtd.$list)||t.is(CKEDITOR.dtd.$listItem):void 0)},t.evaluator=function(t){return t.type==CKEDITOR.NODE_ELEMENT&&t.is(CKEDITOR.dtd.$listItem)},t}return function(e){var n,i=e.startContainer,r=!1;(n=e.clone()).setStart(i,0),(n=t(n).lastBackward())||((n=e.clone()).setEndAt(i,CKEDITOR.POSITION_BEFORE_END),n=t(n).lastForward(),r=!0),n||(n=i),n.is(CKEDITOR.dtd.$list)?(e.setStartAt(n,CKEDITOR.POSITION_BEFORE_START),e.collapse(!0),n.remove()):((i=n.getBogus())&&i.remove(),e.moveToPosition(n,r?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END),e.select())}}(),b={eol:{detect:function(t,e){var n=t.range,i=n.clone(),r=n.clone(),o=new CKEDITOR.dom.elementPath(n.startContainer,e),s=new CKEDITOR.dom.elementPath(n.endContainer,e);i.collapse(1),r.collapse(),o.block&&i.checkBoundaryOfElement(o.block,CKEDITOR.END)&&(n.setStartAfter(o.block),t.prependEolBr=1),s.block&&r.checkBoundaryOfElement(s.block,CKEDITOR.START)&&(n.setEndBefore(s.block),t.appendEolBr=1)},fix:function(t,e){var n,i=e.getDocument();t.appendEolBr&&(n=this.createEolBr(i),t.fragment.append(n)),!t.prependEolBr||n&&!n.getPrevious()||t.fragment.append(this.createEolBr(i),1)},createEolBr:function(t){return t.createElement("br",{attributes:{"data-cke-eol":1}})}},bogus:{exclude:function(t){var e,n=(e=t.range.getBoundaryNodes()).startNode;!(e=e.endNode)||!p(e)||n&&n.equals(e)||t.range.setEndBefore(e)}},tree:{rebuild:function(t,e){var n,i=(s=t.range).getCommonAncestor(),r=new CKEDITOR.dom.elementPath(i,e),o=new CKEDITOR.dom.elementPath(s.startContainer,e),s=new CKEDITOR.dom.elementPath(s.endContainer,e);if(i.type==CKEDITOR.NODE_TEXT&&(i=i.getParent()),r.blockLimit.is({tr:1,table:1})){var a=r.contains("table").getParent();n=function(t){return!t.equals(a)}}else if(r.block&&r.block.is(CKEDITOR.dtd.$listItem)&&(o=o.contains(CKEDITOR.dtd.$list),s=s.contains(CKEDITOR.dtd.$list),!o.equals(s))){var l=r.contains(CKEDITOR.dtd.$list).getParent();n=function(t){return!t.equals(l)}}n||(n=function(t){return!t.equals(r.block)&&!t.equals(r.blockLimit)}),this.rebuildFragment(t,e,i,n)},rebuildFragment:function(t,e,n,i){for(var r;n&&!n.equals(e)&&i(n);)r=n.clone(0,1),t.fragment.appendTo(r),t.fragment=r,n=n.getParent()}},cell:{shrink:function(t){var e=(t=t.range).startContainer,n=t.endContainer,i=t.startOffset,r=t.endOffset;e.type==CKEDITOR.NODE_ELEMENT&&e.equals(n)&&e.is("tr")&&++i==r&&t.shrink(CKEDITOR.SHRINK_TEXT)}}},C=function(){function t(t,e){var n=t.getParent();n.is(CKEDITOR.dtd.$inline)&&t[e?"insertBefore":"insertAfter"](n)}function e(e,n,i){t(n),t(i,1);for(var r;r=i.getNext();)r.insertAfter(n),n=r;f(e)&&e.remove()}function n(t,e){var n=new CKEDITOR.dom.range(t);return n.setStartAfter(e.startNode),n.setEndBefore(e.endNode),n}return{list:{detectMerge:function(t,e){var i=n(e,t.bookmark),r=i.startPath(),o=i.endPath(),s=r.contains(CKEDITOR.dtd.$list),a=o.contains(CKEDITOR.dtd.$list);t.mergeList=s&&a&&s.getParent().equals(a.getParent())&&!s.equals(a),t.mergeListItems=r.block&&o.block&&r.block.is(CKEDITOR.dtd.$listItem)&&o.block.is(CKEDITOR.dtd.$listItem),(t.mergeList||t.mergeListItems)&&((i=i.clone()).setStartBefore(t.bookmark.startNode),i.setEndAfter(t.bookmark.endNode),t.mergeListBookmark=i.createBookmark())},merge:function(t,n){if(t.mergeListBookmark){var i=t.mergeListBookmark.startNode,r=t.mergeListBookmark.endNode,o=new CKEDITOR.dom.elementPath(i,n),s=new CKEDITOR.dom.elementPath(r,n);if(t.mergeList){var a=o.contains(CKEDITOR.dtd.$list),l=s.contains(CKEDITOR.dtd.$list);a.equals(l)||(l.moveChildren(a),l.remove())}t.mergeListItems&&(o=o.contains(CKEDITOR.dtd.$listItem),s=s.contains(CKEDITOR.dtd.$listItem),o.equals(s)||e(s,i,r)),i.remove(),r.remove()}}},block:{detectMerge:function(t,e){if(!t.tableContentsRanges&&!t.mergeListBookmark){var n=new CKEDITOR.dom.range(e);n.setStartBefore(t.bookmark.startNode),n.setEndAfter(t.bookmark.endNode),t.mergeBlockBookmark=n.createBookmark()}},merge:function(t,n){if(t.mergeBlockBookmark&&!t.purgeTableBookmark){var i=t.mergeBlockBookmark.startNode,r=t.mergeBlockBookmark.endNode,o=new CKEDITOR.dom.elementPath(i,n),s=new CKEDITOR.dom.elementPath(r,n);o=o.block,s=s.block;o&&s&&!o.equals(s)&&e(s,i,r),i.remove(),r.remove()}}},table:function(){function t(t){var n,r=[],o=new CKEDITOR.dom.walker(t),s=t.startPath().contains(i),a=t.endPath().contains(i),l={};return o.guard=function(o,c){if(o.type==CKEDITOR.NODE_ELEMENT){var u="visited_"+(c?"out":"in");if(o.getCustomData(u))return;CKEDITOR.dom.element.setMarker(l,o,u,1)}if(c&&s&&o.equals(s))(n=t.clone()).setEndAt(s,CKEDITOR.POSITION_BEFORE_END),r.push(n);else if(!c&&a&&o.equals(a))(n=t.clone()).setStartAt(a,CKEDITOR.POSITION_AFTER_START),r.push(n);else{if((u=!c)&&(u=o.type==CKEDITOR.NODE_ELEMENT&&o.is(i)&&(!s||e(o,s))&&(!a||e(o,a))),!u&&(u=c))if(o.is(i)){u=s&&s.getAscendant("table",!0);var h=a&&a.getAscendant("table",!0),d=o.getAscendant("table",!0);u=u&&u.contains(d)||h&&h.contains(d)}else u=void 0;u&&((n=t.clone()).selectNodeContents(o),r.push(n))}},o.lastForward(),CKEDITOR.dom.element.clearAllMarkers(l),r}function e(t,e){var n=CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED,i=t.getPosition(e);return i!==CKEDITOR.POSITION_IDENTICAL&&0==(i&n)}var i={td:1,th:1,caption:1};return{detectPurge:function(t){var e=t.range;(n=e.clone()).enlarge(CKEDITOR.ENLARGE_ELEMENT);var n=new CKEDITOR.dom.walker(n),r=0;if(n.evaluator=function(t){t.type==CKEDITOR.NODE_ELEMENT&&t.is(i)&&++r},n.checkForward(),1<r){n=e.startPath().contains("table");var o=e.endPath().contains("table");n&&o&&e.checkBoundaryOfElement(n,CKEDITOR.START)&&e.checkBoundaryOfElement(o,CKEDITOR.END)&&((e=t.range.clone()).setStartBefore(n),e.setEndAfter(o),t.purgeTableBookmark=e.createBookmark())}},detectRanges:function(r,o){var s,a,l=n(o,r.bookmark),c=l.clone(),u=l.getCommonAncestor();u.is(CKEDITOR.dtd.$tableContent)&&!u.is(i)&&(u=u.getAscendant("table",!0)),a=u,u=new CKEDITOR.dom.elementPath(l.startContainer,a),a=new CKEDITOR.dom.elementPath(l.endContainer,a),u=u.contains("table"),a=a.contains("table"),(u||a)&&(u&&a&&e(u,a)?(r.tableSurroundingRange=c,c.setStartAt(u,CKEDITOR.POSITION_AFTER_END),c.setEndAt(a,CKEDITOR.POSITION_BEFORE_START),(c=l.clone()).setEndAt(u,CKEDITOR.POSITION_AFTER_END),(s=l.clone()).setStartAt(a,CKEDITOR.POSITION_BEFORE_START),s=t(c).concat(t(s))):u?a||(r.tableSurroundingRange=c,c.setStartAt(u,CKEDITOR.POSITION_AFTER_END),l.setEndAt(u,CKEDITOR.POSITION_AFTER_END)):(r.tableSurroundingRange=c,c.setEndAt(a,CKEDITOR.POSITION_BEFORE_START),l.setStartAt(a,CKEDITOR.POSITION_AFTER_START)),r.tableContentsRanges=s||t(l))},deleteRanges:function(t){for(var e;e=t.tableContentsRanges.pop();)e.extractContents(),f(e.startContainer)&&e.startContainer.appendBogus();t.tableSurroundingRange&&t.tableSurroundingRange.extractContents()},purge:function(t){if(t.purgeTableBookmark){var e=t.doc,n=t.range.clone();(e=e.createElement("p")).insertBefore(t.purgeTableBookmark.startNode),n.moveToBookmark(t.purgeTableBookmark),n.deleteContents(),t.range.moveToPosition(e,CKEDITOR.POSITION_AFTER_START)}}}}(),detectExtractMerge:function(t){return!(t.range.startPath().contains(CKEDITOR.dtd.$listItem)&&t.range.endPath().contains(CKEDITOR.dtd.$listItem))},fixUneditableRangePosition:function(t){t.startContainer.getDtd()["#"]||t.moveToClosestEditablePosition(null,!0)},autoParagraph:function(t,e){var n,i=e.startPath();s(t,i.block,i.blockLimit)&&(n=a(t))&&((n=e.document.createElement(n)).appendBogus(),e.insertNode(n),e.moveToPosition(n,CKEDITOR.POSITION_AFTER_START))}}}()}(),function(){function t(t){return CKEDITOR.plugins.widget&&CKEDITOR.plugins.widget.isDomWidget(t)}function e(e,n){if(0===e.length||t(e[0].getEnclosedNode()))return!1;var i,r;if((i=!n&&1===e.length)&&!(i=e[0].collapsed)){var o=e[0];i=o.startContainer.getAscendant({td:1,th:1},!0);var s=o.endContainer.getAscendant({td:1,th:1},!0);r=CKEDITOR.tools.trim,i&&i.equals(s)&&!i.findOne("td, th, tr, tbody, table")?i=!(o=o.cloneContents()).getFirst()||r(o.getFirst().getText())!==r(i.getText()):i=!1}if(i)return!1;for(r=0;r<e.length;r++)if(!(i=e[r]._getTableElement()))return!1;return!0}function n(t){var e=this.root.editor,n=e.getSelection(1);this.reset(),d=!0,n.root.once("selectionchange",function(t){t.cancel()},null,null,0),n.selectRanges([t[0]]),(n=this._.cache).ranges=new CKEDITOR.dom.rangeList(t),n.type=CKEDITOR.SELECTION_TEXT,n.selectedElement=t[0]._getTableElement(),n.selectedText=function(t){t=function(t){function e(t){t=t.find("td, th");var e,n=[];for(e=0;e<t.count();e++)n.push(t.getItem(e));return n}var n,i,r=[];for(i=0;i<t.length;i++)(n=t[i]._getTableElement()).is&&n.is({td:1,th:1})?r.push(n):r=r.concat(e(n));return r}(t);var e,n,i="",r=[];for(n=0;n<t.length;n++)e&&!e.equals(t[n].getAscendant("tr"))?(i+=r.join("\t")+"\n",e=t[n].getAscendant("tr"),r=[]):0===n&&(e=t[n].getAscendant("tr")),r.push(t[n].getText());return i+r.join("\t")}(t),n.nativeSel=null,this.isFake=1,this.rev=m++,e._.fakeSelection=this,d=!1,this.root.fire("selectionchange")}function i(){var n,i=this._.fakeSelection;if(i){var r;if(!(r=!(n=this.getSelection(1)))&&(r=!n.isHidden())){r=i;var o=n.getRanges(),s=r.getRanges(),a=o.length&&o[0]._getTableElement()&&o[0]._getTableElement().getAscendant("table",!0),l=s.length&&s[0]._getTableElement()&&s[0]._getTableElement().getAscendant("table",!0),c=1===o.length&&o[0]._getTableElement()&&o[0]._getTableElement().is("table"),u=1===s.length&&s[0]._getTableElement()&&s[0]._getTableElement().is("table");if(t(r.getSelectedElement()))r=!1;else{var h=1===o.length&&o[0].collapsed;s=e(o,!!CKEDITOR.env.webkit)&&e(s);(a=!(!a||!l)&&(a.equals(l)||l.contains(a)))&&(h||s)?(c&&!u&&r.selectRanges(o),r=!0):r=!1}r=!r}r&&(i.reset(),i=0)}(i||(i=n||this.getSelection(1))&&i.getType()!=CKEDITOR.SELECTION_NONE)&&(this.fire("selectionCheck",i),(n=this.elementPath()).compare(this._.selectionPreviousPath)||(r=this._.selectionPreviousPath&&this._.selectionPreviousPath.blockLimit.equals(n.blockLimit),!CKEDITOR.env.webkit&&!CKEDITOR.env.gecko||r||(this._.previousActive=this.document.getActive()),this._.selectionPreviousPath=n,this.fire("selectionChange",{selection:i,path:n})))}function r(){p=!0,f||(o.call(this),f=CKEDITOR.tools.setTimeout(o,200,this))}function o(){f=null,p&&(CKEDITOR.tools.setTimeout(i,0,this),p=!1)}function s(t){return!(!b(t)&&(t.type!=CKEDITOR.NODE_ELEMENT||t.is(CKEDITOR.dtd.$empty)))}function a(t){function e(e,n){return!(!e||e.type==CKEDITOR.NODE_TEXT)&&t.clone()["moveToElementEdit"+(n?"End":"Start")](e)}if(!(t.root instanceof CKEDITOR.editable))return!1;var n=t.startContainer,i=t.getPreviousNode(s,null,n),r=t.getNextNode(s,null,n);return!(!e(i)&&!e(r,1)&&(i||r||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary()&&n.getBogus()))}function l(t){c(t,!1);var e=t.getDocument().createText(v);return t.setCustomData("cke-fillingChar",e),e}function c(t,e){var n=t&&t.removeCustomData("cke-fillingChar");if(n){if(!1!==e){var i=t.getDocument().getSelection().getNative(),r=i&&"None"!=i.type&&i.getRangeAt(0),o=v.length;if(n.getLength()>o&&r&&r.intersectsNode(n.$)){var s=[{node:i.anchorNode,offset:i.anchorOffset},{node:i.focusNode,offset:i.focusOffset}];i.anchorNode==n.$&&i.anchorOffset>o&&(s[0].offset-=o),i.focusNode==n.$&&i.focusOffset>o&&(s[1].offset-=o)}}n.setText(u(n.getText(),1)),s&&(i=(n=t.getDocument().$).getSelection(),(n=n.createRange()).setStart(s[0].node,s[0].offset),n.collapse(!0),i.removeAllRanges(),i.addRange(n),i.extend(s[1].node,s[1].offset))}}function u(t,e){return e?t.replace(y,function(t,e){return e?"\xa0":""}):t.replace(v,"")}function h(e){var n={37:1,39:1,8:1,46:1};return function(i){var r=i.data.getKeystroke();if(n[r]){var o=e.getSelection(),s=o.getRanges()[0];o.isCollapsed()&&(s=s[38>r?"getPreviousEditableNode":"getNextEditableNode"]())&&s.type==CKEDITOR.NODE_ELEMENT&&"false"==s.getAttribute("contenteditable")&&(!(o=o.getStartElement()).isBlockBoundary()||""!==(void 0===o.$.textContent?o.$.innerText:o.$.textContent)||t(o.getFirst())||8!==r&&46!==r||(o.remove(),e.fire("saveSnapshot")),e.getSelection().fake(s),i.data.preventDefault(),i.cancel())}}}var d,f,p,g="function"!=typeof window.getSelection,m=1,v=CKEDITOR.tools.repeat("\u200b",7),y=new RegExp(v+"( )?","g"),b=CKEDITOR.dom.walker.invisible(1),C=function(){function t(t){return function(e){var n=e.editor.createRange();return n.moveToClosestEditablePosition(e.selected,t)&&e.editor.getSelection().selectRanges([n]),!1}}function e(t){return function(e){var n,i=e.editor,r=i.createRange();if(!i.readOnly)return(n=r.moveToClosestEditablePosition(e.selected,t))||(n=r.moveToClosestEditablePosition(e.selected,!t)),n&&i.getSelection().selectRanges([r]),i.fire("saveSnapshot"),e.selected.remove(),n||(r.moveToElementEditablePosition(i.editable()),i.getSelection().selectRanges([r])),i.fire("saveSnapshot"),!1}}var n=t(),i=t(1);return{37:n,38:n,39:i,40:i,8:e(),46:e(1)}}();CKEDITOR.on("instanceCreated",function(t){function e(){var t=n.getSelection();t&&t.removeAllRanges()}var n=t.editor;n.on("contentDom",function(){function t(){(s=new CKEDITOR.dom.selection(n.getSelection())).lock()}function e(){f.removeListener("mouseup",e),v.removeListener("mouseup",e);var t=CKEDITOR.document.$.selection,n=t.createRange();"None"!=t.type&&n.parentElement()&&n.parentElement().ownerDocument==d.$&&n.select()}var o,s,l,u,d=n.document,f=CKEDITOR.document,p=n.editable(),m=d.getBody(),v=d.getDocumentElement(),y=p.isInline();if((CKEDITOR.env.gecko&&p.attachListener(p,"focus",function(t){t.removeListener(),0!==o&&(t=n.getSelection().getNative())&&t.isCollapsed&&t.anchorNode==p.$&&((t=n.createRange()).moveToElementEditStart(p),t.select())},null,null,-2),p.attachListener(p,CKEDITOR.env.webkit||CKEDITOR.env.gecko?"focusin":"focus",function(){if(o&&(CKEDITOR.env.webkit||CKEDITOR.env.gecko)){o=n._.previousActive&&n._.previousActive.equals(d.getActive());var t=null!=n._.previousScrollTop&&n._.previousScrollTop!=p.$.scrollTop;CKEDITOR.env.webkit&&o&&t&&(p.$.scrollTop=n._.previousScrollTop)}n.unlockSelection(o),o=0},null,null,-1),p.attachListener(p,"mousedown",function(){o=0}),(CKEDITOR.env.ie||CKEDITOR.env.gecko||y)&&(g?p.attachListener(p,"beforedeactivate",t,null,null,-1):p.attachListener(n,"selectionCheck",t,null,null,-1),p.attachListener(p,CKEDITOR.env.webkit||CKEDITOR.env.gecko?"focusout":"blur",function(){var t=s&&(s.isFake||2>s.getRanges().length);CKEDITOR.env.gecko&&!y&&t||(n.lockSelection(s),o=1)},null,null,-1),p.attachListener(p,"mousedown",function(){o=0})),CKEDITOR.env.ie&&!y)&&(p.attachListener(p,"mousedown",function(t){2==t.data.$.button&&((t=n.document.getSelection())&&t.getType()!=CKEDITOR.SELECTION_NONE||(l=n.window.getScrollPosition()))}),p.attachListener(p,"mouseup",function(t){2==t.data.$.button&&l&&(n.document.$.documentElement.scrollLeft=l.x,n.document.$.documentElement.scrollTop=l.y),l=null}),"BackCompat"!=d.$.compatMode)){var b,C;if(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)v.on("mousedown",function(t){function e(t){if(t=t.data.$,b){var e=m.$.createTextRange();try{e.moveToPoint(t.clientX,t.clientY)}catch(a){}b.setEndPoint(0>C.compareEndPoints("StartToStart",e)?"EndToEnd":"StartToStart",e),b.select()}}function n(){v.removeListener("mousemove",e),f.removeListener("mouseup",n),v.removeListener("mouseup",n),b.select()}if((t=t.data).getTarget().is("html")&&t.$.y<v.$.clientHeight&&t.$.x<v.$.clientWidth){b=m.$.createTextRange();try{b.moveToPoint(t.$.clientX,t.$.clientY)}catch(a){}C=b.duplicate(),v.on("mousemove",e),f.on("mouseup",n),v.on("mouseup",n)}});7<CKEDITOR.env.version&&11>CKEDITOR.env.version&&v.on("mousedown",function(t){t.data.getTarget().is("html")&&(f.on("mouseup",e),v.on("mouseup",e))})}(p.attachListener(p,"selectionchange",i,n),p.attachListener(p,"keyup",r,n),p.attachListener(p,"touchstart",r,n),p.attachListener(p,"touchend",r,n),CKEDITOR.env.ie&&p.attachListener(p,"keydown",function(t){var e,n;(e=!!(e=this.document.getActive())&&("input"===e.getName()||"textarea"===e.getName()))||(n=function(t){return t=t.getRanges()[0],t&&(t=t.startContainer.getAscendant(function(t){return t.type==CKEDITOR.NODE_ELEMENT&&t.hasAttribute("contenteditable")},!0))&&"false"===t.getAttribute("contenteditable")?t:null}(e=this.getSelection(1)))&&!n.equals(p)&&(e.selectElement(n),t.data.preventDefault())},n),p.attachListener(p,CKEDITOR.env.webkit||CKEDITOR.env.gecko?"focusin":"focus",function(){n.forceNextSelectionCheck(),n.selectionChange(1)}),y&&(CKEDITOR.env.webkit||CKEDITOR.env.gecko))?(p.attachListener(p,"mousedown",function(){u=1}),p.attachListener(d.getDocumentElement(),"mouseup",function(){u&&r.call(n),u=0})):p.attachListener(CKEDITOR.env.ie?p:d.getDocumentElement(),"mouseup",r,n);CKEDITOR.env.webkit&&p.attachListener(d,"keydown",function(t){switch(t.data.getKey()){case 13:case 33:case 34:case 35:case 36:case 37:case 39:case 8:case 45:case 46:p.hasFocus&&c(p)}},null,null,-1),p.attachListener(p,"keydown",h(n),null,null,-1)}),n.on("setData",function(){n.unlockSelection(),CKEDITOR.env.webkit&&e()}),n.on("contentDomUnload",function(){n.unlockSelection()}),CKEDITOR.env.ie9Compat&&n.on("beforeDestroy",e,null,null,9),n.on("dataReady",function(){delete n._.fakeSelection,delete n._.hiddenSelectionContainer,n.selectionChange(1)}),n.on("loadSnapshot",function(){var t=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT),e=n.editable().getLast(t);e&&e.hasAttribute("data-cke-hidden-sel")&&(e.remove(),CKEDITOR.env.gecko&&(t=n.editable().getFirst(t))&&t.is("br")&&t.getAttribute("_moz_editor_bogus_node")&&t.remove())},null,null,100),n.on("key",function(t){if("wysiwyg"==n.mode){var e=n.getSelection();if(e.isFake){var i=C[t.data.keyCode];if(i)return i({editor:n,selected:e.getSelectedElement(),selection:e,keyEvent:t})}}})}),CKEDITOR.env.webkit&&CKEDITOR.on("instanceReady",function(t){var e=t.editor;e.on("selectionChange",function(){var t=e.editable(),n=t.getCustomData("cke-fillingChar");n&&(n.getCustomData("ready")?(c(t),t.editor.fire("selectionCheck")):n.setCustomData("ready",1))},null,null,-1),e.on("beforeSetMode",function(){c(e.editable())},null,null,-1),e.on("getSnapshot",function(t){t.data&&(t.data=u(t.data))},e,null,20),e.on("toDataFormat",function(t){t.data.dataValue=u(t.data.dataValue)},null,null,0)}),CKEDITOR.editor.prototype.selectionChange=function(t){(t?i:r).call(this)},CKEDITOR.editor.prototype.getSelection=function(t){return!this._.savedSelection&&!this._.fakeSelection||t?(t=this.editable())&&"wysiwyg"==this.mode&&"recreating"!==this.status?new CKEDITOR.dom.selection(t):null:this._.savedSelection||this._.fakeSelection},CKEDITOR.editor.prototype.getSelectedRanges=function(t){var e=this.getSelection();return e&&e.getRanges(t)||[]},CKEDITOR.editor.prototype.lockSelection=function(t){return(t=t||this.getSelection(1)).getType()!=CKEDITOR.SELECTION_NONE&&(!t.isLocked&&t.lock(),this._.savedSelection=t,!0)},CKEDITOR.editor.prototype.unlockSelection=function(t){var e=this._.savedSelection;return!!e&&(e.unlock(t),delete this._.savedSelection,!0)},CKEDITOR.editor.prototype.forceNextSelectionCheck=function(){delete this._.selectionPreviousPath},CKEDITOR.dom.document.prototype.getSelection=function(){return new CKEDITOR.dom.selection(this)},CKEDITOR.dom.range.prototype.select=function(){var t=this.root instanceof CKEDITOR.editable?this.root.editor.getSelection():new CKEDITOR.dom.selection(this.root);return t.selectRanges([this]),t},CKEDITOR.SELECTION_NONE=1,CKEDITOR.SELECTION_TEXT=2,CKEDITOR.SELECTION_ELEMENT=3,CKEDITOR.dom.selection=function(t){if(t instanceof CKEDITOR.dom.selection){var e=t;t=t.root}var i,r,o=t instanceof CKEDITOR.dom.element;if(this.rev=e?e.rev:m++,this.document=t instanceof CKEDITOR.dom.document?t:t.getDocument(),this.root=o?t:this.document.getBody(),this.isLocked=0,this._={cache:{}},e)return CKEDITOR.tools.extend(this._.cache,e._.cache),this.isFake=e.isFake,this.isLocked=e.isLocked,this;if(t=this.getNative())if(t.getRangeAt)i=(r=t.rangeCount&&t.getRangeAt(0))&&new CKEDITOR.dom.node(r.commonAncestorContainer);else{try{r=t.createRange()}catch(n){}i=r&&CKEDITOR.dom.element.get(r.item&&r.item(0)||r.parentElement())}return(!i||i.type!=CKEDITOR.NODE_ELEMENT&&i.type!=CKEDITOR.NODE_TEXT||!this.root.equals(i)&&!this.root.contains(i))&&(this._.cache.type=CKEDITOR.SELECTION_NONE,this._.cache.startElement=null,this._.cache.selectedElement=null,this._.cache.selectedText="",this._.cache.ranges=new CKEDITOR.dom.rangeList),this};var I={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1};CKEDITOR.tools.extend(CKEDITOR.dom.selection,{_removeFillingCharSequenceString:u,_createFillingCharSequenceNode:l,FILLING_CHAR_SEQUENCE:v}),CKEDITOR.dom.selection.prototype={getNative:function(){return void 0!==this._.cache.nativeSel?this._.cache.nativeSel:this._.cache.nativeSel=g?this.document.$.selection:this.document.getWindow().$.getSelection()},getType:g?function(){var e=this._.cache;if(e.type)return e.type;var n=CKEDITOR.SELECTION_NONE;try{var i=this.getNative(),r=i.type;"Text"==r&&(n=CKEDITOR.SELECTION_TEXT),"Control"==r&&(n=CKEDITOR.SELECTION_ELEMENT),i.createRange().parentElement()&&(n=CKEDITOR.SELECTION_TEXT)}catch(t){}return e.type=n}:function(){var t=this._.cache;if(t.type)return t.type;var e=CKEDITOR.SELECTION_TEXT;if((n=this.getNative())&&n.rangeCount){if(1==n.rangeCount){var n,i=(n=n.getRangeAt(0)).startContainer;i==n.endContainer&&1==i.nodeType&&1==n.endOffset-n.startOffset&&I[i.childNodes[n.startOffset].nodeName.toLowerCase()]&&(e=CKEDITOR.SELECTION_ELEMENT)}}else e=CKEDITOR.SELECTION_NONE;return t.type=e},getRanges:function(){var t=g?function(){function t(t){return new CKEDITOR.dom.node(t).getIndex()}var e=function(e,n){(e=e.duplicate()).collapse(n);var i=e.parentElement();if(!i.hasChildNodes())return{container:i,offset:0};for(var r,o,s,a,l=i.children,c=e.duplicate(),u=0,h=l.length-1,f=-1;u<=h;)if(r=l[f=Math.floor((u+h)/2)],c.moveToElementText(r),0<(s=c.compareEndPoints("StartToStart",e)))h=f-1;else{if(!(0>s))return{container:i,offset:t(r)};u=f+1}if(-1==f||f==l.length-1&&0>s){if(c.moveToElementText(i),c.setEndPoint("StartToStart",e),c=c.text.replace(/(\r\n|\r)/g,"\n").length,l=i.childNodes,!c)return(r=l[l.length-1]).nodeType!=CKEDITOR.NODE_TEXT?{container:i,offset:l.length}:{container:r,offset:r.nodeValue.length};for(i=l.length;0<c&&0<i;)(o=l[--i]).nodeType==CKEDITOR.NODE_TEXT&&(a=o,c-=o.nodeValue.length);return{container:a,offset:-c}}if(c.collapse(0<s),c.setEndPoint(0<s?"StartToStart":"EndToStart",e),!(c=c.text.replace(/(\r\n|\r)/g,"\n").length))return{container:i,offset:t(r)+(0<s?0:1)};for(;0<c;)try{(o=r[0<s?"previousSibling":"nextSibling"]).nodeType==CKEDITOR.NODE_TEXT&&(c-=o.nodeValue.length,a=o),r=o}catch(d){return{container:i,offset:t(r)}}return{container:a,offset:0<s?-c:a.nodeValue.length+c}};return function(){var t=(a=this.getNative())&&a.createRange(),n=this.getType();if(!a)return[];if(n==CKEDITOR.SELECTION_TEXT)return a=new CKEDITOR.dom.range(this.root),n=e(t,!0),a.setStart(new CKEDITOR.dom.node(n.container),n.offset),n=e(t),a.setEnd(new CKEDITOR.dom.node(n.container),n.offset),a.endContainer.getPosition(a.startContainer)&CKEDITOR.POSITION_PRECEDING&&a.endOffset<=a.startContainer.getIndex()&&a.collapse(),[a];if(n==CKEDITOR.SELECTION_ELEMENT){n=[];for(var i=0;i<t.length;i++){for(var r=t.item(i),o=r.parentNode,s=0,a=new CKEDITOR.dom.range(this.root);s<o.childNodes.length&&o.childNodes[s]!=r;s++);a.setStart(new CKEDITOR.dom.node(o),s),a.setEnd(new CKEDITOR.dom.node(o),s+1),n.push(a)}return n}return[]}}():function(){var t,e=[],n=this.getNative();if(!n)return e;for(var i=0;i<n.rangeCount;i++){var r=n.getRangeAt(i);(t=new CKEDITOR.dom.range(this.root)).setStart(new CKEDITOR.dom.node(r.startContainer),r.startOffset),t.setEnd(new CKEDITOR.dom.node(r.endContainer),r.endOffset),e.push(t)}return e};return function(e){var n=this._.cache,i=n.ranges;return i||(n.ranges=i=new CKEDITOR.dom.rangeList(t.call(this))),e?function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n.getCommonAncestor().isReadOnly()&&t.splice(e,1),!n.collapsed){if(n.startContainer.isReadOnly())for(var i,r=n.startContainer;r&&!((i=r.type==CKEDITOR.NODE_ELEMENT)&&r.is("body")||!r.isReadOnly());)i&&"false"==r.getAttribute("contentEditable")&&n.setStartAfter(r),r=r.getParent();r=n.startContainer,i=n.endContainer;var o=n.startOffset,s=n.endOffset,a=n.clone();r&&r.type==CKEDITOR.NODE_TEXT&&(o>=r.getLength()?a.setStartAfter(r):a.setStartBefore(r)),i&&i.type==CKEDITOR.NODE_TEXT&&(s?a.setEndAfter(i):a.setEndBefore(i)),(r=new CKEDITOR.dom.walker(a)).evaluator=function(i){if(i.type==CKEDITOR.NODE_ELEMENT&&i.isReadOnly()){var r=n.clone();return n.setEndBefore(i),n.collapsed&&t.splice(e--,1),i.getPosition(a.endContainer)&CKEDITOR.POSITION_CONTAINS||(r.setStartAfter(i),r.collapsed||t.splice(e+1,0,r)),!0}return!1},r.next()}}return t}(new CKEDITOR.dom.rangeList(i.slice())):i}}(),getStartElement:function(){var t,e=this._.cache;if(void 0!==e.startElement)return e.startElement;switch(this.getType()){case CKEDITOR.SELECTION_ELEMENT:return this.getSelectedElement();case CKEDITOR.SELECTION_TEXT:var n=this.getRanges()[0];if(n){if(n.collapsed)(t=n.startContainer).type!=CKEDITOR.NODE_ELEMENT&&(t=t.getParent());else{for(n.optimize();t=n.startContainer,n.startOffset==(t.getChildCount?t.getChildCount():t.getLength())&&!t.isBlockBoundary();)n.setStartAfter(t);if((t=n.startContainer).type!=CKEDITOR.NODE_ELEMENT)return t.getParent();if((t=t.getChild(n.startOffset))&&t.type==CKEDITOR.NODE_ELEMENT)for(n=t.getFirst();n&&n.type==CKEDITOR.NODE_ELEMENT;)t=n,n=n.getFirst();else t=n.startContainer}t=t.$}}return e.startElement=t?new CKEDITOR.dom.element(t):null},getSelectedElement:function(){var t=this._.cache;if(void 0!==t.selectedElement)return t.selectedElement;var e=this,n=CKEDITOR.tools.tryThese(function(){return e.getNative().createRange().item(0)},function(){for(var t,n,i=e.getRanges()[0].clone(),r=2;r&&!((t=i.getEnclosedNode())&&t.type==CKEDITOR.NODE_ELEMENT&&I[t.getName()]&&(n=t));r--)i.shrink(CKEDITOR.SHRINK_ELEMENT);return n&&n.$});return t.selectedElement=n?new CKEDITOR.dom.element(n):null},getSelectedText:function(){var t=this._.cache;if(void 0!==t.selectedText)return t.selectedText;var e=this.getNative();e=g?"Control"==e.type?"":e.createRange().text:e.toString();return t.selectedText=e},lock:function(){this.getRanges(),this.getStartElement(),this.getSelectedElement(),this.getSelectedText(),this._.cache.nativeSel=null,this.isLocked=1},unlock:function(t){if(this.isLocked){if(t)var i=this.getSelectedElement(),r=this.getRanges(),o=this.isFake;this.isLocked=0,this.reset(),t&&(t=i||r[0]&&r[0].getCommonAncestor())&&t.getAscendant("body",1)&&((t=this.root.editor)&&t.plugins.tableselection&&t.plugins.tableselection.isSupportedEnvironment(t)&&e(r)?n.call(this,r):o?this.fake(i):i&&2>r.length?this.selectElement(i):this.selectRanges(r))}},reset:function(){this._.cache={},this.isFake=0;var t=this.root.editor;if(t&&t._.fakeSelection)if(this.rev==t._.fakeSelection.rev){delete t._.fakeSelection;var e=t._.hiddenSelectionContainer;if(e){var n=t.checkDirty();t.fire("lockSnapshot"),e.remove(),t.fire("unlockSnapshot"),!n&&t.resetDirty()}delete t._.hiddenSelectionContainer}else CKEDITOR.warn("selection-fake-reset");this.rev=m++},selectElement:function(t){var e=new CKEDITOR.dom.range(this.root);e.setStartBefore(t),e.setEndAfter(t),this.selectRanges([e])},selectRanges:function(t){var i=this.root.editor,r=i&&i._.hiddenSelectionContainer;if(this.reset(),r){r=this.root;for(var o,s=0;s<t.length;++s)(o=t[s]).endContainer.equals(r)&&(o.endOffset=Math.min(o.endOffset,r.getChildCount()))}if(t.length)if(this.isLocked){var u=CKEDITOR.document.getActive();this.unlock(),this.selectRanges(t),this.lock(),u&&!u.equals(this.root)&&u.focus()}else{var f,p,m;if(1==t.length&&!(m=t[0]).collapsed&&(f=m.getEnclosedNode())&&f.type==CKEDITOR.NODE_ELEMENT&&((m=m.clone()).shrink(CKEDITOR.SHRINK_ELEMENT,!0),(p=m.getEnclosedNode())&&p.type==CKEDITOR.NODE_ELEMENT&&(f=p),"false"==f.getAttribute("contenteditable"))||(f=void 0),f)this.fake(f);else if(i&&i.plugins.tableselection&&i.plugins.tableselection.isSupportedEnvironment(i)&&e(t)&&!d&&!t[0]._getTableElement({table:1}).hasAttribute("data-cke-tableselection-ignored"))n.call(this,t);else{if(g){var v,b,C;if(p=CKEDITOR.dom.walker.whitespaces(!0),f=/\ufeff|\u00a0/,m={table:1,tbody:1,tr:1},1<t.length&&(i=t[t.length-1],t[0].setEnd(i.endContainer,i.endOffset)),t=(i=t[0]).collapsed,(r=i.getEnclosedNode())&&r.type==CKEDITOR.NODE_ELEMENT&&r.getName()in I&&(!r.is("a")||!r.getText()))try{return(C=r.$.createControlRange()).addElement(r.$),void C.select()}catch(h){}(i.startContainer.type==CKEDITOR.NODE_ELEMENT&&i.startContainer.getName()in m||i.endContainer.type==CKEDITOR.NODE_ELEMENT&&i.endContainer.getName()in m)&&(i.shrink(CKEDITOR.NODE_ELEMENT,!0),t=i.collapsed),m=(C=i.createBookmark()).startNode,t||(u=C.endNode),(C=i.document.$.body.createTextRange()).moveToElementText(m.$),C.moveStart("character",1),u?((f=i.document.$.body.createTextRange()).moveToElementText(u.$),C.setEndPoint("EndToEnd",f),C.moveEnd("character",-1)):(v=m.getNext(p),b=m.hasAscendant("pre"),v=!(v&&v.getText&&v.getText().match(f))&&(b||!m.hasPrevious()||m.getPrevious().is&&m.getPrevious().is("br")),(b=i.document.createElement("span")).setHtml("&#65279;"),b.insertBefore(m),v&&i.document.createText("\ufeff").insertBefore(m)),i.setStartBefore(m),m.remove(),t?(v?(C.moveStart("character",-1),C.select(),i.document.$.selection.clear()):C.select(),i.moveToPosition(b,CKEDITOR.POSITION_BEFORE_START),b.remove()):(i.setEndBefore(u),u.remove(),C.select())}else{if(!(u=this.getNative()))return;for(this.removeAllRanges(),C=0;C<t.length;C++)if(C<t.length-1&&(v=t[C],b=t[C+1],(f=v.clone()).setStart(v.endContainer,v.endOffset),f.setEnd(b.startContainer,b.startOffset),!f.collapsed&&(f.shrink(CKEDITOR.NODE_ELEMENT,!0),i=f.getCommonAncestor(),f=f.getEnclosedNode(),i.isReadOnly()||f&&f.isReadOnly())))b.setStart(v.startContainer,v.startOffset),t.splice(C--,1);else{i=t[C],b=this.document.$.createRange(),i.collapsed&&CKEDITOR.env.webkit&&a(i)&&(f=l(this.root),i.insertNode(f),(v=f.getNext())&&!f.getPrevious()&&v.type==CKEDITOR.NODE_ELEMENT&&"br"==v.getName()?(c(this.root),i.moveToPosition(v,CKEDITOR.POSITION_BEFORE_START)):i.moveToPosition(f,CKEDITOR.POSITION_AFTER_END)),b.setStart(i.startContainer.$,i.startOffset);try{b.setEnd(i.endContainer.$,i.endOffset)}catch(y){if(!(0<=y.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")))throw y;i.collapse(1),b.setEnd(i.endContainer.$,i.endOffset)}u.addRange(b)}}this.reset(),this.root.fire("selectionchange")}}},fake:function(t,e){var n=this.root.editor;void 0===e&&t.hasAttribute("aria-label")&&(e=t.getAttribute("aria-label")),this.reset(),function(t,e){var n=e&&CKEDITOR.tools.htmlEncode(e)||"&nbsp;";n=CKEDITOR.dom.element.createFromHtml('<div data-cke-hidden-sel="1" data-cke-temp="1" style="'+(CKEDITOR.env.ie&&14>CKEDITOR.env.version?"display:none":"position:fixed;top:0;left:-1000px;width:0;height:0;overflow:hidden;")+'">'+n+"</div>",t.document),t.fire("lockSnapshot"),t.editable().append(n);var i=t.getSelection(1),r=t.createRange(),o=i.root.on("selectionchange",function(t){t.cancel()},null,null,0);r.setStartAt(n,CKEDITOR.POSITION_AFTER_START),r.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),i.selectRanges([r]),o.removeListener(),t.fire("unlockSnapshot"),t._.hiddenSelectionContainer=n}(n,e);var i=this._.cache,r=new CKEDITOR.dom.range(this.root);r.setStartBefore(t),r.setEndAfter(t),i.ranges=new CKEDITOR.dom.rangeList(r),i.selectedElement=i.startElement=t,i.type=CKEDITOR.SELECTION_ELEMENT,i.selectedText=i.nativeSel=null,this.isFake=1,this.rev=m++,n._.fakeSelection=this,this.root.fire("selectionchange")},isHidden:function(){var t=this.getCommonAncestor();return t&&t.type==CKEDITOR.NODE_TEXT&&(t=t.getParent()),!(!t||!t.data("cke-hidden-sel"))},isInTable:function(t){return e(this.getRanges(),t)},isCollapsed:function(){var t=this.getRanges();return 1===t.length&&t[0].collapsed},createBookmarks:function(t){return t=this.getRanges().createBookmarks(t),this.isFake&&(t.isFake=1),t},createBookmarks2:function(t){return t=this.getRanges().createBookmarks2(t),this.isFake&&(t.isFake=1),t},selectBookmarks:function(t){for(var n,i=[],r=0;r<t.length;r++){var o=new CKEDITOR.dom.range(this.root);o.moveToBookmark(t[r]),i.push(o)}return t.isFake&&((n=e(i)?i[0]._getTableElement():i[0].getEnclosedNode())&&n.type==CKEDITOR.NODE_ELEMENT||(CKEDITOR.warn("selection-not-fake"),t.isFake=0)),t.isFake&&!e(i)?this.fake(n):this.selectRanges(i),this},getCommonAncestor:function(){var t=this.getRanges();return t.length?t[0].startContainer.getCommonAncestor(t[t.length-1].endContainer):null},scrollIntoView:function(){this.getType()!=CKEDITOR.SELECTION_NONE&&this.getRanges()[0].scrollIntoView()},removeAllRanges:function(){if(this.getType()!=CKEDITOR.SELECTION_NONE){var t=this.getNative();try{t&&t[g?"empty":"removeAllRanges"]()}catch(l){}this.reset()}}}}(),CKEDITOR.STYLE_BLOCK=1,CKEDITOR.STYLE_INLINE=2,CKEDITOR.STYLE_OBJECT=3,function(){function t(t,e){for(var n,i;(t=t.getParent())&&!t.equals(e);)if(t.getAttribute("data-nostyle"))n=t;else if(!i){var r=t.getAttribute("contentEditable");"false"==r?n=t:"true"==r&&(i=1)}return n}function e(t,e,n,i){return(t.getPosition(e)|i)==i&&(!n.childRule||n.childRule(t))}function n(i){var o=i.document;if(i.collapsed)o=g(this,o),i.insertNode(o),i.moveToPosition(o,CKEDITOR.POSITION_BEFORE_END);else{var s,a=this.element,l=this._.definition,c=(y=l.ignoreReadonly)||l.includeReadonly;null==c&&(c=i.root.getCustomData("cke_includeReadonly"));var u=CKEDITOR.dtd[a];u||(s=!0,u=CKEDITOR.dtd.span),i.enlarge(CKEDITOR.ENLARGE_INLINE,1),i.trim();var h,f=i.createBookmark(),p=f.startNode,m=f.endNode,v=p;if(!y){var y=t(p,b=i.getCommonAncestor()),b=t(m,b);y&&(v=y.getNextSourceNode(!0)),b&&(m=b)}for(v.getPosition(m)==CKEDITOR.POSITION_FOLLOWING&&(v=0);v;){if(y=!1,v.equals(m))v=null,y=!0;else{b=(D=v.type==CKEDITOR.NODE_ELEMENT?v.getName():null)&&"false"==v.getAttribute("contentEditable");var C=D&&-1!==CKEDITOR.tools.array.indexOf(CKEDITOR.style.unstylableElements,D);C=D&&(v.getAttribute("data-nostyle")||C);if(D&&v.data("cke-bookmark")||v.type===CKEDITOR.NODE_COMMENT){v=v.getNextSourceNode(!0);continue}if(b&&c&&CKEDITOR.dtd.$block[D])for(var I=void 0,E=0,T=(M=(N=r(T=v)).length)&&new CKEDITOR.dom.range(T.getDocument());E<M;++E){I=N[E];var w=CKEDITOR.filter.instances[I.data("cke-filter")];w&&!w.check(this)||(T.selectNodeContents(I),n.call(this,T))}if(N=D?!u[D]||C||b&&!c?0:e(v,m,l,A):1){if(N=l,M=a,E=s,!(I=v.getParent())||!(I.getDtd()||CKEDITOR.dtd.span)[M]&&!E||N.parentRule&&!N.parentRule(I))y=!0;else if(h||D&&CKEDITOR.dtd.$removeEmpty[D]&&(v.getPosition(m)|A)!=A||(h=i.clone()).setStartBefore(v),(D=v.type)==CKEDITOR.NODE_TEXT||b||D==CKEDITOR.NODE_ELEMENT&&!v.getChildCount()){for(var x,D=v;(y=!D.getNext(_))&&u[(x=D.getParent()).getName()]&&e(x,p,l,O);)D=x;h.setEndAfter(D)}}else y=!0;v=v.getNextSourceNode(C||b)}if(y&&h&&!h.collapsed){b=(y=g(this,o)).hasAttributes(),C=h.getCommonAncestor(),D={};for(var S,R,k,N={},M=(I={},{});y&&C;){if(C.getName()==a){for(S in l.attributes)!M[S]&&(k=C.getAttribute(R))&&(y.getAttribute(S)==k?N[S]=1:M[S]=1);for(R in l.styles)!I[R]&&(k=C.getStyle(R))&&(y.getStyle(R)==k?D[R]=1:I[R]=1)}C=C.getParent()}for(S in N)y.removeAttribute(S);for(R in D)y.removeStyle(R);b&&!y.hasAttributes()&&(y=null),y?(h.extractContents().appendTo(y),h.insertNode(y),d.call(this,y),y.mergeSiblings(),CKEDITOR.env.ie||y.$.normalize()):(y=new CKEDITOR.dom.element("span"),h.extractContents().appendTo(y),h.insertNode(y),d.call(this,y),y.remove(!0)),h=null}}i.moveToBookmark(f),i.shrink(CKEDITOR.SHRINK_TEXT),i.shrink(CKEDITOR.NODE_ELEMENT,!0)}}function i(t){function e(){for(var t=new CKEDITOR.dom.elementPath(i.getParent()),e=new CKEDITOR.dom.elementPath(u.getParent()),n=null,r=null,o=0;o<t.elements.length;o++){var s=t.elements[o];if(s==t.block||s==t.blockLimit)break;d.checkElementRemovable(s,!0)&&(n=s)}for(o=0;o<e.elements.length&&((s=e.elements[o])!=e.block&&s!=e.blockLimit);o++)d.checkElementRemovable(s,!0)&&(r=s);r&&u.breakParent(r),n&&i.breakParent(n)}t.enlarge(CKEDITOR.ENLARGE_INLINE,1);var n=t.createBookmark(),i=n.startNode,r=this._.definition.alwaysRemoveElement;if(t.collapsed){for(var o,s,a=new CKEDITOR.dom.elementPath(i.getParent(),t.root),l=0;l<a.elements.length&&(s=a.elements[l])&&s!=a.block&&s!=a.blockLimit;l++)if(this.checkElementRemovable(s)){var c;!r&&t.collapsed&&(t.checkBoundaryOfElement(s,CKEDITOR.END)||(c=t.checkBoundaryOfElement(s,CKEDITOR.START)))?(o=s).match=c?"start":"end":(s.mergeSiblings(),s.is(this.element)?h.call(this,s):f(s,y(this)[s.getName()]))}if(o){for(r=i,l=0;!(s=a.elements[l]).equals(o);l++)s.match||((s=s.clone()).append(r),r=s);r["start"==o.match?"insertBefore":"insertAfter"](o)}}else{var u=n.endNode,d=this;for(e(),a=i;!a.equals(u);)o=a.getNextSourceNode(),a.type==CKEDITOR.NODE_ELEMENT&&this.checkElementRemovable(a)&&(a.getName()==this.element?h.call(this,a):f(a,y(this)[a.getName()]),o.type==CKEDITOR.NODE_ELEMENT&&o.contains(i)&&(e(),o=i.getNext())),a=o}t.moveToBookmark(n),t.shrink(CKEDITOR.NODE_ELEMENT,!0)}function r(t){var e=[];return t.forEach(function(t){if("true"==t.getAttribute("contenteditable"))return e.push(t),!1},CKEDITOR.NODE_ELEMENT,!0),e}function o(t){var e=t.getEnclosedNode()||t.getCommonAncestor(!1,!0);(t=new CKEDITOR.dom.elementPath(e,t.root).contains(this.element,1))&&!t.isReadOnly()&&m(t,this)}function s(t){var e=t.getCommonAncestor(!0,!0);if(t=new CKEDITOR.dom.elementPath(e,t.root).contains(this.element,1)){var n=(e=this._.definition).attributes;if(n)for(var i in n)t.removeAttribute(i,n[i]);if(e.styles)for(var r in e.styles)e.styles.hasOwnProperty(r)&&t.removeStyle(r)}}function a(t){var e=t.createBookmark(!0),n=t.createIterator();n.enforceRealBlocks=!0,this._.enterMode&&(n.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR);for(var i,r=t.document;i=n.getNextParagraph();)!i.isReadOnly()&&(!n.activeFilter||n.activeFilter.check(this))&&c(i,g(this,r,i));t.moveToBookmark(e)}function l(t){var e,n,i=t.createBookmark(1),r=t.createIterator();for(r.enforceRealBlocks=!0,r.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR;e=r.getNextParagraph();)this.checkElementRemovable(e)&&(e.is("pre")?((n=this._.enterMode==CKEDITOR.ENTER_BR?null:t.document.createElement(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))&&e.copyAttributes(n),c(e,n)):h.call(this,e));t.moveToBookmark(i)}function c(t,e){(n=!e)&&(e=t.getDocument().createElement("div"),t.copyAttributes(e));var n,i,r=e&&e.is("pre"),o=t.is("pre"),s=!r&&o;if(r&&!o){if(o=e,(s=t.getBogus())&&s.remove(),s=(s=(s=(s=u(s=t.getHtml(),/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"")).replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1")).replace(/([ \t\n\r]+|&nbsp;)/g," ")).replace(/<br\b[^>]*>/gi,"\n"),CKEDITOR.env.ie){var a=t.getDocument().createElement("div");a.append(o),o.$.outerHTML="<pre>"+s+"</pre>",o.copyAttributes(a.getFirst()),o=a.getFirst().remove()}else o.setHtml(s);e=o}else s?e=function(t,e){var n;1<t.length&&(n=new CKEDITOR.dom.documentFragment(e.getDocument()));for(var i=0;i<t.length;i++){var r=u(r=(r=t[i]).replace(/(\r\n|\r)/g,"\n"),/^[ \t]*\n/,"");r=u(r,/\n$/,""),r=u(r,/^[ \t]+|[ \t]+$/g,function(t,e){return 1==t.length?"&nbsp;":e?" "+CKEDITOR.tools.repeat("&nbsp;",t.length-1):CKEDITOR.tools.repeat("&nbsp;",t.length-1)+" "}),r=(r=r.replace(/\n/g,"<br>")).replace(/[ \t]{2,}/g,function(t){return CKEDITOR.tools.repeat("&nbsp;",t.length-1)+" "});if(n){var o=e.clone();o.setHtml(r),n.append(o)}else e.setHtml(r)}return n||e}(n?[t.getHtml()]:function(t){var e=[];return u(t.getOuterHtml(),/(\S\s*)\n(?:\s|(<span[^>]+data-cke-bookmark.*?\/span>))*\n(?!$)/gi,function(t,e,n){return e+"</pre>"+n+"<pre>"}).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(t,n){e.push(n)}),e}(t),e):t.moveChildren(e);(e.replace(t),r)?(i=(n=e).getPrevious(D))&&i.type==CKEDITOR.NODE_ELEMENT&&i.is("pre")&&(r=u(i.getHtml(),/\n$/,"")+"\n\n"+u(n.getHtml(),/^\n/,""),CKEDITOR.env.ie?n.$.outerHTML="<pre>"+r+"</pre>":n.setHtml(r),i.remove()):n&&p(e)}function u(t,e,n){var i="",r="";return t=t.replace(/(^<span[^>]+data-cke-bookmark.*?\/span>)|(<span[^>]+data-cke-bookmark.*?\/span>$)/gi,function(t,e,n){return e&&(i=e),n&&(r=n),""}),i+t.replace(e,n)+r}function h(t,e){var n,i=(r=this._.definition).attributes,r=r.styles,o=y(this)[t.getName()],s=CKEDITOR.tools.isEmpty(i)&&CKEDITOR.tools.isEmpty(r);for(n in i)("class"!=n&&!this._.definition.fullMatch||t.getAttribute(n)==b(n,i[n]))&&(e&&"data-"==n.slice(0,5)||(s=t.hasAttribute(n),t.removeAttribute(n)));for(var a in r)this._.definition.fullMatch&&t.getStyle(a)!=b(a,r[a],!0)||(s=s||!!t.getStyle(a),t.removeStyle(a));f(t,o,E[t.getName()]),s&&(this._.definition.alwaysRemoveElement?p(t,1):!CKEDITOR.dtd.$block[t.getName()]||this._.enterMode==CKEDITOR.ENTER_BR&&!t.hasAttributes()?p(t):t.renameNode(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))}function d(t){for(var e,n=y(this),i=t.getElementsByTag(this.element),r=i.count();0<=--r;)(e=i.getItem(r)).isReadOnly()||h.call(this,e,!0);for(var o in n)if(o!=this.element)for(r=(i=t.getElementsByTag(o)).count()-1;0<=r;r--)(e=i.getItem(r)).isReadOnly()||f(e,n[o])}function f(t,e,n){if(e=e&&e.attributes)for(var i=0;i<e.length;i++){var r,o=e[i][0];if(r=t.getAttribute(o)){var s=e[i][1];(null===s||s.test&&s.test(r)||"string"==typeof s&&r==s)&&t.removeAttribute(o)}}n||p(t)}function p(t,e){if(!t.hasAttributes()||e)if(CKEDITOR.dtd.$block[t.getName()]){var n=t.getPrevious(D),i=t.getNext(D);!n||n.type!=CKEDITOR.NODE_TEXT&&n.isBlockBoundary({br:1})||t.append("br",1),!i||i.type!=CKEDITOR.NODE_TEXT&&i.isBlockBoundary({br:1})||t.append("br"),t.remove(!0)}else n=t.getFirst(),i=t.getLast(),t.remove(!0),n&&(n.type==CKEDITOR.NODE_ELEMENT&&n.mergeSiblings(),i&&!n.equals(i)&&i.type==CKEDITOR.NODE_ELEMENT&&i.mergeSiblings())}function g(t,e,n){var i;return"*"==(i=t.element)&&(i="span"),i=new CKEDITOR.dom.element(i,e),n&&n.copyAttributes(i),i=m(i,t),e.getCustomData("doc_processing_style")&&i.hasAttribute("id")?i.removeAttribute("id"):e.setCustomData("doc_processing_style",1),i}function m(t,e){var n=(i=e._.definition).attributes,i=CKEDITOR.style.getStyleText(i);if(n)for(var r in n)t.setAttribute(r,n[r]);return i&&t.setAttribute("style",i),t.getDocument().removeCustomData("doc_processing_style"),t}function v(t,e){for(var n in t)t[n]=t[n].replace(x,function(t,n){return e[n]})}function y(t){if(t._.overrides)return t._.overrides;var e=t._.overrides={},n=t._.definition.overrides;if(n){CKEDITOR.tools.isArray(n)||(n=[n]);for(var i=0;i<n.length;i++){var r,o;if("string"==typeof(a=n[i])?r=a.toLowerCase():(r=a.element?a.element.toLowerCase():t.element,o=a.attributes),a=e[r]||(e[r]={}),o){var s,a=a.attributes=a.attributes||[];for(s in o)a.push([s.toLowerCase(),o[s]])}}}return e}function b(t,e,n){var i=new CKEDITOR.dom.element("span");return i[n?"setStyle":"setAttribute"](t,e),i[n?"getStyle":"getAttribute"](t)}function C(t,e){function n(t,e){return"font-family"==e.toLowerCase()?t.replace(/["']/g,""):t}for(var i in"string"==typeof t&&(t=CKEDITOR.tools.parseCssText(t)),"string"==typeof e&&(e=CKEDITOR.tools.parseCssText(e,!0)),t)if(!(i in e)||n(e[i],i)!=n(t[i],i)&&"inherit"!=t[i]&&"inherit"!=e[i])return!1;return!0}function I(t,e,n){var i=t.getRanges();e=e?this.removeFromRange:this.applyToRange;for(var r,o=i.createIterator();r=o.getNextRange();)e.call(this,r,n);t.selectRanges(i)}var E={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,section:1,header:1,footer:1,nav:1,article:1,aside:1,figure:1,dialog:1,hgroup:1,time:1,meter:1,menu:1,command:1,keygen:1,output:1,progress:1,details:1,datagrid:1,datalist:1},T={a:1,blockquote:1,embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1,audio:1,video:1},w=/\s*(?:;\s*|$)/,x=/#\((.+?)\)/g,_=CKEDITOR.dom.walker.bookmark(0,1),D=CKEDITOR.dom.walker.whitespaces(1);CKEDITOR.style=function(t,e){if("string"==typeof t.type)return new CKEDITOR.style.customHandlers[t.type](t);var n=t.attributes;n&&n.style&&(t.styles=CKEDITOR.tools.extend({},t.styles,CKEDITOR.tools.parseCssText(n.style)),delete n.style),e&&(v((t=CKEDITOR.tools.clone(t)).attributes,e),v(t.styles,e)),n=this.element=t.element?"string"==typeof t.element?t.element.toLowerCase():t.element:"*",this.type=t.type||(E[n]?CKEDITOR.STYLE_BLOCK:T[n]?CKEDITOR.STYLE_OBJECT:CKEDITOR.STYLE_INLINE),"object"==typeof this.element&&(this.type=CKEDITOR.STYLE_OBJECT),this._={definition:t}},CKEDITOR.style.prototype={apply:function(t){if(t instanceof CKEDITOR.dom.document)return I.call(this,t.getSelection());if(this.checkApplicable(t.elementPath(),t)){var e=this._.enterMode;e||(this._.enterMode=t.activeEnterMode),I.call(this,t.getSelection(),0,t),this._.enterMode=e}},remove:function(t){if(t instanceof CKEDITOR.dom.document)return I.call(this,t.getSelection(),1);if(this.checkApplicable(t.elementPath(),t)){var e=this._.enterMode;e||(this._.enterMode=t.activeEnterMode),I.call(this,t.getSelection(),1,t),this._.enterMode=e}},applyToRange:function(t){return this.applyToRange=this.type==CKEDITOR.STYLE_INLINE?n:this.type==CKEDITOR.STYLE_BLOCK?a:this.type==CKEDITOR.STYLE_OBJECT?o:null,this.applyToRange(t)},removeFromRange:function(t){return this.removeFromRange=this.type==CKEDITOR.STYLE_INLINE?i:this.type==CKEDITOR.STYLE_BLOCK?l:this.type==CKEDITOR.STYLE_OBJECT?s:null,this.removeFromRange(t)},applyToObject:function(t){m(t,this)},checkActive:function(t,e){switch(this.type){case CKEDITOR.STYLE_BLOCK:return this.checkElementRemovable(t.block||t.blockLimit,!0,e);case CKEDITOR.STYLE_OBJECT:case CKEDITOR.STYLE_INLINE:for(var n,i=t.elements,r=0;r<i.length;r++)if(n=i[r],this.type!=CKEDITOR.STYLE_INLINE||n!=t.block&&n!=t.blockLimit){if(this.type==CKEDITOR.STYLE_OBJECT){var o=n.getName();if(!("string"==typeof this.element?o==this.element:o in this.element))continue}if(this.checkElementRemovable(n,!0,e))return!0}}return!1},checkApplicable:function(t,e,n){if(e&&e instanceof CKEDITOR.filter&&(n=e),n&&!n.check(this))return!1;switch(this.type){case CKEDITOR.STYLE_OBJECT:return!!t.contains(this.element);case CKEDITOR.STYLE_BLOCK:return!!t.blockLimit.getDtd()[this.element]}return!0},checkElementMatch:function(t,e){var n=this._.definition;if(!t||!n.ignoreReadonly&&t.isReadOnly())return!1;var i=t.getName();if("string"==typeof this.element?i==this.element:i in this.element){if(!e&&!t.hasAttributes())return!0;if(i=n._AC)n=i;else{i={};var r=0,o=n.attributes;if(o)for(var s in o)r++,i[s]=o[s];(s=CKEDITOR.style.getStyleText(n))&&(i.style||r++,i.style=s),i._length=r,n=n._AC=i}if(!n._length)return!0;for(var a in n)if("_length"!=a)if(i=t.getAttribute(a)||"","style"==a?C(n[a],i):n[a]==i){if(!e)return!0}else if(e)return!1;if(e)return!0}return!1},checkElementRemovable:function(t,e,n){if(this.checkElementMatch(t,e,n))return!0;if(e=y(this)[t.getName()]){var i;if(!(e=e.attributes))return!0;for(n=0;n<e.length;n++)if(i=e[n][0],i=t.getAttribute(i)){var r=e[n][1];if(null===r)return!0;if("string"==typeof r){if(i==r)return!0}else if(r.test(i))return!0}}return!1},buildPreview:function(t){var e=this._.definition,n=[],i=e.element;"bdo"==i&&(i="span");n=["<",i];var r=e.attributes;if(r)for(var o in r)n.push(" ",o,'="',r[o],'"');return(r=CKEDITOR.style.getStyleText(e))&&n.push(' style="',r,'"'),n.push(">",t||e.name,"</",i,">"),n.join("")},getDefinition:function(){return this._.definition}},CKEDITOR.style.getStyleText=function(t){if(e=t._ST)return e;var e=t.styles,n=t.attributes&&t.attributes.style||"",i="";for(var r in n.length&&(n=n.replace(w,";")),e){var o=e[r],s=(r+":"+o).replace(w,";");"inherit"==o?i+=s:n+=s}return n.length&&(n=CKEDITOR.tools.normalizeCssText(n,!0)),t._ST=n+i},CKEDITOR.style.customHandlers={},CKEDITOR.style.unstylableElements=[],CKEDITOR.style.addCustomHandler=function(t){var e=function(t){this._={definition:t},this.setup&&this.setup(t)};return e.prototype=CKEDITOR.tools.extend(CKEDITOR.tools.prototypedCopy(CKEDITOR.style.prototype),{assignedTo:CKEDITOR.STYLE_OBJECT},t,!0),this.customHandlers[t.type]=e};var A=CKEDITOR.POSITION_PRECEDING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED,O=CKEDITOR.POSITION_FOLLOWING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED}(),CKEDITOR.styleCommand=function(t,e){this.requiredContent=this.allowedContent=this.style=t,CKEDITOR.tools.extend(this,e,!0)},CKEDITOR.styleCommand.prototype.exec=function(t){t.focus(),this.state==CKEDITOR.TRISTATE_OFF?t.applyStyle(this.style):this.state==CKEDITOR.TRISTATE_ON&&t.removeStyle(this.style)},CKEDITOR.stylesSet=new CKEDITOR.resourceManager("","stylesSet"),CKEDITOR.addStylesSet=CKEDITOR.tools.bind(CKEDITOR.stylesSet.add,CKEDITOR.stylesSet),CKEDITOR.loadStylesSet=function(t,e,n){CKEDITOR.stylesSet.addExternal(t,e,""),CKEDITOR.stylesSet.load(t,n)},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{attachStyleStateChange:function(t,e){var n=this._.styleStateChangeCallbacks;n||(n=this._.styleStateChangeCallbacks=[],this.on("selectionChange",function(t){for(var e=0;e<n.length;e++){var i=n[e],r=i.style.checkActive(t.data.path,this)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF;i.fn.call(this,r)}})),n.push({style:t,fn:e})},applyStyle:function(t){t.apply(this)},removeStyle:function(t){t.remove(this)},getStylesSet:function(t){if(this._.stylesDefinitions)t(this._.stylesDefinitions);else{var e=this;if(!1===(n=e.config.stylesCombo_stylesSet||e.config.stylesSet))t(null);else if(n instanceof Array)e._.stylesDefinitions=n,t(n);else{n||(n="default");var n,i=(n=n.split(":"))[0];CKEDITOR.stylesSet.addExternal(i,n[1]?n.slice(1).join(":"):CKEDITOR.getUrl("styles.js"),""),CKEDITOR.stylesSet.load(i,function(n){e._.stylesDefinitions=n[i],t(e._.stylesDefinitions)})}}}}),function(){if(window.Promise)CKEDITOR.tools.promise=Promise;else{var t=CKEDITOR.getUrl("vendor/promise.js");if("function"==typeof window.define&&window.define.amd&&"function"==typeof window.require)return window.require([t],function(t){CKEDITOR.tools.promise=t});CKEDITOR.scriptLoader.load(t,function(e){return e?void 0!==window.ES6Promise?CKEDITOR.tools.promise=ES6Promise:void 0:CKEDITOR.error("no-vendor-lib",{path:t})})}}(),function(){function t(t,i,r){t.once("selectionCheck",function(t){if(!e){var o=t.data.getRanges()[0];r.equals(o)?t.cancel():i.equals(o)&&(n=!0)}},null,null,-1)}var e=!0,n=!1;CKEDITOR.dom.selection.setupEditorOptimization=function(t){t.on("selectionCheck",function(t){t.data&&!n&&t.data.optimizeInElementEnds(),n=!1}),t.on("contentDom",function(){var e=t.editable();e&&(e.attachListener(e,"keydown",function(t){this._.shiftPressed=t.data.$.shiftKey},this),e.attachListener(e,"keyup",function(t){this._.shiftPressed=t.data.$.shiftKey},this))})},CKEDITOR.dom.selection.prototype.optimizeInElementEnds=function(){var n,i=this.getRanges()[0],r=this.root.editor;if(this.root.editor._.shiftPressed||this.isFake||i.isCollapsed||i.startContainer.equals(i.endContainer)||(i.endContainer.is?i.endContainer.is("li"):i.endContainer.getParent().is&&i.endContainer.getParent().is("li")))n=!1;else if(0===i.endOffset)n=!0;else{n=i.startContainer.type===CKEDITOR.NODE_TEXT;var o=i.endContainer.type===CKEDITOR.NODE_TEXT,s=n?i.startContainer.getLength():i.startContainer.getChildCount();n=i.startOffset===s||n^o}n&&(n=i.clone(),i.shrink(CKEDITOR.SHRINK_TEXT,!1,{skipBogus:!CKEDITOR.env.webkit}),e=!1,t(r,i,n),i.select(),e=!0)}}(),function(){function t(t,e){return n(t)?t=Math.round(e*(parseFloat(t)/100)):("string"==typeof t&&t.match(/^\d+$/gm)||"string"==typeof t&&t.match(/^\d+(?:deg)?$/gm))&&(t=parseInt(t,10)),t}function e(t,e){return n(t)?t=e*(parseFloat(t)/100):"string"==typeof t&&t.match(/^\d?\.\d+/gm)&&(t=parseFloat(t)),t}function n(t){return"string"==typeof t&&t.match(/^((\d*\.\d+)|(\d+))%{1}$/gm)}function i(t,e,n){return!isNaN(t)&&t>=e&&t<=n}function r(t){return 1==(t=t.toString(16)).length?"0"+t:t}CKEDITOR.tools.color=CKEDITOR.tools.createClass({$:function(t,e){this._.initialColorCode=t,this._.defaultValue=e,this._.parseInput(t)},proto:{getHex:function(){if(!this._.isValidColor)return this._.defaultValue;var t=this._.blendAlphaColor(this._.red,this._.green,this._.blue,this._.alpha);return this._.formatHexString(t[0],t[1],t[2])},getHexWithAlpha:function(){if(!this._.isValidColor)return this._.defaultValue;var t=Math.round(this._.alpha*CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE);return this._.formatHexString(this._.red,this._.green,this._.blue,t)},getRgb:function(){if(!this._.isValidColor)return this._.defaultValue;var t=this._.blendAlphaColor(this._.red,this._.green,this._.blue,this._.alpha);return this._.formatRgbString("rgb",t[0],t[1],t[2])},getRgba:function(){return this._.isValidColor?this._.formatRgbString("rgba",this._.red,this._.green,this._.blue,this._.alpha):this._.defaultValue},getHsl:function(){var t=0===this._.alpha||1===this._.alpha;return this._.isValidColor?(this._.type===CKEDITOR.tools.color.TYPE_HSL&&t?t=[this._.hue,this._.saturation,this._.lightness]:(t=this._.blendAlphaColor(this._.red,this._.green,this._.blue,this._.alpha),t=this._.rgbToHsl(t[0],t[1],t[2])),this._.formatHslString("hsl",t[0],t[1],t[2])):this._.defaultValue},getHsla:function(){var t;return this._.isValidColor?(t=this._.type===CKEDITOR.tools.color.TYPE_HSL?[this._.hue,this._.saturation,this._.lightness]:this._.rgbToHsl(this._.red,this._.green,this._.blue),this._.formatHslString("hsla",t[0],t[1],t[2],this._.alpha)):this._.defaultValue},getInitialValue:function(){return this._.initialColorCode}},_:{initialColorCode:"",isValidColor:!0,type:0,hue:0,saturation:0,lightness:0,red:0,green:0,blue:0,alpha:1,blendAlphaColor:function(t,e,n,i){return CKEDITOR.tools.array.map([t,e,n],function(t){return Math.round(CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE-i*(CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE-t))})},formatHexString:function(t,e,n,i){return t="#"+r(t)+r(e)+r(n),void 0!==i&&(t+=r(i)),t.toUpperCase()},formatRgbString:function(t,e,n,i,r){return e=[e,n,i],void 0!==r&&e.push(r),t+"("+e.join(",")+")"},formatHslString:function(t,e,n,i,r){return t+"("+e+","+n+"%,"+i+"%"+(void 0!==r?","+r:"")+")"},parseInput:function(t){if("string"!=typeof t)this._.isValidColor=!1;else{t=CKEDITOR.tools.trim(t),(e=this._.matchStringToNamedColor(t))&&(t=e);var e=this._.extractColorChannelsFromHex(t),n=this._.extractColorChannelsFromRgba(t);t=this._.extractColorChannelsFromHsla(t),(t=e||n||t)?(this._.type=t.type,this._.red=t.red,this._.green=t.green,this._.blue=t.blue,this._.alpha=t.alpha,t.type===CKEDITOR.tools.color.TYPE_HSL&&(this._.hue=t.hue,this._.saturation=t.saturation,this._.lightness=t.lightness)):this._.isValidColor=!1}},matchStringToNamedColor:function(t){return CKEDITOR.tools.color.namedColors[t.toLowerCase()]||null},extractColorChannelsFromHex:function(t){if(-1===t.indexOf("#")&&(t="#"+t),t.match(CKEDITOR.tools.color.hex3CharsRegExp)&&(t=this._.hex3ToHex6(t)),t.match(CKEDITOR.tools.color.hex4CharsRegExp)&&(t=this._.hex4ToHex8(t)),!t.match(CKEDITOR.tools.color.hex6CharsRegExp)&&!t.match(CKEDITOR.tools.color.hex8CharsRegExp))return null;var e=1;return(t=t.split(""))[7]&&t[8]&&(e=parseInt(t[7]+t[8],16),e/=CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE,e=Number(e.toFixed(1))),{type:CKEDITOR.tools.color.TYPE_RGB,red:parseInt(t[1]+t[2],16),green:parseInt(t[3]+t[4],16),blue:parseInt(t[5]+t[6],16),alpha:e}},extractColorChannelsFromRgba:function(n){var i=this._.extractColorChannelsByPattern(n,CKEDITOR.tools.color.rgbRegExp);if(!i||3>i.length||4<i.length)return null;var r=4===i.length;n=t(i[0],CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE);var o=t(i[1],CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE),s=t(i[2],CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE),a=1;return r&&(a=e(i[3],CKEDITOR.tools.color.MAX_ALPHA_CHANNEL_VALUE)),i={type:CKEDITOR.tools.color.TYPE_RGB,red:n,green:o,blue:s,alpha:a},this._.areColorChannelsValid(n,o,s,a)?i:null},extractColorChannelsFromHsla:function(n){var i=this._.extractColorChannelsByPattern(n,CKEDITOR.tools.color.hslRegExp);if(!i||3>i.length||4<i.length)return null;var r=4===i.length,o=t(i[0],CKEDITOR.tools.color.MAX_HUE_CHANNEL_VALUE),s=e(i[1],CKEDITOR.tools.color.MAX_SATURATION_LIGHTNESS_CHANNEL_VALUE),a=e(i[2],CKEDITOR.tools.color.MAX_SATURATION_LIGHTNESS_CHANNEL_VALUE),l=1;return n=this._.hslToRgb(o,s,a),r&&(l=e(i[3],CKEDITOR.tools.color.MAX_ALPHA_CHANNEL_VALUE)),n.push(l),i={type:CKEDITOR.tools.color.TYPE_HSL,red:n[0],green:n[1],blue:n[2],alpha:n[3],hue:o,saturation:Math.round(100*s),lightness:Math.round(100*a)},this._.areColorChannelsValid(n[0],n[1],n[2],n[3])?i:null},hex3ToHex6:function(t){return"#"+(t=t.split(""))[1]+t[1]+t[2]+t[2]+t[3]+t[3]},hex4ToHex8:function(t){return this._.hex3ToHex6(t.substr(0,4))+CKEDITOR.tools.repeat(t[4],2)},extractColorChannelsByPattern:function(t,e){var n=t.match(e);if(!n)return null;var i=-1===n[1].indexOf(",")?/\s/:",";i=n[1].split(i),i=CKEDITOR.tools.array.reduce(i,function(t,e){var n=CKEDITOR.tools.trim(e);return 0===n.length?t:t.concat([n])},[]);return n[2]&&(n=CKEDITOR.tools.trim(n[2].replace(/[\/,]/,"")),i.push(n)),i},areColorChannelsValid:function(t,e,n,r){return i(t,0,CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE)&&i(e,0,CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE)&&i(n,0,CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE)&&i(r,0,CKEDITOR.tools.color.MAX_ALPHA_CHANNEL_VALUE)},hslToRgb:function(t,e,n){var i=function(i){var r=(i+t/30)%12;return i=e*Math.min(n,1-n),r=Math.min(r-3,9-r,1),r=Math.max(-1,r),Math.round((n-i*r)*CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE)};return[i(0),i(8),i(4)]},rgbToHsl:function(t,e,n){t/=CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE,e/=CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE;var i=n/CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE,r=Math.max(t,e,i),o=Math.min(t,e,i);n=r-o;var s=0;switch(r){case t:s=(e-i)/n%6;break;case e:s=(i-t)/n+2;break;case i:s=(t-e)/n+4}return t=0===n?0:60*s,e=(r+o)/2,r=0,1!==e&&0!==e&&(r=n/(1-Math.abs(2*e-1))),[t=Math.round(t),r=Math.round(100*r),e=Math.round(100*e)]}},statics:{TYPE_RGB:1,TYPE_HSL:2,MAX_RGB_CHANNEL_VALUE:255,MAX_ALPHA_CHANNEL_VALUE:1,MAX_HUE_CHANNEL_VALUE:360,MAX_SATURATION_LIGHTNESS_CHANNEL_VALUE:1,hex3CharsRegExp:/#([0-9a-f]{3}$)/gim,hex4CharsRegExp:/#([0-9a-f]{4}$)/gim,hex6CharsRegExp:/#([0-9a-f]{6}$)/gim,hex8CharsRegExp:/#([0-9a-f]{8}$)/gim,rgbRegExp:/rgba?\(([.,\d\s%]*)(\s*\/\s*[\d.%]+)?\s*\)/i,hslRegExp:/hsla?\((\s*(?:[.\d]+(?:deg)?)(?:\s*,?\s*[.\d]+%){2})((?:(?:\s*\/\s*)|(?:\s*,\s*))[\d.]+%?)?\s*\)/i,namedColors:{aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",windowtext:"windowtext",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"}}}),CKEDITOR.tools.style.parse._colors=CKEDITOR.tools.color.namedColors}(),CKEDITOR.dom.comment=function(t,e){"string"==typeof t&&(t=(e?e.$:document).createComment(t)),CKEDITOR.dom.domObject.call(this,t)},CKEDITOR.dom.comment.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.comment.prototype,{type:CKEDITOR.NODE_COMMENT,getOuterHtml:function(){return"\x3c!--"+this.$.nodeValue+"--\x3e"}}),function(){var t,e={},n={};for(t in CKEDITOR.dtd.$blockLimit)t in CKEDITOR.dtd.$list||(e[t]=1);for(t in CKEDITOR.dtd.$block)t in CKEDITOR.dtd.$blockLimit||t in CKEDITOR.dtd.$empty||(n[t]=1);CKEDITOR.dom.elementPath=function(t,i){var r,o=null,s=null,a=[],l=t;i=i||t.getDocument().getBody(),l||(l=i);do{if(l.type==CKEDITOR.NODE_ELEMENT){if(a.push(l),!this.lastElement&&(this.lastElement=l,l.is(CKEDITOR.dtd.$object)||"false"==l.getAttribute("contenteditable")))continue;if(l.equals(i))break;if(!s&&(r=l.getName(),"true"==l.getAttribute("contenteditable")?s=l:!o&&n[r]&&(o=l),e[r])){if(r=!o&&"div"==r){t:{for(var c=0,u=(r=l.getChildren()).count();c<u;c++){var h=r.getItem(c);if(h.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$block[h.getName()]){r=!0;break t}}r=!1}r=!r}r?o=l:s=l}}}while(l=l.getParent());s||(s=i),this.block=o,this.blockLimit=s,this.root=i,this.elements=a}}(),CKEDITOR.dom.elementPath.prototype={compare:function(t){var e=this.elements;if(!(t=t&&t.elements)||e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].equals(t[n]))return!1;return!0},contains:function(t,e,n){var i,r=0;"string"==typeof t&&(i=function(e){return e.getName()==t}),t instanceof CKEDITOR.dom.element?i=function(e){return e.equals(t)}:CKEDITOR.tools.isArray(t)?i=function(e){return-1<CKEDITOR.tools.indexOf(t,e.getName())}:"function"==typeof t?i=t:"object"==typeof t&&(i=function(e){return e.getName()in t});var o=this.elements,s=o.length;for(e&&(n?r+=1:--s),n&&(o=Array.prototype.slice.call(o,0)).reverse();r<s;r++)if(i(o[r]))return o[r];return null},isContextFor:function(t){return!(t in CKEDITOR.dtd.$block)||!!(this.contains(CKEDITOR.dtd.$intermediate)||this.root.equals(this.block)&&this.block||this.blockLimit).getDtd()[t]},direction:function(){return(this.block||this.blockLimit||this.root).getDirection(1)}},CKEDITOR.dom.text=function(t,e){"string"==typeof t&&(t=(e?e.$:document).createTextNode(t)),this.$=t},CKEDITOR.dom.text.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.text.prototype,{type:CKEDITOR.NODE_TEXT,getLength:function(){return this.$.nodeValue.length},getText:function(){return this.$.nodeValue},setText:function(t){this.$.nodeValue=t},isEmpty:function(t){var e=this.getText();return t&&(e=CKEDITOR.tools.trim(e)),!e||e===CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE},split:function(t){var e=this.$.parentNode,n=e.childNodes.length,i=this.getLength(),r=this.getDocument(),o=new CKEDITOR.dom.text(this.$.splitText(t),r);return e.childNodes.length==n&&(t>=i?(o=r.createText("")).insertAfter(this):((t=r.createText("")).insertAfter(o),t.remove())),o},substring:function(t,e){return"number"!=typeof e?this.$.nodeValue.substr(t):this.$.nodeValue.substring(t,e)}}),function(){function t(t,e,n){var i=t.serializable,r=e[n?"endContainer":"startContainer"],o=n?"endOffset":"startOffset",s=i?e.document.getById(t.startNode):t.startNode;return t=i?e.document.getById(t.endNode):t.endNode,r.equals(s.getPrevious())?(e.startOffset=e.startOffset-r.getLength()-t.getPrevious().getLength(),r=t.getNext()):r.equals(t.getPrevious())&&(e.startOffset-=r.getLength(),r=t.getNext()),r.equals(s.getParent())&&e[o]++,r.equals(t.getParent())&&e[o]++,e[n?"endContainer":"startContainer"]=r,e}CKEDITOR.dom.rangeList=function(t){return t instanceof CKEDITOR.dom.rangeList?t:(t?t instanceof CKEDITOR.dom.range&&(t=[t]):t=[],CKEDITOR.tools.extend(t,e))};var e={createIterator:function(){var t,e=this,n=CKEDITOR.dom.walker.bookmark(),i=[];return{getNextRange:function(r){var o=e[t=void 0===t?0:t+1];if(o&&1<e.length){if(!t)for(var s=e.length-1;0<=s;s--)i.unshift(e[s].createBookmark(!0));if(r)for(var a=0;e[t+a+1];){var l=o.document;for(r=0,s=l.getById(i[a].endNode),l=l.getById(i[a+1].startNode);;){if(s=s.getNextSourceNode(!1),l.equals(s))r=1;else if(n(s)||s.type==CKEDITOR.NODE_ELEMENT&&s.isBlockBoundary())continue;break}if(!r)break;a++}for(o.moveToBookmark(i.shift());a--;)(s=e[++t]).moveToBookmark(i.shift()),o.setEnd(s.endContainer,s.endOffset)}return o}}},createBookmarks:function(e){for(var n,i=[],r=0;r<this.length;r++){i.push(n=this[r].createBookmark(e,!0));for(var o=r+1;o<this.length;o++)this[o]=t(n,this[o]),this[o]=t(n,this[o],!0)}return i},createBookmarks2:function(t){for(var e=[],n=0;n<this.length;n++)e.push(this[n].createBookmark2(t));return e},moveToBookmarks:function(t){for(var e=0;e<this.length;e++)this[e].moveToBookmark(t[e])}}}(),function(){function t(){return CKEDITOR.getUrl(CKEDITOR.skinName.split(",")[1]||"skins/"+CKEDITOR.skinName.split(",")[0]+"/")}function e(e){var n=CKEDITOR.skin["ua_"+e],i=CKEDITOR.env;if(n){n=n.split(",").sort(function(t,e){return t>e?-1:1});for(var r,o=0;o<n.length;o++)if(r=n[o],i.ie&&(r.replace(/^ie/,"")==i.version||i.quirks&&"iequirks"==r)&&(r="ie"),i[r]){e+="_"+n[o];break}}return CKEDITOR.getUrl(t()+e+".css")}function n(t,n){o[t]||(CKEDITOR.document.appendStyleSheet(e(t)),o[t]=1),n&&n()}function i(t){var e=t.getById(s);return e||((e=t.getHead().append("style")).setAttribute("id",s),e.setAttribute("type","text/css")),e}function r(t,e,n){var i,r,o;if(CKEDITOR.env.webkit)for(e=e.split("}").slice(0,-1),r=0;r<e.length;r++)e[r]=e[r].split("{");for(var s=0;s<t.length;s++)if(CKEDITOR.env.webkit)for(r=0;r<e.length;r++){for(o=e[r][1],i=0;i<n.length;i++)o=o.replace(n[i][0],n[i][1]);t[s].$.sheet.addRule(e[r][0],o)}else{for(o=e,i=0;i<n.length;i++)o=o.replace(n[i][0],n[i][1]);CKEDITOR.env.ie&&11>CKEDITOR.env.version?t[s].$.styleSheet.cssText+=o:t[s].$.innerHTML+=o}}var o={};CKEDITOR.skin={path:t,loadPart:function(e,i){CKEDITOR.skin.name!=CKEDITOR.skinName.split(",")[0]?CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(t()+"skin.js"),function(){n(e,i)}):n(e,i)},getPath:function(t){return CKEDITOR.getUrl(e(t))},icons:{},addIcon:function(t,e,n,i){t=t.toLowerCase(),this.icons[t]||(this.icons[t]={path:e,offset:n||0,bgsize:i||"16px"})},getIconStyle:function(t,e,n,i,r){var o;return t&&(t=t.toLowerCase(),e&&(o=this.icons[t+"-rtl"]),o||(o=this.icons[t])),t=n||o&&o.path||"",i=i||o&&o.offset,r=r||o&&o.bgsize||"16px",t&&(t=t.replace(/'/g,"\\'")),t&&"background-image:url('"+CKEDITOR.getUrl(t)+"');background-position:0 "+i+"px;background-size:"+r+";"}},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{getUiColor:function(){return this.uiColor},setUiColor:function(t){var e=i(CKEDITOR.document);return(this.setUiColor=function(t){this.uiColor=t;var n=CKEDITOR.skin.chameleon,i="",o="";"function"==typeof n&&(i=n(this,"editor"),o=n(this,"panel")),r([e],i,t=[[l,t]]),r(a,o,t)}).call(this,t)}});var s="cke_ui_color",a=[],l=/\$color/g;CKEDITOR.on("instanceLoaded",function(t){if(!CKEDITOR.env.ie||!CKEDITOR.env.quirks){var e=t.editor;t=function(t){if(!(t=(t.data[0]||t.data).element.getElementsByTag("iframe").getItem(0).getFrameDocument()).getById("cke_ui_color")){var n=i(t);a.push(n),e.on("destroy",function(){a=CKEDITOR.tools.array.filter(a,function(t){return n!==t})}),(t=e.getUiColor())&&r([n],CKEDITOR.skin.chameleon(e,"panel"),[[l,t]])}},e.on("panelShow",t),e.on("menuShow",t),e.config.uiColor&&e.setUiColor(e.config.uiColor)}})}(),function(){var t=CKEDITOR.dom.element.createFromHtml('<div style="width:0;height:0;position:absolute;left:-10000px;border:1px solid;border-color:red blue"></div>',CKEDITOR.document);t.appendTo(CKEDITOR.document.getHead());try{var e=t.getComputedStyle("border-top-color"),n=t.getComputedStyle("border-right-color");CKEDITOR.env.hc=!(!e||e!=n)}catch(i){CKEDITOR.env.hc=!1}if(t.remove(),CKEDITOR.env.hc&&(CKEDITOR.env.cssClass+=" cke_hc"),CKEDITOR.document.appendStyleText(".cke{visibility:hidden;}"),CKEDITOR.status="loaded",CKEDITOR.fireOnce("loaded"),t=CKEDITOR._.pending)for(delete CKEDITOR._.pending,e=0;e<t.length;e++)CKEDITOR.editor.prototype.constructor.apply(t[e][0],t[e][1]),CKEDITOR.add(t[e][0])}(),CKEDITOR.skin.name="moono",CKEDITOR.skin.ua_editor="ie,iequirks,ie7,ie8,gecko",CKEDITOR.skin.ua_dialog="ie,iequirks,ie7,ie8",CKEDITOR.skin.chameleon=function(){var t,e=function(t,e){for(var n=t.match(/[^#]./g),i=0;3>i;i++){var r,o=i;r=parseInt(n[i],16),r=("0"+(0>e?0|r*(1+e):0|r+(255-r)*e).toString(16)).slice(-2),n[o]=r}return"#"+n.join("")},n=(t=new CKEDITOR.template("background:#{to};background-image:linear-gradient(to bottom,{from},{to});filter:progid:DXImageTransform.Microsoft.gradient(gradientType=0,startColorstr='{from}',endColorstr='{to}');"),function(e,n){return t.output({from:e,to:n})}),i={editor:new CKEDITOR.template("{id}.cke_chrome [border-color:{defaultBorder};] {id} .cke_top [ {defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_bottom [{defaultGradient}border-top-color:{defaultBorder};] {id} .cke_resizer [border-right-color:{ckeResizer}] {id} .cke_dialog_title [{defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_dialog_footer [{defaultGradient}outline-color:{defaultBorder};border-top-color:{defaultBorder};] {id} .cke_dialog_tab [{lightGradient}border-color:{defaultBorder};] {id} .cke_dialog_tab:hover [{mediumGradient}] {id} .cke_dialog_contents [border-top-color:{defaultBorder};] {id} .cke_dialog_tab_selected, {id} .cke_dialog_tab_selected:hover [background:{dialogTabSelected};border-bottom-color:{dialogTabSelectedBorder};] {id} .cke_dialog_body [background:{dialogBody};border-color:{defaultBorder};] {id} .cke_toolgroup [{lightGradient}border-color:{defaultBorder};] {id} a.cke_button_off:hover, {id} a.cke_button_off:focus, {id} a.cke_button_off:active [{mediumGradient}] {id} .cke_button_on [{ckeButtonOn}] {id} .cke_toolbar_separator [background-color: {ckeToolbarSeparator};] {id} .cke_combo_button [border-color:{defaultBorder};{lightGradient}] {id} a.cke_combo_button:hover, {id} a.cke_combo_button:focus, {id} .cke_combo_on a.cke_combo_button [border-color:{defaultBorder};{mediumGradient}] {id} .cke_path_item [color:{elementsPathColor};] {id} a.cke_path_item:hover, {id} a.cke_path_item:focus, {id} a.cke_path_item:active [background-color:{elementsPathBg};] {id}.cke_panel [border-color:{defaultBorder};] "),panel:new CKEDITOR.template(".cke_panel_grouptitle [{lightGradient}border-color:{defaultBorder};] .cke_menubutton_icon [background-color:{menubuttonIcon};] .cke_menubutton:hover .cke_menubutton_icon, .cke_menubutton:focus .cke_menubutton_icon, .cke_menubutton:active .cke_menubutton_icon [background-color:{menubuttonIconHover};] .cke_menuseparator [background-color:{menubuttonIcon};] a:hover.cke_colorbox, a:focus.cke_colorbox, a:active.cke_colorbox [border-color:{defaultBorder};] a:hover.cke_colorauto, a:hover.cke_colormore, a:focus.cke_colorauto, a:focus.cke_colormore, a:active.cke_colorauto, a:active.cke_colormore [background-color:{ckeColorauto};border-color:{defaultBorder};] ")};return function(t,r){var o=t.uiColor;o={id:"."+t.id,defaultBorder:e(o,-.1),defaultGradient:n(e(o,.9),o),lightGradient:n(e(o,1),e(o,.7)),mediumGradient:n(e(o,.8),e(o,.5)),ckeButtonOn:n(e(o,.6),e(o,.7)),ckeResizer:e(o,-.4),ckeToolbarSeparator:e(o,.5),ckeColorauto:e(o,.8),dialogBody:e(o,.7),dialogTabSelected:n("#FFFFFF","#FFFFFF"),dialogTabSelectedBorder:"#FFF",elementsPathColor:e(o,-.6),elementsPathBg:o,menubuttonIcon:e(o,.5),menubuttonIconHover:e(o,.3)};return i[r].output(o).replace(/\[/g,"{").replace(/\]/g,"}")}}(),function(){var t='<a id="{id}" class="cke_button cke_button__{name} cke_button_{state} {cls}"'+(CKEDITOR.env.gecko&&!CKEDITOR.env.hc?"":" href=\"javascript:void('{titleJs}')\"")+' title="{title}" tabindex="-1" hidefocus="true" role="button" aria-labelledby="{id}_label" aria-describedby="{id}_description" aria-haspopup="{hasArrow}" aria-disabled="{ariaDisabled}"{hasArrowAriaHtml}{toggleAriaHtml}';CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(t+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(t+=' onblur="this.style.cssText = this.style.cssText;"');var e="";CKEDITOR.env.ie&&(e='return false;" onmouseup="CKEDITOR.tools.getMouseButton(event)==CKEDITOR.MOUSE_BUTTON_LEFT&&');t=t+' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event);" onfocus="return CKEDITOR.tools.callFunction({focusFn},event);" onclick="'+e+'CKEDITOR.tools.callFunction({clickFn},this);return false;"><span class="cke_button_icon cke_button__{iconName}_icon" style="{style}">&nbsp;</span><span id="{id}_label" class="cke_button_label cke_button__{name}_label" aria-hidden="false">{label}</span><span id="{id}_description" class="cke_button_label" aria-hidden="false">{ariaShortcutSpace}{ariaShortcut}</span>{arrowHtml}</a>';var n=CKEDITOR.addTemplate("buttonArrow",'<span class="cke_button_arrow">'+(CKEDITOR.env.hc?"&#9660;":"")+"</span>"),i=CKEDITOR.addTemplate("button",t);CKEDITOR.plugins.add("button",{beforeInit:function(t){t.ui.addHandler(CKEDITOR.UI_BUTTON,CKEDITOR.ui.button.handler)}}),CKEDITOR.UI_BUTTON="button",CKEDITOR.ui.button=function(t){CKEDITOR.tools.extend(this,t,{isToggle:t.isToggle||!1,title:t.label,click:t.click||function(e){e.execCommand(t.command)}}),this._={}},CKEDITOR.ui.button.handler={create:function(t){return new CKEDITOR.ui.button(t)}},CKEDITOR.ui.button.prototype={render:function(t,e){function r(){var e=t.mode;e&&(e=this.modes[e]?void 0!==l[e]?l[e]:CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,e=t.readOnly&&!this.readOnly?CKEDITOR.TRISTATE_DISABLED:e,this.setState(e),this.refresh&&this.refresh())}var o,s,a,l=null,c=CKEDITOR.env,u=this._.id=CKEDITOR.tools.getNextId(),h="",d=this.command;this._.editor=t;var f,p={id:u,button:this,editor:t,focus:function(){CKEDITOR.document.getById(u).focus()},execute:function(){this.button.click(t)},attach:function(t){this.button.attach(t)}},g=CKEDITOR.tools.addFunction(function(t){if(p.onkey)return t=new CKEDITOR.dom.event(t),!1!==p.onkey(p,t.getKeystroke())}),m=CKEDITOR.tools.addFunction(function(t){var e;return p.onfocus&&(e=!1!==p.onfocus(p,new CKEDITOR.dom.event(t))),e}),v=0;p.clickFn=o=CKEDITOR.tools.addFunction(function(){v&&(t.unlockSelection(1),v=0),p.execute(),c.iOS&&t.focus()}),this.modes?(l={},t.on("beforeModeUnload",function(){t.mode&&this._.state!=CKEDITOR.TRISTATE_DISABLED&&(l[t.mode]=this._.state)},this),t.on("activeFilterChange",r,this),t.on("mode",r,this),!this.readOnly&&t.on("readOnly",r,this)):d&&(d=t.getCommand(d))&&(d.on("state",function(){this.setState(d.state)},this),h+=d.state==CKEDITOR.TRISTATE_ON?"on":d.state==CKEDITOR.TRISTATE_DISABLED?"disabled":"off"),this.directional&&t.on("contentDirChanged",function(e){var n=CKEDITOR.document.getById(this._.id),i=n.getFirst();(e=e.data)!=t.lang.dir?n.addClass("cke_"+e):n.removeClass("cke_ltr").removeClass("cke_rtl"),i.setAttribute("style",CKEDITOR.skin.getIconStyle(f,"rtl"==e,this.icon,this.iconOffset))},this),d?(s=t.getCommandKeystroke(d))&&(a=CKEDITOR.tools.keystrokeToString(t.lang.common.keyboard,s)):h+="off",s=this.name||this.command;var y=null,b=this.icon;return f=s,this.icon&&!/\./.test(this.icon)?(f=this.icon,b=null):(this.icon&&(y=this.icon),CKEDITOR.env.hidpi&&this.iconHiDpi&&(y=this.iconHiDpi)),y?(CKEDITOR.skin.addIcon(y,y),b=null):y=f,h={id:u,name:s,iconName:f,label:this.label,cls:(this.hasArrow?"cke_button_expandable ":"")+(this.className||""),state:h,ariaDisabled:"disabled"==h?"true":"false",title:this.title+(a?" ("+a.display+")":""),ariaShortcutSpace:a?"&nbsp;":"",ariaShortcut:a?t.lang.common.keyboardShortcut+" "+a.aria:"",titleJs:c.gecko&&!c.hc?"":(this.title||"").replace("'",""),hasArrow:"string"==typeof this.hasArrow&&this.hasArrow||(this.hasArrow?"true":"false"),keydownFn:g,focusFn:m,clickFn:o,style:CKEDITOR.skin.getIconStyle(y,"rtl"==t.lang.dir,b,this.iconOffset),arrowHtml:this.hasArrow?n.output():"",hasArrowAriaHtml:this.hasArrow?' aria-expanded="false"':"",toggleAriaHtml:this.isToggle?'aria-pressed="false"':""},i.output(h,e),this.onRender&&this.onRender(),p},setState:function(t){if(this._.state==t)return!1;this._.state=t;var e=CKEDITOR.document.getById(this._.id);return!!e&&(e.setState(t,"cke_button"),e.setAttribute("aria-disabled",t==CKEDITOR.TRISTATE_DISABLED),this.isToggle&&!this.hasArrow&&e.setAttribute("aria-pressed",t===CKEDITOR.TRISTATE_ON),!0)},getState:function(){return this._.state},toFeature:function(t){if(this._.feature)return this._.feature;var e=this;return this.allowedContent||this.requiredContent||!this.command||(e=t.getCommand(this.command)||e),this._.feature=e}},CKEDITOR.ui.prototype.addButton=function(t,e){this.add(t,CKEDITOR.UI_BUTTON,e)}}(),CKEDITOR.plugins.add("panelbutton",{requires:"button",onLoad:function(){function t(t){var e=this._;e.state!=CKEDITOR.TRISTATE_DISABLED&&(this.createPanel(t),e.on?e.panel.hide():e.panel.showBlock(this._.id,this.document.getById(this._.id),4))}CKEDITOR.ui.panelButton=CKEDITOR.tools.createClass({base:CKEDITOR.ui.button,$:function(e){var n=e.panel||{};delete e.panel,this.base(e),this.document=n.parent&&n.parent.getDocument()||CKEDITOR.document,n.block={attributes:n.attributes},n.toolbarRelated=!0,this.hasArrow="listbox",this.click=t,this._={panelDefinition:n}},statics:{handler:{create:function(t){return new CKEDITOR.ui.panelButton(t)}}},proto:{createPanel:function(t){var e=this._;if(!e.panel){var n=this._.panelDefinition,i=this._.panelDefinition.block,r=n.parent||CKEDITOR.document.getBody(),o=CKEDITOR.document.getById(this._.id),s=this._.panel=new CKEDITOR.ui.floatPanel(t,r,n),a=(n=s.addBlock(e.id,i),this),l=t.getCommand(this.command);s.onShow=function(){a.className&&this.element.addClass(a.className+"_panel"),a.setState(CKEDITOR.TRISTATE_ON),o.setAttribute("aria-expanded","true"),e.on=1,a.editorFocus&&t.focus(),a.onOpen&&a.onOpen()},s.onHide=function(n){a.className&&this.element.getFirst().removeClass(a.className+"_panel"),!a.modes&&l?a.setStateFromCommand(l):a.setState(a.modes&&a.modes[t.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),e.on=0,o.setAttribute("aria-expanded","false"),!n&&a.onClose&&a.onClose()},s.onEscape=function(){s.hide(1),a.document.getById(e.id).focus()},this.onBlock&&this.onBlock(s,n),n.onHide=function(){e.on=0,!a.modes&&a.command?a.setStateFromCommand(l):a.setState(CKEDITOR.TRISTATE_OFF)}}},setStateFromCommand:function(t){this.setState(t.state)}}})},beforeInit:function(t){t.ui.addHandler(CKEDITOR.UI_PANELBUTTON,CKEDITOR.ui.panelButton.handler)}}),CKEDITOR.UI_PANELBUTTON="panelbutton",function(){CKEDITOR.plugins.add("panel",{beforeInit:function(t){t.ui.addHandler(CKEDITOR.UI_PANEL,CKEDITOR.ui.panel.handler)}}),CKEDITOR.UI_PANEL="panel",CKEDITOR.ui.panel=function(t,e){e&&CKEDITOR.tools.extend(this,e),CKEDITOR.tools.extend(this,{className:"",css:[]}),this.id=CKEDITOR.tools.getNextId(),this.document=t,this.isFramed=this.forceIFrame||this.css.length,this._={blocks:{}}},CKEDITOR.ui.panel.handler={create:function(t){return new CKEDITOR.ui.panel(t)}};var t=CKEDITOR.addTemplate("panel",'<div lang="{langCode}" id="{id}" dir={dir} class="cke cke_reset_all {editorId} cke_panel cke_panel {cls} cke_{dir}" style="z-index:{z-index}" role="presentation">{frame}</div>'),e=CKEDITOR.addTemplate("panel-frame",'<iframe id="{id}" class="cke_panel_frame" role="presentation" frameborder="0" src="{src}"></iframe>'),n=CKEDITOR.addTemplate("panel-frame-inner",'<!DOCTYPE html><html class="cke_panel_container {env}" dir="{dir}" lang="{langCode}"><head>{css}</head><body class="cke_{dir}" style="margin:0;padding:0" onload="{onload}"></body></html>');CKEDITOR.ui.panel.prototype={render:function(i,r){var o={editorId:i.id,id:this.id,langCode:i.langCode,dir:i.lang.dir,cls:this.className,frame:"",env:CKEDITOR.env.cssClass,"z-index":i.config.baseFloatZIndex+1};if(this.getHolderElement=function(){if(!(e=this._.holder)){if(this.isFramed){var t=(e=this.document.getById(this.id+"_frame")).getParent(),e=e.getFrameDocument();CKEDITOR.env.iOS&&t.setStyles({overflow:"scroll","-webkit-overflow-scrolling":"touch"}),t=CKEDITOR.tools.addFunction(CKEDITOR.tools.bind(function(){this.isLoaded=!0,this.onLoad&&this.onLoad()},this)),e.write(n.output(CKEDITOR.tools.extend({css:CKEDITOR.tools.buildStyleHtml(this.css),onload:"window.parent.CKEDITOR.tools.callFunction("+t+");"},o))),e.getWindow().$.CKEDITOR=CKEDITOR,e.on("keydown",function(t){var e=t.data.getKeystroke(),n=this.document.getById(this.id).getAttribute("dir");("input"!==t.data.getTarget().getName()||37!==e&&39!==e)&&(this._.onKeyDown&&!1===this._.onKeyDown(e)?"input"===t.data.getTarget().getName()&&32===e||t.data.preventDefault():(27==e||e==("rtl"==n?39:37))&&this.onEscape&&!1===this.onEscape(e)&&t.data.preventDefault())},this),(e=e.getBody()).unselectable(),CKEDITOR.env.air&&CKEDITOR.tools.callFunction(t)}else e=this.document.getById(this.id);this._.holder=e}return e},this.isFramed){var s=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie&&!CKEDITOR.env.edge?"javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())":"";o.frame=e.output({id:this.id+"_frame",src:s})}return s=t.output(o),r&&r.push(s),s},addBlock:function(t,e){return e=this._.blocks[t]=e instanceof CKEDITOR.ui.panel.block?e:new CKEDITOR.ui.panel.block(this.getHolderElement(),e),this._.currentBlock||this.showBlock(t),e},getBlock:function(t){return this._.blocks[t]},showBlock:function(t){t=this._.blocks[t];var e=this._.currentBlock,n=!this.forceIFrame||CKEDITOR.env.ie?this._.holder:this.document.getById(this.id+"_frame");return e&&e.hide(),this._.currentBlock=t,CKEDITOR.fire("ariaWidget",n),t._.focusIndex=-1,this._.onKeyDown=t.onKeyDown&&CKEDITOR.tools.bind(t.onKeyDown,t),t.show(),t},destroy:function(){this.element&&this.element.remove()}},CKEDITOR.ui.panel.block=CKEDITOR.tools.createClass({$:function(t,e){this.element=t.append(t.getDocument().createElement("div",{attributes:{tabindex:-1,class:"cke_panel_block"},styles:{display:"none"}})),e&&CKEDITOR.tools.extend(this,e),this.element.setAttributes({role:this.attributes.role||"presentation","aria-label":this.attributes["aria-label"],title:this.attributes.title||this.attributes["aria-label"]}),this.keys={},this._.focusIndex=-1,this.element.disableContextMenu()},_:{markItem:function(t){-1!=t&&(t=this._.getItems().getItem(this._.focusIndex=t),CKEDITOR.env.webkit&&t.getDocument().getWindow().focus(),t.focus(),this.onMark&&this.onMark(t))},markFirstDisplayed:function(t){for(var e,n,i=function(t){return t.type==CKEDITOR.NODE_ELEMENT&&"none"==t.getStyle("display")},r=this._.getItems(),o=r.count()-1;0<=o;o--)if((e=r.getItem(o)).getAscendant(i)||(n=e,this._.focusIndex=o),"true"==e.getAttribute("aria-selected")){n=e,this._.focusIndex=o;break}n&&(t&&t(),CKEDITOR.env.webkit&&n.getDocument().getWindow().focus(),n.focus(),this.onMark&&this.onMark(n))},getItems:function(){return this.element.find("a,input")}},proto:{show:function(){this.element.setStyle("display","")},hide:function(){this.onHide&&!0===this.onHide.call(this)||this.element.setStyle("display","none")},onKeyDown:function(t,e){switch(r=this.keys[t]){case"next":for(var n,i=this._.focusIndex,r=this._.getItems();n=r.getItem(++i);)if(n.getAttribute("_cke_focus")&&n.$.offsetWidth){this._.focusIndex=i,n.focus(!0);break}return!n&&!e&&(this._.focusIndex=-1,this.onKeyDown(t,1));case"prev":for(i=this._.focusIndex,r=this._.getItems();0<i&&(n=r.getItem(--i));){if(n.getAttribute("_cke_focus")&&n.$.offsetWidth){this._.focusIndex=i,n.focus(!0);break}n=null}return!n&&!e&&(this._.focusIndex=r.count(),this.onKeyDown(t,1));case"click":case"mouseup":return(n=0<=(i=this._.focusIndex)&&this._.getItems().getItem(i))&&n.fireEventHandler(r,{button:CKEDITOR.tools.normalizeMouseButton(CKEDITOR.MOUSE_BUTTON_LEFT,!0)}),!1}return!0}}})}(),CKEDITOR.plugins.add("floatpanel",{requires:"panel"}),t={},CKEDITOR.ui.floatPanel=CKEDITOR.tools.createClass({$:function(e,n,i,r){function o(){c.hide()}i.forceIFrame=1,i.toolbarRelated&&e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&(n=CKEDITOR.document.getById("cke_"+e.name));var s=n.getDocument();r=function(e,n,i,r,o){o=CKEDITOR.tools.genKey(n.getUniqueId(),i.getUniqueId(),e.lang.dir,e.uiColor||"",r.css||"",o||"");var s=t[o];return s||((s=t[o]=new CKEDITOR.ui.panel(n,r)).element=i.append(CKEDITOR.dom.element.createFromHtml(s.render(e),n)),s.element.setStyles({display:"none",position:"absolute"})),s}(e,s,n,i,r||0);var a=r.element,l=a.getFirst(),c=this;a.disableContextMenu(),this.element=a,this._={editor:e,panel:r,parentElement:n,definition:i,document:s,iframe:l,children:[],dir:e.lang.dir,showBlockParams:null,markFirst:void 0===i.markFirst||i.markFirst},e.on("mode",o),e.on("resize",o),s.getWindow().on("resize",function(){this.reposition()},this)},proto:{addBlock:function(t,e){return this._.panel.addBlock(t,e)},addListBlock:function(t,e){return this._.panel.addListBlock(t,e)},getBlock:function(t){return this._.panel.getBlock(t)},showBlock:function(t,e,n,i,r,o){var s=this._.panel,a=s.showBlock(t);this._.showBlockParams=[].slice.call(arguments),this.allowBlur(!1);var l=this._.editor.editable();this._.returnFocus=l.hasFocus?l:new CKEDITOR.dom.element(CKEDITOR.document.$.activeElement),this._.hideTimeout=0;var c=this.element,u=(l=this._.iframe,l=CKEDITOR.env.ie&&!CKEDITOR.env.edge?l:new CKEDITOR.dom.window(l.$.contentWindow),c.getDocument()),h=this._.parentElement.getPositionedAncestor(),d=e.getDocumentPosition(u),f=(u=h?h.getDocumentPosition(u):{x:0,y:0},"rtl"==this._.dir),p=d.x+(i||0)-u.x,g=d.y+(r||0)-u.y;!f||1!=n&&4!=n?f||2!=n&&3!=n||(p+=e.$.offsetWidth-1):p+=e.$.offsetWidth,3!=n&&4!=n||(g+=e.$.offsetHeight-1),this._.panel._.offsetParentId=e.getId(),c.setStyles({top:g+"px",left:0,display:""}),c.setOpacity(0),c.getFirst().removeStyle("width"),this._.editor.focusManager.add(l),this._.blurSet||(CKEDITOR.event.useCapture=!0,l.on("blur",function(t){function e(){delete this._.returnFocus,this.hide()}this.allowBlur()&&t.data.getPhase()==CKEDITOR.EVENT_PHASE_AT_TARGET&&this.visible&&!this._.activeChild&&(CKEDITOR.env.iOS?this._.hideTimeout||(this._.hideTimeout=CKEDITOR.tools.setTimeout(e,0,this)):e.call(this))},this),l.on("focus",function(){this._.focused=!0,this.hideChild(),this.allowBlur(!0)},this),CKEDITOR.env.iOS&&(l.on("touchstart",function(){clearTimeout(this._.hideTimeout)},this),l.on("touchend",function(){this._.hideTimeout=0,this.focus()},this)),CKEDITOR.event.useCapture=!1,this._.blurSet=1),s.onEscape=CKEDITOR.tools.bind(function(t){if(this.onEscape&&!1===this.onEscape(t))return!1},this),CKEDITOR.tools.setTimeout(function(){var t=CKEDITOR.tools.bind(function(){if((n=c).removeStyle("width"),a.autoSize){var t=a.element.getDocument();t=(CKEDITOR.env.webkit||CKEDITOR.env.edge?a.element:t.getBody()).$.scrollWidth,CKEDITOR.env.ie&&CKEDITOR.env.quirks&&0<t&&(t+=(n.$.offsetWidth||0)-(n.$.clientWidth||0)+3),n.setStyle("width",t+10+"px"),t=a.element.$.scrollHeight,CKEDITOR.env.ie&&CKEDITOR.env.quirks&&0<t&&(t+=(n.$.offsetHeight||0)-(n.$.clientHeight||0)+3),n.setStyle("height",t+"px"),s._.currentBlock.element.setStyle("display","none").removeStyle("display")}else n.removeStyle("height");f&&(p-=c.$.offsetWidth),c.setStyle("left",p+"px"),t=s.element.getWindow();var e,n=c.$.getBoundingClientRect(),i=(t=t.getViewPaneSize(),n.width||n.right-n.left),r=n.height||n.bottom-n.top,l=f?n.right:t.width-n.left,u=f?t.width-n.right:n.left;f?l<i&&(p=u>i?p+i:t.width>i?p-n.left:p-n.right+t.width):l<i&&(p=u>i?p-i:t.width>i?p-n.right+t.width:p-n.left),i=n.top,t.height-n.top<r&&(g=i>r?g-r:t.height>r?g-n.bottom+t.height:g-n.top),CKEDITOR.env.ie&&!CKEDITOR.env.edge&&((t=n=c.$.offsetParent&&new CKEDITOR.dom.element(c.$.offsetParent))&&"html"==t.getName()&&(t=t.getDocument().getBody()),t&&"rtl"==t.getComputedStyle("direction")&&(p=CKEDITOR.env.ie8Compat?p-2*c.getDocument().getDocumentElement().$.scrollLeft:p-(n.$.scrollWidth-n.$.clientWidth))),(e=(n=c.getFirst()).getCustomData("activePanel"))&&e.onHide&&e.onHide.call(this,1),n.setCustomData("activePanel",this),c.setStyles({top:g+"px",left:p+"px"}),c.setOpacity(1),o&&o()},this);s.isLoaded?t():s.onLoad=t,CKEDITOR.tools.setTimeout(function(){var t=CKEDITOR.env.webkit&&CKEDITOR.document.getWindow().getScrollPosition().y;this.focus(),a.element.focus(),CKEDITOR.env.webkit&&(CKEDITOR.document.getBody().$.scrollTop=t),this.allowBlur(!0),this._.markFirst&&(CKEDITOR.env.ie?CKEDITOR.tools.setTimeout(function(){a.markFirstDisplayed?a.markFirstDisplayed():a._.markFirstDisplayed()},0):a.markFirstDisplayed?a.markFirstDisplayed():a._.markFirstDisplayed()),this._.editor.fire("panelShow",this)},0,this)},CKEDITOR.env.air?200:0,this),this.visible=1,this.onShow&&this.onShow.call(this)},reposition:function(){var t=this._.showBlockParams;this.visible&&this._.showBlockParams&&(this.hide(),this.showBlock.apply(this,t))},focus:function(){if(CKEDITOR.env.webkit){var t=CKEDITOR.document.getActive();t&&!t.equals(this._.iframe)&&t.$.blur()}(this._.lastFocused||this._.iframe.getFrameDocument().getWindow()).focus()},blur:function(){var t=this._.iframe.getFrameDocument().getActive();t&&t.is("a")&&(this._.lastFocused=t)},hide:function(t){!this.visible||this.onHide&&!0===this.onHide.call(this)||(this.hideChild(),CKEDITOR.env.gecko&&this._.iframe.getFrameDocument().$.activeElement.blur(),this.element.setStyle("display","none"),this.visible=0,this.element.getFirst().removeCustomData("activePanel"),(t=t&&this._.returnFocus)&&(CKEDITOR.env.webkit&&t.type&&t.getWindow().$.focus(),t.focus()),delete this._.lastFocused,this._.showBlockParams=null,this._.editor.fire("panelHide",this))},allowBlur:function(t){var e=this._.panel;return void 0!==t&&(e.allowBlur=t),e.allowBlur},showAsChild:function(t,e,n,i,r,o){this._.activeChild==t&&t._.panel._.offsetParentId==n.getId()||(this.hideChild(),t.onHide=CKEDITOR.tools.bind(function(){CKEDITOR.tools.setTimeout(function(){this._.focused||this.hide()},0,this)},this),this._.activeChild=t,this._.focused=!1,t.showBlock(e,n,i,r,o),this.blur(),(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)&&setTimeout(function(){t.element.getChild(0).$.style.cssText+=""},100))},hideChild:function(t){var e=this._.activeChild;e&&(delete e.onHide,delete this._.activeChild,e.hide(),t&&this.focus())}}}),CKEDITOR.on("instanceDestroyed",function(){var e,n=CKEDITOR.tools.isEmpty(CKEDITOR.instances);for(e in t){var i=t[e];n?i.destroy():i.element.hide()}n&&(t={})}),function(){var t,e,n;CKEDITOR.plugins.add("colorbutton",{requires:"panelbutton,floatpanel",init:function(e){function i(i){function c(t,n,i){var r={};if(t&&(r.color=t),n&&(r.colorName=n),n=!CKEDITOR.tools.isEmpty(r)&&new CKEDITOR.style(function(){var t=e.config["colorButton_"+h+"Style"];return t.childRule="back"==h?function(t){return o(t)}:function(t){return!(t.is("a")||t.getElementsByTag("a").count())||o(t)},t}(),r),e.execCommand(p,{newStyle:n}),t&&i)for(i.addColor(t.substr(1).toUpperCase()),t=g.element.find("[role=option]").toArray(),i=0;i<t.length;i++)t[i].setAttributes({"aria-posinset":i+1,"aria-setsize":t.length})}var u=i.name,h=i.type,d=i.title,f=i.order,p=i.commandName;i=i.contentTransformations||{};var g,m=new CKEDITOR.style(a["colorButton_"+h+"Style"]),v=CKEDITOR.tools.getNextId()+"_colorBox",y={type:h},b=new CKEDITOR.style(a["colorButton_"+h+"Style"],{color:"inherit"}),C=CKEDITOR.tools.addFunction(function(t,n,i){e.focus(),e.fire("saveSnapshot"),"?"==t?e.getColorFromDialog(function(t){t&&c(t,n,I)},null,y):c(t&&"#"+t,n,I),i&&(i.setAttribute("cke_colorlast",!0),e.once("selectionChange",function(){i.removeAttribute("cke_colorlast")}))}),I=n.getRowLimit(e)?new n(e,"back"==h?"background-color":"color",C):void 0;e.addCommand(p,{contextSensitive:!0,exec:function(t,e){if(!t.readOnly){var n=e.newStyle;t.removeStyle(b),t.focus(),n&&t.applyStyle(n),t.fire("saveSnapshot")}},refresh:function(t,e){b.checkApplicable(e,t,t.activeFilter)?b.checkActive(e,t)?this.setState(CKEDITOR.TRISTATE_ON):this.setState(CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_DISABLED)}}),e.ui.add(u,CKEDITOR.UI_PANELBUTTON,{label:d,title:d,command:p,editorFocus:0,toolbar:"colors,"+f,allowedContent:m,requiredContent:m,contentTransformations:i,panel:{css:CKEDITOR.skin.getPath("editor"),attributes:{role:"listbox","aria-label":l.panelTitle}},select:function(e){var n=a.colorButton_colors.split(",");e=CKEDITOR.tools.array.find(n,e),e=t.normalizeColor(e),s(g,e),g._.markFirstDisplayed()},onBlock:function(t,n){g=n,n.autoSize=!0,n.element.addClass("cke_colorblock"),n.element.setHtml(r(v,C,I?I.getLength():0)),n.element.getDocument().getBody().setStyle("overflow","hidden"),n.element.getAscendant({html:1}).setStyle("overflow","hidden"),CKEDITOR.ui.fire("ready",this);var i=n.keys,o="rtl"==e.lang.dir;i[o?37:39]="next",i[40]="next",i[9]="next",i[o?39:37]="prev",i[38]="prev",i[CKEDITOR.SHIFT+9]="prev",i[32]="click",I&&I.setContainer(n.element.findOne(".cke_colorhistory"))},onOpen:function(){var n=(o=e.getSelection())&&o.getStartElement(),i=e.elementPath(n),r="back"==h?"background-color":"color";if(i){n=i.block||i.blockLimit||e.document.getBody();do{i=n&&n.getComputedStyle(r)||"transparent"}while("back"==h&&"transparent"==i&&n&&(n=n.getParent()));if(i&&"transparent"!=i||(i="#ffffff"),a.colorButton_enableAutomatic&&g.element.findOne("#"+v).setStyle("background-color",i),n=o&&o.getRanges()[0]){var o=new CKEDITOR.dom.walker(n),l=n.collapsed?n.startContainer:o.next();for(n="";l;){if(l.type!==CKEDITOR.NODE_ELEMENT&&(l=l.getParent()),l=t.normalizeColor(l.getComputedStyle(r)),(n=n||l)!==l){n="";break}l=o.next()}"transparent"==n&&(n=""),"fore"==h&&(y.automaticTextColor="#"+t.normalizeColor(i)),y.selectionColor=n?"#"+n:"",s(g,n)}return i}}})}function r(i,r,o){var s=[],c=a.colorButton_colors.split(","),u=e.plugins.colordialog&&a.colorButton_enableMore;o=c.length+o+(u?1:0);var h=1;for(a.colorButton_enableAutomatic&&(o+=1,h+=1,s.push('<a class="cke_colorauto" _cke_focus=1 hidefocus=true',' title="',l.auto,'"',' draggable="false"',' ondragstart="return false;"',' onclick="CKEDITOR.tools.callFunction(',r,',null);return false;"'," href=\"javascript:void('",l.auto,"')\"",' role="option" aria-posinset="1" aria-setsize="',o,'">','<table role="presentation" cellspacing=0 cellpadding=0 width="100%">',"<tr>",'<td colspan="',e.config.colorButton_colorsPerRow,'" align="center">','<span class="cke_colorbox" id="',i,'"></span>',l.auto,"</td>","</tr>","</table>","</a>")),s.push('<table role="presentation" cellspacing=0 cellpadding=0 width="100%"><tbody>'),i=0;i<c.length;i++){0==i%e.config.colorButton_colorsPerRow&&s.push("</tr><tr>");var d,f=(d=c[i].split("/"))[0];(d=new t(e,{color:d[1]||f,label:d[1]?f:void 0},r)).setPositionIndex(h+i,o),s.push(d.getHtml())}return n.getRowLimit(e)&&n.renderContainer(s,e),u&&s.push("</tr>","<tr>",'<td colspan="',e.config.colorButton_colorsPerRow,'" align="center">','<a class="cke_colormore" _cke_focus=1 hidefocus=true',' title="',l.more,'"',' draggable="false"',' ondragstart="return false;"',' onclick="CKEDITOR.tools.callFunction(',r,",'?');return false;\""," href=\"javascript:void('",l.more,"')\"",' role="option" aria-posinset="',o,'" aria-setsize="',o,'">',l.more,"</a>","</td>"),s.push("</tr></tbody></table>"),s.join("")}function o(t){return"false"==t.getAttribute("contentEditable")||t.getAttribute("data-nostyle")}function s(e,n){var i=e._.getItems(),r=e.element.findOne("[aria-selected]"),o=e.element.findOne("[cke_colorlast]");if(r&&r.removeAttribute("aria-selected"),o)o.setAttribute("aria-selected",!0);else for(r=0;r<i.count();r++)if(o=i.getItem(r),n&&n==t.normalizeColor(o.getAttribute("data-value"))){o.setAttribute("aria-selected",!0);break}}var a=e.config,l=e.lang.colorbutton;if(!CKEDITOR.env.hc){i({name:"TextColor",type:"fore",commandName:"textColor",title:l.textColorTitle,order:10,contentTransformations:[[{element:"font",check:"span{color}",left:function(t){return!!t.attributes.color},right:function(t){t.name="span",t.attributes.color&&(t.styles.color=t.attributes.color),delete t.attributes.color}}]]});var c,u=e.config.colorButton_normalizeBackground;(void 0===u||u)&&(c=[[{element:"span",left:function(t){var e=CKEDITOR.tools;return!("span"!=t.name||!t.styles||!t.styles.background)&&((t=e.style.parse.background(t.styles.background)).color&&1===e.object.keys(t).length)},right:function(t){var n=new CKEDITOR.style(e.config.colorButton_backStyle,{color:t.styles.background}).getDefinition();return t.name=n.element,t.styles=n.styles,t.attributes=n.attributes||{},t}}]]),i({name:"BGColor",type:"back",commandName:"bgColor",title:l.bgColorTitle,order:20,contentTransformations:c})}}}),t=CKEDITOR.tools.createClass({$:function(e,n,i){this.$=new CKEDITOR.dom.element("td"),this.color=CKEDITOR.tools._isValidColorFormat(n.color)?n.color:"",this.clickFn=i,this.label=n.label||t.colorNames(e)[this.color]||this.color,this.setHtml()},statics:{colorNames:function(t){return t.lang.colorbutton.colors},normalizeColor:function(t){var e=/^(rgb|hsl)a\(/g.test(t),n=/^rgba\((\s*0\s*,?){4}\)$/g.test(t);return e&&!n?(t=new CKEDITOR.tools.color(t),CKEDITOR.tools.normalizeHex(t.getHex()||"").replace(/#/g,"")):CKEDITOR.tools.normalizeHex("#"+CKEDITOR.tools.convertRgbToHex(t||"")).replace(/#/g,"")}},proto:{getElement:function(){return this.$},getHtml:function(){return this.getElement().getOuterHtml()},setHtml:function(){this.getElement().setHtml('<a class="cke_colorbox" _cke_focus=1 hidefocus=true title="'+this.label+'" draggable="false" ondragstart="return false;" onclick="CKEDITOR.tools.callFunction('+this.clickFn+",'"+this.color+"','"+this.label+"', this); return false;\" href=\"javascript:void('"+this.color+'\')" data-value="'+this.color+'" role="option"><span class="cke_colorbox" style="background-color:#'+this.color+'"></span></a>')},setPositionIndex:function(t,e){this.getElement().getChild(0).setAttributes({"aria-posinset":t,"aria-setsize":e})}}}),e=CKEDITOR.tools.createClass({$:function(){this.$=new CKEDITOR.dom.element("tr"),this.$.addClass("cke_colorhistory_row"),this.boxes=[]},proto:{getElement:function(){return this.$},removeLastColor:function(){return this.getElement().getLast().remove(),this.boxes.pop()},addNewColor:function(t){this.boxes.unshift(t),this.getElement().append(t.getElement(),!0)},extractColorBox:function(t){var e=CKEDITOR.tools.getIndex(this.boxes,function(e){return e.color===t});return 0>e?null:(this.boxes[e].getElement().remove(),this.boxes.splice(e,1)[0])}}}),n=CKEDITOR.tools.createClass({$:function(t,e,n){this.editor=t,this.cssProperty=e,this.clickFn=n,this.rows=[],this._.addNewRow(),this.editor.config.colorButton_renderContentColors&&this.editor.once("instanceReady",function(){this.renderContentColors()},this)},statics:{renderContainer:function(t,e){t.push('</tbody><tbody class="cke_colorhistory" style="display:none;">',"<tr>",'<td colspan="',e.config.colorButton_colorsPerRow,'" align="center">',"<span><hr></span>","</td>","</tr>","</tbody><tbody>")},getRowLimit:function(t){return t.config.colorButton_historyRowLimit},getCapacity:function(t){return n.getRowLimit(t)*t.config.colorButton_colorsPerRow},colorList:CKEDITOR.tools.style.parse._colors},_:{countColors:function(){var t=CKEDITOR.tools.getStyledSpans(this.cssProperty,this.editor.editable());return CKEDITOR.tools.array.reduce(t,function(t,e){var i=this._.getHexCode(e,this.cssProperty,n.colorList);return t[i]=t[i]||0,t[i]+=1,t},{},this)},getHexCode:function(e,n,i){var r=e.getStyle(n);return r in i?i[r].substr(1):t.normalizeColor(e.getComputedStyle(n)).toUpperCase()},sortByOccurrencesAscending:function(t,e){var n,i=[];for(n in t){var r={};r[e]=n,r.frequency=t[n],i.push(r)}return i.sort(function(t,e){return e.frequency-t.frequency}),this._.trimToCapacity(i),i.reverse()},trimToCapacity:function(t){t.splice(n.getCapacity(this.editor))},addColors:function(t){CKEDITOR.tools.array.forEach(t,function(t){this.addColor(t.colorCode)},this)},extractColorBox:function(t){for(var e=0;e<this.rows.length;e++){var n=this.rows[e].extractColorBox(t);if(n)return n}return null},moveToBeginning:function(t){this.rows[0].addNewColor(t)},createAtBeginning:function(e){this._.moveToBeginning(new t(this.editor,{color:e},this.clickFn))},addNewRow:function(){this.rows.push(new e),this.container&&this.container.append(this.rows[this.rows.length-1].getElement())},alignRows:function(){for(var t=0;t<n.getRowLimit(this.editor)&&!(this.rows[t].boxes.length<=this.editor.config.colorButton_colorsPerRow);t++)this.rows[t+1]?this._.moveLastBoxToNextRow(t):t<n.getRowLimit(this.editor)-1?(this._.addNewRow(),this._.moveLastBoxToNextRow(t)):this.rows[t].removeLastColor()},moveLastBoxToNextRow:function(t){this.rows[t+1].addNewColor(this.rows[t].removeLastColor())},refreshPositions:function(){var t=this._.countPanelElements(),e=this._.calculateFirstPosition(t);CKEDITOR.tools.array.forEach(this.rows,function(n){CKEDITOR.tools.array.forEach(n.boxes,function(n){n.setPositionIndex(e,t),e+=1})})},countPanelElements:function(){var t=this.editor.config.colorButton_colors.split(",").length+this.getLength();return this.editor.plugins.colordialog&&this.editor.config.colorButton_enableMore&&(t+=1),this.editor.config.colorButton_enableAutomatic&&(t+=1),t},calculateFirstPosition:function(t){return this.editor.plugins.colordialog&&this.editor.config.colorButton_enableMore?t-this.getLength():t-this.getLength()+1},attachRows:function(){CKEDITOR.tools.array.forEach(this.rows,function(t){this.container.append(t.getElement())},this)}},proto:{setContainer:function(t){this.container=t,this._.attachRows(),this.getLength()&&this.show()},show:function(){this.container&&this.container.show()},renderContentColors:function(){var t=this._.countColors();CKEDITOR.tools.isEmpty(t)||(t=this._.sortByOccurrencesAscending(t,"colorCode"),this._.addColors(t),this._.refreshPositions())},addColor:function(t){var e=this._.extractColorBox(t);this.container&&!this.container.isVisible()&&this.show(),e?this._.moveToBeginning(e):this._.createAtBeginning(t),this._.alignRows()},getLength:function(){return CKEDITOR.tools.array.reduce(this.rows,function(t,e){return t+e.boxes.length},0)}}})}(),CKEDITOR.config.colorButton_enableMore=!0,CKEDITOR.config.colorButton_colors="1ABC9C,2ECC71,3498DB,9B59B6,4E5F70,F1C40F,16A085,27AE60,2980B9,8E44AD,2C3E50,F39C12,E67E22,E74C3C,ECF0F1,95A5A6,DDD,FFF,D35400,C0392B,BDC3C7,7F8C8D,999,000",CKEDITOR.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]},CKEDITOR.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}},CKEDITOR.config.colorButton_enableAutomatic=!0,CKEDITOR.config.colorButton_colorsPerRow=6,CKEDITOR.config.colorButton_historyRowLimit=1,CKEDITOR.config.colorButton_renderContentColors=!0,CKEDITOR.plugins.add("menu",{requires:"floatpanel",beforeInit:function(t){for(var e=t.config.menu_groups.split(","),n=t._.menuGroups={},i=t._.menuItems={},r=0;r<e.length;r++)n[e[r]]=r+1;t.addMenuGroup=function(t,e){n[t]=e||100},t.addMenuItem=function(t,e){n[e.group]&&(i[t]=new CKEDITOR.menuItem(this,t,e))},t.addMenuItems=function(t){for(var e in t)this.addMenuItem(e,t[e])},t.getMenuItem=function(t){return i[t]},t.removeMenuItem=function(t){delete i[t]}}}),function(){var t='<span class="cke_menuitem"><a id="{id}" class="cke_menubutton cke_menubutton__{name} cke_menubutton_{state} {cls}" href="{href}" title="{title}" tabindex="-1" _cke_focus=1 hidefocus="true" role="{role}" aria-label="{attrLabel}" aria-describedby="{id}_description" aria-haspopup="{hasPopup}" aria-disabled="{disabled}" {ariaChecked} draggable="false"',e="";CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(t+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(t+=' onblur="this.style.cssText = this.style.cssText;" ondragstart="return false;"'),CKEDITOR.env.ie&&(e='return false;" onmouseup="CKEDITOR.tools.getMouseButton(event)===CKEDITOR.MOUSE_BUTTON_LEFT&&');t=t+' onmouseover="CKEDITOR.tools.callFunction({hoverFn},{index});" onmouseout="CKEDITOR.tools.callFunction({moveOutFn},{index});" onclick="'+e+'CKEDITOR.tools.callFunction({clickFn},{index}); return false;"><span class="cke_menubutton_inner"><span class="cke_menubutton_icon"><span class="cke_button_icon cke_button__{iconName}_icon" style="{iconStyle}"></span></span><span class="cke_menubutton_label">{label}</span>{shortcutHtml}{arrowHtml}</span></a><span id="{id}_description" class="cke_voice_label" aria-hidden="false">{ariaShortcut}</span></span>';var n=CKEDITOR.addTemplate("menuItem",t),i=CKEDITOR.addTemplate("menuArrow",'<span class="cke_menuarrow"><span>{label}</span></span>'),r=CKEDITOR.addTemplate("menuShortcut",'<span class="cke_menubutton_label cke_menubutton_shortcut">{shortcut}</span>');CKEDITOR.menu=CKEDITOR.tools.createClass({$:function(t,e){e=this._.definition=e||{},this.id=CKEDITOR.tools.getNextId(),this.editor=t,this.items=[],this._.listeners=[],this._.level=e.level||1;var n=CKEDITOR.tools.extend({},e.panel,{css:[CKEDITOR.skin.getPath("editor")],level:this._.level-1,block:{}}),i=n.block.attributes=n.attributes||{};!i.role&&(i.role="menu"),this._.panelDefinition=n},_:{onShow:function(){var t=this.editor.getSelection(),e=t&&t.getStartElement(),n=this.editor.elementPath(),i=this._.listeners;this.removeAll();for(var r=0;r<i.length;r++){var o=i[r](e,t,n);if(o)for(var s in o){var a=this.editor.getMenuItem(s);!a||a.command&&!this.editor.getCommand(a.command).state||(a.state=o[s],this.add(a))}}},onClick:function(t){this.hide(),t.onClick?t.onClick():t.command&&this.editor.execCommand(t.command)},onEscape:function(t){var e=this.parent;return e?e._.panel.hideChild(1):27==t&&this.hide(1),!1},onHide:function(){this.onHide&&this.onHide()},showSubMenu:function(t){var e=this._.subMenu,n=this.items[t];if(n=n.getItems&&n.getItems()){for(var i in e?e.removeAll():((e=this._.subMenu=new CKEDITOR.menu(this.editor,CKEDITOR.tools.extend({},this._.definition,{level:this._.level+1},!0))).parent=this,e._.onClick=CKEDITOR.tools.bind(this._.onClick,this)),n){var r=this.editor.getMenuItem(i);r&&(r.state=n[i],e.add(r))}var o=this._.panel.getBlock(this.id).element.getDocument().getById(this.id+String(t));setTimeout(function(){e.show(o,2)},0)}else this._.panel.hideChild(1)}},proto:{add:function(t){t.order||(t.order=this.items.length),this.items.push(t)},removeAll:function(){this.items=[]},show:function(t,e,n,i){if(this.parent||(this._.onShow(),this.items.length)){e=e||("rtl"==this.editor.lang.dir?2:1);var r=this.items,o=this.editor,s=this._.panel,a=this._.element;if(!s)(s=this._.panel=new CKEDITOR.ui.floatPanel(this.editor,CKEDITOR.document.getBody(),this._.panelDefinition,this._.level)).onEscape=CKEDITOR.tools.bind(function(t){if(!1===this._.onEscape(t))return!1},this),s.onShow=function(){s._.panel.getHolderElement().getParent().addClass("cke").addClass("cke_reset_all")},s.onHide=CKEDITOR.tools.bind(function(){this._.onHide&&this._.onHide()},this),(a=s.addBlock(this.id,this._.panelDefinition.block)).autoSize=!0,(l=a.keys)[40]="next",l[9]="next",l[38]="prev",l[CKEDITOR.SHIFT+9]="prev",l["rtl"==o.lang.dir?37:39]=CKEDITOR.env.ie?"mouseup":"click",l[32]=CKEDITOR.env.ie?"mouseup":"click",CKEDITOR.env.ie&&(l[13]="mouseup"),(l=(a=this._.element=a.element).getDocument()).getBody().setStyle("overflow","hidden"),l.getElementsByTag("html").getItem(0).setStyle("overflow","hidden"),this._.itemOverFn=CKEDITOR.tools.addFunction(function(t){clearTimeout(this._.showSubTimeout),this._.showSubTimeout=CKEDITOR.tools.setTimeout(this._.showSubMenu,o.config.menu_subMenuDelay||400,this,[t])},this),this._.itemOutFn=CKEDITOR.tools.addFunction(function(){clearTimeout(this._.showSubTimeout)},this),this._.itemClickFn=CKEDITOR.tools.addFunction(function(t){var e=this.items[t];e.state==CKEDITOR.TRISTATE_DISABLED?this.hide(1):e.getItems?this._.showSubMenu(t):this._.onClick(e)},this);!function(t){t.sort(function(t,e){return t.group<e.group?-1:t.group>e.group?1:t.order<e.order?-1:t.order>e.order?1:0})}(r);for(var l=['<div class="cke_menu'+((l=o.elementPath())&&l.direction()!=o.lang.dir?" cke_mixed_dir_content":"")+'" role="presentation">'],c=r.length,u=c&&r[0].group,h=0;h<c;h++){var d=r[h];u!=d.group&&(l.push('<div class="cke_menuseparator" role="separator"></div>'),u=d.group),d.render(this,h,l)}l.push("</div>"),a.setHtml(l.join("")),CKEDITOR.ui.fire("ready",this),this.parent?this.parent._.panel.showAsChild(s,this.id,t,e,n,i):s.showBlock(this.id,t,e,n,i),o.fire("menuShow",[s])}},addListener:function(t){this._.listeners.push(t)},hide:function(t){this._.onHide&&this._.onHide(),this._.panel&&this._.panel.hide(t)},findItemByCommandName:function(t){var e=CKEDITOR.tools.array.filter(this.items,function(e){return t===e.command});return e.length?{item:e=e[0],element:this._.element.findOne("."+e.className)}:null}}}),CKEDITOR.menuItem=CKEDITOR.tools.createClass({$:function(t,e,n){CKEDITOR.tools.extend(this,n,{order:0,className:"cke_menubutton__"+e}),this.group=t._.menuGroups[this.group],this.editor=t,this.name=e},proto:{render:function(t,e,o){var s,a,l=t.id+String(e),c=void 0===this.state?CKEDITOR.TRISTATE_OFF:this.state,u="",h=this.editor,d=c==CKEDITOR.TRISTATE_ON?"on":c==CKEDITOR.TRISTATE_DISABLED?"disabled":"off";this.role in{menuitemcheckbox:1,menuitemradio:1}&&(u=' aria-checked="'+(c==CKEDITOR.TRISTATE_ON?"true":"false")+'"');var f=this.getItems,p="&#"+("rtl"==this.editor.lang.dir?"9668":"9658")+";",g=this.name;this.icon&&!/\./.test(this.icon)&&(g=this.icon),this.command&&(s=h.getCommand(this.command),(s=h.getCommandKeystroke(s))&&(a=CKEDITOR.tools.keystrokeToString(h.lang.common.keyboard,s))),s=CKEDITOR.tools.htmlEncodeAttr(this.label),t={id:l,name:this.name,iconName:g,label:this.label,attrLabel:s,cls:this.className||"",state:d,hasPopup:f?"true":"false",disabled:c==CKEDITOR.TRISTATE_DISABLED,title:s+(a?" ("+a.display+")":""),ariaShortcut:a?h.lang.common.keyboardShortcut+" "+a.aria:"",href:"javascript:void('"+(s||"").replace("'")+"')",hoverFn:t._.itemOverFn,moveOutFn:t._.itemOutFn,clickFn:t._.itemClickFn,index:e,iconStyle:CKEDITOR.skin.getIconStyle(g,"rtl"==this.editor.lang.dir,g==this.icon?null:this.icon,this.iconOffset),shortcutHtml:a?r.output({shortcut:a.display}):"",arrowHtml:f?i.output({label:p}):"",role:this.role?this.role:"menuitem",ariaChecked:u},n.output(t,o)}}})}(),CKEDITOR.config.menu_groups="clipboard,form,tablecell,tablecellproperties,tablerow,tablecolumn,table,anchor,link,image,checkbox,radio,textfield,hiddenfield,imagebutton,button,select,textarea,div",CKEDITOR.plugins.add("contextmenu",{requires:"menu",onLoad:function(){CKEDITOR.plugins.contextMenu=CKEDITOR.tools.createClass({base:CKEDITOR.menu,$:function(t){this.base.call(this,t,{panel:{css:t.config.contextmenu_contentsCss,className:"cke_menu_panel",attributes:{"aria-label":t.lang.contextmenu.options}}})},proto:{addTarget:function(t,e){function n(){r=!1}var i,r;if(t.on("contextmenu",function(t){t=t.data;var n=CKEDITOR.env.webkit?i:CKEDITOR.env.mac?t.$.metaKey:t.$.ctrlKey;if(!(e&&n||(t.preventDefault(),r))){if(CKEDITOR.env.mac&&CKEDITOR.env.webkit){n=this.editor;var o=new CKEDITOR.dom.elementPath(t.getTarget(),n.editable()).contains(function(t){return t.hasAttribute("contenteditable")},!0);o&&"false"==o.getAttribute("contenteditable")&&n.getSelection().fake(o)}o=t.getTarget().getDocument();var s=t.getTarget().getDocument().getDocumentElement(),a=(n=!o.equals(CKEDITOR.document),o=o.getWindow().getScrollPosition(),n?t.$.clientX:t.$.pageX||o.x+t.$.clientX),l=n?t.$.clientY:t.$.pageY||o.y+t.$.clientY;CKEDITOR.tools.setTimeout(function(){this.open(s,null,a,l)},CKEDITOR.env.ie?200:0,this)}},this),CKEDITOR.env.webkit){var o=function(){i=0};t.on("keydown",function(t){i=CKEDITOR.env.mac?t.data.$.metaKey:t.data.$.ctrlKey}),t.on("keyup",o),t.on("contextmenu",o)}CKEDITOR.env.gecko&&!CKEDITOR.env.mac&&(t.on("keydown",function(t){t.data.$.shiftKey&&121===t.data.$.keyCode&&(r=!0)},null,null,0),t.on("keyup",n),t.on("contextmenu",n))},open:function(t,e,n,i){!1!==this.editor.config.enableContextMenu&&this.editor.getSelection().getType()!==CKEDITOR.SELECTION_NONE&&(this.editor.focus(),t=t||CKEDITOR.document.getDocumentElement(),this.editor.selectionChange(1),this.show(t,e,n,i))}}})},beforeInit:function(t){var e=t.contextMenu=new CKEDITOR.plugins.contextMenu(t);t.on("contentDom",function(){e.addTarget(t.editable(),!1!==t.config.browserContextMenuOnCtrl)}),t.addCommand("contextMenu",{exec:function(t){var e,n=0,i=0;(e=(e=(e=t.getSelection().getRanges())[e.length-1].getClientRects(t.editable().isInline()))[e.length-1])&&(n=e["rtl"===t.lang.dir?"left":"right"],i=e.bottom),t.contextMenu.open(t.document.getBody().getParent(),null,n,i)}}),t.setKeystroke(CKEDITOR.SHIFT+121,"contextMenu"),t.setKeystroke(CKEDITOR.CTRL+CKEDITOR.SHIFT+121,"contextMenu")}}),CKEDITOR.plugins.add("listblock",{requires:"panel",onLoad:function(){var t=CKEDITOR.addTemplate("panel-list",'<ul role="presentation" class="cke_panel_list">{items}</ul>'),e=CKEDITOR.addTemplate("panel-list-item",'<li id="{id}" class="cke_panel_listItem" role=presentation><a id="{id}_option" _cke_focus=1 hidefocus=true title="{title}" draggable="false" ondragstart="return false;" href="javascript:void(\'{val}\')"  onclick="{onclick}CKEDITOR.tools.callFunction({clickFn},\'{val}\'); return false;" role="option">{text}</a></li>'),n=CKEDITOR.addTemplate("panel-list-group",'<h1 id="{id}" draggable="false" ondragstart="return false;" class="cke_panel_grouptitle" role="presentation" >{label}</h1>'),i=/\'/g;CKEDITOR.ui.panel.prototype.addListBlock=function(t,e){return this.addBlock(t,new CKEDITOR.ui.listBlock(this.getHolderElement(),e))},CKEDITOR.ui.listBlock=CKEDITOR.tools.createClass({base:CKEDITOR.ui.panel.block,$:function(t,e){var n=(e=e||{}).attributes||(e.attributes={});(this.multiSelect=!!e.multiSelect)&&(n["aria-multiselectable"]=!0),!n.role&&(n.role="listbox"),this.base.apply(this,arguments),this.element.setAttribute("role",n.role),(n=this.keys)[40]="next",n[9]="next",n[38]="prev",n[CKEDITOR.SHIFT+9]="prev",n[32]=CKEDITOR.env.ie?"mouseup":"click",CKEDITOR.env.ie&&(n[13]="mouseup"),this._.pendingHtml=[],this._.pendingList=[],this._.items={},this._.groups={}},_:{close:function(){if(this._.started){var e=t.output({items:this._.pendingList.join("")});this._.pendingList=[],this._.pendingHtml.push(e),delete this._.started}},getClick:function(){return this._.click||(this._.click=CKEDITOR.tools.addFunction(function(t){var e=this.toggle(t);this.onClick&&this.onClick(t,e)},this)),this._.click}},proto:{add:function(t,n,r){var o=CKEDITOR.tools.getNextId();this._.started||(this._.started=1,this._.size=this._.size||0),this._.items[t]=o,t={id:o,val:CKEDITOR.tools.htmlEncodeAttr(t).replace(i,"\\'"),onclick:CKEDITOR.env.ie?'return false;" onmouseup="CKEDITOR.tools.getMouseButton(event)===CKEDITOR.MOUSE_BUTTON_LEFT&&':"",clickFn:this._.getClick(),title:CKEDITOR.tools.htmlEncodeAttr(r||t),text:n||t},this._.pendingList.push(e.output(t))},startGroup:function(t){this._.close();var e=CKEDITOR.tools.getNextId();this._.groups[t]=e,this._.pendingHtml.push(n.output({id:e,label:t}))},commit:function(){this._.close(),this.element.appendHtml(this._.pendingHtml.join("")),delete this._.size,this._.pendingHtml=[]},toggle:function(t){var e=this.isMarked(t);return e?this.unmark(t):this.mark(t),!e},hideGroup:function(t){var e=(t=this.element.getDocument().getById(this._.groups[t]))&&t.getNext();t&&(t.setStyle("display","none"),e&&"ul"==e.getName()&&e.setStyle("display","none"))},hideItem:function(t){this.element.getDocument().getById(this._.items[t]).setStyle("display","none")},showAll:function(){var t,e=this._.items,n=this._.groups,i=this.element.getDocument();for(t in e)i.getById(e[t]).setStyle("display","");for(var r in n)t=(e=i.getById(n[r])).getNext(),e.setStyle("display",""),t&&"ul"==t.getName()&&t.setStyle("display","")},mark:function(t){this.multiSelect||this.unmarkAll(),t=this._.items[t];var e=this.element.getDocument().getById(t);e.addClass("cke_selected"),this.element.getDocument().getById(t+"_option").setAttribute("aria-selected",!0),this.onMark&&this.onMark(e)},markFirstDisplayed:function(){var t=this;this._.markFirstDisplayed(function(){t.multiSelect||t.unmarkAll()})},unmark:function(t){var e=this.element.getDocument();t=this._.items[t];var n=e.getById(t);n.removeClass("cke_selected"),e.getById(t+"_option").removeAttribute("aria-selected"),this.onUnmark&&this.onUnmark(n)},unmarkAll:function(){var t,e=this._.items,n=this.element.getDocument();for(t in e){var i=e[t];n.getById(i).removeClass("cke_selected"),n.getById(i+"_option").removeAttribute("aria-selected")}this.onUnmark&&this.onUnmark()},isMarked:function(t){return this.element.getDocument().getById(this._.items[t]).hasClass("cke_selected")},focus:function(t){this._.focusIndex=-1;var e,n=this.element.getElementsByTag("a"),i=-1;if(t){for(e=this.element.getDocument().getById(this._.items[t]).getFirst();t=n.getItem(++i);)if(t.equals(e)){this._.focusIndex=i;break}}else this.element.focus();e&&setTimeout(function(){e.focus()},0)}}})}}),CKEDITOR.plugins.add("richcombo",{requires:"floatpanel,listblock,button",beforeInit:function(t){t.ui.addHandler(CKEDITOR.UI_RICHCOMBO,CKEDITOR.ui.richCombo.handler)}}),function(){var t='<span id="{id}" class="cke_combo cke_combo__{name} {cls}" role="presentation"><span id="{id}_label" class="cke_combo_label">{label}</span><a class="cke_combo_button" title="{title}" tabindex="-1"'+(CKEDITOR.env.gecko&&!CKEDITOR.env.hc?"":" href=\"javascript:void('{titleJs}')\"")+' hidefocus="true" role="button" aria-labelledby="{id}_label" aria-haspopup="listbox"',e="";CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(t+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(t+=' onblur="this.style.cssText = this.style.cssText;"'),CKEDITOR.env.ie&&(e='return false;" onmouseup="CKEDITOR.tools.getMouseButton(event)==CKEDITOR.MOUSE_BUTTON_LEFT&&');t=t+' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event,this);" onfocus="return CKEDITOR.tools.callFunction({focusFn},event);" onclick="'+e+'CKEDITOR.tools.callFunction({clickFn},this);return false;"><span id="{id}_text" class="cke_combo_text cke_combo_inlinelabel">{label}</span><span class="cke_combo_open"><span class="cke_combo_arrow">'+(CKEDITOR.env.hc?"&#9660;":CKEDITOR.env.air?"&nbsp;":"")+"</span></span></a></span>";var n=CKEDITOR.addTemplate("combo",t);CKEDITOR.UI_RICHCOMBO="richcombo",CKEDITOR.ui.richCombo=CKEDITOR.tools.createClass({$:function(t){CKEDITOR.tools.extend(this,t,{canGroup:!1,title:t.label,modes:{wysiwyg:1},editorFocus:1}),t=this.panel||{},delete this.panel,this.id=CKEDITOR.tools.getNextNumber(),this.document=t.parent&&t.parent.getDocument()||CKEDITOR.document,t.className="cke_combopanel",t.block={multiSelect:t.multiSelect,attributes:t.attributes},t.toolbarRelated=!0,this._={panelDefinition:t,items:{},listeners:[]}},proto:{renderHtml:function(t){var e=[];return this.render(t,e),e.join("")},render:function(t,e){function i(){if(this.getState()!=CKEDITOR.TRISTATE_ON){var e=this.modes[t.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED;t.readOnly&&!this.readOnly&&(e=CKEDITOR.TRISTATE_DISABLED),this.setState(e),this.setValue(""),e!=CKEDITOR.TRISTATE_DISABLED&&this.refresh&&this.refresh()}}var r,o,s=CKEDITOR.env,a="cke_"+this.id,l=CKEDITOR.tools.addFunction(function(e){o&&(t.unlockSelection(1),o=0),r.execute(e)},this),c=this;r={id:a,combo:this,focus:function(){CKEDITOR.document.getById(a).getChild(1).focus()},execute:function(e){var n=c._;if(n.state!=CKEDITOR.TRISTATE_DISABLED)if(c.createPanel(t),n.on)n.panel.hide();else{c.commit();var i=c.getValue();i?n.list.mark(i):n.list.unmarkAll(),n.panel.showBlock(c.id,new CKEDITOR.dom.element(e),4)}},clickFn:l},this._.listeners.push(t.on("activeFilterChange",i,this)),this._.listeners.push(t.on("mode",i,this)),this._.listeners.push(t.on("selectionChange",i,this)),!this.readOnly&&this._.listeners.push(t.on("readOnly",i,this));var u=CKEDITOR.tools.addFunction(function(t,e){var n=(t=new CKEDITOR.dom.event(t)).getKeystroke();switch(n){case 13:case 32:case 40:CKEDITOR.tools.callFunction(l,e);break;default:r.onkey(r,n)}t.preventDefault()}),h=CKEDITOR.tools.addFunction(function(){r.onfocus&&r.onfocus()});return o=0,r.keyDownFn=u,s={id:a,name:this.name||this.command,label:this.label,title:this.title,cls:this.className||"",titleJs:s.gecko&&!s.hc?"":(this.title||"").replace("'",""),keydownFn:u,focusFn:h,clickFn:l},n.output(s,e),this.onRender&&this.onRender(),r},createPanel:function(t){if(!this._.panel){var e=this._.panelDefinition,n=this._.panelDefinition.block,i=e.parent||CKEDITOR.document.getBody(),r="cke_combopanel__"+this.name,o=new CKEDITOR.ui.floatPanel(t,i,e),s=(e=o.addListBlock(this.id,n),this);o.onShow=function(){this.element.addClass(r),s.setState(CKEDITOR.TRISTATE_ON),s._.on=1,s.editorFocus&&!t.focusManager.hasFocus&&t.focus(),s.onOpen&&s.onOpen()},o.onHide=function(e){this.element.removeClass(r),s.setState(s.modes&&s.modes[t.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),s._.on=0,!e&&s.onClose&&s.onClose()},o.onEscape=function(){o.hide(1)},e.onClick=function(t,e){s.onClick&&s.onClick.call(s,t,e),o.hide()},this._.panel=o,this._.list=e,o.getBlock(this.id).onHide=function(){s._.on=0,s.setState(CKEDITOR.TRISTATE_OFF)},this.init&&this.init()}},setValue:function(t,e){this._.value=t,(n=this.document.getById("cke_"+this.id+"_text"))&&(t||e?n.removeClass("cke_combo_inlinelabel"):(e=this.label,n.addClass("cke_combo_inlinelabel")),n.setText(void 0!==e?e:t));var n=void 0!==e?e:t,i=this.label;n=n===i?n:n+", "+i;(i=this.document.getById("cke_"+this.id+"_label"))&&i.setText(n)},getValue:function(){return this._.value||""},unmarkAll:function(){this._.list.unmarkAll()},mark:function(t){this._.list.mark(t)},hideItem:function(t){this._.list.hideItem(t)},hideGroup:function(t){this._.list.hideGroup(t)},showAll:function(){this._.list.showAll()},add:function(t,e,n){this._.items[t]=n||t,this._.list.add(t,e,n)},startGroup:function(t){this._.list.startGroup(t)},commit:function(){this._.committed||(this._.list.commit(),this._.committed=1,CKEDITOR.ui.fire("ready",this)),this._.committed=1},setState:function(t){if(this._.state!=t){var e=this.document.getById("cke_"+this.id),n=e.getElementsByTag("a").getItem(0);e.setState(t,"cke_combo"),t==CKEDITOR.TRISTATE_DISABLED?e.setAttribute("aria-disabled",!0):e.removeAttribute("aria-disabled"),n&&n.setAttribute("aria-expanded",t==CKEDITOR.TRISTATE_ON),this._.state=t}},getState:function(){return this._.state},enable:function(){this._.state==CKEDITOR.TRISTATE_DISABLED&&this.setState(this._.lastState)},disable:function(){this._.state!=CKEDITOR.TRISTATE_DISABLED&&(this._.lastState=this._.state,this.setState(CKEDITOR.TRISTATE_DISABLED))},destroy:function(){CKEDITOR.tools.array.forEach(this._.listeners,function(t){t.removeListener()}),this._.listeners=[]},select:function(t){if(!CKEDITOR.tools.isEmpty(this._.items))for(var e in this._.items)if(t({value:e,text:this._.items[e]})){this.setValue(e);break}}},statics:{handler:{create:function(t){return new CKEDITOR.ui.richCombo(t)}}}}),CKEDITOR.ui.prototype.addRichCombo=function(t,e){this.add(t,CKEDITOR.UI_RICHCOMBO,e)}}(),function(){function t(t,n){var r,o=t.config,s=n.lang,a=new CKEDITOR.style(n.styleDefinition),l=new i({entries:n.entries,styleVariable:n.styleVariable,styleDefinition:n.styleDefinition});t.addCommand(n.commandName,{exec:function(t,n){var i=n.newStyle,r=n.oldStyle,o=t.getSelection().getRanges()[0],s=void 0===i;(r||i)&&(r&&o.collapsed&&e({editor:t,range:o,style:r}),s?t.removeStyle(r):(r&&!function(t,e){if(!(t instanceof CKEDITOR.style&&e instanceof CKEDITOR.style))return!1;var n=function(t,e){var n=t.getDefinition().attributes,i=e.getDefinition().attributes;return CKEDITOR.tools.objectCompare(n,i)}(t,e),i=function(t,e){return CKEDITOR.style.getStyleText(t.getDefinition())===CKEDITOR.style.getStyleText(e.getDefinition())}(t,e);return n&&i}(r,i)&&t.removeStyle(r),t.applyStyle(i)))},refresh:function(t,e){a.checkApplicable(e,t,t.activeFilter)||this.setState(CKEDITOR.TRISTATE_DISABLED)}}),r=t.getCommand(n.commandName),t.ui.addRichCombo(n.comboName,{label:s.label,title:s.panelTitle,command:n.commandName,toolbar:"styles,"+n.order,defaultValue:"cke-default",allowedContent:a,requiredContent:a,contentTransformations:"span"===n.styleDefinition.element?[[{element:"font",check:"span",left:function(t){return!!t.attributes.size||!!t.attributes.align||!!t.attributes.face},right:function(t){var e=" x-small small medium large x-large xx-large 48px".split(" ");t.name="span",t.attributes.size&&(t.styles["font-size"]=e[t.attributes.size],delete t.attributes.size),t.attributes.align&&(t.styles["text-align"]=t.attributes.align,delete t.attributes.align),t.attributes.face&&(t.styles["font-family"]=t.attributes.face,delete t.attributes.face)}}]]:null,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(o.contentsCss),multiSelect:!1,attributes:{"aria-label":s.panelTitle}},init:function(){var e="("+t.lang.common.optionDefault+")";this.startGroup(s.panelTitle),this.add(this.defaultValue,e,e),l.addToCombo(this)},onClick:function(e){var i=this.getValue();t.focus(),t.fire("saveSnapshot"),t.execCommand(n.commandName,{newStyle:l.getStyle(e),oldStyle:l.getStyle(i)}),t.fire("saveSnapshot")},onRender:function(){t.on("selectionChange",function(e){var i=this.getValue();(e=l.getMatchingValue(t,e.data.path))?e!=i&&this.setValue(e):this.setValue("",n.defaultLabel)},this),r.on("state",function(){this.setState(r.state)},this)},refresh:function(){this.setState(r.state)}})}function e(t){var e,i,r,o=t.editor,s=t.range,a=t.style;if(t=(e=o.elementPath()).contains(function(t){return a.checkElementRemovable(t)})){if(i=s.checkBoundaryOfElement(t,CKEDITOR.START),r=s.checkBoundaryOfElement(t,CKEDITOR.END),i&&r){for(i=s.createBookmark();e=t.getFirst();)e.insertBefore(t);t.remove(),s.moveToBookmark(i)}else i||r?s.moveToPosition(t,i?CKEDITOR.POSITION_BEFORE_START:CKEDITOR.POSITION_AFTER_END):(s.splitElement(t),s.moveToPosition(t,CKEDITOR.POSITION_AFTER_END)),n(s,e.elements.slice(),t);o.getSelection().selectRanges([s])}}function n(t,e,i){var r=e.pop();if(r){if(i)return n(t,e,r.equals(i)?null:i);i=r.clone(),t.insertNode(i),t.moveToPosition(i,CKEDITOR.POSITION_AFTER_START),n(t,e)}}var i=CKEDITOR.tools.createClass({$:function(t){var e=t.entries.split(";");this._.data={},this._.names=[];for(var n=0;n<e.length;n++){var i,r,o=e[n];o?(i=(o=o.split("/"))[0],o=o[1],(r={})[t.styleVariable]=o||i,this._.data[i]=new CKEDITOR.style(t.styleDefinition,r),this._.data[i]._.definition.name=i,this._.names.push(i)):(e.splice(n,1),n--)}},proto:{getStyle:function(t){return this._.data[t]},addToCombo:function(t){for(var e=0;e<this._.names.length;e++){var n=this._.names[e];t.add(n,this.getStyle(n).buildPreview(),n)}},getMatchingValue:function(t,e){for(var n,i=e.elements,r=0;r<i.length;r++)if(n=i[r],n=this._.findMatchingStyleName(t,n))return n;return null}},_:{findMatchingStyleName:function(t,e){return CKEDITOR.tools.array.find(this._.names,function(n){return this.getStyle(n).checkElementMatch(e,!0,t)},this)}}});CKEDITOR.plugins.add("font",{requires:"richcombo",init:function(e){var n=e.config;t(e,{comboName:"Font",commandName:"font",styleVariable:"family",lang:e.lang.font,entries:n.font_names,defaultLabel:n.font_defaultLabel,styleDefinition:n.font_style,order:30}),t(e,{comboName:"FontSize",commandName:"fontSize",styleVariable:"size",lang:e.lang.font.fontSize,entries:n.fontSize_sizes,defaultLabel:n.fontSize_defaultLabel,styleDefinition:n.fontSize_style,order:40})}})}(),CKEDITOR.config.font_names="Arial/Arial, Helvetica, sans-serif;Comic Sans MS/Comic Sans MS, cursive;Courier New/Courier New, Courier, monospace;Georgia/Georgia, serif;Lucida Sans Unicode/Lucida Sans Unicode, Lucida Grande, sans-serif;Tahoma/Tahoma, Geneva, sans-serif;Times New Roman/Times New Roman, Times, serif;Trebuchet MS/Trebuchet MS, Helvetica, sans-serif;Verdana/Verdana, Geneva, sans-serif",CKEDITOR.config.font_defaultLabel="",CKEDITOR.config.font_style={element:"span",styles:{"font-family":"#(family)"},overrides:[{element:"font",attributes:{face:null}}]},CKEDITOR.config.fontSize_sizes="8/8px;9/9px;10/10px;11/11px;12/12px;14/14px;16/16px;18/18px;20/20px;22/22px;24/24px;26/26px;28/28px;36/36px;48/48px;72/72px",CKEDITOR.config.fontSize_defaultLabel="",CKEDITOR.config.fontSize_style={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}}]},CKEDITOR.plugins.add("format",{requires:"richcombo",init:function(t){if(!t.blockless){for(var e=t.config,n=t.lang.format,i=e.format_tags.split(";"),r={},o=0,s=[],a=0;a<i.length;a++){var l=i[a],c=new CKEDITOR.style(e["format_"+l]);t.filter.customConfig&&!t.filter.check(c)||(o++,r[l]=c,r[l]._.enterMode=t.config.enterMode,s.push(c))}0!==o&&t.ui.addRichCombo("Format",{label:n.label,title:n.panelTitle,toolbar:"styles,20",allowedContent:s,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(e.contentsCss),multiSelect:!1,attributes:{"aria-label":n.panelTitle}},init:function(){for(var t in this.startGroup(n.panelTitle),r){var e=n["tag_"+t];this.add(t,r[t].buildPreview(e),e)}},onClick:function(e){t.focus(),t.fire("saveSnapshot"),e=r[e];var n=t.elementPath();t.fire("stylesRemove",{type:CKEDITOR.STYLE_BLOCK}),e.checkActive(n,t)||t.applyStyle(e),setTimeout(function(){t.fire("saveSnapshot")},0)},onRender:function(){t.on("selectionChange",function(e){var n=this.getValue();for(var i in e=e.data.path,this.refresh(),r)if(r[i].checkActive(e,t))return void(i!=n&&this.setValue(i,t.lang.format["tag_"+i]));this.setValue("")},this)},onOpen:function(){for(var e in this.showAll(),r)t.activeFilter.check(r[e])||this.hideItem(e)},refresh:function(){var e=t.elementPath();if(e){if(e.isContextFor("p"))for(var n in r)if(t.activeFilter.check(r[n]))return;this.setState(CKEDITOR.TRISTATE_DISABLED)}}})}}}),CKEDITOR.config.format_tags="p;h1;h2;h3;h4;h5;h6;pre;address;div",CKEDITOR.config.format_p={element:"p"},CKEDITOR.config.format_div={element:"div"},CKEDITOR.config.format_pre={element:"pre"},CKEDITOR.config.format_address={element:"address"},CKEDITOR.config.format_h1={element:"h1"},CKEDITOR.config.format_h2={element:"h2"},CKEDITOR.config.format_h3={element:"h3"},CKEDITOR.config.format_h4={element:"h4"},CKEDITOR.config.format_h5={element:"h5"},CKEDITOR.config.format_h6={element:"h6"},function(){function t(t,e){var n;if(e)n=t.getComputedStyle("text-align");else{for(;(!t.hasAttribute||!t.hasAttribute("align")&&!t.getStyle("text-align"))&&(n=t.getParent());)t=n;n=t.getStyle("text-align")||t.getAttribute("align")||""}return n&&(n=n.replace(/(?:-(?:moz|webkit)-)?(?:start|auto)/i,"")),!n&&e&&(n="rtl"==t.getComputedStyle("direction")?"right":"left"),n}function e(t,e,n){this.editor=t,this.name=e,this.value=n,this.context="p",e=t.config.justifyClasses;var i=t.config.enterMode==CKEDITOR.ENTER_P?"p":"div";if(e){switch(n){case"left":this.cssClassName=e[0];break;case"center":this.cssClassName=e[1];break;case"right":this.cssClassName=e[2];break;case"justify":this.cssClassName=e[3]}this.cssClassRegex=new RegExp("(?:^|\\s+)(?:"+e.join("|")+")(?=$|\\s)"),this.requiredContent=i+"("+this.cssClassName+")"}else this.requiredContent=i+"{text-align}";this.allowedContent={"caption div h1 h2 h3 h4 h5 h6 p pre td th li":{propertiesOnly:!0,styles:this.cssClassName?null:"text-align",classes:this.cssClassName||null}},t.config.enterMode==CKEDITOR.ENTER_BR&&(this.allowedContent.div=!0)}function n(t){var e=t.editor,n=e.createRange();n.setStartBefore(t.data.node),n.setEndAfter(t.data.node);for(var i,r=new CKEDITOR.dom.walker(n);i=r.next();)if(i.type==CKEDITOR.NODE_ELEMENT)if(!i.equals(t.data.node)&&i.getDirection())n.setStartAfter(i),r=new CKEDITOR.dom.walker(n);else{var o=e.config.justifyClasses;o&&(i.hasClass(o[0])?(i.removeClass(o[0]),i.addClass(o[2])):i.hasClass(o[2])&&(i.removeClass(o[2]),i.addClass(o[0]))),"left"==(o=i.getStyle("text-align"))?i.setStyle("text-align","right"):"right"==o&&i.setStyle("text-align","left")}}e.prototype={exec:function(e){var n=e.getSelection(),i=e.config.enterMode;if(n){for(var r,o,s=n.createBookmarks(),a=n.getRanges(),l=this.cssClassName,c=e.config.useComputedState,u=a.length-1;0<=u;u--)for((r=a[u].createIterator()).enlargeBr=i!=CKEDITOR.ENTER_BR;o=r.getNextParagraph(i==CKEDITOR.ENTER_P?"p":"div");)if(!o.isReadOnly()){var h,d=o.getName();if(h=e.activeFilter.check(d+"{text-align}"),(d=e.activeFilter.check(d+"("+l+")"))||h){o.removeAttribute("align"),o.removeStyle("text-align");var f=l&&(o.$.className=CKEDITOR.tools.ltrim(o.$.className.replace(this.cssClassRegex,""))),p=this.state==CKEDITOR.TRISTATE_OFF&&(!c||t(o,!0)!=this.value);l&&d?p?o.addClass(l):f||o.removeAttribute("class"):p&&h&&o.setStyle("text-align",this.value)}}e.focus(),e.forceNextSelectionCheck(),n.selectBookmarks(s)}},refresh:function(e,n){var i=n.block||n.blockLimit,r=i.getName(),o=i.equals(e.editable());r=this.cssClassName?e.activeFilter.check(r+"("+this.cssClassName+")"):e.activeFilter.check(r+"{text-align}");o&&!CKEDITOR.dtd.$list[n.lastElement.getName()]?this.setState(CKEDITOR.TRISTATE_OFF):!o&&r?this.setState(t(i,this.editor.config.useComputedState)==this.value?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_DISABLED)}},CKEDITOR.plugins.add("justify",{init:function(t){if(!t.blockless){var i=new e(t,"justifyleft","left"),r=new e(t,"justifycenter","center"),o=new e(t,"justifyright","right"),s=new e(t,"justifyblock","justify");t.addCommand("justifyleft",i),t.addCommand("justifycenter",r),t.addCommand("justifyright",o),t.addCommand("justifyblock",s),t.ui.addButton&&(t.ui.addButton("JustifyLeft",{isToggle:!0,label:t.lang.common.alignLeft,command:"justifyleft",toolbar:"align,10"}),t.ui.addButton("JustifyCenter",{isToggle:!0,label:t.lang.common.center,command:"justifycenter",toolbar:"align,20"}),t.ui.addButton("JustifyRight",{isToggle:!0,label:t.lang.common.alignRight,command:"justifyright",toolbar:"align,30"}),t.ui.addButton("JustifyBlock",{isToggle:!0,label:t.lang.common.justify,command:"justifyblock",toolbar:"align,40"})),t.on("dirChanged",n)}}})}(),CKEDITOR.plugins.add("stylescombo",{requires:"richcombo",init:function(t){var e=t.config,n=t.lang.stylescombo,i={},r=[],o=[];t.on("stylesSet",function(n){if(n=n.data.styles){for(var s,a,l,c=0,u=n.length;c<u;c++)s=n[c],t.blockless&&s.element in CKEDITOR.dtd.$block||"string"==typeof s.type&&!CKEDITOR.style.customHandlers[s.type]||(a=s.name,s=new CKEDITOR.style(s),t.filter.customConfig&&!t.filter.check(s))||(s._name=a,s._.enterMode=e.enterMode,s._.type=l=s.assignedTo||s.type,s._.weight=c+1e3*(l==CKEDITOR.STYLE_OBJECT?1:l==CKEDITOR.STYLE_BLOCK?2:3),i[a]=s,r.push(s),o.push(s));r.sort(function(t,e){return t._.weight-e._.weight})}}),t.on("stylesRemove",function(e){var n,r=void 0===(e=e.data&&e.data.type);for(n in i){var o=i[n];(r||o.type===e)&&t.removeStyle(o)}}),t.ui.addRichCombo("Styles",{label:n.label,title:n.panelTitle,toolbar:"styles,10",allowedContent:o,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(e.contentsCss),multiSelect:!0,attributes:{"aria-label":n.panelTitle}},init:function(){var t,e,i,o,s,a;for(s=0,a=r.length;s<a;s++)e=(t=r[s])._name,(o=t._.type)!=i&&(this.startGroup(n["panelTitle"+String(o)]),i=o),this.add(e,t.type==CKEDITOR.STYLE_OBJECT?e:t.buildPreview(),e);this.commit()},onClick:function(e){t.focus(),t.fire("saveSnapshot"),e=i[e];var n=t.elementPath();e.group&&e.removeStylesFromSameGroup(t)?t.applyStyle(e):t[e.checkActive(n,t)?"removeStyle":"applyStyle"](e),t.fire("saveSnapshot")},onRender:function(){t.on("selectionChange",function(e){for(var n,r=this.getValue(),o=0,s=(e=e.data.path.elements).length;o<s;o++)for(var a in n=e[o],i)if(i[a].checkElementRemovable(n,!0,t))return void(a!=r&&this.setValue(a));this.setValue("")},this)},onOpen:function(){var e=(e=t.getSelection()).getSelectedElement()||e.getStartElement()||t.editable(),r=(e=t.elementPath(e),[0,0,0,0]);for(var o in this.showAll(),this.unmarkAll(),i){var s=i[o],a=s._.type;s.checkApplicable(e,t,t.activeFilter)?r[a]++:this.hideItem(o),s.checkActive(e,t)&&this.mark(o)}r[CKEDITOR.STYLE_BLOCK]||this.hideGroup(n["panelTitle"+String(CKEDITOR.STYLE_BLOCK)]),r[CKEDITOR.STYLE_INLINE]||this.hideGroup(n["panelTitle"+String(CKEDITOR.STYLE_INLINE)]),r[CKEDITOR.STYLE_OBJECT]||this.hideGroup(n["panelTitle"+String(CKEDITOR.STYLE_OBJECT)])},refresh:function(){var e=t.elementPath();if(e){for(var n in i)if(i[n].checkApplicable(e,t,t.activeFilter))return;this.setState(CKEDITOR.TRISTATE_DISABLED)}},reset:function(){i={},r=[]}})}}),function(){function t(t,e){CKEDITOR.tools.extend(this,{editor:t,editable:t.editable(),doc:t.document,win:t.window},e,!0),this.inline=this.editable.isInline(),this.inline||(this.frame=this.win.getFrame()),this.target=this[this.inline?"editable":"doc"]}function e(t,e){CKEDITOR.tools.extend(this,e,{editor:t},!0)}function n(t,e){var n=t.editable();CKEDITOR.tools.extend(this,{editor:t,editable:n,inline:n.isInline(),doc:t.document,win:t.window,container:CKEDITOR.document.getBody(),winTop:CKEDITOR.document.getWindow()},e,!0),this.hidden={},this.visible={},this.inline||(this.frame=this.win.getFrame()),this.queryViewport();var i=CKEDITOR.tools.bind(this.queryViewport,this),s=CKEDITOR.tools.bind(this.hideVisible,this),a=CKEDITOR.tools.bind(this.removeAll,this);n.attachListener(this.winTop,"resize",i),n.attachListener(this.winTop,"scroll",i),n.attachListener(this.winTop,"resize",s),n.attachListener(this.win,"scroll",s),n.attachListener(this.inline?n:this.frame,"mouseout",function(t){var e=t.data.$.clientX;t=t.data.$.clientY,this.queryViewport(),(e<=this.rect.left||e>=this.rect.right||t<=this.rect.top||t>=this.rect.bottom)&&this.hideVisible(),(0>=e||e>=this.winTopPane.width||0>=t||t>=this.winTopPane.height)&&this.hideVisible()},this),n.attachListener(t,"resize",i),n.attachListener(t,"mode",a),t.on("destroy",a),this.lineTpl=new CKEDITOR.template('<div data-cke-lineutils-line="1" class="cke_reset_all" style="{lineStyle}"><span style="{tipLeftStyle}">&nbsp;</span><span style="{tipRightStyle}">&nbsp;</span></div>').output({lineStyle:CKEDITOR.tools.writeCssText(CKEDITOR.tools.extend({},o,this.lineStyle,!0)),tipLeftStyle:CKEDITOR.tools.writeCssText(CKEDITOR.tools.extend({},r,{left:"0px","border-left-color":"red","border-width":"6px 0 6px 6px"},this.tipCss,this.tipLeftStyle,!0)),tipRightStyle:CKEDITOR.tools.writeCssText(CKEDITOR.tools.extend({},r,{right:"0px","border-right-color":"red","border-width":"6px 6px 6px 0"},this.tipCss,this.tipRightStyle,!0))})}function i(t){var e;return(e=t&&t.type==CKEDITOR.NODE_ELEMENT)&&(e=!(s[t.getComputedStyle("float")]||s[t.getAttribute("align")])),e&&!a[t.getComputedStyle("position")]}CKEDITOR.plugins.add("lineutils"),CKEDITOR.LINEUTILS_BEFORE=1,CKEDITOR.LINEUTILS_AFTER=2,CKEDITOR.LINEUTILS_INSIDE=4,t.prototype={start:function(t){var e,n,i,r,o=this,s=this.editor,a=this.doc,l=CKEDITOR.tools.eventsBuffer(50,function(){s.readOnly||"wysiwyg"!=s.mode||(o.relations={},(n=a.$.elementFromPoint(i,r))&&n.nodeType&&(e=new CKEDITOR.dom.element(n),o.traverseSearch(e),isNaN(i+r)||o.pixelSearch(e,i,r),t&&t(o.relations,i,r)))});this.listener=this.editable.attachListener(this.target,"mousemove",function(t){i=t.data.$.clientX,r=t.data.$.clientY,l.input()}),this.editable.attachListener(this.inline?this.editable:this.frame,"mouseout",function(){l.reset()})},stop:function(){this.listener&&this.listener.removeListener()},getRange:function(){var t={};return t[CKEDITOR.LINEUTILS_BEFORE]=CKEDITOR.POSITION_BEFORE_START,t[CKEDITOR.LINEUTILS_AFTER]=CKEDITOR.POSITION_AFTER_END,t[CKEDITOR.LINEUTILS_INSIDE]=CKEDITOR.POSITION_AFTER_START,function(e){var n=this.editor.createRange();return n.moveToPosition(this.relations[e.uid].element,t[e.type]),n}}(),store:function(){function t(t,e,n){var i=t.getUniqueId();i in n?n[i].type|=e:n[i]={element:t,type:e}}return function(e,n){var r;n&CKEDITOR.LINEUTILS_AFTER&&i(r=e.getNext())&&r.isVisible()&&(t(r,CKEDITOR.LINEUTILS_BEFORE,this.relations),n^=CKEDITOR.LINEUTILS_AFTER),n&CKEDITOR.LINEUTILS_INSIDE&&i(r=e.getFirst())&&r.isVisible()&&(t(r,CKEDITOR.LINEUTILS_BEFORE,this.relations),n^=CKEDITOR.LINEUTILS_INSIDE),t(e,n,this.relations)}}(),traverseSearch:function(t){var e,n,r;do{if(!(r=t.$["data-cke-expando"])||!(r in this.relations)){if(t.equals(this.editable))break;if(i(t))for(e in this.lookups)(n=this.lookups[e](t))&&this.store(t,n)}}while((!t||t.type!=CKEDITOR.NODE_ELEMENT||"true"!=t.getAttribute("contenteditable"))&&(t=t.getParent()))},pixelSearch:function(){function t(t,n,r,o,s){for(var a,l=0;s(r)&&(r+=o,25!=++l);)if(a=this.doc.$.elementFromPoint(n,r))if(a==t)l=0;else if(e(t,a)&&(l=0,i(a=new CKEDITOR.dom.element(a))))return a}var e=CKEDITOR.env.ie||CKEDITOR.env.webkit?function(t,e){return t.contains(e)}:function(t,e){return!!(16&t.compareDocumentPosition(e))};return function(e,n,r){var o=this.win.getViewPaneSize().height,s=t.call(this,e.$,n,r,-1,function(t){return 0<t});if(n=t.call(this,e.$,n,r,1,function(t){return t<o}),s)for(this.traverseSearch(s);!s.getParent().equals(e);)s=s.getParent();if(n)for(this.traverseSearch(n);!n.getParent().equals(e);)n=n.getParent();for(;(s||n)&&(s&&(s=s.getNext(i)),s&&!s.equals(n))&&(this.traverseSearch(s),n&&(n=n.getPrevious(i)),n&&!n.equals(s));)this.traverseSearch(n)}}(),greedySearch:function(){this.relations={};for(var t,e,n,r=this.editable.getElementsByTag("*"),o=0;t=r.getItem(o++);)if(!t.equals(this.editable)&&t.type==CKEDITOR.NODE_ELEMENT&&(t.hasAttribute("contenteditable")||!t.isReadOnly())&&i(t)&&t.isVisible())for(n in this.lookups)(e=this.lookups[n](t))&&this.store(t,e);return this.relations}},e.prototype={locate:function(){function t(t,e){var n=t.element[e===CKEDITOR.LINEUTILS_BEFORE?"getPrevious":"getNext"]();return n&&i(n)?(t.siblingRect=n.getClientRect(),e==CKEDITOR.LINEUTILS_BEFORE?(t.siblingRect.bottom+t.elementRect.top)/2:(t.elementRect.bottom+t.siblingRect.top)/2):e==CKEDITOR.LINEUTILS_BEFORE?t.elementRect.top:t.elementRect.bottom}return function(e){var n;for(var i in this.locations={},e)(n=e[i]).elementRect=n.element.getClientRect(),n.type&CKEDITOR.LINEUTILS_BEFORE&&this.store(i,CKEDITOR.LINEUTILS_BEFORE,t(n,CKEDITOR.LINEUTILS_BEFORE)),n.type&CKEDITOR.LINEUTILS_AFTER&&this.store(i,CKEDITOR.LINEUTILS_AFTER,t(n,CKEDITOR.LINEUTILS_AFTER)),n.type&CKEDITOR.LINEUTILS_INSIDE&&this.store(i,CKEDITOR.LINEUTILS_INSIDE,(n.elementRect.top+n.elementRect.bottom)/2);return this.locations}}(),sort:function(){var t,e,n,i;return function(r,o){for(var s in t=this.locations,e=[],t)for(var a in t[s])if(n=Math.abs(r-t[s][a]),e.length){for(i=0;i<e.length;i++)if(n<e[i].dist){e.splice(i,0,{uid:+s,type:a,dist:n});break}i==e.length&&e.push({uid:+s,type:a,dist:n})}else e.push({uid:+s,type:a,dist:n});return void 0!==o?e.slice(0,o):e}}(),store:function(t,e,n){this.locations[t]||(this.locations[t]={}),this.locations[t][e]=n}};var r={display:"block",width:"0px",height:"0px","border-color":"transparent","border-style":"solid",position:"absolute",top:"-6px"},o={height:"0px","border-top":"1px dashed red",position:"absolute","z-index":9999};n.prototype={removeAll:function(){for(var t in this.hidden)this.hidden[t].remove(),delete this.hidden[t];for(t in this.visible)this.visible[t].remove(),delete this.visible[t]},hideLine:function(t){var e=t.getUniqueId();t.hide(),this.hidden[e]=t,delete this.visible[e]},showLine:function(t){var e=t.getUniqueId();t.show(),this.visible[e]=t,delete this.hidden[e]},hideVisible:function(){for(var t in this.visible)this.hideLine(this.visible[t])},placeLine:function(t,e){var n,i,r;if(n=this.getStyle(t.uid,t.type)){for(r in this.visible)if(this.visible[r].getCustomData("hash")!==this.hash){i=this.visible[r];break}if(!i)for(r in this.hidden)if(this.hidden[r].getCustomData("hash")!==this.hash){this.showLine(i=this.hidden[r]);break}i||this.showLine(i=this.addLine()),i.setCustomData("hash",this.hash),this.visible[i.getUniqueId()]=i,i.setStyles(n),e&&e(i)}},getStyle:function(t,e){var n=this.relations[t],i=this.locations[t][e],r={};if(r.width=n.siblingRect?Math.max(n.siblingRect.width,n.elementRect.width):n.elementRect.width,r.top=this.inline?i+this.winTopScroll.y-this.rect.relativeY:this.rect.top+this.winTopScroll.y+i,r.top-this.winTopScroll.y<this.rect.top||r.top-this.winTopScroll.y>this.rect.bottom)return!1;for(var o in this.inline?r.left=n.elementRect.left-this.rect.relativeX:(0<n.elementRect.left?r.left=this.rect.left+n.elementRect.left:(r.width+=n.elementRect.left,r.left=this.rect.left),0<(n=r.left+r.width-(this.rect.left+this.winPane.width))&&(r.width-=n)),r.left+=this.winTopScroll.x,r)r[o]=CKEDITOR.tools.cssLength(r[o]);return r},addLine:function(){var t=CKEDITOR.dom.element.createFromHtml(this.lineTpl);return t.appendTo(this.container),t},prepare:function(t,e){this.relations=t,this.locations=e,this.hash=Math.random()},cleanup:function(){var t,e;for(e in this.visible)(t=this.visible[e]).getCustomData("hash")!==this.hash&&this.hideLine(t)},queryViewport:function(){this.winPane=this.win.getViewPaneSize(),this.winTopScroll=this.winTop.getScrollPosition(),this.winTopPane=this.winTop.getViewPaneSize(),this.rect=this.getClientRect(this.inline?this.editable:this.frame)},getClientRect:function(t){t=t.getClientRect();var e=this.container.getDocumentPosition(),n=this.container.getComputedStyle("position");return t.relativeX=t.relativeY=0,"static"!=n&&(t.relativeY=e.y,t.relativeX=e.x,t.top-=t.relativeY,t.bottom-=t.relativeY,t.left-=t.relativeX,t.right-=t.relativeX),t}};var s={left:1,right:1,center:1},a={absolute:1,fixed:1};CKEDITOR.plugins.lineutils={finder:t,locator:e,liner:n}}(),CKEDITOR.plugins.add("dialogui",{onLoad:function(){var t=function(t){this._||(this._={}),this._.default=this._.initValue=t.default||"",this._.required=t.required||!1;for(var e=[this._],n=1;n<arguments.length;n++)e.push(arguments[n]);return e.push(!0),CKEDITOR.tools.extend.apply(CKEDITOR.tools,e),this._},e={build:function(t,e,n){return new CKEDITOR.ui.dialog.textInput(t,e,n)}},n={build:function(t,e,n){return new CKEDITOR.ui.dialog[e.type](t,e,n)}},i={isChanged:function(){return this.getValue()!=this.getInitValue()},reset:function(t){this.setValue(this.getInitValue(),t)},setInitValue:function(){this._.initValue=this.getValue()},resetInitValue:function(){this._.initValue=this._.default},getInitValue:function(){return this._.initValue}},r=CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onChange:function(t,e){this._.domOnChangeRegistered||(t.on("load",function(){this.getInputElement().on("change",function(){t.parts.dialog.isVisible()&&this.fire("change",{value:this.getValue()})},this)},this),this._.domOnChangeRegistered=!0),this.on("change",e)}},!0),o=/^on([A-Z]\w+)/,s=function(t){for(var e in t)(o.test(e)||"title"==e||"type"==e)&&delete t[e];return t},a=function(t){(t=t.data.getKeystroke())==CKEDITOR.SHIFT+CKEDITOR.ALT+36?this.setDirectionMarker("ltr"):t==CKEDITOR.SHIFT+CKEDITOR.ALT+35&&this.setDirectionMarker("rtl")};CKEDITOR.tools.extend(CKEDITOR.ui.dialog,{labeledElement:function(e,n,i,r){if(!(4>arguments.length)){var o=t.call(this,n);o.labelId=CKEDITOR.tools.getNextId()+"_label",this._.children=[];var s={role:n.role||"presentation"};n.includeLabel&&(s["aria-labelledby"]=o.labelId),CKEDITOR.ui.dialog.uiElement.call(this,e,n,i,"div",null,s,function(){var t=[],i=n.required?" cke_required":"";return"horizontal"!=n.labelLayout?t.push('<label class="cke_dialog_ui_labeled_label'+i+'" ',' id="'+o.labelId+'"',o.inputId?' for="'+o.inputId+'"':"",(n.labelStyle?' style="'+n.labelStyle+'"':"")+">",n.required?n.label+'<span class="cke_dialog_ui_labeled_required" aria-hidden="true">*</span>':n.label,"</label>",'<div class="cke_dialog_ui_labeled_content"',n.controlStyle?' style="'+n.controlStyle+'"':"",' role="presentation">',r.call(this,e,n),"</div>"):(i={type:"hbox",widths:n.widths,padding:0,children:[{type:"html",html:'<label class="cke_dialog_ui_labeled_label'+i+'" id="'+o.labelId+'" for="'+o.inputId+'"'+(n.labelStyle?' style="'+n.labelStyle+'"':"")+">"+CKEDITOR.tools.htmlEncode(n.label)+"</label>"},{type:"html",html:'<span class="cke_dialog_ui_labeled_content"'+(n.controlStyle?' style="'+n.controlStyle+'"':"")+">"+r.call(this,e,n)+"</span>"}]},CKEDITOR.dialog._.uiElementBuilders.hbox.build(e,i,t)),t.join("")})}},textInput:function(e,n,i){if(!(3>arguments.length)){t.call(this,n);var r=this._.inputId=CKEDITOR.tools.getNextId()+"_textInput",o={class:"cke_dialog_ui_input_"+n.type,id:r,type:n.type};n.validate&&(this.validate=n.validate),n.maxLength&&(o.maxlength=n.maxLength),n.size&&(o.size=n.size),n.inputStyle&&(o.style=n.inputStyle);var s=this,l=!1;e.on("load",function(){s.getInputElement().on("keydown",function(t){13==t.data.getKeystroke()&&(l=!0)}),s.getInputElement().on("keyup",function(t){13==t.data.getKeystroke()&&l&&(e.getButton("ok")&&setTimeout(function(){e.getButton("ok").click()},0),l=!1),s.bidi&&a.call(s,t)},null,null,1e3)}),CKEDITOR.ui.dialog.labeledElement.call(this,e,n,i,function(){var t=['<div class="cke_dialog_ui_input_',n.type,'" role="presentation"'];for(var e in n.width&&t.push('style="width:'+n.width+'" '),t.push("><input "),o["aria-labelledby"]=this._.labelId,this._.required&&(o["aria-required"]=this._.required),o)t.push(e+'="'+o[e]+'" ');return t.push(" /></div>"),t.join("")})}},textarea:function(e,n,i){if(!(3>arguments.length)){t.call(this,n);var r=this,o=this._.inputId=CKEDITOR.tools.getNextId()+"_textarea",s={};n.validate&&(this.validate=n.validate),s.rows=n.rows||5,s.cols=n.cols||20,s.class="cke_dialog_ui_input_textarea "+(n.class||""),void 0!==n.inputStyle&&(s.style=n.inputStyle),n.dir&&(s.dir=n.dir),r.bidi&&e.on("load",function(){r.getInputElement().on("keyup",a)},r),CKEDITOR.ui.dialog.labeledElement.call(this,e,n,i,function(){s["aria-labelledby"]=this._.labelId,this._.required&&(s["aria-required"]=this._.required);var t,e=['<div class="cke_dialog_ui_input_textarea" role="presentation"><textarea id="',o,'" '];for(t in s)e.push(t+'="'+CKEDITOR.tools.htmlEncode(s[t])+'" ');return e.push(">",CKEDITOR.tools.htmlEncode(r._.default),"</textarea></div>"),e.join("")})}},checkbox:function(e,n,i){if(!(3>arguments.length)){var r=t.call(this,n,{default:!!n.default});n.validate&&(this.validate=n.validate),CKEDITOR.ui.dialog.uiElement.call(this,e,n,i,"span",null,null,function(){var t=CKEDITOR.tools.extend({},n,{id:n.id?n.id+"_checkbox":CKEDITOR.tools.getNextId()+"_checkbox"},!0),i=[],o=CKEDITOR.tools.getNextId()+"_label",a={class:"cke_dialog_ui_checkbox_input",type:"checkbox","aria-labelledby":o};return s(t),n.default&&(a.checked="checked"),void 0!==t.inputStyle&&(t.style=t.inputStyle),r.checkbox=new CKEDITOR.ui.dialog.uiElement(e,t,i,"input",null,a),i.push(' <label id="',o,'" for="',a.id,'"'+(n.labelStyle?' style="'+n.labelStyle+'"':"")+">",CKEDITOR.tools.htmlEncode(n.label),"</label>"),i.join("")})}},radio:function(e,n,i){if(!(3>arguments.length)){t.call(this,n),this._.default||(this._.default=this._.initValue=n.items[0][1]),n.validate&&(this.validate=n.validate);var r=[],o=this;n.role="radiogroup",n.includeLabel=!0,CKEDITOR.ui.dialog.labeledElement.call(this,e,n,i,function(){for(var t=[],i=[],a=(n.id?n.id:CKEDITOR.tools.getNextId())+"_radio",l=0;l<n.items.length;l++){var c=n.items[l],u=void 0!==c[2]?c[2]:c[0],h=void 0!==c[1]?c[1]:c[0],d=(f=CKEDITOR.tools.getNextId()+"_radio_input")+"_label",f=CKEDITOR.tools.extend({},n,{id:f,title:null,type:null},!0),p=(u=CKEDITOR.tools.extend({},f,{title:u},!0),{type:"radio",class:"cke_dialog_ui_radio_input",name:a,value:h,"aria-labelledby":d}),g=[];o._.default==h&&(p.checked="checked"),s(f),s(u),void 0!==f.inputStyle&&(f.style=f.inputStyle),f.keyboardFocusable=!0,r.push(new CKEDITOR.ui.dialog.uiElement(e,f,g,"input",null,p)),g.push(" "),new CKEDITOR.ui.dialog.uiElement(e,u,g,"label",null,{id:d,for:p.id},c[0]),t.push(g.join(""))}return new CKEDITOR.ui.dialog.hbox(e,r,t,i),i.join("")}),this._.children=r}},button:function(e,n,i){if(arguments.length){"function"==typeof n&&(n=n(e.getParentEditor())),t.call(this,n,{disabled:n.disabled||!1}),CKEDITOR.event.implementOn(this);var r=this;e.on("load",function(){var t=this.getElement();t.on("click",function(t){r.click(),t.data.preventDefault()}),t.on("keydown",function(t){t.data.getKeystroke()in{32:1}&&(r.click(),t.data.preventDefault())}),t.unselectable()},this);var o=CKEDITOR.tools.extend({},n);delete o.style;var s=CKEDITOR.tools.getNextId()+"_label";CKEDITOR.ui.dialog.uiElement.call(this,e,o,i,"a",null,{style:n.style,href:"javascript:void(0)",title:n.label,hidefocus:"true",class:n.class,role:"button","aria-labelledby":s},'<span id="'+s+'" class="cke_dialog_ui_button">'+CKEDITOR.tools.htmlEncode(n.label)+"</span>")}},select:function(e,n,i){if(!(3>arguments.length)){var r=t.call(this,n);n.validate&&(this.validate=n.validate),r.inputId=CKEDITOR.tools.getNextId()+"_select",CKEDITOR.ui.dialog.labeledElement.call(this,e,n,i,function(){var t=CKEDITOR.tools.extend({},n,{id:n.id?n.id+"_select":CKEDITOR.tools.getNextId()+"_select"},!0),i=[],o=[],a={id:r.inputId,class:"cke_dialog_ui_input_select","aria-labelledby":this._.labelId};i.push('<div class="cke_dialog_ui_input_',n.type,'" role="presentation"'),n.width&&i.push('style="width:'+n.width+'" '),i.push(">"),void 0!==n.size&&(a.size=n.size),void 0!==n.multiple&&(a.multiple=n.multiple),s(t);for(var l,c=0;c<n.items.length&&(l=n.items[c]);c++)o.push('<option value="',CKEDITOR.tools.htmlEncode(void 0!==l[1]?l[1]:l[0]).replace(/"/g,"&quot;"),'" /> ',CKEDITOR.tools.htmlEncode(l[0]));return void 0!==t.inputStyle&&(t.style=t.inputStyle),r.select=new CKEDITOR.ui.dialog.uiElement(e,t,i,"select",null,a,o.join("")),i.push("</div>"),i.join("")})}},file:function(e,n,i){if(!(3>arguments.length)){void 0===n.default&&(n.default="");var r=CKEDITOR.tools.extend(t.call(this,n),{definition:n,buttons:[]});n.validate&&(this.validate=n.validate),e.on("load",function(){CKEDITOR.document.getById(r.frameId).getParent().addClass("cke_dialog_ui_input_file")}),CKEDITOR.ui.dialog.labeledElement.call(this,e,n,i,function(){r.frameId=CKEDITOR.tools.getNextId()+"_fileInput";var t=['<iframe frameborder="0" allowtransparency="0" class="cke_dialog_ui_input_file" role="presentation" id="',r.frameId,'" title="',n.label,'" src="javascript:void('];return t.push(CKEDITOR.env.ie?"(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"})()":"0"),t.push(')"></iframe>'),t.join("")})}},fileButton:function(e,n,i){var r=this;if(!(3>arguments.length)){t.call(this,n),n.validate&&(this.validate=n.validate);var o=CKEDITOR.tools.extend({},n),s=o.onClick;o.className=(o.className?o.className+" ":"")+"cke_dialog_ui_button",o.onClick=function(t){var i=n.for;!1!==(t=!!s&&s.call(this,t))&&("xhr"!==t&&e.getContentElement(i[0],i[1]).submit(),this.disable())},e.on("load",function(){e.getContentElement(n.for[0],n.for[1])._.buttons.push(r)}),CKEDITOR.ui.dialog.button.call(this,e,o,i)}},html:function(){var t=/^\s*<[\w:]+\s+([^>]*)?>/,e=/^(\s*<[\w:]+(?:\s+[^>]*)?)((?:.|\r|\n)+)$/,n=/\/$/;return function(i,r,o){if(!(3>arguments.length)){var s=[],a=r.html;"<"!=a.charAt(0)&&(a="<span>"+a+"</span>");var l=r.focus;if(l){var c=this.focus;this.focus=function(){("function"==typeof l?l:c).call(this),this.fire("focus")},r.isFocusable&&(this.isFocusable=this.isFocusable),this.keyboardFocusable=!0}CKEDITOR.ui.dialog.uiElement.call(this,i,r,s,"span",null,null,""),s=s.join("").match(t),a=a.match(e)||["","",""],n.test(a[1])&&(a[1]=a[1].slice(0,-1),a[2]="/"+a[2]),o.push([a[1]," ",s[1]||"",a[2]].join(""))}}}(),fieldset:function(t,e,n,i,r){var o=r.label;this._={children:e},CKEDITOR.ui.dialog.uiElement.call(this,t,r,i,"fieldset",null,null,function(){var t=[];o&&t.push("<legend"+(r.labelStyle?' style="'+r.labelStyle+'"':"")+">"+o+"</legend>");for(var e=0;e<n.length;e++)t.push(n[e]);return t.join("")})}},!0),CKEDITOR.ui.dialog.html.prototype=new CKEDITOR.ui.dialog.uiElement,CKEDITOR.ui.dialog.labeledElement.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setLabel:function(t){var e=CKEDITOR.document.getById(this._.labelId);return 1>e.getChildCount()?new CKEDITOR.dom.text(t,CKEDITOR.document).appendTo(e):e.getChild(0).$.nodeValue=t,this},getLabel:function(){var t=CKEDITOR.document.getById(this._.labelId);return!t||1>t.getChildCount()?"":t.getChild(0).getText()},eventProcessors:r},!0),CKEDITOR.ui.dialog.button.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{click:function(){return!this._.disabled&&this.fire("click",{dialog:this._.dialog})},enable:function(){this._.disabled=!1;var t=this.getElement();t&&t.removeClass("cke_disabled")},disable:function(){this._.disabled=!0,this.getElement().addClass("cke_disabled")},isVisible:function(){return this.getElement().getFirst().isVisible()},isEnabled:function(){return!this._.disabled},eventProcessors:CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onClick:function(t,e){this.on("click",function(){e.apply(this,arguments)})}},!0),accessKeyUp:function(){this.click()},accessKeyDown:function(){this.focus()},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.textInput.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return CKEDITOR.document.getById(this._.inputId)},focus:function(){var t=this.selectParentTab();setTimeout(function(){var e=t.getInputElement();e&&e.$.focus()},0)},select:function(){var t=this.selectParentTab();setTimeout(function(){var e=t.getInputElement();e&&(e.$.focus(),e.$.select())},0)},accessKeyUp:function(){this.select()},setValue:function(t){if(this.bidi){var e=t&&t.charAt(0);(e="\u202a"==e?"ltr":"\u202b"==e?"rtl":null)&&(t=t.slice(1)),this.setDirectionMarker(e)}return t||(t=""),CKEDITOR.ui.dialog.uiElement.prototype.setValue.apply(this,arguments)},getValue:function(){var t=CKEDITOR.ui.dialog.uiElement.prototype.getValue.call(this);if(this.bidi&&t){var e=this.getDirectionMarker();e&&(t=("ltr"==e?"\u202a":"\u202b")+t)}return t},setDirectionMarker:function(t){var e=this.getInputElement();t?e.setAttributes({dir:t,"data-cke-dir-marker":t}):this.getDirectionMarker()&&e.removeAttributes(["dir","data-cke-dir-marker"])},getDirectionMarker:function(){return this.getInputElement().data("cke-dir-marker")},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.textarea.prototype=new CKEDITOR.ui.dialog.textInput,CKEDITOR.ui.dialog.select.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return this._.select.getElement()},add:function(t,e,n){var i=new CKEDITOR.dom.element("option",this.getDialog().getParentEditor().document),r=this.getInputElement().$;return i.$.text=t,i.$.value=null==e?t:e,null==n?CKEDITOR.env.ie?r.add(i.$):r.add(i.$,null):r.add(i.$,n),this},remove:function(t){return this.getInputElement().$.remove(t),this},clear:function(){for(var t=this.getInputElement().$;0<t.length;)t.remove(0);return this},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.checkbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getInputElement:function(){return this._.checkbox.getElement()},setValue:function(t,e){return this.getInputElement().$.checked=t,!e&&this.fire("change",{value:t}),this},getValue:function(){return this.getInputElement().$.checked},accessKeyUp:function(){this.setValue(!this.getValue())},eventProcessors:{onChange:function(t,e){return!CKEDITOR.env.ie||8<CKEDITOR.env.version?r.onChange.apply(this,arguments):(t.on("load",function(){var t=this._.checkbox.getElement();t.on("propertychange",function(e){"checked"==(e=e.data.$).propertyName&&this.fire("change",{value:t.$.checked})},this)},this),this.on("change",e),null)}},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.radio.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setValue:function(t,e){for(var n,i=this._.children,r=0;r<i.length&&(n=i[r]);r++)n.getElement().$.checked=n.getValue()==t;return!e&&this.fire("change",{value:t}),this},getValue:function(){for(var t=this._.children,e=0;e<t.length;e++)if(t[e].getElement().$.checked)return t[e].getValue();return null},accessKeyUp:function(){var t,e=this._.children;for(t=0;t<e.length;t++)if(e[t].getElement().$.checked)return void e[t].getElement().focus();e[0].getElement().focus()},eventProcessors:{onChange:function(t,e){return!CKEDITOR.env.ie||8<CKEDITOR.env.version?r.onChange.apply(this,arguments):(t.on("load",function(){for(var t=this._.children,e=this,n=0;n<t.length;n++)t[n].getElement().on("propertychange",function(t){"checked"==(t=t.data.$).propertyName&&this.$.checked&&e.fire("change",{value:this.getAttribute("value")})})},this),this.on("change",e),null)}}},i,!0),CKEDITOR.ui.dialog.file.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,i,{getInputElement:function(){var t=CKEDITOR.document.getById(this._.frameId).getFrameDocument();return 0<t.$.forms.length?new CKEDITOR.dom.element(t.$.forms[0].elements[0]):this.getElement()},submit:function(){return this.getInputElement().getParent().$.submit(),this},getAction:function(){return this.getInputElement().getParent().$.action},registerEvents:function(t){var e,n,i=/^on([A-Z]\w+)/,r=function(t,e,n,i){t.on("formLoaded",function(){t.getInputElement().on(n,i,t)})};for(n in t)(e=n.match(i))&&(this.eventProcessors[n]?this.eventProcessors[n].call(this,this._.dialog,t[n]):r(this,this._.dialog,e[1].toLowerCase(),t[n]));return this},reset:function(){function t(){n.$.open();var t="";i.size&&(t=i.size-(CKEDITOR.env.ie?7:0));var c=e.frameId+"_input";for(n.$.write(['<html dir="'+a+'" lang="'+l+'"><head><title></title></head><body style="margin: 0; overflow: hidden; background: transparent;">','<form enctype="multipart/form-data" method="POST" dir="'+a+'" lang="'+l+'" action="',CKEDITOR.tools.htmlEncode(i.action),'"><label id="',e.labelId,'" for="',c,'" style="display:none">',CKEDITOR.tools.htmlEncode(i.label),'</label><input style="width:100%" id="',c,'" aria-labelledby="',e.labelId,'" type="file" name="',CKEDITOR.tools.htmlEncode(i.id||"cke_upload"),'" size="',CKEDITOR.tools.htmlEncode(0<t?t:""),'" /></form></body></html><script>',CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"","window.parent.CKEDITOR.tools.callFunction("+o+");","window.onbeforeunload = function() {window.parent.CKEDITOR.tools.callFunction("+s+")}","<\/script>"].join("")),n.$.close(),t=0;t<r.length;t++)r[t].enable()}var e=this._,n=CKEDITOR.document.getById(e.frameId).getFrameDocument(),i=e.definition,r=e.buttons,o=this.formLoadedNumber,s=this.formUnloadNumber,a=e.dialog._.editor.lang.dir,l=e.dialog._.editor.langCode;o||(o=this.formLoadedNumber=CKEDITOR.tools.addFunction(function(){this.fire("formLoaded")},this),s=this.formUnloadNumber=CKEDITOR.tools.addFunction(function(){this.getInputElement().clearCustomData()},this),this.getDialog()._.editor.on("destroy",function(){CKEDITOR.tools.removeFunction(o),CKEDITOR.tools.removeFunction(s)})),CKEDITOR.env.gecko?setTimeout(t,500):t()},getValue:function(){return this.getInputElement().$.value||""},setInitValue:function(){this._.initValue=""},eventProcessors:{onChange:function(t,e){this._.domOnChangeRegistered||(this.on("formLoaded",function(){this.getInputElement().on("change",function(){this.fire("change",{value:this.getValue()})},this)},this),this._.domOnChangeRegistered=!0),this.on("change",e)}},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.fileButton.prototype=new CKEDITOR.ui.dialog.button,CKEDITOR.ui.dialog.fieldset.prototype=CKEDITOR.tools.clone(CKEDITOR.ui.dialog.hbox.prototype),CKEDITOR.dialog.addUIElement("text",e),CKEDITOR.dialog.addUIElement("password",e),CKEDITOR.dialog.addUIElement("tel",e),CKEDITOR.dialog.addUIElement("textarea",n),CKEDITOR.dialog.addUIElement("checkbox",n),CKEDITOR.dialog.addUIElement("radio",n),CKEDITOR.dialog.addUIElement("button",n),CKEDITOR.dialog.addUIElement("select",n),CKEDITOR.dialog.addUIElement("file",n),CKEDITOR.dialog.addUIElement("fileButton",n),CKEDITOR.dialog.addUIElement("html",n),CKEDITOR.dialog.addUIElement("fieldset",{build:function(t,e,n){for(var i,r=e.children,o=[],s=[],a=0;a<r.length&&(i=r[a]);a++){var l=[];o.push(l),s.push(CKEDITOR.dialog._.uiElementBuilders[i.type].build(t,i,l))}return new CKEDITOR.ui.dialog[e.type](t,s,o,n,e)}})}}),CKEDITOR.DIALOG_RESIZE_NONE=0,CKEDITOR.DIALOG_RESIZE_WIDTH=1,CKEDITOR.DIALOG_RESIZE_HEIGHT=2,CKEDITOR.DIALOG_RESIZE_BOTH=3,CKEDITOR.DIALOG_STATE_IDLE=1,CKEDITOR.DIALOG_STATE_BUSY=2,function(){function t(t){t._.tabBarMode=!0,t._.tabs[t._.currentTabId][0].focus(),t._.currentFocusIndex=-1}function e(){for(var t=this._.tabIdList.length,e=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId)+t,n=e-1;n>e-t;n--)if(this._.tabs[this._.tabIdList[n%t]][0].$.offsetHeight)return this._.tabIdList[n%t];return null}function n(){for(var t=this._.tabIdList.length,e=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId),n=e+1;n<e+t;n++)if(this._.tabs[this._.tabIdList[n%t]][0].$.offsetHeight)return this._.tabIdList[n%t];return null}function i(t,e){for(var n=t.$.getElementsByTagName("input"),i=0,r=n.length;i<r;i++){var o=new CKEDITOR.dom.element(n[i]);"text"==o.getAttribute("type").toLowerCase()&&(e?(o.setAttribute("value",o.getCustomData("fake_value")||""),o.removeCustomData("fake_value")):(o.setCustomData("fake_value",o.getAttribute("value")),o.setAttribute("value","")))}}function r(t,e){var n=this.getInputElement();n&&(t?n.removeAttribute("aria-invalid"):n.setAttribute("aria-invalid",!0)),t||(this.select?this.select():this.focus()),e&&alert(e),this.fire("validated",{valid:t,msg:e})}function o(){var t=this.getInputElement();t&&t.removeAttribute("aria-invalid")}function s(t,e,n){this.element=e,this.focusIndex=n,this.tabIndex=0,this.isFocusable=function(){return!e.getAttribute("disabled")&&e.isVisible()},this.focus=function(){t._.currentFocusIndex=this.focusIndex,this.element.focus()},e.on("keydown",function(t){t.data.getKeystroke()in{32:1,13:1}&&this.fire("click")}),e.on("focus",function(){this.fire("mouseover")}),e.on("blur",function(){this.fire("mouseout")})}function a(t,e){this.dialog=t;for(var n,i=e.contents,r=0;n=i[r];r++)i[r]=n&&new l(t,n);CKEDITOR.tools.extend(this,e)}function l(t,e){this._={dialog:t},CKEDITOR.tools.extend(this,e)}function c(t){function e(e){var n=t.getSize(),l=t.parts.dialog.getParent().getClientSize(),c=e.data.$.screenX,u=e.data.$.screenY,h=c-i.x,d=u-i.y;i={x:c,y:u},r.x+=h,r.y+=d,c=r.x+a[3]<s?-a[3]:r.x-a[1]>l.width-n.width-s?l.width-n.width+("rtl"==o.lang.dir?0:a[1]):r.x,n=r.y+a[0]<s?-a[0]:r.y-a[2]>l.height-n.height-s?l.height-n.height+a[2]:r.y,c=Math.floor(c),n=Math.floor(n),t.move(c,n,1),e.data.preventDefault()}function n(){if(CKEDITOR.document.removeListener("mousemove",e),CKEDITOR.document.removeListener("mouseup",n),CKEDITOR.env.ie6Compat){var t=I.getChild(0).getFrameDocument();t.removeListener("mousemove",e),t.removeListener("mouseup",n)}}var i=null,r=null,o=t.getParentEditor(),s=o.config.dialog_magnetDistance,a=CKEDITOR.skin.margins||[0,0,0,0];void 0===s&&(s=20),t.parts.title.on("mousedown",function(o){if(!t._.moved){var s=t._.element;s.getFirst().setStyle("position","absolute"),s.removeStyle("display"),t._.moved=!0,t.layout()}i={x:o.data.$.screenX,y:o.data.$.screenY},CKEDITOR.document.on("mousemove",e),CKEDITOR.document.on("mouseup",n),r=t.getPosition(),CKEDITOR.env.ie6Compat&&((s=I.getChild(0).getFrameDocument()).on("mousemove",e),s.on("mouseup",n)),o.data.preventDefault()},t)}function u(t){function e(e){var n="rtl"==d.lang.dir,u=c.width,f=c.height,p=u+(e.data.$.screenX-l.x)*(n?-1:1)*(t._.moved?1:2),g=f+(e.data.$.screenY-l.y)*(t._.moved?1:2),m=t._.element.getFirst(),v=(m=n&&parseInt(m.getComputedStyle("right"),10),t.getPosition());v.x=v.x||0,v.y=v.y||0,v.y+g>a.height&&(g=a.height-v.y),(n?m:v.x)+p>a.width&&(p=a.width-(n?m:v.x)),g=Math.floor(g),p=Math.floor(p),r!=CKEDITOR.DIALOG_RESIZE_WIDTH&&r!=CKEDITOR.DIALOG_RESIZE_BOTH||(u=Math.max(i.minWidth||0,p-o)),r!=CKEDITOR.DIALOG_RESIZE_HEIGHT&&r!=CKEDITOR.DIALOG_RESIZE_BOTH||(f=Math.max(i.minHeight||0,g-s)),t.resize(u,f),t._.moved&&h(t,t._.position.x,t._.position.y),t._.moved||t.layout(),e.data.preventDefault()}function n(){if(CKEDITOR.document.removeListener("mouseup",n),CKEDITOR.document.removeListener("mousemove",e),u&&(u.remove(),u=null),CKEDITOR.env.ie6Compat){var t=I.getChild(0).getFrameDocument();t.removeListener("mouseup",n),t.removeListener("mousemove",e)}}var i=t.definition,r=i.resizable;if(r!=CKEDITOR.DIALOG_RESIZE_NONE){var o,s,a,l,c,u,d=t.getParentEditor(),f=CKEDITOR.tools.addFunction(function(i){function r(t){return t.isVisible()}c=t.getSize();var h=t.parts.contents,d=h.$.getElementsByTagName("iframe").length,f=!(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.quirks);d&&(u=CKEDITOR.dom.element.createFromHtml('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%; left:0; top:0;"></div>'),h.append(u)),s=c.height-t.parts.contents.getFirst(r).getSize("height",f),o=c.width-t.parts.contents.getFirst(r).getSize("width",1),l={x:i.screenX,y:i.screenY},a=CKEDITOR.document.getWindow().getViewPaneSize(),CKEDITOR.document.on("mousemove",e),CKEDITOR.document.on("mouseup",n),CKEDITOR.env.ie6Compat&&((h=I.getChild(0).getFrameDocument()).on("mousemove",e),h.on("mouseup",n)),i.preventDefault&&i.preventDefault()});t.on("load",function(){var e="";r==CKEDITOR.DIALOG_RESIZE_WIDTH?e=" cke_resizer_horizontal":r==CKEDITOR.DIALOG_RESIZE_HEIGHT&&(e=" cke_resizer_vertical"),e=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+e+" cke_resizer_"+d.lang.dir+'" title="'+CKEDITOR.tools.htmlEncode(d.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+f+', event )">'+("ltr"==d.lang.dir?"\u25e2":"\u25e3")+"</div>"),t.parts.footer.append(e,1)}),d.on("destroy",function(){CKEDITOR.tools.removeFunction(f)})}}function h(t,e,n){var i=t.parts.dialog.getParent().getClientSize(),r=t.getSize(),o=t._.viewportRatio,s=Math.max(i.width-r.width,0);i=Math.max(i.height-r.height,0);o.width=s?e/s:o.width,o.height=i?n/i:o.height,t._.viewportRatio=o}function d(t){t.data.preventDefault(1)}function f(t){var e=t.config,n=CKEDITOR.skinName||t.config.skin,i=e.dialog_backgroundCoverColor||("moono-lisa"==n?"black":"white"),r=(n=e.dialog_backgroundCoverOpacity,e.baseFloatZIndex),o=(e=CKEDITOR.tools.genKey(i,n,r),O[e]);CKEDITOR.document.getBody().addClass("cke_dialog_open"),o?o.show():(r=['<div tabIndex="-1" style="position: ',CKEDITOR.env.ie6Compat?"absolute":"fixed","; z-index: ",r,"; top: 0px; left: 0px; ","; width: 100%; height: 100%;",CKEDITOR.env.ie6Compat?"":"background-color: "+i,'" class="cke_dialog_background_cover">'],CKEDITOR.env.ie6Compat&&(i="<html><body style=\\'background-color:"+i+";\\'></body></html>",r.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:'),r.push("void((function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.write( '"+i+"' );document.close();")+"})())"),r.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;filter: progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>')),r.push("</div>"),(o=CKEDITOR.dom.element.createFromHtml(r.join(""))).setOpacity(void 0!==n?n:.5),o.on("keydown",d),o.on("keypress",d),o.on("keyup",d),o.appendTo(CKEDITOR.document.getBody()),O[e]=o),t.focusManager.add(o),I=o,CKEDITOR.env.mac&&CKEDITOR.env.webkit||o.focus()}function p(t){CKEDITOR.document.getBody().removeClass("cke_dialog_open"),I&&(t.focusManager.remove(I),I.hide())}function g(t){var e=t.data.$.ctrlKey||t.data.$.metaKey,n=t.data.$.altKey,i=t.data.$.shiftKey,r=String.fromCharCode(t.data.$.keyCode);(e=S[(e?"CTRL+":"")+(n?"ALT+":"")+(i?"SHIFT+":"")+r])&&e.length&&((e=e[e.length-1]).keydown&&e.keydown.call(e.uiElement,e.dialog,e.key),t.data.preventDefault())}function m(t){var e=t.data.$.ctrlKey||t.data.$.metaKey,n=t.data.$.altKey,i=t.data.$.shiftKey,r=String.fromCharCode(t.data.$.keyCode);(e=S[(e?"CTRL+":"")+(n?"ALT+":"")+(i?"SHIFT+":"")+r])&&e.length&&((e=e[e.length-1]).keyup&&(e.keyup.call(e.uiElement,e.dialog,e.key),t.data.preventDefault()))}function v(t,e,n,i,r){(S[n]||(S[n]=[])).push({uiElement:t,dialog:e,key:n,keyup:r||t.accessKeyUp,keydown:i||t.accessKeyDown})}function y(t,e){t._.accessKeyMap[e]&&t.selectPage(t._.accessKeyMap[e])}function b(){}var C,I,E=CKEDITOR.tools.cssLength,T=!1,w=!CKEDITOR.env.ie||CKEDITOR.env.edge,x='<div class="cke_reset_all cke_dialog_container {editorId} {editorDialogClass} {hidpi}" dir="{langDir}" style="'+(w?"display:flex":"")+'" lang="{langCode}" role="dialog" aria-labelledby="cke_dialog_title_{id}"><table class="cke_dialog '+CKEDITOR.env.cssClass+' cke_{langDir}" style="'+(w?"margin:auto":"position:absolute")+'" role="presentation"><tr><td role="presentation"><div class="cke_dialog_body" role="presentation"><div id="cke_dialog_title_{id}" class="cke_dialog_title" role="presentation"></div><a id="cke_dialog_close_button_{id}" class="cke_dialog_close_button" href="javascript:void(0)" title="{closeTitle}" role="button"><span class="cke_label">X</span></a><div id="cke_dialog_tabs_{id}" class="cke_dialog_tabs" role="tablist"></div><table class="cke_dialog_contents" role="presentation"><tr><td id="cke_dialog_contents_{id}" class="cke_dialog_contents_body" role="presentation"></td></tr><tr><td id="cke_dialog_footer_{id}" class="cke_dialog_footer" role="presentation"></td></tr></table></div></td></tr></table></div>';CKEDITOR.dialog=function(i,s){function l(t){var e=E._.focusList;if(t=t||0,!(1>e.length)){var n=E._.currentFocusIndex;E._.tabBarMode&&0>t&&(n=0);try{e[n].getInputElement().$.blur()}catch(o){}var i=n,r=1<E._.pageCount;do{if(i+=t,r&&!E._.tabBarMode&&(i==e.length||-1==i))return E._.tabBarMode=!0,E._.tabs[E._.currentTabId][0].focus(),void(E._.currentFocusIndex=-1);if((i=(i+e.length)%e.length)==n)break}while(t&&!e[i].isFocusable());e[i].focus(),"text"==e[i].type&&e[i].select()}}function h(r){if(E==CKEDITOR.dialog._.currentTop){var o=r.data.getKeystroke(),s="rtl"==i.lang.dir;if(f=p=0,9==o||o==CKEDITOR.SHIFT+9)l(o==CKEDITOR.SHIFT+9?-1:1),f=1;else if(o==CKEDITOR.ALT+121&&!E._.tabBarMode&&1<E.getPageCount())t(E),f=1;else if(-1!=CKEDITOR.tools.indexOf([37,38,39,40],o)&&E._.tabBarMode)o=-1!=CKEDITOR.tools.indexOf([s?39:37,38],o)?e.call(E):n.call(E),E.selectPage(o),E._.tabs[o][0].focus(),f=1;else if(13!=o&&32!=o||!E._.tabBarMode)if(13==o)(o=r.data.getTarget()).is("a","button","select","textarea")||o.is("input")&&"button"==o.$.type||((o=this.getButton("ok"))&&CKEDITOR.tools.setTimeout(o.click,0,o),f=1),p=1;else{if(27!=o)return;(o=this.getButton("cancel"))?CKEDITOR.tools.setTimeout(o.click,0,o):!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),p=1}else this.selectPage(this._.currentTabId),this._.tabBarMode=!1,this._.currentFocusIndex=-1,l(1),f=1;d(r)}}function d(t){f?t.data.preventDefault(1):p&&t.data.stopPropagation()}var f,p,g=CKEDITOR.dialog._.dialogDefinitions[s],m=CKEDITOR.tools.clone(C),v=i.config.dialog_buttonsOrder||"OS",y=i.lang.dir,b={};if(("OS"==v&&CKEDITOR.env.mac||"rtl"==v&&"ltr"==y||"ltr"==v&&"rtl"==y)&&m.buttons.reverse(),g=CKEDITOR.tools.extend(g(i),m),g=new a(this,g=CKEDITOR.tools.clone(g)),m=function(t){var e=CKEDITOR.dom.element.createFromHtml(CKEDITOR.addTemplate("dialog",x).output({id:CKEDITOR.tools.getNextNumber(),editorId:t.id,langDir:t.lang.dir,langCode:t.langCode,editorDialogClass:"cke_editor_"+t.name.replace(/\./g,"\\.")+"_dialog",closeTitle:t.lang.common.close,hidpi:CKEDITOR.env.hidpi?"cke_hidpi":""})),n=e.getChild([0,0,0,0,0]),i=n.getChild(0),r=n.getChild(1);return t.plugins.clipboard&&CKEDITOR.plugins.clipboard.preventDefaultDropOnElement(n),!CKEDITOR.env.ie||CKEDITOR.env.quirks||CKEDITOR.env.edge||(t="javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())",CKEDITOR.dom.element.createFromHtml('<iframe frameBorder="0" class="cke_iframe_shim" src="'+t+'" tabIndex="-1"></iframe>').appendTo(n.getParent())),i.unselectable(),r.unselectable(),{element:e,parts:{dialog:e.getChild(0),title:i,close:r,tabs:n.getChild(2),contents:n.getChild([3,0,0,0]),footer:n.getChild([3,0,1,0])}}}(i),this._={editor:i,element:m.element,name:s,model:null,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},viewportRatio:{width:.5,height:.5},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:!1,focusList:[],currentFocusIndex:0,hasFocus:!1},this.parts=m.parts,CKEDITOR.tools.setTimeout(function(){i.fire("ariaWidget",this.parts.contents)},0,this),m={top:0,visibility:"hidden"},CKEDITOR.env.ie6Compat&&(m.position="absolute"),m["rtl"==y?"right":"left"]=0,this.parts.dialog.setStyles(m),CKEDITOR.event.call(this),this.definition=g=CKEDITOR.fire("dialogDefinition",{name:s,definition:g,dialog:this},i).definition,!("removeDialogTabs"in i._)&&i.config.removeDialogTabs){for(m=i.config.removeDialogTabs.split(";"),y=0;y<m.length;y++)if(2==(v=m[y].split(":")).length){var I=v[0];b[I]||(b[I]=[]),b[I].push(v[1])}i._.removeDialogTabs=b}if(i._.removeDialogTabs&&(b=i._.removeDialogTabs[s]))for(y=0;y<b.length;y++)g.removeContents(b[y]);g.onLoad&&this.on("load",g.onLoad),g.onShow&&this.on("show",g.onShow),g.onHide&&this.on("hide",g.onHide),g.onOk&&this.on("ok",function(t){i.fire("saveSnapshot"),setTimeout(function(){i.fire("saveSnapshot")},0),!1===g.onOk.call(this,t)&&(t.data.hide=!1)}),this.state=CKEDITOR.DIALOG_STATE_IDLE,g.onCancel&&this.on("cancel",function(t){!1===g.onCancel.call(this,t)&&(t.data.hide=!1)});var E=this,T=function(t){var e,n=E._.contents;for(e in n)for(var i in n[e])if(t.call(this,n[e][i]))return};this.on("ok",function(t){T(function(e){if(e.validate){var n=e.validate(this),i="string"==typeof n||!1===n;return i&&(t.data.hide=!1,t.stop()),r.call(e,!i,"string"==typeof n?n:void 0),i}})},this,null,0),this.on("cancel",function(t){T(function(e){if(e.isChanged())return i.config.dialog_noConfirmCancel||confirm(i.lang.common.confirmCancel)||(t.data.hide=!1),!0})},this,null,0),this.parts.close.on("click",function(t){!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),t.data.preventDefault()},this),this.changeFocus=l;var w=this._.element;for(i.focusManager.add(w,1),this.on("show",function(){w.on("keydown",h,this),CKEDITOR.env.gecko&&w.on("keypress",d,this)}),this.on("hide",function(){w.removeListener("keydown",h),CKEDITOR.env.gecko&&w.removeListener("keypress",d),T(function(t){o.apply(t)})}),this.on("iframeAdded",function(t){new CKEDITOR.dom.document(t.data.iframe.$.contentWindow.document).on("keydown",h,this,null,0)}),this.on("show",function(){!function(){var t=E._.focusList;t.sort(function(t,e){return t.tabIndex!=e.tabIndex?e.tabIndex-t.tabIndex:t.focusIndex-e.focusIndex});for(var e=t.length,n=0;n<e;n++)t[n].focusIndex=n}();var t=1<E._.pageCount;i.config.dialog_startupFocusTab&&t?(E._.tabBarMode=!0,E._.tabs[E._.currentTabId][0].focus(),E._.currentFocusIndex=-1):this._.hasFocus||(this._.currentFocusIndex=t?-1:this._.focusList.length-1,g.onFocus?(t=g.onFocus.call(this))&&t.focus():l(1))},this,null,4294967295),CKEDITOR.env.ie6Compat&&this.on("load",function(){var t=this.getElement(),e=t.getFirst();e.remove(),e.appendTo(t)},this),c(this),u(this),new CKEDITOR.dom.text(g.title,CKEDITOR.document).appendTo(this.parts.title),y=0;y<g.contents.length;y++)(b=g.contents[y])&&this.addPage(b);for(this.parts.tabs.on("click",function(e){var n=e.data.getTarget();n.hasClass("cke_dialog_tab")&&(n=n.$.id,this.selectPage(n.substring(4,n.lastIndexOf("_"))),t(this),e.data.preventDefault())},this),y=[],b=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:"hbox",className:"cke_dialog_footer_buttons",widths:[],children:g.buttons},y).getChild(),this.parts.footer.setHtml(y.join("")),y=0;y<b.length;y++)this._.buttons[b[y].id]=b[y]},CKEDITOR.dialog.prototype={destroy:function(){this.hide(),this._.element.remove()},resize:function(t,e){if(!this._.contentSize||this._.contentSize.width!=t||this._.contentSize.height!=e){if(CKEDITOR.dialog.fire("resize",{dialog:this,width:t,height:e},this._.editor),this.fire("resize",{width:t,height:e},this._.editor),this.parts.contents.setStyles({width:t+"px",height:e+"px"}),"rtl"==this._.editor.lang.dir&&this._.position){var n=this.parts.dialog.getParent().getClientSize().width;this._.position.x=n-this._.contentSize.width-parseInt(this._.element.getFirst().getStyle("right"),10)}this._.contentSize={width:t,height:e}}},getSize:function(){var t=this._.element.getFirst();return{width:t.$.offsetWidth||0,height:t.$.offsetHeight||0}},move:function(t,e,n){var i=this._.element.getFirst(),r="rtl"==this._.editor.lang.dir;CKEDITOR.env.ie&&i.setStyle("zoom","100%");var o=this.parts.dialog.getParent().getClientSize(),s=this.getSize(),a=this._.viewportRatio,l=Math.max(o.width-s.width,0);o=Math.max(o.height-s.height,0);this._.position&&this._.position.x==t&&this._.position.y==e?(t=Math.floor(l*a.width),e=Math.floor(o*a.height)):h(this,t,e),this._.position={x:t,y:e},r&&(t=l-t),(e={top:(0<e?e:0)+"px"})[r?"right":"left"]=(0<t?t:0)+"px",i.setStyles(e),n&&(this._.moved=1)},getPosition:function(){return CKEDITOR.tools.extend({},this._.position)},show:function(){var t=this._.element,e=this.definition,n=CKEDITOR.document.getBody(),i=this._.editor.config.baseFloatZIndex;for(var r in t.getParent()&&t.getParent().equals(n)?t.setStyle("display",w?"flex":"block"):t.appendTo(n),this.resize(this._.contentSize&&this._.contentSize.width||e.width||e.minWidth,this._.contentSize&&this._.contentSize.height||e.height||e.minHeight),this.reset(),null===this._.currentTabId&&this.selectPage(this.definition.contents[0].id),null===CKEDITOR.dialog._.currentZIndex&&(CKEDITOR.dialog._.currentZIndex=i),this._.element.getFirst().setStyle("z-index",CKEDITOR.dialog._.currentZIndex+=10),this.getElement().setStyle("z-index",CKEDITOR.dialog._.currentZIndex),null===CKEDITOR.dialog._.currentTop?(CKEDITOR.dialog._.currentTop=this,this._.parentDialog=null,f(this._.editor)):CKEDITOR.dialog._.currentTop!==this&&(this._.parentDialog=CKEDITOR.dialog._.currentTop,(n=this._.parentDialog.getElement().getFirst()).$.style.zIndex-=Math.floor(i/2),this._.parentDialog.getElement().setStyle("z-index",n.$.style.zIndex),CKEDITOR.dialog._.currentTop=this),t.on("keydown",g),t.on("keyup",m),this._.hasFocus=!1,e.contents)if(e.contents[r]){t=e.contents[r],i=this._.tabs[t.id],n=t.requiredContent;var o=0;if(i){for(var s in this._.contents[t.id]){var a=this._.contents[t.id][s];"hbox"!=a.type&&"vbox"!=a.type&&a.getInputElement()&&(a.requiredContent&&!this._.editor.activeFilter.check(a.requiredContent)?a.disable():(a.enable(),o++))}!o||n&&!this._.editor.activeFilter.check(n)?i[0].addClass("cke_dialog_tab_disabled"):i[0].removeClass("cke_dialog_tab_disabled")}}CKEDITOR.tools.setTimeout(function(){this.layout(),function(t){function e(){t.layout()}var n=CKEDITOR.document.getWindow();n.on("resize",e),t.on("hide",function(){n.removeListener("resize",e)})}(this),this.parts.dialog.setStyle("visibility",""),this.fireOnce("load",{}),CKEDITOR.ui.fire("ready",this),this.fire("show",{}),this._.editor.fire("dialogShow",this),this._.parentDialog||this._.editor.focusManager.lock(),this.foreach(function(t){t.setInitValue&&t.setInitValue()})},100,this)},layout:function(){var t=this.parts.dialog;if(this._.moved||!w){var e,n=this.getSize(),i=CKEDITOR.document.getWindow().getViewPaneSize();this._.moved&&this._.position?(e=this._.position.x,n=this._.position.y):(e=(i.width-n.width)/2,n=(i.height-n.height)/2),CKEDITOR.env.ie6Compat||(t.setStyle("position","absolute"),t.removeStyle("margin")),e=Math.floor(e),n=Math.floor(n),this.move(e,n)}},foreach:function(t){for(var e in this._.contents)for(var n in this._.contents[e])t.call(this,this._.contents[e][n]);return this},reset:function(){var t=function(t){t.reset&&t.reset(1)};return function(){return this.foreach(t),this}}(),setupContent:function(){var t=arguments;this.foreach(function(e){e.setup&&e.setup.apply(e,t)})},commitContent:function(){var t=arguments;this.foreach(function(e){CKEDITOR.env.ie&&this._.currentFocusIndex==e.focusIndex&&e.getInputElement().$.blur(),e.commit&&e.commit.apply(e,t)})},hide:function(){if(this.parts.dialog.isVisible()){this.fire("hide",{}),this._.editor.fire("dialogHide",this),this.selectPage(this._.tabIdList[0]);var t=this._.element;for(t.setStyle("display","none"),this.parts.dialog.setStyle("visibility","hidden"),function(t){for(var e in S){for(var n=S[e],i=n.length-1;0<=i;i--)n[i].dialog!=t&&n[i].uiElement!=t||n.splice(i,1);0===n.length&&delete S[e]}}(this);CKEDITOR.dialog._.currentTop!=this;)CKEDITOR.dialog._.currentTop.hide();if(this._.parentDialog){var e=this._.parentDialog.getElement().getFirst();this._.parentDialog.getElement().removeStyle("z-index"),e.setStyle("z-index",parseInt(e.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2))}else p(this._.editor);if(CKEDITOR.dialog._.currentTop=this._.parentDialog)CKEDITOR.dialog._.currentZIndex-=10;else{CKEDITOR.dialog._.currentZIndex=null,t.removeListener("keydown",g),t.removeListener("keyup",m);var n=this._.editor;n.focus(),setTimeout(function(){n.focusManager.unlock(),CKEDITOR.env.iOS&&n.window.focus()},0)}delete this._.parentDialog,this.foreach(function(t){t.resetInitValue&&t.resetInitValue()}),this.setState(CKEDITOR.DIALOG_STATE_IDLE)}},addPage:function(t){if(!t.requiredContent||this._.editor.filter.check(t.requiredContent)){for(var e=[],n=t.label?' title="'+CKEDITOR.tools.htmlEncode(t.label)+'"':"",i=CKEDITOR.dialog._.uiElementBuilders.vbox.build(this,{type:"vbox",className:"cke_dialog_page_contents",children:t.elements,expand:!!t.expand,padding:t.padding,style:t.style||"width: 100%;"},e),r=this._.contents[t.id]={},o=i.getChild(),s=0;i=o.shift();)i.notAllowed||"hbox"==i.type||"vbox"==i.type||s++,r[i.id]=i,"function"==typeof i.getChild&&o.push.apply(o,i.getChild());s||(t.hidden=!0),(e=CKEDITOR.dom.element.createFromHtml(e.join(""))).setAttribute("role","tabpanel"),e.setStyle("min-height","100%"),i=CKEDITOR.env,r="cke_"+t.id+"_"+CKEDITOR.tools.getNextNumber(),n=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',0<this._.pageCount?" cke_last":"cke_first",n,t.hidden?' style="display:none"':"",' id="',r,'"',i.gecko&&!i.hc?"":' href="javascript:void(0)"',' tabIndex="-1" hidefocus="true" role="tab">',t.label,"</a>"].join("")),e.setAttribute("aria-labelledby",r),this._.tabs[t.id]=[n,e],this._.tabIdList.push(t.id),!t.hidden&&this._.pageCount++,this._.lastTab=n,this.updateStyle(),e.setAttribute("name",t.id),e.appendTo(this.parts.contents),n.unselectable(),this.parts.tabs.append(n),t.accessKey&&(v(this,this,"CTRL+"+t.accessKey,b,y),this._.accessKeyMap["CTRL+"+t.accessKey]=t.id)}},selectPage:function(t){if(this._.currentTabId!=t&&!this._.tabs[t][0].hasClass("cke_dialog_tab_disabled")&&!1!==this.fire("selectPage",{page:t,currentPage:this._.currentTabId})){for(var e in this._.tabs){var n=this._.tabs[e][0],r=this._.tabs[e][1];e!=t&&(n.removeClass("cke_dialog_tab_selected"),n.removeAttribute("aria-selected"),r.hide()),r.setAttribute("aria-hidden",e!=t)}var o=this._.tabs[t];o[0].addClass("cke_dialog_tab_selected"),o[0].setAttribute("aria-selected",!0),CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat?(i(o[1]),o[1].show(),setTimeout(function(){i(o[1],1)},0)):o[1].show(),this._.currentTabId=t,this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,t)}},updateStyle:function(){this.parts.dialog[(1===this._.pageCount?"add":"remove")+"Class"]("cke_single_page")},hidePage:function(t){var n=this._.tabs[t]&&this._.tabs[t][0];n&&1!=this._.pageCount&&n.isVisible()&&(t==this._.currentTabId&&this.selectPage(e.call(this)),n.hide(),this._.pageCount--,this.updateStyle())},showPage:function(t){(t=this._.tabs[t]&&this._.tabs[t][0])&&(t.show(),this._.pageCount++,this.updateStyle())},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(t,e){var n=this._.contents[t];return n&&n[e]},getValueOf:function(t,e){return this.getContentElement(t,e).getValue()},setValueOf:function(t,e,n){return this.getContentElement(t,e).setValue(n)},getButton:function(t){return this._.buttons[t]},click:function(t){return this._.buttons[t].click()},disableButton:function(t){return this._.buttons[t].disable()},enableButton:function(t){return this._.buttons[t].enable()},getPageCount:function(){return this._.pageCount},getParentEditor:function(){return this._.editor},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement()},addFocusable:function(t,e){if(void 0===e)e=this._.focusList.length,this._.focusList.push(new s(this,t,e));else{this._.focusList.splice(e,0,new s(this,t,e));for(var n=e+1;n<this._.focusList.length;n++)this._.focusList[n].focusIndex++}},setState:function(t){if(this.state!=t){if(this.state=t,t==CKEDITOR.DIALOG_STATE_BUSY){if(!this.parts.spinner){var e=this.getParentEditor().lang.dir,n={attributes:{class:"cke_dialog_spinner"},styles:{float:"rtl"==e?"right":"left"}};n.styles["margin-"+("rtl"==e?"left":"right")]="8px",this.parts.spinner=CKEDITOR.document.createElement("div",n),this.parts.spinner.setHtml("&#8987;"),this.parts.spinner.appendTo(this.parts.title,1)}this.parts.spinner.show(),this.getButton("ok")&&this.getButton("ok").disable()}else t==CKEDITOR.DIALOG_STATE_IDLE&&(this.parts.spinner&&this.parts.spinner.hide(),this.getButton("ok")&&this.getButton("ok").enable());this.fire("state",t)}},getModel:function(t){return this._.model?this._.model:this.definition.getModel?this.definition.getModel(t):null},setModel:function(t){this._.model=t},getMode:function(t){return this.definition.getMode?this.definition.getMode(t):!(t=this.getModel(t))||t instanceof CKEDITOR.dom.element&&!t.getParent()?CKEDITOR.dialog.CREATION_MODE:CKEDITOR.dialog.EDITING_MODE}},CKEDITOR.tools.extend(CKEDITOR.dialog,{CREATION_MODE:0,EDITING_MODE:1,add:function(t,e){this._.dialogDefinitions[t]&&"function"!=typeof e||(this._.dialogDefinitions[t]=e)},exists:function(t){return!!this._.dialogDefinitions[t]},getCurrent:function(){return CKEDITOR.dialog._.currentTop},isTabEnabled:function(t,e,n){return!((t=t.config.removeDialogTabs)&&t.match(new RegExp("(?:^|;)"+e+":"+n+"(?:$|;)","i")))},okButton:function(){var t=function(t,e){return e=e||{},CKEDITOR.tools.extend({id:"ok",type:"button",label:t.lang.common.ok,class:"cke_dialog_ui_button_ok",onClick:function(t){!1!==(t=t.data.dialog).fire("ok",{hide:!0}).hide&&t.hide()}},e,!0)};return t.type="button",t.override=function(e){return CKEDITOR.tools.extend(function(n){return t(n,e)},{type:"button"},!0)},t}(),cancelButton:function(){var t=function(t,e){return e=e||{},CKEDITOR.tools.extend({id:"cancel",type:"button",label:t.lang.common.cancel,class:"cke_dialog_ui_button_cancel",onClick:function(t){!1!==(t=t.data.dialog).fire("cancel",{hide:!0}).hide&&t.hide()}},e,!0)};return t.type="button",t.override=function(e){return CKEDITOR.tools.extend(function(n){return t(n,e)},{type:"button"},!0)},t}(),addUIElement:function(t,e){this._.uiElementBuilders[t]=e}}),CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null},CKEDITOR.event.implementOn(CKEDITOR.dialog),CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype),C={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]};var _=function(t,e,n){for(var i,r=0;i=t[r];r++)if(i.id==e||n&&i[n]&&(i=_(i[n],e,n)))return i;return null},D=function(t,e,n,i,r){if(n){for(var o,s=0;o=t[s];s++){if(o.id==n)return t.splice(s,0,e),e;if(i&&o[i]&&(o=D(o[i],e,n,i,!0)))return o}if(r)return null}return t.push(e),e},A=function(t,e,n){for(var i,r=0;i=t[r];r++){if(i.id==e)return t.splice(r,1);if(n&&i[n]&&(i=A(i[n],e,n)))return i}return null};a.prototype={getContents:function(t){return _(this.contents,t)},getButton:function(t){return _(this.buttons,t)},addContents:function(t,e){return D(this.contents,t,e)},addButton:function(t,e){return D(this.buttons,t,e)},removeContents:function(t){A(this.contents,t)},removeButton:function(t){A(this.buttons,t)}},l.prototype={get:function(t){return _(this.elements,t,"children")},add:function(t,e){return D(this.elements,t,e,"children")},remove:function(t){A(this.elements,t,"children")}};var O={},S={};CKEDITOR.ui.dialog={uiElement:function(t,e,n,i,r,o,s){if(!(4>arguments.length)){var a=(i.call?i(e):i)||"div",l=["<",a," "],c=(r&&r.call?r(e):r)||{},u=(o&&o.call?o(e):o)||{},h=(s&&s.call?s.call(this,t,e):s)||"",d=this.domId=u.id||CKEDITOR.tools.getNextId()+"_uiElement";e.requiredContent&&!t.getParentEditor().filter.check(e.requiredContent)&&(c.display="none",this.notAllowed=!0),u.id=d;var f={};e.type&&(f["cke_dialog_ui_"+e.type]=1),e.className&&(f[e.className]=1),e.disabled&&(f.cke_disabled=1);var p=u.class&&u.class.split?u.class.split(" "):[];for(d=0;d<p.length;d++)p[d]&&(f[p[d]]=1);for(d in p=[],f)p.push(d);for(d in u.class=p.join(" "),e.title&&(u.title=e.title),f=(e.style||"").split(";"),e.align&&(p=e.align,c["margin-left"]="left"==p?0:"auto",c["margin-right"]="right"==p?0:"auto"),c)f.push(d+":"+c[d]);for(e.hidden&&f.push("display:none"),d=f.length-1;0<=d;d--)""===f[d]&&f.splice(d,1);for(d in 0<f.length&&(u.style=(u.style?u.style+"; ":"")+f.join("; ")),u)l.push(d+'="'+CKEDITOR.tools.htmlEncode(u[d])+'" ');l.push(">",h,"</",a,">"),n.push(l.join("")),(this._||(this._={})).dialog=t,"boolean"==typeof e.isChanged&&(this.isChanged=function(){return e.isChanged}),"function"==typeof e.isChanged&&(this.isChanged=e.isChanged),"function"==typeof e.setValue&&(this.setValue=CKEDITOR.tools.override(this.setValue,function(t){return function(n){t.call(this,e.setValue.call(this,n))}})),"function"==typeof e.getValue&&(this.getValue=CKEDITOR.tools.override(this.getValue,function(t){return function(){return e.getValue.call(this,t.call(this))}})),CKEDITOR.event.implementOn(this),this.registerEvents(e),this.accessKeyUp&&this.accessKeyDown&&e.accessKey&&v(this,t,"CTRL+"+e.accessKey);var g=this;t.on("load",function(){var e=g.getInputElement();if(e){var n=g.type in{checkbox:1,ratio:1}&&CKEDITOR.env.ie&&8>CKEDITOR.env.version?"cke_dialog_ui_focused":"";e.on("focus",function(){t._.tabBarMode=!1,t._.hasFocus=!0,g.fire("focus"),n&&this.addClass(n)}),e.on("blur",function(){g.fire("blur"),n&&this.removeClass(n)})}}),CKEDITOR.tools.extend(this,e),this.keyboardFocusable&&(this.tabIndex=e.tabIndex||0,this.focusIndex=t._.focusList.push(this)-1,this.on("focus",function(){t._.currentFocusIndex=g.focusIndex}))}},hbox:function(t,e,n,i,r){if(!(4>arguments.length)){this._||(this._={});var o,s=this._.children=e,a=r&&r.widths||null,l=r&&r.height||null,c={role:"presentation"};r&&r.align&&(c.align=r.align),CKEDITOR.ui.dialog.uiElement.call(this,t,r||{type:"hbox"},i,"table",{},c,function(){var t=['<tbody><tr class="cke_dialog_ui_hbox">'];for(o=0;o<n.length;o++){var e="cke_dialog_ui_hbox_child",i=[];0===o&&(e="cke_dialog_ui_hbox_first"),o==n.length-1&&(e="cke_dialog_ui_hbox_last"),t.push('<td class="',e,'" role="presentation" '),a?a[o]&&i.push("width:"+E(a[o])):i.push("width:"+Math.floor(100/n.length)+"%"),l&&i.push("height:"+E(l)),r&&void 0!==r.padding&&i.push("padding:"+E(r.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&s[o].align&&i.push("text-align:"+s[o].align),0<i.length&&t.push('style="'+i.join("; ")+'" '),t.push(">",n[o],"</td>")}return t.push("</tr></tbody>"),t.join("")})}},vbox:function(t,e,n,i,r){if(!(3>arguments.length)){this._||(this._={});var o=this._.children=e,s=r&&r.width||null,a=r&&r.heights||null;CKEDITOR.ui.dialog.uiElement.call(this,t,r||{type:"vbox"},i,"div",null,{role:"presentation"},function(){var e=['<table role="presentation" cellspacing="0" border="0" '];e.push('style="'),r&&r.expand&&e.push("height:100%;"),e.push("width:"+E(s||"100%"),";"),CKEDITOR.env.webkit&&e.push("float:none;"),e.push('"'),e.push('align="',CKEDITOR.tools.htmlEncode(r&&r.align||("ltr"==t.getParentEditor().lang.dir?"left":"right")),'" '),e.push("><tbody>");for(var i=0;i<n.length;i++){var l=[];e.push('<tr><td role="presentation" '),s&&l.push("width:"+E(s||"100%")),a?l.push("height:"+E(a[i])):r&&r.expand&&l.push("height:"+Math.floor(100/n.length)+"%"),r&&void 0!==r.padding&&l.push("padding:"+E(r.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&o[i].align&&l.push("text-align:"+o[i].align),0<l.length&&e.push('style="',l.join("; "),'" '),e.push(' class="cke_dialog_ui_vbox_child">',n[i],"</td></tr>")}return e.push("</tbody></table>"),e.join("")})}}},CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(t,e){return this.getInputElement().setValue(t),!e&&this.fire("change",{value:t}),this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return!1},selectParentTab:function(){for(var t=this.getInputElement();(t=t.getParent())&&-1==t.$.className.search("cke_dialog_page_contents"););return t?(t=t.getAttribute("name"),this._.dialog._.currentTabId!=t&&this._.dialog.selectPage(t),this):this},focus:function(){return this.selectParentTab().getInputElement().focus(),this},registerEvents:function(t){var e,n,i=/^on([A-Z]\w+)/,r=function(t,e,n,i){e.on("load",function(){t.getInputElement().on(n,i,t)})};for(n in t)(e=n.match(i))&&(this.eventProcessors[n]?this.eventProcessors[n].call(this,this._.dialog,t[n]):r(this,this._.dialog,e[1].toLowerCase(),t[n]));return this},eventProcessors:{onLoad:function(t,e){t.on("load",e,this)},onShow:function(t,e){t.on("show",e,this)},onHide:function(t,e){t.on("hide",e,this)}},accessKeyDown:function(){this.focus()},accessKeyUp:function(){},disable:function(){var t=this.getElement();this.getInputElement().setAttribute("disabled","true"),t.addClass("cke_disabled")},enable:function(){var t=this.getElement();this.getInputElement().removeAttribute("disabled"),t.removeClass("cke_disabled")},isEnabled:function(){return!this.getElement().hasClass("cke_disabled")},isVisible:function(){return this.getInputElement().isVisible()},isFocusable:function(){return!(!this.isEnabled()||!this.isVisible())}},CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getChild:function(t){return 1>arguments.length?this._.children.concat():(t.splice||(t=[t]),2>t.length?this._.children[t[0]]:this._.children[t[0]]&&this._.children[t[0]].getChild?this._.children[t[0]].getChild(t.slice(1,t.length)):null)}},!0),CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox,function(){var t={build:function(t,e,n){for(var i,r=e.children,o=[],s=[],a=0;a<r.length&&(i=r[a]);a++){var l=[];o.push(l),s.push(CKEDITOR.dialog._.uiElementBuilders[i.type].build(t,i,l))}return new CKEDITOR.ui.dialog[e.type](t,s,o,n,e)}};CKEDITOR.dialog.addUIElement("hbox",t),CKEDITOR.dialog.addUIElement("vbox",t)}(),CKEDITOR.dialogCommand=function(t,e){this.dialogName=t,CKEDITOR.tools.extend(this,e,!0)},CKEDITOR.dialogCommand.prototype={exec:function(t){var e=this.tabId;t.openDialog(this.dialogName,function(t){e&&t.selectPage(e)})},canUndo:!1,editorFocus:1},function(){var t=/^\d*$/,e=/^\d*(?:\.\d+)?$/,n=/^(((\d*(\.\d+))|(\d*))(px|\%)?)?$/,i=/^(((\d*(\.\d+))|(\d*))(px|em|ex|in|cm|mm|pt|pc|\%)?)?$/i,r=/^(--|-?([a-zA-Z_]|\\))(\\|[a-zA-Z0-9-_])*\s*?:\s*?[^:;]+$/;CKEDITOR.VALIDATE_OR=1,CKEDITOR.VALIDATE_AND=2,CKEDITOR.dialog.validate={functions:function(){var t=arguments;return function(e){this&&this.getValue&&(e=this.getValue());var n,i,r=CKEDITOR.VALIDATE_AND,o=[];for(i=0;i<t.length&&"function"==typeof t[i];i++)o.push(t[i]);i<t.length&&"string"==typeof t[i]&&(n=t[i],i++),i<t.length&&"number"==typeof t[i]&&(r=t[i]),i=r==CKEDITOR.VALIDATE_AND;for(var s=0;s<o.length;s++){var a=!0===o[s](e);i=r==CKEDITOR.VALIDATE_AND?i&&a:i||a}return!!i||n}},regex:function(t,e){return this.functions(function(e){return t.test(e)},e)},notEmpty:function(t){return this.functions(function(t){return 0<t.replace(RegExp("^[\\u0020\\u00a0\\u1680\\u202f\\u205f\\u3000\\u2000-\\u200a\\s]+|[\\u0020\\u00a0\\u1680\\u202f\\u205f\\u3000\\u2000-\\u200a\\s]+$","g"),"").length},t)},integer:function(e){return this.regex(t,e)},number:function(t){return this.regex(e,t)},cssLength:function(t){return this.functions(function(t){return i.test(CKEDITOR.tools.trim(t))},t)},htmlLength:function(t){return this.functions(function(t){return n.test(CKEDITOR.tools.trim(t))},t)},inlineStyle:function(t){return this.functions(function(t){return""===(t=CKEDITOR.tools.trim(t).split(";"))[t.length-1]&&t.pop(),CKEDITOR.tools.array.every(t,function(t){return r.test(CKEDITOR.tools.trim(t))})},t)},equals:function(t,e){return this.functions(function(e){return e==t},e)},notEqual:function(t,e){return this.functions(function(e){return e!=t},e)}},CKEDITOR.on("instanceDestroyed",function(t){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){for(var e;e=CKEDITOR.dialog._.currentTop;)e.hide();for(var n in O)O[n].remove();O={}}for(var i in t=t.editor._.storedDialogs)t[i].destroy()})}(),CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(t,e,n){var i=null,r=CKEDITOR.dialog._.dialogDefinitions[t];if(null===CKEDITOR.dialog._.currentTop&&f(this),"function"==typeof r)r=this._.storedDialogs||(this._.storedDialogs={}),(i=r[t]||(r[t]=new CKEDITOR.dialog(this,t))).setModel(n),e&&e.call(i,i),i.show();else{if("failed"==r)throw p(this),Error('[CKEDITOR.dialog.openDialog] Dialog "'+t+'" failed when loading definition.');"string"==typeof r&&CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(r),function(){"function"!=typeof CKEDITOR.dialog._.dialogDefinitions[t]&&(CKEDITOR.dialog._.dialogDefinitions[t]="failed"),this.openDialog(t,e,n)},this,0,1)}return CKEDITOR.skin.loadPart("dialog"),i&&i.once("hide",function(){i.setModel(null)},null,null,999),i}}),CKEDITOR.plugins.add("dialog",{requires:"dialogui",init:function(t){T||(CKEDITOR.document.appendStyleSheet(this.path+"styles/dialog.css"),T=!0),t.on("doubleclick",function(e){e.data.dialog&&t.openDialog(e.data.dialog)},null,null,999)}})}(),function(){function t(t,e){CKEDITOR.tools.extend(this,e,{editor:t,id:"cke-"+CKEDITOR.tools.getUniqueId(),area:t._.notificationArea}),e.type||(this.type="info"),this.element=this._createElement(),t.plugins.clipboard&&CKEDITOR.plugins.clipboard.preventDefaultDropOnElement(this.element)}function e(t){var e=this;this.editor=t,this.notifications=[],this.element=this._createElement(),this._uiBuffer=CKEDITOR.tools.eventsBuffer(10,this._layout,this),this._changeBuffer=CKEDITOR.tools.eventsBuffer(500,this._layout,this),t.on("destroy",function(){e._removeListeners(),e.element.remove()})}CKEDITOR.plugins.add("notification",{init:function(t){t._.notificationArea=new e(t),t.showNotification=function(e,n,i){var r,o;return"progress"==n?r=i:o=i,(e=new CKEDITOR.plugins.notification(t,{message:e,type:n,progress:r,duration:o})).show(),e},t.on("key",function(e){if(27==e.data.keyCode){var n=t._.notificationArea.notifications;n.length&&(function(t){var e=new CKEDITOR.dom.element("div");e.setStyles({position:"fixed","margin-left":"-9999px"}),e.setAttributes({"aria-live":"assertive","aria-atomic":"true"}),e.setText(t),CKEDITOR.document.getBody().append(e),setTimeout(function(){e.remove()},100)}(t.lang.notification.closed),n[n.length-1].hide(),e.cancel())}})}}),t.prototype={show:function(){!1!==this.editor.fire("notificationShow",{notification:this})&&(this.area.add(this),this._hideAfterTimeout())},update:function(t){var e=!0;!1===this.editor.fire("notificationUpdate",{notification:this,options:t})&&(e=!1);var n=this.element,i=n.findOne(".cke_notification_message"),r=n.findOne(".cke_notification_progress"),o=t.type;n.removeAttribute("role"),t.progress&&"progress"!=this.type&&(o="progress"),o&&(n.removeClass(this._getClass()),n.removeAttribute("aria-label"),this.type=o,n.addClass(this._getClass()),n.setAttribute("aria-label",this.type),"progress"!=this.type||r?"progress"!=this.type&&r&&r.remove():(r=this._createProgressElement()).insertBefore(i)),void 0!==t.message&&(this.message=t.message,i.setHtml(this.message)),void 0!==t.progress&&(this.progress=t.progress,r&&r.setStyle("width",this._getPercentageProgress())),e&&t.important&&(n.setAttribute("role","alert"),this.isVisible()||this.area.add(this)),this.duration=t.duration,this._hideAfterTimeout()},hide:function(){!1!==this.editor.fire("notificationHide",{notification:this})&&this.area.remove(this)},isVisible:function(){return 0<=CKEDITOR.tools.indexOf(this.area.notifications,this)},_createElement:function(){var t,e,n=this,i=this.editor.lang.common.close;return(t=new CKEDITOR.dom.element("div")).addClass("cke_notification"),t.addClass(this._getClass()),t.setAttributes({id:this.id,role:"alert","aria-label":this.type}),"progress"==this.type&&t.append(this._createProgressElement()),(e=new CKEDITOR.dom.element("p")).addClass("cke_notification_message"),e.setHtml(this.message),t.append(e),e=CKEDITOR.dom.element.createFromHtml('<a class="cke_notification_close" href="javascript:void(0)" title="'+i+'" role="button" tabindex="-1"><span class="cke_label">X</span></a>'),t.append(e),e.on("click",function(){n.editor.focus(),n.hide()}),t},_getClass:function(){return"progress"==this.type?"cke_notification_info":"cke_notification_"+this.type},_createProgressElement:function(){var t=new CKEDITOR.dom.element("span");return t.addClass("cke_notification_progress"),t.setStyle("width",this._getPercentageProgress()),t},_getPercentageProgress:function(){return Math.round(100*(this.progress||0))+"%"},_hideAfterTimeout:function(){var t,e=this;this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),"number"==typeof this.duration?t=this.duration:"info"!=this.type&&"success"!=this.type||(t="number"==typeof this.editor.config.notification_duration?this.editor.config.notification_duration:5e3),t&&(e._hideTimeoutId=setTimeout(function(){e.hide()},t))}},e.prototype={add:function(t){this.notifications.push(t),this.element.append(t.element),1==this.element.getChildCount()&&(CKEDITOR.document.getBody().append(this.element),this._attachListeners()),this._layout()},remove:function(t){var e=CKEDITOR.tools.indexOf(this.notifications,t);0>e||(this.notifications.splice(e,1),t.element.remove(),this.element.getChildCount()||(this._removeListeners(),this.element.remove()))},_createElement:function(){var t=this.editor,e=t.config,n=new CKEDITOR.dom.element("div");return n.addClass("cke_notifications_area"),n.setAttribute("id","cke_notifications_area_"+t.name),n.setStyle("z-index",e.baseFloatZIndex-2),n},_attachListeners:function(){var t=CKEDITOR.document.getWindow(),e=this.editor;t.on("scroll",this._uiBuffer.input),t.on("resize",this._uiBuffer.input),e.on("change",this._changeBuffer.input),e.on("floatingSpaceLayout",this._layout,this,null,20),e.on("blur",this._layout,this,null,20)},_removeListeners:function(){var t=CKEDITOR.document.getWindow(),e=this.editor;t.removeListener("scroll",this._uiBuffer.input),t.removeListener("resize",this._uiBuffer.input),e.removeListener("change",this._changeBuffer.input),e.removeListener("floatingSpaceLayout",this._layout),e.removeListener("blur",this._layout)},_layout:function(){function t(){r.setStyle("left",g(m+s.width-c-u))}var e,n,i,r=this.element,o=this.editor,s=o.ui.contentsElement.getClientRect(),a=o.ui.contentsElement.getDocumentPosition(),l=r.getClientRect(),c=this._notificationWidth,u=this._notificationMargin,h=(i=CKEDITOR.document.getWindow()).getScrollPosition(),d=i.getViewPaneSize(),f=CKEDITOR.document.getBody(),p=f.getDocumentPosition(),g=CKEDITOR.tools.cssLength;c&&u||(i=this.element.getChild(0),c=this._notificationWidth=i.getClientRect().width,u=this._notificationMargin=parseInt(i.getComputedStyle("margin-left"),10)+parseInt(i.getComputedStyle("margin-right"),10)),o.toolbar&&(n=(e=o.ui.space(o.config.toolbarLocation)).getClientRect()),e&&e.isVisible()&&n.bottom>s.top&&n.bottom<s.bottom-l.height?r.setStyles({position:"fixed",top:g(n.bottom)}):0<s.top?r.setStyles({position:"absolute",top:g(a.y)}):a.y+s.height-l.height>h.y?r.setStyles({position:"fixed",top:0}):r.setStyles({position:"absolute",top:g(a.y+s.height-l.height)});var m="fixed"==r.getStyle("position")?s.left:"static"!=f.getComputedStyle("position")?a.x-p.x:a.x;s.width<c+u?a.x+c+u>h.x+d.width?t():r.setStyle("left",g(m)):a.x+c+u>h.x+d.width?r.setStyle("left",g(m)):a.x+s.width/2+c/2+u>h.x+d.width?r.setStyle("left",g(m-a.x+h.x+d.width-c-u)):0>s.left+s.width-c-u?t():0>s.left+s.width/2-c/2?r.setStyle("left",g(m-a.x+h.x)):r.setStyle("left",g(m+s.width/2-c/2-u/2))}},CKEDITOR.plugins.notification=t}(),function(){function t(t){function n(e,n){if(n.length){e.items?e.items.push(t.ui.create("-")):e.items=[];for(var r;r=n.shift();)r="string"==typeof r?r:r.name,i&&-1!=CKEDITOR.tools.indexOf(i,r)||(r=t.ui.create(r))&&t.addFeature(r)&&e.items.push(r)}}var i=function(t){return t&&"string"==typeof t?t.split(","):t}(t.config.removeButtons),r=t.config.toolbar;return"string"==typeof r&&(r=t.config["toolbar_"+r]),t.toolbar=r?function(t){var e,i,r,o=[];for(e=0;e<t.length;++e)r={},"/"==(i=t[e])?o.push(i):CKEDITOR.tools.isArray(i)?(n(r,CKEDITOR.tools.clone(i)),o.push(r)):i.items&&(n(r,CKEDITOR.tools.clone(i.items)),r.name=i.name,o.push(r));return o}(r):function(){for(var i=function(){var e,n,i,r={};for(e in t.ui.items)n=t.ui.items[e],i=(i=n.toolbar||"others").split(","),n=i[0],i=parseInt(i[1]||-1,10),r[n]||(r[n]=[]),r[n].push({name:e,order:i});for(n in r)r[n]=r[n].sort(function(t,e){return t.order==e.order?0:0>e.order?-1:0>t.order?1:t.order<e.order?-1:1});return r}(),r=CKEDITOR.tools.clone(t.config.toolbarGroups)||e(t),o=0;o<r.length;o++){var s=r[o];if("/"!=s){"string"==typeof s&&(s=r[o]={name:s});var a,l=s.groups;if(l)for(var c=0;c<l.length;c++)(a=i[a=l[c]])&&n(s,a);(a=i[s.name])&&n(s,a)}}return r}()}function e(t){return t._.toolbarGroups||(t._.toolbarGroups=[{name:"document",groups:["mode","document","doctools"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker"]},{name:"forms"},"/",{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"links"},{name:"insert"},"/",{name:"styles"},{name:"colors"},{name:"tools"},{name:"others"},{name:"about"}])}var n=function(){this.toolbars=[]};n.prototype.focus=function(){for(var t,e=0;t=this.toolbars[e++];)for(var n,i=0;n=t.items[i++];)if(n.focus)return void n.focus()};var i={modes:{wysiwyg:1,source:1},readOnly:1,exec:function(t){t.toolbox&&(CKEDITOR.env.ie||CKEDITOR.env.air?setTimeout(function(){t.toolbox.focus()},100):t.toolbox.focus())}};CKEDITOR.plugins.add("toolbar",{requires:"button",init:function(e){var r,o=function(t,n){var i,s=(a="rtl"==e.lang.dir)?37:39,a=a?39:37,l=void 0===(l=e.config.toolbarGroupCycling)||l;switch(n){case 9:case CKEDITOR.SHIFT+9:for(;!i||!i.items.length;)if((i=9==n?(i?i.next:t.toolbar.next)||e.toolbox.toolbars[0]:(i?i.previous:t.toolbar.previous)||e.toolbox.toolbars[e.toolbox.toolbars.length-1]).items.length)for(t=i.items[r?i.items.length-1:0];t&&!t.focus;)(t=r?t.previous:t.next)||(i=0);return t&&t.focus(),!1;case s:i=t;do{!(i=i.next)&&l&&(i=t.toolbar.items[0])}while(i&&!i.focus);return i?i.focus():o(t,9),!1;case 40:return t.button&&t.button.hasArrow?t.execute():o(t,40==n?s:a),!1;case a:case 38:i=t;do{!(i=i.previous)&&l&&(i=t.toolbar.items[t.toolbar.items.length-1])}while(i&&!i.focus);return i?i.focus():(r=1,o(t,CKEDITOR.SHIFT+9),r=0),!1;case 27:return e.focus(),!1;case 13:case 32:return t.execute(),!1;case CKEDITOR.ALT+122:return e.execCommand("elementsPathFocus"),!1}return!0};e.on("uiSpace",function(i){if(i.data.space==e.config.toolbarLocation){i.removeListener(),e.toolbox=new n;var r,s,a=['<span id="',l=CKEDITOR.tools.getNextId(),'" class="cke_voice_label">',e.lang.toolbar.toolbars,"</span>",'<span id="'+e.ui.spaceId("toolbox")+'" class="cke_toolbox" role="group" aria-labelledby="',l,'" onmousedown="return false;">'],l=!1!==e.config.toolbarStartupExpanded;e.config.toolbarCanCollapse&&e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&a.push('<span class="cke_toolbox_main"'+(l?">":' style="display:none">'));for(var c=e.toolbox.toolbars,u=t(e),h=u.length,d=0;d<h;d++){var f,p,g,m=0,v=u[d],y="/"!==v&&("/"===u[d+1]||d==h-1);if(v)if(r&&(a.push("</span>"),s=r=0),"/"===v)a.push('<span class="cke_toolbar_break"></span>');else{g=v.items||v;for(var b=0;b<g.length;b++){var C,I=g[b];if(I){var E=function(t){t=t.render(e,a),0<(T=m.items.push(t)-1)&&(t.previous=m.items[T-1],t.previous.next=t),t.toolbar=m,t.onkey=o};if(I.type==CKEDITOR.UI_SEPARATOR)s=r&&I;else{if(C=!1!==I.canGroup,!m){f=CKEDITOR.tools.getNextId(),m={id:f,items:[]},p=v.name&&(e.lang.toolbar.toolbarGroups[v.name]||v.name),a.push('<span id="',f,'" class="cke_toolbar'+(y?' cke_toolbar_last"':'"'),p?' aria-labelledby="'+f+'_label"':"",' role="toolbar">'),p&&a.push('<span id="',f,'_label" class="cke_voice_label">',p,"</span>"),a.push('<span class="cke_toolbar_start"></span>');var T=c.push(m)-1;0<T&&(m.previous=c[T-1],m.previous.next=m)}C?r||(a.push('<span class="cke_toolgroup" role="presentation">'),r=1):r&&(a.push("</span>"),r=0),s&&(E(s),s=0),E(I)}}}r&&(a.push("</span>"),s=r=0),m&&a.push('<span class="cke_toolbar_end"></span></span>')}}if(e.config.toolbarCanCollapse&&a.push("</span>"),e.config.toolbarCanCollapse&&e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var w=CKEDITOR.tools.addFunction(function(){e.execCommand("toolbarCollapse")});e.on("destroy",function(){CKEDITOR.tools.removeFunction(w)}),e.addCommand("toolbarCollapse",{readOnly:1,exec:function(t){var e=t.ui.space("toolbar_collapser"),n=e.getPrevious(),i=t.ui.space("contents"),r=n.getParent(),o=parseInt(i.$.style.height,10),s=r.$.offsetHeight,a=e.hasClass("cke_toolbox_collapser_min");a?(n.show(),e.removeClass("cke_toolbox_collapser_min"),e.setAttribute("title",t.lang.toolbar.toolbarCollapse)):(n.hide(),e.addClass("cke_toolbox_collapser_min"),e.setAttribute("title",t.lang.toolbar.toolbarExpand)),e.getFirst().setText(a?"\u25b2":"\u25c0"),i.setStyle("height",o-(r.$.offsetHeight-s)+"px"),t.fire("resize",{outerHeight:t.container.$.offsetHeight,contentsHeight:i.$.offsetHeight,outerWidth:t.container.$.offsetWidth})},modes:{wysiwyg:1,source:1}}),e.setKeystroke(CKEDITOR.ALT+(CKEDITOR.env.ie||CKEDITOR.env.webkit?189:109),"toolbarCollapse"),a.push('<a title="'+(l?e.lang.toolbar.toolbarCollapse:e.lang.toolbar.toolbarExpand)+'" id="'+e.ui.spaceId("toolbar_collapser")+'" tabIndex="-1" class="cke_toolbox_collapser'),l||a.push(" cke_toolbox_collapser_min"),a.push('" onclick="CKEDITOR.tools.callFunction('+w+')">','<span class="cke_arrow">&#9650;</span>',"</a>")}a.push("</span>"),i.data.html+=a.join("")}}),e.on("destroy",function(){if(this.toolbox){var t,e,n,i,r=0;for(t=this.toolbox.toolbars;r<t.length;r++)for(n=t[r].items,e=0;e<n.length;e++)(i=n[e]).clickFn&&CKEDITOR.tools.removeFunction(i.clickFn),i.keyDownFn&&CKEDITOR.tools.removeFunction(i.keyDownFn)}}),e.on("uiReady",function(){var t=e.ui.space("toolbox");t&&e.focusManager.add(t,1)}),e.addCommand("toolbarFocus",i),e.setKeystroke(CKEDITOR.ALT+121,"toolbarFocus"),e.ui.add("-",CKEDITOR.UI_SEPARATOR,{}),e.ui.addHandler(CKEDITOR.UI_SEPARATOR,{create:function(){return{render:function(t,e){return e.push('<span class="cke_toolbar_separator" role="separator"></span>'),{}}}}})}}),CKEDITOR.ui.prototype.addToolbarGroup=function(t,n,i){var r=e(this.editor),o=0===n,s={name:t};if(i){if(i=CKEDITOR.tools.search(r,function(t){return t.name==i}))return!i.groups&&(i.groups=[]),n&&0<=(n=CKEDITOR.tools.indexOf(i.groups,n))?void i.groups.splice(n+1,0,t):void(o?i.groups.splice(0,0,t):i.groups.push(t));n=null}n&&(n=CKEDITOR.tools.indexOf(r,function(t){return t.name==n})),o?r.splice(0,0,t):"number"==typeof n?r.splice(n+1,0,s):r.push(t)}}(),CKEDITOR.UI_SEPARATOR="separator",CKEDITOR.config.toolbarLocation="top",function(){function t(t,e,n){return e.type||(e.type="auto"),!(n&&!1===t.fire("beforePaste",e)||!e.dataValue&&e.dataTransfer.isEmpty())&&(e.dataValue||(e.dataValue=""),CKEDITOR.env.gecko&&"drop"==e.method&&t.toolbox&&t.once("afterPaste",function(){t.toolbox.focus(),t.focus()}),t.fire("paste",e))}function e(e){function n(){var t,n=e.editable();if(CKEDITOR.plugins.clipboard.isCustomCopyCutSupported){var i=function(t){e.getSelection().isCollapsed()||(e.readOnly&&"cut"==t.name||p.initPasteDataTransfer(t,e),t.data.preventDefault())};n.on("copy",i),n.on("cut",i),n.on("cut",function(){e.readOnly||e.extractSelectedHtml()},null,null,999)}n.on(p.mainPasteEvent,function(t){"beforepaste"==p.mainPasteEvent&&g||h(t)}),"beforepaste"==p.mainPasteEvent&&(n.on("paste",function(t){m||(o(),t.data.preventDefault(),h(t),a("paste"))}),n.on("contextmenu",s,null,null,0),n.on("beforepaste",function(t){!t.data||t.data.$.ctrlKey||t.data.$.shiftKey||s()},null,null,0)),n.on("beforecut",function(){!g&&l()}),n.attachListener(CKEDITOR.env.ie?n:e.document.getDocumentElement(),"mouseup",function(){t=setTimeout(d,0)}),e.on("destroy",function(){clearTimeout(t)}),n.on("keyup",d)}function i(t){return{type:t,canUndo:"cut"==t,startDisabled:!0,fakeKeystroke:"cut"==t?CKEDITOR.CTRL+88:CKEDITOR.CTRL+67,exec:function(){var t;"cut"==this.type&&l();var n=this.type;if(CKEDITOR.env.ie)t=a(n);else try{t=e.document.$.execCommand(n,!1,null)}catch(i){t=!1}return t||e.showNotification(e.lang.clipboard[this.type+"Error"]),t}}}function r(){return{canUndo:!1,async:!0,fakeKeystroke:CKEDITOR.CTRL+86,exec:function(e,n){function i(n,i){i=void 0===i||i,n?(n.method="paste",n.dataTransfer||(n.dataTransfer=p.initPasteDataTransfer()),t(e,n,i)):o&&!e._.forcePasteDialog&&e.showNotification(l,"info",e.config.clipboard_notificationDuration),e._.forcePasteDialog=!1,e.fire("afterCommandExec",{name:"paste",command:r,returnValue:!!n})}var r=this,o=void 0===(n=null!=n?n:{}).notification||n.notification,s=n.type,a=CKEDITOR.tools.keystrokeToString(e.lang.common.keyboard,e.getCommandKeystroke(this)),l="string"==typeof o?o:e.lang.clipboard.pasteNotification.replace(/%1/,'<kbd aria-label="'+a.aria+'">'+a.display+"</kbd>");a="string"==typeof n?n:n.dataValue;s&&!0!==e.config.forcePasteAsPlainText&&"allow-word"!==e.config.forcePasteAsPlainText?e._.nextPasteType=s:delete e._.nextPasteType,"string"==typeof a?i({dataValue:a}):e.getClipboardData(i)}}}function o(){m=1,setTimeout(function(){m=0},100)}function s(){g=1,setTimeout(function(){g=0},10)}function a(t){var n=e.document,i=n.getBody(),r=!1,o=function(){r=!0};return i.on(t,o),7<CKEDITOR.env.version?n.$.execCommand(t):n.$.selection.createRange().execCommand(t),i.removeListener(t,o),r}function l(){if(CKEDITOR.env.ie&&!CKEDITOR.env.quirks){var t,n,i,r=e.getSelection();r.getType()==CKEDITOR.SELECTION_ELEMENT&&(t=r.getSelectedElement())&&(n=r.getRanges()[0],(i=e.document.createText("")).insertBefore(t),n.setStartBefore(i),n.setEndAfter(t),r.selectRanges([n]),setTimeout(function(){t.getParent()&&(i.remove(),r.selectElement(t))},0))}}function c(){if("paste"==p.mainPasteEvent)return e.fire("beforePaste",{type:"auto",method:"paste"}),!1;e.focus(),o();var t=e.focusManager;return t.lock(),e.editable().fire(p.mainPasteEvent)&&!a("paste")?(t.unlock(),!1):(t.unlock(),!0)}function u(t){if("wysiwyg"==e.mode)switch(t.data.keyCode){case CKEDITOR.CTRL+86:case CKEDITOR.SHIFT+45:t=e.editable(),o(),"paste"==p.mainPasteEvent&&t.fire("beforepaste");break;case CKEDITOR.CTRL+88:case CKEDITOR.SHIFT+46:e.fire("saveSnapshot"),setTimeout(function(){e.fire("saveSnapshot")},50)}}function h(n){var i={type:"auto",method:"paste",dataTransfer:p.initPasteDataTransfer(n)};i.dataTransfer.cacheData();var r=!1!==e.fire("beforePaste",i);r&&p.canClipboardApiBeTrusted(i.dataTransfer,e)?(n.data.preventDefault(),setTimeout(function(){t(e,i)},0)):function(t,n){var i,r=e.document,o=e.editable(),s=function(t){t.cancel()};if(!r.getById("cke_pastebin")){var a=e.getSelection(),l=a.createBookmarks();CKEDITOR.env.ie&&a.root.fire("selectionchange");var c=new CKEDITOR.dom.element(!CKEDITOR.env.webkit&&!o.is("body")||CKEDITOR.env.ie?"div":"body",r);c.setAttributes({id:"cke_pastebin","data-cke-temp":"1"});var u=0;r=r.getWindow(),CKEDITOR.env.webkit?(o.append(c),c.addClass("cke_editable"),o.is("body")||(u=(u="static"!=o.getComputedStyle("position")?o:CKEDITOR.dom.element.get(o.$.offsetParent)).getDocumentPosition().y)):o.getAscendant(CKEDITOR.env.ie?"body":"html",1).append(c),c.setStyles({position:"absolute",top:r.getScrollPosition().y-u+10+"px",width:"1px",height:Math.max(1,r.getViewPaneSize().height-20)+"px",overflow:"hidden",margin:0,padding:0}),CKEDITOR.env.safari&&c.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","text")),(u=c.getParent().isReadOnly())?(c.setOpacity(0),c.setAttribute("contenteditable",!0)):c.setStyle("ltr"==e.config.contentsLangDirection?"left":"right","-10000px"),e.on("selectionChange",s,null,null,0),(CKEDITOR.env.webkit||CKEDITOR.env.gecko)&&(i=o.once("blur",s,null,null,-100)),u&&c.focus(),(u=new CKEDITOR.dom.range(c)).selectNodeContents(c);var h=u.select();CKEDITOR.env.ie&&(i=o.once("blur",function(){e.lockSelection(h)}));var d=CKEDITOR.document.getWindow().getScrollPosition().y;setTimeout(function(){var t;CKEDITOR.env.webkit&&(CKEDITOR.document.getBody().$.scrollTop=d),i&&i.removeListener(),CKEDITOR.env.ie&&o.focus(),a.selectBookmarks(l),c.remove(),CKEDITOR.env.webkit&&(t=c.getFirst())&&t.is&&t.hasClass("Apple-style-span")&&(c=t),e.removeListener("selectionChange",s),n(c.getHtml())},0)}}(0,function(n){i.dataValue=n.replace(/<span[^>]+data-cke-bookmark[^<]*?<\/span>/gi,""),r&&t(e,i)})}function d(){if("wysiwyg"==e.mode){var t=f("paste");e.getCommand("cut").setState(f("cut")),e.getCommand("copy").setState(f("copy")),e.getCommand("paste").setState(t),e.fire("pasteState",t)}}function f(t){var n=(n=e.getSelection())&&n.getRanges()[0];return(e.readOnly||n&&n.checkReadOnly())&&t in{paste:1,cut:1}?CKEDITOR.TRISTATE_DISABLED:"paste"==t?CKEDITOR.TRISTATE_OFF:(n=(t=e.getSelection()).getRanges(),t.getType()==CKEDITOR.SELECTION_NONE||1==n.length&&n[0].collapsed?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_OFF)}var p=CKEDITOR.plugins.clipboard,g=0,m=0;!function(){if(e.on("key",u),e.on("contentDom",n),e.on("selectionChange",d),e.contextMenu){e.contextMenu.addListener(function(){return{cut:f("cut"),copy:f("copy"),paste:f("paste")}});var t=null;e.on("menuShow",function(){t&&(t.removeListener(),t=null);var n=e.contextMenu.findItemByCommandName("paste");n&&n.element&&(t=n.element.on("touchend",function(){e._.forcePasteDialog=!0}))})}e.ui.addButton&&e.once("instanceReady",function(){e._.pasteButtons&&CKEDITOR.tools.array.forEach(e._.pasteButtons,function(t){(t=e.ui.get(t))&&(t=CKEDITOR.document.getById(t._.id))&&t.on("touchend",function(){e._.forcePasteDialog=!0})})})}(),function(){function t(t,n,i,r,o){var s=e.lang.clipboard[n];e.addCommand(n,i),e.ui.addButton&&e.ui.addButton(t,{label:s,command:n,toolbar:"clipboard,"+r}),e.addMenuItems&&e.addMenuItem(n,{label:s,command:n,group:"clipboard",order:o})}t("Cut","cut",i("cut"),10,1),t("Copy","copy",i("copy"),20,4),t("Paste","paste",r(),30,8),e._.pasteButtons||(e._.pasteButtons=[]),e._.pasteButtons.push("Paste")}(),e.getClipboardData=function(t,n){function i(t){t.removeListener(),t.cancel(),n(t.data)}function r(t){t.removeListener(),t.cancel(),n({type:s,dataValue:t.data.dataValue,dataTransfer:t.data.dataTransfer,method:"paste"})}var o=!1,s="auto";n||(n=t,t=null),e.on("beforePaste",function(t){t.removeListener(),o=!0,s=t.data.type},null,null,1e3),e.on("paste",i,null,null,0),!1===c()&&(e.removeListener("paste",i),e._.forcePasteDialog&&o&&e.fire("pasteDialog")?(e.on("pasteDialogCommit",r),e.on("dialogHide",function(t){t.removeListener(),t.data.removeListener("pasteDialogCommit",r),t.data._.committed||n(null)})):n(null))}}function n(t,e){function n(t){return CKEDITOR.tools.repeat("</p><p>",~~(t/2))+(1==t%2?"<br>":"")}return e=(e=e.replace(/(?!\u3000)\s+/g," ").replace(/> +</g,"><").replace(/<br ?\/>/gi,"<br>")).replace(/<\/?[A-Z]+>/g,function(t){return t.toLowerCase()}),e.match(/^[^<]$/)?e:(CKEDITOR.env.webkit&&-1<e.indexOf("<div>")&&((e=e.replace(/^(<div>(<br>|)<\/div>)(?!$|(<div>(<br>|)<\/div>))/g,"<br>").replace(/^(<div>(<br>|)<\/div>){2}(?!$)/g,"<div></div>")).match(/<div>(<br>|)<\/div>/)&&(e="<p>"+e.replace(/(<div>(<br>|)<\/div>)+/g,function(t){return n(t.split("</div><div>").length+1)})+"</p>"),e=(e=e.replace(/<\/div><div>/g,"<br>")).replace(/<\/?div>/g,"")),CKEDITOR.env.gecko&&t.enterMode!=CKEDITOR.ENTER_BR&&(CKEDITOR.env.gecko&&(e=e.replace(/^<br><br>$/,"<br>")),-1<e.indexOf("<br><br>")&&(e="<p>"+e.replace(/(<br>){2,}/g,function(t){return n(t.length/4)})+"</p>")),function(t,e){return t.enterMode==CKEDITOR.ENTER_BR?e=e.replace(/(<\/p><p>)+/g,function(t){return CKEDITOR.tools.repeat("<br>",t.length/7*2)}).replace(/<\/?p>/g,""):t.enterMode==CKEDITOR.ENTER_DIV&&(e=e.replace(/<(\/)?p>/g,"<$1div>")),e}(t,e))}function i(t,e,n){e=CKEDITOR.htmlParser.fragment.fromHtml(e);var i=new CKEDITOR.htmlParser.basicWriter;return n.applyTo(e,!0,!1,t.activeEnterMode),e.writeHtml(i),i.getHtml()}function r(t){t.data.preventDefault(),t.data.$.dataTransfer.dropEffect="none"}function o(e){var n=CKEDITOR.plugins.clipboard;e.on("contentDom",function(){function i(n,i,r){i.select(),t(e,{dataTransfer:r,method:"drop"},1),r.sourceEditor.fire("saveSnapshot"),r.sourceEditor.editable().extractHtmlFromRange(n),r.sourceEditor.getSelection().selectRanges([n]),r.sourceEditor.fire("saveSnapshot")}function r(i,r){i.select(),t(e,{dataTransfer:r,method:"drop"},1),n.resetDragDataTransfer()}function o(t,n,i){var r={$:t.data.$,target:t.data.getTarget()};n&&(r.dragRange=n),i&&(r.dropRange=i),!1===e.fire(t.name,r)&&t.data.preventDefault()}function s(t){return t.type!=CKEDITOR.NODE_ELEMENT&&(t=t.getParent()),t.getChildCount()}var a=e.editable(),l=CKEDITOR.plugins.clipboard.getDropTarget(e),c=e.ui.space("top"),u=e.ui.space("bottom");n.preventDefaultDropOnElement(c),n.preventDefaultDropOnElement(u),a.attachListener(l,"dragstart",o),a.attachListener(e,"dragstart",n.resetDragDataTransfer,n,null,1),a.attachListener(e,"dragstart",function(t){n.initDragDataTransfer(t,e)},null,null,2),a.attachListener(e,"dragstart",function(){var t=n.dragRange=e.getSelection().getRanges()[0];CKEDITOR.env.ie&&10>CKEDITOR.env.version&&(n.dragStartContainerChildCount=t?s(t.startContainer):null,n.dragEndContainerChildCount=t?s(t.endContainer):null)},null,null,100),a.attachListener(l,"dragend",o),a.attachListener(e,"dragend",n.initDragDataTransfer,n,null,1),a.attachListener(e,"dragend",n.resetDragDataTransfer,n,null,100),a.attachListener(l,"dragover",function(t){if(CKEDITOR.env.edge)t.data.preventDefault();else{var e=t.data.getTarget();(e&&e.is&&e.is("html")||CKEDITOR.env.ie&&CKEDITOR.plugins.clipboard.isFileApiSupported&&t.data.$.dataTransfer.types.contains("Files"))&&t.data.preventDefault()}}),a.attachListener(l,"drop",function(t){if(!t.data.$.defaultPrevented&&(t.data.preventDefault(),!e.readOnly)&&(!(i=t.data.getTarget()).isReadOnly()||i.type==CKEDITOR.NODE_ELEMENT&&i.is("html"))){var i=n.getRangeAtDropPosition(t,e),r=n.dragRange;i&&o(t,r,i)}},null,null,9999),a.attachListener(e,"drop",n.initDragDataTransfer,n,null,1),a.attachListener(e,"drop",function(t){if(t=t.data){var o=t.dropRange,s=t.dragRange,a=t.dataTransfer;a.getTransferType(e)==CKEDITOR.DATA_TRANSFER_INTERNAL?setTimeout(function(){n.internalDrop(s,o,a,e)},0):a.getTransferType(e)==CKEDITOR.DATA_TRANSFER_CROSS_EDITORS?i(s,o,a):r(o,a)}},null,null,9999)})}var s;CKEDITOR.plugins.add("clipboard",{requires:"dialog,notification,toolbar",_supportedFileMatchers:[],init:function(t){function r(t){return-1!==CKEDITOR.tools.indexOf(["image/png","image/jpeg","image/gif"],t.type)}function s(e){return CKEDITOR.tools.array.some(t.plugins.clipboard._supportedFileMatchers,function(t){return t(e)})}function a(e){e.length&&(e=CKEDITOR.tools.array.unique(e),e=function(e){return e?t.lang.clipboard.fileFormatNotSupportedNotification.replace(/\${formats\}/g,"<em>"+e+"</em>"):t.lang.clipboard.fileWithoutFormatNotSupportedNotification}((e=CKEDITOR.tools.array.filter(e,function(t){return!!CKEDITOR.tools.trim(t)})).join(", ")),t.showNotification(e,"info",t.config.clipboard_notificationDuration))}var l,c=function(t){function e(){var t,e={};for(t in CKEDITOR.dtd)"$"!=t.charAt(0)&&"div"!=t&&"span"!=t&&(e[t]=1);return e}var n={};return{get:function(i){return"plain-text"==i?n.plainText||(n.plainText=new CKEDITOR.filter(t,"br")):"semantic-content"==i?((i=n.semanticContent)||((i=new CKEDITOR.filter(t,{})).allow({$1:{elements:e(),attributes:!0,styles:!1,classes:!1}}),i=n.semanticContent=i),i):i?new CKEDITOR.filter(t,i):null}}}(t);t.config.forcePasteAsPlainText?l="plain-text":t.config.pasteFilter?l=t.config.pasteFilter:!CKEDITOR.env.webkit||"pasteFilter"in t.config||(l="semantic-content"),t.pasteFilter=c.get(l),e(t),o(t),CKEDITOR.dialog.add("paste",CKEDITOR.getUrl(this.path+"dialogs/paste.js"));var u,h=CKEDITOR.plugins.clipboard.isCustomDataTypesSupported||CKEDITOR.plugins.clipboard.isFileApiSupported;CKEDITOR.plugins.clipboard.addFileMatcher(t,r),t.on("paste",function(t){if(h&&(t=(e=t.data).dataTransfer,!e.dataValue)){for(var e=[],n=0;n<t.getFilesCount();n++){var i=t.getFile(n);s(i)||e.push(i.type)}a(e)}},null,null,1),t.on("paste",function(e){if(h&&t.config.clipboard_handleImages){var n=e.data,i=n.dataTransfer;if(!n.dataValue&&function(t,e){return!(CKEDITOR.env.ie&&t.data.fileTransferCancel||!(CKEDITOR.env.ie||e&&u!==e.id))&&e.isFileTransfer()&&1===e.getFilesCount()}(e,i)&&r(i=i.getFile(0))){var o=new FileReader;o.addEventListener("load",function(){e.data.dataValue='<img src="'+o.result+'" />',t.fire("paste",e.data)},!1),o.addEventListener("abort",function(){CKEDITOR.env.ie&&(e.data.fileTransferCancel=!0),t.fire("paste",e.data)},!1),o.addEventListener("error",function(){CKEDITOR.env.ie&&(e.data.fileTransferCancel=!0),t.fire("paste",e.data)},!1),o.readAsDataURL(i),u=n.dataTransfer.id,e.stop()}}},null,null,1),t.on("paste",function(e){if(e.data.dataTransfer||(e.data.dataTransfer=new CKEDITOR.plugins.clipboard.dataTransfer),!e.data.dataValue){var n=e.data.dataTransfer,i=n.getData("text/html");i?(e.data.dataValue=i,e.data.type="html"):(i=n.getData("text/plain"))&&(e.data.dataValue=t.editable().transformPlainTextToHtml(i),e.data.type="text")}},null,null,1),t.on("paste",function(t){var e=t.data.dataValue,n=CKEDITOR.dtd.$block;if(-1<e.indexOf("Apple-")&&(e=e.replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," "),"html"!=t.data.type&&(e=e.replace(/<span class="Apple-tab-span"[^>]*>([^<]*)<\/span>/gi,function(t,e){return e.replace(/\t/g,"&nbsp;&nbsp; &nbsp;")})),-1<e.indexOf('<br class="Apple-interchange-newline">')&&(t.data.startsWithEOL=1,t.data.preSniffing="html",e=e.replace(/<br class="Apple-interchange-newline">/,"")),e=e.replace(/(<[^>]+) class="Apple-[^"]*"/gi,"$1")),e.match(/^<[^<]+cke_(editable|contents)/i)){var i,r,o=new CKEDITOR.dom.element("div");for(o.setHtml(e);1==o.getChildCount()&&(i=o.getFirst())&&i.type==CKEDITOR.NODE_ELEMENT&&(i.hasClass("cke_editable")||i.hasClass("cke_contents"));)o=r=i;r&&(e=r.getHtml().replace(/<br>$/i,""))}CKEDITOR.env.ie?e=e.replace(/^&nbsp;(?: |\r\n)?<(\w+)/g,function(e,i){return i.toLowerCase()in n?(t.data.preSniffing="html","<"+i):e}):CKEDITOR.env.webkit?e=e.replace(/<\/(\w+)><div><br><\/div>$/,function(e,i){return i in n?(t.data.endsWithEOL=1,"</"+i+">"):e}):CKEDITOR.env.gecko&&(e=e.replace(/(\s)<br>$/,"$1")),t.data.dataValue=e},null,null,3),t.on("paste",function(e){e=e.data;var r,o=t._.nextPasteType||e.type,s=e.dataValue,a=t.config.clipboard_defaultContentType||"html",l=e.dataTransfer.getTransferType(t)==CKEDITOR.DATA_TRANSFER_EXTERNAL,u=!0===t.config.forcePasteAsPlainText;r="html"==o||"html"==e.preSniffing?"html":function(t){if(CKEDITOR.env.webkit){if(!t.match(/^[^<]*$/g)&&!t.match(/^(<div><br( ?\/)?><\/div>|<div>[^<]*<\/div>)*$/gi))return"html"}else if(CKEDITOR.env.ie){if(!t.match(/^([^<]|<br( ?\/)?>)*$/gi)&&!t.match(/^(<p>([^<]|<br( ?\/)?>)*<\/p>|(\r\n))*$/gi))return"html"}else{if(!CKEDITOR.env.gecko)return"html";if(!t.match(/^([^<]|<br( ?\/)?>)*$/gi))return"html"}return"htmlifiedtext"}(s),delete t._.nextPasteType,"htmlifiedtext"==r&&(s=n(t.config,s)),"text"==o&&"html"==r?s=i(t,s,c.get("plain-text")):(l&&t.pasteFilter&&!e.dontFilter||u)&&(s=i(t,s,t.pasteFilter)),e.startsWithEOL&&(s='<br data-cke-eol="1">'+s),e.endsWithEOL&&(s+='<br data-cke-eol="1">'),"auto"==o&&(o="html"==r||"html"==a?"html":"text"),e.type=o,e.dataValue=s,delete e.preSniffing,delete e.startsWithEOL,delete e.endsWithEOL},null,null,6),t.on("paste",function(e){(e=e.data).dataValue&&(t.insertHtml(e.dataValue,e.type,e.range),setTimeout(function(){t.fire("afterPaste")},0))},null,null,1e3),t.on("pasteDialog",function(e){setTimeout(function(){t.openDialog("paste",e.data)},0)})}}),CKEDITOR.plugins.clipboard={addFileMatcher:function(t,e){t.plugins.clipboard._supportedFileMatchers.push(e)},isCustomCopyCutSupported:!(CKEDITOR.env.ie&&16>CKEDITOR.env.version||CKEDITOR.env.iOS&&605>CKEDITOR.env.version),isCustomDataTypesSupported:!CKEDITOR.env.ie||16<=CKEDITOR.env.version,isFileApiSupported:!CKEDITOR.env.ie||9<CKEDITOR.env.version,mainPasteEvent:CKEDITOR.env.ie&&!CKEDITOR.env.edge?"beforepaste":"paste",addPasteButton:function(t,e,n){t.ui.addButton&&(t.ui.addButton(e,n),t._.pasteButtons||(t._.pasteButtons=[]),t._.pasteButtons.push(e))},canClipboardApiBeTrusted:function(t,e){return!!(t.getTransferType(e)!=CKEDITOR.DATA_TRANSFER_EXTERNAL||CKEDITOR.env.chrome&&!t.isEmpty()||CKEDITOR.env.gecko&&(t.getData("text/html")||t.getFilesCount())||CKEDITOR.env.safari&&603<=CKEDITOR.env.version&&!CKEDITOR.env.iOS||CKEDITOR.env.iOS&&605<=CKEDITOR.env.version||CKEDITOR.env.edge&&16<=CKEDITOR.env.version)},getDropTarget:function(t){var e=t.editable();return CKEDITOR.env.ie&&9>CKEDITOR.env.version||e.isInline()?e:t.document},fixSplitNodesAfterDrop:function(t,e,n,i){function r(t,n,i){var r=t;if(r.type==CKEDITOR.NODE_TEXT&&(r=t.getParent()),r.equals(n)&&i!=n.getChildCount())return t=e.startContainer.getChild(e.startOffset-1),n=e.startContainer.getChild(e.startOffset),t&&t.type==CKEDITOR.NODE_TEXT&&n&&n.type==CKEDITOR.NODE_TEXT&&(i=t.getLength(),t.setText(t.getText()+n.getText()),n.remove(),e.setStart(t,i),e.collapse(!0)),!0}var o=e.startContainer;"number"==typeof i&&"number"==typeof n&&o.type==CKEDITOR.NODE_ELEMENT&&(r(t.startContainer,o,n)||r(t.endContainer,o,i))},isDropRangeAffectedByDragRange:function(t,e){var n=e.startContainer,i=e.endOffset;return!!(t.endContainer.equals(n)&&t.endOffset<=i||t.startContainer.getParent().equals(n)&&t.startContainer.getIndex()<i||t.endContainer.getParent().equals(n)&&t.endContainer.getIndex()<i)},internalDrop:function(e,n,i,r){var o,s,a=CKEDITOR.plugins.clipboard,l=r.editable();r.fire("saveSnapshot"),r.fire("lockSnapshot",{dontUpdate:1}),CKEDITOR.env.ie&&10>CKEDITOR.env.version&&this.fixSplitNodesAfterDrop(e,n,a.dragStartContainerChildCount,a.dragEndContainerChildCount),(s=this.isDropRangeAffectedByDragRange(e,n))||(o=e.createBookmark(!1)),a=n.clone().createBookmark(!1),s&&(o=e.createBookmark(!1)),e=o.startNode,n=o.endNode,s=a.startNode,n&&e.getPosition(s)&CKEDITOR.POSITION_PRECEDING&&n.getPosition(s)&CKEDITOR.POSITION_FOLLOWING&&s.insertBefore(e),(e=r.createRange()).moveToBookmark(o),l.extractHtmlFromRange(e,1),n=r.createRange(),a.startNode.getCommonAncestor(l)||(a=r.getSelection().createBookmarks()[0]),n.moveToBookmark(a),t(r,{dataTransfer:i,method:"drop",range:n},1),r.fire("unlockSnapshot")},getRangeAtDropPosition:function(t,e){var n=t.data.$,i=n.clientX,r=n.clientY,o=e.getSelection(!0).getRanges()[0],s=e.createRange();if(t.data.testRange)return t.data.testRange;if(document.caretRangeFromPoint&&e.document.$.caretRangeFromPoint(i,r))n=e.document.$.caretRangeFromPoint(i,r),s.setStart(CKEDITOR.dom.node(n.startContainer),n.startOffset),s.collapse(!0);else if(n.rangeParent)s.setStart(CKEDITOR.dom.node(n.rangeParent),n.rangeOffset),s.collapse(!0);else{if(CKEDITOR.env.ie&&8<CKEDITOR.env.version&&o&&e.editable().hasFocus)return o;if(!document.body.createTextRange)return null;e.focus(),n=e.document.getBody().$.createTextRange();try{for(var a=!1,l=0;20>l&&!a;l++){if(!a)try{n.moveToPoint(i,r-l),a=!0}catch(f){}if(!a)try{n.moveToPoint(i,r+l),a=!0}catch(p){}}if(a){var c="cke-temp-"+(new Date).getTime();n.pasteHTML('<span id="'+c+'">\u200b</span>');var u=e.document.getById(c);s.moveToPosition(u,CKEDITOR.POSITION_BEFORE_START),u.remove()}else{var h=e.document.$.elementFromPoint(i,r),d=new CKEDITOR.dom.element(h);if(d.equals(e.editable())||"html"==d.getName())return o&&o.startContainer&&!o.startContainer.equals(e.editable())?o:null;i<d.getClientRect().left?s.setStartAt(d,CKEDITOR.POSITION_AFTER_START):s.setStartAt(d,CKEDITOR.POSITION_BEFORE_END),s.collapse(!0)}}catch(g){return null}}return s},initDragDataTransfer:function(t,e){var n=t.data.$?t.data.$.dataTransfer:null,i=new this.dataTransfer(n,e);"dragstart"===t.name&&i.storeId(),n?this.dragData&&i.id==this.dragData.id?i=this.dragData:this.dragData=i:this.dragData?i=this.dragData:this.dragData=i,t.data.dataTransfer=i},resetDragDataTransfer:function(){this.dragData=null},initPasteDataTransfer:function(t,e){if(this.isCustomCopyCutSupported){if(t&&t.data&&t.data.$){var n=t.data.$.clipboardData,i=new this.dataTransfer(n,e);return"copy"!==t.name&&"cut"!==t.name||i.storeId(),this.copyCutData&&i.id==this.copyCutData.id?(i=this.copyCutData).$=n:this.copyCutData=i,i}return new this.dataTransfer(null,e)}return new this.dataTransfer(CKEDITOR.env.edge&&t&&t.data.$&&t.data.$.clipboardData||null,e)},preventDefaultDropOnElement:function(t){t&&t.on("dragover",r)}},s=CKEDITOR.plugins.clipboard.isCustomDataTypesSupported?"cke/id":"Text",CKEDITOR.plugins.clipboard.dataTransfer=function(t,e){t&&(this.$=t),this._={metaRegExp:/^<meta.*?>/i,fragmentRegExp:/\s*\x3c!--StartFragment--\x3e|\x3c!--EndFragment--\x3e\s*/g,types:[],data:{},files:[],nativeHtmlCache:"",normalizeType:function(t){return"text"==(t=t.toLowerCase())||"text/plain"==t?"Text":"url"==t?"URL":"files"===t?"Files":t}},this._.fallbackDataTransfer=new CKEDITOR.plugins.clipboard.fallbackDataTransfer(this),this.id=this.getData(s),this.id||(this.id="Text"==s?"":"cke-"+CKEDITOR.tools.getUniqueId()),e&&(this.sourceEditor=e,this.setData("text/html",e.getSelectedHtml(1)),"Text"==s||this.getData("text/plain")||this.setData("text/plain",e.getSelection().getSelectedText()))},CKEDITOR.DATA_TRANSFER_INTERNAL=1,CKEDITOR.DATA_TRANSFER_CROSS_EDITORS=2,CKEDITOR.DATA_TRANSFER_EXTERNAL=3,CKEDITOR.plugins.clipboard.dataTransfer.prototype={getData:function(t,e){if(null==(i="text/html"==(t=this._.normalizeType(t))&&e?this._.nativeHtmlCache:this._.data[t])||""===i){if(this._.fallbackDataTransfer.isRequired())i=this._.fallbackDataTransfer.getData(t,e);else try{i=this.$.getData(t)||""}catch(s){i=""}"text/html"!=t||e||(i=this._stripHtml(i))}if("Text"==t&&CKEDITOR.env.gecko&&this.getFilesCount()&&"file://"==i.substring(0,7)&&(i=""),"string"==typeof i)var n=i.indexOf("</html>"),i=-1!==n?i.substring(0,n+7):i;return i},setData:function(t,e){if("text/html"==(t=this._.normalizeType(t))?(this._.data[t]=this._stripHtml(e),this._.nativeHtmlCache=e):this._.data[t]=e,CKEDITOR.plugins.clipboard.isCustomDataTypesSupported||"URL"==t||"Text"==t)if("Text"==s&&"Text"==t&&(this.id=e),this._.fallbackDataTransfer.isRequired())this._.fallbackDataTransfer.setData(t,e);else try{this.$.setData(t,e)}catch(o){}},storeId:function(){"Text"!==s&&this.setData(s,this.id)},getTransferType:function(t){return this.sourceEditor?this.sourceEditor==t?CKEDITOR.DATA_TRANSFER_INTERNAL:CKEDITOR.DATA_TRANSFER_CROSS_EDITORS:CKEDITOR.DATA_TRANSFER_EXTERNAL},cacheData:function(){function t(t){t=r._.normalizeType(t);var e=r.getData(t);"text/html"==t&&(r._.nativeHtmlCache=r.getData(t,!0),e=r._stripHtml(e)),e&&(r._.data[t]=e),r._.types.push(t)}if(this.$){var e,n,i,r=this;if(CKEDITOR.plugins.clipboard.isCustomDataTypesSupported){if(this.$.types)for(e=0;e<this.$.types.length;e++)t(this.$.types[e])}else t("Text"),t("URL");if(n=this._getImageFromClipboard(),(i=this.$&&this.$.files||null)||n){if(this._.files=[],i&&i.length)for(e=0;e<i.length;e++)this._.files.push(i[e]);0===this._.files.length&&n&&this._.files.push(n)}}},getFilesCount:function(){if(this._.files.length)return this._.files.length;var t=this.$&&this.$.files||null;return t&&t.length?t.length:this._getImageFromClipboard()?1:0},getFile:function(t){if(this._.files.length)return this._.files[t];var e=this.$&&this.$.files||null;return e&&e.length?e[t]:0===t?this._getImageFromClipboard():void 0},isFileTransfer:function(){var t=this.getTypes();return 1===(t=CKEDITOR.tools.array.filter(t,function(t){return"application/x-moz-file"!==t})).length&&"files"===t[0].toLowerCase()},isEmpty:function(){var t,e={};if(this.getFilesCount())return!1;if(CKEDITOR.tools.array.forEach(CKEDITOR.tools.object.keys(this._.data),function(t){e[t]=1}),this.$)if(CKEDITOR.plugins.clipboard.isCustomDataTypesSupported){if(this.$.types)for(var n=0;n<this.$.types.length;n++)e[this.$.types[n]]=1}else e.Text=1,e.URL=1;for(t in"Text"!=s&&(e[s]=0),e)if(e[t]&&""!==this.getData(t))return!1;return!0},getTypes:function(){return 0<this._.types.length?this._.types:this.$&&this.$.types?[].slice.call(this.$.types):[]},_getImageFromClipboard:function(){var e;try{if(this.$&&this.$.items&&this.$.items[0]&&(e=this.$.items[0].getAsFile())&&e.type)return e}catch(t){}},_stripHtml:function(t){return t&&t.length&&(t=function(t){var e,n,i=new CKEDITOR.htmlParser;return i.onTagOpen=function(t){"body"===t&&(e=i._.htmlPartsRegex.lastIndex)},i.onTagClose=function(t){"body"===t&&(n=i._.htmlPartsRegex.lastIndex)},i.parse(t),"number"!=typeof e||"number"!=typeof n?t:t.substring(e,n).replace(/<\/body\s*>$/gi,"")}(t),t=(t=t.replace(this._.metaRegExp,"")).replace(this._.fragmentRegExp,"")),t}},CKEDITOR.plugins.clipboard.fallbackDataTransfer=function(t){this._dataTransfer=t,this._customDataFallbackType="text/html"},CKEDITOR.plugins.clipboard.fallbackDataTransfer._isCustomMimeTypeSupported=null,CKEDITOR.plugins.clipboard.fallbackDataTransfer._customTypes=[],CKEDITOR.plugins.clipboard.fallbackDataTransfer.prototype={isRequired:function(){var t=CKEDITOR.plugins.clipboard.fallbackDataTransfer,e=this._dataTransfer.$;if(null===t._isCustomMimeTypeSupported){if(!e)return!1;if(t._isCustomMimeTypeSupported=!1,CKEDITOR.env.edge&&17<=CKEDITOR.env.version)return!0;try{e.setData("cke/mimetypetest","cke test value"),t._isCustomMimeTypeSupported="cke test value"===e.getData("cke/mimetypetest"),e.clearData("cke/mimetypetest")}catch(o){}}return!t._isCustomMimeTypeSupported},getData:function(t,e){var n=this._getData(this._customDataFallbackType,!0);if(e)return n;n=this._extractDataComment(n);var i=null;return null!==(i=t===this._customDataFallbackType?n.content:n.data&&n.data[t]?n.data[t]:this._getData(t,!0))?i:""},setData:function(t,n){(o=t===this._customDataFallbackType)&&(n=this._applyDataComment(n,this._getFallbackTypeData()));var i=n,r=this._dataTransfer.$;try{r.setData(t,i),o&&(this._dataTransfer._.nativeHtmlCache=i)}catch(g){if(this._isUnsupportedMimeTypeError(g)){o=CKEDITOR.plugins.clipboard.fallbackDataTransfer,-1===CKEDITOR.tools.indexOf(o._customTypes,t)&&o._customTypes.push(t);var o=this._getFallbackTypeContent(),s=this._getFallbackTypeData();s[t]=i;try{i=this._applyDataComment(o,s),r.setData(this._customDataFallbackType,i),this._dataTransfer._.nativeHtmlCache=i}catch(e){i=""}}}return i},_getData:function(t,e){var n=this._dataTransfer._.data;if(!e&&n[t])return n[t];try{return this._dataTransfer.$.getData(t)}catch(s){return null}},_getFallbackTypeContent:function(){var t=this._dataTransfer._.data[this._customDataFallbackType];return t||(t=this._extractDataComment(this._getData(this._customDataFallbackType,!0)).content),t},_getFallbackTypeData:function(){var t=CKEDITOR.plugins.clipboard.fallbackDataTransfer._customTypes,e=this._extractDataComment(this._getData(this._customDataFallbackType,!0)).data||{},n=this._dataTransfer._.data;return CKEDITOR.tools.array.forEach(t,function(t){void 0!==n[t]?e[t]=n[t]:void 0!==e[t]&&(e[t]=e[t])},this),e},_isUnsupportedMimeTypeError:function(t){return t.message&&-1!==t.message.search(/element not found/gi)},_extractDataComment:function(t){var e,n={data:null,content:t||""};t&&16<t.length&&((e=/\x3c!--cke-data:(.*?)--\x3e/g.exec(t))&&e[1]&&(n.data=JSON.parse(decodeURIComponent(e[1])),n.content=t.replace(e[0],"")));return n},_applyDataComment:function(t,e){var n="";return e&&CKEDITOR.tools.object.keys(e).length&&(n="\x3c!--cke-data:"+encodeURIComponent(JSON.stringify(e))+"--\x3e"),n+(t&&t.length?t:"")}}}(),CKEDITOR.config.clipboard_notificationDuration=1e4,CKEDITOR.config.clipboard_handleImages=!0,function(){function t(t){return t.getName&&!t.hasAttribute("data-cke-temp")}CKEDITOR.plugins.add("widgetselection",{init:function(t){if(CKEDITOR.env.webkit){var e=CKEDITOR.plugins.widgetselection;t.on("contentDom",function(t){var n=(t=t.editor).editable();n.attachListener(n,"keydown",function(t){t.data.getKeystroke()==CKEDITOR.CTRL+65&&CKEDITOR.tools.setTimeout(function(){e.addFillers(n)||e.removeFillers(n)},0)},null,null,-1),t.on("selectionCheck",function(t){e.removeFillers(t.editor.editable())}),t.on("paste",function(t){t.data.dataValue=e.cleanPasteData(t.data.dataValue)}),"selectall"in t.plugins&&e.addSelectAllIntegration(t)})}}}),CKEDITOR.plugins.widgetselection={startFiller:null,endFiller:null,fillerAttribute:"data-cke-filler-webkit",fillerContent:"&nbsp;",fillerTagName:"div",addFillers:function(e){var n=e.editor;if(!this.isWholeContentSelected(e)&&0<e.getChildCount()){var i=e.getFirst(t),r=e.getLast(t);if(i&&i.type==CKEDITOR.NODE_ELEMENT&&!i.isEditable()&&(this.startFiller=this.createFiller(),e.append(this.startFiller,1)),r&&r.type==CKEDITOR.NODE_ELEMENT&&!r.isEditable()&&(this.endFiller=this.createFiller(!0),e.append(this.endFiller,0)),this.hasFiller(e))return(n=n.createRange()).selectNodeContents(e),n.select(),!0}return!1},removeFillers:function(t){if(this.hasFiller(t)&&!this.isWholeContentSelected(t)){var e=t.findOne(this.fillerTagName+"["+this.fillerAttribute+"=start]"),n=t.findOne(this.fillerTagName+"["+this.fillerAttribute+"=end]");this.startFiller&&e&&this.startFiller.equals(e)?this.removeFiller(this.startFiller,t):this.startFiller=e,this.endFiller&&n&&this.endFiller.equals(n)?this.removeFiller(this.endFiller,t):this.endFiller=n}},cleanPasteData:function(t){return t&&t.length&&(t=t.replace(this.createFillerRegex(),"").replace(this.createFillerRegex(!0),"")),t},isWholeContentSelected:function(t){var e=t.editor.getSelection().getRanges()[0];return!(!e||e&&e.collapsed)&&((e=e.clone()).enlarge(CKEDITOR.ENLARGE_ELEMENT),!!(e&&t&&e.startContainer&&e.endContainer&&0===e.startOffset&&e.endOffset===t.getChildCount()&&e.startContainer.equals(t)&&e.endContainer.equals(t)))},hasFiller:function(t){return 0<t.find(this.fillerTagName+"["+this.fillerAttribute+"]").count()},createFiller:function(t){var e=new CKEDITOR.dom.element(this.fillerTagName);return e.setHtml(this.fillerContent),e.setAttribute(this.fillerAttribute,t?"end":"start"),e.setAttribute("data-cke-temp",1),e.setStyles({display:"block",width:0,height:0,padding:0,border:0,margin:0,position:"absolute",top:0,left:"-9999px",opacity:0,overflow:"hidden"}),e},removeFiller:function(t,e){if(t){var n,i,r=e.editor,o=e.editor.getSelection().getRanges()[0].startPath(),s=r.createRange();o.contains(t)&&(n=t.getHtml(),i=!0),o="start"==t.getAttribute(this.fillerAttribute),t.remove(),n&&0<n.length&&n!=this.fillerContent?(e.insertHtmlIntoRange(n,r.getSelection().getRanges()[0]),s.setStartAt(e.getChild(e.getChildCount()-1),CKEDITOR.POSITION_BEFORE_END),r.getSelection().selectRanges([s])):i&&(o?s.setStartAt(e.getFirst().getNext(),CKEDITOR.POSITION_AFTER_START):s.setEndAt(e.getLast().getPrevious(),CKEDITOR.POSITION_BEFORE_END),e.editor.getSelection().selectRanges([s]))}},createFillerRegex:function(t){var e=this.createFiller(t).getOuterHtml().replace(/style="[^"]*"/gi,'style="[^"]*"').replace(/>[^<]*</gi,">[^<]*<");return new RegExp((t?"":"^")+e+(t?"$":""))},addSelectAllIntegration:function(t){var e=this;t.editable().attachListener(t,"beforeCommandExec",function(n){var i=t.editable();"selectAll"==n.data.name&&i&&e.addFillers(i)},null,null,9999)}}}(),function(){function t(t){this.editor=t,this.registered={},this.instances={},this.selected=[],this.widgetHoldingFocusedEditable=this.focused=null,this._={nextId:0,upcasts:[],upcastCallbacks:[],filters:{}},function(t){var n,i,r=t.editor;r.on("toHtml",function(i){var r,o=function(t){var n=[],i=t._.upcasts,r=t._.upcastCallbacks;return{toBeWrapped:n,iterator:function(t){var o,s,a,l,c;if("data-cke-widget-wrapper"in t.attributes)return(t=t.getFirst(e.isParserWidgetElement))&&n.push([t]),!1;if("data-widget"in t.attributes)return n.push([t]),!1;if(c=i.length){if(t.attributes["data-cke-widget-upcasted"])return!1;for(l=0,o=r.length;l<o;++l)if(!1===r[l](t))return;for(l=0;l<c;++l)if(a={},s=(o=i[l])[0](t,a))return s instanceof CKEDITOR.htmlParser.element&&(t=s),t.attributes["data-cke-widget-data"]=encodeURIComponent(JSON.stringify(a)),t.attributes["data-cke-widget-upcasted"]=1,n.push([t,o[1]]),!1}}}}(t);for(i.data.dataValue.forEach(o.iterator,CKEDITOR.NODE_ELEMENT,!0);r=o.toBeWrapped.pop();){var s=r[0],a=s.parent;a.type==CKEDITOR.NODE_ELEMENT&&a.attributes["data-cke-widget-wrapper"]&&a.replaceWith(s),t.wrapElement(r[0],r[1])}n=i.data.protectedWhitespaces?3==i.data.dataValue.children.length&&e.isParserWidgetWrapper(i.data.dataValue.children[1]):1==i.data.dataValue.children.length&&e.isParserWidgetWrapper(i.data.dataValue.children[0])},null,null,8),r.on("dataReady",function(){if(i)for(var n,o,s=r.editable().find(".cke_widget_wrapper"),a=0,l=s.count();a<l;++a)(o=(n=s.getItem(a)).getFirst(e.isDomWidgetElement)).type==CKEDITOR.NODE_ELEMENT&&o.data("widget")?(o.replace(n),t.wrapElement(o)):n.remove();i=0,t.destroyAll(!0),t.initOnAll()}),r.on("loadSnapshot",function(e){/data-cke-widget/.test(e.data)&&(i=1),t.destroyAll(!0)},null,null,9),r.on("paste",function(t){(t=t.data).dataValue=t.dataValue.replace(S,p),t.range&&(t=e.getNestedEditable(r.editable(),t.range.startContainer))&&(t=CKEDITOR.filter.instances[t.data("cke-filter")])&&r.setActiveFilter(t)}),r.on("afterInsertHtml",function(e){e.data.intoRange?t.checkWidgets({initOnlyNew:!0}):(r.fire("lockSnapshot"),t.checkWidgets({initOnlyNew:!0,focusInited:n}),r.fire("unlockSnapshot"))})}(this),function(t){var n=t.editor,i={};n.on("toDataFormat",function(n){var r=CKEDITOR.tools.getNextNumber(),o=[];n.data.downcastingSessionId=r,i[r]=o,n.data.dataValue.forEach(function(n){var i,r=n.attributes;if("data-cke-widget-white-space"in r){i=s(n);var l=a(n);i.parent.attributes["data-cke-white-space-first"]&&(i.value=i.value.replace(/^&nbsp;/g," ")),l.parent.attributes["data-cke-white-space-last"]&&(l.value=l.value.replace(/&nbsp;$/g," "))}if("data-cke-widget-id"in r)(r=t.instances[r["data-cke-widget-id"]])&&(i=n.getFirst(e.isParserWidgetElement),o.push({wrapper:n,element:i,widget:r,editables:{}}),"1"!=i.attributes["data-cke-widget-keep-attr"]&&delete i.attributes["data-widget"]);else if("data-cke-widget-editable"in r)return 0<o.length&&(o[o.length-1].editables[r["data-cke-widget-editable"]]=n),!1},CKEDITOR.NODE_ELEMENT,!0)},null,null,8),n.on("toDataFormat",function(t){if(t.data.downcastingSessionId)for(var e,n,r,o,s,a,l=i[t.data.downcastingSessionId];e=l.shift();){for(a in n=e.widget,r=e.element,o=n._.downcastFn&&n._.downcastFn.call(n,r),t.data.widgetsCopy&&n.getClipboardHtml&&(o=(o=CKEDITOR.htmlParser.fragment.fromHtml(n.getClipboardHtml())).children[0]),e.editables)delete(s=e.editables[a]).attributes.contenteditable,s.setHtml(n.editables[a].getData());o||(o=r),e.wrapper.replaceWith(o)}},null,null,13),n.on("contentDomUnload",function(){t.destroyAll(!0)})}(this),this.on("checkWidgets",r),this.editor.on("contentDomInvalidated",this.checkWidgets,this),function(t){function n(){var t=s.getSelection();if(t&&(t=t.getRanges()[0])&&!t.collapsed){var e=r(t.startContainer),n=r(t.endContainer);!e&&n?(t.setEndBefore(n.wrapper),t.select()):e&&!n&&(t.setStartAfter(e.wrapper),t.select())}}function r(t){return t?t.type==CKEDITOR.NODE_TEXT?r(t.getParent()):s.widgets.getByElement(t):null}function o(){t.fire("checkSelection")}var s=t.editor;s.on("selectionCheck",o),s.on("contentDom",function(){s.editable().attachListener(s,"key",function(){setTimeout(o,10)})}),CKEDITOR.env.ie||t.on("checkSelection",n);t.on("checkSelection",t.checkSelection,t),s.on("selectionChange",function(n){var i=(n=e.getNestedEditable(s.editable(),n.data.selection.getStartElement()))&&t.getByElement(n),r=t.widgetHoldingFocusedEditable;r?r===i&&r.focusedEditable.equals(n)||(f(t,r,null),i&&n&&f(t,i,n)):i&&n&&f(t,i,n)}),s.on("dataReady",function(){g(t).commit()}),s.on("blur",function(){var e;(e=t.focused)&&i(t,e),(e=t.widgetHoldingFocusedEditable)&&f(t,e,null)})}(this),function(t){var n=t.editor;n.on("contentDom",function(){var i,r,o=n.editable(),s=o.isInline()?o:n.document;o.attachListener(s,"mousedown",function(o){var s=o.data.getTarget();i=s instanceof CKEDITOR.dom.element?t.getByElement(s):null,r=0,i&&(i.inline&&s.type==CKEDITOR.NODE_ELEMENT&&s.hasAttribute("data-cke-widget-drag-handler")?(r=1,t.focused!=i&&n.getSelection().removeAllRanges()):e.getNestedEditable(i.wrapper,s)?i=null:(o.data.preventDefault(),CKEDITOR.env.ie||i.focus()))}),o.attachListener(s,"mouseup",function(){r&&i&&i.wrapper&&(r=0,i.focus())}),CKEDITOR.env.ie&&o.attachListener(s,"mouseup",function(){setTimeout(function(){i&&i.wrapper&&o.contains(i.wrapper)&&(i.focus(),i=null)})})}),n.on("doubleclick",function(n){var i=t.getByElement(n.data.element);if(i&&!e.getNestedEditable(i.wrapper,n.data.element))return i.fire("doubleclick",{element:n.data.element})},null,null,1)}(this),function(t){t.editor.on("key",function(e){var n,i=t.focused,r=t.widgetHoldingFocusedEditable;return i?n=i.fire("key",{keyCode:e.data.keyCode}):r&&(i=e.data.keyCode,e=r.focusedEditable,i==CKEDITOR.CTRL+65?(i=e.getBogus(),(r=r.editor.createRange()).selectNodeContents(e),i&&r.setEndAt(i,CKEDITOR.POSITION_BEFORE_START),r.select(),n=!1):8==i||46==i?(n=r.editor.getSelection().getRanges(),r=n[0],n=!(1==n.length&&r.collapsed&&r.checkBoundaryOfElement(e,CKEDITOR[8==i?"START":"END"]))):n=void 0),n},null,null,1)}(this),function(t){var n=t.editor,i=CKEDITOR.plugins.lineutils;n.on("dragstart",function(i){var r=i.data.target;e.isDomDragHandler(r)&&(r=t.getByElement(r),i.data.dataTransfer.setData("cke/widget-id",r.id),n.focus(),r.focus())}),n.on("drop",function(e){function i(t,e){return!(!t||!e)&&(t.wrapper.equals(e.wrapper)||t.wrapper.contains(e.wrapper))}var r=(s=e.data.dataTransfer).getData("cke/widget-id"),o=s.getTransferType(n),s=n.createRange(),a=function(t){return(t=t.getBoundaryNodes().startNode).type!==CKEDITOR.NODE_ELEMENT&&(t=t.getParent()),n.widgets.getByElement(t)}(e.data.dropRange);""!==r&&o===CKEDITOR.DATA_TRANSFER_CROSS_EDITORS?e.cancel():o==CKEDITOR.DATA_TRANSFER_INTERNAL&&(""===r&&0<n.widgets.selected.length?e.data.dataTransfer.setData("text/html",T(n)):(r=t.instances[r])&&(i(r,a)?e.cancel():(s.setStartBefore(r.wrapper),s.setEndAfter(r.wrapper),e.data.dragRange=s,delete CKEDITOR.plugins.clipboard.dragStartContainerChildCount,delete CKEDITOR.plugins.clipboard.dragEndContainerChildCount,e.data.dataTransfer.setData("text/html",r.getClipboardHtml()),n.widgets.destroy(r,!0))))}),n.on("contentDom",function(){var r=n.editable();CKEDITOR.tools.extend(t,{finder:new i.finder(n,{lookups:{default:function(n){if(!n.is(CKEDITOR.dtd.$listItem)&&n.is(CKEDITOR.dtd.$block)&&!e.isDomNestedEditable(n)&&!t._.draggedWidget.wrapper.contains(n)){var i=e.getNestedEditable(r,n);if(i){if(n=t._.draggedWidget,t.getByElement(i)==n)return;if(i=CKEDITOR.filter.instances[i.data("cke-filter")],n=n.requiredContent,i&&n&&!i.check(n))return}return CKEDITOR.LINEUTILS_BEFORE|CKEDITOR.LINEUTILS_AFTER}}}}),locator:new i.locator(n),liner:new i.liner(n,{lineStyle:{cursor:"move !important","border-top-color":"#666"},tipLeftStyle:{"border-left-color":"#666"},tipRightStyle:{"border-right-color":"#666"}})},!0)})}(this),function(t){function e(e){1>t.selected.length||b(n,"cut"===e.name)}var n=t.editor;n.on("contentDom",function(){var t=n.editable();t.attachListener(t,"copy",e),t.attachListener(t,"cut",e)})}(this)}function e(t,n,i,r,o){var s=t.editor;CKEDITOR.tools.extend(this,r,{editor:s,id:n,inline:"span"==i.getParent().getName(),element:i,data:CKEDITOR.tools.extend({},"function"==typeof r.defaults?r.defaults():r.defaults),dataReady:!1,inited:!1,ready:!1,edit:e.prototype.edit,focusedEditable:null,definition:r,repository:t,draggable:!1!==r.draggable,_:{downcastFn:r.downcast&&"string"==typeof r.downcast?r.downcasts[r.downcast]:r.downcast}},!0),t.fire("instanceCreated",this),function(t,n){var i=t.editor.config.widget_keystrokeInsertLineBefore,r=t.editor.config.widget_keystrokeInsertLineAfter;(function(t){(t.wrapper=t.element.getParent()).setAttribute("data-cke-widget-id",t.id)})(t),w(t),function(t){var e,n,i=t.editables;if(t.editables={},t.editables)for(e in i)n=i[e],t.initEditable(e,"string"==typeof n?{selector:n}:n)}(t),x(t),function(t){if(t.draggable){var n,i=t.editor,r=t.wrapper.getLast(e.isDomDragHandlerContainer);r?n=r.findOne("img"):((r=new CKEDITOR.dom.element("span",i.document)).setAttributes({class:"cke_reset cke_widget_drag_handler_container",style:"background:rgba(220,220,220,0.5);background-image:url("+i.plugins.widget.path+"images/handle.png);display:none;"}),(n=new CKEDITOR.dom.element("img",i.document)).setAttributes({class:"cke_reset cke_widget_drag_handler","data-cke-widget-drag-handler":"1",src:CKEDITOR.tools.transparentImageData,width:15,title:i.lang.widget.move,height:15,role:"presentation"}),t.inline&&n.setAttribute("draggable","true"),r.append(n),t.wrapper.append(r)),t.wrapper.on("dragover",function(t){t.data.preventDefault()}),t.wrapper.on("mouseenter",t.updateDragHandlerPosition,t),setTimeout(function(){t.on("data",t.updateDragHandlerPosition,t)},50),!t.inline&&(n.on("mousedown",D,t),CKEDITOR.env.ie&&9>CKEDITOR.env.version)&&n.on("dragstart",function(t){t.data.preventDefault(!0)}),t.dragHandlerContainer=r}}(t),function(t){var e=null;t.on("data",function(){var t,n=this.data.classes;if(e!=n){for(t in e)n&&n[t]||this.removeClass(t);for(t in n)this.addClass(t);e=n}})}(t),function(t){t.on("data",function(){if(t.wrapper){var e=this.getLabel?this.getLabel():this.editor.lang.widget.label.replace(/%1/,this.pathName||this.element.getName());t.wrapper.setAttribute("role","region"),t.wrapper.setAttribute("aria-label",e)}},null,null,9999)}(t),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&t.wrapper.on("dragstart",function(n){var i=n.data.getTarget();e.getNestedEditable(t,i)||t.inline&&e.isDomDragHandler(i)||n.data.preventDefault()});t.wrapper.removeClass("cke_widget_new"),t.element.addClass("cke_widget_element"),t.on("key",function(e){if((e=e.data.keyCode)==i)y(t,"before"),t.editor.fire("saveSnapshot");else if(e==r)y(t,"after"),t.editor.fire("saveSnapshot");else if(13==e)t.edit();else{if(e==CKEDITOR.CTRL+67||e==CKEDITOR.CTRL+88)return void b(t.editor,e==CKEDITOR.CTRL+88);if(e in R||CKEDITOR.CTRL&e||CKEDITOR.ALT&e)return}return!1},null,null,999),t.on("doubleclick",function(e){t.edit()&&e.cancel()}),n.data&&t.on("data",n.data);n.edit&&t.on("edit",n.edit)}(this,r),this.init&&this.init(),this.inited=!0,(t=this.element.data("cke-widget-data"))&&this.setData(JSON.parse(decodeURIComponent(t))),o&&this.setData(o),this.data.classes||this.setData("classes",this.getClasses()),this.dataReady=!0,A(this),this.fire("data",this.data),this.isInited()&&s.editable().contains(this.wrapper)&&(this.ready=!0,this.fire("ready"))}function n(t,e,n){CKEDITOR.dom.element.call(this,e.$),this.editor=t,this._={},e=this.filter=n.filter,CKEDITOR.dtd[this.getName()].p?(this.enterMode=e?e.getAllowedEnterMode(t.enterMode):t.enterMode,this.shiftEnterMode=e?e.getAllowedEnterMode(t.shiftEnterMode,!0):t.shiftEnterMode):this.enterMode=this.shiftEnterMode=CKEDITOR.ENTER_BR}function i(t,e){if(t.focused=null,e.isInited()){var n=e.editor.checkDirty();t.fire("widgetBlurred",{widget:e}),e.setFocused(!1),!n&&e.editor.resetDirty()}}function r(t){if(t=t.data,"wysiwyg"==this.editor.mode){var n,i,r,o,s=this.editor.editable(),a=this.instances;if(s){for(n in a)a[n].isReady()&&!s.contains(a[n].wrapper)&&this.destroy(a[n],!0);if(t&&t.initOnlyNew)a=this.initOnAll();else{var l=s.find(".cke_widget_wrapper");a=[];for(n=0,i=l.count();n<i;n++){if(r=l.getItem(n),o=!this.getByElement(r,!0)){t:{o=d;for(var c=r;c=c.getParent();)if(o(c)){o=!0;break t}o=!1}o=!o}o&&s.contains(r)&&(r.addClass("cke_widget_new"),a.push(this.initOn(r.getFirst(e.isDomWidgetElement))))}}t&&t.focusInited&&1==a.length&&a[0].focus()}}}function o(t){if(void 0!==t.attributes&&t.attributes["data-widget"]){var e=s(t),n=a(t),i=!1;e&&e.value&&e.value.match(/^\s/g)&&(e.parent.attributes["data-cke-white-space-first"]=1,e.value=e.value.replace(/^\s/g,"&nbsp;"),i=!0),n&&n.value&&n.value.match(/\s$/g)&&(n.parent.attributes["data-cke-white-space-last"]=1,n.value=n.value.replace(/\s$/g,"&nbsp;"),i=!0),i&&(t.attributes["data-cke-widget-white-space"]=1)}}function s(t){return t.find(function(t){return 3===t.type},!0).shift()}function a(t){return t.find(function(t){return 3===t.type},!0).pop()}function l(t,e,n){if(!n.allowedContent&&!n.disallowedContent)return null;var i=this._.filters[t];return i||(this._.filters[t]=i={}),(t=i[e])||(t=n.allowedContent?new CKEDITOR.filter(n.allowedContent):this.editor.filter.clone(),i[e]=t,n.disallowedContent&&t.disallow(n.disallowedContent)),t}function c(t,e){return{tabindex:-1,contenteditable:"false","data-cke-widget-wrapper":1,"data-cke-filter":"off",class:"cke_widget_wrapper cke_widget_new cke_widget_"+(t?"inline":"block")+(e?" cke_widget_"+e:"")}}function u(t,e,n){if(t.type==CKEDITOR.NODE_ELEMENT&&((i=CKEDITOR.dtd[t.name])&&!i[n.name])){var i=t.split(e),r=t.parent;return e=i.getIndex(),t.children.length||(--e,t.remove()),i.children.length||i.remove(),u(r,e,n)}t.add(n,e)}function h(t,e){return"boolean"==typeof t.inline?t.inline:!!CKEDITOR.dtd.$inline[e]}function d(t){return t.hasAttribute("data-cke-temp")}function f(t,e,n,i){var r=t.editor;r.fire("lockSnapshot"),n?(i=n.data("cke-widget-editable"),i=e.editables[i],t.widgetHoldingFocusedEditable=e,e.focusedEditable=i,n.addClass("cke_widget_editable_focused"),i.filter&&r.setActiveFilter(i.filter),r.setActiveEnterMode(i.enterMode,i.shiftEnterMode)):(i||e.focusedEditable.removeClass("cke_widget_editable_focused"),e.focusedEditable=null,t.widgetHoldingFocusedEditable=null,r.setActiveFilter(null),r.setActiveEnterMode(null,null)),r.fire("unlockSnapshot")}function p(t,e){return CKEDITOR.tools.trim(e)}function g(t){var e=t.selected,n=[],r=e.slice(0),o=null;return{select:function(t){return 0>CKEDITOR.tools.indexOf(e,t)&&n.push(t),0<=(t=CKEDITOR.tools.indexOf(r,t))&&r.splice(t,1),this},focus:function(t){return o=t,this},commit:function(){var s,a,l=t.focused!==o;for(t.editor.fire("lockSnapshot"),l&&(s=t.focused)&&i(t,s);s=r.pop();)e.splice(CKEDITOR.tools.indexOf(e,s),1),s.isInited()&&(a=s.editor.checkDirty(),s.setSelected(!1),!a&&s.editor.resetDirty());for(l&&o&&(a=t.editor.checkDirty(),t.focused=o,t.fire("widgetFocused",{widget:o}),o.setFocused(!0),!a&&t.editor.resetDirty());s=n.pop();)e.push(s),s.setSelected(!0);t.editor.fire("unlockSnapshot")}}}function m(t,e,n){var i=0;e=C(e);var r,o=t.data.classes||{};if(e){for(o=CKEDITOR.tools.clone(o);r=e.pop();)n?o[r]||(i=o[r]=1):o[r]&&(delete o[r],i=1);i&&t.setData("classes",o)}}function v(t){t.cancel()}function y(t,e){var n=function(t){return t==CKEDITOR.ENTER_BR?"br":t==CKEDITOR.ENTER_DIV?"div":"p"}(t.editor.config.enterMode),i=new CKEDITOR.dom.element(n);"br"!==n&&i.appendBogus(),"after"===e?i.insertAfter(t.wrapper):i.insertBefore(t.wrapper),function(e){var n=t.editor.createRange();n.setStart(e,0),t.editor.getSelection().selectRanges([n])}(i)}function b(t,e){var n,i,r,o=t.widgets.focused;k.hasCopyBin(t)||(i=new k(t,{beforeDestroy:function(){!e&&o&&o.focus(),r&&t.getSelection().selectBookmarks(r),n&&CKEDITOR.plugins.widgetselection.addFillers(t.editable())},afterDestroy:function(){e&&!t.readOnly&&(o?t.widgets.del(o):t.extractSelectedHtml(),t.fire("saveSnapshot"))}}),o||(n=CKEDITOR.env.webkit&&CKEDITOR.plugins.widgetselection.isWholeContentSelected(t.editable()),r=t.getSelection().createBookmarks(!0)),i.handle(T(t)))}function C(t){return(t=(t=t.getDefinition().attributes)&&t.class)?t.split(/\s+/):null}function I(){var t=CKEDITOR.document.getActive(),e=this.editor,n=e.editable();(n.isInline()?n:e.document.getWindow().getFrame()).equals(t)&&e.focusManager.focus(n)}function E(){CKEDITOR.env.gecko&&this.editor.unlockSelection(),CKEDITOR.env.webkit||(this.editor.forceNextSelectionCheck(),this.editor.selectionChange(1))}function T(t){var e=t.getSelectedHtml(!0);return t.widgets.focused?t.widgets.focused.getClipboardHtml():(t.once("toDataFormat",function(t){t.data.widgetsCopy=!0},null,null,-1),t.dataProcessor.toDataFormat(e))}function w(t,e){if(t.partSelectors||(t.partSelectors=t.parts),t.parts){var n,i,r={};for(i in t.partSelectors)e||!t.parts[i]||"string"==typeof t.parts[i]?(n=t.wrapper.findOne(t.partSelectors[i]),r[i]=n):r[i]=t.parts[i];t.parts=r}}function x(t){if(!0===t.mask)!function(t){var e=t.wrapper.findOne(".cke_widget_mask");e||(e=new CKEDITOR.dom.element("img",t.editor.document),e.setAttributes({src:CKEDITOR.tools.transparentImageData,class:"cke_reset cke_widget_mask"}),t.wrapper.append(e)),t.mask=e}(t);else if(t.mask){var e,n,i=new CKEDITOR.tools.buffers.throttle(250,_,t),r=CKEDITOR.env.gecko?300:0;if(t.on("focus",function(){i.input(),e=t.editor.on("change",i.input),n=t.on("blur",function(){e.removeListener(),n.removeListener()})}),t.editor.on("instanceReady",function(){setTimeout(function(){i.input()},r)}),t.editor.on("mode",function(){setTimeout(function(){i.input()},r)}),CKEDITOR.env.gecko){var o=t.element.find("img");CKEDITOR.tools.array.forEach(o.toArray(),function(t){t.on("load",function(){i.input()})})}for(var s in t.editables)t.editables[s].on("focus",function(){t.editor.on("change",i.input),n&&n.removeListener()}),t.editables[s].on("blur",function(){t.editor.removeListener("change",i.input)});i.input()}}function _(){if(this.wrapper){this.maskPart=this.maskPart||this.mask;var t,e=this.parts[this.maskPart];if(e&&"string"!=typeof e){(t=this.wrapper.findOne(".cke_widget_partial_mask"))||((t=new CKEDITOR.dom.element("img",this.editor.document)).setAttributes({src:CKEDITOR.tools.transparentImageData,class:"cke_reset cke_widget_partial_mask"}),this.wrapper.append(t)),this.mask=t;var n=t.$,i=e.$,r=!(n.offsetTop==i.offsetTop&&n.offsetLeft==i.offsetLeft);(n.offsetWidth!=i.offsetWidth||n.offsetHeight!=i.offsetHeight||r)&&(n=e.getParent(),i=CKEDITOR.plugins.widget.isDomWidget(n),t.setStyles({top:e.$.offsetTop+(i?0:n.$.offsetTop)+"px",left:e.$.offsetLeft+(i?0:n.$.offsetLeft)+"px",width:e.$.offsetWidth+"px",height:e.$.offsetHeight+"px"}))}}}function D(t){function e(){var e;for(d.reset();e=c.pop();)e.removeListener();var n=u;e=t.sender;var i=this.repository.finder,r=this.repository.liner,o=this.editor,s=this.editor.editable();CKEDITOR.tools.isEmpty(r.visible)||(n=i.getRange(n[0]),this.focus(),o.fire("drop",{dropRange:n,target:n.startContainer})),s.removeClass("cke_widget_dragging"),r.hideVisible(),o.fire("dragend",{target:e})}if(CKEDITOR.tools.getMouseButton(t)===CKEDITOR.MOUSE_BUTTON_LEFT){var n,i,r=this.repository.finder,o=this.repository.locator,s=this.repository.liner,a=this.editor,l=a.editable(),c=[],u=[];this.repository._.draggedWidget=this;var h=r.greedySearch(),d=CKEDITOR.tools.eventsBuffer(50,function(){n=o.locate(h),(u=o.sort(i,1)).length&&(s.prepare(h,n),s.placeLine(u[0]),s.cleanup())});l.addClass("cke_widget_dragging"),c.push(l.on("mousemove",function(t){i=t.data.$.clientY,d.input()})),a.fire("dragstart",{target:t.sender}),c.push(a.document.once("mouseup",e,this)),l.isInline()||c.push(CKEDITOR.document.once("mouseup",e,this))}}function A(t){t.element.data("cke-widget-data",encodeURIComponent(JSON.stringify(t.data)))}function O(){function t(){}function n(t,e,n){return!(!n||!this.checkElement(t))&&((t=n.widgets.getByElement(t,!0))&&t.checkStyleActive(this))}function i(t){function e(t,e,n){for(var i=t.length,r=0;r<i;){if(e.call(n,t[r],r,t))return t[r];r++}}function n(t){function e(t,n){var i=CKEDITOR.tools.object.keys(t),r=CKEDITOR.tools.object.keys(n);if(i.length!==r.length)return!1;for(var o in t)if(("object"!=typeof t[o]||"object"!=typeof n[o]||!e(t[o],n[o]))&&t[o]!==n[o])return!1;return!0}return function(n){return e(t.getDefinition(),n.getDefinition())}}var i,o=t.widget;r[o]||(r[o]={});for(var s=0,a=t.group.length;s<a;s++)i=t.group[s],r[o][i]||(r[o][i]=[]),e(i=r[o][i],n(t))||i.push(t)}var r={};CKEDITOR.style.addCustomHandler({type:"widget",setup:function(t){this.widget=t.widget,(this.group="string"==typeof t.group?[t.group]:t.group)&&i(this)},apply:function(t){var e;t instanceof CKEDITOR.editor&&this.checkApplicable(t.elementPath(),t)&&(e=t.widgets.focused,this.group&&this.removeStylesFromSameGroup(t),e.applyStyle(this))},remove:function(t){t instanceof CKEDITOR.editor&&this.checkApplicable(t.elementPath(),t)&&t.widgets.focused.removeStyle(this)},removeStylesFromSameGroup:function(t){var e,n,i=!1;if(!(t instanceof CKEDITOR.editor))return!1;if(n=t.elementPath(),this.checkApplicable(n,t))for(var o=0,s=this.group.length;o<s;o++){e=r[this.widget][this.group[o]];for(var a=0;a<e.length;a++)e[a]!==this&&e[a].checkActive(n,t)&&(t.widgets.focused.removeStyle(e[a]),i=!0)}return i},checkActive:function(t,e){return this.checkElementMatch(t.lastElement,0,e)},checkApplicable:function(t,e){return e instanceof CKEDITOR.editor&&this.checkElement(t.lastElement)},checkElementMatch:n,checkElementRemovable:n,checkElement:function(t){return!!e.isDomWidgetWrapper(t)&&((t=t.getFirst(e.isDomWidgetElement))&&t.data("widget")==this.widget)},buildPreview:function(t){return t||this._.definition.name},toAllowedContentRules:function(t){if(!t)return null;var e,n={};return(t=t.widgets.registered[this.widget])?t.styleableElements?(e=this.getClassesArray())?(n[t.styleableElements]={classes:e,propertiesOnly:!0},n):null:t.styleToAllowedContentRules?t.styleToAllowedContentRules(this):null:null},getClassesArray:function(){var t=this._.definition.attributes&&this._.definition.attributes.class;return t?CKEDITOR.tools.trim(t).split(/\s+/):null},applyToRange:t,removeFromRange:t,applyToObject:t})}CKEDITOR.plugins.add("widget",{requires:"lineutils,clipboard,widgetselection",onLoad:function(){void 0!==CKEDITOR.document.$.querySelectorAll&&(CKEDITOR.addCss('.cke_widget_wrapper{position:relative;outline:none}.cke_widget_inline{display:inline-block}.cke_widget_wrapper:hover>.cke_widget_element{outline:2px solid #ffd25c;cursor:default}.cke_widget_wrapper:hover .cke_widget_editable{outline:2px solid #ffd25c}.cke_widget_wrapper.cke_widget_focused>.cke_widget_element,.cke_widget_wrapper .cke_widget_editable.cke_widget_editable_focused{outline:2px solid #47a4f5}.cke_widget_editable{cursor:text}.cke_widget_drag_handler_container{position:absolute;width:15px;height:0;display:block;opacity:0.75;transition:height 0s 0.2s;line-height:0}.cke_widget_wrapper:hover>.cke_widget_drag_handler_container{height:15px;transition:none}.cke_widget_drag_handler_container:hover{opacity:1}.cke_editable[contenteditable="false"] .cke_widget_drag_handler_container{display:none;}img.cke_widget_drag_handler{cursor:move;width:15px;height:15px;display:inline-block}.cke_widget_mask{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.cke_widget_partial_mask{position:absolute;display:block}.cke_editable.cke_widget_dragging, .cke_editable.cke_widget_dragging *{cursor:move !important}'),O())},beforeInit:function(e){void 0!==CKEDITOR.document.$.querySelectorAll&&(e.widgets=new t(e))},afterInit:function(t){if(void 0!==CKEDITOR.document.$.querySelectorAll){var e,n,i,r=t.widgets.registered;for(n in r)(i=(e=r[n]).button)&&t.ui.addButton&&t.ui.addButton(CKEDITOR.tools.capitalize(e.name,!0),{label:i,command:e.name,toolbar:"insert,10"});!function(t){t.contextMenu&&t.contextMenu.addListener(function(e){if(e=t.widgets.getByElement(e,!0))return e.fire("contextMenu",{})})}(t),function(t){t&&t.addFilterRule(function(t){return t.replace(/\s*cke_widget_selected/g,"").replace(/\s*cke_widget_focused/g,"")})}(t.undoManager)}}}),t.prototype={MIN_SELECTION_CHECK_INTERVAL:500,add:function(t,e){var n=this.editor;if((e=CKEDITOR.tools.prototypedCopy(e)).name=t,e._=e._||{},n.fire("widgetDefinition",e),e.template&&(e.template=new CKEDITOR.template(e.template)),function(t,e){t.addCommand(e.name,{exec:function(t,n){function i(){t.widgets.finalizeCreation(a)}if((o=t.widgets.focused)&&o.name==e.name)o.edit();else if(e.insert)e.insert({editor:t,commandData:n});else if(e.template){var r,o="function"==typeof e.defaults?e.defaults():e.defaults,s=(o=CKEDITOR.dom.element.createFromHtml(e.template.output(o),t.document),t.widgets.wrapElement(o,e.name)),a=new CKEDITOR.dom.documentFragment(s.getDocument());a.append(s),(r=t.widgets.initOn(o,e,n&&n.startupData))?(o=r.once("edit",function(e){e.data.dialog?r.once("dialog",function(e){var n,o;e=e.data,n=e.once("ok",i,null,null,20),o=e.once("cancel",function(e){e.data&&!1===e.data.hide||t.widgets.destroy(r,!0)}),e.once("hide",function(){n.removeListener(),o.removeListener()})}):i()},null,null,999),r.edit(),o.removeListener()):i()}},allowedContent:e.allowedContent,requiredContent:e.requiredContent,contentForms:e.contentForms,contentTransformations:e.contentTransformations})}(n,e),function(t,e){function n(e,n,i){var r=CKEDITOR.tools.getIndex(t._.upcasts,function(t){return t[2]>i});0>r&&(r=t._.upcasts.length),t._.upcasts.splice(r,0,[CKEDITOR.tools.bind(e,n),n.name,i])}var i=e.upcast,r=e.upcastPriority||10;i&&n("string"==typeof i?function(t,n){var i,r,o=e.upcast.split(",");for(r=0;r<o.length;r++)if((i=o[r])===t.name)return e.upcasts[i].call(this,t,n);return!1}:i,e,r)}(this,e),this.registered[t]=e,e.dialog&&n.plugins.dialog)var i=CKEDITOR.on("dialogDefinition",function(t){var r=(t=t.data.definition).dialog;t.getMode||r.getName()!==e.dialog||(t.getMode=function(){var t=r.getModel(n);return t&&t instanceof CKEDITOR.plugins.widget&&t.ready?CKEDITOR.dialog.EDITING_MODE:CKEDITOR.dialog.CREATION_MODE}),i.removeListener()});return e},addUpcastCallback:function(t){this._.upcastCallbacks.push(t)},checkSelection:function(){if(this.editor.getSelection()){var t,n=this.editor.getSelection(),i=n.getSelectedElement(),r=g(this);if(i&&(t=this.getByElement(i,!0)))return r.focus(t).select(t).commit();if(!(n=n.getRanges()[0])||n.collapsed)return r.commit();for((n=new CKEDITOR.dom.walker(n)).evaluator=e.isDomWidgetWrapper;i=n.next();)r.select(this.getByElement(i));r.commit()}},checkWidgets:function(t){this.fire("checkWidgets",CKEDITOR.tools.copy(t||{}))},del:function(t){if(this.focused===t){var e,n=t.editor,i=n.createRange();(e=i.moveToClosestEditablePosition(t.wrapper,!0))||(e=i.moveToClosestEditablePosition(t.wrapper,!1)),e&&n.getSelection().selectRanges([i])}t.wrapper.remove(),this.destroy(t,!0)},destroy:function(t,e){this.widgetHoldingFocusedEditable===t&&f(this,t,null,e),t.destroy(e),delete this.instances[t.id],this.fire("instanceDestroyed",t)},destroyAll:function(t,e){var n,i,r=this.instances;if(e&&!t){r=(i=e.find(".cke_widget_wrapper")).count();for(var o=0;o<r;++o)(n=this.getByElement(i.getItem(o),!0))&&this.destroy(n)}else for(i in r)n=r[i],this.destroy(n,t)},finalizeCreation:function(t){(t=t.getFirst())&&e.isDomWidgetWrapper(t)&&(this.editor.insertElement(t),(t=this.getByElement(t)).ready=!0,t.fire("ready"),t.focus())},getByElement:function(){function t(t){return t.is(e)&&t.data("cke-widget-id")}var e={div:1,span:1};return function(e,n){if(!e)return null;var i=t(e);if(!n&&!i){var r=this.editor.editable();do{e=e.getParent()}while(e&&!e.equals(r)&&!(i=t(e)))}return this.instances[i]||null}}(),initOn:function(t,n,i){if(n?"string"==typeof n&&(n=this.registered[n]):n=this.registered[t.data("widget")],!n)return null;var r=this.wrapElement(t,n.name);return r?r.hasClass("cke_widget_new")?(t=new e(this,this._.nextId++,t,n,i)).isInited()?this.instances[t.id]=t:null:this.getByElement(t):null},initOnAll:function(t){for(var n,i=[],r=(t=(t||this.editor.editable()).find(".cke_widget_new")).count();r--;)(n=this.initOn(t.getItem(r).getFirst(e.isDomWidgetElement)))&&i.push(n);return i},onWidget:function(t){var e=Array.prototype.slice.call(arguments);for(var n in e.shift(),this.instances){var i=this.instances[n];i.name==t&&i.on.apply(i,e)}this.on("instanceCreated",function(n){(n=n.data).name==t&&n.on.apply(n,e)})},parseElementClasses:function(t){if(!t)return null;t=CKEDITOR.tools.trim(t).split(/\s+/);for(var e,n={},i=0;e=t.pop();)-1==e.indexOf("cke_")&&(n[e]=i=1);return i?n:null},wrapElement:function(t,e){var n,i,r=null;if(t instanceof CKEDITOR.dom.element){if(e=e||t.data("widget"),!(n=this.registered[e]))return null;if((r=t.getParent())&&r.type==CKEDITOR.NODE_ELEMENT&&r.data("cke-widget-wrapper"))return r;t.hasAttribute("data-cke-widget-keep-attr")||t.data("cke-widget-keep-attr",t.data("widget")?1:0),t.data("widget",e),(i=h(n,t.getName()))&&o(t),(r=new CKEDITOR.dom.element(i?"span":"div",t.getDocument())).setAttributes(c(i,e)),r.data("cke-display-name",n.pathName?n.pathName:t.getName()),t.getParent(!0)&&r.replace(t),t.appendTo(r)}else if(t instanceof CKEDITOR.htmlParser.element){if(e=e||t.attributes["data-widget"],!(n=this.registered[e]))return null;if((r=t.parent)&&r.type==CKEDITOR.NODE_ELEMENT&&r.attributes["data-cke-widget-wrapper"])return r;var s;"data-cke-widget-keep-attr"in t.attributes||(t.attributes["data-cke-widget-keep-attr"]=t.attributes["data-widget"]?1:0),e&&(t.attributes["data-widget"]=e),(i=h(n,t.name))&&o(t),(r=new CKEDITOR.htmlParser.element(i?"span":"div",c(i,e))).attributes["data-cke-display-name"]=n.pathName?n.pathName:t.name,(n=t.parent)&&(s=t.getIndex(),t.remove()),r.add(t),n&&u(n,s,r)}return r},_tests_createEditableFilter:l},CKEDITOR.event.implementOn(t.prototype),e.prototype={addClass:function(t){this.element.addClass(t),this.wrapper.addClass(e.WRAPPER_CLASS_PREFIX+t)},applyStyle:function(t){m(this,t,1)},checkStyleActive:function(t){var e;if(!(t=C(t)))return!1;for(;e=t.pop();)if(!this.hasClass(e))return!1;return!0},destroy:function(t){if(this.fire("destroy"),this.editables)for(var e in this.editables)this.destroyEditable(e,t);t||("0"==this.element.data("cke-widget-keep-attr")&&this.element.removeAttribute("data-widget"),this.element.removeAttributes(["data-cke-widget-data","data-cke-widget-keep-attr"]),this.element.removeClass("cke_widget_element"),this.element.replace(this.wrapper)),this.wrapper=null},destroyEditable:function(t,e){var n=this.editables[t],i=!0;if(n.removeListener("focus",E),n.removeListener("blur",I),this.editor.focusManager.remove(n),n.filter){for(var r in this.repository.instances){var o=this.repository.instances[r];o.editables&&(o=o.editables[t])&&o!==n&&n.filter===o.filter&&(i=!1)}i&&(n.filter.destroy(),(i=this.repository._.filters[this.name])&&delete i[t])}e||(this.repository.destroyAll(!1,n),n.removeClass("cke_widget_editable"),n.removeClass("cke_widget_editable_focused"),n.removeAttributes(["contenteditable","data-cke-widget-editable","data-cke-enter-mode"])),delete this.editables[t]},edit:function(){var t={dialog:this.dialog},e=this;return!(!1===this.fire("edit",t)||!t.dialog)&&(this.editor.openDialog(t.dialog,function(t){var n,i;!1!==e.fire("dialog",t)&&(n=t.on("show",function(){t.setupContent(e)}),i=t.on("ok",function(){var n,i=e.on("data",function(t){n=1,t.cancel()},null,null,0);e.editor.fire("saveSnapshot"),t.commitContent(e),i.removeListener(),n&&(e.fire("data",e.data),e.editor.fire("saveSnapshot"))}),t.once("hide",function(){n.removeListener(),i.removeListener()}))},e),!0)},getClasses:function(){return this.repository.parseElementClasses(this.element.getAttribute("class"))},getClipboardHtml:function(){var t=this.editor.createRange();return t.setStartBefore(this.wrapper),t.setEndAfter(this.wrapper),this.editor.editable().getHtmlFromRange(t).getHtml()},hasClass:function(t){return this.element.hasClass(t)},initEditable:function(t,e){var i=this._findOneNotNested(e.selector);return!(!i||!i.is(CKEDITOR.dtd.$editable))&&(i=new n(this.editor,i,{filter:l.call(this.repository,this.name,t,e)}),this.editables[t]=i,i.setAttributes({contenteditable:"true","data-cke-widget-editable":t,"data-cke-enter-mode":i.enterMode}),i.filter&&i.data("cke-filter",i.filter.id),i.addClass("cke_widget_editable"),i.removeClass("cke_widget_editable_focused"),e.pathName&&i.data("cke-display-name",e.pathName),this.editor.focusManager.add(i),i.on("focus",E,this),CKEDITOR.env.ie&&i.on("blur",I,this),i._.initialSetData=!0,i.setData(i.getHtml()),!0)},_findOneNotNested:function(t){t=this.wrapper.find(t);for(var n,i,r=0;r<t.count();r++)if(i=(n=t.getItem(r)).getAscendant(e.isDomWidgetWrapper),this.wrapper.equals(i))return n;return null},isInited:function(){return!(!this.wrapper||!this.inited)},isReady:function(){return this.isInited()&&this.ready},focus:function(){var t=this.editor.getSelection();if(t){var e=this.editor.checkDirty();t.fake(this.wrapper),!e&&this.editor.resetDirty()}this.editor.focus()},refreshMask:function(){x(this)},refreshParts:function(t){w(this,void 0===t||t)},removeClass:function(t){this.element.removeClass(t),this.wrapper.removeClass(e.WRAPPER_CLASS_PREFIX+t)},removeStyle:function(t){m(this,t,0)},setData:function(t,e){var n=this.data,i=0;if("string"==typeof t)n[t]!==e&&(n[t]=e,i=1);else{var r=t;for(t in r)n[t]!==r[t]&&(i=1,n[t]=r[t])}return i&&this.dataReady&&(A(this),this.fire("data",n)),this},setFocused:function(t){return this.wrapper[t?"addClass":"removeClass"]("cke_widget_focused"),this.fire(t?"focus":"blur"),this},setSelected:function(t){return this.wrapper[t?"addClass":"removeClass"]("cke_widget_selected"),this.fire(t?"select":"deselect"),this},updateDragHandlerPosition:function(){var t=this.editor,e=this.element.$,n=this._.dragHandlerOffset;e={x:e.offsetLeft,y:e.offsetTop-15};n&&e.x==n.x&&e.y==n.y||(n=t.checkDirty(),t.fire("lockSnapshot"),this.dragHandlerContainer.setStyles({top:e.y+"px",left:e.x+"px"}),this.dragHandlerContainer.removeStyle("display"),t.fire("unlockSnapshot"),!n&&t.resetDirty(),this._.dragHandlerOffset=e)}},CKEDITOR.event.implementOn(e.prototype),e.getNestedEditable=function(t,n){return!n||n.equals(t)?null:e.isDomNestedEditable(n)?n:e.getNestedEditable(t,n.getParent())},e.isDomDragHandler=function(t){return t.type==CKEDITOR.NODE_ELEMENT&&t.hasAttribute("data-cke-widget-drag-handler")},e.isDomDragHandlerContainer=function(t){return t.type==CKEDITOR.NODE_ELEMENT&&t.hasClass("cke_widget_drag_handler_container")},e.isDomNestedEditable=function(t){return t.type==CKEDITOR.NODE_ELEMENT&&t.hasAttribute("data-cke-widget-editable")},e.isDomWidgetElement=function(t){return t.type==CKEDITOR.NODE_ELEMENT&&t.hasAttribute("data-widget")},e.isDomWidgetWrapper=function(t){return t.type==CKEDITOR.NODE_ELEMENT&&t.hasAttribute("data-cke-widget-wrapper")},e.isDomWidget=function(t){return!!t&&(this.isDomWidgetWrapper(t)||this.isDomWidgetElement(t))},e.isParserWidgetElement=function(t){return t.type==CKEDITOR.NODE_ELEMENT&&!!t.attributes["data-widget"]},e.isParserWidgetWrapper=function(t){return t.type==CKEDITOR.NODE_ELEMENT&&!!t.attributes["data-cke-widget-wrapper"]},e.WRAPPER_CLASS_PREFIX="cke_widget_wrapper_",n.prototype=CKEDITOR.tools.extend(CKEDITOR.tools.prototypedCopy(CKEDITOR.dom.element.prototype),{setData:function(t){this._.initialSetData||this.editor.widgets.destroyAll(!1,this),this._.initialSetData=!1,t=this.editor.dataProcessor.unprotectRealComments(t),t=this.editor.dataProcessor.unprotectSource(t),t=this.editor.dataProcessor.toHtml(t,{context:this.getName(),filter:this.filter,enterMode:this.enterMode}),this.setHtml(t),this.editor.widgets.initOnAll(this)},getData:function(){return this.editor.dataProcessor.toDataFormat(this.getHtml(),{context:this.getName(),filter:this.filter,enterMode:this.enterMode})}});var S=/^(?:<(?:div|span)(?: data-cke-temp="1")?(?: id="cke_copybin")?(?: data-cke-temp="1")?>)?(?:<(?:div|span)(?: style="[^"]+")?>)?<span [^>]*data-cke-copybin-start="1"[^>]*>.?<\/span>([\s\S]+)<span [^>]*data-cke-copybin-end="1"[^>]*>.?<\/span>(?:<\/(?:div|span)>)?(?:<\/(?:div|span)>)?$/i,R={37:1,38:1,39:1,40:1,8:1,46:1};R[CKEDITOR.SHIFT+121]=1;var k=CKEDITOR.tools.createClass({$:function(t,e){this._.createCopyBin(t,e),this._.createListeners(e)},_:{createCopyBin:function(t){var e=t.document,n=CKEDITOR.env.edge&&16<=CKEDITOR.env.version,i=!t.blockless&&!CKEDITOR.env.ie||n?"div":"span";n=e.createElement(i);(e=e.createElement(i)).setAttributes({id:"cke_copybin","data-cke-temp":"1"}),n.setStyles({position:"absolute",width:"1px",height:"1px",overflow:"hidden"}),n.setStyle("ltr"==t.config.contentsLangDirection?"left":"right","-5000px"),this.editor=t,this.copyBin=n,this.container=e},createListeners:function(t){t&&(t.beforeDestroy&&(this.beforeDestroy=t.beforeDestroy),t.afterDestroy&&(this.afterDestroy=t.afterDestroy))}},proto:{handle:function(t){var e,n,i,r=this.copyBin,o=this.editor,s=this.container,a=CKEDITOR.env.ie&&9>CKEDITOR.env.version,l=o.document.getDocumentElement().$,c=o.createRange(),u=this,h=CKEDITOR.env.mac&&CKEDITOR.env.webkit,d=h?100:0,f=window.requestAnimationFrame&&!h?requestAnimationFrame:setTimeout;return r.setHtml('<span data-cke-copybin-start="1">\u200b</span>'+t+'<span data-cke-copybin-end="1">\u200b</span>'),o.fire("lockSnapshot"),s.append(r),o.editable().append(s),e=o.on("selectionChange",v,null,null,0),n=o.widgets.on("checkSelection",v,null,null,0),a&&(i=l.scrollTop),c.selectNodeContents(r),c.select(),a&&(l.scrollTop=i),new CKEDITOR.tools.promise(function(t){f(function(){u.beforeDestroy&&u.beforeDestroy(),s.remove(),e.removeListener(),n.removeListener(),o.fire("unlockSnapshot"),u.afterDestroy&&u.afterDestroy(),t()},d)})}},statics:{hasCopyBin:function(t){return!!k.getCopyBin(t)},getCopyBin:function(t){return t.document.getById("cke_copybin")}}});CKEDITOR.plugins.widget=e,e.repository=t,e.nestedEditable=n}(),CKEDITOR.config.widget_keystrokeInsertLineBefore=CKEDITOR.SHIFT+CKEDITOR.ALT+13,CKEDITOR.config.widget_keystrokeInsertLineAfter=CKEDITOR.SHIFT+13,CKEDITOR.plugins.add("about",{requires:"dialog",init:function(t){var e=t.addCommand("about",new CKEDITOR.dialogCommand("about"));e.modes={wysiwyg:1,source:1},e.canUndo=!1,e.readOnly=1,t.ui.addButton&&t.ui.addButton("About",{label:t.lang.about.dlgTitle,command:"about",toolbar:"about"}),CKEDITOR.dialog.add("about",this.path+"dialogs/about.js")}}),CKEDITOR.plugins.add("basicstyles",{init:function(t){var e=0,n=function(n,r,o,s){if(s){s=new CKEDITOR.style(s);var a=i[o];a.unshift(s),t.attachStyleStateChange(s,function(e){!t.readOnly&&t.getCommand(o).setState(e)}),t.addCommand(o,new CKEDITOR.styleCommand(s,{contentForms:a})),t.ui.addButton&&t.ui.addButton(n,{isToggle:!0,label:r,command:o,toolbar:"basicstyles,"+(e+=10)})}},i={bold:["strong","b",["span",function(t){return"bold"==(t=t.styles["font-weight"])||700<=+t}]],italic:["em","i",["span",function(t){return"italic"==t.styles["font-style"]}]],underline:["u",["span",function(t){return"underline"==t.styles["text-decoration"]}]],strike:["s","strike",["span",function(t){return"line-through"==t.styles["text-decoration"]}]],subscript:["sub"],superscript:["sup"]},r=t.config,o=t.lang.basicstyles;n("Bold",o.bold,"bold",r.coreStyles_bold),n("Italic",o.italic,"italic",r.coreStyles_italic),n("Underline",o.underline,"underline",r.coreStyles_underline),n("Strike",o.strike,"strike",r.coreStyles_strike),n("Subscript",o.subscript,"subscript",r.coreStyles_subscript),n("Superscript",o.superscript,"superscript",r.coreStyles_superscript),t.setKeystroke([[CKEDITOR.CTRL+66,"bold"],[CKEDITOR.CTRL+73,"italic"],[CKEDITOR.CTRL+85,"underline"]])},afterInit:function(t){if(t.config.coreStyles_toggleSubSup){var e=t.getCommand("subscript"),n=t.getCommand("superscript");e&&n&&t.on("afterCommandExec",function(i){if("subscript"===(i=i.data.name)||"superscript"===i){var r="subscript"===i?n:e;("subscript"===i?e:n).state===CKEDITOR.TRISTATE_ON&&r.state===CKEDITOR.TRISTATE_ON&&(r.exec(t),t.fire("updateSnapshot"))}})}}}),CKEDITOR.config.coreStyles_bold={element:"strong",overrides:"b"},CKEDITOR.config.coreStyles_italic={element:"em",overrides:"i"},CKEDITOR.config.coreStyles_underline={element:"u"},CKEDITOR.config.coreStyles_strike={element:"s",overrides:"strike"},CKEDITOR.config.coreStyles_subscript={element:"sub"},CKEDITOR.config.coreStyles_superscript={element:"sup"},CKEDITOR.config.coreStyles_toggleSubSup=!1,function(){function t(t,e,n){if(n=t.config.forceEnterMode||n,"wysiwyg"==t.mode){e||(e=t.activeEnterMode);var o=t.elementPath();o&&!o.isContextFor("p")&&(e=CKEDITOR.ENTER_BR,n=1),t.fire("saveSnapshot"),e==CKEDITOR.ENTER_BR?i(t,e,null,n):r(t,e,null,n),t.fire("saveSnapshot")}}function e(t){for(var e=(t=t.getSelection().getRanges(!0)).length-1;0<e;e--)t[e].deleteContents();return t[0]}CKEDITOR.plugins.add("enterkey",{init:function(e){e.addCommand("enter",{modes:{wysiwyg:1},editorFocus:!1,exec:function(e){t(e)}}),e.addCommand("shiftEnter",{modes:{wysiwyg:1},editorFocus:!1,exec:function(e){t(e,e.activeShiftEnterMode,1)}}),e.setKeystroke([[13,"enter"],[CKEDITOR.SHIFT+13,"shiftEnter"]])}});var n,i,r,o,s=CKEDITOR.dom.walker.whitespaces(),a=CKEDITOR.dom.walker.bookmark();CKEDITOR.plugins.enterkey={enterBlock:function(t,n,r,l){if(r=r||e(t)){r=function(t){var e=t.startContainer.getAscendant(function(t){return t.type==CKEDITOR.NODE_ELEMENT&&"true"==t.getAttribute("contenteditable")},!0);return t.root.equals(e)?t:((e=new CKEDITOR.dom.range(e)).moveToRange(t),e)}(r);var c,u=r.document,h=r.checkStartOfBlock(),d=r.checkEndOfBlock(),f=t.elementPath(r.startContainer),p=f.block,g=n==CKEDITOR.ENTER_DIV?"div":"p";if(p&&h&&d){if((h=p.getParent()).is("li")&&1<h.getChildCount())return u=new CKEDITOR.dom.element("li"),c=t.createRange(),u.insertAfter(h),p.remove(),c.setStart(u,0),void t.getSelection().selectRanges([c]);if(p.is("li")||p.getParent().is("li")){p.is("li")||(h=(p=p.getParent()).getParent()),c=h.getParent(),r=!p.hasPrevious();var m=!p.hasNext(),v=(g=(l=t.getSelection()).createBookmarks(),p.getDirection(1)),y=(d=p.getAttribute("class"),p.getAttribute("style")),b=c.getDirection(1)!=v;if(t=t.enterMode!=CKEDITOR.ENTER_BR||b||y||d,c.is("li"))r||m?(r&&m&&h.remove(),p[m?"insertAfter":"insertBefore"](c)):p.breakParent(c);else{if(t)f.block.is("li")?(c=u.createElement(n==CKEDITOR.ENTER_P?"p":"div"),b&&c.setAttribute("dir",v),y&&c.setAttribute("style",y),d&&c.setAttribute("class",d),p.moveChildren(c)):c=f.block,r||m?c[r?"insertBefore":"insertAfter"](h):(p.breakParent(h),c.insertAfter(h));else if(p.appendBogus(!0),r||m)for(;u=p[r?"getFirst":"getLast"]();)u[r?"insertBefore":"insertAfter"](h);else for(p.breakParent(h);u=p.getLast();)u.insertAfter(h);p.remove()}return void l.selectBookmarks(g)}if(p&&p.getParent().is("blockquote"))return p.breakParent(p.getParent()),p.getPrevious().getFirst(CKEDITOR.dom.walker.invisible(1))||p.getPrevious().remove(),p.getNext().getFirst(CKEDITOR.dom.walker.invisible(1))||p.getNext().remove(),r.moveToElementEditStart(p),void r.select()}else if(p&&p.is("pre")&&!d)return void i(t,n,r,l);if(y=r.splitBlock(g)){if(t=y.previousBlock,p=y.nextBlock,h=y.wasStartOfBlock,d=y.wasEndOfBlock,p?(m=p.getParent()).is("li")&&(p.breakParent(m),p.move(p.getNext(),1)):t&&(m=t.getParent())&&m.is("li")&&(t.breakParent(m),m=t.getNext(),r.moveToElementEditStart(m),t.move(t.getPrevious())),h||d)if(function(t){var e;return t!==CKEDITOR.ENTER_BR&&-1!==CKEDITOR.tools.indexOf(["td","th"],f.lastElement.getName())&&1===f.lastElement.getChildCount()&&((e=(t=f.lastElement.getChild(0).clone(!0)).getBogus())&&e.remove(),!t.getText().length)}(n))r.moveToElementEditStart(r.getTouchedStartNode());else{if(t?(t.is("li")||!o.test(t.getName())&&!t.is("pre"))&&(c=t.clone()):p&&(c=p.clone()),c?l&&!c.is("li")&&c.renameNode(g):m&&m.is("li")?c=m:(c=u.createElement(g),t&&(v=t.getDirection())&&c.setAttribute("dir",v)),u=y.elementPath)for(n=0,l=u.elements.length;n<l&&(!(g=u.elements[n]).equals(u.block)&&!g.equals(u.blockLimit));n++)CKEDITOR.dtd.$removeEmpty[g.getName()]&&(g=g.clone(),c.moveChildren(g),c.append(g));c.appendBogus(),c.getParent()||r.insertNode(c),c.is("li")&&c.removeAttribute("value"),!CKEDITOR.env.ie||!h||d&&t.getChildCount()||(r.moveToElementEditStart(d?t:c),r.select()),r.moveToElementEditStart(h&&!d?p:c)}else p.is("li")&&((c=r.clone()).selectNodeContents(p),(c=new CKEDITOR.dom.walker(c)).evaluator=function(t){return!(a(t)||s(t)||t.type==CKEDITOR.NODE_ELEMENT&&t.getName()in CKEDITOR.dtd.$inline&&!(t.getName()in CKEDITOR.dtd.$empty))},(m=c.next())&&m.type==CKEDITOR.NODE_ELEMENT&&m.is("ul","ol")&&(CKEDITOR.env.needsBrFiller?u.createElement("br"):u.createText("\xa0")).insertBefore(m)),p&&r.moveToElementEditStart(p);r.select(),r.scrollIntoView()}}},enterBr:function(t,n,i,s){if(i=i||e(t)){var a=i.document,l=i.checkEndOfBlock(),c=new CKEDITOR.dom.elementPath(t.getSelection().getStartElement()),u=c.block,h=u&&c.block.getName();s||"li"!=h?(!s&&l&&o.test(h)?(l=u.getDirection())?((a=a.createElement("div")).setAttribute("dir",l),a.insertAfter(u),i.setStart(a,0)):(a.createElement("br").insertAfter(u),CKEDITOR.env.gecko&&a.createText("").insertAfter(u),i.setStartAt(u.getNext(),CKEDITOR.env.ie?CKEDITOR.POSITION_BEFORE_START:CKEDITOR.POSITION_AFTER_START)):(t="pre"==h&&CKEDITOR.env.ie&&8>CKEDITOR.env.version?a.createText("\r"):a.createElement("br"),i.deleteContents(),i.insertNode(t),CKEDITOR.env.needsBrFiller?(a.createText("\ufeff").insertAfter(t),l&&(u||c.blockLimit).appendBogus(),t.getNext().$.nodeValue="",i.setStartAt(t.getNext(),CKEDITOR.POSITION_AFTER_START)):i.setStartAt(t,CKEDITOR.POSITION_AFTER_END)),i.collapse(!0),i.select(),i.scrollIntoView()):r(t,n,i,s)}}},n=CKEDITOR.plugins.enterkey,i=n.enterBr,r=n.enterBlock,o=/^h[1-6]$/}(),function(){function t(t,e){var n={},i=[],r={nbsp:"\xa0",shy:"\xad",gt:">",lt:"<",amp:"&",apos:"'",quot:'"'};if(t=t.replace(/\b(nbsp|shy|gt|lt|amp|apos|quot)(?:,|$)/g,function(t,o){var s=e?"&"+o+";":r[o];return n[s]=e?r[o]:"&"+o+";",i.push(s),""}),t=t.replace(/,$/,""),!e&&t){t=t.split(",");var o,s=document.createElement("div");for(s.innerHTML="&"+t.join(";&")+";",o=s.innerHTML,s=null,s=0;s<o.length;s++){var a=o.charAt(s);n[a]="&"+t[s]+";",i.push(a)}}return n.regex=i.join(e?"|":""),n}CKEDITOR.plugins.add("entities",{afterInit:function(e){function n(t){return l[t]}function i(t){return"force"!=r.entities_processNumerical&&s[t]?s[t]:"&#"+(CKEDITOR.env.ie?t.charCodeAt(0):t.codePointAt(0))+";"}var r=e.config;if(e=(e=e.dataProcessor)&&e.htmlFilter){var o=[];!1!==r.basicEntities&&o.push("nbsp,gt,lt,amp"),r.entities&&(o.length&&o.push("quot,iexcl,cent,pound,curren,yen,brvbar,sect,uml,copy,ordf,laquo,not,shy,reg,macr,deg,plusmn,sup2,sup3,acute,micro,para,middot,cedil,sup1,ordm,raquo,frac14,frac12,frac34,iquest,times,divide,fnof,bull,hellip,prime,Prime,oline,frasl,weierp,image,real,trade,alefsym,larr,uarr,rarr,darr,harr,crarr,lArr,uArr,rArr,dArr,hArr,forall,part,exist,empty,nabla,isin,notin,ni,prod,sum,minus,lowast,radic,prop,infin,ang,and,or,cap,cup,int,there4,sim,cong,asymp,ne,equiv,le,ge,sub,sup,nsub,sube,supe,oplus,otimes,perp,sdot,lceil,rceil,lfloor,rfloor,lang,rang,loz,spades,clubs,hearts,diams,circ,tilde,ensp,emsp,thinsp,zwnj,zwj,lrm,rlm,ndash,mdash,lsquo,rsquo,sbquo,ldquo,rdquo,bdquo,dagger,Dagger,permil,lsaquo,rsaquo,euro"),r.entities_latin&&o.push("Agrave,Aacute,Acirc,Atilde,Auml,Aring,AElig,Ccedil,Egrave,Eacute,Ecirc,Euml,Igrave,Iacute,Icirc,Iuml,ETH,Ntilde,Ograve,Oacute,Ocirc,Otilde,Ouml,Oslash,Ugrave,Uacute,Ucirc,Uuml,Yacute,THORN,szlig,agrave,aacute,acirc,atilde,auml,aring,aelig,ccedil,egrave,eacute,ecirc,euml,igrave,iacute,icirc,iuml,eth,ntilde,ograve,oacute,ocirc,otilde,ouml,oslash,ugrave,uacute,ucirc,uuml,yacute,thorn,yuml,OElig,oelig,Scaron,scaron,Yuml"),r.entities_greek&&o.push("Alpha,Beta,Gamma,Delta,Epsilon,Zeta,Eta,Theta,Iota,Kappa,Lambda,Mu,Nu,Xi,Omicron,Pi,Rho,Sigma,Tau,Upsilon,Phi,Chi,Psi,Omega,alpha,beta,gamma,delta,epsilon,zeta,eta,theta,iota,kappa,lambda,mu,nu,xi,omicron,pi,rho,sigmaf,sigma,tau,upsilon,phi,chi,psi,omega,thetasym,upsih,piv"),r.entities_additional&&o.push(r.entities_additional));var s=t(o.join(",")),a=s.regex?"["+s.regex+"]":"a^";delete s.regex,r.entities&&r.entities_processNumerical&&(a="[^ -~]|"+a);a=new RegExp(a,CKEDITOR.env.ie?"g":"gu");var l=t("nbsp,gt,lt,amp,shy",!0),c=new RegExp(l.regex,"g");e.addRules({text:function(t){return t.replace(c,n).replace(a,i)}},{applyToAll:!0,excludeNestedEditable:!0})}}})}(),CKEDITOR.config.basicEntities=!0,CKEDITOR.config.entities=!0,CKEDITOR.config.entities_latin=!0,CKEDITOR.config.entities_greek=!0,CKEDITOR.config.entities_additional="#39",function(){var t=CKEDITOR.document.getWindow(),e=CKEDITOR.tools.cssLength;CKEDITOR.plugins.add("floatingspace",{init:function(n){n.on("loaded",function(){!function(n){var i=n.config,r=n.fire("uiSpace",{space:"top",html:""}).html,o=function(){function r(t,n,i){a.setStyle(n,e(i)),a.setStyle("position",t)}function s(t){var e=c.getDocumentPosition();switch(t){case"top":r("absolute","top",e.y-f-m);break;case"pin":r("fixed","top",y);break;case"bottom":r("absolute","top",e.y+(h.height||h.bottom-h.top)+m)}l=t}var l,c,u,h,d,f,p,g=i.floatSpaceDockedOffsetX||0,m=i.floatSpaceDockedOffsetY||0,v=i.floatSpacePinnedOffsetX||0,y=i.floatSpacePinnedOffsetY||0;return function(r){if(c=n.editable()){var y=r&&"focus"==r.name;y&&a.show(),n.fire("floatingSpaceLayout",{show:y}),a.removeStyle("left"),a.removeStyle("right"),u=a.getClientRect(),h=c.getClientRect(),d=t.getViewPaneSize(),f=u.height,p="pageXOffset"in t.$?t.$.pageXOffset:CKEDITOR.document.$.documentElement.scrollLeft,l?(f+m<=h.top?s("top"):f+m>d.height-h.bottom?s("pin"):s("bottom"),r=d.width/2,r=i.floatSpacePreferRight?"right":0<h.left&&h.right<d.width&&h.width>u.width?"rtl"==i.contentsLangDirection?"right":"left":r-h.left>h.right-r?"left":"right",u.width>d.width?(r="left",y=0):(y="left"==r?0<h.left?h.left:0:h.right<d.width?d.width-h.right:0)+u.width>d.width&&(r="left"==r?"right":"left",y=0),a.setStyle(r,e(("pin"==l?v:g)+y+("pin"==l?0:"left"==r?p:-p)))):(l="pin",s("pin"),o(r))}}}();if(r){var s=new CKEDITOR.template('<div id="cke_{name}" class="cke {id} cke_reset_all cke_chrome cke_editor_{name} cke_float cke_{langDir} '+CKEDITOR.env.cssClass+'" dir="{langDir}" title="'+(CKEDITOR.env.gecko?" ":"")+'" lang="{langCode}" role="application" style="{style}"'+(n.applicationTitle?' aria-labelledby="cke_{name}_arialbl"':" ")+">"+(n.applicationTitle?'<span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span>':" ")+'<div class="cke_inner"><div id="{topId}" class="cke_top" role="presentation">{content}</div></div></div>'),a=CKEDITOR.document.getBody().append(CKEDITOR.dom.element.createFromHtml(s.output({content:r,id:n.id,langDir:n.lang.dir,langCode:n.langCode,name:n.name,style:"display:none;z-index:"+(i.baseFloatZIndex-1),topId:n.ui.spaceId("top"),voiceLabel:n.applicationTitle}))),l=CKEDITOR.tools.eventsBuffer(500,o),c=CKEDITOR.tools.eventsBuffer(100,o);a.unselectable(),a.on("mousedown",function(t){(t=t.data).getTarget().hasAscendant("a",1)||t.preventDefault()}),n.on("focus",function(e){o(e),n.on("change",l.input),t.on("scroll",c.input),t.on("resize",c.input)}),n.on("blur",function(){a.hide(),n.removeListener("change",l.input),t.removeListener("scroll",c.input),t.removeListener("resize",c.input)}),n.on("destroy",function(){t.removeListener("scroll",c.input),t.removeListener("resize",c.input),a.clearCustomData(),a.remove()}),n.focusManager.hasFocus&&a.show(),n.focusManager.add(a,1)}}(this)},null,null,20)}})}(),function(){function t(t,i){var r,o;i.on("refresh",function(t){var i,r=[e];for(i in t.data.states)r.push(t.data.states[i]);this.setState(CKEDITOR.tools.search(r,n)?n:e)},i,null,100),i.on("exec",function(e){r=t.getSelection(),o=r.createBookmarks(1),e.data||(e.data={}),e.data.done=!1},i,null,0),i.on("exec",function(){t.forceNextSelectionCheck(),r.selectBookmarks(o)},i,null,100)}var e=CKEDITOR.TRISTATE_DISABLED,n=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indent",{init:function(e){var n=CKEDITOR.plugins.indent.genericDefinition;t(e,e.addCommand("indent",new n(!0))),t(e,e.addCommand("outdent",new n)),e.ui.addButton&&(e.ui.addButton("Indent",{label:e.lang.indent.indent,command:"indent",directional:!0,toolbar:"indent,20"}),e.ui.addButton("Outdent",{label:e.lang.indent.outdent,command:"outdent",directional:!0,toolbar:"indent,10"})),e.on("dirChanged",function(t){var n=e.createRange(),i=t.data.node;n.setStartBefore(i),n.setEndAfter(i);for(var r,o=new CKEDITOR.dom.walker(n);r=o.next();)if(r.type==CKEDITOR.NODE_ELEMENT)if(!r.equals(i)&&r.getDirection())n.setStartAfter(r),o=new CKEDITOR.dom.walker(n);else{var s=e.config.indentClasses;if(s)for(var a="ltr"==t.data.dir?["_rtl",""]:["","_rtl"],l=0;l<s.length;l++)r.hasClass(s[l]+a[0])&&(r.removeClass(s[l]+a[0]),r.addClass(s[l]+a[1]));s=r.getStyle("margin-right"),a=r.getStyle("margin-left"),s?r.setStyle("margin-left",s):r.removeStyle("margin-left"),a?r.setStyle("margin-right",a):r.removeStyle("margin-right")}})}}),CKEDITOR.plugins.indent={genericDefinition:function(t){this.isIndent=!!t,this.startDisabled=!this.isIndent},specificDefinition:function(t,e,n){this.name=e,this.editor=t,this.jobs={},this.enterBr=t.config.enterMode==CKEDITOR.ENTER_BR,this.isIndent=!!n,this.relatedGlobal=n?"indent":"outdent",this.indentKey=n?9:CKEDITOR.SHIFT+9,this.database={}},registerCommands:function(t,e){t.on("pluginsLoaded",function(){for(var t in e)!function(t,e){var n,i=t.getCommand(e.relatedGlobal);for(n in e.jobs)i.on("exec",function(i){i.data.done||(t.fire("lockSnapshot"),e.execJob(t,n)&&(i.data.done=!0),t.fire("unlockSnapshot"),CKEDITOR.dom.element.clearAllMarkers(e.database))},this,null,n),i.on("refresh",function(i){i.data.states||(i.data.states={}),i.data.states[e.name+"@"+n]=e.refreshJob(t,n,i.data.path)},this,null,n);t.addFeature(e)}(this,e[t])})}},CKEDITOR.plugins.indent.genericDefinition.prototype={context:"p",exec:function(){}},CKEDITOR.plugins.indent.specificDefinition.prototype={execJob:function(t,n){var i=this.jobs[n];if(i.state!=e)return i.exec.call(this,t)},refreshJob:function(t,n,i){return n=this.jobs[n],t.activeFilter.checkFeature(this)?n.state=n.refresh.call(this,t,i):n.state=e,n.state},getContext:function(t){return t.contains(this.context)}}}(),function(){function t(t){function i(e){for(var i=r.startContainer,l=r.endContainer;i&&!i.getParent().equals(e);)i=i.getParent();for(;l&&!l.getParent().equals(e);)l=l.getParent();if(!i||!l)return!1;for(var c=[],u=!1;!u;)i.equals(l)&&(u=!0),c.push(i),i=i.getNext();if(1>c.length)return!1;for(i=e.getParents(!0),l=0;l<i.length;l++)if(i[l].getName&&a[i[l].getName()]){e=i[l];break}i=o.isIndent?1:-1,l=c[0],c=c[c.length-1];var h=(u=CKEDITOR.plugins.list.listToArray(e,s))[c.getCustomData("listarray_index")].indent;for(l=l.getCustomData("listarray_index");l<=c.getCustomData("listarray_index");l++)if(u[l].indent+=i,0<i){for(var d=u[l].parent,f=l-1;0<=f;f--)if(u[f].indent===i){d=u[f].parent;break}u[l].parent=new CKEDITOR.dom.element(d.getName(),d.getDocument())}for(l=c.getCustomData("listarray_index")+1;l<u.length&&u[l].indent>h;l++)u[l].indent+=i;var p;if((i=CKEDITOR.plugins.list.arrayToList(u,s,null,t.config.enterMode,e.getDirection()),!o.isIndent)&&((p=e.getParent())&&p.is("li"))){var g,m=[];for(l=(c=i.listNode.getChildren()).count()-1;0<=l;l--)(g=c.getItem(l))&&g.is&&g.is("li")&&m.push(g)}if(i&&i.listNode.replace(e),m&&m.length)for(l=0;l<m.length;l++){for(g=e=m[l];(g=g.getNext())&&g.is&&g.getName()in a;)CKEDITOR.env.needsNbspFiller&&!e.getFirst(n)&&e.append(r.document.createText("\xa0")),e.append(g);e.insertAfter(p)}return i&&t.fire("contentDomInvalidated"),!0}for(var r,o=this,s=this.database,a=this.context,l=((l=t.getSelection())&&l.getRanges()).createIterator();r=l.getNextRange();){for(var c=r.getCommonAncestor();c&&(c.type!=CKEDITOR.NODE_ELEMENT||!a[c.getName()]);){if(t.editable().equals(c)){c=!1;break}c=c.getParent()}if(c||(c=r.startPath().contains(a))&&r.setEndAt(c,CKEDITOR.POSITION_BEFORE_END),!c){var u=r.getEnclosedNode();u&&u.type==CKEDITOR.NODE_ELEMENT&&u.getName()in a&&(r.setStartAt(u,CKEDITOR.POSITION_AFTER_START),r.setEndAt(u,CKEDITOR.POSITION_BEFORE_END),c=u)}if(c&&r.startContainer.type==CKEDITOR.NODE_ELEMENT&&r.startContainer.getName()in a&&((u=new CKEDITOR.dom.walker(r)).evaluator=e,r.startContainer=u.next()),c&&r.endContainer.type==CKEDITOR.NODE_ELEMENT&&r.endContainer.getName()in a&&((u=new CKEDITOR.dom.walker(r)).evaluator=e,r.endContainer=u.previous()),c)return i(c)}return 0}function e(t){return t.type==CKEDITOR.NODE_ELEMENT&&t.is("li")}function n(t){return i(t)&&r(t)}var i=CKEDITOR.dom.walker.whitespaces(!0),r=CKEDITOR.dom.walker.bookmark(!1,!0),o=CKEDITOR.TRISTATE_DISABLED,s=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indentlist",{requires:"indent",init:function(e){function n(e){i.specificDefinition.apply(this,arguments),this.requiredContent=["ul","ol"],e.on("key",function(t){var n=e.elementPath();if("wysiwyg"==e.mode&&t.data.keyCode==this.indentKey&&n){var i=this.getContext(n);!i||this.isIndent&&CKEDITOR.plugins.indentList.firstItemInPath(this.context,n,i)||(e.execCommand(this.relatedGlobal),t.cancel())}},this),this.jobs[this.isIndent?10:30]={refresh:this.isIndent?function(t,e){var n=this.getContext(e),i=CKEDITOR.plugins.indentList.firstItemInPath(this.context,e,n);return n&&this.isIndent&&!i?s:o}:function(t,e){return!this.getContext(e)||this.isIndent?o:s},exec:CKEDITOR.tools.bind(t,this)}}var i=CKEDITOR.plugins.indent;i.registerCommands(e,{indentlist:new n(e,"indentlist",!0),outdentlist:new n(e,"outdentlist")}),CKEDITOR.tools.extend(n.prototype,i.specificDefinition.prototype,{context:{ol:1,ul:1}})}}),CKEDITOR.plugins.indentList={},CKEDITOR.plugins.indentList.firstItemInPath=function(t,n,i){var r=n.contains(e);return i||(i=n.contains(t)),i&&r&&r.equals(i.getFirst(e))}}(),function(){function t(t,e){var n=o.exec(t),i=o.exec(e);if(n){if(!n[2]&&"px"==i[2])return i[1];if("px"==n[2]&&!i[2])return i[1]+"px"}return e}function e(e){return{elements:{$:function(r){var o=(o=r.attributes)&&o["data-cke-realelement"],s=n(e,decodeURIComponent(o));if((o=(o=o&&new CKEDITOR.htmlParser.fragment.fromHtml(s))&&o.children[0])&&r.attributes["data-cke-resizable"]){var a=new i(r).rules;r=o.attributes,s=a.width,a=a.height,s&&(r.width=t(r.width,s)),a&&(r.height=t(r.height,a))}return o}}}}function n(t,e){var n=[],i=/^cke:/i,r=new CKEDITOR.htmlParser.filter({elements:{"^":function(t){i.test(t.name)&&(t.name=t.name.replace(i,""),n.push(t))},iframe:function(t){t.children=[]}}}),o=t.activeFilter,s=new CKEDITOR.htmlParser.basicWriter,a=CKEDITOR.htmlParser.fragment.fromHtml(e);return r.applyTo(a),o.applyTo(a),CKEDITOR.tools.array.forEach(n,function(t){t.name="cke:"+t.name}),a.writeHtml(s),s.getHtml()}var i=CKEDITOR.htmlParser.cssStyle,r=CKEDITOR.tools.cssLength,o=/^((?:\d*(?:\.\d+))|(?:\d+))(.*)?$/i;CKEDITOR.plugins.add("fakeobjects",{init:function(t){t.filter.allow("img[!data-cke-realelement,src,alt,title](*){*}","fakeobjects")},afterInit:function(t){var n=t.dataProcessor;(n=n&&n.htmlFilter)&&n.addRules(e(t),{applyToAll:!0})}}),CKEDITOR.editor.prototype.createFakeElement=function(t,e,n,o){var s=(s=this.lang.fakeobjects)[n]||s.unknown;return e={class:e,"data-cke-realelement":encodeURIComponent(t.getOuterHtml()),"data-cke-real-node-type":t.type,alt:s,title:s,align:t.getAttribute("align")||""},CKEDITOR.env.hc||(e.src=CKEDITOR.tools.transparentImageData),n&&(e["data-cke-real-element-type"]=n),o&&(e["data-cke-resizable"]=o,n=new i,o=t.getAttribute("width"),t=t.getAttribute("height"),o&&(n.rules.width=r(o)),t&&(n.rules.height=r(t)),n.populate(e)),this.document.createElement("img",{attributes:e})},CKEDITOR.editor.prototype.createFakeParserElement=function(t,e,n,o){var s,a=(a=this.lang.fakeobjects)[n]||a.unknown;return s=new CKEDITOR.htmlParser.basicWriter,t.writeHtml(s),s=s.getHtml(),e={class:e,"data-cke-realelement":encodeURIComponent(s),"data-cke-real-node-type":t.type,alt:a,title:a,align:t.attributes.align||""},CKEDITOR.env.hc||(e.src=CKEDITOR.tools.transparentImageData),n&&(e["data-cke-real-element-type"]=n),o&&(e["data-cke-resizable"]=o,o=t.attributes,t=new i,n=o.width,o=o.height,void 0!==n&&(t.rules.width=r(n)),void 0!==o&&(t.rules.height=r(o)),t.populate(e)),new CKEDITOR.htmlParser.element("img",e)},CKEDITOR.editor.prototype.restoreRealElement=function(e){if(e.data("cke-real-node-type")!=CKEDITOR.NODE_ELEMENT)return null;var i=n(this,i=decodeURIComponent(e.data("cke-realelement")));i=CKEDITOR.dom.element.createFromHtml(i,this.document);if(e.data("cke-resizable")){var r=e.getStyle("width");e=e.getStyle("height"),r&&i.setAttribute("width",t(i.getAttribute("width"),r)),e&&i.setAttribute("height",t(i.getAttribute("height"),e))}return i}}(),function(){function t(t){return t.replace(/'/g,"\\$&")}function e(t){for(var e,n=t.length,i=[],r=0;r<n;r++)e=t.charCodeAt(r),i.push(e);return"String.fromCharCode("+i.join(",")+")"}function n(e,n){for(var i,r,o=(s=e.plugins.link).compiledProtectionFunction.params,s=[s.compiledProtectionFunction.name,"("],a=0;a<o.length;a++)r=n[i=o[a].toLowerCase()],0<a&&s.push(","),s.push("'",r?t(encodeURIComponent(n[i])):"","'");return s.push(")"),s.join("")}CKEDITOR.plugins.add("link",{requires:"dialog,fakeobjects",onLoad:function(){function t(t){return n.replace(/%1/g,"rtl"==t?"right":"left").replace(/%2/g,"cke_contents_"+t)}var e="background:url("+CKEDITOR.getUrl(this.path+"images"+(CKEDITOR.env.hidpi?"/hidpi":"")+"/anchor.png")+") no-repeat %1 center;border:1px dotted #00f;background-size:16px;",n=".%2 a.cke_anchor,.%2 a.cke_anchor_empty,.cke_editable.%2 a[name],.cke_editable.%2 a[data-cke-saved-name]{"+e+"padding-%1:18px;cursor:auto;}.%2 img.cke_anchor{"+e+"width:16px;min-height:15px;height:1.15em;vertical-align:text-bottom;}";CKEDITOR.addCss(t("ltr")+t("rtl"))},init:function(t){var e="a[!href]";CKEDITOR.dialog.isTabEnabled(t,"link","advanced")&&(e=e.replace("]",",accesskey,charset,dir,id,lang,name,rel,tabindex,title,type,download]{*}(*)")),CKEDITOR.dialog.isTabEnabled(t,"link","target")&&(e=e.replace("]",",target,onclick]")),t.addCommand("link",new CKEDITOR.dialogCommand("link",{allowedContent:e,requiredContent:"a[href]"})),t.addCommand("anchor",new CKEDITOR.dialogCommand("anchor",{allowedContent:"a[!name,id]",requiredContent:"a[name]"})),t.addCommand("unlink",new CKEDITOR.unlinkCommand),t.addCommand("removeAnchor",new CKEDITOR.removeAnchorCommand),t.setKeystroke(CKEDITOR.CTRL+76,"link"),t.setKeystroke(CKEDITOR.CTRL+75,"link"),t.ui.addButton&&(t.ui.addButton("Link",{label:t.lang.link.toolbar,command:"link",toolbar:"links,10"}),t.ui.addButton("Unlink",{label:t.lang.link.unlink,command:"unlink",toolbar:"links,20"}),t.ui.addButton("Anchor",{label:t.lang.link.anchor.toolbar,command:"anchor",toolbar:"links,30"})),CKEDITOR.dialog.add("link",this.path+"dialogs/link.js"),CKEDITOR.dialog.add("anchor",this.path+"dialogs/anchor.js"),t.on("doubleclick",function(e){var n=e.data.element.getAscendant({a:1,img:1},!0);n&&!n.isReadOnly()&&(n.is("a")?(e.data.dialog=!n.getAttribute("name")||n.getAttribute("href")&&n.getChildCount()?"link":"anchor",e.data.link=n):CKEDITOR.plugins.link.tryRestoreFakeAnchor(t,n)&&(e.data.dialog="anchor"))},null,null,0),t.on("doubleclick",function(e){e.data.dialog in{link:1,anchor:1}&&e.data.link&&t.getSelection().selectElement(e.data.link)},null,null,20),t.addMenuItems&&t.addMenuItems({anchor:{label:t.lang.link.anchor.menu,command:"anchor",group:"anchor",order:1},removeAnchor:{label:t.lang.link.anchor.remove,command:"removeAnchor",group:"anchor",order:5},link:{label:t.lang.link.menu,command:"link",group:"link",order:1},unlink:{label:t.lang.link.unlink,command:"unlink",group:"link",order:5}}),t.contextMenu&&t.contextMenu.addListener(function(e){if(!e||e.isReadOnly())return null;if(!(e=CKEDITOR.plugins.link.tryRestoreFakeAnchor(t,e))&&!(e=CKEDITOR.plugins.link.getSelectedLink(t)))return null;var n={};return e.getAttribute("href")&&e.getChildCount()&&(n={link:CKEDITOR.TRISTATE_OFF,unlink:CKEDITOR.TRISTATE_OFF}),e&&e.hasAttribute("name")&&(n.anchor=n.removeAnchor=CKEDITOR.TRISTATE_OFF),n}),this.compiledProtectionFunction=function(t){var e;return(t=t.config.emailProtection||"")&&"encode"!=t&&(e={},t.replace(/^([^(]+)\(([^)]+)\)$/,function(t,n,i){e.name=n,e.params=[],i.replace(/[^,\s]+/g,function(t){e.params.push(t)})})),e}(t)},afterInit:function(t){t.dataProcessor.dataFilter.addRules({elements:{a:function(e){return e.attributes.name?e.children.length?null:t.createFakeParserElement(e,"cke_anchor","anchor"):null}}});var e=t._.elementsPath&&t._.elementsPath.filters;e&&e.push(function(e,n){if("a"==n&&(CKEDITOR.plugins.link.tryRestoreFakeAnchor(t,e)||e.getAttribute("name")&&(!e.getAttribute("href")||!e.getChildCount())))return"anchor"})}});var i=/^javascript:/,r=/^(?:mailto)(?:(?!\?(subject|body)=).)+/i,o=/subject=([^;?:@&=$,\/]*)/i,s=/body=([^;?:@&=$,\/]*)/i,a=/^#(.*)$/,l=/^((?:http|https|ftp|news):\/\/)?(.*)$/,c=/^(_(?:self|top|parent|blank))$/,u=/^javascript:void\(location\.href='mailto:'\+String\.fromCharCode\(([^)]+)\)(?:\+'(.*)')?\)$/,h=/^javascript:([^(]+)\(([^)]+)\)$/,d=/\s*window.open\(\s*this\.href\s*,\s*(?:'([^']*)'|null)\s*,\s*'([^']*)'\s*\)\s*;\s*return\s*false;*\s*/,f=/(?:^|,)([^=]+)=(\d+|yes|no)/gi,p=/^tel:(.*)$/,g={id:"advId",dir:"advLangDir",accessKey:"advAccessKey",name:"advName",lang:"advLangCode",tabindex:"advTabIndex",title:"advTitle",type:"advContentType",class:"advCSSClasses",charset:"advCharset",style:"advStyles",rel:"advRel"};CKEDITOR.plugins.link={getSelectedLink:function(t,e){var n,i=t.getSelection(),r=i.getSelectedElement(),o=i.getRanges(),s=[];if(!e&&r&&r.is("a"))return r;for(r=0;r<o.length;r++)if((n=i.getRanges()[r]).shrink(CKEDITOR.SHRINK_ELEMENT,!0,{skipBogus:!0}),(n=t.elementPath(n.getCommonAncestor()).contains("a",1))&&e)s.push(n);else if(n)return n;return e?s:null},getEditorAnchors:function(t){for(var e,n=(i=(n=t.editable()).isInline()&&!t.plugins.divarea?t.document:n).getElementsByTag("a"),i=i.getElementsByTag("img"),r=[],o=0;e=n.getItem(o++);)(e.data("cke-saved-name")||e.hasAttribute("name"))&&r.push({name:e.data("cke-saved-name")||e.getAttribute("name"),id:e.getAttribute("id")});for(o=0;e=i.getItem(o++);)(e=this.tryRestoreFakeAnchor(t,e))&&r.push({name:e.getAttribute("name"),id:e.getAttribute("id")});return r},fakeAnchor:!0,tryRestoreFakeAnchor:function(t,e){if(e&&e.data("cke-real-element-type")&&"anchor"==e.data("cke-real-element-type")){var n=t.restoreRealElement(e);if(n.data("cke-saved-name"))return n}},parseLinkAttributes:function(t,e){var n,m=e&&(e.data("cke-saved-href")||e.getAttribute("href"))||"",v=t.plugins.link.compiledProtectionFunction,y=t.config.emailProtection,b={};if(m.match(i)&&("encode"==y?m=m.replace(u,function(t,e,n){return n=n||"","mailto:"+String.fromCharCode.apply(String,e.split(","))+n.replace(/\\'/g,"'")}):y&&m.replace(h,function(t,e,n){if(e==v.name){b.type="email",t=b.email={},e=/(^')|('$)/g;for(var i,r=(n=n.match(/[^,\s]+/g)).length,o=0;o<r;o++)i=decodeURIComponent(i=n[o].replace(e,"").replace(/\\'/g,"'")),t[v.params[o].toLowerCase()]=i;t.address=[t.name,t.domain].join("@")}})),!b.type)if(y=m.match(a))b.type="anchor",b.anchor={},b.anchor.name=b.anchor.id=y[1];else if(y=m.match(p))b.type="tel",b.tel=y[1];else if(y=m.match(r)){n=m.match(o);m=m.match(s);var C=b.email={};b.type="email",C.address=y[0].replace("mailto:",""),n&&(C.subject=decodeURIComponent(n[1])),m&&(C.body=decodeURIComponent(m[1]))}else m&&(n=m.match(l))&&(b.type="url",b.url={},b.url.protocol=n[1],b.url.url=n[2]);if(e){if(m=e.getAttribute("target"))b.target={type:m.match(c)?m:"frame",name:m};else if(m=(m=e.data("cke-pa-onclick")||e.getAttribute("onclick"))&&m.match(d))for(b.target={type:"popup",name:m[1]};y=f.exec(m[2]);)"yes"!=y[2]&&"1"!=y[2]||y[1]in{height:1,width:1,top:1,left:1}?isFinite(y[2])&&(b.target[y[1]]=y[2]):b.target[y[1]]=!0;null!==e.getAttribute("download")&&(b.download=!0);var I;m={};for(I in g)(y=e.getAttribute(I))&&(m[g[I]]=y);(I=e.data("cke-saved-name")||m.advName)&&(m.advName=I),CKEDITOR.tools.isEmpty(m)||(b.advanced=m)}return b},getLinkAttributes:function(i,r){var o=i.config.emailProtection||"",s={};switch(r.type){case"url":o=r.url&&void 0!==r.url.protocol?r.url.protocol:"http://";var a=r.url&&CKEDITOR.tools.trim(r.url.url)||"";s["data-cke-saved-href"]=0===a.indexOf("/")?a:o+a;break;case"anchor":o=r.anchor&&r.anchor.id,s["data-cke-saved-href"]="#"+(r.anchor&&r.anchor.name||o||"");break;case"email":a=(u=r.email).address;switch(o){case"":case"encode":var l=encodeURIComponent(u.subject||""),c=encodeURIComponent(u.body||""),u=[];l&&u.push("subject="+l),c&&u.push("body="+c),u=u.length?"?"+u.join("&"):"","encode"==o?(o=["javascript:void(location.href='mailto:'+",e(a)],u&&o.push("+'",t(u),"'"),o.push(")")):o=["mailto:",a,u];break;default:o=a.split("@",2),u.name=o[0],u.domain=o[1],o=["javascript:",n(i,u)]}s["data-cke-saved-href"]=o.join("");break;case"tel":s["data-cke-saved-href"]="tel:"+r.tel}if(r.target)if("popup"==r.target.type){o=["window.open(this.href, '",r.target.name||"","', '"];var h="resizable status location toolbar menubar fullscreen scrollbars dependent".split(" ");for(a=h.length,l=function(t){r.target[t]&&h.push(t+"="+r.target[t])},u=0;u<a;u++)h[u]+=r.target[h[u]]?"=yes":"=no";l("width"),l("left"),l("height"),l("top"),o.push(h.join(","),"'); return false;"),s["data-cke-pa-onclick"]=o.join("")}else"notSet"!=r.target.type&&r.target.name&&(s.target=r.target.name);if(r.download&&(s.download=""),r.advanced){for(var d in g)(o=r.advanced[g[d]])&&(s[d]=o);s.name&&(s["data-cke-saved-name"]=s.name)}for(var f in s["data-cke-saved-href"]&&(s.href=s["data-cke-saved-href"]),d={target:1,onclick:1,"data-cke-pa-onclick":1,"data-cke-saved-name":1,download:1},r.advanced&&CKEDITOR.tools.extend(d,g),s)delete d[f];return{set:s,removed:CKEDITOR.tools.object.keys(d)}},showDisplayTextForElement:function(t,e){var n=e.getSelection();return!(e.widgets&&e.widgets.focused||n&&1<n.getRanges().length)&&(!t||!t.getName||!t.is({img:1,table:1,tbody:1,thead:1,tfoot:1,input:1,select:1,textarea:1}))}},CKEDITOR.unlinkCommand=function(){},CKEDITOR.unlinkCommand.prototype={exec:function(t){if(CKEDITOR.env.ie){var e,n=t.getSelection().getRanges()[0],i=n.getPreviousEditableNode()&&n.getPreviousEditableNode().getAscendant("a",!0)||n.getNextEditableNode()&&n.getNextEditableNode().getAscendant("a",!0);n.collapsed&&i&&(e=n.createBookmark(),n.selectNodeContents(i),n.select())}i=new CKEDITOR.style({element:"a",type:CKEDITOR.STYLE_INLINE,alwaysRemoveElement:1}),t.removeStyle(i),e&&(n.moveToBookmark(e),n.select())},refresh:function(t,e){var n=e.lastElement&&e.lastElement.getAscendant("a",!0);n&&"a"==n.getName()&&n.getAttribute("href")&&n.getChildCount()?this.setState(CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_DISABLED)},contextSensitive:1,startDisabled:1,requiredContent:"a[href]",editorFocus:1},CKEDITOR.removeAnchorCommand=function(){},CKEDITOR.removeAnchorCommand.prototype={exec:function(t){var e,n=t.getSelection(),i=n.createBookmarks();n&&(e=n.getSelectedElement())&&(e.getChildCount()?e.is("a"):CKEDITOR.plugins.link.tryRestoreFakeAnchor(t,e))?e.remove(1):(e=CKEDITOR.plugins.link.getSelectedLink(t))&&(e.hasAttribute("href")?(e.removeAttributes({name:1,"data-cke-saved-name":1}),e.removeClass("cke_anchor")):e.remove(1)),n.selectBookmarks(i)},requiredContent:"a[name]"},CKEDITOR.tools.extend(CKEDITOR.config,{linkShowAdvancedTab:!0,linkShowTargetTab:!0,linkDefaultProtocol:"http://"})}(),function(){function t(t,e,n,i){for(var r=CKEDITOR.plugins.list.listToArray(e.root,n),o=[],s=0;s<e.contents.length;s++){(c=(c=e.contents[s]).getAscendant("li",!0))&&!c.getCustomData("list_item_processed")&&(o.push(c),CKEDITOR.dom.element.setMarker(n,c,"list_item_processed",!0))}var a,l,c=e.root.getDocument();for(s=0;s<o.length;s++){var u=o[s].getCustomData("listarray_index");(a=r[u].parent).is(this.type)||(l=c.createElement(this.type),a.copyAttributes(l,{start:1,type:1}),l.removeStyle("list-style-type"),r[u].parent=l)}var h;for(r=(n=CKEDITOR.plugins.list.arrayToList(r,n,null,t.config.enterMode)).listNode.getChildCount(),s=0;s<r&&(h=n.listNode.getChild(s));s++)h.getName()==this.type&&i.push(h);n.listNode.replace(e.root),t.fire("contentDomInvalidated")}function e(t,e,n){var i=e.contents,r=e.root.getDocument(),o=[];if(1==i.length&&i[0].equals(e.root)){var s=r.createElement("div");i[0].moveChildren&&i[0].moveChildren(s),i[0].append(s),i[0]=s}for(e=e.contents[0].getParent(),s=0;s<i.length;s++)e=e.getCommonAncestor(i[s].getParent());t=t.config.useComputedState;var a,l;for(s=0;s<i.length;s++)for(var c,u=i[s];c=u.getParent();){if(c.equals(e)){o.push(u),!l&&u.getDirection()&&(l=1),u=u.getDirection(t),null!==a&&(a=a&&a!=u?null:u);break}u=c}if(!(1>o.length)){for(i=o[o.length-1].getNext(),s=r.createElement(this.type),n.push(s);o.length;)n=o.shift(),t=r.createElement("li"),(u=n).is("pre")||p.test(u.getName())||"false"==u.getAttribute("contenteditable")?n.appendTo(t):(n.copyAttributes(t),a&&n.getDirection()&&(t.removeStyle("direction"),t.removeAttribute("dir")),n.moveChildren(t),n.remove()),t.appendTo(s);a&&l&&s.setAttribute("dir",a),i?s.insertBefore(i):s.appendTo(e)}}function n(t,e,n){function i(n){!(l=u[n?"getFirst":"getLast"]())||l.is&&l.isBlockBoundary()||!(c=e.root[n?"getPrevious":"getNext"](CKEDITOR.dom.walker.invisible(!0)))||c.is&&c.isBlockBoundary({br:1})||t.document.createElement("br")[n?"insertBefore":"insertAfter"](l)}for(var r=CKEDITOR.plugins.list.listToArray(e.root,n),o=[],s=0;s<e.contents.length;s++){var a=e.contents[s];(a=a.getAscendant("li",!0))&&!a.getCustomData("list_item_processed")&&(o.push(a),CKEDITOR.dom.element.setMarker(n,a,"list_item_processed",!0))}for(a=null,s=0;s<o.length;s++)r[a=o[s].getCustomData("listarray_index")].indent=-1;for(s=a+1;s<r.length;s++)if(r[s].indent>r[s-1].indent+1){for(o=r[s-1].indent+1-r[s].indent,a=r[s].indent;r[s]&&r[s].indent>=a;)r[s].indent+=o,s++;s--}var l,c,u=CKEDITOR.plugins.list.arrayToList(r,n,null,t.config.enterMode,e.root.getAttribute("dir")).listNode;i(!0),i(),u.replace(e.root),t.fire("contentDomInvalidated")}function i(t,e){this.name=t,this.context=this.type=e,this.allowedContent=e+" li",this.requiredContent=e}function r(t,e,n,i){for(var r,o;r=t[i?"getLast":"getFirst"](g);)(o=r.getDirection(1))!==e.getDirection(1)&&r.setAttribute("dir",o),r.remove(),n?r[i?"insertBefore":"insertAfter"](n):e.append(r,i),n=r}function o(t){function e(e){var n=t[e?"getPrevious":"getNext"](d);n&&n.type==CKEDITOR.NODE_ELEMENT&&n.is(t.getName())&&(r(t,n,null,!e),t.remove(),t=n)}e(),e(1)}function s(t){return t.type==CKEDITOR.NODE_ELEMENT&&(t.getName()in CKEDITOR.dtd.$block||t.getName()in CKEDITOR.dtd.$listItem)&&CKEDITOR.dtd[t.getName()]["#"]}function a(t,e,n){t.fire("saveSnapshot"),n.enlarge(CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS);var i=n.extractContents();e.trim(!1,!0);var s=e.createBookmark(),a=(c=new CKEDITOR.dom.elementPath(e.startContainer)).block,c=c.lastElement.getAscendant("li",1)||a,u=(h=new CKEDITOR.dom.elementPath(n.startContainer)).contains(CKEDITOR.dtd.$listItem),h=h.contains(CKEDITOR.dtd.$list);for(a?(a=a.getBogus())&&a.remove():h&&(a=h.getPrevious(d))&&f(a)&&a.remove(),(a=i.getLast())&&a.type==CKEDITOR.NODE_ELEMENT&&a.is("br")&&a.remove(),(a=e.startContainer.getChild(e.startOffset))?i.insertBefore(a):e.startContainer.append(i),u&&(i=l(u))&&(c.contains(u)?(r(i,u.getParent(),u),i.remove()):c.append(i));n.checkStartOfBlock()&&n.checkEndOfBlock()&&(i=(h=n.startPath()).block);)i.is("li")&&(c=i.getParent(),i.equals(c.getLast(d))&&i.equals(c.getFirst(d))&&(i=c)),n.moveToPosition(i,CKEDITOR.POSITION_BEFORE_START),i.remove();n=n.clone(),i=t.editable(),n.setEndAt(i,CKEDITOR.POSITION_BEFORE_END),(n=new CKEDITOR.dom.walker(n)).evaluator=function(t){return d(t)&&!f(t)},(n=n.next())&&n.type==CKEDITOR.NODE_ELEMENT&&n.getName()in CKEDITOR.dtd.$list&&o(n),e.moveToBookmark(s),e.select(),t.fire("saveSnapshot")}function l(t){return(t=t.getLast(d))&&t.type==CKEDITOR.NODE_ELEMENT&&t.getName()in c?t:null}var c={ol:1,ul:1},u=CKEDITOR.dom.walker.whitespaces(),h=CKEDITOR.dom.walker.bookmark(),d=function(t){return!(u(t)||h(t))},f=CKEDITOR.dom.walker.bogus();CKEDITOR.plugins.list={listToArray:function(t,e,n,i,r){if(!c[t.getName()])return[];i||(i=0),n||(n=[]);for(var o=0,s=t.getChildCount();o<s;o++){var a=t.getChild(o);if(a.type==CKEDITOR.NODE_ELEMENT&&a.getName()in CKEDITOR.dtd.$list&&CKEDITOR.plugins.list.listToArray(a,e,n,i+1),"li"==a.$.nodeName.toLowerCase()){var l={parent:t,indent:i,element:a,contents:[]};r?l.grandparent=r:(l.grandparent=t.getParent(),l.grandparent&&"li"==l.grandparent.$.nodeName.toLowerCase()&&(l.grandparent=l.grandparent.getParent())),e&&CKEDITOR.dom.element.setMarker(e,a,"listarray_index",n.length),n.push(l);for(var u,h=0,d=a.getChildCount();h<d;h++)(u=a.getChild(h)).type==CKEDITOR.NODE_ELEMENT&&c[u.getName()]?CKEDITOR.plugins.list.listToArray(u,e,n,i+1,l.grandparent):l.contents.push(u)}}return n},arrayToList:function(t,e,n,i,r){if(n||(n=0),!t||t.length<n+1)return null;for(var o,s,a,l=t[n].parent.getDocument(),u=new CKEDITOR.dom.documentFragment(l),f=null,p=n,g=Math.max(t[n].indent,0),m=null,v=i==CKEDITOR.ENTER_P?"p":"div";;){var y=t[p];if(o=y.grandparent,s=y.element.getDirection(1),y.indent==g){for(f&&t[p].parent.getName()==f.getName()||(f=t[p].parent.clone(!1,1),r&&f.setAttribute("dir",r),u.append(f)),m=f.append(y.element.clone(0,1)),s!=f.getDirection(1)&&m.setAttribute("dir",s),o=0;o<y.contents.length;o++)m.append(y.contents[o].clone(1,1));p++}else if(y.indent==Math.max(g,0)+1)y=t[p-1].element.getDirection(1),p=CKEDITOR.plugins.list.arrayToList(t,null,p,i,y!=s?s:null),!m.getChildCount()&&CKEDITOR.env.needsNbspFiller&&7>=l.$.documentMode&&m.append(l.createText("\xa0")),m.append(p.listNode),p=p.nextIndex;else{if(-1!=y.indent||n||!o)return null;c[o.getName()]?(m=y.element.clone(!1,!0),s!=o.getDirection(1)&&m.setAttribute("dir",s)):m=new CKEDITOR.dom.documentFragment(l);f=o.getDirection(1)!=s;var b,C,I=y.element,E=I.getAttribute("class"),T=I.getAttribute("style"),w=m.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&(i!=CKEDITOR.ENTER_BR||f||T||E),x=y.contents.length;for(o=0;o<x;o++)if(b=y.contents[o],h(b)&&1<x)w?C=b.clone(1,1):m.append(b.clone(1,1));else if(b.type==CKEDITOR.NODE_ELEMENT&&b.isBlockBoundary()){f&&!b.getDirection()&&b.setAttribute("dir",s),a=b;var _=I.getAttribute("style");_&&a.setAttribute("style",_.replace(/([^;])$/,"$1;")+(a.getAttribute("style")||"")),E&&b.addClass(E),a=null,C&&(m.append(C),C=null),m.append(b.clone(1,1))}else w?(a||(a=l.createElement(v),m.append(a),f&&a.setAttribute("dir",s)),T&&a.setAttribute("style",T),E&&a.setAttribute("class",E),C&&(a.append(C),C=null),a.append(b.clone(1,1))):m.append(b.clone(1,1));C&&((a||m).append(C),C=null),m.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&p!=t.length-1&&(CKEDITOR.env.needsBrFiller&&(s=m.getLast())&&s.type==CKEDITOR.NODE_ELEMENT&&s.is("br")&&s.remove(),(s=m.getLast(d))&&s.type==CKEDITOR.NODE_ELEMENT&&s.is(CKEDITOR.dtd.$block)||m.append(l.createElement("br"))),"div"!=(s=m.$.nodeName.toLowerCase())&&"p"!=s||m.appendBogus(),u.append(m),f=null,p++}if(a=null,t.length<=p||Math.max(t[p].indent,0)<g)break}if(e)for(t=u.getFirst();t;){if(t.type==CKEDITOR.NODE_ELEMENT&&(CKEDITOR.dom.element.clearMarkers(e,t),t.getName()in CKEDITOR.dtd.$listItem&&(l=r=i=void 0,i=(n=t).getDirection()))){for(r=n.getParent();r&&!(l=r.getDirection());)r=r.getParent();i==l&&n.removeAttribute("dir")}t=t.getNextSourceNode()}return{listNode:u,nextIndex:p}}};var p=/^h[1-6]$/,g=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT);i.prototype={exec:function(i){function r(t){return c[t.root.getName()]&&!function(t,e){return CKEDITOR.tools.array.filter(t.getChildren().toArray(),function(t){return-1===CKEDITOR.tools.array.indexOf(e,t.type)}).length}(t.root,[CKEDITOR.NODE_COMMENT])}function s(t){var e=!0;return 0!==t.getChildCount()&&(t.forEach(function(t){if(t.type!==CKEDITOR.NODE_COMMENT)return e=!1},null,!0),e)}this.refresh(i,i.elementPath());var a=i.config,l=i.getSelection(),u=l&&l.getRanges();if(this.state==CKEDITOR.TRISTATE_OFF)if((f=i.editable()).getFirst(d)){var h=1==u.length&&u[0];(a=h&&h.getEnclosedNode())&&a.is&&this.type==a.getName()&&this.setState(CKEDITOR.TRISTATE_ON)}else a.enterMode==CKEDITOR.ENTER_BR?f.appendBogus():u[0].fixBlock(1,a.enterMode==CKEDITOR.ENTER_P?"p":"div"),l.selectRanges(u);a=l.createBookmarks(!0);for(var f=[],p={},g=(u=u.createIterator(),0);(h=u.getNextRange())&&++g;){var m=h.getBoundaryNodes(),v=m.startNode,y=m.endNode;for(v.type==CKEDITOR.NODE_ELEMENT&&"td"==v.getName()&&h.setStartAt(m.startNode,CKEDITOR.POSITION_AFTER_START),y.type==CKEDITOR.NODE_ELEMENT&&"td"==y.getName()&&h.setEndAt(m.endNode,CKEDITOR.POSITION_BEFORE_END),(h=h.createIterator()).forceBrBreak=this.state==CKEDITOR.TRISTATE_OFF;m=h.getNextParagraph();)if(!m.getCustomData("list_block")&&!s(m)){CKEDITOR.dom.element.setMarker(p,m,"list_block",1);v=(C=i.elementPath(m)).elements,y=0;for(var b,C=C.blockLimit,I=v.length-1;0<=I&&(b=v[I]);I--)if(c[b.getName()]&&C.contains(b)){C.removeCustomData("list_group_object_"+g),(v=b.getCustomData("list_group_object"))?v.contents.push(m):(v={root:b,contents:[m]},f.push(v),CKEDITOR.dom.element.setMarker(p,b,"list_group_object",v)),y=1;break}y||((y=C).getCustomData("list_group_object_"+g)?y.getCustomData("list_group_object_"+g).contents.push(m):(v={root:y,contents:[m]},CKEDITOR.dom.element.setMarker(p,y,"list_group_object_"+g,v),f.push(v)))}}for(b=[];0<f.length;)v=f.shift(),this.state==CKEDITOR.TRISTATE_OFF?r(v)||(c[v.root.getName()]?t.call(this,i,v,p,b):e.call(this,i,v,b)):this.state==CKEDITOR.TRISTATE_ON&&c[v.root.getName()]&&!r(v)&&n.call(this,i,v,p);for(I=0;I<b.length;I++)o(b[I]);CKEDITOR.dom.element.clearAllMarkers(p),l.selectBookmarks(a),i.focus()},refresh:function(t,e){var n=e.contains(c,1),i=e.blockLimit||e.root;n&&i.contains(n)?this.setState(n.is(this.type)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.plugins.add("list",{requires:"indentlist",init:function(t){t.blockless||(t.addCommand("numberedlist",new i("numberedlist","ol")),t.addCommand("bulletedlist",new i("bulletedlist","ul")),t.ui.addButton&&(t.ui.addButton("NumberedList",{isToggle:!0,label:t.lang.list.numberedlist,command:"numberedlist",directional:!0,toolbar:"list,10"}),t.ui.addButton("BulletedList",{isToggle:!0,label:t.lang.list.bulletedlist,command:"bulletedlist",directional:!0,toolbar:"list,20"})),t.on("key",function(e){var n,i=e.data.domEvent.getKey();if("wysiwyg"==t.mode&&i in{8:1,46:1}){var r=t.getSelection().getRanges()[0],o=r&&r.startPath();if(r&&r.collapsed){var u,h=8==i,p=t.editable(),g=new CKEDITOR.dom.walker(r.clone());if(g.evaluator=function(t){return d(t)&&!f(t)},g.guard=function(t,e){return!(e&&t.type==CKEDITOR.NODE_ELEMENT&&t.is("table"))},i=r.clone(),h)if((u=o.contains(c))&&r.checkBoundaryOfElement(u,CKEDITOR.START)&&(u=u.getParent())&&u.is("li")&&(u=l(u))?(n=u,u=u.getPrevious(d),i.moveToPosition(u&&f(u)?u:n,CKEDITOR.POSITION_BEFORE_START)):(g.range.setStartAt(p,CKEDITOR.POSITION_AFTER_START),g.range.setEnd(r.startContainer,r.startOffset),(u=g.previous())&&u.type==CKEDITOR.NODE_ELEMENT&&(u.getName()in c||u.is("li"))&&(u.is("li")||(g.range.selectNodeContents(u),g.reset(),g.evaluator=s,u=g.previous()),n=u,i.moveToElementEditEnd(n),i.moveToPosition(i.endPath().block,CKEDITOR.POSITION_BEFORE_END))),n)a(t,i,r),e.cancel();else{var m=o.contains(c);m&&r.checkBoundaryOfElement(m,CKEDITOR.START)&&(n=m.getFirst(d),r.checkBoundaryOfElement(n,CKEDITOR.START)&&(u=m.getPrevious(d),l(n)?u&&(r.moveToElementEditEnd(u),r.select()):t.execCommand("outdent"),e.cancel()))}else if(n=o.contains("li")){if(g.range.setEndAt(p,CKEDITOR.POSITION_BEFORE_END),h=(p=n.getLast(d))&&s(p)?p:n,o=0,(u=g.next())&&u.type==CKEDITOR.NODE_ELEMENT&&u.getName()in c&&u.equals(p)?(o=1,u=g.next()):r.checkBoundaryOfElement(h,CKEDITOR.END)&&(o=2),o&&u){if((r=r.clone()).moveToElementEditStart(u),1==o&&(i.optimize(),!i.startContainer.equals(n))){for(n=i.startContainer;n.is(CKEDITOR.dtd.$inline);)m=n,n=n.getParent();m&&i.moveToPosition(m,CKEDITOR.POSITION_AFTER_END)}2==o&&(i.moveToPosition(i.endPath().block,CKEDITOR.POSITION_BEFORE_END),r.endPath().block&&r.moveToPosition(r.endPath().block,CKEDITOR.POSITION_AFTER_START)),a(t,i,r),e.cancel()}}else g.range.setEndAt(p,CKEDITOR.POSITION_BEFORE_END),(u=g.next())&&u.type==CKEDITOR.NODE_ELEMENT&&u.is(c)&&(u=u.getFirst(d),o.block&&r.checkStartOfBlock()&&r.checkEndOfBlock()?(o.block.remove(),r.moveToElementEditStart(u),r.select()):l(u)?(r.moveToElementEditStart(u),r.select()):((r=r.clone()).moveToElementEditStart(u),a(t,i,r)),e.cancel());setTimeout(function(){t.selectionChange(1)})}}}))}})}(),function(){var t=[CKEDITOR.CTRL+90,CKEDITOR.CTRL+89,CKEDITOR.CTRL+CKEDITOR.SHIFT+90],e={8:1,46:1};CKEDITOR.plugins.add("undo",{init:function(e){function i(t){s.enabled&&!1!==t.data.command.canUndo&&s.save()}function r(){s.enabled=!e.readOnly&&"wysiwyg"==e.mode,s.onChange()}var s=e.undoManager=new n(e),a=s.editingHandler=new o(s),l=e.addCommand("undo",{exec:function(){s.undo()&&(e.selectionChange(),this.fire("afterUndo"))},startDisabled:!0,canUndo:!1}),c=e.addCommand("redo",{exec:function(){s.redo()&&(e.selectionChange(),this.fire("afterRedo"))},startDisabled:!0,canUndo:!1});e.setKeystroke([[t[0],"undo"],[t[1],"redo"],[t[2],"redo"]]),s.onChange=function(){l.setState(s.undoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),c.setState(s.redoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)},e.on("beforeCommandExec",i),e.on("afterCommandExec",i),e.on("saveSnapshot",function(t){s.save(t.data&&t.data.contentOnly)}),e.on("contentDom",a.attachListeners,a),e.on("instanceReady",function(){e.fire("saveSnapshot")}),e.on("beforeModeUnload",function(){"wysiwyg"==e.mode&&s.save(!0)}),e.on("mode",r),e.on("readOnly",r),e.ui.addButton&&(e.ui.addButton("Undo",{label:e.lang.undo.undo,command:"undo",toolbar:"undo,10"}),e.ui.addButton("Redo",{label:e.lang.undo.redo,command:"redo",toolbar:"undo,20"})),e.resetUndo=function(){s.reset(),e.fire("saveSnapshot")},e.on("updateSnapshot",function(){s.currentImage&&s.update()}),e.on("lockSnapshot",function(t){t=t.data,s.lock(t&&t.dontUpdate,t&&t.forceUpdate)}),e.on("unlockSnapshot",s.unlock,s)}}),CKEDITOR.plugins.undo={};var n=CKEDITOR.plugins.undo.UndoManager=function(t){this.strokesRecorded=[0,0],this.locked=null,this.previousKeyGroup=-1,this.limit=t.config.undoStackSize||20,this.strokesLimit=25,this._filterRules=[],this.editor=t,this.reset(),CKEDITOR.env.ie&&this.addFilterRule(function(t){return t.replace(/\s+data-cke-expando=".*?"/g,"")})};n.prototype={type:function(t,e){var i=n.getKeyGroup(t),r=this.strokesRecorded[i]+1;e=e||r>=this.strokesLimit,this.typing||(this.hasUndo=this.typing=!0,this.hasRedo=!1,this.onChange()),e?(r=0,this.editor.fire("saveSnapshot")):this.editor.fire("change"),this.strokesRecorded[i]=r,this.previousKeyGroup=i},keyGroupChanged:function(t){return n.getKeyGroup(t)!=this.previousKeyGroup},reset:function(){this.snapshots=[],this.index=-1,this.currentImage=null,this.hasRedo=this.hasUndo=!1,this.locked=null,this.resetType()},resetType:function(){this.strokesRecorded=[0,0],this.typing=!1,this.previousKeyGroup=-1},refreshState:function(){this.hasUndo=!!this.getNextImage(!0),this.hasRedo=!!this.getNextImage(!1),this.resetType(),this.onChange()},save:function(t,e,n){var r=this.editor;if(this.locked||"ready"!=r.status||"wysiwyg"!=r.mode)return!1;var o=r.editable();if(!o||"ready"!=o.status)return!1;if(o=this.snapshots,e||(e=new i(r)),!1===e.contents)return!1;if(this.currentImage)if(e.equalsContent(this.currentImage)){if(t||e.equalsSelection(this.currentImage))return!1}else!1!==n&&r.fire("change");return o.splice(this.index+1,o.length-this.index-1),o.length==this.limit&&o.shift(),this.index=o.push(e)-1,this.currentImage=e,!1!==n&&this.refreshState(),!0},restoreImage:function(t){var e,n=this.editor;t.bookmarks&&(n.focus(),e=n.getSelection()),this.locked={level:999},this.editor.loadSnapshot(t.contents),t.bookmarks?e.selectBookmarks(t.bookmarks):CKEDITOR.env.ie&&((e=this.editor.document.getBody().$.createTextRange()).collapse(!0),e.select()),this.locked=null,this.index=t.index,this.currentImage=this.snapshots[this.index],this.update(),this.refreshState(),n.fire("change")},getNextImage:function(t){var e,n=this.snapshots,i=this.currentImage;if(i)if(t){for(e=this.index-1;0<=e;e--)if(t=n[e],!i.equalsContent(t))return t.index=e,t}else for(e=this.index+1;e<n.length;e++)if(t=n[e],!i.equalsContent(t))return t.index=e,t;return null},redoable:function(){return this.enabled&&this.hasRedo},undoable:function(){return this.enabled&&this.hasUndo},undo:function(){if(this.undoable()){this.save(!0);var t=this.getNextImage(!0);if(t)return this.restoreImage(t),!0}return!1},redo:function(){if(this.redoable()&&(this.save(!0),this.redoable())){var t=this.getNextImage(!1);if(t)return this.restoreImage(t),!0}return!1},update:function(t){if(!this.locked){t||(t=new i(this.editor));for(var e=this.index,n=this.snapshots;0<e&&this.currentImage.equalsContent(n[e-1]);)--e;n.splice(e,this.index-e+1,t),this.index=e,this.currentImage=t}},updateSelection:function(t){if(!this.snapshots.length)return!1;var e=this.snapshots,n=e[e.length-1];return!(!n.equalsContent(t)||n.equalsSelection(t))&&(this.currentImage=e[e.length-1]=t,!0)},lock:function(t,e){if(this.locked)this.locked.level++;else if(t)this.locked={level:1};else{var n=null;if(e)n=!0;else{var r=new i(this.editor,!0);this.currentImage&&this.currentImage.equalsContent(r)&&(n=r)}this.locked={update:n,level:1}}},unlock:function(){if(this.locked&&! --this.locked.level){var t=this.locked.update;if(this.locked=null,!0===t)this.update();else if(t){var e=new i(this.editor,!0);t.equalsContent(e)||this.update()}}},addFilterRule:function(t){this._filterRules.push(t)}},n.navigationKeyCodes={37:1,38:1,39:1,40:1,36:1,35:1,33:1,34:1},n.keyGroups={PRINTABLE:0,FUNCTIONAL:1},n.isNavigationKey=function(t){return!!n.navigationKeyCodes[t]},n.getKeyGroup=function(t){var i=n.keyGroups;return e[t]?i.FUNCTIONAL:i.PRINTABLE},n.getOppositeKeyGroup=function(t){var e=n.keyGroups;return t==e.FUNCTIONAL?e.PRINTABLE:e.FUNCTIONAL},n.ieFunctionalKeysBug=function(t){return CKEDITOR.env.ie&&n.getKeyGroup(t)==n.keyGroups.FUNCTIONAL};var i=CKEDITOR.plugins.undo.Image=function(t,e){this.editor=t,t.fire("beforeUndoImage");var n=t.getSnapshot();n&&(this.contents=function(t,e){return CKEDITOR.tools.array.reduce(e,function(t,e){return e(t)},t)}(n,t.undoManager._filterRules)),e||(this.bookmarks=(n=n&&t.getSelection())&&n.createBookmarks2(!0)),t.fire("afterUndoImage")},r=/\b(?:href|src|name)="[^"]*?"/gi;i.prototype={equalsContent:function(t){var e=this.contents;return t=t.contents,CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)&&(e=e.replace(r,""),t=t.replace(r,"")),e==t},equalsSelection:function(t){var e=this.bookmarks;if(t=t.bookmarks,e||t){if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;n++){var i=e[n],r=t[n];if(i.startOffset!=r.startOffset||i.endOffset!=r.endOffset||!CKEDITOR.tools.arrayCompare(i.start,r.start)||!CKEDITOR.tools.arrayCompare(i.end,r.end))return!1}}return!0}};var o=CKEDITOR.plugins.undo.NativeEditingHandler=function(t){this.undoManager=t,this.ignoreInputEvent=!1,this.keyEventsStack=new s,this.lastKeydownImage=null};o.prototype={onKeydown:function(e){var r=e.data.getKey();229!==r&&(-1<CKEDITOR.tools.indexOf(t,e.data.getKeystroke())?e.data.preventDefault():(this.keyEventsStack.cleanUp(e),e=this.undoManager,this.keyEventsStack.getLast(r)||this.keyEventsStack.push(r),this.lastKeydownImage=new i(e.editor),(n.isNavigationKey(r)||this.undoManager.keyGroupChanged(r))&&(e.strokesRecorded[0]||e.strokesRecorded[1])&&(e.save(!1,this.lastKeydownImage,!1),e.resetType())))},onInput:function(){if(this.ignoreInputEvent)this.ignoreInputEvent=!1;else{var t=this.keyEventsStack.getLast();t||(t=this.keyEventsStack.push(0)),this.keyEventsStack.increment(t.keyCode),this.keyEventsStack.getTotalInputs()>=this.undoManager.strokesLimit&&(this.undoManager.type(t.keyCode,!0),this.keyEventsStack.resetInputs())}},onKeyup:function(t){var e=this.undoManager;t=t.data.getKey();var r=this.keyEventsStack.getTotalInputs();this.keyEventsStack.remove(t),n.ieFunctionalKeysBug(t)&&this.lastKeydownImage&&this.lastKeydownImage.equalsContent(new i(e.editor,!0))||(0<r?e.type(t):n.isNavigationKey(t)&&this.onNavigationKey(!0))},onNavigationKey:function(t){var e=this.undoManager;!t&&e.save(!0,null,!1)||e.updateSelection(new i(e.editor)),e.resetType()},ignoreInputEventListener:function(){this.ignoreInputEvent=!0},activateInputEventListener:function(){this.ignoreInputEvent=!1},attachListeners:function(){var t=this.undoManager.editor,e=t.editable(),i=this;e.attachListener(e,"keydown",function(t){i.onKeydown(t),n.ieFunctionalKeysBug(t.data.getKey())&&i.onInput()},null,null,999),e.attachListener(e,CKEDITOR.env.ie?"keypress":"input",i.onInput,i,null,999),e.attachListener(e,"keyup",i.onKeyup,i,null,999),e.attachListener(e,"paste",i.ignoreInputEventListener,i,null,999),e.attachListener(e,"drop",i.ignoreInputEventListener,i,null,999),t.on("afterPaste",i.activateInputEventListener,i,null,999),e.attachListener(e.isInline()?e:t.document.getDocumentElement(),"click",function(){i.onNavigationKey()},null,null,999),e.attachListener(this.undoManager.editor,"blur",function(){i.keyEventsStack.remove(9)},null,null,999)}};var s=CKEDITOR.plugins.undo.KeyEventsStack=function(){this.stack=[]};s.prototype={push:function(t){return t=this.stack.push({keyCode:t,inputs:0}),this.stack[t-1]},getLastIndex:function(t){if("number"!=typeof t)return this.stack.length-1;for(var e=this.stack.length;e--;)if(this.stack[e].keyCode==t)return e;return-1},getLast:function(t){return-1!=(t=this.getLastIndex(t))?this.stack[t]:null},increment:function(t){this.getLast(t).inputs++},remove:function(t){-1!=(t=this.getLastIndex(t))&&this.stack.splice(t,1)},resetInputs:function(t){if("number"==typeof t)this.getLast(t).inputs=0;else for(t=this.stack.length;t--;)this.stack[t].inputs=0},getTotalInputs:function(){for(var t=this.stack.length,e=0;t--;)e+=this.stack[t].inputs;return e},cleanUp:function(t){(t=t.data.$).ctrlKey||t.metaKey||this.remove(17),t.shiftKey||this.remove(16),t.altKey||this.remove(18)}}}(),function(){function t(t){function e(t){var e=!1;s.attachListener(s,"keydown",function(){var n=i.getBody().getElementsByTag(t);if(!e){for(var r=0;r<n.count();r++)n.getItem(r).setCustomData("retain",!0);e=!0}},null,null,1),s.attachListener(s,"keyup",function(){var n=i.getElementsByTag(t);e&&(1==n.count()&&!n.getItem(0).getCustomData("retain")&&CKEDITOR.tools.isEmpty(n.getItem(0).getAttributes())&&n.getItem(0).remove(1),e=!1)})}var n=this.editor;if(n&&!n.isDetached()){var i=t.document,r=i.body,o=i.getElementById("cke_actscrpt");o&&o.parentNode.removeChild(o),(o=i.getElementById("cke_shimscrpt"))&&o.parentNode.removeChild(o),(o=i.getElementById("cke_basetagscrpt"))&&o.parentNode.removeChild(o),r.contentEditable=!0,CKEDITOR.env.ie&&(r.hideFocus=!0,r.disabled=!0,r.removeAttribute("disabled")),delete this._.isLoadingData,this.$=r,i=new CKEDITOR.dom.document(i),this.setup(),this.fixInitialSelection();var s=this;CKEDITOR.env.ie&&!CKEDITOR.env.edge&&i.getDocumentElement().addClass(i.$.compatMode),CKEDITOR.env.ie&&!CKEDITOR.env.edge&&n.enterMode!=CKEDITOR.ENTER_P?e("p"):CKEDITOR.env.edge&&15>CKEDITOR.env.version&&n.enterMode!=CKEDITOR.ENTER_DIV&&e("div"),(CKEDITOR.env.webkit||CKEDITOR.env.ie&&10<CKEDITOR.env.version)&&i.getDocumentElement().on("mousedown",function(t){t.data.getTarget().is("html")&&setTimeout(function(){n.editable().focus()})}),function(t){function e(){var e;t.editable().attachListener(t,"selectionChange",function(){var i=t.getSelection().getSelectedElement();i&&(e&&(e.detachEvent("onresizestart",n),e=null),i.$.attachEvent("onresizestart",n),e=i.$)})}function n(t){t.returnValue=!1}if(CKEDITOR.env.gecko)try{var i=t.document.$;i.execCommand("enableObjectResizing",!1,!t.config.disableObjectResizing),i.execCommand("enableInlineTableEditing",!1,!t.config.disableNativeTableHandles)}catch(r){}else CKEDITOR.env.ie&&11>CKEDITOR.env.version&&t.config.disableObjectResizing&&e()}(n);try{n.document.$.execCommand("2D-position",!1,!0)}catch(a){}(CKEDITOR.env.gecko||CKEDITOR.env.ie&&"CSS1Compat"==n.document.$.compatMode)&&this.attachListener(this,"keydown",function(t){var e=t.data.getKeystroke();if(33==e||34==e)if(CKEDITOR.env.ie)setTimeout(function(){n.getSelection().scrollIntoView()},0);else if(n.window.$.innerHeight>this.$.offsetHeight){var i=n.createRange();i[33==e?"moveToElementEditStart":"moveToElementEditEnd"](this),i.select(),t.data.preventDefault()}}),CKEDITOR.env.ie&&this.attachListener(i,"blur",function(){try{i.$.selection.empty()}catch(t){}}),CKEDITOR.env.iOS&&this.attachListener(i,"touchend",function(){t.focus()}),(r=n.document.getElementsByTag("title").getItem(0)).data("cke-title",r.getText()),CKEDITOR.env.ie&&(n.document.$.title=this._.docTitle),CKEDITOR.tools.setTimeout(function(){"unloaded"==this.status&&(this.status="ready"),n.fire("contentDom"),this._.isPendingFocus&&(n.focus(),this._.isPendingFocus=!1),setTimeout(function(){n.fire("dataReady")},0)},0,this)}}var e;CKEDITOR.plugins.add("wysiwygarea",{init:function(t){t.config.fullPage&&t.addFeature({allowedContent:"html head title; style [media,type]; body (*)[id]; meta link [*]",requiredContent:"body"}),t.addMode("wysiwyg",function(n){function i(i){i&&i.removeListener(),t.isDestroyed()||t.isDetached()||(t.editable(new e(t,a.getFrameDocument().getBody())),t.setData(t.getData(1),n),!p)||(f&&t.on("mode",r,{iframe:a,editor:t,callback:n}),t.on("mode",function(){t.status="ready"}),c=new MutationObserver(function(e){for(var n=0;n<e.length;n++){var i=e[n];if("childList"===i.type&&0!==i.addedNodes.length)for(var r=0;r<i.addedNodes.length;r++){var s=i.addedNodes[r];s.contains&&s.contains(t.container.$)&&(f?d=!0:o())}}}),c.observe(t.config.observableParent,{childList:!0,subtree:!0}))}function r(t){t&&t.removeListener(),a.on("load",function(){d&&(d=!1,o())})}function o(){var i,r=t.getData(!1);t.editable().preserveIframe=!0,t.editable(null),i=new e(t,a.getFrameDocument().getBody()),t.editable(i),t.status="recreating",t.setData(r,{callback:n,internal:!1,noSnapshot:!1})}var s="document.open();"+(CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"")+"document.close();",a=(s=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie&&!CKEDITOR.env.edge?"javascript:void(function(){"+encodeURIComponent(s)+"}())":"",CKEDITOR.dom.element.createFromHtml('<iframe src="'+s+'" frameBorder="0"></iframe>'));a.setStyles({width:"100%",height:"100%"}),a.addClass("cke_wysiwyg_frame").addClass("cke_reset"),(s=t.ui.space("contents")).append(a);var l=CKEDITOR.env.ie&&!CKEDITOR.env.edge||CKEDITOR.env.gecko;l&&a.on("load",i);var c,u=t.title,h=t.fire("ariaEditorHelpLabel",{}).label,d=!1,f=CKEDITOR.env.ie&&11===CKEDITOR.env.version,p=!!window.MutationObserver;if(u&&(CKEDITOR.env.ie&&h&&(u+=", "+h),a.setAttribute("title",u)),h){u=CKEDITOR.tools.getNextId();var g=CKEDITOR.dom.element.createFromHtml('<span id="'+u+'" class="cke_voice_label">'+h+"</span>");s.append(g,1),a.setAttribute("aria-describedby",u)}t.on("beforeModeUnload",function(t){t.removeListener(),g&&g.remove(),p&&c.disconnect()}),t.on("destroy",function(){c&&c.disconnect()}),a.setAttributes({tabIndex:t.tabIndex,allowTransparency:"true"}),!l&&i(),t.fire("ariaWidget",a)})}}),CKEDITOR.editor.prototype.addContentsCss=function(t){var e=this.config,n=e.contentsCss;CKEDITOR.tools.isArray(n)||(e.contentsCss=n?[n]:[]),e.contentsCss.push(t)},e=CKEDITOR.tools.createClass({$:function(){this.base.apply(this,arguments),this._.frameLoadedHandler=CKEDITOR.tools.addFunction(function(e){CKEDITOR.tools.setTimeout(t,0,this,e)},this),this._.docTitle=this.getWindow().getFrame().getAttribute("title")||"\xa0"},base:CKEDITOR.editable,proto:{preserveIframe:!1,setData:function(t,e){var n=this.editor;if(e)this.setHtml(t),this.fixInitialSelection(),n.fire("dataReady");else{this._.isLoadingData=!0,n._.dataStore={id:1};var i=n.config,r=i.fullPage,o=i.docType,s=CKEDITOR.tools.buildStyleHtml(function(){var t=[];if(8<=CKEDITOR.document.$.documentMode){t.push("html.CSS1Compat [contenteditable=false]{min-height:0 !important}");var e,n=[];for(e in CKEDITOR.dtd.$removeEmpty)n.push("html.CSS1Compat "+e+"[contenteditable=false]");t.push(n.join(",")+"{display:inline-block}")}else CKEDITOR.env.gecko&&(t.push("html{height:100% !important}"),t.push("img:-moz-broken{-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"));return t.push("html{cursor:text;*cursor:auto}"),t.push("img,input,textarea{cursor:default}"),t.join("\n")}()).replace(/<style>/,'<style data-cke-temp="1">');r||(s+=CKEDITOR.tools.buildStyleHtml(n.config.contentsCss));var a=i.baseHref?'<base href="'+i.baseHref+'" data-cke-temp="1" />':"";r&&(t=t.replace(/<!DOCTYPE[^>]*>/i,function(t){return n.docType=o=t,""}).replace(/<\?xml\s[^\?]*\?>/i,function(t){return n.xmlDeclaration=t,""})),t=n.dataProcessor.toHtml(t),r?(/<body[\s|>]/.test(t)||(t="<body>"+t),/<html[\s|>]/.test(t)||(t="<html>"+t+"</html>"),/<head[\s|>]/.test(t)?/<title[\s|>]/.test(t)||(t=t.replace(/<head[^>]*>/,"$&<title></title>")):t=t.replace(/<html[^>]*>/,"$&<head><title></title></head>"),a&&(t=t.replace(/<head[^>]*?>/,"$&"+a)),t=t.replace(/<\/head\s*>/,s+"$&"),t=o+t):t=i.docType+'<html dir="'+i.contentsLangDirection+'" lang="'+(i.contentsLanguage||n.langCode)+'"><head><title>'+this._.docTitle+"</title>"+a+s+"</head><body"+(i.bodyId?' id="'+i.bodyId+'"':"")+(i.bodyClass?' class="'+i.bodyClass+'"':"")+">"+t+"</body></html>",CKEDITOR.env.gecko&&(t=t.replace(/<body/,'<body contenteditable="true" '),2e4>CKEDITOR.env.version&&(t=t.replace(/<body[^>]*>/,"$&\x3c!-- cke-content-start --\x3e"))),t=t.replace(/<body/,'<body role="textbox" aria-multiline="true"'),n.title&&(t=t.replace(/<body/,'<body aria-label="'+CKEDITOR.tools.htmlEncodeAttr(n.title)+'"')),CKEDITOR.env.gecko||(t=t.replace("<body",'<body tabindex="0" ')),i='<script id="cke_actscrpt" type="text/javascript"'+(CKEDITOR.env.ie?' defer="defer" ':"")+">var wasLoaded=0;function onload(){if(!wasLoaded)window.parent.CKEDITOR && window.parent.CKEDITOR.tools.callFunction("+this._.frameLoadedHandler+",window);wasLoaded=1;}"+(CKEDITOR.env.ie?"onload();":'document.addEventListener("DOMContentLoaded", onload, false );')+"<\/script>",CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(i+='<script id="cke_shimscrpt">window.parent.CKEDITOR.tools.enableHtml5Elements(document)<\/script>'),a&&CKEDITOR.env.ie&&10>CKEDITOR.env.version&&(i+='<script id="cke_basetagscrpt">var baseTag = document.querySelector( "base" );baseTag.href = baseTag.href;<\/script>'),t=t.replace(/(?=\s*<\/(:?head)>)/,i),this.clearCustomData(),this.clearListeners(),n.fire("contentDomUnload");var l=this.getDocument();try{l.write(t)}catch(c){setTimeout(function(){l.write(t)},0)}}},getData:function(t){if(t)return this.getHtml();var e=(t=this.editor).config,n=e.fullPage,i=n&&t.docType,r=n&&t.xmlDeclaration,o=this.getDocument();o=n?o.getDocumentElement().getOuterHtml():o.getBody().getHtml();return CKEDITOR.env.gecko&&e.enterMode!=CKEDITOR.ENTER_BR&&(o=o.replace(/<br>(?=\s*(:?$|<\/body>))/,"")),n&&(o=o.replace(/<body(.*?)role="?textbox"?/i,"<body$1").replace(/<body(.*?)aria-multiline="?true"?/i,"<body$1").replace(/<body(.*?)tabindex="?0"?/i,"<body$1").replace(/<body(.*?)aria-label="(.+?)"/i,"<body$1").replace(/<body(.*?)aria-readonly="?(?:true|false)"?/i,"<body$1")),o=t.dataProcessor.toDataFormat(o),r&&(o=r+"\n"+o),i&&(o=i+"\n"+o),o},focus:function(){this._.isLoadingData?this._.isPendingFocus=!0:e.baseProto.focus.call(this)},detach:function(){if(!this.preserveIframe){var t=(n=this.editor).document,n=n.container.findOne("iframe.cke_wysiwyg_frame");e.baseProto.detach.call(this),this.clearCustomData(this._.expandoNumber),t.getDocumentElement().clearCustomData(),CKEDITOR.tools.removeFunction(this._.frameLoadedHandler),n&&(n.clearCustomData(),(t=n.removeCustomData("onResize"))&&t.removeListener(),n.isDetached()||n.remove())}}}})}(),CKEDITOR.config.disableObjectResizing=!1,CKEDITOR.config.disableNativeTableHandles=!0,CKEDITOR.config.disableNativeSpellChecker=!0,CKEDITOR.config.observableParent=CKEDITOR.document.$,CKEDITOR.config.plugins="button,panelbutton,panel,floatpanel,colorbutton,menu,contextmenu,listblock,richcombo,font,format,justify,stylescombo,lineutils,dialogui,dialog,notification,toolbar,clipboard,widgetselection,widget,about,basicstyles,enterkey,entities,floatingspace,indent,indentlist,fakeobjects,link,list,undo,wysiwygarea",CKEDITOR.config.skin="moono",function(){var t=function(t,e){var n=CKEDITOR.getUrl("plugins/"+e);t=t.split(",");for(var i=0;i<t.length;i++)CKEDITOR.skin.icons[t[i]]={path:n,offset:-t[++i],bgsize:t[++i]}};CKEDITOR.env.hidpi?t("about,0,,base64image,24,,bold,48,,italic,72,,strike,96,,subscript,120,,superscript,144,,underline,168,,copy-rtl,192,,copy,216,,cut-rtl,240,,cut,264,,paste-rtl,288,,paste,312,,bgcolor,336,,textcolor,360,,copyformatting,384,,find-rtl,408,,find,432,,replace,456,,image,480,,indent-rtl,504,,indent,528,,outdent-rtl,552,,outdent,576,,justifyblock,600,,justifycenter,624,,justifyleft,648,,justifyright,672,,anchor-rtl,696,,anchor,720,,link,744,,unlink,768,,bulletedlist-rtl,792,,bulletedlist,816,,numberedlist-rtl,840,,numberedlist,864,,maximize,888,,pagebreak-rtl,912,,pagebreak,936,,pastefromword-rtl,960,,pastefromword,984,,preview-rtl,1008,,preview,1032,,print,1056,,scayt,1080,,showblocks-rtl,1104,,showblocks,1128,,source-rtl,1152,,source,1176,,sourcedialog-rtl,1200,,sourcedialog,1224,,table,1248,,redo-rtl,1272,,redo,1296,,undo-rtl,1320,,undo,1344,,simplebox,2736,auto","icons_hidpi.png"):t("about,0,auto,base64image,24,auto,bold,48,auto,italic,72,auto,strike,96,auto,subscript,120,auto,superscript,144,auto,underline,168,auto,copy-rtl,192,auto,copy,216,auto,cut-rtl,240,auto,cut,264,auto,paste-rtl,288,auto,paste,312,auto,bgcolor,336,auto,textcolor,360,auto,copyformatting,384,auto,find-rtl,408,auto,find,432,auto,replace,456,auto,image,480,auto,indent-rtl,504,auto,indent,528,auto,outdent-rtl,552,auto,outdent,576,auto,justifyblock,600,auto,justifycenter,624,auto,justifyleft,648,auto,justifyright,672,auto,anchor-rtl,696,auto,anchor,720,auto,link,744,auto,unlink,768,auto,bulletedlist-rtl,792,auto,bulletedlist,816,auto,numberedlist-rtl,840,auto,numberedlist,864,auto,maximize,888,auto,pagebreak-rtl,912,auto,pagebreak,936,auto,pastefromword-rtl,960,auto,pastefromword,984,auto,preview-rtl,1008,auto,preview,1032,auto,print,1056,auto,scayt,1080,auto,showblocks-rtl,1104,auto,showblocks,1128,auto,source-rtl,1152,auto,source,1176,auto,sourcedialog-rtl,1200,auto,sourcedialog,1224,auto,table,1248,auto,redo-rtl,1272,auto,redo,1296,auto,undo-rtl,1320,auto,undo,1344,auto,simplebox,1368,auto","icons.png")}(),CKEDITOR.lang.languages={af:1,ar:1,az:1,bg:1,bn:1,bs:1,ca:1,cs:1,cy:1,da:1,de:1,"de-ch":1,el:1,en:1,"en-au":1,"en-ca":1,"en-gb":1,eo:1,es:1,et:1,eu:1,fa:1,fi:1,fo:1,fr:1,"fr-ca":1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,is:1,it:1,ja:1,ka:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,ms:1,nb:1,nl:1,no:1,oc:1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,sr:1,"sr-latn":1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,zh:1,"zh-cn":1})}(),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("backbone"),require("lodash"),require("jquery")):"function"==typeof define&&define.amd?define(["exports","backbone","lodash","jquery"],e):e((t=t||self).joint={},t.Backbone,t._,t.$)}(this,function(t,e,n,i){"use strict";function r(t){return"function"==typeof t||"[object Function]"===s.call(t)}function o(t){var e=function(t){var e=Number(t);return isNaN(e)?0:0!==e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e}(t);return Math.min(Math.max(e,0),a)}var s,a;function l(t,e){return this.slice(t,e)}function c(t,e){arguments.length<2&&(e=0);for(var n=0,i=t.length;n<i;++n,++e)this[e]=255&t[n]}function u(t){var e;if("number"==typeof t){e=new Array(t);for(var n=0;n<t;++n)e[n]=0}else e=t.slice(0);return e.subarray=l,(e.buffer=e).byteLength=e.length,e.set=c,"object"==typeof t&&t.buffer&&(e.buffer=t.buffer),e}e=e&&e.hasOwnProperty("default")?e.default:e,n=n&&n.hasOwnProperty("default")?n.default:n,i=i&&i.hasOwnProperty("default")?i.default:i,"undefined"==typeof window||"SVGPathSeg"in window||(window.SVGPathSeg=function(t,e,n){this.pathSegType=t,this.pathSegTypeAsLetter=e,this._owningPathSegList=n},window.SVGPathSeg.prototype.classname="SVGPathSeg",window.SVGPathSeg.PATHSEG_UNKNOWN=0,window.SVGPathSeg.PATHSEG_CLOSEPATH=1,window.SVGPathSeg.PATHSEG_MOVETO_ABS=2,window.SVGPathSeg.PATHSEG_MOVETO_REL=3,window.SVGPathSeg.PATHSEG_LINETO_ABS=4,window.SVGPathSeg.PATHSEG_LINETO_REL=5,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS=6,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL=7,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS=8,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL=9,window.SVGPathSeg.PATHSEG_ARC_ABS=10,window.SVGPathSeg.PATHSEG_ARC_REL=11,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS=12,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL=13,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS=14,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL=15,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19,window.SVGPathSeg.prototype._segmentChanged=function(){this._owningPathSegList&&this._owningPathSegList.segmentChanged(this)},window.SVGPathSegClosePath=function(t){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CLOSEPATH,"z",t)},window.SVGPathSegClosePath.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegClosePath.prototype.toString=function(){return"[object SVGPathSegClosePath]"},window.SVGPathSegClosePath.prototype._asPathString=function(){return this.pathSegTypeAsLetter},window.SVGPathSegClosePath.prototype.clone=function(){return new window.SVGPathSegClosePath(void 0)},window.SVGPathSegMovetoAbs=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_MOVETO_ABS,"M",t),this._x=e,this._y=n},window.SVGPathSegMovetoAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegMovetoAbs.prototype.toString=function(){return"[object SVGPathSegMovetoAbs]"},window.SVGPathSegMovetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegMovetoAbs.prototype.clone=function(){return new window.SVGPathSegMovetoAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegMovetoAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegMovetoAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegMovetoRel=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_MOVETO_REL,"m",t),this._x=e,this._y=n},window.SVGPathSegMovetoRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegMovetoRel.prototype.toString=function(){return"[object SVGPathSegMovetoRel]"},window.SVGPathSegMovetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegMovetoRel.prototype.clone=function(){return new window.SVGPathSegMovetoRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegMovetoRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegMovetoRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoAbs=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_ABS,"L",t),this._x=e,this._y=n},window.SVGPathSegLinetoAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoAbs.prototype.toString=function(){return"[object SVGPathSegLinetoAbs]"},window.SVGPathSegLinetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegLinetoAbs.prototype.clone=function(){return new window.SVGPathSegLinetoAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegLinetoAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegLinetoAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoRel=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_REL,"l",t),this._x=e,this._y=n},window.SVGPathSegLinetoRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoRel.prototype.toString=function(){return"[object SVGPathSegLinetoRel]"},window.SVGPathSegLinetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegLinetoRel.prototype.clone=function(){return new window.SVGPathSegLinetoRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegLinetoRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegLinetoRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicAbs=function(t,e,n,i,r,o,s){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS,"C",t),this._x=e,this._y=n,this._x1=i,this._y1=r,this._x2=o,this._y2=s},window.SVGPathSegCurvetoCubicAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicAbs]"},window.SVGPathSegCurvetoCubicAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicAbs(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicRel=function(t,e,n,i,r,o,s){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL,"c",t),this._x=e,this._y=n,this._x1=i,this._y1=r,this._x2=o,this._y2=s},window.SVGPathSegCurvetoCubicRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicRel]"},window.SVGPathSegCurvetoCubicRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicRel.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicRel(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticAbs=function(t,e,n,i,r){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS,"Q",t),this._x=e,this._y=n,this._x1=i,this._y1=r},window.SVGPathSegCurvetoQuadraticAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticAbs]"},window.SVGPathSegCurvetoQuadraticAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticAbs(void 0,this._x,this._y,this._x1,this._y1)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticRel=function(t,e,n,i,r){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL,"q",t),this._x=e,this._y=n,this._x1=i,this._y1=r},window.SVGPathSegCurvetoQuadraticRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticRel]"},window.SVGPathSegCurvetoQuadraticRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticRel.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticRel(void 0,this._x,this._y,this._x1,this._y1)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegArcAbs=function(t,e,n,i,r,o,s,a){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_ARC_ABS,"A",t),this._x=e,this._y=n,this._r1=i,this._r2=r,this._angle=o,this._largeArcFlag=s,this._sweepFlag=a},window.SVGPathSegArcAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegArcAbs.prototype.toString=function(){return"[object SVGPathSegArcAbs]"},window.SVGPathSegArcAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y},window.SVGPathSegArcAbs.prototype.clone=function(){return new window.SVGPathSegArcAbs(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)},Object.defineProperty(window.SVGPathSegArcAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"r1",{get:function(){return this._r1},set:function(t){this._r1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"r2",{get:function(){return this._r2},set:function(t){this._r2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(t){this._largeArcFlag=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(t){this._sweepFlag=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegArcRel=function(t,e,n,i,r,o,s,a){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_ARC_REL,"a",t),this._x=e,this._y=n,this._r1=i,this._r2=r,this._angle=o,this._largeArcFlag=s,this._sweepFlag=a},window.SVGPathSegArcRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegArcRel.prototype.toString=function(){return"[object SVGPathSegArcRel]"},window.SVGPathSegArcRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y},window.SVGPathSegArcRel.prototype.clone=function(){return new window.SVGPathSegArcRel(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)},Object.defineProperty(window.SVGPathSegArcRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"r1",{get:function(){return this._r1},set:function(t){this._r1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"r2",{get:function(){return this._r2},set:function(t){this._r2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(t){this._largeArcFlag=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(t){this._sweepFlag=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoHorizontalAbs=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS,"H",t),this._x=e},window.SVGPathSegLinetoHorizontalAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoHorizontalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalAbs]"},window.SVGPathSegLinetoHorizontalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x},window.SVGPathSegLinetoHorizontalAbs.prototype.clone=function(){return new window.SVGPathSegLinetoHorizontalAbs(void 0,this._x)},Object.defineProperty(window.SVGPathSegLinetoHorizontalAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoHorizontalRel=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL,"h",t),this._x=e},window.SVGPathSegLinetoHorizontalRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoHorizontalRel.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalRel]"},window.SVGPathSegLinetoHorizontalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x},window.SVGPathSegLinetoHorizontalRel.prototype.clone=function(){return new window.SVGPathSegLinetoHorizontalRel(void 0,this._x)},Object.defineProperty(window.SVGPathSegLinetoHorizontalRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoVerticalAbs=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS,"V",t),this._y=e},window.SVGPathSegLinetoVerticalAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoVerticalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalAbs]"},window.SVGPathSegLinetoVerticalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y},window.SVGPathSegLinetoVerticalAbs.prototype.clone=function(){return new window.SVGPathSegLinetoVerticalAbs(void 0,this._y)},Object.defineProperty(window.SVGPathSegLinetoVerticalAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoVerticalRel=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL,"v",t),this._y=e},window.SVGPathSegLinetoVerticalRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoVerticalRel.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalRel]"},window.SVGPathSegLinetoVerticalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y},window.SVGPathSegLinetoVerticalRel.prototype.clone=function(){return new window.SVGPathSegLinetoVerticalRel(void 0,this._y)},Object.defineProperty(window.SVGPathSegLinetoVerticalRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicSmoothAbs=function(t,e,n,i,r){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS,"S",t),this._x=e,this._y=n,this._x2=i,this._y2=r},window.SVGPathSegCurvetoCubicSmoothAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothAbs]"},window.SVGPathSegCurvetoCubicSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicSmoothAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicSmoothAbs(void 0,this._x,this._y,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicSmoothRel=function(t,e,n,i,r){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL,"s",t),this._x=e,this._y=n,this._x2=i,this._y2=r},window.SVGPathSegCurvetoCubicSmoothRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothRel]"},window.SVGPathSegCurvetoCubicSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicSmoothRel.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicSmoothRel(void 0,this._x,this._y,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticSmoothAbs=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS,"T",t),this._x=e,this._y=n},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothAbs]"},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticSmoothAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticSmoothRel=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL,"t",t),this._x=e,this._y=n},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothRel]"},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticSmoothRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathElement.prototype.createSVGPathSegClosePath=function(){return new window.SVGPathSegClosePath(void 0)},window.SVGPathElement.prototype.createSVGPathSegMovetoAbs=function(t,e){return new window.SVGPathSegMovetoAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegMovetoRel=function(t,e){return new window.SVGPathSegMovetoRel(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegLinetoAbs=function(t,e){return new window.SVGPathSegLinetoAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegLinetoRel=function(t,e){return new window.SVGPathSegLinetoRel(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicAbs=function(t,e,n,i,r,o){return new window.SVGPathSegCurvetoCubicAbs(void 0,t,e,n,i,r,o)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicRel=function(t,e,n,i,r,o){return new window.SVGPathSegCurvetoCubicRel(void 0,t,e,n,i,r,o)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticAbs=function(t,e,n,i){return new window.SVGPathSegCurvetoQuadraticAbs(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticRel=function(t,e,n,i){return new window.SVGPathSegCurvetoQuadraticRel(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegArcAbs=function(t,e,n,i,r,o,s){return new window.SVGPathSegArcAbs(void 0,t,e,n,i,r,o,s)},window.SVGPathElement.prototype.createSVGPathSegArcRel=function(t,e,n,i,r,o,s){return new window.SVGPathSegArcRel(void 0,t,e,n,i,r,o,s)},window.SVGPathElement.prototype.createSVGPathSegLinetoHorizontalAbs=function(t){return new window.SVGPathSegLinetoHorizontalAbs(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoHorizontalRel=function(t){return new window.SVGPathSegLinetoHorizontalRel(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoVerticalAbs=function(t){return new window.SVGPathSegLinetoVerticalAbs(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoVerticalRel=function(t){return new window.SVGPathSegLinetoVerticalRel(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothAbs=function(t,e,n,i){return new window.SVGPathSegCurvetoCubicSmoothAbs(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothRel=function(t,e,n,i){return new window.SVGPathSegCurvetoCubicSmoothRel(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothAbs=function(t,e){return new window.SVGPathSegCurvetoQuadraticSmoothAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothRel=function(t,e){return new window.SVGPathSegCurvetoQuadraticSmoothRel(void 0,t,e)},"getPathSegAtLength"in window.SVGPathElement.prototype||(window.SVGPathElement.prototype.getPathSegAtLength=function(t){if(void 0===t||!isFinite(t))throw"Invalid arguments.";var e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",this.getAttribute("d"));var n=e.pathSegList.numberOfItems-1;if(n<=0)return 0;do{if(e.pathSegList.removeItem(n),t>e.getTotalLength())break;n--}while(0<n);return n})),"undefined"==typeof window||"SVGPathSegList"in window&&"appendItem"in window.SVGPathSegList.prototype||(window.SVGPathSegList=function(t){this._pathElement=t,this._list=this._parsePath(this._pathElement.getAttribute("d")),this._mutationObserverConfig={attributes:!0,attributeFilter:["d"]},this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)},window.SVGPathSegList.prototype.classname="SVGPathSegList",Object.defineProperty(window.SVGPathSegList.prototype,"numberOfItems",{get:function(){return this._checkPathSynchronizedToList(),this._list.length},enumerable:!0}),Object.defineProperty(window.SVGPathSegList.prototype,"length",{get:function(){return this._checkPathSynchronizedToList(),this._list.length},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"pathSegList",{get:function(){return this._pathSegList||(this._pathSegList=new window.SVGPathSegList(this)),this._pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"normalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"animatedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"animatedNormalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),window.SVGPathSegList.prototype._checkPathSynchronizedToList=function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())},window.SVGPathSegList.prototype._updateListFromPathMutations=function(t){if(this._pathElement){var e=!1;t.forEach(function(t){"d"==t.attributeName&&(e=!0)}),e&&(this._list=this._parsePath(this._pathElement.getAttribute("d")))}},window.SVGPathSegList.prototype._writeListToPath=function(){this._pathElementMutationObserver.disconnect(),this._pathElement.setAttribute("d",window.SVGPathSegList._pathSegArrayAsString(this._list)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)},window.SVGPathSegList.prototype.segmentChanged=function(t){this._writeListToPath()},window.SVGPathSegList.prototype.clear=function(){this._checkPathSynchronizedToList(),this._list.forEach(function(t){t._owningPathSegList=null}),this._list=[],this._writeListToPath()},window.SVGPathSegList.prototype.initialize=function(t){return this._checkPathSynchronizedToList(),this._list=[t],(t._owningPathSegList=this)._writeListToPath(),t},window.SVGPathSegList.prototype._checkValidIndex=function(t){if(isNaN(t)||t<0||t>=this.numberOfItems)throw"INDEX_SIZE_ERR"},window.SVGPathSegList.prototype.getItem=function(t){return this._checkPathSynchronizedToList(),this._checkValidIndex(t),this._list[t]},window.SVGPathSegList.prototype.insertItemBefore=function(t,e){return this._checkPathSynchronizedToList(),e>this.numberOfItems&&(e=this.numberOfItems),t._owningPathSegList&&(t=t.clone()),this._list.splice(e,0,t),(t._owningPathSegList=this)._writeListToPath(),t},window.SVGPathSegList.prototype.replaceItem=function(t,e){return this._checkPathSynchronizedToList(),t._owningPathSegList&&(t=t.clone()),this._checkValidIndex(e),((this._list[e]=t)._owningPathSegList=this)._writeListToPath(),t},window.SVGPathSegList.prototype.removeItem=function(t){this._checkPathSynchronizedToList(),this._checkValidIndex(t);var e=this._list[t];return this._list.splice(t,1),this._writeListToPath(),e},window.SVGPathSegList.prototype.appendItem=function(t){return this._checkPathSynchronizedToList(),t._owningPathSegList&&(t=t.clone()),this._list.push(t),(t._owningPathSegList=this)._writeListToPath(),t},window.SVGPathSegList._pathSegArrayAsString=function(t){var e="",n=!0;return t.forEach(function(t){n?(n=!1,e+=t._asPathString()):e+=" "+t._asPathString()}),e},window.SVGPathSegList.prototype._parsePath=function(t){if(!t||0==t.length)return[];function e(){this.pathSegList=[]}var n=this;function i(t){this._string=t,this._currentIndex=0,this._endIndex=this._string.length,this._previousCommand=window.SVGPathSeg.PATHSEG_UNKNOWN,this._skipOptionalSpaces()}e.prototype.appendSegment=function(t){this.pathSegList.push(t)},i.prototype._isCurrentSpace=function(){var t=this._string[this._currentIndex];return t<=" "&&(" "==t||"\n"==t||"\t"==t||"\r"==t||"\f"==t)},i.prototype._skipOptionalSpaces=function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex},i.prototype._skipOptionalSpacesOrDelimiter=function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!=this._string.charAt(this._currentIndex))&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","==this._string.charAt(this._currentIndex)&&(this._currentIndex++,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},i.prototype.hasMoreData=function(){return this._currentIndex<this._endIndex},i.prototype.peekSegmentType=function(){var t=this._string[this._currentIndex];return this._pathSegTypeFromChar(t)},i.prototype._pathSegTypeFromChar=function(t){switch(t){case"Z":case"z":return window.SVGPathSeg.PATHSEG_CLOSEPATH;case"M":return window.SVGPathSeg.PATHSEG_MOVETO_ABS;case"m":return window.SVGPathSeg.PATHSEG_MOVETO_REL;case"L":return window.SVGPathSeg.PATHSEG_LINETO_ABS;case"l":return window.SVGPathSeg.PATHSEG_LINETO_REL;case"C":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS;case"c":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL;case"Q":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS;case"q":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL;case"A":return window.SVGPathSeg.PATHSEG_ARC_ABS;case"a":return window.SVGPathSeg.PATHSEG_ARC_REL;case"H":return window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS;case"h":return window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL;case"V":return window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS;case"v":return window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL;case"S":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case"s":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case"T":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case"t":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;default:return window.SVGPathSeg.PATHSEG_UNKNOWN}},i.prototype._nextCommandHelper=function(t,e){return("+"==t||"-"==t||"."==t||"0"<=t&&t<="9")&&e!=window.SVGPathSeg.PATHSEG_CLOSEPATH?e==window.SVGPathSeg.PATHSEG_MOVETO_ABS?window.SVGPathSeg.PATHSEG_LINETO_ABS:e==window.SVGPathSeg.PATHSEG_MOVETO_REL?window.SVGPathSeg.PATHSEG_LINETO_REL:e:window.SVGPathSeg.PATHSEG_UNKNOWN},i.prototype.initialCommandIsMoveTo=function(){if(!this.hasMoreData())return!0;var t=this.peekSegmentType();return t==window.SVGPathSeg.PATHSEG_MOVETO_ABS||t==window.SVGPathSeg.PATHSEG_MOVETO_REL},i.prototype._parseNumber=function(){var t=0,e=0,n=1,i=0,r=1,o=1,s=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"==this._string.charAt(this._currentIndex)?this._currentIndex++:this._currentIndex<this._endIndex&&"-"==this._string.charAt(this._currentIndex)&&(this._currentIndex++,r=-1),!(this._currentIndex==this._endIndex||(this._string.charAt(this._currentIndex)<"0"||"9"<this._string.charAt(this._currentIndex))&&"."!=this._string.charAt(this._currentIndex))){for(var a=this._currentIndex;this._currentIndex<this._endIndex&&"0"<=this._string.charAt(this._currentIndex)&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;if(this._currentIndex!=a)for(var l=this._currentIndex-1,c=1;a<=l;)e+=c*(this._string.charAt(l--)-"0"),c*=10;if(this._currentIndex<this._endIndex&&"."==this._string.charAt(this._currentIndex)){if(this._currentIndex++,this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||"9"<this._string.charAt(this._currentIndex))return;for(;this._currentIndex<this._endIndex&&"0"<=this._string.charAt(this._currentIndex)&&this._string.charAt(this._currentIndex)<="9";)n*=10,i+=(this._string.charAt(this._currentIndex)-"0")/n,this._currentIndex+=1}if(this._currentIndex!=s&&this._currentIndex+1<this._endIndex&&("e"==this._string.charAt(this._currentIndex)||"E"==this._string.charAt(this._currentIndex))&&"x"!=this._string.charAt(this._currentIndex+1)&&"m"!=this._string.charAt(this._currentIndex+1)){if(this._currentIndex++,"+"==this._string.charAt(this._currentIndex)?this._currentIndex++:"-"==this._string.charAt(this._currentIndex)&&(this._currentIndex++,o=-1),this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||"9"<this._string.charAt(this._currentIndex))return;for(;this._currentIndex<this._endIndex&&"0"<=this._string.charAt(this._currentIndex)&&this._string.charAt(this._currentIndex)<="9";)t*=10,t+=this._string.charAt(this._currentIndex)-"0",this._currentIndex++}var u=e+i;if(u*=r,t&&(u*=Math.pow(10,o*t)),s!=this._currentIndex)return this._skipOptionalSpacesOrDelimiter(),u}},i.prototype._parseArcFlag=function(){if(!(this._currentIndex>=this._endIndex)){var t=!1,e=this._string.charAt(this._currentIndex++);if("0"==e)t=!1;else{if("1"!=e)return;t=!0}return this._skipOptionalSpacesOrDelimiter(),t}},i.prototype.parseSegment=function(){var t,e=this._string[this._currentIndex],i=this._pathSegTypeFromChar(e);if(i==window.SVGPathSeg.PATHSEG_UNKNOWN){if(this._previousCommand==window.SVGPathSeg.PATHSEG_UNKNOWN)return null;if((i=this._nextCommandHelper(e,this._previousCommand))==window.SVGPathSeg.PATHSEG_UNKNOWN)return null}else this._currentIndex++;switch(this._previousCommand=i){case window.SVGPathSeg.PATHSEG_MOVETO_REL:return new window.SVGPathSegMovetoRel(n,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_MOVETO_ABS:return new window.SVGPathSegMovetoAbs(n,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_REL:return new window.SVGPathSegLinetoRel(n,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_ABS:return new window.SVGPathSegLinetoAbs(n,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:return new window.SVGPathSegLinetoHorizontalRel(n,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:return new window.SVGPathSegLinetoHorizontalAbs(n,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:return new window.SVGPathSegLinetoVerticalRel(n,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:return new window.SVGPathSegLinetoVerticalAbs(n,this._parseNumber());case window.SVGPathSeg.PATHSEG_CLOSEPATH:return this._skipOptionalSpaces(),new window.SVGPathSegClosePath(n);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:return t={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegCurvetoCubicRel(n,t.x,t.y,t.x1,t.y1,t.x2,t.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:return t={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegCurvetoCubicAbs(n,t.x,t.y,t.x1,t.y1,t.x2,t.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:return t={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegCurvetoCubicSmoothRel(n,t.x,t.y,t.x2,t.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:return t={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegCurvetoCubicSmoothAbs(n,t.x,t.y,t.x2,t.y2);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:return t={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegCurvetoQuadraticRel(n,t.x,t.y,t.x1,t.y1);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:return t={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegCurvetoQuadraticAbs(n,t.x,t.y,t.x1,t.y1);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return new window.SVGPathSegCurvetoQuadraticSmoothRel(n,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return new window.SVGPathSegCurvetoQuadraticSmoothAbs(n,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_ARC_REL:return t={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegArcRel(n,t.x,t.y,t.x1,t.y1,t.arcAngle,t.arcLarge,t.arcSweep);case window.SVGPathSeg.PATHSEG_ARC_ABS:return t={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegArcAbs(n,t.x,t.y,t.x1,t.y1,t.arcAngle,t.arcLarge,t.arcSweep);default:throw"Unknown path seg type."}};var r=new e,o=new i(t);if(!o.initialCommandIsMoveTo())return[];for(;o.hasMoreData();){var s=o.parseSegment();if(!s)return[];r.appendSegment(s)}return r.pathSegList}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0==i)return!1;for(var r,o,s=0|e,a=Math.max(0<=s?s:i-Math.abs(s),0);a<i;){if((r=n[a])===(o=t)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;a++}return!1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<n;){var o=e[r];if(t.call(i,o,r,e))return o;r++}}}),Array.from||(Array.from=(s=Object.prototype.toString,a=Math.pow(2,53)-1,function(t,e,n){var i=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var s,a=1<arguments.length?e:void 0;if(void 0!==a){if(!r(a))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(s=n)}for(var l,c=o(i.length),u=r(this)?Object(new this(c)):new Array(c),h=0;h<c;)l=i[h],u[h]=a?void 0===s?a(l,h):a.call(s,l,h):l,h+=1;return u.length=c,u})),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<n;){var o=e[r];if(t.call(i,o,r,e))return r;r++}return-1}}),function(){var e=void 0!==t?t:this,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function i(t){this.message=t}(i.prototype=new Error).name="InvalidCharacterError",e.btoa||(e.btoa=function(t){for(var e,r,o=String(t),s=0,a=n,l="";o.charAt(0|s)||(a="=",s%1);l+=a.charAt(63&e>>8-s%1*8)){if(255<(r=o.charCodeAt(s+=.75)))throw new i("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");e=e<<8|r}return l}),e.atob||(e.atob=function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new i("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,o,s=0,a=0,l="";o=e.charAt(a++);~o&&(r=s%4?64*r+o:o,s++%4)&&(l+=String.fromCharCode(255&r>>(-2*s&6))))o=n.indexOf(o);return l})}(),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isNaN=Number.isNaN||function(t){return t!=t},String.prototype.includes||(String.prototype.includes=function(t,e){return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(e||0,t.length)===t}),"undefined"==typeof Uint8Array&&"undefined"!=typeof window&&(window.Uint8Array=u,window.Uint32Array=u,window.Int32Array=u),"undefined"!=typeof XMLHttpRequest&&("response"in XMLHttpRequest.prototype||"mozResponseArrayBuffer"in XMLHttpRequest.prototype||"mozResponse"in XMLHttpRequest.prototype||"responseArrayBuffer"in XMLHttpRequest.prototype||Object.defineProperty(XMLHttpRequest.prototype,"response",{get:function(){return new Uint8Array(new VBArray(this.responseBody).toArray())}}));var h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function d(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=e[t]||t;for(var n=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],i=0;i<n.length;i++){var r=n[i].re,o=n[i].process,s=r.exec(t);if(s){var a=o(s);this.r=a[0],this.g=a[1],this.b=a[2],3<a.length&&(this.alpha=a[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:255<this.r?255:this.r,this.g=this.g<0||isNaN(this.g)?0:255<this.g?255:this.g,this.b=this.b<0||isNaN(this.b)?0:255<this.b?255:this.b,this.alpha=this.alpha<0?0:1<this.alpha||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),n=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==n.length&&(n="0"+n),"#"+t+e+n},this.getHelpXML=function(){for(var t=new Array,i=0;i<n.length;i++)for(var r=n[i].example,o=0;o<r.length;o++)t[t.length]=r[o];for(var s in e)t[t.length]=s;var a=document.createElement("ul");for(a.setAttribute("id","rgbcolor-examples"),i=0;i<t.length;i++)try{var l=document.createElement("li"),c=new RGBColor(t[i]),u=document.createElement("div");u.style.cssText="margin: 3px; border: 1px solid black; background:"+c.toHex()+"; color:"+c.toHex(),u.appendChild(document.createTextNode("test"));var h=document.createTextNode(" "+t[i]+" -> "+c.toRGB()+" -> "+c.toHex());l.appendChild(u),l.appendChild(h),a.appendChild(l)}catch(t){}return a}}var f,p=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],g=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function m(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function v(t,e,n,i){if(!(isNaN(i)||i<1)){var r,o,s,a,l,c,u,h,d,f,v,y,b,C,I,E,T,w,x,_,D,A,O,S,R=(i|=0)+i+1,k=e-1,N=n-1,M=i+1,P=M*(M+1)/2,L=new m,K=L;for(s=1;s<R;s++)if(K=K.next=new m,s==M)var B=K;K.next=L;var z=null,j=null;u=c=0;var G=p[i],F=g[i];for(o=0;o<n;o++){for(E=T=w=x=h=d=f=v=0,y=M*(_=t[c]),b=M*(D=t[c+1]),C=M*(A=t[c+2]),I=M*(O=t[c+3]),h+=P*_,d+=P*D,f+=P*A,v+=P*O,K=L,s=0;s<M;s++)K.r=_,K.g=D,K.b=A,K.a=O,K=K.next;for(s=1;s<M;s++)a=c+((k<s?k:s)<<2),h+=(K.r=_=t[a])*(S=M-s),d+=(K.g=D=t[a+1])*S,f+=(K.b=A=t[a+2])*S,v+=(K.a=O=t[a+3])*S,E+=_,T+=D,w+=A,x+=O,K=K.next;for(z=L,j=B,r=0;r<e;r++)t[c+3]=O=v*G>>F,0!=O?(O=255/O,t[c]=(h*G>>F)*O,t[c+1]=(d*G>>F)*O,t[c+2]=(f*G>>F)*O):t[c]=t[c+1]=t[c+2]=0,h-=y,d-=b,f-=C,v-=I,y-=z.r,b-=z.g,C-=z.b,I-=z.a,a=u+((a=r+i+1)<k?a:k)<<2,h+=E+=z.r=t[a],d+=T+=z.g=t[a+1],f+=w+=z.b=t[a+2],v+=x+=z.a=t[a+3],z=z.next,y+=_=j.r,b+=D=j.g,C+=A=j.b,I+=O=j.a,E-=_,T-=D,w-=A,x-=O,j=j.next,c+=4;u+=e}for(r=0;r<e;r++){for(T=w=x=E=d=f=v=h=0,y=M*(_=t[c=r<<2]),b=M*(D=t[c+1]),C=M*(A=t[c+2]),I=M*(O=t[c+3]),h+=P*_,d+=P*D,f+=P*A,v+=P*O,K=L,s=0;s<M;s++)K.r=_,K.g=D,K.b=A,K.a=O,K=K.next;for(l=e,s=1;s<=i;s++)c=l+r<<2,h+=(K.r=_=t[c])*(S=M-s),d+=(K.g=D=t[c+1])*S,f+=(K.b=A=t[c+2])*S,v+=(K.a=O=t[c+3])*S,E+=_,T+=D,w+=A,x+=O,K=K.next,s<N&&(l+=e);for(c=r,z=L,j=B,o=0;o<n;o++)t[3+(a=c<<2)]=O=v*G>>F,0<O?(O=255/O,t[a]=(h*G>>F)*O,t[a+1]=(d*G>>F)*O,t[a+2]=(f*G>>F)*O):t[a]=t[a+1]=t[a+2]=0,h-=y,d-=b,f-=C,v-=I,y-=z.r,b-=z.g,C-=z.b,I-=z.a,a=r+((a=o+M)<N?a:N)*e<<2,h+=E+=z.r=t[a],d+=T+=z.g=t[a+1],f+=w+=z.b=t[a+2],v+=x+=z.a=t[a+3],z=z.next,y+=_=j.r,b+=D=j.g,C+=A=j.b,I+=O=j.a,E-=_,T-=D,w-=A,x-=O,j=j.next,c+=e}}}f={exports:{}},function(t,e){if(f.exports){var n=d,i=v;f.exports=e(n,i)}t.canvg=e(void 0!==n?n:t.RGBColor,"undefined"!=typeof statckblur?i:t.stackBlur)}("undefined"!=typeof window?window:h,function(t,e){if("undefined"!=typeof Element){var n,i=function(r,o,s){if(null!=r||null!=o||null!=s){"string"==typeof r&&(r=document.getElementById(r)),null!=r.svg&&r.svg.stop();var a=function(i){var r={opts:i,FRAMERATE:30,MAX_VIRTUAL_PIXELS:3e4,log:function(t){}};1==r.opts.log&&"undefined"!=typeof console&&(r.log=function(t){console.log(t)}),r.init=function(t){var e=0;r.UniqueId=function(){return"canvg"+ ++e},r.Definitions={},r.Styles={},r.StylesSpecificity={},r.Animations=[],r.Images=[],r.ctx=t,r.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(t,e){this.viewPorts.push({width:t,height:e})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(t){return null!=t&&"number"==typeof t?t:"x"==t?this.width():"y"==t?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},r.init(),r.ImagesLoaded=function(){for(var t=0;t<r.Images.length;t++)if(!r.Images[t].loaded)return!1;return!0},r.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},r.compressSpaces=function(t){return t.replace(/[\s\r\t\n]+/gm," ")},r.ajax=function(t){var e;return(e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"))?(e.open("GET",t,!1),e.send(null),e.responseText):null},r.parseXml=function(t){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var e=new Windows.Data.Xml.Dom.XmlDocument,n=new Windows.Data.Xml.Dom.XmlLoadSettings;return n.prohibitDtd=!1,e.loadXml(t,n),e}if(!window.DOMParser)return t=t.replace(/<!DOCTYPE svg[^>]*>/,""),(e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t),e;try{var i=new DOMParser;return i.parseFromString(t,"image/svg+xml")}catch(e){return(i=new DOMParser).parseFromString(t,"text/xml")}},r.Property=function(t,e){this.name=t,this.value=e},r.Property.prototype.getValue=function(){return this.value},r.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},r.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var t=parseFloat(this.value);return(this.value+"").match(/%$/)&&(t/=100),t},r.Property.prototype.valueOrDefault=function(t){return this.hasValue()?this.value:t},r.Property.prototype.numValueOrDefault=function(t){return this.hasValue()?this.numValue():t},r.Property.prototype.addOpacity=function(e){var n=this.value;if(null!=e.value&&""!=e.value&&"string"==typeof this.value){var i=new t(this.value);i.ok&&(n="rgba("+i.r+", "+i.g+", "+i.b+", "+e.numValue()+")")}return new r.Property(this.name,n)},r.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t=(t=t&&t[1])||this.value,r.Definitions[t]},r.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},r.Property.prototype.getFillStyleDefinition=function(t,e){var n=this.getDefinition();if(null!=n&&n.createGradient)return n.createGradient(r.ctx,t,e);if(null!=n&&n.createPattern){if(n.getHrefAttribute().hasValue()){var i=n.attribute("patternTransform");n=n.getHrefAttribute().getDefinition(),i.hasValue()&&(n.attribute("patternTransform",!0).value=i.value)}return n.createPattern(r.ctx,t)}return null},r.Property.prototype.getDPI=function(t){return 96},r.Property.prototype.getEM=function(t){var e=12,n=new r.Property("fontSize",r.Font.Parse(r.ctx.font).fontSize);return n.hasValue()&&(e=n.toPixels(t)),e},r.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},r.Property.prototype.toPixels=function(t,e){if(!this.hasValue())return 0;var n=this.value+"";if(n.match(/em$/))return this.numValue()*this.getEM(t);if(n.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(n.match(/px$/))return this.numValue();if(n.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(n.match(/pc$/))return 15*this.numValue();if(n.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(n.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(n.match(/in$/))return this.numValue()*this.getDPI(t);if(n.match(/%$/))return this.numValue()*r.ViewPort.ComputeSize(t);var i=this.numValue();return e&&i<1?i*r.ViewPort.ComputeSize(t):i},r.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/s$/)?1e3*this.numValue():(t.match(/ms$/),this.numValue())},r.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/deg$/)?this.numValue()*(Math.PI/180):t.match(/grad$/)?this.numValue()*(Math.PI/200):t.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var o={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return r.Property.prototype.toTextBaseline=function(){return this.hasValue()?o[this.value]:null},r.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,e,n,i,o,s){var a=null!=s?this.Parse(s):this.CreateFont("","","","","",r.ctx.font);return{fontFamily:o||a.fontFamily,fontSize:i||a.fontSize,fontStyle:t||a.fontStyle,fontWeight:n||a.fontWeight,fontVariant:e||a.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var t=this;this.Parse=function(e){for(var n={},i=r.trim(r.compressSpaces(e||"")).split(" "),o={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},s="",a=0;a<i.length;a++)o.fontStyle||-1==t.Styles.indexOf(i[a])?o.fontVariant||-1==t.Variants.indexOf(i[a])?o.fontWeight||-1==t.Weights.indexOf(i[a])?o.fontSize?"inherit"!=i[a]&&(s+=i[a]):("inherit"!=i[a]&&(n.fontSize=i[a].split("/")[0]),o.fontStyle=o.fontVariant=o.fontWeight=o.fontSize=!0):("inherit"!=i[a]&&(n.fontWeight=i[a]),o.fontStyle=o.fontVariant=o.fontWeight=!0):("inherit"!=i[a]&&(n.fontVariant=i[a]),o.fontStyle=o.fontVariant=!0):("inherit"!=i[a]&&(n.fontStyle=i[a]),o.fontStyle=!0);return""!=s&&(n.fontFamily=s),n}},r.ToNumberArray=function(t){for(var e=r.trim(r.compressSpaces((t||"").replace(/,/g," "))).split(" "),n=0;n<e.length;n++)e[n]=parseFloat(e[n]);return e},r.Point=function(t,e){this.x=t,this.y=e},r.Point.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},r.Point.prototype.applyTransform=function(t){var e=this.x*t[0]+this.y*t[2]+t[4],n=this.x*t[1]+this.y*t[3]+t[5];this.x=e,this.y=n},r.CreatePoint=function(t){var e=r.ToNumberArray(t);return new r.Point(e[0],e[1])},r.CreatePath=function(t){for(var e=r.ToNumberArray(t),n=[],i=0;i<e.length;i+=2)n.push(new r.Point(e[i],e[i+1]));return n},r.BoundingBox=function(t,e,n,i){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(t,e){null!=t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),null!=e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},this.addX=function(t){this.addPoint(t,null)},this.addY=function(t){this.addPoint(null,t)},this.addBoundingBox=function(t){this.addPoint(t.x1,t.y1),this.addPoint(t.x2,t.y2)},this.addQuadraticCurve=function(t,e,n,i,r,o){var s=t+2/3*(n-t),a=e+2/3*(i-e),l=s+1/3*(r-t),c=a+1/3*(o-e);this.addBezierCurve(t,e,s,l,a,c,r,o)},this.addBezierCurve=function(t,e,n,i,r,o,s,a){var l=[t,e],c=[n,i],u=[r,o],h=[s,a];this.addPoint(l[0],l[1]),this.addPoint(h[0],h[1]);for(var d=0;d<=1;d++){var f=function(t){return Math.pow(1-t,3)*l[d]+3*Math.pow(1-t,2)*t*c[d]+3*(1-t)*Math.pow(t,2)*u[d]+Math.pow(t,3)*h[d]},p=6*l[d]-12*c[d]+6*u[d],g=-3*l[d]+9*c[d]-9*u[d]+3*h[d],m=3*c[d]-3*l[d];if(0!=g){var v=Math.pow(p,2)-4*m*g;if(!(v<0)){var y=(-p+Math.sqrt(v))/(2*g);0<y&&y<1&&(0==d&&this.addX(f(y)),1==d&&this.addY(f(y)));var b=(-p-Math.sqrt(v))/(2*g);0<b&&b<1&&(0==d&&this.addX(f(b)),1==d&&this.addY(f(b)))}}else{if(0==p)continue;var C=-m/p;0<C&&C<1&&(0==d&&this.addX(f(C)),1==d&&this.addY(f(C)))}}},this.isPointInBox=function(t,e){return this.x1<=t&&t<=this.x2&&this.y1<=e&&e<=this.y2},this.addPoint(t,e),this.addPoint(n,i)},r.Transform=function(t){var e=this;this.Type={},this.Type.translate=function(t){this.p=r.CreatePoint(t),this.apply=function(t){t.translate(this.p.x||0,this.p.y||0)},this.unapply=function(t){t.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(t){t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var e=r.ToNumberArray(t);this.angle=new r.Property("angle",e[0]),this.cx=e[1]||0,this.cy=e[2]||0,this.apply=function(t){t.translate(this.cx,this.cy),t.rotate(this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.unapply=function(t){t.translate(this.cx,this.cy),t.rotate(-1*this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.applyToPoint=function(t){var e=this.angle.toRadians();t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),t.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]),t.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=r.CreatePoint(t),this.apply=function(t){t.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(t){t.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(t){t.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(t){this.m=r.ToNumberArray(t),this.apply=function(t){t.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(t){var e=this.m[0],n=this.m[2],i=this.m[4],r=this.m[1],o=this.m[3],s=this.m[5],a=1/(e*(1*o-0*s)-n*(1*r-0*s)+i*(0*r-0*o));t.transform(a*(1*o-0*s),a*(0*s-1*r),a*(0*i-1*n),a*(1*e-0*i),a*(n*s-i*o),a*(i*r-e*s))},this.applyToPoint=function(t){t.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=e.Type.matrix,this.base(t),this.angle=new r.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(t)},this.unapply=function(t){for(var e=this.transforms.length-1;0<=e;e--)this.transforms[e].unapply(t)},this.applyToPoint=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].applyToPoint(t)};for(var n=r.trim(r.compressSpaces(t)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),i=0;i<n.length;i++){var o=r.trim(n[i].split("(")[0]),s=n[i].split("(")[1].replace(")",""),a=this.Type[o];if(void 0!==a){var l=new a(s);l.type=o,this.transforms.push(l)}}},r.AspectRatio=function(t,e,n,i,o,s,a,l,c,u){var h=(e=(e=r.compressSpaces(e)).replace(/^defer\s/,"")).split(" ")[0]||"xMidYMid",d=e.split(" ")[1]||"meet",f=n/i,p=o/s,g=Math.min(f,p),m=Math.max(f,p);"meet"==d&&(i*=g,s*=g),"slice"==d&&(i*=m,s*=m),c=new r.Property("refX",c),u=new r.Property("refY",u),c.hasValue()&&u.hasValue()?t.translate(-g*c.toPixels("x"),-g*u.toPixels("y")):(h.match(/^xMid/)&&("meet"==d&&g==p||"slice"==d&&m==p)&&t.translate(n/2-i/2,0),h.match(/YMid$/)&&("meet"==d&&g==f||"slice"==d&&m==f)&&t.translate(0,o/2-s/2),h.match(/^xMax/)&&("meet"==d&&g==p||"slice"==d&&m==p)&&t.translate(n-i,0),h.match(/YMax$/)&&("meet"==d&&g==f||"slice"==d&&m==f)&&t.translate(0,o-s)),"none"==h?t.scale(f,p):"meet"==d?t.scale(g,g):"slice"==d&&t.scale(m,m),t.translate(null==a?0:-a,null==l?0:-l)},r.Element={},r.EmptyProperty=new r.Property("EMPTY",""),r.Element.ElementBase=function(t){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(t,e){var n=this.attributes[t];return null!=n?n:(1==e&&(n=new r.Property(t,""),this.attributes[t]=n),n||r.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if("href"==t||t.match(/:href$/))return this.attributes[t];return r.EmptyProperty},this.style=function(t,e,n){var i=this.styles[t];if(null!=i)return i;var o=this.attribute(t);if(null!=o&&o.hasValue())return this.styles[t]=o;if(1!=n){var s=this.parent;if(null!=s){var a=s.style(t);if(null!=a&&a.hasValue())return a}}return 1==e&&(i=new r.Property(t,""),this.styles[t]=i),i||r.EmptyProperty},this.render=function(t){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(t.save(),this.style("mask").hasValue()){var e=this.style("mask").getDefinition();null!=e&&e.apply(t,this)}else if(this.style("filter").hasValue()){var n=this.style("filter").getDefinition();null!=n&&n.apply(t,this)}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}},this.setContext=function(t){},this.clearContext=function(t){},this.renderChildren=function(t){for(var e=0;e<this.children.length;e++)this.children[e].render(t)},this.addChild=function(t,e){var n=t;e&&(n=r.CreateElement(t)),n.parent=this,"title"!=n.type&&this.children.push(n)},this.addStylesFromStyleDefinition=function(){for(var e in r.Styles)if("@"!=e[0]&&n(t,e)){var i=r.Styles[e],o=r.StylesSpecificity[e];if(null!=i)for(var s in i){var a=this.stylesSpecificity[s];void 0===a&&(a="000"),a<o&&(this.styles[s]=i[s],this.stylesSpecificity[s]=o)}}};var e,i=new RegExp("^[A-Z-]+$");if(null!=t&&1==t.nodeType){for(var o=0;o<t.attributes.length;o++){var s=t.attributes[o],a=(e=s.nodeName,i.test(e)?e.toLowerCase():e);this.attributes[a]=new r.Property(a,s.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue()){var l=this.attribute("style").value.split(";");for(o=0;o<l.length;o++)if(""!=r.trim(l[o])){var c=l[o].split(":"),u=r.trim(c[0]),h=r.trim(c[1]);this.styles[u]=new r.Property(u,h)}}for(this.attribute("id").hasValue()&&null==r.Definitions[this.attribute("id").value]&&(r.Definitions[this.attribute("id").value]=this),o=0;o<t.childNodes.length;o++){var d=t.childNodes[o];if(1==d.nodeType&&this.addChild(d,!0),this.captureTextNodes&&(3==d.nodeType||4==d.nodeType)){var f=d.value||d.text||d.textContent||"";""!=r.compressSpaces(f)&&this.addChild(new r.Element.tspan(d),!1)}}}},r.Element.RenderedElementBase=function(t){this.base=r.Element.ElementBase,this.base(t),this.setContext=function(t){var e;if(this.style("fill").isUrlDefinition())null!=(e=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity")))&&(t.fillStyle=e);else if(this.style("fill").hasValue()){var n;"currentColor"==(n=this.style("fill")).value&&(n.value=this.style("color").value),"inherit"!=n.value&&(t.fillStyle="none"==n.value?"rgba(0,0,0,0)":n.value)}if(this.style("fill-opacity").hasValue()&&(n=(n=new r.Property("fill",t.fillStyle)).addOpacity(this.style("fill-opacity")),t.fillStyle=n.value),this.style("stroke").isUrlDefinition())null!=(e=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")))&&(t.strokeStyle=e);else if(this.style("stroke").hasValue()){var i;"currentColor"==(i=this.style("stroke")).value&&(i.value=this.style("color").value),"inherit"!=i.value&&(t.strokeStyle="none"==i.value?"rgba(0,0,0,0)":i.value)}if(this.style("stroke-opacity").hasValue()&&(i=(i=new r.Property("stroke",t.strokeStyle)).addOpacity(this.style("stroke-opacity")),t.strokeStyle=i.value),this.style("stroke-width").hasValue()){var o=this.style("stroke-width").toPixels();t.lineWidth=0==o?.001:o}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var s=r.ToNumberArray(this.style("stroke-dasharray").value);void 0!==t.setLineDash?t.setLineDash(s):void 0!==t.webkitLineDash?t.webkitLineDash=s:void 0===t.mozDash||1==s.length&&0==s[0]||(t.mozDash=s);var a=this.style("stroke-dashoffset").numValueOrDefault(1);void 0!==t.lineDashOffset?t.lineDashOffset=a:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=a:void 0!==t.mozDashOffset&&(t.mozDashOffset=a)}if(void 0!==t.font&&(t.font=r.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.style("transform",!1,!0).hasValue()&&new r.Transform(this.style("transform",!1,!0).value).apply(t),this.style("clip-path",!1,!0).hasValue()){var l=this.style("clip-path",!1,!0).getDefinition();null!=l&&l.apply(t)}this.style("opacity").hasValue()&&(t.globalAlpha=this.style("opacity").numValue())}},r.Element.RenderedElementBase.prototype=new r.Element.ElementBase,r.Element.PathElementBase=function(t){this.base=r.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new r.BoundingBox},this.renderChildren=function(t){this.path(t),r.Mouse.checkPath(this,t),""!=t.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?t.fill(this.style("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var e=this.getMarkers();if(null!=e){if(this.style("marker-start").isUrlDefinition()&&(n=this.style("marker-start").getDefinition()).render(t,e[0][0],e[0][1]),this.style("marker-mid").isUrlDefinition())for(var n=this.style("marker-mid").getDefinition(),i=1;i<e.length-1;i++)n.render(t,e[i][0],e[i][1]);this.style("marker-end").isUrlDefinition()&&(n=this.style("marker-end").getDefinition()).render(t,e[e.length-1][0],e[e.length-1][1])}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},r.Element.PathElementBase.prototype=new r.Element.RenderedElementBase,r.Element.svg=function(t){this.base=r.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),r.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4,void 0!==t.font&&void 0!==window.getComputedStyle&&(t.font=window.getComputedStyle(t.canvas).getPropertyValue("font")),this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var e=r.ViewPort.width(),n=r.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root){e=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y");var i=0,o=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(i=-this.attribute("refX").toPixels("x"),o=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(t.beginPath(),t.moveTo(i,o),t.lineTo(e,o),t.lineTo(e,n),t.lineTo(i,n),t.closePath(),t.clip())}if(r.ViewPort.SetCurrent(e,n),this.attribute("viewBox").hasValue()){var s=r.ToNumberArray(this.attribute("viewBox").value),a=s[0],l=s[1];e=s[2],n=s[3],r.AspectRatio(t,this.attribute("preserveAspectRatio").value,r.ViewPort.width(),e,r.ViewPort.height(),n,a,l,this.attribute("refX").value,this.attribute("refY").value),r.ViewPort.RemoveCurrent(),r.ViewPort.SetCurrent(s[2],s[3])}}},r.Element.svg.prototype=new r.Element.RenderedElementBase,r.Element.rect=function(t){this.base=r.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y"),s=this.attribute("rx").toPixels("x"),a=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(a=s),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(s=a),s=Math.min(s,i/2),a=Math.min(a,o/2),null!=t&&(t.beginPath(),t.moveTo(e+s,n),t.lineTo(e+i-s,n),t.quadraticCurveTo(e+i,n,e+i,n+a),t.lineTo(e+i,n+o-a),t.quadraticCurveTo(e+i,n+o,e+i-s,n+o),t.lineTo(e+s,n+o),t.quadraticCurveTo(e,n+o,e,n+o-a),t.lineTo(e,n+a),t.quadraticCurveTo(e,n,e+s,n),t.closePath()),new r.BoundingBox(e,n,e+i,n+o)}},r.Element.rect.prototype=new r.Element.PathElementBase,r.Element.circle=function(t){this.base=r.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("cx").toPixels("x"),n=this.attribute("cy").toPixels("y"),i=this.attribute("r").toPixels();return null!=t&&(t.beginPath(),t.arc(e,n,i,0,2*Math.PI,!0),t.closePath()),new r.BoundingBox(e-i,n-i,e+i,n+i)}},r.Element.circle.prototype=new r.Element.PathElementBase,r.Element.ellipse=function(t){this.base=r.Element.PathElementBase,this.base(t),this.path=function(t){var e=(Math.sqrt(2)-1)/3*4,n=this.attribute("rx").toPixels("x"),i=this.attribute("ry").toPixels("y"),o=this.attribute("cx").toPixels("x"),s=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(o,s-i),t.bezierCurveTo(o+e*n,s-i,o+n,s-e*i,o+n,s),t.bezierCurveTo(o+n,s+e*i,o+e*n,s+i,o,s+i),t.bezierCurveTo(o-e*n,s+i,o-n,s+e*i,o-n,s),t.bezierCurveTo(o-n,s-e*i,o-e*n,s-i,o,s-i),t.closePath()),new r.BoundingBox(o-n,s-i,o+n,s+i)}},r.Element.ellipse.prototype=new r.Element.PathElementBase,r.Element.line=function(t){this.base=r.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new r.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new r.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var e=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(e[0].x,e[0].y),t.lineTo(e[1].x,e[1].y)),new r.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y)},this.getMarkers=function(){var t=this.getPoints(),e=t[0].angleTo(t[1]);return[[t[0],e],[t[1],e]]}},r.Element.line.prototype=new r.Element.PathElementBase,r.Element.polyline=function(t){this.base=r.Element.PathElementBase,this.base(t),this.points=r.CreatePath(this.attribute("points").value),this.path=function(t){var e=new r.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var n=1;n<this.points.length;n++)e.addPoint(this.points[n].x,this.points[n].y),null!=t&&t.lineTo(this.points[n].x,this.points[n].y);return e},this.getMarkers=function(){for(var t=[],e=0;e<this.points.length-1;e++)t.push([this.points[e],this.points[e].angleTo(this.points[e+1])]);return 0<t.length&&t.push([this.points[this.points.length-1],t[t.length-1][1]]),t}},r.Element.polyline.prototype=new r.Element.PathElementBase,r.Element.polygon=function(t){this.base=r.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(t){var e=this.basePath(t);return null!=t&&(t.lineTo(this.points[0].x,this.points[0].y),t.closePath()),e}},r.Element.polygon.prototype=new r.Element.polyline,r.Element.path=function(t){this.base=r.Element.PathElementBase,this.base(t);var e=this.attribute("d").value;e=e.replace(/,/gm," ");for(var n=0;n<2;n++)e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");for(e=(e=e.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2"),n=0;n<2;n++)e=e.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");e=e.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),e=r.compressSpaces(e),e=r.trim(e),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new r.Point(0,0),this.control=new r.Point(0,0),this.current=new r.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new r.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var t=this.getPoint();return this.control=t},this.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new r.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(t){return this.isRelativeCommand()&&(t.x+=this.current.x,t.y+=this.current.y),t},this.addMarker=function(t,e,n){null!=n&&0<this.angles.length&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(n)),this.addMarkerAngle(t,null==e?null:e.angleTo(t))},this.addMarkerAngle=function(t,e){this.points.push(t),this.angles.push(e)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++)if(null==this.angles[t])for(var e=t+1;e<this.angles.length;e++)if(null!=this.angles[e]){this.angles[t]=this.angles[e];break}return this.angles}}(e),this.path=function(t){var e=this.PathParser;e.reset();var n=new r.BoundingBox;for(null!=t&&t.beginPath();!e.isEnd();)switch(e.nextCommand(),e.command){case"M":case"m":var i=e.getAsCurrentPoint();for(e.addMarker(i),n.addPoint(i.x,i.y),null!=t&&t.moveTo(i.x,i.y),e.start=e.current;!e.isCommandOrEnd();)i=e.getAsCurrentPoint(),e.addMarker(i,e.start),n.addPoint(i.x,i.y),null!=t&&t.lineTo(i.x,i.y);break;case"L":case"l":for(;!e.isCommandOrEnd();){var o=e.current;i=e.getAsCurrentPoint(),e.addMarker(i,o),n.addPoint(i.x,i.y),null!=t&&t.lineTo(i.x,i.y)}break;case"H":case"h":for(;!e.isCommandOrEnd();){var s=new r.Point((e.isRelativeCommand()?e.current.x:0)+e.getScalar(),e.current.y);e.addMarker(s,e.current),e.current=s,n.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"V":case"v":for(;!e.isCommandOrEnd();)s=new r.Point(e.current.x,(e.isRelativeCommand()?e.current.y:0)+e.getScalar()),e.addMarker(s,e.current),e.current=s,n.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y);break;case"C":case"c":for(;!e.isCommandOrEnd();){var a=e.current,l=e.getPoint(),c=e.getAsControlPoint(),u=e.getAsCurrentPoint();e.addMarker(u,c,l),n.addBezierCurve(a.x,a.y,l.x,l.y,c.x,c.y,u.x,u.y),null!=t&&t.bezierCurveTo(l.x,l.y,c.x,c.y,u.x,u.y)}break;case"S":case"s":for(;!e.isCommandOrEnd();)a=e.current,l=e.getReflectedControlPoint(),c=e.getAsControlPoint(),u=e.getAsCurrentPoint(),e.addMarker(u,c,l),n.addBezierCurve(a.x,a.y,l.x,l.y,c.x,c.y,u.x,u.y),null!=t&&t.bezierCurveTo(l.x,l.y,c.x,c.y,u.x,u.y);break;case"Q":case"q":for(;!e.isCommandOrEnd();)a=e.current,c=e.getAsControlPoint(),u=e.getAsCurrentPoint(),e.addMarker(u,c,c),n.addQuadraticCurve(a.x,a.y,c.x,c.y,u.x,u.y),null!=t&&t.quadraticCurveTo(c.x,c.y,u.x,u.y);break;case"T":case"t":for(;!e.isCommandOrEnd();)a=e.current,c=e.getReflectedControlPoint(),e.control=c,u=e.getAsCurrentPoint(),e.addMarker(u,c,c),n.addQuadraticCurve(a.x,a.y,c.x,c.y,u.x,u.y),null!=t&&t.quadraticCurveTo(c.x,c.y,u.x,u.y);break;case"A":case"a":for(;!e.isCommandOrEnd();){a=e.current;var h=e.getScalar(),d=e.getScalar(),f=e.getScalar()*(Math.PI/180),p=e.getScalar(),g=e.getScalar(),m=(u=e.getAsCurrentPoint(),new r.Point(Math.cos(f)*(a.x-u.x)/2+Math.sin(f)*(a.y-u.y)/2,-Math.sin(f)*(a.x-u.x)/2+Math.cos(f)*(a.y-u.y)/2)),v=Math.pow(m.x,2)/Math.pow(h,2)+Math.pow(m.y,2)/Math.pow(d,2);1<v&&(h*=Math.sqrt(v),d*=Math.sqrt(v));var y=(p==g?-1:1)*Math.sqrt((Math.pow(h,2)*Math.pow(d,2)-Math.pow(h,2)*Math.pow(m.y,2)-Math.pow(d,2)*Math.pow(m.x,2))/(Math.pow(h,2)*Math.pow(m.y,2)+Math.pow(d,2)*Math.pow(m.x,2)));isNaN(y)&&(y=0);var b=new r.Point(y*h*m.y/d,y*-d*m.x/h),C=new r.Point((a.x+u.x)/2+Math.cos(f)*b.x-Math.sin(f)*b.y,(a.y+u.y)/2+Math.sin(f)*b.x+Math.cos(f)*b.y),I=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},E=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(I(t)*I(e))},T=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(E(t,e))},w=T([1,0],[(m.x-b.x)/h,(m.y-b.y)/d]),x=[(m.x-b.x)/h,(m.y-b.y)/d],_=[(-m.x-b.x)/h,(-m.y-b.y)/d],D=T(x,_);E(x,_)<=-1&&(D=Math.PI),1<=E(x,_)&&(D=0);var A=1-g?1:-1,O=w+D/2*A,S=new r.Point(C.x+h*Math.cos(O),C.y+d*Math.sin(O));if(e.addMarkerAngle(S,O-A*Math.PI/2),e.addMarkerAngle(u,O-A*Math.PI),n.addPoint(u.x,u.y),null!=t){E=d<h?h:d;var R=d<h?1:h/d,k=d<h?d/h:1;t.translate(C.x,C.y),t.rotate(f),t.scale(R,k),t.arc(0,0,E,w,w+D,1-g),t.scale(1/R,1/k),t.rotate(-f),t.translate(-C.x,-C.y)}}break;case"Z":case"z":null!=t&&t.closePath(),e.current=e.start}return n},this.getMarkers=function(){for(var t=this.PathParser.getMarkerPoints(),e=this.PathParser.getMarkerAngles(),n=[],i=0;i<t.length;i++)n.push([t[i],e[i]]);return n}},r.Element.path.prototype=new r.Element.PathElementBase,r.Element.pattern=function(t){this.base=r.Element.ElementBase,this.base(t),this.createPattern=function(t,e){var n=this.attribute("width").toPixels("x",!0),i=this.attribute("height").toPixels("y",!0),o=new r.Element.svg;o.attributes.viewBox=new r.Property("viewBox",this.attribute("viewBox").value),o.attributes.width=new r.Property("width",n+"px"),o.attributes.height=new r.Property("height",i+"px"),o.attributes.transform=new r.Property("transform",this.attribute("patternTransform").value),o.children=this.children;var s=document.createElement("canvas");s.width=n,s.height=i;var a=s.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&a.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var l=-1;l<=1;l++)for(var c=-1;c<=1;c++)a.save(),o.attributes.x=new r.Property("x",l*s.width),o.attributes.y=new r.Property("y",c*s.height),o.render(a),a.restore();return t.createPattern(s,"repeat")}},r.Element.pattern.prototype=new r.Element.ElementBase,r.Element.marker=function(t){this.base=r.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,e,n){t.translate(e.x,e.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(n),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();var i=new r.Element.svg;i.attributes.viewBox=new r.Property("viewBox",this.attribute("viewBox").value),i.attributes.refX=new r.Property("refX",this.attribute("refX").value),i.attributes.refY=new r.Property("refY",this.attribute("refY").value),i.attributes.width=new r.Property("width",this.attribute("markerWidth").value),i.attributes.height=new r.Property("height",this.attribute("markerHeight").value),i.attributes.fill=new r.Property("fill",this.attribute("fill").valueOrDefault("black")),i.attributes.stroke=new r.Property("stroke",this.attribute("stroke").valueOrDefault("none")),i.children=this.children,i.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-n),t.translate(-e.x,-e.y)}},r.Element.marker.prototype=new r.Element.ElementBase,r.Element.defs=function(t){this.base=r.Element.ElementBase,this.base(t),this.render=function(t){}},r.Element.defs.prototype=new r.Element.ElementBase,r.Element.GradientBase=function(t){this.base=r.Element.ElementBase,this.base(t),this.stops=[];for(var e=0;e<this.children.length;e++){var n=this.children[e];"stop"==n.type&&this.stops.push(n)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(t){for(var e=0;e<this.attributesToInherit.length;e++){var n=this.attributesToInherit[e];!this.attribute(n).hasValue()&&t.attribute(n).hasValue()&&(this.attribute(n,!0).value=t.attribute(n).value)}},this.createGradient=function(t,e,n){var i=this;function o(t){return n.hasValue()?new r.Property("color",t).addOpacity(n).value:t}this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(i));var s=this.getGradient(t,e);if(null==s)return o(i.stops[i.stops.length-1].color);for(var a=0;a<i.stops.length;a++)s.addColorStop(i.stops[a].offset,o(i.stops[a].color));if(this.attribute("gradientTransform").hasValue()){var l=r.ViewPort.viewPorts[0],c=new r.Element.rect;c.attributes.x=new r.Property("x",-r.MAX_VIRTUAL_PIXELS/3),c.attributes.y=new r.Property("y",-r.MAX_VIRTUAL_PIXELS/3),c.attributes.width=new r.Property("width",r.MAX_VIRTUAL_PIXELS),c.attributes.height=new r.Property("height",r.MAX_VIRTUAL_PIXELS);var u=new r.Element.g;u.attributes.transform=new r.Property("transform",this.attribute("gradientTransform").value),u.children=[c];var h=new r.Element.svg;h.attributes.x=new r.Property("x",0),h.attributes.y=new r.Property("y",0),h.attributes.width=new r.Property("width",l.width),h.attributes.height=new r.Property("height",l.height),h.children=[u];var d=document.createElement("canvas");d.width=l.width,d.height=l.height;var f=d.getContext("2d");return f.fillStyle=s,h.render(f),f.createPattern(d,"no-repeat")}return s}},r.Element.GradientBase.prototype=new r.Element.ElementBase,r.Element.linearGradient=function(t){this.base=r.Element.GradientBase,this.base(t),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(t,e){var n="objectBoundingBox"==this.gradientUnits()?e.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var i="objectBoundingBox"==this.gradientUnits()?n.x()+n.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),r="objectBoundingBox"==this.gradientUnits()?n.y()+n.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),o="objectBoundingBox"==this.gradientUnits()?n.x()+n.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),s="objectBoundingBox"==this.gradientUnits()?n.y()+n.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return i==o&&r==s?null:t.createLinearGradient(i,r,o,s)}},r.Element.linearGradient.prototype=new r.Element.GradientBase,r.Element.radialGradient=function(t){this.base=r.Element.GradientBase,this.base(t),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(t,e){var n=e.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var i="objectBoundingBox"==this.gradientUnits()?n.x()+n.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),r="objectBoundingBox"==this.gradientUnits()?n.y()+n.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),o=i,s=r;this.attribute("fx").hasValue()&&(o="objectBoundingBox"==this.gradientUnits()?n.x()+n.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(s="objectBoundingBox"==this.gradientUnits()?n.y()+n.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var a="objectBoundingBox"==this.gradientUnits()?(n.width()+n.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return t.createRadialGradient(o,s,0,i,r,a)}},r.Element.radialGradient.prototype=new r.Element.GradientBase,r.Element.stop=function(t){this.base=r.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),1<this.offset&&(this.offset=1);var e=this.style("stop-color",!0);""===e.value&&(e.value="#000"),this.style("stop-opacity").hasValue()&&(e=e.addOpacity(this.style("stop-opacity"))),this.color=e.value},r.Element.stop.prototype=new r.Element.ElementBase,r.Element.AnimateBase=function(t){this.base=r.Element.ElementBase,this.base(t),r.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var t=this.attribute("attributeType").value,e=this.attribute("attributeName").value;return"CSS"==t?this.parent.style(e,!0):this.parent.attribute(e,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(t){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+t;var e=!1;if(this.begin<this.duration){var n=this.calcValue();this.attribute("type").hasValue()&&(n=this.attribute("type").value+"("+n+")"),this.getProperty().value=n,e=!0}return e},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var e=t.progress*(this.values.value.length-1),n=Math.floor(e),i=Math.ceil(e);t.from=new r.Property("from",parseFloat(this.values.value[n])),t.to=new r.Property("to",parseFloat(this.values.value[i])),t.progress=(e-n)/(i-n)}else t.from=this.from,t.to=this.to;return t}},r.Element.AnimateBase.prototype=new r.Element.ElementBase,r.Element.animate=function(t){this.base=r.Element.AnimateBase,this.base(t),this.calcValue=function(){var t=this.progress();return t.from.numValue()+(t.to.numValue()-t.from.numValue())*t.progress+this.initialUnits}},r.Element.animate.prototype=new r.Element.AnimateBase,r.Element.animateColor=function(e){this.base=r.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),n=new t(e.from.value),i=new t(e.to.value);if(n.ok&&i.ok){var r=n.r+(i.r-n.r)*e.progress,o=n.g+(i.g-n.g)*e.progress,s=n.b+(i.b-n.b)*e.progress;return"rgb("+parseInt(r,10)+","+parseInt(o,10)+","+parseInt(s,10)+")"}return this.attribute("from").value}},r.Element.animateColor.prototype=new r.Element.AnimateBase,r.Element.animateTransform=function(t){this.base=r.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),e=r.ToNumberArray(t.from.value),n=r.ToNumberArray(t.to.value),i="",o=0;o<e.length;o++)i+=e[o]+(n[o]-e[o])*t.progress+" ";return i}},r.Element.animateTransform.prototype=new r.Element.animate,r.Element.font=function(t){this.base=r.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var e=0;e<this.children.length;e++){var n=this.children[e];"font-face"==n.type?(this.fontFace=n).style("font-family").hasValue()&&(r.Definitions[n.style("font-family").value]=this):"missing-glyph"==n.type?this.missingGlyph=n:"glyph"==n.type&&(""!=n.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[n.unicode]&&(this.glyphs[n.unicode]=[]),this.glyphs[n.unicode][n.arabicForm]=n):this.glyphs[n.unicode]=n)}},r.Element.font.prototype=new r.Element.ElementBase,r.Element.fontface=function(t){this.base=r.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},r.Element.fontface.prototype=new r.Element.ElementBase,r.Element.missingglyph=function(t){this.base=r.Element.path,this.base(t),this.horizAdvX=0},r.Element.missingglyph.prototype=new r.Element.path,r.Element.glyph=function(t){this.base=r.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},r.Element.glyph.prototype=new r.Element.path,r.Element.text=function(t){this.captureTextNodes=!0,this.base=r.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t);var e=this.style("dominant-baseline").toTextBaseline();null==e&&(e=this.style("alignment-baseline").toTextBaseline()),null!=e&&(t.textBaseline=e)},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),n=this.parent.style("font-size").numValueOrDefault(r.Font.Parse(r.ctx.font).fontSize);return new r.BoundingBox(t,e-n,t+Math.floor(2*n/3)*this.children[0].getText().length,e)},this.renderChildren=function(t){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(t,this,0);for(var e=0;e<this.children.length;e++)this.renderChild(t,this,this,e)},this.getAnchorDelta=function(t,e,n){var i=this.style("text-anchor").valueOrDefault("start");if("start"==i)return 0;for(var r=0,o=n;o<e.children.length;o++){var s=e.children[o];if(n<o&&s.attribute("x").hasValue())break;r+=s.measureTextRecursive(t)}return-1*("end"==i?r:r/2)},this.renderChild=function(t,e,n,i){var r=n.children[i];for(r.attribute("x").hasValue()?(r.x=r.attribute("x").toPixels("x")+e.getAnchorDelta(t,n,i),r.attribute("dx").hasValue()&&(r.x+=r.attribute("dx").toPixels("x"))):(r.attribute("dx").hasValue()&&(e.x+=r.attribute("dx").toPixels("x")),r.x=e.x),e.x=r.x+r.measureText(t),r.attribute("y").hasValue()?(r.y=r.attribute("y").toPixels("y"),r.attribute("dy").hasValue()&&(r.y+=r.attribute("dy").toPixels("y"))):(r.attribute("dy").hasValue()&&(e.y+=r.attribute("dy").toPixels("y")),r.y=e.y),e.y=r.y,r.render(t),i=0;i<r.children.length;i++)e.renderChild(t,e,r,i)}},r.Element.text.prototype=new r.Element.RenderedElementBase,r.Element.TextElementBase=function(t){this.base=r.Element.RenderedElementBase,this.base(t),this.getGlyph=function(t,e,n){var i=e[n],r=null;if(t.isArabic){var o="isolated";(0==n||" "==e[n-1])&&n<e.length-2&&" "!=e[n+1]&&(o="terminal"),0<n&&" "!=e[n-1]&&n<e.length-2&&" "!=e[n+1]&&(o="medial"),0<n&&" "!=e[n-1]&&(n==e.length-1||" "==e[n+1])&&(o="initial"),void 0!==t.glyphs[i]&&null==(r=t.glyphs[i][o])&&"glyph"==t.glyphs[i].type&&(r=t.glyphs[i])}else r=t.glyphs[i];return null==r&&(r=t.missingGlyph),r},this.renderChildren=function(t){var e=this.parent.style("font-family").getDefinition();if(null==e)""!=t.fillStyle&&t.fillText(r.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(r.compressSpaces(this.getText()),this.x,this.y);else{var n=this.parent.style("font-size").numValueOrDefault(r.Font.Parse(r.ctx.font).fontSize),i=this.parent.style("font-style").valueOrDefault(r.Font.Parse(r.ctx.font).fontStyle),o=this.getText();e.isRTL&&(o=o.split("").reverse().join(""));for(var s=r.ToNumberArray(this.parent.attribute("dx").value),a=0;a<o.length;a++){var l=this.getGlyph(e,o,a),c=n/e.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(c,-c);var u=t.lineWidth;t.lineWidth=t.lineWidth*e.fontFace.unitsPerEm/n,"italic"==i&&t.transform(1,0,.4,1,0,0),l.render(t),"italic"==i&&t.transform(1,0,-.4,1,0,0),t.lineWidth=u,t.scale(1/c,-1/c),t.translate(-this.x,-this.y),this.x+=n*(l.horizAdvX||e.horizAdvX)/e.fontFace.unitsPerEm,void 0===s[a]||isNaN(s[a])||(this.x+=s[a])}}},this.getText=function(){},this.measureTextRecursive=function(t){for(var e=this.measureText(t),n=0;n<this.children.length;n++)e+=this.children[n].measureTextRecursive(t);return e},this.measureText=function(t){var e=this.parent.style("font-family").getDefinition();if(null!=e){var n=this.parent.style("font-size").numValueOrDefault(r.Font.Parse(r.ctx.font).fontSize),i=0,o=this.getText();e.isRTL&&(o=o.split("").reverse().join(""));for(var s=r.ToNumberArray(this.parent.attribute("dx").value),a=0;a<o.length;a++)i+=(this.getGlyph(e,o,a).horizAdvX||e.horizAdvX)*n/e.fontFace.unitsPerEm,void 0===s[a]||isNaN(s[a])||(i+=s[a]);return i}var l=r.compressSpaces(this.getText());if(!t.measureText)return 10*l.length;t.save(),this.setContext(t);var c=t.measureText(l).width;return t.restore(),c}},r.Element.TextElementBase.prototype=new r.Element.RenderedElementBase,r.Element.tspan=function(t){this.captureTextNodes=!0,this.base=r.Element.TextElementBase,this.base(t),this.text=r.compressSpaces(t.value||t.text||t.textContent||""),this.getText=function(){return 0<this.children.length?"":this.text}},r.Element.tspan.prototype=new r.Element.TextElementBase,r.Element.tref=function(t){this.base=r.Element.TextElementBase,this.base(t),this.getText=function(){var t=this.getHrefAttribute().getDefinition();if(null!=t)return t.children[0].getText()}},r.Element.tref.prototype=new r.Element.TextElementBase,r.Element.a=function(t){this.base=r.Element.TextElementBase,this.base(t),this.hasText=0<t.childNodes.length;for(var e=0;e<t.childNodes.length;e++)3!=t.childNodes[e].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var e=new r.Property("fontSize",r.Font.Parse(r.ctx.font).fontSize);r.Mouse.checkBoundingBox(this,new r.BoundingBox(this.x,this.y-e.toPixels("y"),this.x+this.measureText(t),this.y))}else if(0<this.children.length){var n=new r.Element.g;n.children=this.children,n.parent=this,n.render(t)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){r.ctx.canvas.style.cursor="pointer"}},r.Element.a.prototype=new r.Element.TextElementBase,r.Element.image=function(t){this.base=r.Element.RenderedElementBase,this.base(t);var e=this.getHrefAttribute().value;if(""!=e){var n=e.match(/\.svg$/);if(r.Images.push(this),this.loaded=!1,n)this.img=r.ajax(e),this.loaded=!0;else{this.img=document.createElement("img"),1==r.opts.useCORS&&(this.img.crossOrigin="Anonymous");var i=this;this.img.onload=function(){i.loaded=!0},this.img.onerror=function(){r.log('ERROR: image "'+e+'" not found'),i.loaded=!0},this.img.src=e}this.renderChildren=function(t){var e=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),o=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y");0!=o&&0!=s&&(t.save(),n?t.drawSvg(this.img,e,i,o,s):(t.translate(e,i),r.AspectRatio(t,this.attribute("preserveAspectRatio").value,o,this.img.width,s,this.img.height,0,0),t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),n=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");return new r.BoundingBox(t,e,t+n,e+i)}}},r.Element.image.prototype=new r.Element.RenderedElementBase,r.Element.g=function(t){this.base=r.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(){for(var t=new r.BoundingBox,e=0;e<this.children.length;e++)t.addBoundingBox(this.children[e].getBoundingBox());return t}},r.Element.g.prototype=new r.Element.RenderedElementBase,r.Element.symbol=function(t){this.base=r.Element.RenderedElementBase,this.base(t),this.render=function(t){}},r.Element.symbol.prototype=new r.Element.RenderedElementBase,r.Element.style=function(t){this.base=r.Element.ElementBase,this.base(t);for(var e="",n=0;n<t.childNodes.length;n++)e+=t.childNodes[n].data;e=e.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");var i=(e=r.compressSpaces(e)).split("}");for(n=0;n<i.length;n++)if(""!=r.trim(i[n]))for(var o=i[n].split("{"),s=o[0].split(","),a=o[1].split(";"),l=0;l<s.length;l++){var c=r.trim(s[l]);if(""!=c){for(var u=r.Styles[c]||{},d=0;d<a.length;d++){var f=a[d].indexOf(":"),p=a[d].substr(0,f),g=a[d].substr(f+1,a[d].length-f);null!=p&&null!=g&&(u[r.trim(p)]=new r.Property(r.trim(p),r.trim(g)))}if(r.Styles[c]=u,r.StylesSpecificity[c]=h(c),"@font-face"==c)for(var m=u["font-family"].value.replace(/"/g,""),v=u.src.value.split(","),y=0;y<v.length;y++)if(0<v[y].indexOf('format("svg")'))for(var b=v[y].indexOf("url"),C=v[y].indexOf(")",b),I=v[y].substr(b+5,C-b-6),E=r.parseXml(r.ajax(I)).getElementsByTagName("font"),T=0;T<E.length;T++){var w=r.CreateElement(E[T]);r.Definitions[m]=w}}}},r.Element.style.prototype=new r.Element.ElementBase,r.Element.use=function(t){this.base=r.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t),this.attribute("x").hasValue()&&t.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&t.translate(0,this.attribute("y").toPixels("y"))};var e=this.getHrefAttribute().getDefinition();this.path=function(t){null!=e&&e.path(t)},this.getBoundingBox=function(){if(null!=e)return e.getBoundingBox()},this.renderChildren=function(t){if(null!=e){var n=e;"symbol"==e.type&&((n=new r.Element.svg).type="svg",n.attributes.viewBox=new r.Property("viewBox",e.attribute("viewBox").value),n.attributes.preserveAspectRatio=new r.Property("preserveAspectRatio",e.attribute("preserveAspectRatio").value),n.attributes.overflow=new r.Property("overflow",e.attribute("overflow").value),n.children=e.children),"svg"==n.type&&(this.attribute("width").hasValue()&&(n.attributes.width=new r.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(n.attributes.height=new r.Property("height",this.attribute("height").value)));var i=n.parent;n.parent=null,n.render(t),n.parent=i}}},r.Element.use.prototype=new r.Element.RenderedElementBase,r.Element.mask=function(t){this.base=r.Element.ElementBase,this.base(t),this.apply=function(t,e){var n=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),o=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y");if(0==o&&0==s){for(var a=new r.BoundingBox,l=0;l<this.children.length;l++)a.addBoundingBox(this.children[l].getBoundingBox());n=Math.floor(a.x1),i=Math.floor(a.y1),o=Math.floor(a.width()),s=Math.floor(a.height())}var c=e.attribute("mask").value;e.attribute("mask").value="";var u=document.createElement("canvas");u.width=n+o,u.height=i+s;var h=u.getContext("2d");this.renderChildren(h);var d=document.createElement("canvas");d.width=n+o,d.height=i+s;var f=d.getContext("2d");e.render(f),f.globalCompositeOperation="destination-in",f.fillStyle=h.createPattern(u,"no-repeat"),f.fillRect(0,0,n+o,i+s),t.fillStyle=f.createPattern(d,"no-repeat"),t.fillRect(0,0,n+o,i+s),e.attribute("mask").value=c},this.render=function(t){}},r.Element.mask.prototype=new r.Element.ElementBase,r.Element.clipPath=function(t){this.base=r.Element.ElementBase,this.base(t),this.apply=function(t){var e=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var n=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){},e.call(t);for(var i=0;i<this.children.length;i++){var o=this.children[i];if(void 0!==o.path){var s=null;o.style("transform",!1,!0).hasValue()&&(s=new r.Transform(o.style("transform",!1,!0).value)).apply(t),o.path(t),CanvasRenderingContext2D.prototype.closePath=n,s&&s.unapply(t)}}n.call(t),t.clip(),CanvasRenderingContext2D.prototype.beginPath=e,CanvasRenderingContext2D.prototype.closePath=n},this.render=function(t){}},r.Element.clipPath.prototype=new r.Element.ElementBase,r.Element.filter=function(t){this.base=r.Element.ElementBase,this.base(t),this.apply=function(t,e){var n=e.getBoundingBox(),i=Math.floor(n.x1),r=Math.floor(n.y1),o=Math.floor(n.width()),s=Math.floor(n.height()),a=e.style("filter").value;e.style("filter").value="";for(var l=0,c=0,u=0;u<this.children.length;u++){var h=this.children[u].extraFilterDistance||0;l=Math.max(l,h),c=Math.max(c,h)}var d=document.createElement("canvas");d.width=o+2*l,d.height=s+2*c;var f=d.getContext("2d");for(f.translate(-i+l,-r+c),e.render(f),u=0;u<this.children.length;u++)"function"==typeof this.children[u].apply&&this.children[u].apply(f,0,0,o+2*l,s+2*c);t.drawImage(d,0,0,o+2*l,s+2*c,i-l,r-c,o+2*l,s+2*c),e.style("filter",!0).value=a},this.render=function(t){}},r.Element.filter.prototype=new r.Element.ElementBase,r.Element.feDropShadow=function(t){this.base=r.Element.ElementBase,this.base(t),this.addStylesFromStyleDefinition(),this.apply=function(t,e,n,i,r){}},r.Element.feDropShadow.prototype=new r.Element.ElementBase,r.Element.feMorphology=function(t){this.base=r.Element.ElementBase,this.base(t),this.apply=function(t,e,n,i,r){}},r.Element.feMorphology.prototype=new r.Element.ElementBase,r.Element.feComposite=function(t){this.base=r.Element.ElementBase,this.base(t),this.apply=function(t,e,n,i,r){}},r.Element.feComposite.prototype=new r.Element.ElementBase,r.Element.feColorMatrix=function(t){this.base=r.Element.ElementBase,this.base(t);var e=r.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var n=e[0];e=[.213+.787*n,.715-.715*n,.072-.072*n,0,0,.213-.213*n,.715+.285*n,.072-.072*n,0,0,.213-.213*n,.715-.715*n,.072+.928*n,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var i=e[0]*Math.PI/180,o=function(t,e,n){return t+Math.cos(i)*e+Math.sin(i)*n};e=[o(.213,.787,-.213),o(.715,-.715,-.715),o(.072,-.072,.928),0,0,o(.213,-.213,.143),o(.715,.285,.14),o(.072,-.072,-.283),0,0,o(.213,-.213,-.787),o(.715,-.715,.715),o(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}function s(t,e,n,i,r,o){return t[n*i*4+4*e+o]}function a(t,e,n,i,r,o,s){t[n*i*4+4*e+o]=s}function l(t,n){var i=e[t];return i*(i<0?n-255:n)}this.apply=function(t,e,n,i,r){var o=t.getImageData(0,0,i,r);for(n=0;n<r;n++)for(e=0;e<i;e++){var c=s(o.data,e,n,i,0,0),u=s(o.data,e,n,i,0,1),h=s(o.data,e,n,i,0,2),d=s(o.data,e,n,i,0,3);a(o.data,e,n,i,0,0,l(0,c)+l(1,u)+l(2,h)+l(3,d)+l(4,1)),a(o.data,e,n,i,0,1,l(5,c)+l(6,u)+l(7,h)+l(8,d)+l(9,1)),a(o.data,e,n,i,0,2,l(10,c)+l(11,u)+l(12,h)+l(13,d)+l(14,1)),a(o.data,e,n,i,0,3,l(15,c)+l(16,u)+l(17,h)+l(18,d)+l(19,1))}t.clearRect(0,0,i,r),t.putImageData(o,0,0)}},r.Element.feColorMatrix.prototype=new r.Element.ElementBase,r.Element.feGaussianBlur=function(t){this.base=r.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,n,i,o,s){void 0!==e.canvasRGBA?(t.canvas.id=r.UniqueId(),t.canvas.style.display="none",document.body.appendChild(t.canvas),e.canvasRGBA(t.canvas.id,n,i,o,s,this.blurRadius),document.body.removeChild(t.canvas)):r.log("ERROR: StackBlur.js must be included for blur to work")}},r.Element.feGaussianBlur.prototype=new r.Element.ElementBase,r.Element.title=function(t){},r.Element.title.prototype=new r.Element.ElementBase,r.Element.desc=function(t){},r.Element.desc.prototype=new r.Element.ElementBase,r.Element.MISSING=function(t){r.log("ERROR: Element '"+t.nodeName+"' not yet implemented.")},r.Element.MISSING.prototype=new r.Element.ElementBase,r.CreateElement=function(t){var e=t.nodeName.replace(/^[^:]+:/,"");e=e.replace(/\-/g,"");var n=null;return(n=void 0!==r.Element[e]?new r.Element[e](t):new r.Element.MISSING(t)).type=t.nodeName,n},r.load=function(t,e){r.loadXml(t,r.ajax(e))},r.loadXml=function(t,e){r.loadXmlDoc(t,r.parseXml(e))},r.loadXmlDoc=function(t,e){function n(e){for(var n=t.canvas;n;)e.x-=n.offsetLeft,e.y-=n.offsetTop,n=n.offsetParent;return window.scrollX&&(e.x+=window.scrollX),window.scrollY&&(e.y+=window.scrollY),e}r.init(t),1!=r.opts.ignoreMouse&&(t.canvas.onclick=function(t){var e=n(new r.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));r.Mouse.onclick(e.x,e.y)},t.canvas.onmousemove=function(t){var e=n(new r.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));r.Mouse.onmousemove(e.x,e.y)});var i=r.CreateElement(e.documentElement);function o(){r.ViewPort.Clear(),t.canvas.parentNode&&r.ViewPort.SetCurrent(t.canvas.parentNode.clientWidth,t.canvas.parentNode.clientHeight),1!=r.opts.ignoreDimensions&&(i.style("width").hasValue()&&(t.canvas.width=i.style("width").toPixels("x"),t.canvas.style.width=t.canvas.width+"px"),i.style("height").hasValue()&&(t.canvas.height=i.style("height").toPixels("y"),t.canvas.style.height=t.canvas.height+"px"));var n=t.canvas.clientWidth||t.canvas.width,o=t.canvas.clientHeight||t.canvas.height;if(1==r.opts.ignoreDimensions&&i.style("width").hasValue()&&i.style("height").hasValue()&&(n=i.style("width").toPixels("x"),o=i.style("height").toPixels("y")),r.ViewPort.SetCurrent(n,o),null!=r.opts.offsetX&&(i.attribute("x",!0).value=r.opts.offsetX),null!=r.opts.offsetY&&(i.attribute("y",!0).value=r.opts.offsetY),null!=r.opts.scaleWidth||null!=r.opts.scaleHeight){var a=null,l=null,c=r.ToNumberArray(i.attribute("viewBox").value);null!=r.opts.scaleWidth&&(i.attribute("width").hasValue()?a=i.attribute("width").toPixels("x")/r.opts.scaleWidth:isNaN(c[2])||(a=c[2]/r.opts.scaleWidth)),null!=r.opts.scaleHeight&&(i.attribute("height").hasValue()?l=i.attribute("height").toPixels("y")/r.opts.scaleHeight:isNaN(c[3])||(l=c[3]/r.opts.scaleHeight)),null==a&&(a=l),null==l&&(l=a),i.attribute("width",!0).value=r.opts.scaleWidth,i.attribute("height",!0).value=r.opts.scaleHeight,i.style("transform",!0,!0).value+=" scale("+1/a+","+1/l+")"}1!=r.opts.ignoreClear&&t.clearRect(0,0,n,o),i.render(t),s&&(s=!1,"function"==typeof r.opts.renderCallback&&r.opts.renderCallback(e))}i.root=!0,i.addStylesFromStyleDefinition();var s=!0,a=!0;r.ImagesLoaded()&&(a=!1,o()),r.intervalID=setInterval(function(){var t=!1;if(a&&r.ImagesLoaded()&&(t=!(a=!1)),1!=r.opts.ignoreMouse&&(t|=r.Mouse.hasEvents()),1!=r.opts.ignoreAnimation)for(var e=0;e<r.Animations.length;e++)t|=r.Animations[e].update(1e3/r.FRAMERATE);"function"==typeof r.opts.forceRedraw&&1==r.opts.forceRedraw()&&(t=!0),t&&(o(),r.Mouse.runEvents())},1e3/r.FRAMERATE)},r.stop=function(){r.intervalID&&clearInterval(r.intervalID)},r.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(t,e){this.events.push({type:"onclick",x:t,y:e,run:function(t){t.onclick&&t.onclick()}})},this.onmousemove=function(t,e){this.events.push({type:"onmousemove",x:t,y:e,run:function(t){t.onmousemove&&t.onmousemove()}})},this.eventElements=[],this.checkPath=function(t,e){for(var n=0;n<this.events.length;n++){var i=this.events[n];e.isPointInPath&&e.isPointInPath(i.x,i.y)&&(this.eventElements[n]=t)}},this.checkBoundingBox=function(t,e){for(var n=0;n<this.events.length;n++){var i=this.events[n];e.isPointInBox(i.x,i.y)&&(this.eventElements[n]=t)}},this.runEvents=function(){r.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var e=this.events[t],n=this.eventElements[t];n;)e.run(n),n=n.parent;this.events=[],this.eventElements=[]}},r}(s||{});1==r.childNodes.length&&"OBJECT"==r.childNodes[0].nodeName||(r.svg=a);var l=r.getContext("2d");void 0!==o.documentElement?a.loadXmlDoc(l,o):"<"==o.substr(0,1)?a.loadXml(l,o):a.load(l,o)}else for(var c=document.querySelectorAll("svg"),u=0;u<c.length;u++){var d=c[u],f=document.createElement("canvas");f.width=d.clientWidth,f.height=d.clientHeight,d.parentNode.insertBefore(f,d),d.parentNode.removeChild(d);var p=document.createElement("div");p.appendChild(d),i(f,p.innerHTML)}};void 0!==Element.prototype.matches?n=function(t,e){return t.matches(e)}:void 0!==Element.prototype.webkitMatchesSelector?n=function(t,e){return t.webkitMatchesSelector(e)}:void 0!==Element.prototype.mozMatchesSelector?n=function(t,e){return t.mozMatchesSelector(e)}:void 0!==Element.prototype.msMatchesSelector?n=function(t,e){return t.msMatchesSelector(e)}:void 0!==Element.prototype.oMatchesSelector?n=function(t,e){return t.oMatchesSelector(e)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(n=function(t,e){return $(t).is(e)}),void 0===n&&(n=Sizzle.matchesSelector));var r=/(\[[^\]]+\])/g,o=/(#[^\s\+>~\.\[:]+)/g,s=/(\.[^\s\+>~\.\[:]+)/g,a=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,l=/(:[\w-]+\([^\)]*\))/gi,c=/(:[^\s\+>~\.\[:]+)/g,u=/([^\s\+>~\.\[:]+)/g;return"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(t,e,n,r,o,s){var a={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:e,offsetY:n,scaleWidth:r,scaleHeight:o};for(var l in s)s.hasOwnProperty(l)&&(a[l]=s[l]);i(this.canvas,t,a)}),i}function h(t){function e(e,i){var r=t.match(e);null!=r&&(n[i]+=r.length,t=t.replace(e," "))}var n=[0,0,0];return t=(t=t.replace(/:not\(([^\)]*)\)/g,"     $1 ")).replace(/{[\s\S]*/gm," "),e(r,1),e(o,0),e(s,1),e(a,2),e(l,1),e(c,1),t=(t=t.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),e(u,2),n.join("")}});var y=Math,b=y.abs,C=y.cos,I=y.sin,E=y.sqrt,T=y.min,w=y.max,x=y.atan2,_=y.round,D=y.floor,A=y.PI,O=y.pow,S={curveThroughPoints:function(t){return console.warn("deprecated"),new P(R.throughPoints(t)).serialize()},getCurveControlPoints:function(t){console.warn("deprecated");var e,n=[],i=[],r=t.length-1;if(1==r)return n[0]=new L((2*t[0].x+t[1].x)/3,(2*t[0].y+t[1].y)/3),i[0]=new L(2*n[0].x-t[0].x,2*n[0].y-t[0].y),[n,i];var o=[];for(e=1;e<r-1;e++)o[e]=4*t[e].x+2*t[e+1].x;o[0]=t[0].x+2*t[1].x,o[r-1]=(8*t[r-1].x+t[r].x)/2;var s=this.getFirstControlPoints(o);for(e=1;e<r-1;++e)o[e]=4*t[e].y+2*t[e+1].y;o[0]=t[0].y+2*t[1].y,o[r-1]=(8*t[r-1].y+t[r].y)/2;var a=this.getFirstControlPoints(o);for(e=0;e<r;e++)n.push(new L(s[e],a[e])),e<r-1?i.push(new L(2*t[e+1].x-s[e+1],2*t[e+1].y-a[e+1])):i.push(new L((t[r].x+s[r-1])/2,(t[r].y+a[r-1])/2));return[n,i]},getCurveDivider:function(t,e,n,i){console.warn("deprecated");var r=new R(t,e,n,i);return function(t){var e=r.divide(t);return[{p0:e[0].start,p1:e[0].controlPoint1,p2:e[0].controlPoint2,p3:e[0].end},{p0:e[1].start,p1:e[1].controlPoint1,p2:e[1].controlPoint2,p3:e[1].end}]}},getFirstControlPoints:function(t){console.warn("deprecated");var e=t.length,n=[],i=[],r=2;n[0]=t[0]/r;for(var o=1;o<e;o++)i[o]=1/r,r=(o<e-1?4:3.5)-i[o],n[o]=(t[o]-n[o-1])/r;for(o=1;o<e;o++)n[e-o-1]-=i[e-o]*n[e-o];return n},getInversionSolver:function(t,e,n,i){console.warn("deprecated");var r=new R(t,e,n,i);return function(t){return r.closestPointT(t)}}},R=function(t,e,n,i){return this instanceof R?t instanceof R?new R(t.start,t.controlPoint1,t.controlPoint2,t.end):(this.start=new L(t),this.controlPoint1=new L(e),this.controlPoint2=new L(n),void(this.end=new L(i))):new R(t,e,n,i)};function k(t){var e=t.length,n=[],i=[],r=2;n[0]=t[0]/r;for(var o=1;o<e;o++)i[o]=1/r,r=(o<e-1?4:3.5)-i[o],n[o]=(t[o]-n[o-1])/r;for(o=1;o<e;o++)n[e-o-1]-=i[e-o]*n[e-o];return n}R.throughPoints=function(t){if(!t||Array.isArray(t)&&t.length<2)throw new Error("At least 2 points are required");for(var e=function(t){var e,n=[],i=[],r=t.length-1;if(1==r)return n[0]=new L((2*t[0].x+t[1].x)/3,(2*t[0].y+t[1].y)/3),i[0]=new L(2*n[0].x-t[0].x,2*n[0].y-t[0].y),[n,i];var o=[];for(e=1;e<r-1;e++)o[e]=4*t[e].x+2*t[e+1].x;o[0]=t[0].x+2*t[1].x,o[r-1]=(8*t[r-1].x+t[r].x)/2;var s=k(o);for(e=1;e<r-1;++e)o[e]=4*t[e].y+2*t[e+1].y;o[0]=t[0].y+2*t[1].y,o[r-1]=(8*t[r-1].y+t[r].y)/2;var a=k(o);for(e=0;e<r;e++)n.push(new L(s[e],a[e])),e<r-1?i.push(new L(2*t[e+1].x-s[e+1],2*t[e+1].y-a[e+1])):i.push(new L((t[r].x+s[r-1])/2,(t[r].y+a[r-1])/2));return[n,i]}(t),n=[],i=e[0].length,r=0;r<i;r++){var o=new L(e[0][r].x,e[0][r].y),s=new L(e[1][r].x,e[1][r].y);n.push(new R(t[r],o,s,t[r+1]))}return n},R.prototype={bbox:function(){for(var t,e,n,i,r,o,s,a,l=this.start,c=this.controlPoint1,u=this.controlPoint2,h=this.end,d=l.x,f=l.y,p=c.x,g=c.y,m=u.x,v=u.y,y=h.x,C=h.y,I=new Array,x=new Array,_=[new Array,new Array],D=0;D<2;++D)if(n=0===D?(e=6*d-12*p+6*m,t=-3*d+9*p-9*m+3*y,3*p-3*d):(e=6*f-12*g+6*v,t=-3*f+9*g-9*v+3*C,3*g-3*f),b(t)<1e-12){if(b(e)<1e-12)continue;0<(i=-n/e)&&i<1&&x.push(i)}else a=E(s=e*e-4*n*t),s<0||(0<(r=(-e+a)/(2*t))&&r<1&&x.push(r),0<(o=(-e-a)/(2*t))&&o<1&&x.push(o));for(var A,O,S,R=x.length,k=R;R--;)O=(A=1-(i=x[R]))*A*A*d+3*A*A*i*p+3*A*i*i*m+i*i*i*y,_[0][R]=O,S=A*A*A*f+3*A*A*i*g+3*A*i*i*v+i*i*i*C,_[1][R]=S,I[R]={X:O,Y:S};x[k]=0,x[k+1]=1,I[k]={X:d,Y:f},I[k+1]={X:y,Y:C},_[0][k]=d,_[1][k]=f,_[0][k+1]=y,_[1][k+1]=C,x.length=k+2,_[0].length=k+2,_[1].length=k+2,I.length=k+2;var N=T.apply(null,_[0]),M=T.apply(null,_[1]),P=w.apply(null,_[0]),L=w.apply(null,_[1]);return new B(N,M,P-N,L-M)},clone:function(){return new R(this.start,this.controlPoint1,this.controlPoint2,this.end)},closestPoint:function(t,e){return this.pointAtT(this.closestPointT(t,e))},closestPointLength:function(t,e){var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,i={precision:n,subdivisions:void 0===e.subdivisions?this.getSubdivisions({precision:n}):e.subdivisions};return this.lengthAtT(this.closestPointT(t,i),i)},closestPointNormalizedLength:function(t,e){var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,i={precision:n,subdivisions:void 0===e.subdivisions?this.getSubdivisions({precision:n}):e.subdivisions},r=this.closestPointLength(t,i);if(!r)return 0;var o=this.length(i);return 0===o?0:r/o},closestPointT:function(t,e){for(var n,i,r,o,s,a,l,c=void 0===(e=e||{}).precision?this.PRECISION:e.precision,u=void 0===e.subdivisions?this.getSubdivisions({precision:c}):e.subdivisions,h=u.length,d=h?1/h:0,f=0;f<h;f++){var p=u[f],g=p.start.distance(t),m=p.end.distance(t),v=g+m;(!l||v<l)&&(i=f*d,r=(f+1)*d,o=g,s=m,a=(n=p).start.distance(p.end),l=v)}for(var y=O(10,-c);;){var C=o?b(o-s)/o:0,I=s?b(o-s)/s:0;if(C<y||I<y||!o||o<a*y||!s||s<a*y)return o<=s?i:r;var E=n.divide(.5);d/=2;var T=E[0].start.distance(t),w=E[0].end.distance(t),x=T+w,_=E[1].start.distance(t),D=E[1].end.distance(t);s=x<=_+D?(n=E[0],r-=d,o=T,w):(n=E[1],i+=d,o=_,D)}},closestPointTangent:function(t,e){return this.tangentAtT(this.closestPointT(t,e))},containsPoint:function(t,e){return this.toPolyline(e).containsPoint(t)},divideAt:function(t,e){if(t<=0)return this.divideAtT(0);if(1<=t)return this.divideAtT(1);var n=this.tAt(t,e);return this.divideAtT(n)},divideAtLength:function(t,e){var n=this.tAtLength(t,e);return this.divideAtT(n)},divideAtT:function(t){var e=this.start,n=this.controlPoint1,i=this.controlPoint2,r=this.end;if(t<=0)return[new R(e,e,e,e),new R(e,n,i,r)];if(1<=t)return[new R(e,n,i,r),new R(r,r,r,r)];var o=this.getSkeletonPoints(t),s=o.startControlPoint1,a=o.startControlPoint2,l=o.divider,c=o.dividerControlPoint1,u=o.dividerControlPoint2;return[new R(e,s,a,l),new R(l,c,u,r)]},endpointDistance:function(){return this.start.distance(this.end)},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.controlPoint1.x===t.controlPoint1.x&&this.controlPoint1.y===t.controlPoint1.y&&this.controlPoint2.x===t.controlPoint2.x&&this.controlPoint2.y===t.controlPoint2.y&&this.end.x===t.end.x&&this.end.y===t.end.y},getSkeletonPoints:function(t){var e=this.start,n=this.controlPoint1,i=this.controlPoint2,r=this.end;if(t<=0)return{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:i.clone()};if(1<=t)return{startControlPoint1:n.clone(),startControlPoint2:i.clone(),divider:r.clone(),dividerControlPoint1:r.clone(),dividerControlPoint2:r.clone()};var o=new M(e,n).pointAt(t),s=new M(n,i).pointAt(t),a=new M(i,r).pointAt(t),l=new M(o,s).pointAt(t),c=new M(s,a).pointAt(t);return{startControlPoint1:o,startControlPoint2:l,divider:new M(l,c).pointAt(t),dividerControlPoint1:c,dividerControlPoint2:a}},getSubdivisions:function(t){var e=void 0===(t=t||{}).precision?this.PRECISION:t.precision,n=[new R(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(0===e)return n;for(var i=this.endpointDistance(),r=O(10,-e),o=0;;){o+=1;for(var s=[],a=n.length,l=0;l<a;l++){var c=n[l].divide(.5);s.push(c[0],c[1])}for(var u=0,h=s.length,d=0;d<h;d++)u+=s[d].endpointDistance();if(1<o&&(0!==u?(u-i)/u:0)<r)return s;n=s,i=u}},isDifferentiable:function(){var t=this.start,e=this.controlPoint1,n=this.controlPoint2,i=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(i))},length:function(t){for(var e=void 0===(t=t||{}).precision?this.PRECISION:t.precision,n=void 0===t.subdivisions?this.getSubdivisions({precision:e}):t.subdivisions,i=0,r=n.length,o=0;o<r;o++)i+=n[o].endpointDistance();return i},lengthAtT:function(t,e){if(t<=0)return 0;var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision;return this.divide(t)[0].length({precision:n})},pointAt:function(t,e){if(t<=0)return this.start.clone();if(1<=t)return this.end.clone();var n=this.tAt(t,e);return this.pointAtT(n)},pointAtLength:function(t,e){var n=this.tAtLength(t,e);return this.pointAtT(n)},pointAtT:function(t){return t<=0?this.start.clone():1<=t?this.end.clone():this.getSkeletonPoints(t).divider},PRECISION:3,scale:function(t,e,n){return this.start.scale(t,e,n),this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this},tangentAt:function(t,e){if(!this.isDifferentiable())return null;t<0?t=0:1<t&&(t=1);var n=this.tAt(t,e);return this.tangentAtT(n)},tangentAtLength:function(t,e){if(!this.isDifferentiable())return null;var n=this.tAtLength(t,e);return this.tangentAtT(n)},tangentAtT:function(t){if(!this.isDifferentiable())return null;t<0?t=0:1<t&&(t=1);var e=this.getSkeletonPoints(t),n=e.startControlPoint2,i=e.dividerControlPoint1,r=e.divider,o=new M(n,i);return o.translate(r.x-n.x,r.y-n.y),o},tAt:function(t,e){if(t<=0)return 0;if(1<=t)return 1;var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,i={precision:n,subdivisions:void 0===e.subdivisions?this.getSubdivisions({precision:n}):e.subdivisions},r=this.length(i)*t;return this.tAtLength(r,i)},tAtLength:function(t,e){var n=!0;t<0&&(n=!1,t=-t);for(var i,r,o,s,a,l=void 0===(e=e||{}).precision?this.PRECISION:e.precision,c=void 0===e.subdivisions?this.getSubdivisions({precision:l}):e.subdivisions,u={precision:l,subdivisions:c},h=0,d=c.length,f=1/d,p=0;p<d;p++){var g=n?p:d-1-p,m=c[p],v=m.endpointDistance();if(t<=h+v){i=m,r=g*f,o=(g+1)*f,s=n?t-h:v+h-t,a=n?v+h-t:t-h;break}h+=v}if(!i)return n?1:0;for(var y=this.length(u),b=O(10,-l);;){var C,I;if((0!==y?s/y:0)<b)return r;if((0!==y?a/y:0)<b)return o;var E=i.divide(.5);f/=2;var T=E[0].endpointDistance(),w=E[1].endpointDistance();I=s<=T?(i=E[0],o-=f,T-(C=s)):(i=E[1],r+=f,w-(C=s-T)),s=C,a=I}},toPoints:function(t){for(var e=void 0===(t=t||{}).precision?this.PRECISION:t.precision,n=void 0===t.subdivisions?this.getSubdivisions({precision:e}):t.subdivisions,i=[n[0].start.clone()],r=n.length,o=0;o<r;o++){var s=n[o];i.push(s.end.clone())}return i},toPolyline:function(t){return new K(this.toPoints(t))},toString:function(){return this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}},R.prototype.divide=R.prototype.divideAtT;var N=function(t,e,n){return this instanceof N?t instanceof N?new N(new L(t.x,t.y),t.a,t.b):(t=new L(t),this.x=t.x,this.y=t.y,this.a=e,void(this.b=n)):new N(t,e,n)};N.fromRect=function(t){return t=new B(t),new N(t.center(),t.width/2,t.height/2)},N.prototype={bbox:function(){return new B(this.x-this.a,this.y-this.b,2*this.a,2*this.b)},center:function(){return new L(this.x,this.y)},clone:function(){return new N(this)},containsPoint:function(t){return this.normalizedDistance(t)<=1},equals:function(t){return!!t&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b},inflate:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.a+=2*t,this.b+=2*e,this},intersectionWithLine:function(t){var e=[],n=t.start,i=t.end,r=this.a,o=this.b,s=t.vector(),a=n.difference(new L(this)),l=new L(s.x/(r*r),s.y/(o*o)),c=new L(a.x/(r*r),a.y/(o*o)),u=s.dot(l),h=s.dot(c),d=h*h-u*(a.dot(c)-1);if(d<0)return null;if(0<d){var f=E(d),p=(-h-f)/u,g=(-h+f)/u;if((p<0||1<p)&&(g<0||1<g))return null;0<=p&&p<=1&&e.push(n.lerp(i,p)),0<=g&&g<=1&&e.push(n.lerp(i,g))}else{var m=-h/u;if(!(0<=m&&m<=1))return null;e.push(n.lerp(i,m))}return e},intersectionWithLineFromCenterToPoint:function(t,e){t=new L(t),e&&t.rotate(new L(this.x,this.y),e);var n,i=t.x-this.x,r=t.y-this.y;if(0==i)return n=this.bbox().pointNearestToPoint(t),e?n.rotate(new L(this.x,this.y),-e):n;var o=r/i,s=o*o,a=this.a*this.a,l=this.b*this.b,c=E(1/(1/a+s/l)),u=o*(c=i<0?-c:c);return n=new L(this.x+c,this.y+u),e?n.rotate(new L(this.x,this.y),-e):n},normalizedDistance:function(t){var e=t.x,n=t.y,i=this.a,r=this.b,o=this.x,s=this.y;return(e-o)*(e-o)/(i*i)+(n-s)*(n-s)/(r*r)},tangentTheta:function(t){var e,n,i=t.x,r=t.y,o=this.a,s=this.b,a=this.bbox().center(),l=a.x,c=a.y,u=i>a.x+o/2,h=i<a.x-o/2;return u||h?n=o*o/(i-l)-o*o*(r-c)*((e=i>a.x?r-30:r+30)-c)/(s*s*(i-l))+l:e=s*s/(r-c)-s*s*(i-l)*((n=r>a.y?i+30:i-30)-l)/(o*o*(r-c))+c,new L(n,e).theta(t)},toString:function(){return new L(this.x,this.y).toString()+" "+this.a+" "+this.b}};var M=function(t,e){return this instanceof M?t instanceof M?new M(t.start,t.end):(this.start=new L(t),void(this.end=new L(e))):new M(t,e)};M.prototype={angle:function(){var t=new L(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)},bbox:function(){var t=T(this.start.x,this.end.x),e=T(this.start.y,this.end.y),n=w(this.start.x,this.end.x),i=w(this.start.y,this.end.y);return new B(t,e,n-t,i-e)},bearing:function(){var t=V(this.start.y),e=V(this.end.y),n=this.start.x,i=this.end.x,r=V(i-n),o=I(r)*C(e),s=C(t)*I(e)-I(t)*C(e)*C(r),a=F(x(o,s))-22.5;return a<0&&(a+=360),["NE","E","SE","S","SW","W","NW","N"][a=parseInt(a/45)]},clone:function(){return new M(this.start,this.end)},closestPoint:function(t){return this.pointAt(this.closestPointNormalizedLength(t))},closestPointLength:function(t){return this.closestPointNormalizedLength(t)*this.length()},closestPointNormalizedLength:function(t){var e=this.vector().dot(new M(this.start,t).vector()),n=T(1,w(0,e/this.squaredLength()));return n!=n?0:n},closestPointTangent:function(t){return this.tangentAt(this.closestPointNormalizedLength(t))},containsPoint:function(t){var e=this.start,n=this.end;if(0!==e.cross(t,n))return!1;var i=this.length();return!(new M(e,t).length()>i||new M(t,n).length()>i)},divideAt:function(t){var e=this.pointAt(t);return[new M(this.start,e),new M(e,this.end)]},divideAtLength:function(t){var e=this.pointAtLength(t);return[new M(this.start,e),new M(e,this.end)]},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y},intersect:function(t,e){if(t instanceof M||t instanceof B||t instanceof K||t instanceof N||t instanceof P){var n=t.intersectionWithLine(this,e);return n&&t instanceof M&&(n=n[0]),n}return null},intersectionWithLine:function(t){var e=new L(this.end.x-this.start.x,this.end.y-this.start.y),n=new L(t.end.x-t.start.x,t.end.y-t.start.y),i=e.x*n.y-e.y*n.x,r=new L(t.start.x-this.start.x,t.start.y-this.start.y),o=r.x*n.y-r.y*n.x,s=r.x*e.y-r.y*e.x;if(0==i||o*i<0||s*i<0)return null;if(0<i){if(i<o||i<s)return null}else if(o<i||s<i)return null;return[new L(this.start.x+o*e.x/i,this.start.y+o*e.y/i)]},isDifferentiable:function(){return!this.start.equals(this.end)},length:function(){return E(this.squaredLength())},midpoint:function(){return new L((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},pointAt:function(t){var e=this.start,n=this.end;return t<=0?e.clone():1<=t?n.clone():e.lerp(n,t)},pointAtLength:function(t){var e=this.start,n=this.end,i=!0;t<0&&(i=!1,t=-t);var r=this.length();return r<=t?i?n.clone():e.clone():this.pointAt((i?t:r-t)/r)},pointOffset:function(t){t=new L(t);var e=this.start,n=this.end;return((n.x-e.x)*(t.y-e.y)-(n.y-e.y)*(t.x-e.x))/this.length()},rotate:function(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this},round:function(t){var e=O(10,t||0);return this.start.x=_(this.start.x*e)/e,this.start.y=_(this.start.y*e)/e,this.end.x=_(this.end.x*e)/e,this.end.y=_(this.end.y*e)/e,this},scale:function(t,e,n){return this.start.scale(t,e,n),this.end.scale(t,e,n),this},setLength:function(t){var e=this.length();if(!e)return this;var n=t/e;return this.scale(n,n,this.start)},squaredLength:function(){var t=this.start.x,e=this.start.y;return(t-=this.end.x)*t+(e-=this.end.y)*e},tangentAt:function(t){if(!this.isDifferentiable())return null;var e=this.start,n=this.end,i=this.pointAt(t),r=new M(e,n);return r.translate(i.x-e.x,i.y-e.y),r},tangentAtLength:function(t){if(!this.isDifferentiable())return null;var e=this.start,n=this.end,i=this.pointAtLength(t),r=new M(e,n);return r.translate(i.x-e.x,i.y-e.y),r},toString:function(){return this.start.toString()+" "+this.end.toString()},translate:function(t,e){return this.start.translate(t,e),this.end.translate(t,e),this},vector:function(){return new L(this.end.x-this.start.x,this.end.y-this.start.y)}},M.prototype.intersection=M.prototype.intersect;var P=function(t){if(!(this instanceof P))return new P(t);if("string"==typeof t)return new P.parse(t);var e,n;if(this.segments=[],t)if(Array.isArray(t)&&0!==t.length)if(n=(t=t.reduce(function(t,e){return t.concat(e)},[])).length,t[0].isSegment)for(e=0;e<n;e++){var i=t[e];this.appendSegment(i)}else{var r=null;for(e=0;e<n;e++){var o=t[e];if(!(o instanceof M||o instanceof R))throw new Error("Cannot construct a path segment from the provided object.");0===e&&this.appendSegment(P.createSegment("M",o.start)),r&&!r.end.equals(o.start)&&this.appendSegment(P.createSegment("M",o.start)),o instanceof M?this.appendSegment(P.createSegment("L",o.end)):o instanceof R&&this.appendSegment(P.createSegment("C",o.controlPoint1,o.controlPoint2,o.end)),r=o}}else if(t.isSegment)this.appendSegment(t);else if(t instanceof M)this.appendSegment(P.createSegment("M",t.start)),this.appendSegment(P.createSegment("L",t.end));else if(t instanceof R)this.appendSegment(P.createSegment("M",t.start)),this.appendSegment(P.createSegment("C",t.controlPoint1,t.controlPoint2,t.end));else{if(!(t instanceof K))throw new Error("Cannot construct a path from the provided object.");if(!t.points||0===t.points.length)return;for(n=t.points.length,e=0;e<n;e++){var s=t.points[e];0===e?this.appendSegment(P.createSegment("M",s)):this.appendSegment(P.createSegment("L",s))}}};P.parse=function(t){if(!t)return new P;for(var e=new P,n=t.match(/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g),i=n.length,r=0;r<i;r++){var o=n[r].match(/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g),s=P.createSegment.apply(this,o);e.appendSegment(s)}return e},P.createSegment=function(t){var e=arguments;if(!t)throw new Error("Type must be provided.");var n=P.segmentTypes[t];if(!n)throw new Error(t+" is not a recognized path segment type.");for(var i=[],r=arguments.length,o=1;o<r;o++)i.push(e[o]);return X(n,i)},P.prototype={appendSegment:function(t){var e,n=this.segments,i=n.length,r=0!==i?n[i-1]:null;if(Array.isArray(t)){if(!(t=t.reduce(function(t,e){return t.concat(e)},[]))[0].isSegment)throw new Error("Segments required.");for(var o=t.length,s=0;s<o;s++){var a=t[s];e=this.prepareSegment(a,r,null),n.push(e),r=e}}else{if(!t||!t.isSegment)throw new Error("Segment required.");e=this.prepareSegment(t,r,null),n.push(e)}},bbox:function(){var t,e=this.segments,n=e.length;if(0===n)return null;for(var i=0;i<n;i++){var r=e[i];if(r.isVisible){var o=r.bbox();t=t?t.union(o):o}}if(t)return t;var s=e[n-1];return new B(s.end.x,s.end.y,0,0)},clone:function(){for(var t=this.segments,e=t.length,n=new P,i=0;i<e;i++){var r=t[i].clone();n.appendSegment(r)}return n},closestPoint:function(t,e){var n=this.closestPointT(t,e);return n?this.pointAtT(n):null},closestPointLength:function(t,e){var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,i={precision:n,segmentSubdivisions:void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions},r=this.closestPointT(t,i);return r?this.lengthAtT(r,i):0},closestPointNormalizedLength:function(t,e){var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,i={precision:n,segmentSubdivisions:void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions},r=this.closestPointLength(t,i);if(0===r)return 0;var o=this.length(i);return 0===o?0:r/o},closestPointT:function(t,e){var n=this.segments,i=n.length;if(0===i)return null;for(var r,o=void 0===(e=e||{}).precision?this.PRECISION:e.precision,s=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,a=1/0,l=0;l<i;l++){var c=n[l],u=s[l];if(c.isVisible){var h=c.closestPointT(t,{precision:o,subdivisions:u}),d=c.pointAtT(h),f=new M(d,t).squaredLength();f<a&&(r={segmentIndex:l,value:h},a=f)}}return r||{segmentIndex:i-1,value:1}},closestPointTangent:function(t,e){var n=this.segments,i=n.length;if(0===i)return null;for(var r,o=void 0===(e=e||{}).precision?this.PRECISION:e.precision,s=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,a=1/0,l=0;l<i;l++){var c=n[l],u=s[l];if(c.isDifferentiable()){var h=c.closestPointT(t,{precision:o,subdivisions:u}),d=c.pointAtT(h),f=new M(d,t).squaredLength();f<a&&(r=c.tangentAtT(h),a=f)}}return r||null},containsPoint:function(t,e){var n=this.toPolylines(e);if(!n)return!1;for(var i=n.length,r=0,o=0;o<i;o++)n[o].containsPoint(t)&&r++;return r%2==1},divideAt:function(t,e){if(0===this.segments.length)return null;t<0&&(t=0),1<t&&(t=1);var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,i={precision:n,segmentSubdivisions:void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions},r=this.length(i)*t;return this.divideAtLength(r,i)},divideAtLength:function(t,e){var n=this.segments.length;if(0===n)return null;var i=!0;t<0&&(i=!1,t=-t);var r,o,s,a,l,c,u,h=void 0===(e=e||{}).precision?this.PRECISION:e.precision,d=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:h}):e.segmentSubdivisions,f=0;for(r=0;r<n;r++){var p=i?r:n-1-r;o=this.getSegment(p);var g=d[p],m=o.length({precision:h,subdivisions:g});if(o.isDifferentiable()&&(l=o,c=p,t<=f+m)){a=p,s=o.divideAtLength((i?1:-1)*(t-f),{precision:h,subdivisions:g});break}f+=m}if(!l)return null;s||(a=c,u=i?1:0,s=l.divideAtT(u));var v=this.clone();v.replaceSegment(a,s);var y=a,b=a+1,C=a+2;s[0].isDifferentiable()||(v.removeSegment(y),b-=1,C-=1);var I=v.getSegment(b).start;v.insertSegment(b,P.createSegment("M",I)),C+=1,s[1].isDifferentiable()||(v.removeSegment(C-1),C-=1);var E=C-y-1;for(r=C;r<v.segments.length;r++){var T=this.getSegment(r-E);if("Z"===(o=v.getSegment(r)).type&&!T.subpathStartSegment.end.equals(o.subpathStartSegment.end)){var w=P.createSegment("L",T.end);v.replaceSegment(r,w)}}return[new P(v.segments.slice(0,b)),new P(v.segments.slice(b))]},equals:function(t){if(!t)return!1;var e=this.segments,n=t.segments,i=e.length;if(n.length!==i)return!1;for(var r=0;r<i;r++){var o=e[r],s=n[r];if(o.type!==s.type||!o.equals(s))return!1}return!0},getSegment:function(t){var e=this.segments,n=e.length;if(0===n)throw new Error("Path has no segments.");if(t<0&&(t=n+t),n<=t||t<0)throw new Error("Index out of range.");return e[t]},getSegmentSubdivisions:function(t){for(var e=this.segments,n=e.length,i=void 0===(t=t||{}).precision?this.PRECISION:t.precision,r=[],o=0;o<n;o++){var s=e[o].getSubdivisions({precision:i});r.push(s)}return r},insertSegment:function(t,e){var n,i=this.segments,r=i.length;if(t<0&&(t=r+t+1),r<t||t<0)throw new Error("Index out of range.");var o=null,s=null;if(0!==r&&(s=1<=t?(o=i[t-1]).nextSegment:i[0]),Array.isArray(e)){if(!(e=e.reduce(function(t,e){return t.concat(e)},[]))[0].isSegment)throw new Error("Segments required.");for(var a=e.length,l=0;l<a;l++){var c=e[l];n=this.prepareSegment(c,o,s),i.splice(t+l,0,n),o=n}}else{if(!e||!e.isSegment)throw new Error("Segment required.");n=this.prepareSegment(e,o,s),i.splice(t,0,n)}},intersectionWithLine:function(t,e){var n=null,i=this.toPolylines(e);if(!i)return null;for(var r=0,o=i.length;r<o;r++){var s=i[r],a=t.intersect(s);a&&(n=n||[],Array.isArray(a)?Array.prototype.push.apply(n,a):n.push(a))}return n},isDifferentiable:function(){for(var t=this.segments,e=t.length,n=0;n<e;n++)if(t[n].isDifferentiable())return!0;return!1},isValid:function(){var t=this.segments;return 0===t.length||"M"===t[0].type},length:function(t){var e=this.segments,n=e.length;if(0===n)return 0;for(var i=void 0===(t=t||{}).precision?this.PRECISION:t.precision,r=void 0===t.segmentSubdivisions?this.getSegmentSubdivisions({precision:i}):t.segmentSubdivisions,o=0,s=0;s<n;s++){var a=e[s],l=r[s];o+=a.length({subdivisions:l})}return o},lengthAtT:function(t,e){var n=this.segments,i=n.length;if(0===i)return 0;var r=t.segmentIndex;if(r<0)return 0;var o=t.value;i<=r?(r=i-1,o=1):o<0?o=0:1<o&&(o=1);for(var s,a=void 0===(e=e||{}).precision?this.PRECISION:e.precision,l=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:a}):e.segmentSubdivisions,c=0,u=0;u<r;u++){var h=n[u];s=l[u],c+=h.length({precisison:a,subdivisions:s})}return h=n[r],s=l[r],c+h.lengthAtT(o,{precisison:a,subdivisions:s})},pointAt:function(t,e){if(0===this.segments.length)return null;if(t<=0)return this.start.clone();if(1<=t)return this.end.clone();var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,i={precision:n,segmentSubdivisions:void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions},r=this.length(i)*t;return this.pointAtLength(r,i)},pointAtLength:function(t,e){var n=this.segments,i=n.length;if(0===i)return null;if(0===t)return this.start.clone();var r=!0;t<0&&(r=!1,t=-t);for(var o,s=void 0===(e=e||{}).precision?this.PRECISION:e.precision,a=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:s}):e.segmentSubdivisions,l=0,c=0;c<i;c++){var u=r?c:i-1-c,h=n[u],d=a[u],f=h.length({precision:s,subdivisions:d});if(h.isVisible){if(t<=l+f)return h.pointAtLength((r?1:-1)*(t-l),{precision:s,subdivisions:d});o=h}l+=f}return o?r?o.end:o.start:n[i-1].end.clone()},pointAtT:function(t){var e=this.segments,n=e.length;if(0===n)return null;var i=t.segmentIndex;if(i<0)return e[0].pointAtT(0);if(n<=i)return e[n-1].pointAtT(1);var r=t.value;return r<0?r=0:1<r&&(r=1),e[i].pointAtT(r)},PRECISION:3,prepareSegment:function(t,e,n){t.previousSegment=e,t.nextSegment=n,e&&(e.nextSegment=t),n&&(n.previousSegment=t);var i=t;return t.isSubpathStart&&(t.subpathStartSegment=t,i=n),i&&this.updateSubpathStartSegment(i),t},removeSegment:function(t){var e=this.segments,n=e.length;if(0===n)throw new Error("Path has no segments.");if(t<0&&(t=n+t),n<=t||t<0)throw new Error("Index out of range.");var i=e.splice(t,1)[0],r=i.previousSegment,o=i.nextSegment;r&&(r.nextSegment=o),o&&(o.previousSegment=r),i.isSubpathStart&&o&&this.updateSubpathStartSegment(o)},replaceSegment:function(t,e){var n,i=this.segments,r=i.length;if(0===r)throw new Error("Path has no segments.");if(t<0&&(t=r+t),r<=t||t<0)throw new Error("Index out of range.");var o=i[t],s=o.previousSegment,a=o.nextSegment,l=o.isSubpathStart;if(Array.isArray(e)){if(!(e=e.reduce(function(t,e){return t.concat(e)},[]))[0].isSegment)throw new Error("Segments required.");i.splice(t,1);for(var c=e.length,u=0;u<c;u++){var h=e[u];n=this.prepareSegment(h,s,a),i.splice(t+u,0,n),s=n,l&&n.isSubpathStart&&(l=!1)}}else{if(!e||!e.isSegment)throw new Error("Segment required.");n=this.prepareSegment(e,s,a),i.splice(t,1,n),l&&n.isSubpathStart&&(l=!1)}l&&a&&this.updateSubpathStartSegment(a)},scale:function(t,e,n){for(var i=this.segments,r=i.length,o=0;o<r;o++)i[o].scale(t,e,n);return this},segmentAt:function(t,e){var n=this.segmentIndexAt(t,e);return n?this.getSegment(n):null},segmentAtLength:function(t,e){var n=this.segmentIndexAtLength(t,e);return n?this.getSegment(n):null},segmentIndexAt:function(t,e){if(0===this.segments.length)return null;t<0&&(t=0),1<t&&(t=1);var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,i={precision:n,segmentSubdivisions:void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions},r=this.length(i)*t;return this.segmentIndexAtLength(r,i)},segmentIndexAtLength:function(t,e){var n=this.segments,i=n.length;if(0===i)return null;var r=!0;t<0&&(r=!1,t=-t);for(var o=void 0===(e=e||{}).precision?this.PRECISION:e.precision,s=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,a=null,l=0,c=0;c<i;c++){var u=r?c:i-1-c,h=n[u],d=s[u],f=h.length({precision:o,subdivisions:d});if(h.isVisible){if(t<=l+f)return u;a=u}l+=f}return a},serialize:function(){if(!this.isValid())throw new Error("Invalid path segments.");return this.toString()},tangentAt:function(t,e){if(0===this.segments.length)return null;t<0&&(t=0),1<t&&(t=1);var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,i={precision:n,segmentSubdivisions:void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions},r=this.length(i)*t;return this.tangentAtLength(r,i)},tangentAtLength:function(t,e){var n=this.segments,i=n.length;if(0===i)return null;var r=!0;t<0&&(r=!1,t=-t);for(var o,s=void 0===(e=e||{}).precision?this.PRECISION:e.precision,a=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:s}):e.segmentSubdivisions,l=0,c=0;c<i;c++){var u=r?c:i-1-c,h=n[u],d=a[u],f=h.length({precision:s,subdivisions:d});if(h.isDifferentiable()){if(t<=l+f)return h.tangentAtLength((r?1:-1)*(t-l),{precision:s,subdivisions:d});o=h}l+=f}if(o){var p=r?1:0;return o.tangentAtT(p)}return null},tangentAtT:function(t){var e=this.segments,n=e.length;if(0===n)return null;var i=t.segmentIndex;if(i<0)return e[0].tangentAtT(0);if(n<=i)return e[n-1].tangentAtT(1);var r=t.value;return r<0?r=0:1<r&&(r=1),e[i].tangentAtT(r)},toPoints:function(t){var e=this.segments,n=e.length;if(0===n)return null;for(var i=void 0===(t=t||{}).precision?this.PRECISION:t.precision,r=void 0===t.segmentSubdivisions?this.getSegmentSubdivisions({precision:i}):t.segmentSubdivisions,o=[],s=[],a=0;a<n;a++){var l=e[a];if(l.isVisible){var c=r[a];if(0<c.length){var u=c.map(function(t){return t.start});Array.prototype.push.apply(s,u)}else s.push(l.start)}else 0<s.length&&(s.push(e[a-1].end),o.push(s),s=[])}return 0<s.length&&(s.push(this.end),o.push(s)),o},toPolylines:function(t){var e=[],n=this.toPoints(t);if(!n)return null;for(var i=0,r=n.length;i<r;i++)e.push(new K(n[i]));return e},toString:function(){for(var t=this.segments,e=t.length,n="",i=0;i<e;i++)n+=t[i].serialize()+" ";return n.trim()},translate:function(t,e){for(var n=this.segments,i=n.length,r=0;r<i;r++)n[r].translate(t,e);return this},updateSubpathStartSegment:function(t){for(var e=t.previousSegment;t&&!t.isSubpathStart;)t.subpathStartSegment=e?e.subpathStartSegment:null,t=(e=t).nextSegment}},Object.defineProperty(P.prototype,"start",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(0===e)return null;for(var n=0;n<e;n++){var i=t[n];if(i.isVisible)return i.start}return t[e-1].end}}),Object.defineProperty(P.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(0===e)return null;for(var n=e-1;0<=n;n--){var i=t[n];if(i.isVisible)return i.end}return t[e-1].end}});var L=function(t,e){if(!(this instanceof L))return new L(t,e);if("string"==typeof t){var n=t.split(-1===t.indexOf("@")?" ":"@");t=parseFloat(n[0]),e=parseFloat(n[1])}else Object(t)===t&&(e=t.y,t=t.x);this.x=void 0===t?0:t,this.y=void 0===e?0:e};L.fromPolar=function(t,e,n){n=n&&new L(n)||new L(0,0);var i=b(t*C(e)),r=b(t*I(e)),o=j(F(e));return o<90?r=-r:o<180?(i=-i,r=-r):o<270&&(i=-i),new L(n.x+i,n.y+r)},L.random=function(t,e,n,i){return new L(H(t,e),H(n,i))},L.prototype={chooseClosest:function(t){var e=t.length;if(1===e)return new L(t[0]);for(var n=null,i=1/0,r=0;r<e;r++){var o=new L(t[r]),s=this.squaredDistance(o);s<i&&(n=o,i=s)}return n},adhereToRect:function(t){return t.containsPoint(this)||(this.x=T(w(this.x,t.x),t.x+t.width),this.y=T(w(this.y,t.y),t.y+t.height)),this},angleBetween:function(t,e){var n=this.equals(t)||this.equals(e)?NaN:this.theta(e)-this.theta(t);return n<0&&(n+=360),n},bearing:function(t){return new M(this,t).bearing()},changeInAngle:function(t,e,n){return this.clone().offset(-t,-e).theta(n)-this.theta(n)},clone:function(){return new L(this)},cross:function(t,e){return t&&e?(e.x-this.x)*(t.y-this.y)-(e.y-this.y)*(t.x-this.x):NaN},difference:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),new L(this.x-(t||0),this.y-(e||0))},distance:function(t){return new M(this,t).length()},dot:function(t){return t?this.x*t.x+this.y*t.y:NaN},equals:function(t){return!!t&&this.x===t.x&&this.y===t.y},lerp:function(t,e){var n=this.x,i=this.y;return new L((1-e)*n+e*t.x,(1-e)*i+e*t.y)},magnitude:function(){return E(this.x*this.x+this.y*this.y)||.01},manhattanDistance:function(t){return b(t.x-this.x)+b(t.y-this.y)},move:function(t,e){var n=V(new L(t).theta(this));return this.offset(C(n)*e,-I(n)*e)},normalize:function(t){var e=(t||1)/this.magnitude();return this.scale(e,e)},offset:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),this.x+=t||0,this.y+=e||0,this},reflection:function(t){return new L(t).move(this,this.distance(t))},rotate:function(t,e){t=t||new L(0,0),e=V(j(-e));var n=C(e),i=I(e),r=n*(this.x-t.x)-i*(this.y-t.y)+t.x,o=i*(this.x-t.x)+n*(this.y-t.y)+t.y;return this.x=r,this.y=o,this},round:function(t){var e=O(10,t||0);return this.x=_(this.x*e)/e,this.y=_(this.y*e)/e,this},scale:function(t,e,n){return n=n&&new L(n)||new L(0,0),this.x=n.x+t*(this.x-n.x),this.y=n.y+e*(this.y-n.y),this},snapToGrid:function(t,e){return this.x=G(this.x,t),this.y=G(this.y,e||t),this},squaredDistance:function(t){return new M(this,t).squaredLength()},theta:function(t){var e=-((t=new L(t)).y-this.y),n=t.x-this.x,i=x(e,n);return i<0&&(i=2*A+i),180*i/A},toJSON:function(){return{x:this.x,y:this.y}},toPolar:function(t){t=t&&new L(t)||new L(0,0);var e=this.x,n=this.y;return this.x=E((e-t.x)*(e-t.x)+(n-t.y)*(n-t.y)),this.y=V(t.theta(new L(e,n))),this},toString:function(){return this.x+"@"+this.y},update:function(t,e){return this.x=t||0,this.y=e||0,this},vectorAngle:function(t){return new L(0,0).angleBetween(this,t)}},L.prototype.translate=L.prototype.offset;var K=function(t){return this instanceof K?"string"==typeof t?new K.parse(t):void(this.points=Array.isArray(t)?t.map(L):[]):new K(t)};K.parse=function(t){if(""===(t=t.trim()))return new K;for(var e=[],n=t.split(/\s*,\s*|\s+/),i=n.length,r=0;r<i;r+=2)e.push({x:+n[r],y:+n[r+1]});return new K(e)},K.prototype={bbox:function(){var t=1/0,e=-1/0,n=1/0,i=-1/0,r=this.points,o=r.length;if(0===o)return null;for(var s=0;s<o;s++){var a=r[s],l=a.x,c=a.y;l<t&&(t=l),e<l&&(e=l),c<n&&(n=c),i<c&&(i=c)}return new B(t,n,e-t,i-n)},clone:function(){var t=this.points,e=t.length;if(0===e)return new K;for(var n=[],i=0;i<e;i++){var r=t[i].clone();n.push(r)}return new K(n)},closestPoint:function(t){var e=this.closestPointLength(t);return this.pointAtLength(e)},closestPointLength:function(t){var e,n=this.points,i=n.length;if(0===i)return 0;if(1===i)return 0;for(var r=1/0,o=0,s=i-1,a=0;a<s;a++){var l=new M(n[a],n[a+1]),c=l.length(),u=l.closestPointNormalizedLength(t),h=l.pointAt(u).squaredDistance(t);h<r&&(r=h,e=o+u*c),o+=c}return e},closestPointNormalizedLength:function(t){var e=this.closestPointLength(t);if(0===e)return 0;var n=this.length();return 0===n?0:e/n},closestPointTangent:function(t){var e=this.closestPointLength(t);return this.tangentAtLength(e)},containsPoint:function(t){var e=this.points,n=e.length;if(0===n)return!1;for(var i=t.x,r=t.y,o=n-1,s=0,a=0;s<n;s++){var l=e[o],c=e[s];if(t.equals(l))return!0;var u=new M(l,c);if(u.containsPoint(t))return!0;if(r<=l.y&&r>c.y||r>l.y&&r<=c.y){var h=l.x-i>c.x-i?l.x-i:c.x-i;if(0<=h){var d=new L(i+h,r),f=new M(t,d);u.intersect(f)&&a++}}o=s}return a%2==1},convexHull:function(){var t,e,n,i=this.points,r=i.length;if(0===r)return new K;for(t=0;t<r;t++)(void 0===n||i[t].y<n.y||i[t].y===n.y&&i[t].x>n.x)&&(n=i[t]);var o=[];for(t=0;t<r;t++){var s=n.theta(i[t]);0===s&&(s=360);var a=[i[t],t,s];o.push(a)}if(o.sort(function(t,e){var n=t[2]-e[2];return 0===n&&(n=e[1]-t[1]),n}),2<o.length){var l=o[o.length-1];o.unshift(l)}for(var c,u,h,d,f,p,g,m={},v=[];0!==o.length;)if(u=(c=o.pop())[0],!m.hasOwnProperty(c[0]+"@@"+c[1]))for(var y=!1;!y;)if(v.length<2)v.push(c),y=!0;else{d=(h=v.pop())[0];var C=(p=(f=v.pop())[0]).cross(d,u);if(C<0)v.push(f),v.push(h),v.push(c),y=!0;else if(0===C){var I=d.angleBetween(p,u);b(I-180)<1e-10||d.equals(u)||p.equals(d)?(m[h[0]+"@@"+h[1]]=d,v.push(f)):b((I+1)%360-1)<1e-10&&(v.push(f),o.push(h))}else m[h[0]+"@@"+h[1]]=d,v.push(f)}2<v.length&&v.pop();var E=-1;for(e=v.length,t=0;t<e;t++){var T=v[t][1];(void 0===g||T<g)&&(g=T,E=t)}var w=[];if(0<E){var x=v.slice(E),_=v.slice(0,E);w=x.concat(_)}else w=v;var D=[];for(e=w.length,t=0;t<e;t++)D.push(w[t][0]);return new K(D)},equals:function(t){if(!t)return!1;var e=this.points,n=t.points,i=e.length;if(n.length!==i)return!1;for(var r=0;r<i;r++){var o=e[r],s=t.points[r];if(!o.equals(s))return!1}return!0},intersectionWithLine:function(t){for(var e=new M(t),n=[],i=this.points,r=0,o=i.length-1;r<o;r++){var s=i[r],a=i[r+1],l=new M(s,a),c=e.intersectionWithLine(l);c&&n.push(c[0])}return 0<n.length?n:null},isDifferentiable:function(){var t=this.points,e=t.length;if(0===e)return!1;for(var n=e-1,i=0;i<n;i++){var r=t[i],o=t[i+1];if(new M(r,o).isDifferentiable())return!0}return!1},length:function(){var t=this.points,e=t.length;if(0===e)return 0;for(var n=0,i=e-1,r=0;r<i;r++)n+=t[r].distance(t[r+1]);return n},pointAt:function(t){var e=this.points,n=e.length;if(0===n)return null;if(1===n)return e[0].clone();if(t<=0)return e[0].clone();if(1<=t)return e[n-1].clone();var i=this.length()*t;return this.pointAtLength(i)},pointAtLength:function(t){var e=this.points,n=e.length;if(0===n)return null;if(1===n)return e[0].clone();var i=!0;t<0&&(i=!1,t=-t);for(var r=0,o=n-1,s=0;s<o;s++){var a=i?s:o-1-s,l=e[a],c=e[a+1],u=new M(l,c),h=l.distance(c);if(t<=r+h)return u.pointAtLength((i?1:-1)*(t-r));r+=h}return(i?e[n-1]:e[0]).clone()},scale:function(t,e,n){var i=this.points,r=i.length;if(0===r)return this;for(var o=0;o<r;o++)i[o].scale(t,e,n);return this},simplify:function(t){void 0===t&&(t={});var e=this.points;if(e.length<3)return this;for(var n=t.threshold||0,i=0;e[i+2];){var r=i+1,o=i+2,s=e[i],a=e[r],l=e[o];new M(s,l).closestPoint(a).distance(a)<=n?e.splice(r,1):i+=1}return this},tangentAt:function(t){var e=this.points.length;if(0===e)return null;if(1===e)return null;t<0&&(t=0),1<t&&(t=1);var n=this.length()*t;return this.tangentAtLength(n)},tangentAtLength:function(t){var e=this.points,n=e.length;if(0===n)return null;if(1===n)return null;var i,r=!0;t<0&&(r=!1,t=-t);for(var o=0,s=n-1,a=0;a<s;a++){var l=r?a:s-1-a,c=e[l],u=e[l+1],h=new M(c,u),d=c.distance(u);if(h.isDifferentiable()){if(t<=o+d)return h.tangentAtLength((r?1:-1)*(t-o));i=h}o+=d}if(i){var f=r?1:0;return i.tangentAt(f)}return null},toString:function(){return this.points+""},translate:function(t,e){var n=this.points,i=n.length;if(0===i)return this;for(var r=0;r<i;r++)n[r].translate(t,e);return this},serialize:function(){var t=this.points,e=t.length;if(0===e)return"";for(var n="",i=0;i<e;i++){var r=t[i];n+=r.x+","+r.y+" "}return n.trim()}},Object.defineProperty(K.prototype,"start",{configurable:!0,enumerable:!0,get:function(){return 0===this.points.length?null:this.points[0]}}),Object.defineProperty(K.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.points.length;return 0===t?null:this.points[t-1]}});var B=function(t,e,n,i){if(!(this instanceof B))return new B(t,e,n,i);Object(t)===t&&(e=t.y,n=t.width,i=t.height,t=t.x),this.x=void 0===t?0:t,this.y=void 0===e?0:e,this.width=void 0===n?0:n,this.height=void 0===i?0:i};B.fromEllipse=function(t){return t=new N(t),new B(t.x-t.a,t.y-t.b,2*t.a,2*t.b)},B.prototype={bbox:function(t){if(!t)return this.clone();var e=V(t),n=b(I(e)),i=b(C(e)),r=this.width*i+this.height*n,o=this.width*n+this.height*i;return new B(this.x+(this.width-r)/2,this.y+(this.height-o)/2,r,o)},bottomLeft:function(){return new L(this.x,this.y+this.height)},bottomLine:function(){return new M(this.bottomLeft(),this.bottomRight())},bottomMiddle:function(){return new L(this.x+this.width/2,this.y+this.height)},center:function(){return new L(this.x+this.width/2,this.y+this.height/2)},clone:function(){return new B(this)},containsPoint:function(t){return(t=new L(t)).x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height},containsRect:function(t){var e=new B(this).normalize(),n=new B(t).normalize(),i=e.width,r=e.height,o=n.width,s=n.height;if(!(i&&r&&o&&s))return!1;var a=e.x,l=e.y,c=n.x,u=n.y;return o+=c,i+=a,s+=u,r+=l,a<=c&&o<=i&&l<=u&&s<=r},corner:function(){return new L(this.x+this.width,this.y+this.height)},equals:function(t){var e=new B(this).normalize(),n=new B(t).normalize();return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height},inflate:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},intersect:function(t){var e=this.origin(),n=this.corner(),i=t.origin(),r=t.corner();if(r.x<=e.x||r.y<=e.y||i.x>=n.x||i.y>=n.y)return null;var o=w(e.x,i.x),s=w(e.y,i.y);return new B(o,s,T(n.x,r.x)-o,T(n.y,r.y)-s)},intersectionWithLine:function(t){var e,n,i=[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()],r=[],o=[],s=i.length;for(n=0;n<s;n++)null!==(e=t.intersect(i[n]))&&o.indexOf(e.toString())<0&&(r.push(e),o.push(e.toString()));return 0<r.length?r:null},intersectionWithLineFromCenterToPoint:function(t,e){t=new L(t);var n,i=new L(this.x+this.width/2,this.y+this.height/2);e&&t.rotate(i,e);for(var r=[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()],o=new M(i,t),s=r.length-1;0<=s;--s){var a=r[s].intersection(o);if(null!==a){n=a;break}}return n&&e&&n.rotate(i,-e),n},leftLine:function(){return new M(this.topLeft(),this.bottomLeft())},leftMiddle:function(){return new L(this.x,this.y+this.height/2)},maxRectScaleToFit:function(t,e){var n,i,r,o,s,a,l,c;t=new B(t);var u=(e=e||t.center()).x,h=e.y;n=i=r=o=s=a=l=c=1/0;var d=t.topLeft();d.x<u&&(n=(this.x-u)/(d.x-u)),d.y<h&&(s=(this.y-h)/(d.y-h));var f=t.bottomRight();f.x>u&&(i=(this.x+this.width-u)/(f.x-u)),f.y>h&&(a=(this.y+this.height-h)/(f.y-h));var p=t.topRight();p.x>u&&(r=(this.x+this.width-u)/(p.x-u)),p.y<h&&(l=(this.y-h)/(p.y-h));var g=t.bottomLeft();return g.x<u&&(o=(this.x-u)/(g.x-u)),g.y>h&&(c=(this.y+this.height-h)/(g.y-h)),{sx:T(n,i,r,o),sy:T(s,a,l,c)}},maxRectUniformScaleToFit:function(t,e){var n=this.maxRectScaleToFit(t,e);return T(n.sx,n.sy)},moveAndExpand:function(t){return this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this},normalize:function(){var t=this.x,e=this.y,n=this.width,i=this.height;return this.width<0&&(t=this.x+this.width,n=-this.width),this.height<0&&(e=this.y+this.height,i=-this.height),this.x=t,this.y=e,this.width=n,this.height=i,this},offset:function(t,e){return L.prototype.offset.call(this,t,e)},origin:function(){return new L(this.x,this.y)},pointNearestToPoint:function(t){if(t=new L(t),this.containsPoint(t))switch(this.sideNearestToPoint(t)){case"right":return new L(this.x+this.width,t.y);case"left":return new L(this.x,t.y);case"bottom":return new L(t.x,this.y+this.height);case"top":return new L(t.x,this.y)}return t.adhereToRect(this)},rightLine:function(){return new M(this.topRight(),this.bottomRight())},rightMiddle:function(){return new L(this.x+this.width,this.y+this.height/2)},round:function(t){var e=O(10,t||0);return this.x=_(this.x*e)/e,this.y=_(this.y*e)/e,this.width=_(this.width*e)/e,this.height=_(this.height*e)/e,this},scale:function(t,e,n){return n=this.origin().scale(t,e,n),this.x=n.x,this.y=n.y,this.width*=t,this.height*=e,this},sideNearestToPoint:function(t){var e=(t=new L(t)).x-this.x,n=this.x+this.width-t.x,i=t.y-this.y,r=e,o="left";return n<r&&(r=n,o="right"),i<r&&(r=i,o="top"),this.y+this.height-t.y<r&&(o="bottom"),o},snapToGrid:function(t,e){var n=this.origin().snapToGrid(t,e),i=this.corner().snapToGrid(t,e);return this.x=n.x,this.y=n.y,this.width=i.x-n.x,this.height=i.y-n.y,this},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},topLine:function(){return new M(this.topLeft(),this.topRight())},topMiddle:function(){return new L(this.x+this.width/2,this.y)},topRight:function(){return new L(this.x+this.width,this.y)},toString:function(){return this.origin().toString()+" "+this.corner().toString()},union:function(t){var e=new B(t),n=this.x,i=this.y,r=this.width,o=this.height,s=e.x,a=e.y,l=e.width,c=e.height,u=e.x=T(n,s),h=e.y=T(i,a);return e.width=w(n+r,s+l)-u,e.height=w(i+o,a+c)-h,e}},B.prototype.bottomRight=B.prototype.corner,B.prototype.topLeft=B.prototype.origin,B.prototype.translate=B.prototype.offset;var z={linear:function(t,e,n){var i=t[1]-t[0],r=e[1]-e[0];return(n-t[0])/i*r+e[0]||0}},j=function(t){return t%360+(t<0?360:0)},G=function(t,e){return e*_(t/e)},F=function(t){return 180*t/A%360},V=function(t,e){return(t=(e=e||!1)?t:t%360)*A/180},H=function(t,e){if(void 0===e)e=void 0===t?1:t,t=0;else if(e<t){var n=t;t=e,e=n}return D(y.random()*(e-t+1)+t)},U=N,Z=M,W=L,Y=B;function X(t,e){return e.unshift(null),new(Function.prototype.bind.apply(t,e))}function q(t){var e,n,i=arguments,r=[];for(n=arguments.length,e=1;e<n;e++)r.push(i[e]);if(!t)throw new Error("Missing a parent object.");var o=Object.create(t);for(n=r.length,e=0;e<n;e++){var s,a,l=r[e];for(a in l)l.hasOwnProperty(a)&&(delete o[a],s=Object.getOwnPropertyDescriptor(l,a),Object.defineProperty(o,a,s))}return o}var J={bbox:function(){throw new Error("Declaration missing for virtual function.")},clone:function(){throw new Error("Declaration missing for virtual function.")},closestPoint:function(){throw new Error("Declaration missing for virtual function.")},closestPointLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointNormalizedLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointT:function(t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither closestPointT() nor closestPointNormalizedLength() function is implemented.")},closestPointTangent:function(){throw new Error("Declaration missing for virtual function.")},divideAt:function(){throw new Error("Declaration missing for virtual function.")},divideAtLength:function(){throw new Error("Declaration missing for virtual function.")},divideAtT:function(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither divideAtT() nor divideAt() function is implemented.")},equals:function(){throw new Error("Declaration missing for virtual function.")},getSubdivisions:function(){throw new Error("Declaration missing for virtual function.")},isDifferentiable:function(){throw new Error("Declaration missing for virtual function.")},isSegment:!0,isSubpathStart:!1,isVisible:!0,length:function(){throw new Error("Declaration missing for virtual function.")},lengthAtT:function(t){if(t<=0)return 0;var e=this.length();return 1<=t?e:e*t},nextSegment:null,pointAt:function(){throw new Error("Declaration missing for virtual function.")},pointAtLength:function(){throw new Error("Declaration missing for virtual function.")},pointAtT:function(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither pointAtT() nor pointAt() function is implemented.")},previousSegment:null,subpathStartSegment:null,scale:function(){throw new Error("Declaration missing for virtual function.")},serialize:function(){throw new Error("Declaration missing for virtual function.")},tangentAt:function(){throw new Error("Declaration missing for virtual function.")},tangentAtLength:function(){throw new Error("Declaration missing for virtual function.")},tangentAtT:function(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither tangentAtT() nor tangentAt() function is implemented.")},toString:function(){throw new Error("Declaration missing for virtual function.")},translate:function(){throw new Error("Declaration missing for virtual function.")}};Object.defineProperty(J,"end",{configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(J,"start",{configurable:!0,enumerable:!0,get:function(){if(!this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path; OR segment has not yet been added to a path.)");return this.previousSegment.end}}),Object.defineProperty(J,"type",{configurable:!0,enumerable:!0,get:function(){throw new Error("Bad segment declaration. No type specified.")}});var Q=function(){for(var t,e,n=arguments,i=[],r=arguments.length,o=0;o<r;o++)i.push(n[o]);if(!(this instanceof Q))return X(Q,i);if(0===r)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates (none provided).");if(i[0]instanceof M){if(1===r)return this.end=i[0].end.clone(),this;throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+r+" lines provided).")}if("string"==typeof i[0]||"number"==typeof i[0]){if(2===r)return this.end=new L(+i[0],+i[1]),this;if(r<2)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+r+" coordinates provided).");var s;for(t=[],o=0;o<r;o+=2)s=i.slice(o,o+2),t.push(X(Q,s));return t}if(1===r)return this.end=new L(i[0]),this;for(t=[],o=0;o<r;o+=1)e=i[o],t.push(new Q(e));return t},tt={clone:function(){return new Q(this.end)},divideAt:function(t){var e=new M(this.start,this.end).divideAt(t);return[new Q(e[0]),new Q(e[1])]},divideAtLength:function(t){var e=new M(this.start,this.end).divideAtLength(t);return[new Q(e[0]),new Q(e[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return!!this.previousSegment&&!this.start.equals(this.end)},scale:function(t,e,n){return this.end.scale(t,e,n),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}};Object.defineProperty(tt,"type",{configurable:!0,enumerable:!0,value:"L"}),Q.prototype=q(J,M.prototype,tt);var et=function(){for(var t,e,n=arguments,i=[],r=arguments.length,o=0;o<r;o++)i.push(n[o]);if(!(this instanceof et))return X(et,i);if(0===r)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates (none provided).");if(i[0]instanceof R){if(1===r)return this.controlPoint1=i[0].controlPoint1.clone(),this.controlPoint2=i[0].controlPoint2.clone(),this.end=i[0].end.clone(),this;throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+r+" curves provided).")}if("string"==typeof i[0]||"number"==typeof i[0]){if(6===r)return this.controlPoint1=new L(+i[0],+i[1]),this.controlPoint2=new L(+i[2],+i[3]),this.end=new L(+i[4],+i[5]),this;if(r<6)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+r+" coordinates provided).");var s;for(t=[],o=0;o<r;o+=6)s=i.slice(o,o+6),t.push(X(et,s));return t}if(3===r)return this.controlPoint1=new L(i[0]),this.controlPoint2=new L(i[1]),this.end=new L(i[2]),this;if(r<3)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+r+" points provided).");for(t=[],o=0;o<r;o+=3)e=i.slice(o,o+3),t.push(X(et,e));return t},nt={clone:function(){return new et(this.controlPoint1,this.controlPoint2,this.end)},divideAt:function(t,e){var n=new R(this.start,this.controlPoint1,this.controlPoint2,this.end).divideAt(t,e);return[new et(n[0]),new et(n[1])]},divideAtLength:function(t,e){var n=new R(this.start,this.controlPoint1,this.controlPoint2,this.end).divideAtLength(t,e);return[new et(n[0]),new et(n[1])]},divideAtT:function(t){var e=new R(this.start,this.controlPoint1,this.controlPoint2,this.end).divideAtT(t);return[new et(e[0]),new et(e[1])]},isDifferentiable:function(){if(!this.previousSegment)return!1;var t=this.start,e=this.controlPoint1,n=this.controlPoint2,i=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(i))},scale:function(t,e,n){return this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this},serialize:function(){var t=this.controlPoint1,e=this.controlPoint2,n=this.end;return this.type+" "+t.x+" "+t.y+" "+e.x+" "+e.y+" "+n.x+" "+n.y},toString:function(){return this.type+" "+this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}};Object.defineProperty(nt,"type",{configurable:!0,enumerable:!0,value:"C"}),et.prototype=q(J,R.prototype,nt);var it=function(){for(var t,e,n=arguments,i=[],r=arguments.length,o=0;o<r;o++)i.push(n[o]);if(!(this instanceof it))return X(it,i);if(0===r)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates (none provided).");if(i[0]instanceof M){if(1===r)return this.end=i[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+r+" lines provided).")}if(i[0]instanceof R){if(1===r)return this.end=i[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+r+" curves provided).")}if("string"==typeof i[0]||"number"==typeof i[0]){if(2===r)return this.end=new L(+i[0],+i[1]),this;if(r<2)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+r+" coordinates provided).");var s;for(t=[],o=0;o<r;o+=2)s=i.slice(o,o+2),0===o?t.push(X(it,s)):t.push(X(Q,s));return t}if(1===r)return this.end=new L(i[0]),this;for(t=[],o=0;o<r;o+=1)e=i[o],0===o?t.push(new it(e)):t.push(new Q(e));return t},rt={bbox:function(){return null},clone:function(){return new it(this.end)},closestPoint:function(){return this.end.clone()},closestPointNormalizedLength:function(){return 0},closestPointLength:function(){return 0},closestPointT:function(){return 1},closestPointTangent:function(){return null},divideAt:function(){return[this.clone(),this.clone()]},divideAtLength:function(){return[this.clone(),this.clone()]},equals:function(t){return this.end.equals(t.end)},getSubdivisions:function(){return[]},isDifferentiable:function(){return!1},isSubpathStart:!0,isVisible:!1,length:function(){return 0},lengthAtT:function(){return 0},pointAt:function(){return this.end.clone()},pointAtLength:function(){return this.end.clone()},pointAtT:function(){return this.end.clone()},scale:function(t,e,n){return this.end.scale(t,e,n),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},tangentAt:function(){return null},tangentAtLength:function(){return null},tangentAtT:function(){return null},toString:function(){return this.type+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}};Object.defineProperty(rt,"start",{configurable:!0,enumerable:!0,get:function(){throw new Error("Illegal access. Moveto segments should not need a start property.")}}),Object.defineProperty(rt,"type",{configurable:!0,enumerable:!0,value:"M"}),it.prototype=q(J,rt);var ot=function(){for(var t=arguments,e=[],n=arguments.length,i=0;i<n;i++)e.push(t[i]);if(!(this instanceof ot))return X(ot,e);if(0<n)throw new Error("Closepath constructor expects no arguments.");return this},st={clone:function(){return new ot},divideAt:function(t){var e=new M(this.start,this.end).divideAt(t);return[e[1].isDifferentiable()?new Q(e[0]):this.clone(),new Q(e[1])]},divideAtLength:function(t){var e=new M(this.start,this.end).divideAtLength(t);return[e[1].isDifferentiable()?new Q(e[0]):this.clone(),new Q(e[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return!(!this.previousSegment||!this.subpathStartSegment||this.start.equals(this.end))},scale:function(){return this},serialize:function(){return this.type},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(){return this}};Object.defineProperty(st,"end",{configurable:!0,enumerable:!0,get:function(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. Moveto); OR segment has not yet been added to a path.)");return this.subpathStartSegment.end}}),Object.defineProperty(st,"type",{configurable:!0,enumerable:!0,value:"Z"}),ot.prototype=q(J,M.prototype,st);var at=P.segmentTypes={L:Q,C:et,M:it,Z:ot,z:ot};function lt(t){return t?t.toString().split(" ").map(function(t){return t.substr(0,Pt.classNamePrefix.length)!==Pt.classNamePrefix&&(t=Pt.classNamePrefix+t),t}).join(" "):t}function ct(t){return t?t.toString().split(" ").map(function(t){return t.substr(0,Pt.classNamePrefix.length)===Pt.classNamePrefix&&(t=t.substr(Pt.classNamePrefix.length)),t}).join(" "):t}function ut(t,e){for(var n={},r={},o=Mt.namespace.svg,s=e||o,a=document.createDocumentFragment(),l=[t,a,s];0<l.length;){s=l.pop();for(var c=l.pop(),u=l.pop(),h=0,d=u.length;h<d;h++){var f=u[h];if(!f.hasOwnProperty("tagName"))throw new Error("json-dom-parser: missing tagName");var p=f.tagName;f.hasOwnProperty("namespaceURI")&&(s=f.namespaceURI);var g=document.createElementNS(s,p),m=s===o,v=m?Mt:i,y=f.attributes;y&&v(g).attr(y);var b=f.style;if(b&&i(g).css(b),f.hasOwnProperty("className")){var C=f.className;m?g.className.baseVal=C:g.className=C}if(f.hasOwnProperty("textContent")&&(g.textContent=f.textContent),f.hasOwnProperty("selector")){var I=f.selector;if(n[I])throw new Error("json-dom-parser: selector must be unique");v(n[I]=g).attr("joint-selector",I)}if(f.hasOwnProperty("groupSelector")){var E=f.groupSelector;Array.isArray(E)||(E=[E]);for(var T=0,w=E.length;T<w;T++){var x=E[T],_=r[x];(_=_||(r[x]=[])).push(g)}}c.appendChild(g);var D=f.children;Array.isArray(D)&&l.push(D,g,s)}}return{fragment:a,selectors:n,groupSelectors:r}}function ht(t){var e=0;if(0===t.length)return e;for(var n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e&=e;return e}function dt(t,e,n){for(var i,r=Array.isArray(e)?e:e.split(n||"/"),o=0,s=r.length;o<s;){if(i=r[o++],Object(t)!==t||!(i in t))return;t=t[i]}return t}function ft(t,e,n,i){for(var r=Array.isArray(e)?e:e.split(i||"/"),o=t,s=0,a=r.length;s<a-1;s++)o=o[r[s]]||(o[r[s]]={});return o[r[a-1]]=n,t}function pt(t,e,n){n=n||"/";var i=Array.isArray(e)?e.slice():e.split(n),r=i.pop();if(0<i.length){var o=dt(t,i,n);o&&delete o[r]}else delete t[r];return t}function gt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}function mt(t){return t.replace(/[A-Z]/g,"-$&").toLowerCase()}function vt(t){var e=t,n=t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0];if(n){for(var i in t)void 0===n[i]&&(n[i]=t[i]);e=n}var r=e.target;if(r){var o=r.correspondingUseElement;o&&(e.target=o)}return e}function yt(t,e){var n=parseFloat(t);if(Number.isNaN(n))return null;var i,r={};if(r.value=n,null==e)i="[A-Za-z]*";else if(Array.isArray(e)){if(0===e.length)return null;i=e.join("|")}else Ae(e)&&(i=e);var o,s=(o=new RegExp("(?:\\d+(?:\\.\\d+)*)("+i+")$").exec(t))?o[1]:null;return null===s?null:(r.unit=s,r)}function bt(t,e,n,i){i=i||{},n=n||{};var r=e.width,o=e.height,s=i.svgDocument||Mt("svg").node,a=Mt("tspan").node,l=Mt("text").attr(n).append(a).node,c=document.createTextNode("");l.style.opacity=0,l.style.display="block",a.style.display="block",a.appendChild(c),s.appendChild(l),i.svgDocument||document.body.appendChild(s);for(var u,h,d,f=i.separator||" ",p=i.eol||"\n",g=i.hyphen?new RegExp(i.hyphen):/[^\w\d]/,m=t.split(f),v=[],y=[],b=0,C=0,I=m.length;b<I;b++){var E=m[b];if(E)if(p&&0<=E.indexOf(p))if(1<E.length){for(var T=E.split(p),w=0,x=T.length-1;w<x;w++)T.splice(2*w+1,0,p);Array.prototype.splice.apply(m,[b,1].concat(T)),b--,I+=T.length-1}else C++;else{if(c.data=y[C]?y[C]+" "+E:E,a.getComputedTextLength()<=r)y[C]=c.data,(u||h)&&(v[C++]=!0,h=u=0);else{if(!y[C]||u){var _=!!u;if(u=E.length-1,_||!u){if(!u){if(!y[C]){y=[];break}m.splice(b,2,E+m[b+1]),I--,v[C++]=!0,b--;continue}m[b]=E.substring(0,u),m[b+1]=E.substring(u)+m[b+1]}else{if(h)m.splice(b,2,m[b]+m[b+1]),h=0;else{var D=E.search(g);-1<D&&D!==E.length-1&&0!==D&&(h=D+1,u=0),m.splice(b,1,E.substring(0,h||u),E.substring(h||u)),I++}C&&!v[C-1]&&C--}b--;continue}C++,b--}var A;if(void 0!==o)if(void 0===d&&(d=(A="auto"===n.lineHeight?{value:1.5,unit:"em"}:yt(n.lineHeight,["em"])||{value:1,unit:"em"}).value,"em"===A.unit&&(d*=l.getBBox().height)),d*y.length>o){var O=Math.floor(o/d)-1;y.splice(1+O);var S=i.ellipsis;if(!S||O<0)break;"string"!=typeof S&&(S="\u2026");var R,k,N=y[O],M=N.length;do{if(k=N[M],R=N.substring(0,M),k?k.match(f)&&(R+=k):R+="string"==typeof f?f:" ",R+=S,c.data=R,a.getComputedTextLength()<=r){y[O]=R;break}M--}while(0<=M);break}}}return i.svgDocument?s.removeChild(l):document.body.removeChild(s),y.join(p)}function Ct(t){var e=i(i.parseHTML("<div>"+t+"</div>",null,!1));return e.find("*").each(function(){var t=this;i.each(t.attributes,function(){var e=this.name,n=this.value;0!==e.indexOf("on")&&0!==n.indexOf("javascript:")||i(t).removeAttr(e)})}),e.html()}function It(t,e){if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(t,e);else{var n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n)}}function Et(t,e){It(Gt(t),e)}function Tt(t,e){if(!t||"data:"===t.substr(0,5))return setTimeout(function(){e(null,t)},0);var n=new XMLHttpRequest;n.open("GET",t,!0),n.addEventListener("error",function(){e(new Error("Failed to load image "+t))}),n.responseType=window.FileReader?"blob":"arraybuffer",n.addEventListener("load",function(){window.FileReader?function(e,n){if(200===e.status){var i=new FileReader;i.onload=function(t){var e=t.target.result;n(null,e)},i.onerror=function(){n(new Error("Failed to load image "+t))},i.readAsDataURL(e.response)}else n(new Error("Failed to load image "+t))}(n,e):function(e,n){if(200===e.status){var i=new Uint8Array(e.response),r=t.split(".").pop()||"png";n(null,"data:image/"+({svg:"svg+xml"}[r]||r)+";base64,"+btoa(function(t){for(var e=[],n=0;n<t.length;n+=32768)e.push(String.fromCharCode.apply(null,t.subarray(n,n+32768)));return e.join("")}(i)))}else n(new Error("Failed to load image "+t))}(n,e)}),n.send()}function wt(t){var e=i(t);if(0===e.length)throw new Error("Element not found");var n=e[0],r=n.ownerDocument,o=n.getBoundingClientRect(),s=0,a=0;if(n.ownerSVGElement){var l=Mt(n),c=l.getBBox({target:l.svg()});s=o.width-c.width,a=o.height-c.height}return{x:o.left+window.pageXOffset-r.documentElement.offsetLeft+s/2,y:o.top+window.pageYOffset-r.documentElement.offsetTop+a/2,width:o.width-s,height:o.height-a}}function xt(t,e){var n=i(t),r=n.map(function(){var t=this.parentNode,e=t.insertBefore(document.createTextNode(""),this.nextSibling);return function(){if(t===this)throw new Error("You can't sort elements if any one is a descendant of another.");t.insertBefore(this,e),t.removeChild(e)}});return Array.prototype.sort.call(n,e).each(function(t){r[t].call(this)})}function _t(t,e){var n=i(t);we(e,function(t,e){var i=n.find(e).addBack().filter(e);be(t,"class")&&(i.addClass(t.class),t=Ie(t,"class")),i.attr(t)})}function Dt(t){var e=window.top.document;function n(t,e){for(var n=["webkit","moz","ms","o",""],i=0;i<n.length;i++){var r=n[i],o=r?r+e:e.substr(0,1).toLowerCase()+e.substr(1);if(void 0!==t[o])return le(t[o])?t[o]():t[o]}}t=t||e.body,n(e,"FullscreenElement")||n(e,"FullScreenElement")?n(e,"ExitFullscreen")||n(e,"CancelFullScreen"):n(t,"RequestFullscreen")||n(t,"RequestFullScreen")}function At(){if(n.mergeWith){var t=Array.from(arguments),e=t[t.length-1],i=le(e)?e:Oe;return t.push(function(t,e){var n=i(t,e);return void 0!==n?n:Array.isArray(t)&&!Array.isArray(e)?e:void 0}),n.mergeWith.apply(this,t)}return n.merge.apply(this,arguments)}function Ot(t){var e=Object.prototype.toString;return!0===t||!1===t||!!t&&"object"==typeof t&&"[object Boolean]"===e.call(t)}function St(t){var e=Object.prototype.toString;return"number"==typeof t||!!t&&"object"==typeof t&&"[object Number]"===e.call(t)}P.regexSupportedData=new RegExp("^[\\s\\d"+Object.keys(at).join("")+",.]*$"),P.isDataSupported=function(t){return"string"==typeof t&&this.regexSupportedData.test(t)};var Rt,kt,Nt={bezier:S,Curve:R,Ellipse:N,Line:M,Path:P,Point:L,Polyline:K,Rect:B,scale:z,normalizeAngle:j,snapToGrid:G,toDeg:F,toRad:V,random:H,ellipse:U,line:Z,point:W,rect:Y},Mt=function(){if("object"!=typeof window||!window.SVGAngle&&!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"))return function(){throw new Error("SVG is required to use Vectorizer.")};var t={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},e=Math,n=e.PI,i=e.atan2,r=e.sqrt,o=e.min,s=e.max,a=e.cos,l=e.sin,c=function(e,n,i){if(!(this instanceof c))return c.apply(Object.create(c.prototype),arguments);if(e){if(c.isV(e)&&(e=e.node),n=n||{},c.isString(e)){if("svg"===e.toLowerCase())e=c.createSvgDocument();else if("<"===e[0]){var r=c.createSvgDocument(e);if(1<r.childNodes.length){var o,s,a=[];for(o=0,s=r.childNodes.length;o<s;o++){var l=r.childNodes[o];a.push(new c(document.importNode(l,!0)))}return a}e=document.importNode(r.firstChild,!0)}else e=document.createElementNS(t.svg,e);c.ensureId(e)}return this.node=e,this.setAttributes(n),i&&this.append(i),this}},u=c.prototype;function h(t,e,n){for(var i=(n=n||{}).includeAnnotationIndices,r=n.eol,o=n.lineHeight,s=n.baseSize,a=0,l={},u=e.length-1,h=0;h<=u;h++){var d=e[h],f=null;if(c.isObject(d)){var p=d.attrs,g=c("tspan",p),m=g.node,v=d.t;r&&h===u&&(v+=r),m.textContent=v;var y=p.class;y&&g.addClass(y),i&&g.attr("annotations",d.annotations),void 0===(f=parseFloat(p["font-size"]))&&(f=s),f&&a<f&&(a=f)}else r&&h===u&&(d+=r),m=document.createTextNode(d||" "),s&&a<s&&(a=s);t.appendChild(m)}return a&&(l.maxFontSize=a),o?l.lineHeight=o:a&&(l.lineHeight=1.2*a),l}Object.defineProperty(u,"id",{enumerable:!0,get:function(){return this.node.id},set:function(t){this.node.id=t}}),u.getTransformToElement=function(t){var e=this.node;if(c.isSVGGraphicsElement(t)&&c.isSVGGraphicsElement(e)){var n=c.toNode(t).getScreenCTM(),i=e.getScreenCTM();if(n&&i)return n.inverse().multiply(i)}return c.createSVGMatrix()},u.transform=function(t,e){var n=this.node;if(c.isUndefined(t))return c.transformStringToMatrix(this.attr("transform"));if(e&&e.absolute)return this.attr("transform",c.matrixToTransformString(t));var i=c.createSVGTransform(t);return n.transform.baseVal.appendItem(i),this},u.translate=function(t,e,n){n=n||{},e=e||0;var i=this.attr("transform")||"",r=c.parseTransformString(i);if(i=r.value,c.isUndefined(t))return r.translate;i=i.replace(/translate\([^)]*\)/g,"").trim();var o="translate("+(n.absolute?t:r.translate.tx+t)+","+(n.absolute?e:r.translate.ty+e)+")";return this.attr("transform",(o+" "+i).trim()),this},u.rotate=function(t,e,n,i){i=i||{};var r=this.attr("transform")||"",o=c.parseTransformString(r);if(r=o.value,c.isUndefined(t))return o.rotate;r=r.replace(/rotate\([^)]*\)/g,"").trim(),t%=360;var s="rotate("+(i.absolute?t:o.rotate.angle+t)+(void 0!==e&&void 0!==n?","+e+","+n:"")+")";return this.attr("transform",(r+" "+s).trim()),this},u.scale=function(t,e){e=c.isUndefined(e)?t:e;var n=this.attr("transform")||"",i=c.parseTransformString(n);if(n=i.value,c.isUndefined(t))return i.scale;n=n.replace(/scale\([^)]*\)/g,"").trim();var r="scale("+t+","+e+")";return this.attr("transform",(n+" "+r).trim()),this},u.bbox=function(t,e){var n,i=this.node,r=i.ownerSVGElement;if(!r)return new B(0,0,0,0);try{n=i.getBBox()}catch(t){n={x:i.clientLeft,y:i.clientTop,width:i.clientWidth,height:i.clientHeight}}if(t)return new B(n);var o=this.getTransformToElement(e||r);return c.transformRect(n,o)},u.getBBox=function(t){var e,n={},i=this.node;if(!i.ownerSVGElement||!c.isSVGGraphicsElement(i))return new B(0,0,0,0);if(t&&(t.target&&(n.target=c.toNode(t.target)),t.recursive&&(n.recursive=t.recursive)),n.recursive){var r=this.children(),o=r.length;if(0===o)return this.getBBox({target:n.target,recursive:!1});n.target||(n.target=this);for(var s=0;s<o;s++){var a,l=r[s];a=0===l.children().length?l.getBBox({target:n.target,recursive:!1}):l.getBBox({target:n.target,recursive:!0}),e=e?e.union(a):a}return e}try{e=i.getBBox()}catch(t){e={x:i.clientLeft,y:i.clientTop,width:i.clientWidth,height:i.clientHeight}}if(n.target){var u=this.getTransformToElement(n.target);return c.transformRect(e,u)}return new B(e)};var d=/em$/;function f(t,e){var n=parseFloat(t);return d.test(t)?n*e:n}u.text=function(e,n){if(e&&"string"!=typeof e)throw new Error("Vectorizer: text() expects the first argument to be a string.");e=c.sanitizeText(e);var i=(n=n||{}).displayEmpty,r=n.eol,o=n.textPath,s=n.textVerticalAnchor,a="middle"===s||"bottom"===s||"top"===s,l=n.x;void 0===l&&(l=this.attr("x")||0);var u=n.includeAnnotationIndices,p=n.annotations;p&&!c.isArray(p)&&(p=[p]);var g=n.lineHeight,m="auto"===g,v=m?"1.5em":g||"1em";this.empty(),this.attr({"xml:space":"preserve",display:e||i?null:"none"});var y=parseFloat(this.attr("font-size"));y||(y=16,(a||p)&&this.attr("font-size",y));var b,C=document;b=o?("string"==typeof o&&(o={d:o}),function(t,e){t=t||{};var n=c("textPath"),i=t.d;if(i&&void 0===t["xlink:href"]){var r=c("path").attr("d",i).appendTo(e.defs());n.attr("xlink:href","#"+r.id)}return c.isObject(t)&&n.attr(t),n.node}(o,this)):C.createDocumentFragment();for(var I,E=0,T=e.split("\n"),w=[],x=0,_=T.length-1;x<=_;x++){var D,A=v,O="v-line",S=C.createElementNS(t.svg,"tspan"),R=T[x];if(R)if(p){var k=(D=h(S,c.annotateString(R,p,{offset:-E,includeAnnotationIndices:u}),{includeAnnotationIndices:u,eol:x!==_&&r,lineHeight:m?null:v,baseSize:y})).lineHeight;k&&m&&0!==x&&(A=k),0===x&&(I=.8*D.maxFontSize)}else r&&x!==_&&(R+=r),S.textContent=R;else{S.textContent="-",O+=" v-empty-line";var N=S.style;N.fillOpacity=0,N.strokeOpacity=0,p&&(D={})}D&&w.push(D),0<x&&S.setAttribute("dy",A),(0<x||o)&&S.setAttribute("x",l),S.className.baseVal=O,b.appendChild(S),E+=R.length+1}if(a)if(p)A=function(t,e,n,i){if(!Array.isArray(e))return 0;var r=e.length;if(!r)return 0;for(var o=e[0],s=f(o.maxFontSize,n)||n,a=0,l=f(i,n),c=1;c<r;c++)a+=f((o=e[c]).lineHeight,n)||l;var u,h=f(o.maxFontSize,n)||n;switch(t){case"middle":u=s/2-.15*h-a/2;break;case"bottom":u=-.25*h-a;break;default:u=.8*s}return u}(s,w,y,v);else if("top"===s)A="0.8em";else{var M;switch(0<_?(M=parseFloat(v)||1,M*=_,d.test(v)||(M/=y)):M=0,s){case"middle":A=.3-M/2+"em";break;case"bottom":A=-M-.3+"em"}}else 0===s?A="0em":s?A=s:(A=0,null===this.attr("y")&&this.attr("y",I||"0.8em"));return b.firstChild.setAttribute("dy",A),this.append(b),this},u.removeAttr=function(t){var e=c.qualifyAttr(t),n=this.node;return e.ns?n.hasAttributeNS(e.ns,e.local)&&n.removeAttributeNS(e.ns,e.local):n.hasAttribute(t)&&n.removeAttribute(t),this},u.attr=function(t,e){if(c.isUndefined(t)){for(var n=this.node.attributes,i={},r=0;r<n.length;r++)i[n[r].name]=n[r].value;return i}if(c.isString(t)&&c.isUndefined(e))return this.node.getAttribute(t);if("object"==typeof t)for(var o in t)t.hasOwnProperty(o)&&this.setAttribute(o,t[o]);else this.setAttribute(t,e);return this},u.normalizePath=function(){return"PATH"===this.tagName()&&this.attr("d",c.normalizePathData(this.attr("d"))),this},u.remove=function(){return this.node.parentNode&&this.node.parentNode.removeChild(this.node),this},u.empty=function(){for(;this.node.firstChild;)this.node.removeChild(this.node.firstChild);return this},u.setAttributes=function(t){for(var e in t)t.hasOwnProperty(e)&&this.setAttribute(e,t[e]);return this},u.append=function(t){c.isArray(t)||(t=[t]);for(var e=0,n=t.length;e<n;e++)this.node.appendChild(c.toNode(t[e]));return this},u.prepend=function(t){var e=this.node.firstChild;return e?c(e).before(t):this.append(t)},u.before=function(t){var e=this.node,n=e.parentNode;if(n){c.isArray(t)||(t=[t]);for(var i=0,r=t.length;i<r;i++)n.insertBefore(c.toNode(t[i]),e)}return this},u.appendTo=function(t){return c.toNode(t).appendChild(this.node),this},u.svg=function(){return this.node instanceof window.SVGSVGElement?this:c(this.node.ownerSVGElement)},u.tagName=function(){return this.node.tagName.toUpperCase()},u.defs=function(){var t=this.svg()||this,e=t.node.getElementsByTagName("defs")[0];return e?c(e):c("defs").appendTo(t)},u.clone=function(){var t=c(this.node.cloneNode(!0));return t.node.id=c.uniqueId(),t},u.findOne=function(t){var e=this.node.querySelector(t);return e?c(e):void 0},u.find=function(t){var e=[],n=this.node.querySelectorAll(t);if(n)for(var i=0;i<n.length;i++)e.push(c(n[i]));return e},u.children=function(){for(var t=this.node.childNodes,e=[],n=0;n<t.length;n++)1===t[n].nodeType&&e.push(c(t[n]));return e},u.index=function(){for(var t=0,e=this.node.previousSibling;e;)1===e.nodeType&&t++,e=e.previousSibling;return t},u.findParentByClass=function(t,e){for(var n=this.node.ownerSVGElement,i=this.node.parentNode;i&&i!==e&&i!==n;){var r=c(i);if(r.hasClass(t))return r;i=i.parentNode}return null},u.contains=function(t){var e=this.node,n=c.toNode(t),i=n&&n.parentNode;return e===i||!!(i&&1===i.nodeType&&16&e.compareDocumentPosition(i))},u.toLocalPoint=function(t,e){var n=this.svg().node,i=n.createSVGPoint();i.x=t,i.y=e;try{var r=i.matrixTransform(n.getScreenCTM().inverse()),o=this.getTransformToElement(n).inverse()}catch(t){return i}return r.matrixTransform(o)},u.translateCenterToPoint=function(t){var e=this.getBBox({target:this.svg()}).center();return this.translate(t.x-e.x,t.y-e.y),this},u.translateAndAutoOrient=function(t,e,n){t=new L(t),e=new L(e),n=n||this.svg();var i=this.scale();this.attr("transform","");var r=this.getBBox({target:n}).scale(i.sx,i.sy),o=c.createSVGTransform();o.setTranslate(-r.x-r.width/2,-r.y-r.height/2);var s=c.createSVGTransform(),a=t.angleBetween(e,t.clone().offset(1,0));a&&s.setRotate(a,0,0);var l=c.createSVGTransform(),u=t.clone().move(e,r.width/2);l.setTranslate(2*t.x-u.x,2*t.y-u.y);var h=this.getTransformToElement(n),d=c.createSVGTransform();return d.setMatrix(l.matrix.multiply(s.matrix.multiply(o.matrix.multiply(h.scale(i.sx,i.sy))))),this.attr("transform",c.matrixToTransformString(d.matrix)),this},u.animateAlongPath=function(t,e){e=c.toNode(e);var n=c.ensureId(e),i=c("animateMotion",t),r=c("mpath",{"xlink:href":"#"+n});i.append(r),this.append(i);try{i.node.beginElement()}catch(t){if("fake"===document.documentElement.getAttribute("smiling")){var o=i.node;o.animators=[];var s=o.getAttribute("id");s&&(id2anim[s]=o);for(var a=getTargets(o),l=0,u=a.length;l<u;l++){var h=a[l],d=new Animator(o,h,l);animators.push(d),(o.animators[l]=d).register()}}}return this},u.hasClass=function(t){return new RegExp("(\\s|^)"+t+"(\\s|$)").test(this.node.getAttribute("class"))},u.addClass=function(t){if(t&&!this.hasClass(t)){var e=this.node.getAttribute("class")||"";this.node.setAttribute("class",(e+" "+t).trim())}return this},u.removeClass=function(t){if(t&&this.hasClass(t)){var e=this.node.getAttribute("class").replace(new RegExp("(\\s|^)"+t+"(\\s|$)","g"),"$2");this.node.setAttribute("class",e)}return this},u.toggleClass=function(t,e){return(c.isUndefined(e)?this.hasClass(t):!e)?this.removeClass(t):this.addClass(t),this},u.sample=function(t){t=t||1;for(var e,n=this.node,i=n.getTotalLength(),r=[],o=0;o<i;)e=n.getPointAtLength(o),r.push({x:e.x,y:e.y,distance:o}),o+=t;return r},u.convertToPath=function(){var t=c("path");t.attr(this.attr());var e=this.convertToPathData();return e&&t.attr("d",e),t},u.convertToPathData=function(){var t=this.tagName();switch(t){case"PATH":return this.attr("d");case"LINE":return c.convertLineToPathData(this.node);case"POLYGON":return c.convertPolygonToPathData(this.node);case"POLYLINE":return c.convertPolylineToPathData(this.node);case"ELLIPSE":return c.convertEllipseToPathData(this.node);case"CIRCLE":return c.convertCircleToPathData(this.node);case"RECT":return c.convertRectToPathData(this.node)}throw new Error(t+" cannot be converted to PATH.")},c.prototype.toGeometryShape=function(){var t,e,n,i,r,o,s,a,l,u,h,d,f,p,g;switch(this.tagName()){case"RECT":return t=parseFloat(this.attr("x"))||0,e=parseFloat(this.attr("y"))||0,n=parseFloat(this.attr("width"))||0,i=parseFloat(this.attr("height"))||0,new B(t,e,n,i);case"CIRCLE":return r=parseFloat(this.attr("cx"))||0,o=parseFloat(this.attr("cy"))||0,s=parseFloat(this.attr("r"))||0,new N({x:r,y:o},s,s);case"ELLIPSE":return r=parseFloat(this.attr("cx"))||0,o=parseFloat(this.attr("cy"))||0,a=parseFloat(this.attr("rx"))||0,l=parseFloat(this.attr("ry"))||0,new N({x:r,y:o},a,l);case"POLYLINE":return u=c.getPointsFromSvgNode(this),new K(u);case"POLYGON":return 1<(u=c.getPointsFromSvgNode(this)).length&&u.push(u[0]),new K(u);case"PATH":return h=this.attr("d"),P.isDataSupported(h)||(h=c.normalizePathData(h)),new P(h);case"LINE":return d=parseFloat(this.attr("x1"))||0,p=parseFloat(this.attr("y1"))||0,f=parseFloat(this.attr("x2"))||0,g=parseFloat(this.attr("y2"))||0,new M({x:d,y:p},{x:f,y:g})}return this.getBBox()},u.findIntersection=function(t,e){var n=this.svg().node;e=e||n;var i=this.getBBox({target:e}),r=i.center();if(i.intersectionWithLineFromCenterToPoint(t)){var o,s=this.tagName();if("RECT"===s){var a=new B(parseFloat(this.attr("x")||0),parseFloat(this.attr("y")||0),parseFloat(this.attr("width")),parseFloat(this.attr("height"))),l=this.getTransformToElement(e),u=c.decomposeMatrix(l),h=n.createSVGTransform();h.setRotate(-u.rotation,r.x,r.y);var d=c.transformRect(a,h.matrix.multiply(l));o=new B(d).intersectionWithLineFromCenterToPoint(t,u.rotation)}else if("PATH"===s||"POLYGON"===s||"POLYLINE"===s||"CIRCLE"===s||"ELLIPSE"===s){var f,p,g,m,v,y=("PATH"===s?this:this.convertToPath()).sample(),b=1/0,C=[];for(f=0;f<y.length;f++)p=y[f],g=(g=c.createSVGPoint(p.x,p.y)).matrixTransform(this.getTransformToElement(e)),(v=(p=new L(g)).distance(r)+(m=1.1*p.distance(t)))<b?(b=v,C=[{sample:p,refDistance:m}]):v<b+1&&C.push({sample:p,refDistance:m});C.sort(function(t,e){return t.refDistance-e.refDistance}),C[0]&&(o=C[0].sample)}return o}},u.setAttribute=function(t,e){var n=this.node;if(null===e)return this.removeAttr(t),this;var i=c.qualifyAttr(t);return i.ns?n.setAttributeNS(i.ns,t,e):"id"===t?n.id=e:n.setAttribute(t,e),this},c.createSvgDocument=function(e){if(e){var n='<svg xmlns="'+t.svg+'" xmlns:xlink="'+t.xlink+'" version="1.1">'+e+"</svg>";return c.parseXML(n,{async:!1}).documentElement}var i=document.createElementNS(t.svg,"svg");return i.setAttributeNS(t.xmlns,"xmlns:xlink",t.xlink),i.setAttribute("version","1.1"),i},c.idCounter=0,c.uniqueId=function(){return"v-"+ ++c.idCounter},c.toNode=function(t){return c.isV(t)?t.node:t.nodeName&&t||t[0]},c.ensureId=function(t){return(t=c.toNode(t)).id||(t.id=c.uniqueId())},c.sanitizeText=function(t){return(t||"").replace(/ /g,"\xa0")},c.isUndefined=function(t){return void 0===t},c.isString=function(t){return"string"==typeof t},c.isObject=function(t){return t&&"object"==typeof t},c.isArray=Array.isArray,c.parseXML=function(t,e){var n;e=e||{};try{var i=new DOMParser;c.isUndefined(e.async)||(i.async=e.async),n=i.parseFromString(t,"text/xml")}catch(t){n=void 0}if(!n||n.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+t);return n},c.qualifyAttr=function(e){if(-1===e.indexOf(":"))return{ns:null,local:e};var n=e.split(":");return{ns:t[n[0]],local:n[1]}},c.transformRegex=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,c.transformSeparatorRegex=/[ ,]+/,c.transformationListRegex=/^(\w+)\((.*)\)/,c.transformStringToMatrix=function(t){var e=c.createSVGMatrix(),n=t&&t.match(c.transformRegex);if(!n)return e;for(var i=0,r=n.length;i<r;i++){var o=n[i].match(c.transformationListRegex);if(o){var s,a,l,u,h,d=c.createSVGMatrix(),f=o[2].split(c.transformSeparatorRegex);switch(o[1].toLowerCase()){case"scale":s=parseFloat(f[0]),a=void 0===f[1]?s:parseFloat(f[1]),d=d.scaleNonUniform(s,a);break;case"translate":l=parseFloat(f[0]),u=parseFloat(f[1]),d=d.translate(l,u);break;case"rotate":h=parseFloat(f[0]),l=parseFloat(f[1])||0,u=parseFloat(f[2])||0,d=0!==l||0!==u?d.translate(l,u).rotate(h).translate(-l,-u):d.rotate(h);break;case"skewx":h=parseFloat(f[0]),d=d.skewX(h);break;case"skewy":h=parseFloat(f[0]),d=d.skewY(h);break;case"matrix":d.a=parseFloat(f[0]),d.b=parseFloat(f[1]),d.c=parseFloat(f[2]),d.d=parseFloat(f[3]),d.e=parseFloat(f[4]),d.f=parseFloat(f[5]);break;default:continue}e=e.multiply(d)}}return e},c.matrixToTransformString=function(t){return"matrix("+(void 0!==(t=t||!0).a?t.a:1)+","+(void 0!==t.b?t.b:0)+","+(void 0!==t.c?t.c:0)+","+(void 0!==t.d?t.d:1)+","+(void 0!==t.e?t.e:0)+","+(void 0!==t.f?t.f:0)+")"},c.parseTransformString=function(t){var e,n,i;if(t){var r=c.transformSeparatorRegex;if(0<=t.trim().indexOf("matrix")){var o=c.transformStringToMatrix(t),s=c.decomposeMatrix(o);e=[s.translateX,s.translateY],i=[s.scaleX,s.scaleY],n=[s.rotation];var a=[];0===e[0]&&0===e[1]||a.push("translate("+e+")"),1===i[0]&&1===i[1]||a.push("scale("+i+")"),0!==n[0]&&a.push("rotate("+n+")"),t=a.join(" ")}else{var l=t.match(/translate\((.*?)\)/);l&&(e=l[1].split(r));var u=t.match(/rotate\((.*?)\)/);u&&(n=u[1].split(r));var h=t.match(/scale\((.*?)\)/);h&&(i=h[1].split(r))}}var d=i&&i[0]?parseFloat(i[0]):1;return{value:t,translate:{tx:e&&e[0]?parseInt(e[0],10):0,ty:e&&e[1]?parseInt(e[1],10):0},rotate:{angle:n&&n[0]?parseInt(n[0],10):0,cx:n&&n[1]?parseInt(n[1],10):void 0,cy:n&&n[2]?parseInt(n[2],10):void 0},scale:{sx:d,sy:i&&i[1]?parseFloat(i[1]):d}}},c.deltaTransformPoint=function(t,e){return{x:e.x*t.a+e.y*t.c+0,y:e.x*t.b+e.y*t.d+0}},c.decomposeMatrix=function(t){var e=c.deltaTransformPoint(t,{x:0,y:1}),o=c.deltaTransformPoint(t,{x:1,y:0}),s=180/n*i(e.y,e.x)-90,a=180/n*i(o.y,o.x);return{translateX:t.e,translateY:t.f,scaleX:r(t.a*t.a+t.b*t.b),scaleY:r(t.c*t.c+t.d*t.d),skewX:s,skewY:a,rotation:s}},c.matrixToScale=function(t){var e,n,i,o;return t?(e=c.isUndefined(t.a)?1:t.a,o=c.isUndefined(t.d)?1:t.d,n=t.b,i=t.c):e=o=1,{sx:n?r(e*e+n*n):e,sy:i?r(i*i+o*o):o}},c.matrixToRotate=function(t){var e={x:0,y:1};return t&&(e=c.deltaTransformPoint(t,e)),{angle:j(F(i(e.y,e.x))-90)}},c.matrixToTranslate=function(t){return{tx:t&&t.e||0,ty:t&&t.f||0}},c.isV=function(t){return t instanceof c},c.isVElement=c.isV,c.isSVGGraphicsElement=function(t){return!!t&&(t=c.toNode(t))instanceof SVGElement&&"function"==typeof t.getScreenCTM};var p,g,m,v,y,b,C,I,E,T,w,x=c("svg").node;function _(t,e,n,i,r,o){return[1/3*t+2/3*n,1/3*e+2/3*i,1/3*r+2/3*n,1/3*o+2/3*i,r,o]}function D(t,e,n){return{x:t*C(n)-e*b(n),y:t*b(n)+e*C(n)}}function A(t){var e=function(t){if(Array.isArray(t)&&Array.isArray(t&&t[0])||(t=function(t){if(!t)return null;var e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},n=[];return String(t).replace(g,function(t,i,r){var o=[],s=i.toLowerCase();for(r.replace(m,function(t,e){e&&o.push(+e)}),"m"===s&&2<o.length&&(n.push([i].concat(o.splice(0,2))),s="l",i="m"===i?"l":"L");o.length>=e[s]&&(n.push([i].concat(o.splice(0,e[s]))),e[s]););}),n}(t)),!t||!t.length)return[["M",0,0]];for(var e,n=[],i=0,r=0,o=0,s=0,a=t.length,l=0;l<a;l++){var c=[];n.push(c);var u,h,d=t[l];if((e=d[0])!=e.toUpperCase())switch(c[0]=e.toUpperCase(),c[0]){case"A":c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=+d[6]+i,c[7]=+d[7]+r;break;case"V":c[1]=+d[1]+r;break;case"H":c[1]=+d[1]+i;break;case"M":for(o=+d[1]+i,s=+d[2]+r,u=d.length,h=1;h<u;h++)c[h]=+d[h]+(h%2?i:r);break;default:for(u=d.length,h=1;h<u;h++)c[h]=+d[h]+(h%2?i:r)}else for(var f=d.length,p=0;p<f;p++)c[p]=d[p];switch(c[0]){case"Z":i=+o,r=+s;break;case"H":i=c[1];break;case"V":r=c[1];break;case"M":o=c[c.length-2],s=c[c.length-1],i=c[c.length-2],r=c[c.length-1];break;default:i=c[c.length-2],r=c[c.length-1]}}return n}(t),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function i(t,e,n){var i,r;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(t[0]in{T:1,Q:1}||(e.qx=null,e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=0===parseFloat(t[1])||0===parseFloat(t[2])?["L",t[6],t[7]]:["C"].concat((function t(e,n,i,r,o,s,a,l,c,u){var h,d=120*y/180,f=y/180*(+o||0),p=[];if(u)R=u[0],k=u[1],O=u[2],S=u[3];else{e=(h=D(e,n,-f)).x,n=h.y;var g=(e-(l=(h=D(l,c,-f)).x))/2,m=(n-(c=h.y))/2,v=g*g/(i*i)+m*m/(r*r);1<v&&(i*=v=T(v),r*=v);var x=i*i,_=r*r,A=(s==a?-1:1)*T(w((x*_-x*m*m-_*g*g)/(x*m*m+_*g*g))),O=A*i*m/r+(e+l)/2,S=A*-r*g/i+(n+c)/2,R=E(((n-S)/r).toFixed(9)),k=E(((c-S)/r).toFixed(9));(R=e<O?y-R:R)<0&&(R=2*y+R),(k=l<O?y-k:k)<0&&(k=2*y+k),a&&k<R&&(R-=2*y),!a&&R<k&&(k-=2*y)}var N=k-R;if(w(N)>d){var M=k,P=l,L=c;p=t(l=O+i*C(k=R+d*(a&&R<k?1:-1)),c=S+r*b(k),i,r,o,0,a,P,L,[k,M,O,S])}N=k-R;var K=C(R),B=b(R),z=C(k),j=b(k),G=I(N/4),F=4/3*(i*G),V=4/3*(r*G),H=[e,n],U=[e+F*B,n-V*K],Z=[l+F*j,c-V*z],W=[l,c];if(U[0]=2*H[0]-U[0],U[1]=2*H[1]-U[1],u)return[U,Z,W].concat(p);for(var $=[],Y=(p=[U,Z,W].concat(p).join().split(",")).length,X=0;X<Y;X++)$[X]=X%2?D(p[X-1],p[X],f).y:D(p[X],p[X+1],f).x;return $}).apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":r="C"===n||"S"===n?(i=2*e.x-e.bx,2*e.y-e.by):(i=e.x,e.y),t=["C",i,r].concat(t.slice(1));break;case"T":"Q"===n||"T"===n?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(_(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(_(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"H":t=["L"].concat(t[1],e.y);break;case"V":t=["L"].concat(e.x,t[1])}return t}function r(t,n){if(7<t[n].length){t[n].shift();for(var i=t[n];i.length;)o[n]="A",t.splice(n++,0,["C"].concat(i.splice(0,6)));t.splice(n,1),l=e.length}}for(var o=[],s="",a="",l=e.length,c=0;c<l;c++){e[c]&&(s=e[c][0]),"C"!==s&&(o[c]=s,0<c&&(a=o[c-1])),e[c]=i(e[c],n,a),"A"!==o[c]&&"C"===s&&(o[c]="C"),r(e,c);var u=e[c],h=u.length;n.x=u[h-2],n.y=u[h-1],n.bx=parseFloat(u[h-4])||n.x,n.by=parseFloat(u[h-3])||n.y}return e[0][0]&&"M"===e[0][0]||e.unshift(["M",0,0]),e}return c.createSVGMatrix=function(t){var e=x.createSVGMatrix();for(var n in t)e[n]=t[n];return e},c.createSVGTransform=function(t){return c.isUndefined(t)?x.createSVGTransform():(t instanceof SVGMatrix||(t=c.createSVGMatrix(t)),x.createSVGTransformFromMatrix(t))},c.createSVGPoint=function(t,e){var n=x.createSVGPoint();return n.x=t,n.y=e,n},c.transformRect=function(t,e){var n=x.createSVGPoint();n.x=t.x,n.y=t.y;var i=n.matrixTransform(e);n.x=t.x+t.width,n.y=t.y;var r=n.matrixTransform(e);n.x=t.x+t.width,n.y=t.y+t.height;var a=n.matrixTransform(e);n.x=t.x,n.y=t.y+t.height;var l=n.matrixTransform(e),c=o(i.x,r.x,a.x,l.x),u=s(i.x,r.x,a.x,l.x),h=o(i.y,r.y,a.y,l.y),d=s(i.y,r.y,a.y,l.y);return new B(c,h,u-c,d-h)},c.transformPoint=function(t,e){return new L(c.createSVGPoint(t.x,t.y).matrixTransform(e))},c.transformLine=function(t,e){return new M(c.transformPoint(t.start,e),c.transformPoint(t.end,e))},c.transformPolyline=function(t,e){var n=t instanceof K?t.points:t;c.isArray(n)||(n=[]);for(var i=[],r=0,o=n.length;r<o;r++)i[r]=c.transformPoint(n[r],e);return new K(i)},c.styleToObject=function(t){for(var e={},n=t.split(";"),i=0;i<n.length;i++){var r=n[i].split("=");e[r[0].trim()]=r[1].trim()}return e},c.createSlicePathData=function(t,e,i,r){var o=2*n-1e-6,s=t,c=e,u=i,h=r,d=(h<u&&(d=u,u=h,h=d),h-u),f=d<n?"0":"1",p=a(u),g=l(u),m=a(h),v=l(h);return o<=d?s?"M0,"+c+"A"+c+","+c+" 0 1,1 0,"+-c+"A"+c+","+c+" 0 1,1 0,"+c+"M0,"+s+"A"+s+","+s+" 0 1,0 0,"+-s+"A"+s+","+s+" 0 1,0 0,"+s+"Z":"M0,"+c+"A"+c+","+c+" 0 1,1 0,"+-c+"A"+c+","+c+" 0 1,1 0,"+c+"Z":s?"M"+c*p+","+c*g+"A"+c+","+c+" 0 "+f+",1 "+c*m+","+c*v+"L"+s*m+","+s*v+"A"+s+","+s+" 0 "+f+",0 "+s*p+","+s*g+"Z":"M"+c*p+","+c*g+"A"+c+","+c+" 0 "+f+",1 "+c*m+","+c*v+"L0,0Z"},c.mergeAttrs=function(t,e){for(var n in e)"class"===n?t[n]=t[n]?t[n]+" "+e[n]:e[n]:"style"===n?c.isObject(t[n])&&c.isObject(e[n])?t[n]=c.mergeAttrs(t[n],e[n]):c.isObject(t[n])?t[n]=c.mergeAttrs(t[n],c.styleToObject(e[n])):c.isObject(e[n])?t[n]=c.mergeAttrs(c.styleToObject(t[n]),e[n]):t[n]=c.mergeAttrs(c.styleToObject(t[n]),c.styleToObject(e[n])):t[n]=e[n];return t},c.annotateString=function(t,e,n){e=e||[];for(var i,r,o,s=(n=n||{}).offset||0,a=[],l=[],u=0;u<t.length;u++){r=l[u]=t[u];for(var h=0;h<e.length;h++){var d=e[h],f=d.start+s,p=d.end+s;f<=u&&u<p&&(c.isObject(r)?r.attrs=c.mergeAttrs(c.mergeAttrs({},r.attrs),d.attrs):r=l[u]={t:t[u],attrs:d.attrs},n.includeAnnotationIndices&&(r.annotations||(r.annotations=[])).push(h))}(o=l[u-1])?c.isObject(r)&&c.isObject(o)?JSON.stringify(r.attrs)===JSON.stringify(o.attrs)?i.t+=r.t:(a.push(i),i=r):i=c.isObject(r)||c.isObject(o)?(a.push(i),r):(i||"")+r:i=r}return i&&a.push(i),a},c.findAnnotationsAtIndex=function(t,e){var n=[];return t&&t.forEach(function(t){t.start<e&&e<=t.end&&n.push(t)}),n},c.findAnnotationsBetweenIndexes=function(t,e,n){var i=[];return t&&t.forEach(function(t){(e>=t.start&&e<t.end||n>t.start&&n<=t.end||t.start>=e&&t.end<n)&&i.push(t)}),i},c.shiftAnnotations=function(t,e,n){return t&&t.forEach(function(t){t.start<e&&t.end>=e?t.end+=n:t.start>=e&&(t.start+=n,t.end+=n)}),t},c.convertLineToPathData=function(t){return["M",(t=c(t)).attr("x1"),t.attr("y1"),"L",t.attr("x2"),t.attr("y2")].join(" ")},c.convertPolygonToPathData=function(t){var e=c.getPointsFromSvgNode(t);return 0===e.length?null:c.svgPointsToPath(e)+" Z"},c.convertPolylineToPathData=function(t){var e=c.getPointsFromSvgNode(t);return 0===e.length?null:c.svgPointsToPath(e)},c.svgPointsToPath=function(t){for(var e=0,n=t.length;e<n;e++)t[e]=t[e].x+" "+t[e].y;return"M "+t.join(" L")},c.getPointsFromSvgNode=function(t){var e=[],n=(t=c.toNode(t)).points;if(n)for(var i=0,r=n.numberOfItems;i<r;i++)e.push(n.getItem(i));return e},c.KAPPA=.551784,c.convertCircleToPathData=function(t){t=c(t);var e=parseFloat(t.attr("cx"))||0,n=parseFloat(t.attr("cy"))||0,i=parseFloat(t.attr("r")),r=i*c.KAPPA;return["M",e,n-i,"C",e+r,n-i,e+i,n-r,e+i,n,"C",e+i,n+r,e+r,n+i,e,n+i,"C",e-r,n+i,e-i,n+r,e-i,n,"C",e-i,n-r,e-r,n-i,e,n-i,"Z"].join(" ")},c.convertEllipseToPathData=function(t){t=c(t);var e=parseFloat(t.attr("cx"))||0,n=parseFloat(t.attr("cy"))||0,i=parseFloat(t.attr("rx")),r=parseFloat(t.attr("ry"))||i,o=i*c.KAPPA,s=r*c.KAPPA;return["M",e,n-r,"C",e+o,n-r,e+i,n-s,e+i,n,"C",e+i,n+s,e+o,n+r,e,n+r,"C",e-o,n+r,e-i,n+s,e-i,n,"C",e-i,n-s,e-o,n-r,e,n-r,"Z"].join(" ")},c.convertRectToPathData=function(t){return t=c(t),c.rectToPath({x:parseFloat(t.attr("x"))||0,y:parseFloat(t.attr("y"))||0,width:parseFloat(t.attr("width"))||0,height:parseFloat(t.attr("height"))||0,rx:parseFloat(t.attr("rx"))||0,ry:parseFloat(t.attr("ry"))||0})},c.rectToPath=function(t){var e=t.x,n=t.y,i=t.width,r=t.height,s=o(t.rx||t["top-rx"]||0,i/2),a=o(t.rx||t["bottom-rx"]||0,i/2),l=o(t.ry||t["top-ry"]||0,r/2),c=o(t.ry||t["bottom-ry"]||0,r/2);return(s||a||l||c?["M",e,n+l,"v",r-l-c,"a",a,c,0,0,0,a,c,"h",i-2*a,"a",a,c,0,0,0,a,-c,"v",-(r-c-l),"a",s,l,0,0,0,-s,-l,"h",-(i-2*s),"a",s,l,0,0,0,-s,l,"Z"]:["M",e,n,"H",e+i,"V",n+r,"H",e,"V",n,"Z"]).join(" ")},c.normalizePathData=(p="\t\n\v\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029",g=new RegExp("([a-z])["+p+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+p+"]*,?["+p+"]*)+)","ig"),m=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+p+"]*,?["+p+"]*","ig"),v=Math,y=v.PI,b=v.sin,C=v.cos,I=v.tan,E=v.asin,T=v.sqrt,w=v.abs,function(t){return A(t).join(",").split(",").join(" ")}),c.namespace=t,c.g=Nt,c}(),Pt={useCSSSelectors:!0,classNamePrefix:"joint-",defaultTheme:"default"},Lt=function(t,e,n){e=e||"/";var i={};for(var r in t)if(t.hasOwnProperty(r)){var o="object"==typeof t[r];if(o&&n&&n(t[r])&&(o=!1),o){var s=Lt(t[r],e,n);for(var a in s)s.hasOwnProperty(a)&&(i[r+e+a]=s[a])}else i[r]=t[r]}return i},Kt=function(t){return Kt.id=Kt.id||1,t.id=void 0===t.id?"j_"+Kt.id++:t.id,t.id},Bt=function(){var t;if("undefined"!=typeof window&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame),!t){var e=0;t=function(t){var n=(new Date).getTime(),i=Math.max(0,16-(n-e)),r=setTimeout(function(){t(n+i)},i);return e=n+i,r}}return function(e,n){for(var i=[],r=arguments.length-2;0<r--;)i[r]=arguments[r+2];return t(void 0!==n?e.bind.apply(e,[n].concat(i)):e)}}(),zt=((kt="undefined"!=typeof window)&&(Rt=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame),Rt=Rt||clearTimeout,kt?Rt.bind(window):Rt),jt=function(t){return Ae(t)&&"%"===t.slice(-1)},Gt=function(t){t=t.replace(/\s/g,"");var e,n=(t=decodeURIComponent(t)).indexOf(","),i=t.slice(0,n),r=i.split(":")[1].split(";")[0],o=t.slice(n+1);e=0<=i.indexOf("base64")?atob(o):unescape(encodeURIComponent(o));for(var s=new Uint8Array(e.length),a=0;a<e.length;a++)s[a]=e.charCodeAt(a);return new Blob([s],{type:r})},Ft=function(t){if(Object(t)===t)return e=n=i=r=0,isFinite(t.vertical)&&(e=i=+t.vertical),isFinite(t.horizontal)&&(n=r=+t.horizontal),isFinite(t.top)&&(e=+t.top),isFinite(t.right)&&(n=+t.right),isFinite(t.bottom)&&(i=+t.bottom),isFinite(t.left)&&(r=+t.left),{top:e,right:n,bottom:i,left:r};var e,n,i,r,o=0;return isFinite(t)&&(o=+t),{top:o,right:o,bottom:o,left:o}},Vt={linear:function(t){return t},quad:function(t){return t*t},cubic:function(t){return t*t*t},inout:function(t){if(t<=0)return 0;if(1<=t)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)},exponential:function(t){return Math.pow(2,10*(t-1))},bounce:function(t){for(var e=0,n=1;;e+=n,n/=2)if((7-4*e)/11<=t){var i=(11-6*e-11*t)/4;return-i*i+n*n}},reverse:function(t){return function(e){return 1-t(1-e)}},reflect:function(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}},clamp:function(t,e,n){return e=e||0,n=n||1,function(i){var r=t(i);return r<e?e:n<r?n:r}},back:function(t){return t=t||1.70158,function(e){return e*e*((t+1)*e-t)}},elastic:function(t){return t=t||1.5,function(e){return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}}},Ht={number:function(t,e){var n=e-t;return function(e){return t+n*e}},object:function(t,e){var n=Object.keys(t);return function(i){var r,o,s={};for(r=n.length-1;-1!=r;r--)s[o=n[r]]=t[o]+(e[o]-t[o])*i;return s}},hexColor:function(t,e){var n=parseInt(t.slice(1),16),i=parseInt(e.slice(1),16),r=255&n,o=(255&i)-r,s=65280&n,a=(65280&i)-s,l=16711680&n,c=(16711680&i)-l;return function(t){return"#"+(1<<24|r+o*t&255|s+a*t&65280|l+c*t&16711680).toString(16).slice(1)}},unit:function(t,e){var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,i=n.exec(t),r=n.exec(e),o=r[1].indexOf("."),s=0<o?r[1].length-o-1:0;t=+i[1];var a=+r[1]-t,l=i[2];return function(e){return(t+a*e).toFixed(s)+l}}},Ut={outline:function(t){var e=Number.isFinite(t.margin)?t.margin:2,n=Number.isFinite(t.width)?t.width:1;return Wt('<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${outerRadius}" /><feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${innerRadius}" /><feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/><feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/><feMerge><feMergeNode in="outline"/><feMergeNode in="SourceGraphic"/></feMerge></filter>')({color:t.color||"blue",opacity:Number.isFinite(t.opacity)?t.opacity:1,outerRadius:e+n,innerRadius:e})},highlight:function(t){return Wt('<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${width}"/><feComposite result="composed" in="colored" in2="morphed" operator="in"/><feGaussianBlur result="blured" in="composed" stdDeviation="${blur}"/><feBlend in="SourceGraphic" in2="blured" mode="normal"/></filter>')({color:t.color||"red",width:Number.isFinite(t.width)?t.width:1,blur:Number.isFinite(t.blur)?t.blur:0,opacity:Number.isFinite(t.opacity)?t.opacity:1})},blur:function(t){var e=Number.isFinite(t.x)?t.x:2;return Wt('<filter><feGaussianBlur stdDeviation="${stdDeviation}"/></filter>')({stdDeviation:Number.isFinite(t.y)?[e,t.y]:e})},dropShadow:function(t){var e="SVGFEDropShadowElement"in window?'<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>':'<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';return Wt(e)({dx:t.dx||0,dy:t.dy||0,opacity:Number.isFinite(t.opacity)?t.opacity:1,color:t.color||"black",blur:Number.isFinite(t.blur)?t.blur:4})},grayscale:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Wt('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>')({a:.2126+.7874*(1-e),b:.7152-.7152*(1-e),c:.0722-.0722*(1-e),d:.2126-.2126*(1-e),e:.7152+.2848*(1-e),f:.0722-.0722*(1-e),g:.2126-.2126*(1-e),h:.0722+.9278*(1-e)})},sepia:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Wt('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>')({a:.393+.607*(1-e),b:.769-.769*(1-e),c:.189-.189*(1-e),d:.349-.349*(1-e),e:.686+.314*(1-e),f:.168-.168*(1-e),g:.272-.272*(1-e),h:.534-.534*(1-e),i:.131+.869*(1-e)})},saturate:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Wt('<filter><feColorMatrix type="saturate" values="${amount}"/></filter>')({amount:1-e})},hueRotate:function(t){return Wt('<filter><feColorMatrix type="hueRotate" values="${angle}"/></filter>')({angle:t.angle||0})},invert:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Wt('<filter><feComponentTransfer><feFuncR type="table" tableValues="${amount} ${amount2}"/><feFuncG type="table" tableValues="${amount} ${amount2}"/><feFuncB type="table" tableValues="${amount} ${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:1-e})},brightness:function(t){return Wt('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}"/><feFuncG type="linear" slope="${amount}"/><feFuncB type="linear" slope="${amount}"/></feComponentTransfer></filter>')({amount:Number.isFinite(t.amount)?t.amount:1})},contrast:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Wt('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}" intercept="${amount2}"/><feFuncG type="linear" slope="${amount}" intercept="${amount2}"/><feFuncB type="linear" slope="${amount}" intercept="${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:.5-e/2})}},Zt={number:function(t,e,n){n=n||{currency:["$",""],decimal:".",thousands:",",grouping:[3]};var i=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i.exec(t),r=i[1]||" ",o=i[2]||">",s=i[3]||"",a=i[4]||"",l=i[5],c=+i[6],u=i[7],h=i[8],d=i[9],f=1,p="",g="",m=!1;switch(h=h&&+h.substring(1),(l||"0"===r&&"="===o)&&(l=r="0",o="=",u&&(c-=Math.floor((c-1)/4))),d){case"n":u=!0,d="g";break;case"%":f=100,g="%",d="f";break;case"p":f=100,g="%",d="r";break;case"b":case"o":case"x":case"X":"#"===a&&(p="0"+d.toLowerCase());break;case"c":case"d":m=!0,h=0;break;case"s":f=-1,d="r"}"$"===a&&(p=n.currency[0],g=n.currency[1]),"r"!=d||h||(d="g"),null!=h&&("g"==d?h=Math.max(1,Math.min(21,h)):"e"!=d&&"f"!=d||(h=Math.max(0,Math.min(20,h))));var v=l&&u;if(m&&e%1)return"";var y=e<0||0===e&&1/e<0?(e=-e,"-"):s,b=g;if(f<0){var C=this.prefix(e,h);e=C.scale(e),b=C.symbol+g}else e*=f;var I=(e=this.convert(d,e,h)).lastIndexOf("."),E=I<0?e:e.substring(0,I),T=I<0?"":n.decimal+e.substring(I+1);function w(t){for(var e=t.length,i=[],r=0,o=n.grouping[0];0<e&&0<o;)i.push(t.substring(e-=o,e+o)),o=n.grouping[r=(r+1)%n.grouping.length];return i.reverse().join(n.thousands)}!l&&u&&n.grouping&&(E=w(E));var x=p.length+E.length+T.length+(v?0:y.length),_=x<c?new Array(x=c-x+1).join(r):"";return v&&(E=w(_+E)),y+=p,e=E+T,("<"===o?y+e+_:">"===o?_+y+e:"^"===o?_.substring(0,x>>=1)+y+e+_.substring(x):y+(v?e:_+e))+b},string:function(t,e){for(var n,i="{",r=!1,o=[];-1!==(n=t.indexOf(i));){var s,a,l;if(s=t.slice(0,n),r){l=(a=s.split(":")).shift().split("."),s=e;for(var c=0;c<l.length;c++)s=s[l[c]];a.length&&(s=this.number(a,s))}o.push(s),t=t.slice(n+1),i=(r=!r)?"}":"{"}return o.push(t),o.join("")},convert:function(t,e,n){switch(t){case"b":return e.toString(2);case"c":return String.fromCharCode(e);case"o":return e.toString(8);case"x":return e.toString(16);case"X":return e.toString(16).toUpperCase();case"g":return e.toPrecision(n);case"e":return e.toExponential(n);case"f":return e.toFixed(n);case"r":return(e=this.round(e,this.precision(e,n))).toFixed(Math.max(0,Math.min(20,this.precision(e*(1+1e-15),n))));default:return e+""}},round:function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},precision:function(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)},prefix:function(t,e){var n=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(function(t,e){var n=Math.pow(10,3*Math.abs(8-e));return{scale:8<e?function(t){return t/n}:function(t){return t*n},symbol:t}}),i=0;return t&&(t<0&&(t*=-1),e&&(t=this.round(t,this.precision(t,e))),i=1+Math.floor(1e-12+Math.log(t)/Math.LN10),i=Math.max(-24,Math.min(24,3*Math.floor((i<=0?i+1:i-1)/3)))),n[8+i/3]}},Wt=function(t){var e=/<%= ([^ ]+) %>|\$\{ ?([^{} ]+) ?\}|\{\{([^{} ]+)\}\}/g;return function(n){return n=n||{},t.replace(e,function(t){for(var e=Array.from(arguments).slice(1,4).find(function(t){return!!t}).split("."),i=n[e.shift()];void 0!==i&&e.length;)i=i[e.shift()];return void 0!==i?i:""})}},$t=n.assign,Yt=n.defaults,Xt=$t,qt=n.defaultsDeep,Jt=n.assign,Qt=n.defaults,te=n.defaultsDeep,ee=n.invokeMap||n.invoke,ne=n.sortedIndexBy||n.sortedIndex,ie=n.uniqBy||n.uniq,re=n.clone,oe=n.cloneDeep,se=n.isEmpty,ae=n.isEqual,le=n.isFunction,ce=n.isPlainObject,ue=n.toArray,he=n.debounce,de=n.groupBy,fe=n.sortBy,pe=n.flattenDeep,ge=n.without,me=n.difference,ve=n.intersection,ye=n.union,be=n.has,Ce=n.result,Ie=n.omit,Ee=n.pick,Te=n.bindAll,we=n.forIn,xe=n.camelCase,_e=n.uniqueId,De=function(t){return!!t&&("object"==typeof t||"function"==typeof t)},Ae=function(t){var e=Object.prototype.toString;return"string"==typeof t||!!t&&"object"==typeof t&&"[object String]"===e.call(t)},Oe=function(){};function Se(t){t=ie(t);var e=ue(t).reduce(function(t,e){return t[e.id]=e.clone(),t},{});return ue(t).forEach(function(t){var n=e[t.id];if(n.isLink()){var i=n.source(),r=n.target();i.id&&e[i.id]&&n.prop("source/id",e[i.id].id),r.id&&e[r.id]&&n.prop("target/id",e[r.id].id)}var o=t.get("parent");o&&e[o]&&n.set("parent",e[o].id);var s=ue(t.get("embeds")).reduce(function(t,n){return e[n]&&t.push(e[n].id),t},[]);se(s)||n.set("embeds",s)}),e}function Re(t,e){return function(n,i){var r=jt(n);n=parseFloat(n),r&&(n/=100);var o={};if(isFinite(n)){var s=r||0<=n&&n<=1?n*i[e]:Math.max(n+i[e],0);o[t]=s}return o}}function ke(t,e,n){return function(i,r){var o,s=jt(i);if(i=parseFloat(i),s&&(i/=100),isFinite(i)){var a=r[n]();o=s||0<i&&i<1?a[t]+r[e]*i:a[t]+i}var l=L();return l[t]=o||0,l}}function Ne(t,e,n){return function(i,r){var o;o="middle"===i?r[e]/2:i===n?r[e]:isFinite(i)?-1<i&&i<1?-r[e]*i:-i:jt(i)?r[e]*parseFloat(i)/100:0;var s=L();return s[t]=-(r[t]+o),s}}function Me(t,e){var n="joint-shape",r=e&&e.resetOffset;return function(e,o,s){var a=i(s),l=a.data(n);if(!l||l.value!==e){var c=t(e);l={value:e,shape:c,shapeBBox:c.bbox()},a.data(n,l)}var u=l.shape.clone(),h=l.shapeBBox.clone(),d=h.origin(),f=o.origin();h.x=f.x,h.y=f.y;var p=o.maxRectScaleToFit(h,f),g=0===h.width||0===o.width?1:p.sx,m=0===h.height||0===o.height?1:p.sy;return u.scale(g,m,d),r&&u.translate(-d.x,-d.y),u}}function Pe(t){var e=Me(function(t){return new P(Mt.normalizePathData(t))},t);return function(t,n,i){return{d:e(t,n,i).serialize()}}}function Le(t){var e=Me(K,t);return function(t,n,i){return{points:e(t,n,i).serialize()}}}function Ke(t,e){var n=new L(1,0);return function(i){var r,o,s=this[t](i);return s?(o=e.rotate?s.vector().vectorAngle(n):0,r=s.start):(r=this.path.start,o=0),0===o?{transform:"translate("+r.x+","+r.y+")"}:{transform:"translate("+r.x+","+r.y+") rotate("+o+")"}}}function Be(t,e,n){return void 0!==n.text}function ze(){return this.model.isLink()}function je(t){var e={},n=t.stroke;"string"==typeof n&&(e.stroke=n,e.fill=n);var i=t.strokeOpacity;return void 0===i&&(i=t["stroke-opacity"]),void 0===i&&(i=t.opacity),void 0!==i&&(e["stroke-opacity"]=i,e["fill-opacity"]=i),e}var Ge,Fe,Ve={xlinkHref:{set:"xlink:href"},xlinkShow:{set:"xlink:show"},xlinkRole:{set:"xlink:role"},xlinkType:{set:"xlink:type"},xlinkArcrole:{set:"xlink:arcrole"},xlinkTitle:{set:"xlink:title"},xlinkActuate:{set:"xlink:actuate"},xmlSpace:{set:"xml:space"},xmlBase:{set:"xml:base"},xmlLang:{set:"xml:lang"},preserveAspectRatio:{set:"preserveAspectRatio"},requiredExtension:{set:"requiredExtension"},requiredFeatures:{set:"requiredFeatures"},systemLanguage:{set:"systemLanguage"},externalResourcesRequired:{set:"externalResourceRequired"},filter:{qualify:ce,set:function(t){return"url(#"+this.paper.defineFilter(t)+")"}},fill:{qualify:ce,set:function(t){return"url(#"+this.paper.defineGradient(t)+")"}},stroke:{qualify:ce,set:function(t){return"url(#"+this.paper.defineGradient(t)+")"}},sourceMarker:{qualify:ce,set:function(t,e,n,i){return t=Jt(je(i),t),{"marker-start":"url(#"+this.paper.defineMarker(t)+")"}}},targetMarker:{qualify:ce,set:function(t,e,n,i){return t=Jt(je(i),{transform:"rotate(180)"},t),{"marker-end":"url(#"+this.paper.defineMarker(t)+")"}}},vertexMarker:{qualify:ce,set:function(t,e,n,i){return t=Jt(je(i),t),{"marker-mid":"url(#"+this.paper.defineMarker(t)+")"}}},text:{qualify:function(t,e,n){return!n.textWrap||!ce(n.textWrap)},set:function(t,e,n,r){var o=i(n),s="joint-text",a=o.data(s),l=Ee(r,"lineHeight","annotations","textPath","x","textVerticalAnchor","eol","displayEmpty"),c=l.fontSize=r["font-size"]||r.fontSize,u=JSON.stringify([t,l]);if(void 0===a||a!==u){c&&n.setAttribute("font-size",c);var h=l.textPath;if(De(h)){var d=h.selector;if("string"==typeof d){var f=this.findBySelector(d)[0];f instanceof SVGPathElement&&(l.textPath=Jt({"xlink:href":"#"+f.id},h))}}Mt(n).text(""+t,l),o.data(s,u)}}},textWrap:{qualify:ce,set:function(t,e,n,i){var r=t.width||0;jt(r)?e.width*=parseFloat(r)/100:r<=0?e.width+=r:e.width=r;var o,s=t.height||0;jt(s)?e.height*=parseFloat(s)/100:s<=0?e.height+=s:e.height=s;var a=t.text;void 0===a&&(a=i.text),o=void 0!==a?bt(""+a,e,{"font-weight":i["font-weight"]||i.fontWeight,"font-size":i["font-size"]||i.fontSize,"font-family":i["font-family"]||i.fontFamily,lineHeight:i.lineHeight},{svgDocument:this.paper.svg,ellipsis:t.ellipsis,hyphen:t.hyphen}):"",Ve.text.set.call(this,o,e,n,i)}},title:{qualify:function(t,e){return e instanceof SVGElement},set:function(t,e,n){var r=i(n),o="joint-title",s=r.data(o);if(void 0===s||s!==t){r.data(o,t);var a=n.firstChild;if(a&&"TITLE"===a.tagName.toUpperCase())a.textContent=t;else{var l=document.createElementNS(n.namespaceURI,"title");l.textContent=t,n.insertBefore(l,a)}}}},lineHeight:{qualify:Be},textVerticalAnchor:{qualify:Be},textPath:{qualify:Be},annotations:{qualify:Be},eol:{qualify:Be},displayEmpty:{qualify:Be},port:{set:function(t){return null===t||void 0===t.id?t:t.id}},style:{qualify:ce,set:function(t,e,n){i(n).css(t)}},html:{set:function(t,e,n){i(n).html(t+"")}},ref:{},refX:{position:ke("x","width","origin")},refY:{position:ke("y","height","origin")},refDx:{position:ke("x","width","corner")},refDy:{position:ke("y","height","corner")},refWidth:{set:Re("width","width")},refHeight:{set:Re("height","height")},refRx:{set:Re("rx","width")},refRy:{set:Re("ry","height")},refRInscribed:{set:(Ge=Re("r","width"),Fe=Re("r","height"),function(t,e){return(e.height>e.width?Ge:Fe)(t,e)})},refRCircumscribed:{set:function(t,e){var n=jt(t);t=parseFloat(t),n&&(t/=100);var i,r=Math.sqrt(e.height*e.height+e.width*e.width);return isFinite(t)&&(i=n||0<=t&&t<=1?t*r:Math.max(t+r,0)),{r:i}}},refCx:{set:Re("cx","width")},refCy:{set:Re("cy","height")},xAlignment:{offset:Ne("x","width","right")},yAlignment:{offset:Ne("y","height","bottom")},resetOffset:{offset:function(t,e){return t?{x:-e.x,y:-e.y}:{x:0,y:0}}},refDResetOffset:{set:Pe({resetOffset:!0})},refDKeepOffset:{set:Pe({resetOffset:!1})},refPointsResetOffset:{set:Le({resetOffset:!0})},refPointsKeepOffset:{set:Le({resetOffset:!1})},connection:{qualify:ze,set:function(t){var e,n=t.stubs;if(void 0===n&&(n=0),isFinite(n)&&0!==n){var i;i=n<0?(this.getConnectionLength()+n)/2:n;var r=this.getConnection(),o=r.divideAtLength(i),s=r.divideAtLength(-i);o&&s&&(e=o[0].serialize()+" "+s[1].serialize())}return{d:e||this.getSerializedConnection()}}},atConnectionLengthKeepGradient:{qualify:ze,set:Ke("getTangentAtLength",{rotate:!0})},atConnectionLengthIgnoreGradient:{qualify:ze,set:Ke("getTangentAtLength",{rotate:!1})},atConnectionRatioKeepGradient:{qualify:ze,set:Ke("getTangentAtRatio",{rotate:!0})},atConnectionRatioIgnoreGradient:{qualify:ze,set:Ke("getTangentAtRatio",{rotate:!1})}};function He(t,e,n){if(Ae(n)){if(!We[n])throw new Error('Unknown wrapper: "'+n+'"');n=We[n]}if(!le(n))throw new Error("Wrapper must be a function.");ue(e).forEach(function(e){t[e]=n(t[e])})}Ve.refR=Ve.refRInscribed,Ve.refD=Ve.refDResetOffset,Ve.refPoints=Ve.refPointsResetOffset,Ve.atConnectionLength=Ve.atConnectionLengthKeepGradient,Ve.atConnectionRatio=Ve.atConnectionRatioKeepGradient,Ve.refX2=Ve.refX,Ve.refY2=Ve.refY,Ve.refWidth2=Ve.refWidth,Ve.refHeight2=Ve.refHeight,Ve["ref-x"]=Ve.refX,Ve["ref-y"]=Ve.refY,Ve["ref-dy"]=Ve.refDy,Ve["ref-dx"]=Ve.refDx,Ve["ref-width"]=Ve.refWidth,Ve["ref-height"]=Ve.refHeight,Ve["x-alignment"]=Ve.xAlignment,Ve["y-alignment"]=Ve.yAlignment;var Ue=Ve,Ze=e.Model.extend({constructor:function(t,e){var n,i=t||{};this.cid=_e("c"),this.attributes={},e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(i=this.parse(i,e)||{}),(n=Ce(this,"defaults"))&&(i=At({},n,i)),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)},translate:function(t,e,n){throw new Error("Must define a translate() method.")},toJSON:function(){var t=this.constructor.prototype.defaults.attrs||{},e=this.attributes.attrs,n={};we(e,function(e,i){var r=t[i];we(e,function(t,e){De(t)&&!Array.isArray(t)?we(t,function(t,o){r&&r[e]&&ae(r[e][o],t)||(n[i]=n[i]||{},(n[i][e]||(n[i][e]={}))[o]=t)}):r&&ae(r[e],t)||(n[i]=n[i]||{},n[i][e]=t)})});var i=oe(Ie(this.attributes,"attrs"));return i.attrs=n,i},initialize:function(t){t&&t.id||this.set("id",this.generateId(),{silent:!0}),this._transitionIds={},this.processPorts(),this.on("change:attrs",this.processPorts,this)},generateId:function(){return gt()},processPorts:function(){var t=this.ports,e={};we(this.get("attrs"),function(t,n){t&&t.port&&(void 0!==t.port.id?e[t.port.id]=t.port:e[t.port]={id:t.port})});var n={};we(t,function(t,i){e[i]||(n[i]=!0)}),this.graph&&!se(n)&&(this.graph.getConnectedLinks(this,{inbound:!0}).forEach(function(t){n[t.get("target").port]&&t.remove()}),this.graph.getConnectedLinks(this,{outbound:!0}).forEach(function(t){n[t.get("source").port]&&t.remove()})),this.ports=e},remove:function(t){t=t||{};var e=this.graph;if(!e)return this.collection&&this.collection.remove(this,t),this;e.startBatch("remove");var n=this.getParentCell();n&&n.unembed(this);for(var i=this.getEmbeddedCells(),r=0,o=i.length;r<o;r++){var s=i[r];s&&s.remove(t)}return this.trigger("remove",this,e.attributes.cells,t),e.stopBatch("remove"),this},toFront:function(t){var e=this.graph;if(e){t=t||{};var n,i=e.maxZIndex();t.deep?(n=this.getEmbeddedCells({deep:!0,breadthFirst:!0})).unshift(this):n=[this],i=i-n.length+1;var r=e.get("cells"),o=r.indexOf(this)!==r.length-n.length;(o=o||n.some(function(t,e){return t.get("z")!==i+e}))&&(this.startBatch("to-front"),i+=n.length,n.forEach(function(e,n){e.set("z",i+n,t)}),this.stopBatch("to-front"))}return this},toBack:function(t){var e=this.graph;if(e){t=t||{};var n,i=e.minZIndex();t.deep?(n=this.getEmbeddedCells({deep:!0,breadthFirst:!0})).unshift(this):n=[this];var r=0!==e.get("cells").indexOf(this);(r=r||n.some(function(t,e){return t.get("z")!==i+e}))&&(this.startBatch("to-back"),i-=n.length,n.forEach(function(e,n){e.set("z",i+n,t)}),this.stopBatch("to-back"))}return this},parent:function(t,e){return void 0===t?this.get("parent"):this.set("parent",t,e)},embed:function(t,e){if(this===t||this.isEmbeddedIn(t))throw new Error("Recursive embedding not allowed.");this.startBatch("embed");var n=Jt([],this.get("embeds"));return n[t.isLink()?"unshift":"push"](t.id),t.parent(this.id,e),this.set("embeds",ie(n),e),this.stopBatch("embed"),this},unembed:function(t,e){return this.startBatch("unembed"),t.unset("parent",e),this.set("embeds",ge(this.get("embeds"),t.id),e),this.stopBatch("unembed"),this},getParentCell:function(){var t=this.parent(),e=this.graph;return t&&e&&e.getCell(t)||null},getAncestors:function(){var t=[];if(!this.graph)return t;for(var e=this.getParentCell();e;)t.push(e),e=e.getParentCell();return t},getEmbeddedCells:function(t){if(t=t||{},this.graph){var e;if(t.deep)if(t.breadthFirst){e=[];for(var n=this.getEmbeddedCells();0<n.length;){var i=n.shift();e.push(i),n.push.apply(n,i.getEmbeddedCells())}}else(e=this.getEmbeddedCells()).forEach(function(n){e.push.apply(e,n.getEmbeddedCells(t))});else e=ue(this.get("embeds")).map(this.graph.getCell,this.graph);return e}return[]},isEmbeddedIn:function(t,e){var n=Ae(t)?t:t.id,i=this.parent();if(e=Qt({deep:!0},e),this.graph&&e.deep){for(;i;){if(i===n)return!0;i=this.graph.getCell(i).parent()}return!1}return i===n},isEmbedded:function(){return!!this.parent()},clone:function(t){if((t=t||{}).deep)return ue(Se([this].concat(this.getEmbeddedCells({deep:!0}))));var n=e.Model.prototype.clone.apply(this,arguments);return n.set("id",this.generateId()),n.unset("embeds"),n.unset("parent"),n},prop:function(t,e,n){var i=Ae(t);if(i||Array.isArray(t)){if(1<arguments.length){var r,o,s=(o=i?(r=t).split("/"):(r=t.join("/"),t.slice()))[0],a=o.length;if((n=n||{}).propertyPath=r,n.propertyValue=e,n.propertyPathArray=o,1===a)return this.set(s,e,n);for(var l={},c=l,u=s,h=1;h<a;h++){var d=o[h],f=Number.isFinite(i?Number(d):d);c=c[u]=f?[]:{},u=d}l=ft(l,o,e,"/");var p=At({},this.attributes);n.rewrite&&pt(p,r,"/");var g=At(p,l);return this.set(s,g[s],n)}return dt(this.attributes,t,"/")}return this.set(At({},this.attributes,t),e)},removeProp:function(t,e){e=e||{};var n=Array.isArray(t)?t:t.split("/"),i=n[0];if("attrs"===i&&(e.dirty=!0),1===n.length)return this.unset(t,e);var r=n.slice(1),o=oe(this.get(i));return pt(o,r,"/"),this.set(i,o,e)},attr:function(t,e,n){var i=Array.from(arguments);return 0===i.length?this.get("attrs"):(Array.isArray(t)?i[0]=["attrs"].concat(t):Ae(t)?i[0]="attrs/"+t:i[0]={attrs:t},this.prop.apply(this,i))},removeAttr:function(t,e){return Array.isArray(t)?this.removeProp(["attrs"].concat(t)):this.removeProp("attrs/"+t,e)},transition:function(t,e,n,i){i=i||"/",n=Jt({duration:100,delay:10,timingFunction:Vt.linear,valueFunction:Ht.number},n);var r,o=0,s=(function(e){var i,a,l;(a=(e-=o=o||e)/n.duration)<1?this._transitionIds[t]=i=Bt(s):(a=1,delete this._transitionIds[t]),l=r(n.timingFunction(a)),n.transitionId=i,this.prop(t,l,n),i||this.trigger("transition:end",this,t)}).bind(this),a=(function(o){this.stopTransitions(t),r=n.valueFunction(dt(this.attributes,t,i),e),this._transitionIds[t]=Bt(o),this.trigger("transition:start",this,t)}).bind(this);return setTimeout(a,n.delay,s)},getTransitions:function(){return Object.keys(this._transitionIds)},stopTransitions:function(t,e){e=e||"/";var n=t&&t.split(e);return Object.keys(this._transitionIds).filter(n&&function(t){return ae(n,t.split(e).slice(0,n.length))}).forEach(function(t){zt(this._transitionIds[t]),delete this._transitionIds[t],this.trigger("transition:end",this,t)},this),this},addTo:function(t,e){return t.addCell(this,e),this},findView:function(t){return t.findViewByModel(this)},isElement:function(){return!1},isLink:function(){return!1},startBatch:function(t,e){return this.graph&&this.graph.startBatch(t,Jt({},e,{cell:this})),this},stopBatch:function(t,e){return this.graph&&this.graph.stopBatch(t,Jt({},e,{cell:this})),this},getChangeFlag:function(t){var e=0;if(!t)return e;for(var n in t)t.hasOwnProperty(n)&&this.hasChanged(n)&&(e|=t[n]);return e},angle:function(){return 0},position:function(){return new L(0,0)},getPointFromConnectedLink:function(){return new L},getBBox:function(){return new B(0,0,0,0)}},{getAttributeDefinition:function(t){var e=this.attributes,n=Ue;return e&&e[t]||n[t]},define:function(t,e,n,i){n=Jt({defaults:te({type:t},e,this.prototype.defaults)},n);var r=this.extend(n,i);return"undefined"!=typeof joint&&be(joint,"shapes")&&ft(joint.shapes,t,r,"."),r}}),We={cells:function(t){return function(){var e=Array.from(arguments),n=e.length,i=0<n&&e[0]||[],r=1<n&&e[n-1]||{};return Array.isArray(i)||(r instanceof Ze?i=e:i instanceof Ze&&(1<e.length&&e.pop(),i=e)),r instanceof Ze&&(r={}),t.call(this,i,r)}}},$e={wrapWith:He,wrappers:We,addClassNamePrefix:lt,removeClassNamePrefix:ct,parseDOMJSON:ut,hashCode:ht,getByPath:dt,setByPath:ft,unsetByPath:pt,flattenObject:Lt,uuid:gt,guid:Kt,toKebabCase:mt,normalizeEvent:vt,nextFrame:Bt,cancelFrame:zt,shapePerimeterConnectionPoint:function(t,e,n,i){var r,o;if(!n){var s=e.$(".scalable")[0],a=e.$(".rotatable")[0];s&&s.firstChild?n=s.firstChild:a&&a.firstChild&&(n=a.firstChild)}return n?(o=Mt(n).findIntersection(i,t.paper.cells))||(r=Mt(n).getBBox({target:t.paper.cells})):o=(r=e.model.getBBox()).intersectionWithLineFromCenterToPoint(i),o||r.center()},isPercentage:jt,parseCssNumeric:yt,breakText:bt,sanitizeHTML:Ct,downloadBlob:It,downloadDataUri:Et,dataUriToBlob:Gt,imageToDataUri:Tt,getElementBBox:wt,sortElements:xt,setAttributesBySelector:_t,normalizeSides:Ft,timing:Vt,interpolate:Ht,filter:Ut,format:Zt,template:Wt,toggleFullScreen:Dt,mixin:$t,supplement:Yt,deepMixin:Xt,deepSupplement:qt,assign:Jt,defaults:Qt,defaultsDeep:te,invoke:ee,sortedIndex:ne,uniq:ie,clone:re,cloneDeep:oe,isEmpty:se,isEqual:ae,isFunction:le,isPlainObject:ce,toArray:ue,debounce:he,groupBy:de,sortBy:fe,flattenDeep:pe,without:ge,difference:me,intersection:ve,union:ye,has:be,result:Ce,omit:Ie,pick:Ee,bindAll:Te,forIn:we,camelCase:xe,uniqueId:_e,merge:At,isBoolean:Ot,isObject:De,isNumber:St,isString:Ae,noop:Oe,cloneCells:Se};function Ye(t,e,n){var i=t.toJSON();return i.angle=e||0,Qt({},n,i)}function Xe(t,e,n){return t.map(function(t,e,n){var i=this.pointAt((e+.5)/n.length);return(t.dx||t.dy)&&i.offset(t.dx||0,t.dy||0),Ye(i.round(),0,t)},Z(e,n))}function qe(t,e,n,i){var r=e.center(),o=e.width/e.height,s=e.topMiddle(),a=N.fromRect(e);return t.map(function(t,e,l){var c=n+i(e,l.length),u=s.clone().rotate(r,-c).scale(o,1,r),h=t.compensateRotation?-a.tangentTheta(u):0;return(t.dx||t.dy)&&u.offset(t.dx||0,t.dy||0),t.dr&&u.move(r,t.dr),Ye(u.round(),h,t)})}function Je(t,e){var n=e.x;Ae(n)&&(n=parseFloat(n)/100*t.width);var i=e.y;return Ae(i)&&(i=parseFloat(i)/100*t.height),W(n||0,i||0)}var Qe={absolute:function(t,e,n){return t.map(Je.bind(null,e))},fn:function(t,e,n){return n.fn(t,e,n)},line:function(t,e,n){return Xe(t,Je(e,n.start||e.origin()),Je(e,n.end||e.corner()))},left:function(t,e,n){return Xe(t,e.origin(),e.bottomLeft())},right:function(t,e,n){return Xe(t,e.topRight(),e.corner())},top:function(t,e,n){return Xe(t,e.origin(),e.topRight())},bottom:function(t,e,n){return Xe(t,e.bottomLeft(),e.corner())},ellipseSpread:function(t,e,n){var i=n.startAngle||0,r=n.step||360/t.length;return qe(t,e,i,function(t){return t*r})},ellipse:function(t,e,n){var i=n.startAngle||0,r=n.step||20;return qe(t,e,i,function(t,e){return(t+.5-e/2)*r})}};function tn(t,e){return te({},t,e,{x:0,y:0,angle:0,attrs:{".":{y:"0","text-anchor":"start"}}})}function en(t,e,n,i){i=Qt({},i,{offset:15});var r,o,s,a,l=e.center().theta(t),c=nn(e),u=i.offset,h=0;a=l<c[1]||l>c[2]?(s=".3em",r=u,o=0,"start"):l<c[0]?(s="0",r=0,o=-u,n?(h=-90,"start"):"middle"):l<c[3]?(s=".3em",r=-u,o=0,"end"):(s=".6em",r=0,o=u,n?(h=90,"start"):"middle");var d=Math.round;return tn({x:d(r),y:d(o),angle:h,attrs:{".":{y:s,"text-anchor":a}}})}function nn(t){var e=t.center(),n=e.theta(t.origin()),i=e.theta(t.bottomLeft()),r=e.theta(t.corner());return[n,e.theta(t.topRight()),r,i]}function rn(t,e,n,i){var r,o,s,a,l=e.center().theta(t),c=(i=Qt({},i,{offset:15})).offset,u=0,h=nn(e);a=l<h[1]||l>h[2]?(s=".3em",r=-c,o=0,"end"):l<h[0]?(s=".6em",r=0,o=c,n?(u=90,"start"):"middle"):l<h[3]?(s=".3em",r=c,o=0,"start"):(s="0em",r=0,o=-c,n?(u=-90,"start"):"middle");var d=Math.round;return tn({x:d(r),y:d(o),angle:u,attrs:{".":{y:s,"text-anchor":a}}})}function on(t,e,n){n=Qt({},n,{offset:20});var i,r=W(0,0),o=-t.theta(r),s=o,a=t.clone().move(r,n.offset).difference(t).round(),l=".3em";(90+o)%180==0?(i=e?"end":"middle",e||-270!=o||(l="0em")):-270<o&&o<-90?(i="start",s=o-180):i="end";var c=Math.round;return tn({x:c(a.x),y:c(a.y),angle:e?s:0,attrs:{".":{y:l,"text-anchor":i}}})}function sn(t){var e=oe(t)||{};this.ports=[],this.groups={},this.portLayoutNamespace=Qe,this.portLabelLayoutNamespace=an,this._init(e)}var an={manual:function(t,e,n){return tn(n,e)},left:function(t,e,n){return tn(n,{x:-15,attrs:{".":{y:".3em","text-anchor":"end"}}})},right:function(t,e,n){return tn(n,{x:15,attrs:{".":{y:".3em","text-anchor":"start"}}})},top:function(t,e,n){return tn(n,{y:-15,attrs:{".":{"text-anchor":"middle"}}})},bottom:function(t,e,n){return tn(n,{y:15,attrs:{".":{y:".6em","text-anchor":"middle"}}})},outsideOriented:function(t,e,n){return en(t,e,!0,n)},outside:function(t,e,n){return en(t,e,!1,n)},insideOriented:function(t,e,n){return rn(t,e,!0,n)},inside:function(t,e,n){return rn(t,e,!1,n)},radial:function(t,e,n){return on(t.difference(e.center()),!1,n)},radialOriented:function(t,e,n){return on(t.difference(e.center()),!0,n)}};sn.prototype={getPorts:function(){return this.ports},getGroup:function(t){return this.groups[t]||{}},getPortsByGroup:function(t){return this.ports.filter(function(e){return e.group===t})},getGroupPortsMetrics:function(t,e){var n=this.getGroup(t),i=this.getPortsByGroup(t),r=n.position||{},o=r.name,s=this.portLayoutNamespace;s[o]||(o="left");var a=r.args||{},l=i.map(function(t){return t&&t.position&&t.position.args}),c=s[o](l,e,a),u={ports:i,result:[]};return ue(c).reduce((function(t,n,i){var r=t.ports[i];return t.result.push({portId:r.id,portTransformation:n,labelTransformation:this._getPortLabelLayout(r,L(n),e),portAttrs:r.attrs,portSize:r.size,labelSize:r.label.size}),t}).bind(this),u),u.result},_getPortLabelLayout:function(t,e,n){var i=this.portLabelLayoutNamespace,r=t.label.position.name||"left";return i[r]?i[r](e,n,t.label.position.args):null},_init:function(t){if(De(t.groups))for(var e=Object.keys(t.groups),n=0,i=e.length;n<i;n++){var r=e[n];this.groups[r]=this._evaluateGroup(t.groups[r])}for(var o=ue(t.items),s=0,a=o.length;s<a;s++)this.ports.push(this._evaluatePort(o[s]))},_evaluateGroup:function(t){return At(t,{position:this._getPosition(t.position,!0),label:this._getLabel(t,!0)})},_evaluatePort:function(t){var e=Jt({},t),n=this.getGroup(t.group);return e.markup=e.markup||n.markup,e.attrs=At({},n.attrs,e.attrs),e.position=this._createPositionNode(n,e),e.label=At({},n.label,this._getLabel(e)),e.z=this._getZIndex(n,e),e.size=Jt({},n.size,e.size),e},_getZIndex:function(t,e){return St(e.z)?e.z:St(t.z)||"auto"===t.z?t.z:"auto"},_createPositionNode:function(t,e){return At({name:"left",args:{}},t.position,{args:e.args})},_getPosition:function(t,e){var n,i={};le(t)?(n="fn",i.fn=t):Ae(t)?n=t:void 0===t?n=e?"left":null:Array.isArray(t)?(n="absolute",i.x=t[0],i.y=t[1]):De(t)&&(n=t.name,Jt(i,t.args));var r={args:i};return n&&(r.name=n),r},_getLabel:function(t,e){var n=t.label||{},i=n;return i.position=this._getPosition(n.position,e),i}};var ln={_initializePorts:function(){this._createPortData(),this.on("change:ports",function(){this._processRemovedPort(),this._createPortData()},this)},_processRemovedPort:function(){var t=this.get("ports")||{},e={};ue(t.items).forEach(function(t){e[t.id]=!0});var n=this.previous("ports")||{},i={};ue(n.items).forEach(function(t){e[t.id]||(i[t.id]=!0)});var r=this.graph;r&&!se(i)&&(r.getConnectedLinks(this,{inbound:!0}).forEach(function(t){i[t.get("target").port]&&t.remove()}),r.getConnectedLinks(this,{outbound:!0}).forEach(function(t){i[t.get("source").port]&&t.remove()}))},hasPorts:function(){var t=this.prop("ports/items");return Array.isArray(t)&&0<t.length},hasPort:function(t){return-1!==this.getPortIndex(t)},getPorts:function(){return oe(this.prop("ports/items"))||[]},getPort:function(t){return oe(ue(this.prop("ports/items")).find(function(e){return e.id&&e.id===t}))},getPortsPositions:function(t){return this._portSettingsData.getGroupPortsMetrics(t,B(this.size())).reduce(function(t,e){var n=e.portTransformation;return t[e.portId]={x:n.x,y:n.y,angle:n.angle},t},{})},getPortIndex:function(t){var e=De(t)?t.id:t;return this._isValidPortId(e)?ue(this.prop("ports/items")).findIndex(function(t){return t.id===e}):-1},addPort:function(t,e){if(!De(t)||Array.isArray(t))throw new Error("Element: addPort requires an object.");var n=Jt([],this.prop("ports/items"));return n.push(t),this.prop("ports/items",n,e),this},portProp:function(t,e,n,i){var r=this.getPortIndex(t);if(-1===r)throw new Error("Element: unable to find port with id "+t);var o=Array.prototype.slice.call(arguments,1);return Array.isArray(e)?o[0]=["ports","items",r].concat(e):Ae(e)?o[0]=["ports/items/",r,"/",e].join(""):(o=["ports/items/"+r],ce(e)&&(o.push(e),o.push(n))),this.prop.apply(this,o)},_validatePorts:function(){var t=this.get("ports")||{},e=[],n=ue((t=t||{}).items);return n.forEach(function(t){"object"!=typeof t&&e.push("Element: invalid port ",t),this._isValidPortId(t.id)||(t.id=this.generatePortId())},this),ie(n,"id").length!==n.length&&e.push("Element: found id duplicities in ports."),e},generatePortId:function(){return this.generateId()},_isValidPortId:function(t){return null!=t&&!De(t)},addPorts:function(t,e){return t.length&&this.prop("ports/items",Jt([],this.prop("ports/items")).concat(t),e),this},removePort:function(t,e){var n=e||{},i=Jt([],this.prop("ports/items")),r=this.getPortIndex(t);return-1!==r&&(i.splice(r,1),n.rewrite=!0,this.prop("ports/items",i,n)),this},removePorts:function(t,e){var n;if(Array.isArray(t)){if(n=e||{},t.length){n.rewrite=!0;var i=Jt([],this.prop("ports/items")).filter(function(e){return!t.some(function(t){var n=De(t)?t.id:t;return e.id===n})});this.prop("ports/items",i,n)}}else(n=t||{}).rewrite=!0,this.prop("ports/items",[],n);return this},_createPortData:function(){var t,e=this._validatePorts();if(0<e.length)throw this.set("ports",this.previous("ports")),new Error(e.join(" "));this._portSettingsData&&(t=this._portSettingsData.getPorts()),this._portSettingsData=new sn(this.get("ports"));var n=this._portSettingsData.getPorts();if(t){var i=n.filter(function(e){if(!t.find(function(t){return t.id===e.id}))return e}),r=t.filter(function(t){if(!n.find(function(e){return e.id===t.id}))return t});0<r.length&&this.trigger("ports:remove",this,r),0<i.length&&this.trigger("ports:add",this,i)}}},cn={portContainerMarkup:"g",portMarkup:[{tagName:"circle",selector:"circle",attributes:{r:10,fill:"#FFFFFF",stroke:"#000000"}}],portLabelMarkup:[{tagName:"text",selector:"text",attributes:{fill:"#000000"}}],_portElementsCache:null,_initializePorts:function(){this._cleanPortsCache()},_refreshPorts:function(){this._removePorts(),this._cleanPortsCache(),this._renderPorts()},_cleanPortsCache:function(){this._portElementsCache={}},_renderPorts:function(){for(var t=[],e=this._getContainerElement(),n=0,i=e.node.childNodes.length;n<i;n++)t.push(e.node.childNodes[n]);var r=de(this.model._portSettingsData.getPorts(),"z");ue(r.auto).forEach(function(n){var i=this._getPortElement(n);e.append(i),t.push(i)},this);for(var o=Object.keys(r),s=0;s<o.length;s++){var a=o[s];if("auto"!==a){var l=parseInt(a,10);this._appendPorts(r[a],l,t)}}this._updatePorts()},_getContainerElement:function(){return this.rotatableNode||this.vel},_appendPorts:function(t,e,n){var i=this._getContainerElement(),r=ue(t).map(this._getPortElement,this);n[e]||e<0?Mt(n[Math.max(e,0)]).before(r):i.append(r)},_getPortElement:function(t){return this._portElementsCache[t.id]?this._portElementsCache[t.id].portElement:this._createPortElement(t)},findPortNode:function(t,e){var n=this._portElementsCache[t];if(!n)return null;var i=n.portContentElement.node,r=n.portContentSelectors;return this.findBySelector(e,i,r)[0]},_updatePorts:function(){this._updatePortGroup(void 0),Object.keys(this.model._portSettingsData.groups).forEach(this._updatePortGroup,this)},_removePorts:function(){ee(this._portElementsCache,"portElement.remove")},_createPortElement:function(t){var e,n,i,r=Mt(this.portContainerMarkup).addClass("joint-port"),o=this._getPortMarkup(t);if(Array.isArray(o)){var s=this.parseDOMJSON(o,r.node),a=s.fragment;e=1<a.childNodes.length?Mt("g").append(a):Mt(a.firstChild),i=s.selectors}else e=Mt(o),Array.isArray(e)&&(e=Mt("g").append(e));if(!e)throw new Error("ElementView: Invalid port markup.");e.attr({port:t.id,"port-group":t.group});var l,c,u=this._getPortLabelMarkup(t.label);if(Array.isArray(u)){var h=this.parseDOMJSON(u,r.node),d=h.fragment;n=1<d.childNodes.length?Mt("g").append(d):Mt(d.firstChild),l=h.selectors}else n=Mt(u),Array.isArray(n)&&(n=Mt("g").append(n));if(!n)throw new Error("ElementView: Invalid port label markup.");if(i&&l){for(var f in l)if(i[f]&&f!==this.selector)throw new Error("ElementView: selectors within port must be unique.");c=Jt({},i,l)}else c=i||l;return r.append([e.addClass("joint-port-body"),n.addClass("joint-port-label")]),this._portElementsCache[t.id]={portElement:r,portLabelElement:n,portSelectors:c,portLabelSelectors:l,portContentElement:e,portContentSelectors:i},r},_updatePortGroup:function(t){for(var e=B(this.model.size()),n=this.model._portSettingsData.getGroupPortsMetrics(t,e),i=0,r=n.length;i<r;i++){var o=n[i],s=o.portId,a=this._portElementsCache[s]||{},l=o.portTransformation;this.applyPortTransform(a.portElement,l),this.updateDOMSubtreeAttributes(a.portElement.node,o.portAttrs,{rootBBox:new B(o.portSize),selectors:a.portSelectors});var c=o.labelTransformation;c&&(this.applyPortTransform(a.portLabelElement,c,-l.angle||0),this.updateDOMSubtreeAttributes(a.portLabelElement.node,c.attrs,{rootBBox:new B(o.labelSize),selectors:a.portLabelSelectors}))}},applyPortTransform:function(t,e,n){var i=Mt.createSVGMatrix().rotate(n||0).translate(e.x||0,e.y||0).rotate(e.angle||0);t.transform(i,{absolute:!0})},_getPortMarkup:function(t){return t.markup||this.model.get("portMarkup")||this.model.portMarkup||this.portMarkup},_getPortLabelMarkup:function(t){return t.markup||this.model.get("portLabelMarkup")||this.model.portLabelMarkup||this.portLabelMarkup}},un=Ze.extend({defaults:{position:{x:0,y:0},size:{width:1,height:1},angle:0},initialize:function(){this._initializePorts(),Ze.prototype.initialize.apply(this,arguments)},_initializePorts:function(){},_refreshPorts:function(){},isElement:function(){return!0},position:function(t,e,n){var i=St(e);if((n=(i?n:t)||{}).parentRelative){if(!this.graph)throw new Error("Element must be part of a graph.");var r=this.getParentCell(),o=r&&!r.isLink()?r.get("position"):{x:0,y:0}}if(i){if(n.parentRelative&&(t+=o.x,e+=o.y),n.deep){var s=this.get("position");this.translate(t-s.x,e-s.y,n)}else this.set("position",{x:t,y:e},n);return this}var a=L(this.get("position"));return n.parentRelative?a.difference(o):a},translate:function(t,e,n){if(e=e||0,0===(t=t||0)&&0===e)return this;(n=n||{}).translateBy=n.translateBy||this.id;var i=this.get("position")||{x:0,y:0};if(n.restrictedArea&&n.translateBy===this.id){var r=this.getBBox({deep:!0}),o=n.restrictedArea,s=i.x-r.x,a=i.y-r.y,l=Math.max(o.x+s,Math.min(o.x+o.width+s-r.width,i.x+t)),c=Math.max(o.y+a,Math.min(o.y+o.height+a-r.height,i.y+e));t=l-i.x,e=c-i.y}var u={x:i.x+t,y:i.y+e};return n.tx=t,n.ty=e,n.transition?(De(n.transition)||(n.transition={}),this.transition("position",u,Jt({},n.transition,{valueFunction:Ht.object})),ee(this.getEmbeddedCells(),"translate",t,e,n)):(this.startBatch("translate",n),this.set("position",u,n),ee(this.getEmbeddedCells(),"translate",t,e,n),this.stopBatch("translate",n)),this},size:function(t,e,n){var i=this.get("size");return void 0===t?{width:i.width,height:i.height}:(De(t)&&(n=e,e=St(t.height)?t.height:i.height,t=St(t.width)?t.width:i.width),this.resize(t,e,n))},resize:function(t,e,n){if(n=n||{},this.startBatch("resize",n),n.direction){var i=this.get("size");switch(n.direction){case"left":case"right":e=i.height;break;case"top":case"bottom":t=i.width}var r=j(this.get("angle")||0),o={"top-right":0,right:0,"top-left":1,top:1,"bottom-left":2,left:2,"bottom-right":3,bottom:3}[n.direction];n.absolute&&(o+=Math.floor((r+45)/90),o%=4);var s=this.getBBox(),a=s[["bottomLeft","corner","topRight","origin"][o]](),l=L(a).rotate(s.center(),-r),c=Math.sqrt(t*t+e*e)/2,u=o*Math.PI/2;u+=Math.atan(o%2==0?e/t:t/e),u-=V(r);var h=L.fromPolar(c,u,l),d=L(h).offset(t/-2,e/-2);this.set("size",{width:t,height:e},n),this.position(d.x,d.y,n)}else this.set("size",{width:t,height:e},n);return this.stopBatch("resize",n),this},scale:function(t,e,n,i){var r=this.getBBox().scale(t,e,n);return this.startBatch("scale",i),this.position(r.x,r.y,i),this.resize(r.width,r.height,i),this.stopBatch("scale"),this},fitEmbeds:function(t){void 0===t&&(t={});var e=this.graph;if(!e)throw new Error("Element must be part of a graph.");var n=this.getEmbeddedCells().filter(function(t){return t.isElement()});if(0===n.length)return this;this.startBatch("fit-embeds",t),t.deep&&ee(n,"fitEmbeds",t);var i=Ft(t.padding),r=i.left,o=i.right,s=i.top,a=i.bottom,l=e.getCellsBBox(n),c=l.x,u=l.y,h=l.width,d=l.height;return c-=r,u-=s,h+=r+o,d+=a+s,this.set({position:{x:c,y:u},size:{width:h,height:d}},t),this.stopBatch("fit-embeds"),this},rotate:function(t,e,n,i){if(n){var r=this.getBBox().center(),o=this.get("size"),s=this.get("position");r.rotate(n,this.get("angle")-t);var a=r.x-o.width/2-s.x,l=r.y-o.height/2-s.y;this.startBatch("rotate",{angle:t,absolute:e,origin:n}),this.position(s.x+a,s.y+l,i),this.rotate(t,e,null,i),this.stopBatch("rotate")}else this.set("angle",e?t:(this.get("angle")+t)%360,i);return this},angle:function(){return j(this.get("angle")||0)},getBBox:function(t){if((t=t||{}).deep&&this.graph){var e=this.getEmbeddedCells({deep:!0,breadthFirst:!0});return e.push(this),this.graph.getCellsBBox(e)}var n=this.get("position"),i=this.get("size");return new B(n.x,n.y,i.width,i.height)},getPointFromConnectedLink:function(t,e){var n=this.getBBox(),i=n.center(),r=t.get(e);if(!r)return i;var o=r.port;if(!o)return i;var s=this.portProp(o,["group"]),a=this.getPortsPositions(s),l=new L(a[o]).offset(n.origin()),c=this.angle();return c&&l.rotate(i,-c),l}});Jt(un.prototype,ln);var hn={},dn=e.View.extend({options:{},theme:null,themeClassNamePrefix:lt("theme-"),requireSetThemeOverride:!1,defaultTheme:Pt.defaultTheme,children:null,childNodes:null,UPDATE_PRIORITY:2,constructor:function(t){this.requireSetThemeOverride=t&&!!t.theme,this.options=Jt({},this.options,t),e.View.call(this,t)},initialize:function(){(hn[this.cid]=this).setTheme(this.options.theme||this.defaultTheme),this.init()},unmount:function(){this.svgElement?this.vel.remove():this.$el.remove()},renderChildren:function(t){if(t=t||Ce(this,"children")){var e=this.svgElement,n=ut(t,Mt.namespace[e?"svg":"xhtml"]);(e?this.vel:this.$el).empty().append(n.fragment),this.childNodes=n.selectors}return this},findAttribute:function(t,e){for(var n=e;n&&1===n.nodeType;){var i=n.getAttribute(t);if(i)return i;if(n===this.el)return null;n=n.parentNode}return null},_ensureElement:function(){if(this.el)this.setElement(Ce(this,"el"));else{var t=Ce(this,"tagName"),e=Jt({},Ce(this,"attributes")),n=Jt({},Ce(this,"style"));this.id&&(e.id=Ce(this,"id")),this.setElement(this._createElement(t)),this._setAttributes(e),this._setStyle(n)}this._ensureElClassName()},_setAttributes:function(t){this.svgElement?this.vel.attr(t):this.$el.attr(t)},_setStyle:function(t){this.$el.css(t)},_createElement:function(t){return this.svgElement?document.createElementNS(Mt.namespace.svg,t):document.createElement(t)},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],this.svgElement&&(this.vel=Mt(this.el))},_ensureElClassName:function(){var t=Ce(this,"className");if(t){var e=lt(t);this.svgElement?this.vel.removeClass(t).addClass(e):this.$el.removeClass(t).addClass(e)}},init:function(){},onRender:function(){},confirmUpdate:function(){return 0},setTheme:function(t,e){return e=e||{},this.theme&&this.requireSetThemeOverride&&!e.override||(this.removeThemeClassName(),this.addThemeClassName(t),this.onSetTheme(this.theme,t),this.theme=t),this},addThemeClassName:function(t){t=t||this.theme;var e=this.themeClassNamePrefix+t;return this.svgElement?this.vel.addClass(e):this.$el.addClass(e),this},removeThemeClassName:function(t){t=t||this.theme;var e=this.themeClassNamePrefix+t;return this.svgElement?this.vel.removeClass(e):this.$el.removeClass(e),this},onSetTheme:function(t,e){},remove:function(){return this.onRemove(),this.undelegateDocumentEvents(),hn[this.cid]=null,e.View.prototype.remove.apply(this,arguments),this},onRemove:function(){},getEventNamespace:function(){return".joint-event-ns-"+this.cid},delegateElementEvents:function(t,e,n){if(!e)return this;n=n||{};var r=this.getEventNamespace();for(var o in e){var s=e[o];"function"!=typeof s&&(s=this[s]),s&&i(t).on(o+r,n,s.bind(this))}return this},undelegateElementEvents:function(t){return i(t).off(this.getEventNamespace()),this},delegateDocumentEvents:function(t,e){return t=t||Ce(this,"documentEvents"),this.delegateElementEvents(document,t,e)},undelegateDocumentEvents:function(){return this.undelegateElementEvents(document)},eventData:function(t,e){if(!t)throw new Error("eventData(): event object required.");var n=t.data,i="__"+this.cid+"__";return void 0===e?n&&n[i]||{}:((n=n||(t.data={}))[i]||(n[i]={}),Jt(n[i],e),this)},stopPropagation:function(t){return this.eventData(t,{propagationStopped:!0}),this},isPropagationStopped:function(t){return!!this.eventData(t).propagationStopped}},{extend:function(){var t=Array.from(arguments),n=t[0]&&Jt({},t[0])||{},i=t[1]&&Jt({},t[1])||{},r=n.render||this.prototype&&this.prototype.render||null;return n.render=function(){return"function"==typeof r&&r.apply(this,arguments),this.render.__render__===r&&this.onRender(),this},n.render.__render__=r,e.View.extend.call(this,n,i)}}),fn={views:hn,View:dn},pn=dn.extend({tagName:"g",svgElement:!0,selector:"root",metrics:null,className:function(){var t=["cell"],e=this.model.get("type");return e&&e.toLowerCase().split(".").forEach(function(e,n,i){t.push("type-"+i.slice(0,n+1).join("-"))}),t.join(" ")},_presentationAttributes:null,_flags:null,setFlags:function(){var t,e,n,i={},r={},o=0,s=this.presentationAttributes;for(var a in s)if(s.hasOwnProperty(a)){var l=s[a];for(Array.isArray(l)||(l=[l]),t=0,e=l.length;t<e;t++){var c=i[n=l[t]];c=c||(i[n]=1<<o++),r[a]|=c}}var u=this.initFlag;for(Array.isArray(u)||(u=[u]),t=0,e=u.length;t<e;t++)i[n=u[t]]||(i[n]=1<<o++);if(25<o)throw new Error("dia.CellView: Maximum number of flags exceeded.");this._flags=i,this._presentationAttributes=r},hasFlag:function(t,e){return t&this.getFlag(e)},removeFlag:function(t,e){return t^t&this.getFlag(e)},getFlag:function(t){var e=this._flags;if(!e)return 0;var n=0;if(Array.isArray(t))for(var i=0,r=t.length;i<r;i++)n|=e[t[i]];else n|=e[t];return n},attributes:function(){var t=this.model;return{"model-id":t.id,"data-type":t.attributes.type}},constructor:function(t){t.id=t.id||Kt(this),dn.call(this,t)},initialize:function(){this.setFlags(),dn.prototype.initialize.apply(this,arguments),this.cleanNodesCache(),this.$el.data("view",this),this.startListening()},startListening:function(){this.listenTo(this.model,"change",this.onAttributesChange)},onAttributesChange:function(t,e){var n=t.getChangeFlag(this._presentationAttributes);if(!e.updateHandled&&n){e.dirty&&this.hasFlag(n,"UPDATE")&&(n|=this.getFlag("RENDER")),e.tool&&(e.async=!1);var i=this.paper;i&&i.requestViewUpdate(this,n,this.UPDATE_PRIORITY,e)}},parseDOMJSON:function(t,e){var n=ut(t),i=n.selectors,r=n.groupSelectors;for(var o in r){if(i[o])throw new Error("dia.CellView: ambiguous group selector");i[o]=r[o]}if(e){var s=this.selector;if(i[s])throw new Error("dia.CellView: ambiguous root selector.");i[s]=e}return{fragment:n.fragment,selectors:i}},can:function(t){var e=le(this.options.interactive)?this.options.interactive(this):this.options.interactive;return De(e)&&!1!==e[t]||Ot(e)&&!1!==e},findBySelector:function(t,e,n){if(e=e||this.el,n=n||this.selectors,!t||"."===t)return[e];if(n){var r=n[t];if(r)return Array.isArray(r)?r:[r]}return Pt.useCSSSelectors?i(e).find(t).toArray():[]},notify:function(t){if(this.paper){var e=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t].concat(e)),this.paper.trigger.apply(this.paper,[t,this].concat(e))}},getBBox:function(t){var e;if(t&&t.useModelGeometry){var n=this.model;e=n.getBBox().bbox(n.angle())}else e=this.getNodeBBox(this.el);return this.paper.localToPaperRect(e)},getNodeBBox:function(t){var e=this.getNodeBoundingRect(t),n=this.getNodeMatrix(t),i=this.getRootTranslateMatrix(),r=this.getRootRotateMatrix();return Mt.transformRect(e,i.multiply(r).multiply(n))},getNodeUnrotatedBBox:function(t){var e=this.getNodeBoundingRect(t),n=this.getNodeMatrix(t),i=this.getRootTranslateMatrix();return Mt.transformRect(e,i.multiply(n))},getRootTranslateMatrix:function(){var t=this.model.position();return Mt.createSVGMatrix().translate(t.x,t.y)},getRootRotateMatrix:function(){var t=Mt.createSVGMatrix(),e=this.model,n=e.angle();if(n){var i=e.getBBox(),r=i.width/2,o=i.height/2;t=t.translate(r,o).rotate(n).translate(-r,-o)}return t},highlight:function(t,e){return t=t&&this.$(t)[0]||this.el,(e=e||{}).partial=t!==this.el,this.notify("cell:highlight",t,e),this},unhighlight:function(t,e){return t=t&&this.$(t)[0]||this.el,(e=e||{}).partial=t!=this.el,this.notify("cell:unhighlight",t,e),this},findMagnet:function(t){var e=this.$(t),n=this.$el;0===e.length&&(e=n);do{var i=e.attr("magnet");if((i||e.is(n))&&"false"!==i)return e[0];e=e.parent()}while(0<e.length)},getSelector:function(t,e){var n;if(t===this.el)return"string"==typeof e&&(n="> "+e),n;if(t){var i=Mt(t).index()+1;n=t.tagName+":nth-child("+i+")",e&&(n+=" > "+e),n=this.getSelector(t.parentNode,n)}return n},getLinkEnd:function(t,e,n,i,r){var o=this.model,s=o.id,a=this.findAttribute("port",t),l=t.getAttribute("joint-selector"),c={id:s};null!=l&&(c.magnet=l),null!=a?(c.port=a,o.hasPort(a)||l||(c.selector=this.getSelector(t))):null==l&&this.el!==t&&(c.selector=this.getSelector(t));var u=this.paper,h=u.options.connectionStrategy;if("function"==typeof h){var d=h.call(u,c,this,t,new L(e,n),i,r,u);d&&(c=d)}return c},getMagnetFromLinkEnd:function(t){var e=this.el,n=t.port,i=t.magnet,r=this.model;return null!=n&&r.isElement()&&r.hasPort(n)?this.findPortNode(n,i)||e:((i=i||t.selector)||null==n||(i='[port="'+n+'"]'),this.findBySelector(i,e,this.selectors)[0])},getAttributeDefinition:function(t){return this.model.constructor.getAttributeDefinition(t)},setNodeAttributes:function(t,e){se(e)||(t instanceof SVGElement?Mt(t).attr(e):i(t).attr(e))},processNodeAttributes:function(t,e){var n,i,r,o,s,a,l,c,u,h=[];for(n in e)e.hasOwnProperty(n)&&(i=e[n],!(r=this.getAttributeDefinition(n))||le(r.qualify)&&!r.qualify.call(this,i,t,e)?(a=a||{})[mt(n)]=i:(Ae(r.set)&&((a=a||{})[r.set]=i),null!==i&&h.push(n,r)));for(o=0,s=h.length;o<s;o+=2)n=h[o],r=h[o+1],i=e[n],le(r.set)&&((l=l||{})[n]=i),le(r.position)&&((c=c||{})[n]=i),le(r.offset)&&((u=u||{})[n]=i);return{raw:e,normal:a,set:l,position:c,offset:u}},updateRelativeAttributes:function(t,e,n,i){var r,o;i=i||{};var s=e.raw||{},a=e.normal||{},l=e.set,c=e.position,u=e.offset;for(r in l){o=l[r];var h=this.getAttributeDefinition(r).set.call(this,o,n.clone(),t,s);De(h)?Jt(a,h):void 0!==h&&(a[r]=h)}if(t instanceof HTMLElement)this.setNodeAttributes(t,a);else{var d,f,p,g=a.transform,m=Mt.transformStringToMatrix(g),v=L(m.e,m.f);if(g&&(a=Ie(a,"transform"),m.e=m.f=0),c||u){var y=this.getNodeScale(t,i.scalableNode);d=y.sx,f=y.sy}var b=!1;for(r in c)o=c[r],(p=this.getAttributeDefinition(r).position.call(this,o,n.clone(),t,s))&&(v.offset(L(p).scale(d,f)),b=b||!0);this.setNodeAttributes(t,a);var C=!1;if(u){var I=this.getNodeBoundingRect(t);if(0<I.width&&0<I.height){var E=Mt.transformRect(I,m).scale(1/d,1/f);for(r in u)o=u[r],(p=this.getAttributeDefinition(r).offset.call(this,o,E,t,s))&&(v.offset(L(p).scale(d,f)),C=C||!0)}}(void 0!==g||b||C)&&(v.round(1),m.e=v.x,m.f=v.y,t.setAttribute("transform",Mt.matrixToTransformString(m)))}},getNodeScale:function(t,e){var n,i;if(e&&e.contains(t)){var r=e.scale();n=1/r.sx,i=1/r.sy}else i=n=1;return{sx:n,sy:i}},cleanNodesCache:function(){this.metrics={}},nodeCache:function(t){var e=this.metrics;if(!e)return{};var n=Mt.ensureId(t),i=e[n];return i||(e[n]={})},getNodeData:function(t){var e=this.nodeCache(t);return e.data||(e.data={}),e.data},getNodeBoundingRect:function(t){var e=this.nodeCache(t);return void 0===e.boundingRect&&(e.boundingRect=Mt(t).getBBox()),new B(e.boundingRect)},getNodeMatrix:function(t){var e=this.nodeCache(t);if(void 0===e.magnetMatrix){var n=this.rotatableNode||this.el;e.magnetMatrix=Mt(t).getTransformToElement(n)}return Mt.createSVGMatrix(e.magnetMatrix)},getNodeShape:function(t){var e=this.nodeCache(t);return void 0===e.geometryShape&&(e.geometryShape=Mt(t).toGeometryShape()),e.geometryShape.clone()},isNodeConnection:function(t){return this.model.isLink()&&(!t||t===this.el)},findNodesAttributes:function(t,e,n,i){var r,o,s,a,l={},c=[];for(var u in t)if(t.hasOwnProperty(u)&&(s=t[u],ce(s))){var h=n[u]=this.findBySelector(u,e,i);for(r=0,o=h.length;r<o;r++){var d=h[r];a=Mt.ensureId(d);var f=i&&i[u]===d,p=l[a];if(p){p.array||(c.push(a),p.array=!0,p.attributes=[p.attributes],p.selectedLength=[p.selectedLength]);var g=p.attributes,m=p.selectedLength;if(f)g.unshift(s),m.unshift(-1);else{var v=ne(m,o);g.splice(v,0,s),m.splice(v,0,o)}}else l[a]={attributes:s,selectedLength:f?-1:o,node:d,array:!1}}}for(r=0,o=c.length;r<o;r++)(s=l[a=c[r]]).attributes=At.apply(void 0,[{}].concat(s.attributes.reverse()));return l},getEventTarget:function(t,e){void 0===e&&(e={});var n=t.target,i=t.type,r=t.clientX;void 0===r&&(r=0);var o=t.clientY;return void 0===o&&(o=0),e.fromPoint||"touchmove"===i||"touchend"===i?document.elementFromPoint(r,o):n},updateDOMSubtreeAttributes:function(t,e,n){(n=n||{}).rootBBox||(n.rootBBox=B()),n.selectors||(n.selectors=this.selectors);var i,r,o,s,a,l,c={},u={},h=[],d=n.roAttributes,f=this.findNodesAttributes(d||e,t,c,n.selectors),p=d?this.findNodesAttributes(e,t,c,n.selectors):f;for(var g in f)if(o=(s=f[g]).attributes,r=s.node,(a=this.processNodeAttributes(r,o)).set||a.position||a.offset){var m,v=p[g]&&p[g].attributes,y=v&&void 0===o.ref?v.ref:o.ref;if(y){if(!(m=(c[y]||this.findBySelector(y,t,n.selectors))[0]))throw new Error('dia.ElementView: "'+y+'" reference does not exist.')}else m=null;i={node:r,refNode:m,processedAttributes:a,allAttributes:v};var b=h.findIndex(function(t){return t.refNode===r});-1<b?h.splice(b,0,i):h.push(i)}else this.setNodeAttributes(r,a.normal);for(var C=0,I=h.length;C<I;C++){i=h[C],r=i.node,m=i.refNode;var E=Mt(n.rotatableNode),T=m?Mt.ensureId(m):"",w=!!E&&!!m&&E.contains(m),x=u[T];if(!x){var _=w?E:t;x=u[T]=m?Mt(m).getBBox({target:_}):n.rootBBox}d?(a=this.processNodeAttributes(r,i.allAttributes),this.mergeProcessedAttributes(a,i.processedAttributes)):a=i.processedAttributes;var D=x;w&&!E.contains(r)&&(l=l||Mt.transformStringToMatrix(E.attr("transform")),D=Mt.transformRect(x,l)),this.updateRelativeAttributes(r,a,D,n)}},mergeProcessedAttributes:function(t,e){t.set||(t.set={}),t.position||(t.position={}),t.offset||(t.offset={}),Jt(t.set,e.set),Jt(t.position,e.position),Jt(t.offset,e.offset);var n=t.normal&&t.normal.transform;void 0!==n&&e.normal&&(e.normal.transform=n),t.normal=e.normal},onRemove:function(){this.removeTools()},_toolsView:null,hasTools:function(t){var e=this._toolsView;return!(!e||t&&e.getName()!==t)},addTools:function(t){return this.removeTools(),t&&((this._toolsView=t).configure({relatedView:this}),t.listenTo(this.paper,"tools:event",this.onToolEvent.bind(this)),t.mount()),this},updateTools:function(t){var e=this._toolsView;return e&&e.update(t),this},removeTools:function(){var t=this._toolsView;return t&&(t.remove(),this._toolsView=null),this},hideTools:function(){var t=this._toolsView;return t&&t.hide(),this},showTools:function(){var t=this._toolsView;return t&&t.show(),this},onToolEvent:function(t){switch(t){case"remove":this.removeTools();break;case"hide":this.hideTools();break;case"show":this.showTools()}},pointerdblclick:function(t,e,n){this.notify("cell:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){this.notify("cell:pointerclick",t,e,n)},contextmenu:function(t,e,n){this.notify("cell:contextmenu",t,e,n)},pointerdown:function(t,e,n){this.model.graph&&(this.model.startBatch("pointer"),this._graph=this.model.graph),this.notify("cell:pointerdown",t,e,n)},pointermove:function(t,e,n){this.notify("cell:pointermove",t,e,n)},pointerup:function(t,e,n){this.notify("cell:pointerup",t,e,n),this._graph&&(this._graph.stopBatch("pointer",{cell:this.model}),delete this._graph)},mouseover:function(t){this.notify("cell:mouseover",t)},mouseout:function(t){this.notify("cell:mouseout",t)},mouseenter:function(t){this.notify("cell:mouseenter",t)},mouseleave:function(t){this.notify("cell:mouseleave",t)},mousewheel:function(t,e,n,i){this.notify("cell:mousewheel",t,e,n,i)},onevent:function(t,e,n,i){this.notify(e,t,n,i)},onmagnet:function(){},magnetpointerdblclick:function(){},magnetcontextmenu:function(){},checkMouseleave:function(t){var e=this.paper;e.isAsync()&&e.dumpView(this);var n=this.getEventTarget(t,{fromPoint:!0}),i=e.findView(n);i!==this&&(this.mouseleave(t),i&&i.mouseenter(t))},setInteractivity:function(t){this.options.interactive=t}},{addPresentationAttributes:function(t){return At({},this.prototype.presentationAttributes,t,function(t,e){if(t&&e)return"string"==typeof t&&(t=[t]),"string"==typeof e&&(e=[e]),Array.isArray(t)&&Array.isArray(e)?ie(t.concat(e)):void 0})}}),gn=pn.extend({_removePorts:function(){},_renderPorts:function(){},className:function(){var t=pn.prototype.className.apply(this).split(" ");return t.push("element"),t.join(" ")},initialize:function(){pn.prototype.initialize.apply(this,arguments),this._initializePorts()},presentationAttributes:{attrs:["UPDATE"],position:["TRANSLATE","TOOLS"],size:["RESIZE","PORTS","TOOLS"],angle:["ROTATE","TOOLS"],markup:["RENDER"],ports:["PORTS"]},initFlag:["RENDER"],UPDATE_PRIORITY:0,confirmUpdate:function(t,e){var n=Pt.useCSSSelectors;return this.hasFlag(t,"PORTS")&&(this._removePorts(),this._cleanPortsCache()),this.hasFlag(t,"RENDER")?(this.render(),this.updateTools(e),t=this.removeFlag(t,["RENDER","UPDATE","RESIZE","TRANSLATE","ROTATE","PORTS"])):(this.hasFlag(t,"RESIZE")&&(this.resize(e),t=this.removeFlag(t,["RESIZE","UPDATE"])),this.hasFlag(t,"UPDATE")&&(this.update(this.model,null,e),t=this.removeFlag(t,"UPDATE"),n&&(t=this.removeFlag(t,"PORTS"))),this.hasFlag(t,"TRANSLATE")&&(this.translate(),t=this.removeFlag(t,"TRANSLATE")),this.hasFlag(t,"ROTATE")&&(this.rotate(),t=this.removeFlag(t,"ROTATE")),this.hasFlag(t,"PORTS")&&(this._renderPorts(),t=this.removeFlag(t,"PORTS"))),this.hasFlag(t,"TOOLS")&&(this.updateTools(e),t=this.removeFlag(t,"TOOLS")),t},_initializePorts:function(){},update:function(t,e){this.cleanNodesCache();var n=Pt.useCSSSelectors;n&&this._removePorts();var i=this.model,r=i.attr();this.updateDOMSubtreeAttributes(this.el,r,{rootBBox:new B(i.size()),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode,roAttributes:e===r?null:e}),n&&this._renderPorts()},rotatableSelector:"rotatable",scalableSelector:"scalable",scalableNode:null,rotatableNode:null,renderMarkup:function(){var t=this.model,e=t.get("markup")||t.markup;if(!e)throw new Error("dia.ElementView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if("string"==typeof e)return this.renderStringMarkup(e);throw new Error("dia.ElementView: invalid markup")},renderJSONMarkup:function(t){var e=this.parseDOMJSON(t,this.el),n=this.selectors=e.selectors;this.rotatableNode=Mt(n[this.rotatableSelector])||null,this.scalableNode=Mt(n[this.scalableSelector])||null,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=this.vel;e.append(Mt(t)),this.rotatableNode=e.findOne(".rotatable"),this.scalableNode=e.findOne(".scalable"),(this.selectors={})[this.selector]=this.el},render:function(){return this.vel.empty(),this.renderMarkup(),this.scalableNode&&this.update(),this.resize(),this.rotatableNode?(this.rotate(),this.translate()):this.updateTransformation(),Pt.useCSSSelectors||this._renderPorts(),this},resize:function(t){if(this.scalableNode)return this.sgResize(t);this.model.attributes.angle&&this.rotate(),this.update()},translate:function(){if(this.rotatableNode)return this.rgTranslate();this.updateTransformation()},rotate:function(){if(this.rotatableNode)return this.rgRotate(),void this.update();this.updateTransformation()},updateTransformation:function(){var t=this.getTranslateString(),e=this.getRotateString();e&&(t+=" "+e),this.vel.attr("transform",t)},getTranslateString:function(){var t=this.model.attributes.position;return"translate("+t.x+","+t.y+")"},getRotateString:function(){var t=this.model.attributes,e=t.angle;if(!e)return null;var n=t.size;return"rotate("+e+","+n.width/2+","+n.height/2+")"},rgRotate:function(){this.rotatableNode.attr("transform",this.getRotateString())},rgTranslate:function(){this.vel.attr("transform",this.getTranslateString())},sgResize:function(t){var e=this.model,n=e.angle(),i=e.size(),r=this.scalableNode,o=!1;0<r.node.getElementsByTagName("path").length&&(o=!0);var s=r.getBBox({recursive:o}),a=i.width/(s.width||1),l=i.height/(s.height||1);r.attr("transform","scale("+a+","+l+")");var c=this.rotatableNode,u=c&&c.attr("transform");if(u){c.attr("transform",u+" rotate("+-n+","+i.width/2+","+i.height/2+")");var h=r.getBBox({target:this.paper.cells});e.set("position",{x:h.x,y:h.y},Jt({updateHandled:!0},t)),this.translate(),this.rotate()}this.update()},prepareEmbedding:function(t){var e=(t=t||{}).model||this.model,n=(t.paper||this.paper).model;e.startBatch("to-front"),e.toFront({deep:!0,ui:!0});var i=n.getElements().reduce(function(t,e){return Math.max(t,e.attributes.z||0)},0);n.getConnectedLinks(e,{deep:!0,includeEnclosed:!0}).forEach(function(t){t.attributes.z<=i&&t.set("z",i+1,{ui:!0})}),e.stopBatch("to-front");var r=e.parent();r&&n.getCell(r).unembed(e,{ui:!0})},processEmbedding:function(t){var e=(t=t||{}).model||this.model,n=t.paper||this.paper,i=n.options,r=[];r=le(i.findParentBy)?ue(i.findParentBy.call(n.model,this)).filter((function(t){return t instanceof Ze&&this.model.id!==t.id&&!t.isEmbeddedIn(this.model)}).bind(this)):n.model.findModelsUnderElement(e,{searchBy:i.findParentBy}),i.frontParentOnly&&(r=r.slice(-1));for(var o=null,s=t.candidateEmbedView,a=r.length-1;0<=a;a--){var l=r[a];if(s&&s.model.id==l.id){o=s;break}var c=l.findView(n);if(i.validateEmbedding.call(n,this,c)){o=c;break}}o&&o!=s&&(this.clearEmbedding(t),t.candidateEmbedView=o.highlight(null,{embedding:!0})),!o&&s&&this.clearEmbedding(t)},clearEmbedding:function(t){var e=(t=t||{}).candidateEmbedView;e&&(e.unhighlight(null,{embedding:!0}),t.candidateEmbedView=null)},finalizeEmbedding:function(t){var e=(t=t||{}).candidateEmbedView,n=t.model||this.model,i=t.paper||this.paper;e&&(e.model.embed(n,{ui:!0}),e.unhighlight(null,{embedding:!0}),t.candidateEmbedView=null),ee(i.model.getConnectedLinks(n,{deep:!0}),"reparent",{ui:!0})},getDelegatedView:function(){for(var t=this,e=t.model,n=t.paper;t&&!e.isLink();){if(!e.isEmbedded()||t.can("stopDelegation"))return t;e=e.getParentCell(),t=n.findViewByModel(e)}return null},notifyPointerdown:function(t,e,n){pn.prototype.pointerdown.call(this,t,e,n),this.notify("element:pointerdown",t,e,n)},notifyPointermove:function(t,e,n){pn.prototype.pointermove.call(this,t,e,n),this.notify("element:pointermove",t,e,n)},notifyPointerup:function(t,e,n){this.notify("element:pointerup",t,e,n),pn.prototype.pointerup.call(this,t,e,n)},pointerdblclick:function(t,e,n){pn.prototype.pointerdblclick.apply(this,arguments),this.notify("element:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){pn.prototype.pointerclick.apply(this,arguments),this.notify("element:pointerclick",t,e,n)},contextmenu:function(t,e,n){pn.prototype.contextmenu.apply(this,arguments),this.notify("element:contextmenu",t,e,n)},pointerdown:function(t,e,n){this.isPropagationStopped(t)||(this.notifyPointerdown(t,e,n),this.dragStart(t,e,n))},pointermove:function(t,e,n){var i=this.eventData(t);switch(i.action){case"magnet":this.dragMagnet(t,e,n);break;case"move":(i.delegatedView||this).drag(t,e,n);default:this.notifyPointermove(t,e,n)}this.eventData(t,i)},pointerup:function(t,e,n){var i=this.eventData(t);switch(i.action){case"magnet":this.dragMagnetEnd(t,e,n);break;case"move":(i.delegatedView||this).dragEnd(t,e,n);default:this.notifyPointerup(t,e,n)}var r=i.targetMagnet;r&&this.magnetpointerclick(t,r,e,n),this.checkMouseleave(t)},mouseover:function(t){pn.prototype.mouseover.apply(this,arguments),this.notify("element:mouseover",t)},mouseout:function(t){pn.prototype.mouseout.apply(this,arguments),this.notify("element:mouseout",t)},mouseenter:function(t){pn.prototype.mouseenter.apply(this,arguments),this.notify("element:mouseenter",t)},mouseleave:function(t){pn.prototype.mouseleave.apply(this,arguments),this.notify("element:mouseleave",t)},mousewheel:function(t,e,n,i){pn.prototype.mousewheel.apply(this,arguments),this.notify("element:mousewheel",t,e,n,i)},onmagnet:function(t,e,n){this.dragMagnetStart(t,e,n)},magnetpointerdblclick:function(t,e,n,i){this.notify("element:magnet:pointerdblclick",t,e,n,i)},magnetcontextmenu:function(t,e,n,i){this.notify("element:magnet:contextmenu",t,e,n,i)},dragStart:function(t,e,n){var i=this.getDelegatedView();i&&i.can("elementMove")&&(this.eventData(t,{action:"move",delegatedView:i}),i.eventData(t,{pointerOffset:i.model.position().difference(e,n),restrictedArea:this.paper.getRestrictedArea(i)}))},dragMagnetStart:function(t,e,n){if(this.can("addLinkFromMagnet")){var i=t.currentTarget,r=this.paper;this.eventData(t,{targetMagnet:i}),t.stopPropagation(),r.options.validateMagnet(this,i,t)?(r.options.magnetThreshold<=0&&this.dragLinkStart(t,i,e,n),this.eventData(t,{action:"magnet"}),this.stopPropagation(t)):this.pointerdown(t,e,n),r.delegateDragEvents(this,t.data)}},dragLinkStart:function(t,e,n,i){this.model.startBatch("add-link");var r=this.addLinkFromMagnet(e,n,i);r.notifyPointerdown(t,n,i),r.eventData(t,r.startArrowheadMove("target",{whenNotAllowed:"remove"})),this.eventData(t,{linkView:r})},addLinkFromMagnet:function(t,e,n){var i=this.paper,r=i.model,o=i.getDefaultLink(this,t);return o.set({source:this.getLinkEnd(t,e,n,o,"source"),target:{x:e,y:n}}).addTo(r,{async:!1,ui:!0}),o.findView(i)},drag:function(t,e,n){var i=this.paper,r=i.options.gridSize,o=this.model,s=this.eventData(t),a=s.pointerOffset,l=s.restrictedArea,c=s.embedding,u=G(e+a.x,r),h=G(n+a.y,r);o.position(u,h,{restrictedArea:l,deep:!0,ui:!0}),i.options.embeddingMode&&(c||(this.prepareEmbedding(s),c=!0),this.processEmbedding(s)),this.eventData(t,{embedding:c})},dragMagnet:function(t,e,n){var i=this.eventData(t),r=i.linkView;if(r)r.pointermove(t,e,n);else{var o=this.paper,s=o.options.magnetThreshold,a=this.getEventTarget(t),l=i.targetMagnet;if("onleave"===s){if(l===a||Mt(l).contains(a))return}else if(o.eventData(t).mousemoved<=s)return;this.dragLinkStart(t,l,e,n)}},dragEnd:function(t,e,n){var i=this.eventData(t);i.embedding&&this.finalizeEmbedding(i)},dragMagnetEnd:function(t,e,n){var i=this.eventData(t).linkView;i&&(i.pointerup(t,e,n),this.model.stopBatch("add-link"))},magnetpointerclick:function(t,e,n,i){var r=this.paper;r.eventData(t).mousemoved>r.options.clickThreshold||this.notify("element:magnet:pointerclick",t,e,n,i)}});Jt(gn.prototype,cn);var mn={_results:{},_tests:{svgforeignobject:function(){return!!document.createElementNS&&/SVGForeignObject/.test({}.toString.call(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")))}},addTest:function(t,e){return this._tests[t]=e},test:function(t){var e=this._tests[t];if(!e)throw new Error('Test not defined ("'+t+'"). Use `joint.env.addTest(name, fn) to add a new test.`');var n=this._results[t];if(void 0!==n)return n;try{n=e()}catch(t){n=!1}return this._results[t]=n}},vn=un.define("basic.Generic",{attrs:{".":{fill:"#ffffff",stroke:"none"}}}),yn=vn.define("basic.Rect",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:100,height:60},text:{fill:"#000000",text:"","font-size":14,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><rect/></g><text/></g>'}),bn=gn.extend({presentationAttributes:gn.addPresentationAttributes({attrs:["SCALE"]}),confirmUpdate:function(){var t=gn.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"SCALE")&&(this.resize(),t=this.removeFlag(t,"SCALE")),t}}),Cn=vn.define("basic.Text",{attrs:{text:{"font-size":18,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><text/></g></g>'}),In=vn.define("basic.Circle",{size:{width:60,height:60},attrs:{circle:{fill:"#ffffff",stroke:"#000000",r:30,cx:30,cy:30},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g><text/></g>'}),En=vn.define("basic.Ellipse",{size:{width:60,height:40},attrs:{ellipse:{fill:"#ffffff",stroke:"#000000",rx:30,ry:20,cx:30,cy:20},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse/></g><text/></g>'}),Tn=vn.define("basic.Polygon",{size:{width:60,height:40},attrs:{polygon:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'}),wn=vn.define("basic.Polyline",{size:{width:60,height:40},attrs:{polyline:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polyline/></g><text/></g>'}),xn=vn.define("basic.Image",{attrs:{text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><image/></g><text/></g>'}),_n=vn.define("basic.Path",{size:{width:60,height:60},attrs:{path:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle",ref:"path","ref-x":.5,"ref-dy":10,fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><path/></g><text/></g>'}),Dn=_n.define("basic.Rhombus",{attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5,"ref-dy":null,"y-alignment":"middle"}}}),An=mn.test("svgforeignobject"),On=vn.define("basic.TextBlock",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000","font-size":14,"font-family":"Arial, helvetica, sans-serif"},".content":{text:"","ref-x":.5,"ref-y":.5,"y-alignment":"middle","x-alignment":"middle"}},content:""},{markup:['<g class="rotatable">','<g class="scalable"><rect/></g>',An?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>',"</g>"].join(""),initialize:function(){this.listenTo(this,"change:size",this.updateSize),this.listenTo(this,"change:content",this.updateContent),this.updateSize(this,this.get("size")),this.updateContent(this,this.get("content")),vn.prototype.initialize.apply(this,arguments)},updateSize:function(t,e){this.attr({".fobj":Jt({},e),div:{style:Jt({},e)}})},updateContent:function(t,e){An?this.attr({".content":{html:Ct(e)}}):this.attr({".content":{text:e}})},setForeignObjectSize:function(){this.updateSize.apply(this,arguments)},setDivContent:function(){this.updateContent.apply(this,arguments)}}),Sn=gn.extend({presentationAttributes:An?gn.prototype.presentationAttributes:gn.addPresentationAttributes({content:["CONTENT"],size:["CONTENT"]}),initFlag:["RENDER","CONTENT"],confirmUpdate:function(){var t=gn.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"CONTENT")&&(this.updateContent(this.model),t=this.removeFlag(t,"CONTENT")),t},update:function(t,e){var n=this.model;if(An)gn.prototype.update.call(this,n,e);else{var i=Ie(e||n.get("attrs"),".content");gn.prototype.update.call(this,n,i),e&&!be(e,".content")||this.updateContent(n,e)}},updateContent:function(t,e){var n=At({},(e||t.get("attrs"))[".content"]);n=Ie(n,"text");var i=bt(t.get("content"),t.get("size"),n,{svgDocument:this.paper.svg}),r=ft({},".content",n,"/");r[".content"].text=i,gn.prototype.update.call(this,t,r)}}),Rn={Generic:vn,Rect:yn,TextView:bn,Text:Cn,Circle:In,Ellipse:En,Polygon:Tn,Polyline:wn,Image:xn,Path:_n,Rhombus:Dn,TextBlock:On,TextBlockView:Sn},kn=Ze.extend({markup:['<path class="connection" stroke="black" d="M 0 0 0 0"/>','<path class="marker-source" fill="black" stroke="black" d="M 0 0 0 0"/>','<path class="marker-target" fill="black" stroke="black" d="M 0 0 0 0"/>','<path class="connection-wrap" d="M 0 0 0 0"/>','<g class="labels"/>','<g class="marker-vertices"/>','<g class="marker-arrowheads"/>','<g class="link-tools"/>'].join(""),toolMarkup:['<g class="link-tool">','<g class="tool-remove" event="remove">','<circle r="11" />','<path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z" />',"<title>Remove link.</title>","</g>",'<g class="tool-options" event="link:options">','<circle r="11" transform="translate(25)"/>','<path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>',"<title>Link options.</title>","</g>","</g>"].join(""),doubleToolMarkup:void 0,vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>"].join(""),arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<path class="marker-arrowhead" end="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />',"</g>"].join(""),defaultLabel:void 0,labelMarkup:void 0,_builtins:{defaultLabel:{markup:[{tagName:"rect",selector:"rect"},{tagName:"text",selector:"text"}],attrs:{text:{fill:"#000000",fontSize:14,textAnchor:"middle",yAlignment:"middle",pointerEvents:"none"},rect:{ref:"text",fill:"#ffffff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}}},defaults:{type:"link",source:{},target:{}},isLink:function(){return!0},disconnect:function(t){return this.set({source:{x:0,y:0},target:{x:0,y:0}},t)},source:function(t,e,n){return void 0===t?re(this.get("source")):(r=t instanceof Ze?((i=re(e)||{}).id=t.id,n):ce(t)?(i=t,e):((i=re(e)||{}).x=t.x,i.y=t.y,n),this.set("source",i,r));var i,r},target:function(t,e,n){return void 0===t?re(this.get("target")):(r=t instanceof Ze?((i=re(e)||{}).id=t.id,n):ce(t)?(i=t,e):((i=re(e)||{}).x=t.x,i.y=t.y,n),this.set("target",i,r));var i,r},router:function(t,e,n){if(void 0===t){var i=this.get("router");return i?"object"==typeof i?re(i):i:this.get("manhattan")?{name:"orthogonal"}:null}var r="object"==typeof t||"function"==typeof t,o=r?t:{name:t,args:e},s=r?e:n;return this.set("router",o,s)},connector:function(t,e,n){if(void 0===t){var i=this.get("connector");return i?"object"==typeof i?re(i):i:this.get("smooth")?{name:"smooth"}:null}var r="object"==typeof t||"function"==typeof t,o=r?t:{name:t,args:e},s=r?e:n;return this.set("connector",o,s)},label:function(t,e,n){var i=this.labels();return(t=isFinite(t)&&null!==t?0|t:0)<0&&(t=i.length+t),arguments.length<=1?this.prop(["labels",t]):this.prop(["labels",t],e,n)},labels:function(t,e){return 0===arguments.length?(t=this.get("labels"),Array.isArray(t)?t.slice():[]):(Array.isArray(t)||(t=[]),this.set("labels",t,e))},insertLabel:function(t,e,n){if(!e)throw new Error("dia.Link: no label provided");var i=this.labels(),r=i.length;return(t=isFinite(t)&&null!==t?0|t:r)<0&&(t=r+t+1),i.splice(t,0,e),this.labels(i,n)},appendLabel:function(t,e){return this.insertLabel(-1,t,e)},removeLabel:function(t,e){var n=this.labels();return t=isFinite(t)&&null!==t?0|t:-1,n.splice(t,1),this.labels(n,e)},vertex:function(t,e,n){var i=this.vertices();if((t=isFinite(t)&&null!==t?0|t:0)<0&&(t=i.length+t),arguments.length<=1)return this.prop(["vertices",t]);var r=this._normalizeVertex(e);return this.prop(["vertices",t],r,n)},vertices:function(t,e){if(0===arguments.length)return t=this.get("vertices"),Array.isArray(t)?t.slice():[];Array.isArray(t)||(t=[]);for(var n=[],i=0;i<t.length;i++){var r=t[i],o=this._normalizeVertex(r);n.push(o)}return this.set("vertices",n,e)},insertVertex:function(t,e,n){if(!e)throw new Error("dia.Link: no vertex provided");var i=this.vertices(),r=i.length;(t=isFinite(t)&&null!==t?0|t:r)<0&&(t=r+t+1);var o=this._normalizeVertex(e);return i.splice(t,0,o),this.vertices(i,n)},removeVertex:function(t,e){var n=this.vertices();return t=isFinite(t)&&null!==t?0|t:-1,n.splice(t,1),this.vertices(n,e)},_normalizeVertex:function(t){return ce(t)?t:{x:t.x,y:t.y}},translate:function(t,e,n){return(n=n||{}).translateBy=n.translateBy||this.id,n.tx=t,n.ty=e,this.applyToPoints(function(n){return{x:(n.x||0)+t,y:(n.y||0)+e}},n)},scale:function(t,e,n,i){return this.applyToPoints(function(i){return L(i).scale(t,e,n).toJSON()},i)},applyToPoints:function(t,e){if(!le(t))throw new TypeError("dia.Link: applyToPoints expects its first parameter to be a function.");var n={},i=this.attributes,r=i.source,o=i.target;r.id||(n.source=t(r)),o.id||(n.target=t(o));var s=this.vertices();return 0<s.length&&(n.vertices=s.map(t)),this.set(n,e)},getSourcePoint:function(){var t=this.getSourceCell();return t?t.getPointFromConnectedLink(this,"source"):new L(this.source())},getTargetPoint:function(){var t=this.getTargetCell();return t?t.getPointFromConnectedLink(this,"target"):new L(this.target())},getPointFromConnectedLink:function(){return this.getPolyline().pointAt(.5)},getPolyline:function(){var t=[this.getSourcePoint(),this.getTargetPoint()],e=this.vertices();return 0<e.length&&Array.prototype.push.apply(t,e.map(L)),new K(t)},getBBox:function(){return this.getPolyline().bbox()},reparent:function(t){var e;if(this.graph){var n=this.getSourceElement(),i=this.getTargetElement(),r=this.getParentCell();n&&i&&(e=n===i||n.isEmbeddedIn(i)?i:i.isEmbeddedIn(n)?n:this.graph.getCommonAncestor(n,i)),!r||e&&e.id===r.id||r.unembed(this,t),e&&e.embed(this,t)}return e},hasLoop:function(t){t=t||{};var e=this.attributes,n=e.source,i=e.target,r=n.id,o=i.id;if(!r||!o)return!1;var s=r===o;if(!s&&t.deep&&this.graph){var a=this.getSourceCell(),l=this.getTargetCell();s=a.isEmbeddedIn(l)||l.isEmbeddedIn(a)}return s},getSourceCell:function(){var t=this.graph,e=this.attributes.source;return e&&e.id&&t&&t.getCell(e.id)||null},getSourceElement:function(){var t=this,e={};do{if(e[t.id])return null;e[t.id]=!0,t=t.getSourceCell()}while(t&&t.isLink());return t},getTargetCell:function(){var t=this.graph,e=this.attributes.target;return e&&e.id&&t&&t.getCell(e.id)||null},getTargetElement:function(){var t=this,e={};do{if(e[t.id])return null;e[t.id]=!0,t=t.getTargetCell()}while(t&&t.isLink());return t},getRelationshipAncestor:function(){var t;if(this.graph){var e=[this,this.getSourceElement(),this.getTargetElement()].filter(function(t){return!!t});t=this.graph.getCommonAncestor.apply(this.graph,e)}return t||null},isRelationshipEmbeddedIn:function(t){var e=Ae(t)||St(t)?t:t.id,n=this.getRelationshipAncestor();return!!n&&(n.id===e||n.isEmbeddedIn(e))},_getDefaultLabel:function(){var t=this.get("defaultLabel")||this.defaultLabel||{},e={};return e.markup=t.markup||this.get("labelMarkup")||this.labelMarkup,e.position=t.position,e.attrs=t.attrs,e.size=t.size,e}},{endsEqual:function(t,e){var n=t.port===e.port||!t.port&&!e.port;return t.id===e.id&&n}}),Nn=un.define("standard.Rectangle",{attrs:{body:{refWidth:"100%",refHeight:"100%",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}]}),Mn=un.define("standard.Circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}]}),Pn=un.define("standard.Ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"body"},{tagName:"text",selector:"label"}]}),Ln=un.define("standard.Path",{attrs:{body:{refD:"M 0 0 L 10 0 10 10 0 10 Z",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}]}),Kn=un.define("standard.Polygon",{attrs:{body:{refPoints:"0 0 10 0 10 10 0 10",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"}]}),Bn=un.define("standard.Polyline",{attrs:{body:{refPoints:"0 0 10 0 10 10 0 10 0 0",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polyline",selector:"body"},{tagName:"text",selector:"label"}]}),zn=un.define("standard.Image",{attrs:{image:{refWidth:"100%",refHeight:"100%"},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),jn=un.define("standard.BorderedImage",{attrs:{border:{refWidth:"100%",refHeight:"100%",stroke:"#333333",strokeWidth:2},background:{refWidth:-1,refHeight:-1,x:.5,y:.5,fill:"#FFFFFF"},image:{refWidth:-1,refHeight:-1,x:.5,y:.5},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"background",attributes:{stroke:"none"}},{tagName:"image",selector:"image"},{tagName:"rect",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),Gn=un.define("standard.EmbeddedImage",{attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#FFFFFF",strokeWidth:2},image:{refWidth:"30%",refHeight:-20,x:10,y:10,preserveAspectRatio:"xMidYMin"},label:{textVerticalAnchor:"top",textAnchor:"left",refX:"30%",refX2:20,refY:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),Fn=un.define("standard.InscribedImage",{attrs:{border:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",stroke:"#333333",strokeWidth:2},background:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",fill:"#FFFFFF"},image:{refWidth:"68%",refHeight:"68%",refX:"16%",refY:"16%",preserveAspectRatio:"xMidYMid"},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"image"},{tagName:"ellipse",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),Vn=un.define("standard.HeaderedRectangle",{attrs:{body:{refWidth:"100%",refHeight:"100%",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},header:{refWidth:"100%",height:30,strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},headerText:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:15,fontSize:16,fill:"#333333"},bodyText:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",refY2:15,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerText"},{tagName:"text",selector:"bodyText"}]}),Hn=un.define("standard.Cylinder",{attrs:{body:{lateralArea:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},top:{refCx:"50%",cy:10,refRx:"50%",ry:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"100%",refY2:15,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],topRy:function(t,e){if(void 0===t)return this.attr("body/lateralArea");var n={lateralArea:t},i=jt(t)?{refCy:t,refRy:t,cy:null,ry:null}:{refCy:null,refRy:null,cy:t,ry:t};return this.attr({body:n,top:i},e)}},{attributes:{lateralArea:{set:function(t,e){var n=jt(t);n&&(t=parseFloat(t)/100);var i=e.x,r=e.y,o=e.width,s=e.height,a=o/2,l=n?s*t:t,c=Mt.KAPPA,u=c*a,h=c*(n?s*t:t),d=i+o/2,f=i+o,p=r+l,g=p-l,m=r+s-l,v=r+s;return{d:["M",i,p,"L",i,m,"C",i,m+h,d-u,v,d,v,"C",d+u,v,f,m+h,f,m,"L",f,p,"C",f,p-h,d+u,g,d,g,"C",d-u,g,i,p-h,i,p,"Z"].join(" ")}}}}}),Un=mn.test("svgforeignobject")?{tagName:"foreignObject",selector:"foreignObject",attributes:{overflow:"hidden"},children:[{tagName:"div",namespaceURI:"http://www.w3.org/1999/xhtml",selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attributes:{"text-anchor":"middle"}},Zn={Rectangle:Nn,Circle:Mn,Ellipse:Pn,Path:Ln,Polygon:Kn,Polyline:Bn,Image:zn,BorderedImage:jn,EmbeddedImage:Gn,InscribedImage:Fn,HeaderedRectangle:Vn,Cylinder:Hn,TextBlock:un.define("standard.TextBlock",{attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#ffffff",strokeWidth:2},foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}}},{markup:[{tagName:"rect",selector:"body"},Un]},{attributes:{text:{set:function(t,e,n,i){if(!(n instanceof HTMLElement)){var r=i.style||{},o={text:t,width:-5,height:"100%"},s=Jt({textVerticalAnchor:"middle"},r);return Ue.textWrap.set.call(this,o,e,n,s),{fill:r.color||null}}n.textContent=t},position:function(t,e,n){if(n instanceof SVGElement)return e.center()}}}}),Link:kn.define("standard.Link",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 10 -5 0 0 10 5 z"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),DoubleLink:kn.define("standard.DoubleLink",{attrs:{line:{connection:!0,stroke:"#DDDDDD",strokeWidth:4,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"#000000",d:"M 10 -3 10 -10 -2 0 10 10 10 3"}},outline:{connection:!0,stroke:"#000000",strokeWidth:6,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"outline",attributes:{fill:"none"}},{tagName:"path",selector:"line",attributes:{fill:"none"}}]}),ShadowLink:kn.define("standard.ShadowLink",{attrs:{line:{connection:!0,stroke:"#FF0000",strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"none",d:"M 0 -10 -10 0 0 10 z"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}},shadow:{connection:!0,refX:3,refY:6,stroke:"#000000",strokeOpacity:.2,strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 0 -10 -10 0 0 10 z",stroke:"none"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}}}},{markup:[{tagName:"path",selector:"shadow",attributes:{fill:"none"}},{tagName:"path",selector:"line",attributes:{fill:"none"}}]})},Wn=vn.define("devs.Model",{inPorts:[],outPorts:[],size:{width:80,height:80},attrs:{".":{magnet:!1},".label":{text:"Model","ref-x":.5,"ref-y":10,"font-size":18,"text-anchor":"middle",fill:"#000"},".body":{"ref-width":"100%","ref-height":"100%",stroke:"#000"}},ports:{groups:{in:{position:{name:"left"},attrs:{".port-label":{fill:"#000"},".port-body":{fill:"#fff",stroke:"#000",r:10,magnet:!0}},label:{position:{name:"left",args:{y:10}}}},out:{position:{name:"right"},attrs:{".port-label":{fill:"#000"},".port-body":{fill:"#fff",stroke:"#000",r:10,magnet:!0}},label:{position:{name:"right",args:{y:10}}}}}}},{markup:'<g class="rotatable"><rect class="body"/><text class="label"/></g>',portMarkup:'<circle class="port-body"/>',portLabelMarkup:'<text class="port-label"/>',initialize:function(){vn.prototype.initialize.apply(this,arguments),this.on("change:inPorts change:outPorts",this.updatePortItems,this),this.updatePortItems()},updatePortItems:function(t,e,n){var i=ie(this.get("inPorts")),r=me(ie(this.get("outPorts")),i),o=this.createPortItems("in",i),s=this.createPortItems("out",r);this.prop("ports/items",o.concat(s),Jt({rewrite:!0},n))},createPortItem:function(t,e){return{id:e,group:t,attrs:{".port-label":{text:e}}}},createPortItems:function(t,e){return ue(e).map(this.createPortItem.bind(this,t))},_addGroupPort:function(t,e,n){var i=this.get(e);return this.set(e,Array.isArray(i)?i.concat(t):[t],n)},addOutPort:function(t,e){return this._addGroupPort(t,"outPorts",e)},addInPort:function(t,e){return this._addGroupPort(t,"inPorts",e)},_removeGroupPort:function(t,e,n){return this.set(e,ge(this.get(e),t),n)},removeOutPort:function(t,e){return this._removeGroupPort(t,"outPorts",e)},removeInPort:function(t,e){return this._removeGroupPort(t,"inPorts",e)},_changeGroup:function(t,e,n){return this.prop("ports/groups/"+t,De(e)?e:{},n)},changeInGroup:function(t,e){return this._changeGroup("in",t,e)},changeOutGroup:function(t,e){return this._changeGroup("out",t,e)}}),$n=Wn.define("devs.Atomic",{size:{width:80,height:80},attrs:{".label":{text:"Atomic"}}}),Yn=Wn.define("devs.Coupled",{size:{width:200,height:300},attrs:{".label":{text:"Coupled"}}}),Xn={Model:Wn,Atomic:$n,Coupled:Yn,Link:kn.define("devs.Link",{attrs:{".connection":{"stroke-width":2}}})},qn=vn.define("logic.Gate",{size:{width:80,height:40},attrs:{".":{magnet:!1},".body":{width:100,height:50},circle:{r:7,stroke:"black",fill:"transparent","stroke-width":2}}},{operation:function(){return!0}}),Jn=qn.define("logic.IO",{size:{width:60,height:30},attrs:{".body":{fill:"white",stroke:"black","stroke-width":2},".wire":{ref:".body","ref-y":.5,stroke:"black"},text:{fill:"black",ref:".body","ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle","font-weight":"bold","font-variant":"small-caps","text-transform":"capitalize","font-size":"14px"}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="body"/></g><path class="wire"/><circle/><text/></g>'}),Qn=Jn.define("logic.Input",{attrs:{".wire":{"ref-dx":0,d:"M 0 0 L 23 0"},circle:{ref:".body","ref-dx":30,"ref-y":.5,magnet:!0,class:"output",port:"out"},text:{text:"input"}}}),ti=Jn.define("logic.Output",{attrs:{".wire":{"ref-x":0,d:"M 0 0 L -23 0"},circle:{ref:".body","ref-x":-30,"ref-y":.5,magnet:"passive",class:"input",port:"in"},text:{text:"output"}}}),ei=qn.define("logic.Gate11",{attrs:{".input":{ref:".body","ref-x":-2,"ref-y":.5,magnet:"passive",port:"in"},".output":{ref:".body","ref-dx":2,"ref-y":.5,magnet:!0,port:"out"}}},{markup:'<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input"/><circle class="output"/></g>'}),ni=qn.define("logic.Gate21",{attrs:{".input1":{ref:".body","ref-x":-2,"ref-y":.3,magnet:"passive",port:"in1"},".input2":{ref:".body","ref-x":-2,"ref-y":.7,magnet:"passive",port:"in2"},".output":{ref:".body","ref-dx":2,"ref-y":.5,magnet:!0,port:"out"}}},{markup:'<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input input1"/><circle  class="input input2"/><circle class="output"/></g>'}),ii=ei.define("logic.Repeater",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzIuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICA8L2c+Cjwvc3ZnPgo="}}},{operation:function(t){return t}}),ri=ei.define("logic.Not",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzkuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDI2NzEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzYiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA4MCwyNSBBIDQsNCAwIDEgMSA3MiwyNSBBIDQsNCAwIDEgMSA4MCwyNSB6IgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEsMCkiIC8+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t){return!t}}),oi=ni.define("logic.Or",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik9SIEFOU0kuc3ZnIgogICBpbmtzY2FwZTpvdXRwdXRfZXh0ZW5zaW9uPSJvcmcuaW5rc2NhcGUub3V0cHV0LnN2Zy5pbmtzY2FwZSI+CiAgPGRlZnMKICAgICBpZD0iZGVmczQiPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTAgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjcxNCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iMSA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMC41IDogMC4zMzMzMzMzMyA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODA2IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODE5IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjM3Mi4wNDcyNCA6IDM1MC43ODczOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzc3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49Ijc1IDogNDAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTUwIDogNjAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDYwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTMyNzUiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNTAgOiAzMy4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTAwIDogNTAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTU1MzMiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzIgOiAyMS4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNjQgOiAzMiA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMzIgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjU1NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDE2LjY2NjY2NyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDI1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAyNSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iNCIKICAgICBpbmtzY2FwZTpjeD0iMTEzLjAwMDM5IgogICAgIGlua3NjYXBlOmN5PSIxMi44OTM3MzEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9InB4IgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImcyNTYwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTpncmlkLWJib3g9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1wb2ludHM9InRydWUiCiAgICAgZ3JpZHRvbGVyYW5jZT0iMTAwMDAiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMzk5IgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9Ijg3NCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMzciCiAgICAgaW5rc2NhcGU6d2luZG93LXk9Ii00IgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gNzAsMjUgYyAyMCwwIDI1LDAgMjUsMCIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMSwxNSA1LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzIsMzUgNSwzNSIKICAgICAgIGlkPSJwYXRoMzk0NCIgLz4KICAgIDxnCiAgICAgICBpZD0iZzI1NjAiCiAgICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2LjUsLTM5LjUpIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICA8L2c+Cjwvc3ZnPgo="}}},{operation:function(t,e){return t||e}}),si=ni.define("logic.And",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IkFORCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI4IgogICAgIGlua3NjYXBlOmN4PSI1Ni42OTgzNDgiCiAgICAgaW5rc2NhcGU6Y3k9IjI1LjMyNjg5OSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTptZWRpdW07Zm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDt0ZXh0LWluZGVudDowO3RleHQtYWxpZ246c3RhcnQ7dGV4dC1kZWNvcmF0aW9uOm5vbmU7bGluZS1oZWlnaHQ6bm9ybWFsO2xldHRlci1zcGFjaW5nOm5vcm1hbDt3b3JkLXNwYWNpbmc6bm9ybWFsO3RleHQtdHJhbnNmb3JtOm5vbmU7ZGlyZWN0aW9uOmx0cjtibG9jay1wcm9ncmVzc2lvbjp0Yjt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6c3RhcnQ7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDozO21hcmtlcjpub25lO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGU7Zm9udC1mYW1pbHk6Qml0c3RyZWFtIFZlcmEgU2FuczstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOkJpdHN0cmVhbSBWZXJhIFNhbnMiCiAgICAgICBkPSJNIDMwLDUgTCAzMCw2LjQyODU3MTQgTCAzMCw0My41NzE0MjkgTCAzMCw0NSBMIDMxLjQyODU3MSw0NSBMIDUwLjQ3NjE5LDQ1IEMgNjEuNzQ0MDk4LDQ1IDcwLjQ3NjE5LDM1Ljk5OTk1NSA3MC40NzYxOSwyNSBDIDcwLjQ3NjE5LDE0LjAwMDA0NSA2MS43NDQwOTksNS4wMDAwMDAyIDUwLjQ3NjE5LDUgQyA1MC40NzYxOSw1IDUwLjQ3NjE5LDUgMzEuNDI4NTcxLDUgTCAzMCw1IHogTSAzMi44NTcxNDMsNy44NTcxNDI5IEMgNDAuODM0MjY0LDcuODU3MTQyOSA0NS45MTgzNjgsNy44NTcxNDI5IDQ4LjA5NTIzOCw3Ljg1NzE0MjkgQyA0OS4yODU3MTQsNy44NTcxNDI5IDQ5Ljg4MDk1Miw3Ljg1NzE0MjkgNTAuMTc4NTcxLDcuODU3MTQyOSBDIDUwLjMyNzM4MSw3Ljg1NzE0MjkgNTAuNDA5MjI3LDcuODU3MTQyOSA1MC40NDY0MjksNy44NTcxNDI5IEMgNTAuNDY1MDI5LDcuODU3MTQyOSA1MC40NzE1NDMsNy44NTcxNDI5IDUwLjQ3NjE5LDcuODU3MTQyOSBDIDYwLjIzNjg1Myw3Ljg1NzE0MyA2Ny4xNDI4NTcsMTUuNDk3MDk4IDY3LjE0Mjg1NywyNSBDIDY3LjE0Mjg1NywzNC41MDI5MDIgNTkuNzYwNjYyLDQyLjE0Mjg1NyA1MCw0Mi4xNDI4NTcgTCAzMi44NTcxNDMsNDIuMTQyODU3IEwgMzIuODU3MTQzLDcuODU3MTQyOSB6IgogICAgICAgaWQ9InBhdGgyODg0IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2NjY2NzY2NjY3Nzc3NzY2NjIiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return t&&e}}),ai=ni.define("logic.Nor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjEiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjY3NzY0NCIKICAgICBpbmtzY2FwZTpjeT0iMjIuMTAyMzQ0IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjM3IgogICAgIGlua3NjYXBlOndpbmRvdy15PSItNCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc5LDI1IEMgOTksMjUgOTUsMjUgOTUsMjUiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHNvZGlwb2RpOnR5cGU9ImFyYyIKICAgICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgICBpZD0icGF0aDI2MDQiCiAgICAgICAgIHNvZGlwb2RpOmN4PSI3NSIKICAgICAgICAgc29kaXBvZGk6Y3k9IjI1IgogICAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgICAgc29kaXBvZGk6cnk9IjQiCiAgICAgICAgIGQ9Ik0gNzksMjUgQSA0LDQgMCAxIDEgNzEsMjUgQSA0LDQgMCAxIDEgNzksMjUgeiIKICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI2LjUsMzkuNSkiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t,e){return!(t||e)}}),li=ni.define("logic.Nand",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5BTkQgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iMTYiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjI4MzMwNyIKICAgICBpbmtzY2FwZTpjeT0iMTYuNDQyODQzIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzksMjUgQyA5MS44LDI1IDk1LDI1IDk1LDI1IgogICAgICAgaWQ9InBhdGgzMDU5IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMxLDE1IDUsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMiwzNSA1LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmb250LXNpemU6bWVkaXVtO2ZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7dGV4dC1pbmRlbnQ6MDt0ZXh0LWFsaWduOnN0YXJ0O3RleHQtZGVjb3JhdGlvbjpub25lO2xpbmUtaGVpZ2h0Om5vcm1hbDtsZXR0ZXItc3BhY2luZzpub3JtYWw7d29yZC1zcGFjaW5nOm5vcm1hbDt0ZXh0LXRyYW5zZm9ybTpub25lO2RpcmVjdGlvbjpsdHI7YmxvY2stcHJvZ3Jlc3Npb246dGI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOnN0YXJ0O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MzttYXJrZXI6bm9uZTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlO2ZvbnQtZmFtaWx5OkJpdHN0cmVhbSBWZXJhIFNhbnM7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpCaXRzdHJlYW0gVmVyYSBTYW5zIgogICAgICAgZD0iTSAzMCw1IEwgMzAsNi40Mjg1NzE0IEwgMzAsNDMuNTcxNDI5IEwgMzAsNDUgTCAzMS40Mjg1NzEsNDUgTCA1MC40NzYxOSw0NSBDIDYxLjc0NDA5OCw0NSA3MC40NzYxOSwzNS45OTk5NTUgNzAuNDc2MTksMjUgQyA3MC40NzYxOSwxNC4wMDAwNDUgNjEuNzQ0MDk5LDUuMDAwMDAwMiA1MC40NzYxOSw1IEMgNTAuNDc2MTksNSA1MC40NzYxOSw1IDMxLjQyODU3MSw1IEwgMzAsNSB6IE0gMzIuODU3MTQzLDcuODU3MTQyOSBDIDQwLjgzNDI2NCw3Ljg1NzE0MjkgNDUuOTE4MzY4LDcuODU3MTQyOSA0OC4wOTUyMzgsNy44NTcxNDI5IEMgNDkuMjg1NzE0LDcuODU3MTQyOSA0OS44ODA5NTIsNy44NTcxNDI5IDUwLjE3ODU3MSw3Ljg1NzE0MjkgQyA1MC4zMjczODEsNy44NTcxNDI5IDUwLjQwOTIyNyw3Ljg1NzE0MjkgNTAuNDQ2NDI5LDcuODU3MTQyOSBDIDUwLjQ2NTAyOSw3Ljg1NzE0MjkgNTAuNDcxNTQzLDcuODU3MTQyOSA1MC40NzYxOSw3Ljg1NzE0MjkgQyA2MC4yMzY4NTMsNy44NTcxNDMgNjcuMTQyODU3LDE1LjQ5NzA5OCA2Ny4xNDI4NTcsMjUgQyA2Ny4xNDI4NTcsMzQuNTAyOTAyIDU5Ljc2MDY2Miw0Mi4xNDI4NTcgNTAsNDIuMTQyODU3IEwgMzIuODU3MTQzLDQyLjE0Mjg1NyBMIDMyLjg1NzE0Myw3Ljg1NzE0MjkgeiIKICAgICAgIGlkPSJwYXRoMjg4NCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2Njc2NjY2Nzc3Nzc2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDQwMDgiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return!(t&&e)}}),ci=ni.define("logic.Xor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhPUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjUuNjU2ODU0MiIKICAgICBpbmtzY2FwZTpjeD0iMjUuOTM4MTE2IgogICAgIGlua3NjYXBlOmN5PSIxNy4yMzAwNSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzAuMzg1NzE3LDE1IEwgNC45OTk5OTk4LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5NzY7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEuMzYyMDkxLDM1IEwgNC45OTk5OTk4LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPGcKICAgICAgIGlkPSJnMjU2MCIKICAgICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAxIgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjYuNSwtMzkuNSkiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDM1MTYiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi4yNSw4MS41MDAwMDUgQyAtMy44NDczNzQsODQuMTQ0NDA1IC00LjUsODQuNTAwMDA1IC00LjUsODQuNTAwMDA1IEwgLTguMTU2MjUsODQuNTAwMDA1IEwgLTYuMTU2MjUsODIuMDYyNTA1IEMgLTYuMTU2MjUsODIuMDYyNTA1IC0wLjUsNzUuMDYyNDUxIC0wLjUsNjQuNSBDIC0wLjUsNTMuOTM3NTQ5IC02LjE1NjI1LDQ2LjkzNzUgLTYuMTU2MjUsNDYuOTM3NSBMIC04LjE1NjI1LDQ0LjUgTCAtNC41LDQ0LjUgQyAtMy43MTg3NSw0NS40Mzc1IC0zLjA3ODEyNSw0Ni4xNTYyNSAtMi4yODEyNSw0Ny41IEMgLTAuNDA4NTMxLDUwLjU5OTgxNSAyLjUsNTYuNTI2NjQ2IDIuNSw2NC41IEMgMi41LDcyLjQ1MDY1IC0wLjM5NjY5Nyw3OC4zNzk0MjUgLTIuMjUsODEuNTAwMDA1IHoiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY3NjY2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t,e){return(!t||e)&&(t||!e)}}),ui=ni.define("logic.Xnor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhOT1IgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNTU3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTYuNjY2NjY3IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDI1IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI0IgogICAgIGlua3NjYXBlOmN4PSI5NS43MjM2NiIKICAgICBpbmtzY2FwZTpjeT0iLTI2Ljc3NTAyMyIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyLjAwMDAwMDI0O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc4LjMzMzMzMiwyNSBDIDkxLjY2NjY2NiwyNSA5NSwyNSA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMC4zODU3MTcsMTUgTCA0Ljk5OTk5OTgsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk3NjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMS4zNjIwOTEsMzUgTCA0Ljk5OTk5OTgsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMzUxNiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjI1LDgxLjUwMDAwNSBDIC0zLjg0NzM3NCw4NC4xNDQ0MDUgLTQuNSw4NC41MDAwMDUgLTQuNSw4NC41MDAwMDUgTCAtOC4xNTYyNSw4NC41MDAwMDUgTCAtNi4xNTYyNSw4Mi4wNjI1MDUgQyAtNi4xNTYyNSw4Mi4wNjI1MDUgLTAuNSw3NS4wNjI0NTEgLTAuNSw2NC41IEMgLTAuNSw1My45Mzc1NDkgLTYuMTU2MjUsNDYuOTM3NSAtNi4xNTYyNSw0Ni45Mzc1IEwgLTguMTU2MjUsNDQuNSBMIC00LjUsNDQuNSBDIC0zLjcxODc1LDQ1LjQzNzUgLTMuMDc4MTI1LDQ2LjE1NjI1IC0yLjI4MTI1LDQ3LjUgQyAtMC40MDg1MzEsNTAuNTk5ODE1IDIuNSw1Ni41MjY2NDYgMi41LDY0LjUgQyAyLjUsNzIuNDUwNjUgLTAuMzk2Njk3LDc4LjM3OTQyNSAtMi4yNSw4MS41MDAwMDUgeiIKICAgICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2Njc2NjY2NzYyIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDM1NTEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return(!t||!e)&&(t||e)}}),hi={Gate:qn,IO:Jn,Input:Qn,Output:ti,Gate11:ei,Gate21:ni,Repeater:ii,Not:ri,Or:oi,And:si,Nor:ai,Nand:li,Xor:ci,Xnor:ui,Wire:kn.define("logic.Wire",{attrs:{".connection":{"stroke-width":2},".marker-vertex":{r:7}},router:{name:"orthogonal"},connector:{name:"rounded",args:{radius:10}}},{arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<circle class="marker-arrowhead" end="<%= end %>" r="7"/>',"</g>"].join(""),vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<g class="marker-vertex-remove-group">','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>","</g>"].join("")})},di={KingWhite:vn.define("chess.KingWhite",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;"><path      d="M 22.5,11.63 L 22.5,6"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 20,8 L 25,8"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"      style="fill:#ffffff; stroke:#000000; stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 11.5,30 C 17,27 27,27 32.5,30"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,37 C 17,34 27,34 32.5,37"      style="fill:none; stroke:#000000;" />  </g></g></g>'}),KingBlack:vn.define("chess.KingBlack",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path       d="M 22.5,11.63 L 22.5,6"       style="fill:none; stroke:#000000; stroke-linejoin:miter;"       id="path6570" />    <path       d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"       style="fill:#000000;fill-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;" />    <path       d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "       style="fill:#000000; stroke:#000000;" />    <path       d="M 20,8 L 25,8"       style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path       d="M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.51,26.6 L 22.5,24.5 C 20,18 9.906,14 6.997,19.85 C 4.5,25.5 11.85,28.85 11.85,28.85"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,30 C 17,27 27,27 32.5,30 M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5 M 11.5,37 C 17,34 27,34 32.5,37"       style="fill:none; stroke:#ffffff;" />  </g></g></g>'}),QueenWhite:vn.define("chess.QueenWhite",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(-1,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(15.5,-5.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(32,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(7,-4.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(24,-4)" />    <path      d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38,14 L 31,25 L 31,11 L 25.5,24.5 L 22.5,9.5 L 19.5,24.5 L 14,10.5 L 14,25 L 7,14 L 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 11.5,30 C 15,29 30,29 33.5,30"      style="fill:none;" />    <path      d="M 12,33.5 C 18,32.5 27,32.5 33,33.5"      style="fill:none;" />  </g></g></g>'}),QueenBlack:vn.define("chess.QueenBlack",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:none;">      <circle cx="6"    cy="12" r="2.75" />      <circle cx="14"   cy="9"  r="2.75" />      <circle cx="22.5" cy="8"  r="2.75" />      <circle cx="31"   cy="9"  r="2.75" />      <circle cx="39"   cy="12" r="2.75" />    </g>    <path       d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"       style="stroke-linecap:butt; stroke:#000000;" />    <path       d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"       style="stroke-linecap:butt;" />    <path       d="M 11,38.5 A 35,35 1 0 0 34,38.5"       style="fill:none; stroke:#000000; stroke-linecap:butt;" />    <path       d="M 11,29 A 35,35 1 0 1 34,29"       style="fill:none; stroke:#ffffff;" />    <path       d="M 12.5,31.5 L 32.5,31.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"       style="fill:none; stroke:#ffffff;" />  </g></g></g>'}),RookWhite:vn.define("chess.RookWhite",{size:{width:32,height:34}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14"      style="stroke-linecap:butt;" />    <path      d="M 34,14 L 31,17 L 14,17 L 11,14" />    <path      d="M 31,17 L 31,29.5 L 14,29.5 L 14,17"      style="stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>'}),RookBlack:vn.define("chess.RookBlack",{size:{width:32,height:34}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z "      style="stroke-linecap:butt;stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z "      style="stroke-linecap:butt;" />    <path      d="M 12,35.5 L 33,35.5 L 33,35.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 13,31.5 L 32,31.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,29.5 L 31,29.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 31,16.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />  </g></g></g>'}),BishopWhite:vn.define("chess.BishopWhite",{size:{width:38,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#ffffff; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path      d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>'}),BishopBlack:vn.define("chess.BishopBlack",{size:{width:38,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path       d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"       style="fill:none; stroke:#ffffff; stroke-linejoin:miter;" />  </g></g></g>'}),KnightWhite:vn.define("chess.KnightWhite",{size:{width:38,height:37}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#000000; stroke:#000000;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#000000; stroke:#000000;" />  </g></g></g>'}),KnightBlack:vn.define("chess.KnightBlack",{size:{width:38,height:37}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#000000; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#000000; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z "      style="fill:#ffffff; stroke:none;" />  </g></g></g>'}),PawnWhite:vn.define("chess.PawnWhite",{size:{width:28,height:33}},{markup:'<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>'}),PawnBlack:vn.define("chess.PawnBlack",{size:{width:28,height:33}},{markup:'<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>'})},fi=un.define("erd.Entity",{size:{width:150,height:60},attrs:{".outer":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"100,0 100,60 0,60 0,0"},".inner":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"95,5 95,55 5,55 5,5",display:"none"},text:{text:"Entity","font-family":"Arial","font-size":14,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>'}),pi=fi.define("erd.WeakEntity",{attrs:{".inner":{display:"auto"},text:{text:"Weak Entity"}}}),gi=un.define("erd.Relationship",{size:{width:80,height:80},attrs:{".outer":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,0 80,40 40,80 0,40"},".inner":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,5 75,40 40,75 5,40",display:"none"},text:{text:"Relationship","font-family":"Arial","font-size":12,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>'}),mi=gi.define("erd.IdentifyingRelationship",{attrs:{".inner":{display:"auto"},text:{text:"Identifying"}}}),vi=un.define("erd.Attribute",{size:{width:100,height:50},attrs:{ellipse:{transform:"translate(50, 25)"},".outer":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:50,ry:25,fill:"#E67E22"},".inner":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:45,ry:20,fill:"#E67E22",display:"none"},text:{"font-family":"Arial","font-size":14,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse class="outer"/><ellipse class="inner"/></g><text/></g>'}),yi=vi.define("erd.Multivalued",{attrs:{".inner":{display:"block"},text:{text:"multivalued"}}}),bi=vi.define("erd.Derived",{attrs:{".outer":{"stroke-dasharray":"3,5"},text:{text:"derived"}}}),Ci=vi.define("erd.Key",{attrs:{ellipse:{"stroke-width":4},text:{text:"key","font-weight":"800","text-decoration":"underline"}}}),Ii=vi.define("erd.Normal",{attrs:{text:{text:"Normal"}}}),Ei={Entity:fi,WeakEntity:pi,Relationship:gi,IdentifyingRelationship:mi,Attribute:vi,Multivalued:yi,Derived:bi,Key:Ci,Normal:Ii,ISA:un.define("erd.ISA",{type:"erd.ISA",size:{width:100,height:50},attrs:{polygon:{points:"0,0 50,50 100,0",fill:"#F1C40F",stroke:"#F39C12","stroke-width":2},text:{text:"ISA","font-size":18,"ref-x":.5,"ref-y":.3,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'}),Line:kn.define("erd.Line",{},{cardinality:function(t){this.set("labels",[{position:-20,attrs:{text:{dy:-8,text:t}}}])}})},Ti={State:In.define("fsa.State",{attrs:{circle:{"stroke-width":3},text:{"font-weight":"800"}}}),StartState:un.define("fsa.StartState",{size:{width:20,height:20},attrs:{circle:{transform:"translate(10, 10)",r:10,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g></g>'}),EndState:un.define("fsa.EndState",{size:{width:20,height:20},attrs:{".outer":{transform:"translate(10, 10)",r:10,fill:"#ffffff",stroke:"#000000"},".inner":{transform:"translate(10, 10)",r:6,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>'}),Arrow:kn.define("fsa.Arrow",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z"}},smooth:!0})},wi={Member:un.define("org.Member",{size:{width:180,height:70},attrs:{rect:{width:170,height:60},".card":{fill:"#FFFFFF",stroke:"#000000","stroke-width":2,"pointer-events":"visiblePainted",rx:10,ry:10},image:{width:48,height:48,ref:".card","ref-x":10,"ref-y":5},".rank":{"text-decoration":"underline",ref:".card","ref-x":.9,"ref-y":.2,"font-family":"Courier New","font-size":14,"text-anchor":"end"},".name":{"font-weight":"800",ref:".card","ref-x":.9,"ref-y":.6,"font-family":"Courier New","font-size":14,"text-anchor":"end"}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="card"/><image/></g><text class="rank"/><text class="name"/></g>'}),Arrow:kn.define("org.Arrow",{source:{selector:".card"},target:{selector:".card"},attrs:{".connection":{stroke:"#585858","stroke-width":3}},z:-1})},xi={Place:vn.define("pn.Place",{size:{width:50,height:50},attrs:{".root":{r:25,fill:"#ffffff",stroke:"#000000",transform:"translate(25, 25)"},".label":{"text-anchor":"middle","ref-x":.5,"ref-y":-20,ref:".root",fill:"#000000","font-size":12},".tokens > circle":{fill:"#000000",r:5},".tokens.one > circle":{transform:"translate(25, 25)"},".tokens.two > circle:nth-child(1)":{transform:"translate(19, 25)"},".tokens.two > circle:nth-child(2)":{transform:"translate(31, 25)"},".tokens.three > circle:nth-child(1)":{transform:"translate(18, 29)"},".tokens.three > circle:nth-child(2)":{transform:"translate(25, 19)"},".tokens.three > circle:nth-child(3)":{transform:"translate(32, 29)"},".tokens.alot > text":{transform:"translate(25, 18)","text-anchor":"middle",fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="root"/><g class="tokens" /></g><text class="label"/></g>'}),PlaceView:gn.extend({presentationAttributes:gn.addPresentationAttributes({tokens:["TOKENS"]}),initFlag:gn.prototype.initFlag.concat(["TOKENS"]),confirmUpdate:function(){for(var t,e=[],n=arguments.length;n--;)e[n]=arguments[n];var i=(t=gn.prototype.confirmUpdate).call.apply(t,[this].concat(e));return this.hasFlag(i,"TOKENS")&&(this.renderTokens(),this.update(),i=this.removeFlag(i,"TOKENS")),i},renderTokens:function(){var t=this.vel.findOne(".tokens").empty();["one","two","three","alot"].forEach(function(e){t.removeClass(e)});var e=this.model.get("tokens");if(e)switch(e){case 1:t.addClass("one"),t.append(Mt("circle"));break;case 2:t.addClass("two"),t.append([Mt("circle"),Mt("circle")]);break;case 3:t.addClass("three"),t.append([Mt("circle"),Mt("circle"),Mt("circle")]);break;default:t.addClass("alot"),t.append(Mt("text").text(e+""))}}}),Transition:vn.define("pn.Transition",{size:{width:12,height:50},attrs:{rect:{width:12,height:50,fill:"#000000",stroke:"#000000"},".label":{"text-anchor":"middle","ref-x":.5,"ref-y":-20,ref:"rect",fill:"#000000","font-size":12}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="root"/></g></g><text class="label"/>'}),Link:kn.define("pn.Link",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z"}}})},_i=vn.define("uml.Class",{attrs:{rect:{width:200},".uml-class-name-rect":{stroke:"black","stroke-width":2,fill:"#3498db"},".uml-class-attrs-rect":{stroke:"black","stroke-width":2,fill:"#2980b9"},".uml-class-methods-rect":{stroke:"black","stroke-width":2,fill:"#2980b9"},".uml-class-name-text":{ref:".uml-class-name-rect","ref-y":.5,"ref-x":.5,"text-anchor":"middle","y-alignment":"middle","font-weight":"bold",fill:"black","font-size":12,"font-family":"Times New Roman"},".uml-class-attrs-text":{ref:".uml-class-attrs-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"Times New Roman"},".uml-class-methods-text":{ref:".uml-class-methods-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"Times New Roman"}},name:[],attributes:[],methods:[]},{markup:['<g class="rotatable">','<g class="scalable">','<rect class="uml-class-name-rect"/><rect class="uml-class-attrs-rect"/><rect class="uml-class-methods-rect"/>',"</g>",'<text class="uml-class-name-text"/><text class="uml-class-attrs-text"/><text class="uml-class-methods-text"/>',"</g>"].join(""),initialize:function(){this.on("change:name change:attributes change:methods",function(){this.updateRectangles(),this.trigger("uml-update")},this),this.updateRectangles(),vn.prototype.initialize.apply(this,arguments)},getClassName:function(){return this.get("name")},updateRectangles:function(){var t=this.get("attrs"),e=[{type:"name",text:this.getClassName()},{type:"attrs",text:this.get("attributes")},{type:"methods",text:this.get("methods")}],n=0;e.forEach(function(e){var i=Array.isArray(e.text)?e.text:[e.text],r=20*i.length+20;t[".uml-class-"+e.type+"-text"].text=i.join("\n"),t[".uml-class-"+e.type+"-rect"].height=r,t[".uml-class-"+e.type+"-rect"].transform="translate(0,"+n+")",n+=r})}}),Di=gn.extend({initialize:function(){gn.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"uml-update",function(){this.update(),this.resize()})}}),Ai=_i.define("uml.Abstract",{attrs:{".uml-class-name-rect":{fill:"#e74c3c"},".uml-class-attrs-rect":{fill:"#c0392b"},".uml-class-methods-rect":{fill:"#c0392b"}}},{getClassName:function(){return["<<Abstract>>",this.get("name")]}}),Oi=Di,Si=_i.define("uml.Interface",{attrs:{".uml-class-name-rect":{fill:"#f1c40f"},".uml-class-attrs-rect":{fill:"#f39c12"},".uml-class-methods-rect":{fill:"#f39c12"}}},{getClassName:function(){return["<<Interface>>",this.get("name")]}}),Ri={Class:_i,ClassView:Di,Abstract:Ai,AbstractView:Oi,Interface:Si,InterfaceView:Di,Generalization:kn.define("uml.Generalization",{attrs:{".marker-target":{d:"M 20 0 L 0 10 L 20 20 z",fill:"white"}}}),Implementation:kn.define("uml.Implementation",{attrs:{".marker-target":{d:"M 20 0 L 0 10 L 20 20 z",fill:"white"},".connection":{"stroke-dasharray":"3,3"}}}),Aggregation:kn.define("uml.Aggregation",{attrs:{".marker-target":{d:"M 40 10 L 20 20 L 0 10 L 20 0 z",fill:"white"}}}),Composition:kn.define("uml.Composition",{attrs:{".marker-target":{d:"M 40 10 L 20 20 L 0 10 L 20 0 z",fill:"black"}}}),Association:kn.define("uml.Association"),State:vn.define("uml.State",{attrs:{".uml-state-body":{width:200,height:200,rx:10,ry:10,fill:"#ecf0f1",stroke:"#bdc3c7","stroke-width":3},".uml-state-separator":{stroke:"#bdc3c7","stroke-width":2},".uml-state-name":{ref:".uml-state-body","ref-x":.5,"ref-y":5,"text-anchor":"middle",fill:"#000000","font-family":"Courier New","font-size":14},".uml-state-events":{ref:".uml-state-separator","ref-x":5,"ref-y":5,fill:"#000000","font-family":"Courier New","font-size":14}},name:"State",events:[]},{markup:['<g class="rotatable">','<g class="scalable">','<rect class="uml-state-body"/>',"</g>",'<path class="uml-state-separator"/>','<text class="uml-state-name"/>','<text class="uml-state-events"/>',"</g>"].join(""),initialize:function(){this.on({"change:name":this.updateName,"change:events":this.updateEvents,"change:size":this.updatePath},this),this.updateName(),this.updateEvents(),this.updatePath(),vn.prototype.initialize.apply(this,arguments)},updateName:function(){this.attr(".uml-state-name/text",this.get("name"))},updateEvents:function(){this.attr(".uml-state-events/text",this.get("events").join("\n"))},updatePath:function(){var t="M 0 20 L "+this.get("size").width+" 20";this.attr(".uml-state-separator/d",t,{silent:!0})}}),StartState:In.define("uml.StartState",{type:"uml.StartState",attrs:{circle:{fill:"#34495e",stroke:"#2c3e50","stroke-width":2,rx:1}}}),EndState:vn.define("uml.EndState",{size:{width:20,height:20},attrs:{"circle.outer":{transform:"translate(10, 10)",r:10,fill:"#ffffff",stroke:"#2c3e50"},"circle.inner":{transform:"translate(10, 10)",r:6,fill:"#34495e"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>'}),Transition:kn.define("uml.Transition",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z",fill:"#34495e",stroke:"#2c3e50"},".connection":{stroke:"#2c3e50"}}})},ki=["arc","gap","cubic"],Ni=["smooth"],Mi=1/3,Pi=2/3;function Li(t,e,n){var i=[].concat(t,n,e);return i.reduce(function(t,e,n){var r=i[n+1];return null!=r&&(t[n]=Z(e,r)),t},[])}function Ki(){for(var t=this._jumpOverUpdateList,e=0;e<t.length;e++)t[e].update()}function Bi(t,e){return Z(t,e).squaredLength()}function zi(t,e,n,i){var r,o=new P;return r=P.createSegment("M",t[0].start),o.appendSegment(r),ue(t).forEach(function(s,a){if(s.isJump){var l,c,u,h;if("arc"===n){l=-90,c=s.start.difference(s.end);var d=Number(c.x<0||0===c.x&&c.y<0);d&&(l+=180);var f,p=s.midpoint(),g=new M(p,s.end).rotate(p,l);u=(f=new M(s.start,p)).pointAt(2/3).rotate(s.start,l),h=g.pointAt(1/3).rotate(g.end,-l),r=P.createSegment("C",u,h,g.end),o.appendSegment(r),f=new M(p,s.end),u=g.pointAt(1/3).rotate(g.end,l),h=f.pointAt(1/3).rotate(s.end,-l),r=P.createSegment("C",u,h,s.end),o.appendSegment(r)}else if("gap"===n)r=P.createSegment("M",s.end),o.appendSegment(r);else if("cubic"===n){l=s.start.theta(s.end);var m=.6*e,v=1.35*e;c=s.start.difference(s.end),(d=Number(c.x<0||0===c.x&&c.y<0))&&(v*=-1),u=L(s.start.x+m,s.start.y+v).rotate(s.start,l),h=L(s.end.x-m,s.end.y+v).rotate(s.end,l),r=P.createSegment("C",u,h,s.end),o.appendSegment(r)}}else{var y=t[a+1];0==i||!y||y.isJump?(r=P.createSegment("L",s.end),o.appendSegment(r)):function(t,e,n,i,r){var o,s=n.distance(i)/2,a=n.distance(r)/2,l=-Math.min(t,s),c=-Math.min(t,a),u=n.clone().move(i,l).round(),h=n.clone().move(r,c).round(),d=new L(Mi*u.x+Pi*n.x,Pi*n.y+Mi*u.y),f=new L(Mi*h.x+Pi*n.x,Pi*n.y+Mi*h.y);o=P.createSegment("L",u),e.appendSegment(o),o=P.createSegment("C",d,f,h),e.appendSegment(o)}(i,o,s.end,s.start,y.end)}}),o}function ji(t,e,n,i){var r,o=(i=i||{}).radius||10,s=i.raw,a=new P;r=P.createSegment("M",t),a.appendSegment(r);for(var l,c,u,h,d,f,p,g,m,v,y,b=0,C=n.length;b<C;b++)l=new L(n[b]),c=n[b-1]||t,u=n[b+1]||e,h=d||l.distance(c)/2,d=l.distance(u)/2,f=-Math.min(o,h),p=-Math.min(o,d),g=l.clone().move(c,f).round(),m=l.clone().move(u,p).round(),v=new L(1/3*g.x+2/3*l.x,2/3*l.y+1/3*g.y),y=new L(1/3*m.x+2/3*l.x,2/3*l.y+1/3*m.y),r=P.createSegment("L",g),a.appendSegment(r),r=P.createSegment("C",v,y,m),a.appendSegment(r);return r=P.createSegment("L",e),a.appendSegment(r),s?a:a.serialize()}var Gi={jumpover:function(t,e,n,i){!function(t){var e=t.paper._jumpOverUpdateList;null==e&&(e=t.paper._jumpOverUpdateList=[],t.paper.on("cell:pointerup",Ki),t.paper.model.on("reset",function(){e=t.paper._jumpOverUpdateList=[]})),e.indexOf(t)<0&&(e.push(t),t.listenToOnce(t.model,"change:connector remove",function(){e.splice(e.indexOf(t),1)}))}(this);var r=i.raw,o=i.size||5,s=i.jump&&(""+i.jump).toLowerCase(),a=i.radius||0,l=i.ignoreConnectors||Ni;-1===ki.indexOf(s)&&(s=ki[0]);var c=this.paper,u=c.model.getLinks();if(1===u.length)return zi(Li(t,e,n),o,s,a);var h=this.model,d=u.indexOf(h),f=c.options.defaultConnector||{},p=u.filter(function(t,e){var n=t.get("connector")||f;return!(ue(l).includes(n.name)||d<e&&"jumpover"===n.name)}),g=p.map(function(t){return c.findViewByModel(t)}),m=Li(t,e,n),v=g.map(function(t){return null==t?[]:t===this?m:Li(t.sourcePoint,t.targetPoint,t.route)},this),y=zi(m.reduce(function(t,e){var n=p.reduce(function(t,n,i){if(n!==h){var r=function(t,e){return ue(e).reduce(function(e,n){var i=t.intersection(n);return i&&e.push(i),e},[])}(e,v[i]);t.push.apply(t,r)}return t},[]).sort(function(t,n){return Bi(e.start,t)-Bi(e.start,n)});return 0<n.length?t.push.apply(t,function(t,e,n){return e.reduce(function(i,r,o){if(!0===r.skip)return i;var s=i.pop()||t,a=W(r).move(s.start,-n),l=W(r).move(s.start,+n),c=e[o+1];if(null!=c){var u=l.distance(c);u<=n&&(l=c.move(s.start,u),c.skip=!0)}else if(a.distance(s.end)<2*n+1)return i.push(s),i;if(l.distance(s.start)<2*n+1)return i.push(s),i;var h=Z(a,l);return h.isJump=!0,i.push(Z(s.start,a),h,Z(l,s.end)),i},[])}(e,n,o)):t.push(e),t},[]),o,s,a);return r?y:y.serialize()},normal:function(t,e,n,i){var r=i&&i.raw,o=[t].concat(n).concat([e]),s=new K(o),a=new P(s);return r?a:a.serialize()},rounded:ji,smooth:function(t,e,n,i){var r,o=i&&i.raw;if(n&&0!==n.length){var s=[t].concat(n).concat([e]),a=R.throughPoints(s);r=new P(a)}else{var l;if(r=new P,l=P.createSegment("M",t),r.appendSegment(l),Math.abs(t.x-e.x)>=Math.abs(t.y-e.y)){var c=(t.x+e.x)/2;l=P.createSegment("C",c,t.y,c,e.y,e.x,e.y),r.appendSegment(l)}else{var u=(t.y+e.y)/2;l=P.createSegment("C",t.x,u,e.x,u,e.x,e.y),r.appendSegment(l)}}return o?r:r.serialize()}},Fi={stroke:{defaultOptions:{padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},_views:{},getHighlighterId:function(t,e){return t.id+JSON.stringify(e)},removeHighlighter:function(t){this._views[t]&&(this._views[t].remove(),this._views[t]=null)},highlight:function(t,e,n){var i=this.getHighlighterId(e,n);if(!this._views[i]){var r,o=Qt(n||{},this.defaultOptions),s=Mt(e);try{var a=s.convertToPathData()}catch(t){r=s.bbox(!0),a=Mt.rectToPath(Jt({},o,r))}var l=Mt("path").attr({d:a,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"}).attr(o.attrs);if(t.isNodeConnection(e))l.attr("d",t.getSerializedConnection());else{var c=s.getTransformToElement(t.el),u=o.padding;if(u){var h=(r=r||s.bbox(!0)).x+r.width/2,d=r.y+r.height/2;r=Mt.transformRect(r,c);var f=Math.max(r.width,1),p=Math.max(r.height,1),g=(f+u)/f,m=(p+u)/p,v=Mt.createSVGMatrix({a:g,b:0,c:0,d:m,e:h-g*h,f:d-m*d});c=c.multiply(v)}l.transform(c)}var y=this._views[i]=new dn({svgElement:!0,className:"highlight-stroke",el:l.node}),b=this.removeHighlighter.bind(this,i),C=t.model;y.listenTo(C,"remove",b),y.listenTo(C.graph,"reset",b),t.vel.append(l)}},unhighlight:function(t,e,n){this.removeHighlighter(this.getHighlighterId(e,n))}},opacity:{highlight:function(t,e){Mt(e).addClass(lt("highlight-opacity"))},unhighlight:function(t,e){Mt(e).removeClass(lt("highlight-opacity"))}},addClass:{className:lt("highlighted"),highlight:function(t,e,n){var i=(n||{}).className||this.className;Mt(e).addClass(i)},unhighlight:function(t,e,n){var i=(n||{}).className||this.className;Mt(e).removeClass(i)}}};function Vi(t,e,n){if(!isFinite(n))return t;var i=t.distance(e);return 0===n&&0<i?t:t.move(e,-Math.min(n,i-1))}function Hi(t){var e=t.getAttribute("stroke-width");return null===e?0:parseFloat(e)||0}function Ui(t,e,n,i){var r=e.getNodeBBox(n);i.stroke&&r.inflate(Hi(n)/2);var o=t.intersect(r);return Vi(o?t.start.chooseClosest(o):t.end,t.start,i.offset)}var Zi="segmentSubdivisons",Wi="shapeBBox",$i={anchor:function(t,e,n,i){return Vi(t.end,t.start,i.offset)},bbox:Ui,rectangle:function(t,e,n,i){var r=e.model.angle();if(0===r)return Ui(t,e,n,i);var o=e.getNodeUnrotatedBBox(n);i.stroke&&o.inflate(Hi(n)/2);var s=o.center(),a=t.clone().rotate(s,r),l=a.setLength(1e6).intersect(o);return Vi(l?a.start.chooseClosest(l).rotate(s,-r):t.end,t.start,i.offset)},boundary:function(t,e,n,i){var r,o,s=i.selector,a=t.end;if(r="string"==typeof s?e.findBySelector(s)[0]:Array.isArray(s)?dt(n,s):function(t){if(!t)return null;var e=t;do{var n=e.tagName;if("string"!=typeof n)return null;if("G"===(n=n.toUpperCase()))e=e.firstElementChild;else{if("TITLE"!==n)break;e=e.nextElementSibling}}while(e);return e}(n),!Mt.isSVGGraphicsElement(r)){if(r===n||!Mt.isSVGGraphicsElement(n))return a;r=n}var l,c=e.getNodeShape(r),u=e.getNodeMatrix(r),h=e.getRootTranslateMatrix(),d=e.getRootRotateMatrix(),f=h.multiply(d).multiply(u),p=f.inverse(),g=Mt.transformLine(t,p),m=g.start.clone(),v=e.getNodeData(r);if(!1===i.insideout&&(v[Wi]||(v[Wi]=c.bbox()),v[Wi].containsPoint(m)))return a;if(c instanceof P){var y=i.precision||2;v[Zi]||(v[Zi]=c.getSegmentSubdivisions({precision:y})),l={precision:y,segmentSubdivisions:v[Zi]}}!0===i.extrapolate&&g.setLength(1e6),(o=g.intersect(c,l))?Mt.isArray(o)&&(o=m.chooseClosest(o)):!0===i.sticky&&(o=c instanceof B?c.pointNearestToPoint(m):c instanceof N?c.intersectionWithLineFromCenterToPoint(m):c.closestPoint(m,l));var b=o?Mt.transformPoint(o,f):a,C=i.offset||0;return i.stroke&&(C+=Hi(r)/2),Vi(b,t.start,C)}};function Yi(t,e){return 0===e?"0%":Math.round(t/e*100)+"%"}function Xi(t){return function(e,n,i,r){return(n.isNodeConnection(i)?Ji:qi)(t,e,n,i,r)}}function qi(t,e,n,i,r){var o=n.model.angle(),s=n.getNodeUnrotatedBBox(i),a=n.model.getBBox().center();r.rotate(a,o);var l=r.x-s.x,c=r.y-s.y;return t&&(l=Yi(l,s.width),c=Yi(c,s.height)),e.anchor={name:"topLeft",args:{dx:l,dy:c,rotate:!0}},e}function Ji(t,e,n,i,r){var o=n.getConnection();if(!o)return e;var s=o.closestPointLength(r);if(t){var a=o.length();e.anchor={name:"connectionRatio",args:{ratio:s/a}}}else e.anchor={name:"connectionLength",args:{length:s}};return e}var Qi=Oe,tr=Xi(!1),er=Xi(!0),nr={useDefaults:Qi,pinAbsolute:tr,pinRelative:er},ir={N:"S",S:"N",E:"W",W:"E"},rr={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function or(t,e,n){var i=new L(t.x,e.y);return n.containsPoint(i)&&(i=new L(e.x,t.y)),i}function sr(t,e){return t["W"===e||"E"===e?"width":"height"]}function ar(t,e){return t.x===e.x?t.y>e.y?"N":"S":t.y===e.y?t.x>e.x?"W":"E":null}function lr(t){return new B(t.x,t.y,0,0)}function cr(t){var e=Ft(t.padding||t.elementPadding||20);return{x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}function ur(t,e){return t.sourceBBox.clone().moveAndExpand(cr(e))}function hr(t,e){return t.targetBBox.clone().moveAndExpand(cr(e))}function dr(t,e,n){var i=new L(t.x,e.y),r=new L(e.x,t.y),o=ar(t,i),s=ar(t,r),a=ir[n],l=o===n||o!==a&&(s===a||s!==n)?i:r;return{points:[l],direction:ar(l,e)}}function fr(t,e,n){var i=or(t,e,n);return{points:[i],direction:ar(i,e)}}function pr(t,e,n,i){var r,o={},s=[new L(t.x,e.y),new L(e.x,t.y)],a=s.filter(function(t){return!n.containsPoint(t)}),l=a.filter(function(e){return ar(e,t)!==i});if(0<l.length)r=(r=l.filter(function(e){return ar(t,e)===i}).pop())||l[0],o.points=[r],o.direction=ar(r,e);else{r=me(s,a)[0];var c=new L(e).move(r,-sr(n,i)/2),u=or(c,t,n);o.points=[u,c],o.direction=ar(c,e)}return o}function gr(t,e,n,i){var r=fr(e,t,i),o=r.points[0];if(n.containsPoint(o)){var s=(r=fr(t,e,n)).points[0];if(i.containsPoint(s)){var a=new L(t).move(s,-sr(n,ar(t,s))/2),l=new L(e).move(o,-sr(i,ar(e,o))/2),c=new M(a,l).midpoint(),u=fr(t,c,n),h=dr(c,e,u.direction);r.points=[u.points[0],h.points[0]],r.direction=h.direction}}return r}function mr(t,e,n,i,r){var o,s,a,l={},c=n.union(i).inflate(1),u=c.center().distance(e)>c.center().distance(t),h=u?e:t,d=u?t:e;return s=or(o=r?(o=L.fromPolar(c.width+c.height,rr[r],h),c.pointNearestToPoint(o).move(o,-1)):c.pointNearestToPoint(h).move(h,1),d,c),o.round().equals(s.round())?(s=L.fromPolar(c.width+c.height,V(o.theta(h))+Math.PI/2,d),a=or(o,s=c.pointNearestToPoint(s).move(d,1).round(),c),l.points=u?[s,a,o]:[o,a,s]):l.points=u?[s,o]:[o,s],l.direction=ar(u?o:s,e),l}function vr(t,e,n){var i,r=ur(n,e),o=hr(n,e),s=function(t,e){return t.sourceAnchor?t.sourceAnchor:ur(t,e).center()}(n,e),a=function(t,e){return t.targetAnchor?t.targetAnchor:hr(t,e).center()}(n,e);r=r.union(lr(s)),o=o.union(lr(a)),(t=ue(t).map(L)).unshift(s),t.push(a);for(var l=[],c=0,u=t.length-1;c<u;c++){var h=null,d=t[c],f=t[c+1],p=!!ar(d,f);if(0===c)c+1===u?r.intersect(o.clone().inflate(1))?h=mr(d,f,r,o):p||(h=gr(d,f,r,o)):r.containsPoint(f)?h=mr(d,f,r,lr(f).moveAndExpand(cr(e))):p||(h=fr(d,f,r));else if(c+1===u){var g=p&&ar(f,d)===i;o.containsPoint(d)||g?h=mr(d,f,lr(d).moveAndExpand(cr(e)),o,i):p||(h=pr(d,f,o,i))}else p||(h=dr(d,f,i));i=h?(Array.prototype.push.apply(l,h.points),h.direction):ar(d,f),c+1<u&&l.push(f)}return l}var yr={step:10,maximumLoops:2e3,precision:1,maxAllowedDirectionChange:90,perpendicular:!0,excludeEnds:[],excludeTypes:["basic.Text"],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost:function(){return this.step},directions:function(){var t=this.step,e=this.cost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:0,offsetY:t,cost:e},{offsetX:-t,offsetY:0,cost:e},{offsetX:0,offsetY:-t,cost:e}]},penalties:function(){return{0:0,45:this.step/2,90:this.step/2}},paddingBox:function(){var t=this.step;return{x:-t,y:-t,width:2*t,height:2*t}},fallbackRouter:function(t,e,n){if(!le(vr))throw new Error("Manhattan requires the orthogonal router as default fallback.");return vr(t,Jt({},yr,e),n)},fallbackRoute:function(t,e,n){return null},draggingRoute:null};function br(t){this.map={},this.options=t,this.mapGridSize=100}function Cr(){this.items=[],this.hash={},this.values={},this.OPEN=1,this.CLOSE=2}function Ir(t,e){return e&&e.paddingBox?t.sourceBBox.clone().moveAndExpand(e.paddingBox):t.sourceBBox.clone()}function Er(t,e){return e&&e.paddingBox?t.targetBBox.clone().moveAndExpand(e.paddingBox):t.targetBBox.clone()}function Tr(t,e){return t.sourceAnchor?t.sourceAnchor:Ir(t,e).center()}function wr(t,e,n,i,r){var o=360/n,s=t.theta(function(t,e,n,i){var r=i.step,o=e.x-t.x,s=e.y-t.y,a=o/n.x*r,l=s/n.y*r;return new L(t.x+a,t.y+l)}(t,e,i,r)),a=j(s+o/2);return o*Math.floor(a/o)}function xr(t,e){var n=Math.abs(t-e);return 180<n?360-n:n}function _r(t,e){if(!t)return e;var n=Math.abs(t),i=Math.round(n/e);return i?e+(n-i*e)/i:n}function Dr(t,e){return t.round(e)}function Ar(t,e,n){return Dr(function(t,e){var n=e.source,i=G(t.x-n.x,e.x)+n.x,r=G(t.y-n.y,e.y)+n.y;return new L(i,r)}(t.clone(),e),n)}function Or(t){return t.clone().toString()}function Sr(t){return new L(0===t.x?0:Math.abs(t.x)/t.x,0===t.y?0:Math.abs(t.y)/t.y)}function Rr(t,e,n,i,r){for(var o,s=[],a=Sr(r.difference(n)),l=Or(n),c=t[l];c;){var u=Sr((o=e[l]).difference(c));u.equals(a)||(s.unshift(o),a=u),c=t[l=Or(c)]}var h=e[l];return Sr(h.difference(i)).equals(a)||s.unshift(h),s}function kr(t,e){for(var n=1/0,i=0,r=e.length;i<r;i++){var o=t.manhattanDistance(e[i]);o<n&&(n=o)}return n}function Nr(t,e,n,i,r){var o=r.precision,s=r.directionMap,a=t.difference(e.center()),l=De(s)?Object.keys(s):[],c=ue(n),u=l.reduce(function(n,r){if(c.includes(r)){for(var l,u=s[r],h=new L(t.x+u.x*(Math.abs(a.x)+e.width),t.y+u.y*(Math.abs(a.y)+e.height)),d=new M(t,h).intersect(e)||[],f=d.length,p=null,g=0;g<f;g++){var m=d[g],v=t.squaredDistance(m);(void 0===l||l<v)&&(l=v,p=m)}if(p){var y=Ar(p,i,o);e.containsPoint(y)&&(y=Ar(y.offset(u.x*i.x,u.y*i.y),i,o)),n.push(y)}}return n},[]);return e.containsPoint(t)||u.push(Ar(t,i,o)),u}function Mr(t,e,n,i){var r,o,s=i.precision;r=Dr(t instanceof B?Tr(this,i).clone():t.clone(),s),o=Dr(e instanceof B?function(t,e){return t.targetAnchor?t.targetAnchor:Er(t,e).center()}(this,i).clone():e.clone(),s);var a,l,c,u,h=function(t,e,n){return{source:e.clone(),x:_r(n.x-e.x,t),y:_r(n.y-e.y,t)}}(i.step,r,o);if(c=t instanceof B?Nr(a=r,t,i.startDirections,h,i):[a=r],u=e instanceof B?Nr(l=o,e,i.endDirections,h,i):[l=o],c=c.filter(n.isPointAccessible,n),u=u.filter(n.isPointAccessible,n),0<c.length&&0<u.length){for(var d=new Cr,f={},p={},g={},m=0,v=c.length;m<v;m++){var y=c[m],b=Or(y);d.add(b,kr(y,u)),f[b]=y,g[b]=0}var C,I,E=i.previousDirectionAngle,T=void 0===E,w=i.directions;!function(t,e,n){var i=n.step;ue(n.directions).forEach(function(t){t.gridOffsetX=t.offsetX/i*e.x,t.gridOffsetY=t.offsetY/i*e.y})}(0,h,i);for(var x=w.length,_=ue(u).reduce(function(t,e){var n=Or(e);return t.push(n),t},[]),D=i.maximumLoops;!d.isEmpty()&&0<D;){var A,O=d.pop(),S=f[O],R=p[O],k=g[O],N=void 0===R,M=S.equals(a);A=N?T?M?null:wr(a,S,x,h,i):E:wr(R,S,x,h,i);var P=ae(c,u);if((!N||!P)&&0<=_.indexOf(O))return i.previousDirectionAngle=A,Rr(p,f,S,a,l);for(m=0;m<x;m++){var L=(C=w[m]).angle;if(I=xr(A,L),T&&M||!(I>i.maxAllowedDirectionChange)){var K=Ar(S.clone().offset(C.gridOffsetX,C.gridOffsetY),h,s),z=Or(K);if(!d.isClose(z)&&n.isPointAccessible(K)){if(0<=_.indexOf(z)&&!K.equals(l)&&xr(L,wr(K,l,x,h,i))>i.maxAllowedDirectionChange)continue;var j=k+C.cost+(M?0:i.penalties[I]);(!d.isOpen(z)||j<g[z])&&(f[z]=K,p[z]=S,g[z]=j,d.add(z,j+kr(K,u)))}}}D--}}return i.fallbackRoute.call(this,a,l,i)}function Pr(t,e,n){return function(t,e,n){!function(t){if(t.directions=Ce(t,"directions"),t.penalties=Ce(t,"penalties"),t.paddingBox=Ce(t,"paddingBox"),t.padding=Ce(t,"padding"),t.padding){var e=Ft(t.padding);t.paddingBox={x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}ue(t.directions).forEach(function(t){var e=new L(0,0),n=new L(t.offsetX,t.offsetY);t.angle=j(e.theta(n))})}(e),n.options.perpendicular=!!e.perpendicular;for(var i,r,o=Ir(n,e),s=Er(n,e),a=Tr(n,e),l=new br(e).build(n.paper.model,n.model),c=ue(t).map(L),u=[],h=a,d=0,f=c.length;d<=f;d++){var p=null;if(r=i||o,!(i=c[d])&&(i=s,(!n.model.get("source").id||!n.model.get("target").id)&&le(e.draggingRoute))){var g=r===o?a:r,m=i.origin();p=e.draggingRoute.call(n,g,m,e)}if(null===(p=p||Mr.call(n,r,i,l,e)))return e.fallbackRouter(t,e,n);var v=p[0];v&&v.equals(h)&&p.shift(),h=p[p.length-1]||h,Array.prototype.push.apply(u,p)}return u}(t,Jt({},yr,e),n)}br.prototype.build=function(t,e){var n=this.options,i=ue(n.excludeEnds).reduce(function(n,i){var r=e.get(i);if(r){var o=t.getCell(r.id);o&&n.push(o)}return n},[]),r=[],o=t.getCell(e.get("source").id);o&&(r=ye(r,o.getAncestors().map(function(t){return t.id})));var s=t.getCell(e.get("target").id);s&&(r=ye(r,s.getAncestors().map(function(t){return t.id})));var a=this.mapGridSize;return t.getElements().reduce(function(t,e){var o=ue(n.excludeTypes).includes(e.get("type")),s=i.find(function(t){return t.id===e.id}),l=r.includes(e.id);if(!(o||s||l))for(var c=e.getBBox().moveAndExpand(n.paddingBox),u=c.origin().snapToGrid(a),h=c.corner().snapToGrid(a),d=u.x;d<=h.x;d+=a)for(var f=u.y;f<=h.y;f+=a){var p=d+"@"+f;t[p]=t[p]||[],t[p].push(c)}return t},this.map),this},br.prototype.isPointAccessible=function(t){var e=t.clone().snapToGrid(this.mapGridSize).toString();return ue(this.map[e]).every(function(e){return!e.containsPoint(t)})},Cr.prototype.add=function(t,e){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=this.OPEN,this.values[t]=e;var n=ne(this.items,t,(function(t){return this.values[t]}).bind(this));this.items.splice(n,0,t)},Cr.prototype.remove=function(t){this.hash[t]=this.CLOSE},Cr.prototype.isOpen=function(t){return this.hash[t]===this.OPEN},Cr.prototype.isClose=function(t){return this.hash[t]===this.CLOSE},Cr.prototype.isEmpty=function(){return 0===this.items.length},Cr.prototype.pop=function(){var t=this.items.shift();return this.remove(t),t};var Lr={maxAllowedDirectionChange:45,diagonalCost:function(){var t=this.step;return Math.ceil(Math.sqrt(t*t<<1))},directions:function(){var t=this.step,e=this.cost(),n=this.diagonalCost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:t,offsetY:t,cost:n},{offsetX:0,offsetY:t,cost:e},{offsetX:-t,offsetY:t,cost:n},{offsetX:-t,offsetY:0,cost:e},{offsetX:-t,offsetY:-t,cost:n},{offsetX:0,offsetY:-t,cost:e},{offsetX:t,offsetY:-t,cost:n}]},fallbackRoute:function(t,e,n){var i=t.theta(e),r=[],o={x:e.x,y:t.y},s={x:t.x,y:e.y};if(90<i%180){var a=o;o=s,s=a}var l=i%90<45?o:s,c=new M(t,l),u=90*Math.ceil(i/90),h=L.fromPolar(c.squaredLength(),V(135+u),l),d=new M(e,h),f=c.intersection(d),p=f||e,g=f?p:t,m=360/n.directions.length,v=g.theta(e),y=j(v+m/2),b=m*Math.floor(y/m);return n.previousDirectionAngle=b,p&&r.push(p.round()),r.push(e),r}},Kr={normal:function(t,e,n){return t},oneSide:function(t,e,n){var i,r,o,s=e.side||"bottom",a=Ft(e.padding||40),l=n.sourceBBox,c=n.targetBBox,u=l.center(),h=c.center();switch(s){case"bottom":o=1,i="y",r="height";break;case"top":o=-1,i="y",r="height";break;case"left":o=-1,i="x",r="width";break;case"right":o=1,i="x",r="width";break;default:throw new Error("Router: invalid side")}return u[i]+=o*(l[r]/2+a[s]),h[i]+=o*(c[r]/2+a[s]),0<o*(u[i]-h[i])?h[i]=u[i]:u[i]=h[i],[u].concat(t,h)},orthogonal:vr,manhattan:Pr,metro:function(t,e,n){if(!le(Pr))throw new Error("Metro requires the manhattan router.");return Pr(t,Jt({},Lr,e),n)}};function Br(t){return function(e,n,i,r){if(i instanceof Element){var o,s=this.paper.findView(i);return o=s?s.isNodeConnection(i)?zr(s,"fixedAt"in r?r.fixedAt:"50%"):s.getNodeBBox(i).center():new L,t.call(this,e,n,o,r)}return t.apply(this,arguments)}}function zr(t,e){var n=parseFloat(e);return jt(e)?t.getPointAtRatio(n/100):t.getPointAtLength(n)}var jr=Br(function(t,e,n,i){var r=t.getConnection(),o=t.getConnectionSubdivisions(),s=new M(n.clone().offset(0,1e6),n.clone().offset(0,-1e6)),a=new M(n.clone().offset(1e6,0),n.clone().offset(-1e6,0)),l=s.intersect(r,{segmentSubdivisions:o}),c=a.intersect(r,{segmentSubdivisions:o}),u=[];return l&&Array.prototype.push.apply(u,l),c&&Array.prototype.push.apply(u,c),0<u.length?n.chooseClosest(u):"fallbackAt"in i?zr(t,i.fallbackAt):Gr(t,e,n,i)}),Gr=Br(function(t,e,n,i){return t.getClosestPoint(n)||new L}),Fr={resolveRef:Br,connectionRatio:function(t,e,n,i){var r="ratio"in i?i.ratio:.5;return t.getPointAtRatio(r)},connectionLength:function(t,e,n,i){var r="length"in i?i.length:20;return t.getPointAtLength(r)},connectionPerpendicular:jr,connectionClosest:Gr};function Vr(t){return function(e,n,i,r){var o=!!r.rotate,s=o?e.getNodeUnrotatedBBox(n):e.getNodeBBox(n),a=s[t](),l=r.dx;if(l){var c=jt(l);l=parseFloat(l),isFinite(l)&&(c&&(l/=100,l*=s.width),a.x+=l)}var u=r.dy;if(u){var h=jt(u);u=parseFloat(u),isFinite(u)&&(h&&(u/=100,u*=s.height),a.y+=u)}return o?a.rotate(e.model.getBBox().center(),-e.model.angle()):a}}var Hr={center:Vr("center"),top:Vr("topMiddle"),bottom:Vr("bottomMiddle"),left:Vr("leftMiddle"),right:Vr("rightMiddle"),topLeft:Vr("origin"),topRight:Vr("topRight"),bottomLeft:Vr("bottomLeft"),bottomRight:Vr("corner"),perpendicular:Br(function(t,e,n,i){var r=t.model.angle(),o=t.getNodeBBox(e),s=o.center(),a=o.origin(),l=o.corner(),c=i.padding;if(isFinite(c)||(c=0),a.y+c<=n.y&&n.y<=l.y-c){var u=n.y-s.y;s.x+=0===r||180===r?0:1*u/Math.tan(V(r)),s.y+=u}else if(a.x+c<=n.x&&n.x<=l.x-c){var h=n.x-s.x;s.y+=90===r||270===r?0:h*Math.tan(V(r)),s.x+=h}return s}),midSide:Br(function(t,e,n,i){var r,o,s,a=!!i.rotate;a?(r=t.getNodeUnrotatedBBox(e),s=t.model.getBBox().center(),o=t.model.angle()):r=t.getNodeBBox(e);var l,c=i.padding;switch(isFinite(c)&&r.inflate(c),a&&n.rotate(s,o),r.sideNearestToPoint(n)){case"left":l=r.leftMiddle();break;case"right":l=r.rightMiddle();break;case"top":l=r.topMiddle();break;case"bottom":l=r.bottomMiddle()}return a?l.rotate(s,-o):l}),modelCenter:function(t,e,n,i,r){return t.model.getPointFromConnectedLink(this.model,r).offset(i.dx,i.dy)}},Ur=e.Collection.extend({initialize:function(t,e){e.cellNamespace?this.cellNamespace=e.cellNamespace:this.cellNamespace="undefined"!=typeof joint&&be(joint,"shapes")?joint.shapes:null,this.graph=e.graph},model:function(t,e){var n=e.collection,i=n.cellNamespace,r=new("link"===t.type?kn:dt(i,t.type,".")||un)(t,e);return e.dry||(r.graph=n.graph),r},comparator:function(t){return t.get("z")||0}}),Zr=e.Model.extend({_batches:{},initialize:function(t,n){var i=new Ur([],{model:(n=n||{}).cellModel,cellNamespace:n.cellNamespace,graph:this});e.Model.prototype.set.call(this,"cells",i),i.on("all",this.trigger,this),this.on("change:z",this._sortOnChangeZ,this),this._out={},this._in={},this._nodes={},this._edges={},i.on("add",this._restructureOnAdd,this),i.on("remove",this._restructureOnRemove,this),i.on("reset",this._restructureOnReset,this),i.on("change:source",this._restructureOnChangeSource,this),i.on("change:target",this._restructureOnChangeTarget,this),i.on("remove",this._removeCell,this)},_sortOnChangeZ:function(){this.get("cells").sort()},_restructureOnAdd:function(t){if(t.isLink()){this._edges[t.id]=!0;var e=t.attributes,n=e.source,i=e.target;n.id&&((this._out[n.id]||(this._out[n.id]={}))[t.id]=!0),i.id&&((this._in[i.id]||(this._in[i.id]={}))[t.id]=!0)}else this._nodes[t.id]=!0},_restructureOnRemove:function(t){if(t.isLink()){delete this._edges[t.id];var e=t.attributes,n=e.source,i=e.target;n.id&&this._out[n.id]&&this._out[n.id][t.id]&&delete this._out[n.id][t.id],i.id&&this._in[i.id]&&this._in[i.id][t.id]&&delete this._in[i.id][t.id]}else delete this._nodes[t.id]},_restructureOnReset:function(t){t=t.models,this._out={},this._in={},this._nodes={},this._edges={},t.forEach(this._restructureOnAdd,this)},_restructureOnChangeSource:function(t){var e=t.previous("source");e.id&&this._out[e.id]&&delete this._out[e.id][t.id];var n=t.attributes.source;n.id&&((this._out[n.id]||(this._out[n.id]={}))[t.id]=!0)},_restructureOnChangeTarget:function(t){var e=t.previous("target");e.id&&this._in[e.id]&&delete this._in[e.id][t.id];var n=t.get("target");n.id&&((this._in[n.id]||(this._in[n.id]={}))[t.id]=!0)},getOutboundEdges:function(t){return this._out&&this._out[t]||{}},getInboundEdges:function(t){return this._in&&this._in[t]||{}},toJSON:function(){var t=e.Model.prototype.toJSON.apply(this,arguments);return t.cells=this.get("cells").toJSON(),t},fromJSON:function(t,e){if(!t.cells)throw new Error("Graph JSON must contain cells array.");return this.set(t,e)},set:function(t,n,i){var r;return"object"==typeof t?(r=t,i=n):(r={})[t]=n,r.hasOwnProperty("cells")&&(this.resetCells(r.cells,i),r=Ie(r,"cells")),e.Model.prototype.set.call(this,r,i)},clear:function(t){t=Jt({},t,{clear:!0});var e=this.get("cells");if(0===e.length)return this;this.startBatch("clear",t);for(var n=e.sortBy(function(t){return t.isLink()?1:2});n.shift().remove(t),0<n.length;);return this.stopBatch("clear"),this},_prepareCell:function(t,n){var i;if(t instanceof e.Model?(i=t.attributes,t.graph||n&&n.dry||(t.graph=this)):i=t,!Ae(i.type))throw new TypeError("dia.Graph: cell type must be a string.");return t},minZIndex:function(){var t=this.get("cells").first();return t&&t.get("z")||0},maxZIndex:function(){var t=this.get("cells").last();return t&&t.get("z")||0},addCell:function(t,n){return Array.isArray(t)?this.addCells(t,n):(t instanceof e.Model?t.has("z")||t.set("z",this.maxZIndex()+1):void 0===t.z&&(t.z=this.maxZIndex()+1),this.get("cells").add(this._prepareCell(t,n),n||{}),this)},addCells:function(t,e){return 0===t.length||(t=pe(t),e.maxPosition=e.position=t.length-1,this.startBatch("add",e),t.forEach(function(t){this.addCell(t,e),e.position--},this),this.stopBatch("add",e)),this},resetCells:function(t,e){var n=ue(t).map(function(t){return this._prepareCell(t,e)},this);return this.get("cells").reset(n,e),this},removeCells:function(t,e){return t.length&&(this.startBatch("remove"),ee(t,"remove",e),this.stopBatch("remove")),this},_removeCell:function(t,e,n){(n=n||{}).clear||(n.disconnectLinks?this.disconnectLinks(t,n):this.removeLinks(t,n)),this.get("cells").remove(t,{silent:!0}),t.graph===this&&(t.graph=null)},getCell:function(t){return this.get("cells").get(t)},getCells:function(){return this.get("cells").toArray()},getElements:function(){return Object.keys(this._nodes).map(this.getCell,this)},getLinks:function(){return Object.keys(this._edges).map(this.getCell,this)},getFirstCell:function(){return this.get("cells").first()},getLastCell:function(){return this.get("cells").last()},getConnectedLinks:function(t,e){var n=(e=e||{}).indirect,i=e.inbound,r=e.outbound;void 0===i&&void 0===r&&(i=r=!0);var o=[],s={};function a(t,e){if(we(t.getOutboundEdges(e.id),(function(e,c){if(!s[c]){var u=t.getCell(c);o.push(u),s[c]=!0,n&&(i&&l(t,u),r&&a(t,u))}}).bind(t)),n&&e.isLink()){var c=e.getTargetCell();c&&c.isLink()&&(s[c.id]||(o.push(c),a(t,c)))}}function l(t,e){if(we(t.getInboundEdges(e.id),(function(e,c){if(!s[c]){var u=t.getCell(c);o.push(u),s[c]=!0,n&&(i&&l(t,u),r&&a(t,u))}}).bind(t)),n&&e.isLink()){var c=e.getSourceCell();c&&c.isLink()&&(s[c.id]||(o.push(c),l(t,c)))}}if(r&&a(this,t),i&&l(this,t),e.deep){var c=t.getEmbeddedCells({deep:!0}),u={};c.forEach(function(t){t.isElement()&&(u[t.id]=!0)}),c.forEach(function(t){t.isLink()||(r&&we(this.getOutboundEdges(t.id),(function(t,n){if(!s[n]){var i=this.getCell(n).attributes,r=i.source,a=i.target,l=r.id,c=a.id;if(!e.includeEnclosed&&l&&u[l]&&c&&u[c])return;o.push(this.getCell(n)),s[n]=!0}}).bind(this)),i&&we(this.getInboundEdges(t.id),(function(t,n){if(!s[n]){var i=this.getCell(n).attributes,r=i.source,a=i.target,l=r.id,c=a.id;if(!e.includeEnclosed&&l&&u[l]&&c&&u[c])return;o.push(this.getCell(n)),s[n]=!0}}).bind(this)))},this)}return o},getNeighbors:function(t,e){var n=(e=e||{}).inbound,i=e.outbound;void 0===n&&void 0===i&&(n=i=!0);var r=this.getConnectedLinks(t,e).reduce((function(r,o){var s=o.attributes,a=s.source,l=s.target,c=o.hasLoop(e);if(n&&be(a,"id")&&!r[a.id]){var u=this.getCell(a.id);u.isElement()&&(!c&&(!u||u===t||e.deep&&u.isEmbeddedIn(t))||(r[a.id]=u))}if(i&&be(l,"id")&&!r[l.id]){var h=this.getCell(l.id);h.isElement()&&(!c&&(!h||h===t||e.deep&&h.isEmbeddedIn(t))||(r[l.id]=h))}return r}).bind(this),{});if(t.isLink()){if(n){var o=t.getSourceCell();o&&o.isElement()&&!r[o.id]&&(r[o.id]=o)}if(i){var s=t.getTargetCell();s&&s.isElement()&&!r[s.id]&&(r[s.id]=s)}}return ue(r)},getCommonAncestor:function(){var t=Array.from(arguments).map(function(t){for(var e=[],n=t.get("parent");n;)e.push(n),n=this.getCell(n).get("parent");return e},this);t=t.sort(function(t,e){return t.length-e.length});var e=ue(t.shift()).find(function(e){return t.every(function(t){return t.includes(e)})});return this.getCell(e)},getSuccessors:function(t,e){e=e||{};var n=[];return this.search(t,function(e){e!==t&&n.push(e)},Jt({},e,{outbound:!0})),n},cloneCells:Se,cloneSubgraph:function(t,e){var n=this.getSubgraph(t,e);return this.cloneCells(n)},getSubgraph:function(t,e){e=e||{};var n=[],i={},r=[],o=[];return ue(t).forEach(function(t){i[t.id]||(n.push(t),(i[t.id]=t).isLink()?o.push(t):r.push(t)),e.deep&&t.getEmbeddedCells({deep:!0}).forEach(function(t){i[t.id]||(n.push(t),(i[t.id]=t).isLink()?o.push(t):r.push(t))})}),o.forEach(function(t){var e=t.attributes,o=e.source,s=e.target;if(o.id&&!i[o.id]){var a=this.getCell(o.id);n.push(a),i[a.id]=a,r.push(a)}if(s.id&&!i[s.id]){var l=this.getCell(s.id);n.push(this.getCell(s.id)),i[l.id]=l,r.push(l)}},this),r.forEach(function(t){this.getConnectedLinks(t,e).forEach(function(t){var e=t.attributes,r=e.source,o=e.target;!i[t.id]&&r.id&&i[r.id]&&o.id&&i[o.id]&&(n.push(t),i[t.id]=t)})},this),n},getPredecessors:function(t,e){e=e||{};var n=[];return this.search(t,function(e){e!==t&&n.push(e)},Jt({},e,{inbound:!0})),n},search:function(t,e,n){(n=n||{}).breadthFirst?this.bfs(t,e,n):this.dfs(t,e,n)},bfs:function(t,e,n){void 0===n&&(n={});var i={},r={},o=[];for(o.push(t),r[t.id]=0;0<o.length;){var s=o.shift();if(!i[s.id]&&!(i[s.id]=!0)!==e.call(this,s,r[s.id]))for(var a=this.getNeighbors(s,n),l=0,c=a.length;l<c;l++){var u=a[l];r[u.id]=r[s.id]+1,o.push(u)}}},dfs:function(t,e,n){void 0===n&&(n={});var i={},r={},o=[];for(o.push(t),r[t.id]=0;0<o.length;){var s=o.pop();if(!i[s.id]&&!(i[s.id]=!0)!==e.call(this,s,r[s.id]))for(var a=this.getNeighbors(s,n),l=o.length,c=0,u=a.length;c<u;c++){var h=a[c];r[h.id]=r[s.id]+1,o.splice(l,0,h)}}},getSources:function(){var t=[];return we(this._nodes,(function(e,n){this._in[n]&&!se(this._in[n])||t.push(this.getCell(n))}).bind(this)),t},getSinks:function(){var t=[];return we(this._nodes,(function(e,n){this._out[n]&&!se(this._out[n])||t.push(this.getCell(n))}).bind(this)),t},isSource:function(t){return!this._in[t.id]||se(this._in[t.id])},isSink:function(t){return!this._out[t.id]||se(this._out[t.id])},isSuccessor:function(t,e){var n=!1;return this.search(t,function(i){if(i===e&&i!==t)return!(n=!0)},{outbound:!0}),n},isPredecessor:function(t,e){var n=!1;return this.search(t,function(i){if(i===e&&i!==t)return!(n=!0)},{inbound:!0}),n},isNeighbor:function(t,e,n){var i=(n=n||{}).inbound,r=n.outbound;void 0===i&&void 0===r&&(i=r=!0);var o=!1;return this.getConnectedLinks(t,n).forEach(function(t){var n=t.attributes,s=n.source,a=n.target;return i&&be(s,"id")&&s.id===e.id||r&&be(a,"id")&&a.id===e.id?!(o=!0):void 0}),o},disconnectLinks:function(t,e){this.getConnectedLinks(t).forEach(function(n){n.set(n.attributes.source.id===t.id?"source":"target",{x:0,y:0},e)})},removeLinks:function(t,e){ee(this.getConnectedLinks(t),"remove",e)},findModelsFromPoint:function(t){return this.getElements().filter(function(e){return e.getBBox().containsPoint(t)})},findModelsInArea:function(t,e){t=Y(t);var n=(e=Qt(e||{},{strict:!1})).strict?"containsRect":"intersect";return this.getElements().filter(function(e){return t[n](e.getBBox())})},findModelsUnderElement:function(t,e){e=Qt(e||{},{searchBy:"bbox"});var n=t.getBBox();return("bbox"===e.searchBy?this.findModelsInArea(n):this.findModelsFromPoint(n[e.searchBy]())).filter(function(e){return t.id!==e.id&&!e.isEmbeddedIn(t)})},getBBox:function(){return this.getCellsBBox(this.getCells())},getCellsBBox:function(t,e){return e=e||{},ue(t).reduce(function(t,n){var i=n.getBBox(e);if(!i)return t;var r=n.angle();return r&&(i=i.bbox(r)),t?t.union(i):i},null)},translate:function(t,e,n){var i=this.getCells().filter(function(t){return!t.isEmbedded()});return ee(i,"translate",t,e,n),this},resize:function(t,e,n){return this.resizeCells(t,e,this.getCells(),n)},resizeCells:function(t,e,n,i){var r=this.getCellsBBox(n);if(r){var o=Math.max(t/r.width,0),s=Math.max(e/r.height,0);ee(n,"scale",o,s,r.origin(),i)}return this},startBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)+1,this.trigger("batch:start",Jt({},e,{batchName:t}))},stopBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)-1,this.trigger("batch:stop",Jt({},e,{batchName:t}))},hasActiveBatch:function(t){var e=this._batches;return(0===arguments.length?ue(e):Array.isArray(t)?t:[t]).some(function(t){return 0<e[t]})}},{validations:{multiLinks:function(t,e){var n=e.attributes,i=n.source,r=n.target;if(i.id&&r.id){var o=e.getSourceCell();if(o&&1<t.getConnectedLinks(o,{outbound:!0}).filter(function(t){var e=t.attributes,n=e.source,o=e.target;return n&&n.id===i.id&&(!n.port||n.port===i.port)&&o&&o.id===r.id&&(!o.port||o.port===r.port)}).length)return!1}return!0},linkPinning:function(t,e){var n=e.attributes,i=n.source,r=n.target;return i.id&&r.id}}});He(Zr.prototype,["resetCells","addCells","removeCells"],We.cells);var Wr=pn.extend({className:function(){var t=pn.prototype.className.apply(this).split(" ");return t.push("link"),t.join(" ")},options:{shortLinkLength:105,doubleLinkTools:!1,longLinkLength:155,linkToolsOffset:40,doubleLinkToolsOffset:65,sampleInterval:50},_labelCache:null,_labelSelectors:null,_markerCache:null,_V:null,_dragData:null,metrics:null,decimalsRounding:2,initialize:function(){pn.prototype.initialize.apply(this,arguments),this._labelCache={},this._labelSelectors={},this._markerCache={},this._V={},this.metrics={}},presentationAttributes:{markup:["RENDER"],attrs:["UPDATE"],router:["UPDATE"],connector:["UPDATE"],smooth:["UPDATE"],manhattan:["UPDATE"],toolMarkup:["TOOLS"],labels:["LABELS"],labelMarkup:["LABELS"],vertices:["VERTICES","UPDATE"],vertexMarkup:["VERTICES"],source:["SOURCE","UPDATE"],target:["TARGET","UPDATE"]},initFlag:["RENDER","SOURCE","TARGET"],UPDATE_PRIORITY:1,confirmUpdate:function(t,e){if(e=e||{},this.hasFlag(t,"SOURCE")){if(!this.updateEndProperties("source"))return t;t=this.removeFlag(t,"SOURCE")}if(this.hasFlag(t,"TARGET")){if(!this.updateEndProperties("target"))return t;t=this.removeFlag(t,"TARGET")}var n=this.paper,i=this.sourceView,r=this.targetView;if(n&&(i&&!n.isViewMounted(i)||r&&!n.isViewMounted(r)))return t;if(this.hasFlag(t,"RENDER"))return this.render(),this.removeFlag(t,["RENDER","UPDATE","VERTICES","TOOLS","LABELS"]);this.hasFlag(t,"VERTICES")&&(this.renderVertexMarkers(),t=this.removeFlag(t,"VERTICES"));var o=this.model,s=o.attributes;return this.hasFlag(t,"UPDATE")&&(this.update(o,null,e),t=this.removeFlag(t,"UPDATE")),this.hasFlag(t,"LABELS")&&(this.onLabelsChange(o,s.labels,e),t=this.removeFlag(t,"LABELS")),this.hasFlag(t,"TOOLS")&&(this.renderTools().updateToolsPosition(),t=this.removeFlag(t,"TOOLS")),t},isLabelsRenderRequired:function(t){void 0===t&&(t={});var e=this.model.previous("labels");if(!e)return!0;if("propertyPathArray"in t&&"propertyValue"in t){var n=t.propertyPathArray||[],i=n.length;if(1<i&&e[n[1]]){if(2===i)return"markup"in Object(t.propertyValue);if("markup"!==n[2])return!1}}return!0},onLabelsChange:function(t,e,n){this.isLabelsRenderRequired(n)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()},render:function(){return this.vel.empty(),this._V={},this.renderMarkup(),this.renderLabels(),this.update(),this},renderMarkup:function(){var t=this.model,e=t.get("markup")||t.markup;if(!e)throw new Error("dia.LinkView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if("string"==typeof e)return this.renderStringMarkup(e);throw new Error("dia.LinkView: invalid markup")},renderJSONMarkup:function(t){var e=this.parseDOMJSON(t,this.el);this.selectors=e.selectors,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=Mt(t);Array.isArray(e)||(e=[e]);for(var n=this._V,r=0,o=e.length;r<o;r++){var s=e[r],a=s.attr("class");a&&(a=ct(a),n[i.camelCase(a)]=s)}this.renderTools(),this.renderVertexMarkers(),this.renderArrowheadMarkers(),this.vel.append(e)},_getLabelMarkup:function(t){if(t){if(Array.isArray(t))return this.parseDOMJSON(t,null);if("string"==typeof t)return this._getLabelStringMarkup(t);throw new Error("dia.linkView: invalid label markup")}},_getLabelStringMarkup:function(t){var e=Mt(t),n=document.createDocumentFragment();if(Array.isArray(e))for(var i=0,r=e.length;i<r;i++){var o=e[i].node;n.appendChild(o)}else n.appendChild(e.node);return{fragment:n,selectors:{}}},_normalizeLabelMarkup:function(t){if(t){var e,n=t.fragment;if(!(t.fragment instanceof DocumentFragment&&t.fragment.hasChildNodes()))throw new Error("dia.LinkView: invalid label markup.");var i=n.childNodes;return(e=1<i.length||"G"!==i[0].nodeName.toUpperCase()?Mt("g").append(n):Mt(i[0])).addClass("label"),{node:e.node,selectors:t.selectors}}},renderLabels:function(){var t=this._V,e=t.labels,n=this._labelCache={},i=this._labelSelectors={},r=this.model,o=r.attributes.labels||[],s=o.length;if(0===s)return e&&e.remove(),this;e?e.empty():e=t.labels=Mt("g").addClass("labels");for(var a=e.node,l=0;l<s;l++){var c,u,h=o[l],d=this._normalizeLabelMarkup(this._getLabelMarkup(h.markup));if(d)c=d.node,u=d.selectors;else{var f=r._builtins.defaultLabel,p=this._normalizeLabelMarkup(this._getLabelMarkup(f.markup)),g=r._getDefaultLabel(),m=this._normalizeLabelMarkup(this._getLabelMarkup(g.markup))||p;c=m.node,u=m.selectors}c.setAttribute("label-idx",l),a.appendChild(c),n[l]=c;var v=this.selector;if(u[v])throw new Error("dia.LinkView: ambiguous label root selector.");u[v]=c,i[l]=u}return a.parentNode||this.el.appendChild(a),this.updateLabels(),this},_mergeLabelAttrs:function(t,e,n,i){return null===e?null:void 0!==e?t?At({},n,e):At({},i,n,e):null===n?null:void 0!==n?t?n:At({},i,n):t?void 0:i},updateLabels:function(){if(!this._V.labels)return this;for(var t=this.model,e=t.get("labels")||[],n=this.can("labelMove"),i=t._builtins.defaultLabel.attrs,r=t._getDefaultLabel(),o=r.markup,s=r.attrs,a=0,l=e.length;a<l;a++){var c=this._labelCache[a];c.setAttribute("cursor",n?"move":"default");var u=this._labelSelectors[a],h=e[a],d=h.markup,f=h.attrs,p=this._mergeLabelAttrs(d||o,f,s,i);this.updateDOMSubtreeAttributes(c,p,{rootBBox:new B(h.size),selectors:u})}return this},renderTools:function(){if(!this._V.linkTools)return this;var t,e=i(this._V.linkTools.node).empty(),n=Wt(this.model.get("toolMarkup")||this.model.toolMarkup),r=Mt(n());return e.append(r.node),this._toolCache=r,this.options.doubleLinkTools&&(t=this.model.get("doubleToolMarkup")||this.model.doubleToolMarkup?(n=Wt(this.model.get("doubleToolMarkup")||this.model.doubleToolMarkup),Mt(n())):r.clone(),e.append(t.node),this._tool2Cache=t),this},renderVertexMarkers:function(){if(!this._V.markerVertices)return this;var t=i(this._V.markerVertices.node).empty(),e=Wt(this.model.get("vertexMarkup")||this.model.vertexMarkup);return this.model.vertices().forEach(function(n,i){t.append(Mt(e(Jt({idx:i},n))).node)}),this},renderArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;var t=i(this._V.markerArrowheads.node);t.empty();var e=Wt(this.model.get("arrowheadMarkup")||this.model.arrowheadMarkup);return this._V.sourceArrowhead=Mt(e({end:"source"})),this._V.targetArrowhead=Mt(e({end:"target"})),t.append(this._V.sourceArrowhead.node,this._V.targetArrowhead.node),this},update:function(t,e,n){return n=n||{},this.cleanNodesCache(),this.updateConnection(n),this.updateDOMSubtreeAttributes(this.el,this.model.attr(),{selectors:this.selectors}),this.updateDefaultConnectionPath(),this.updateLabelPositions(),this.updateToolsPosition(),this.updateArrowheadMarkers(),this.updateTools(n),this.options.perpendicular=null,this},removeRedundantLinearVertices:function(t){var e=this.model,n=e.vertices(),i=[this.sourceAnchor].concat(n,[this.targetAnchor]),r=i.length,o=new K(i);o.simplify({threshold:.001});var s=o.points.map(function(t){return t.toJSON()}),a=s.length;return r===a?0:(e.vertices(s.slice(1,a-1),t),r-a)},updateDefaultConnectionPath:function(){var t=this._V;t.connection&&t.connection.attr("d",this.getSerializedConnection()),t.connectionWrap&&t.connectionWrap.attr("d",this.getSerializedConnection()),t.markerSource&&t.markerTarget&&this._translateAndAutoOrientArrows(t.markerSource,t.markerTarget)},getEndView:function(t){switch(t){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error("dia.LinkView: type parameter required.")}},getEndAnchor:function(t){switch(t){case"source":return new L(this.sourceAnchor);case"target":return new L(this.targetAnchor);default:throw new Error("dia.LinkView: type parameter required.")}},getEndMagnet:function(t){switch(t){case"source":var e=this.sourceView;if(!e)break;return this.sourceMagnet||e.el;case"target":var n=this.targetView;if(!n)break;return this.targetMagnet||n.el;default:throw new Error("dia.LinkView: type parameter required.")}return null},updateConnection:function(t){t=t||{};var e,n,i=this.model;if(t.translateBy&&i.isRelationshipEmbeddedIn(t.translateBy)){var r=t.tx||0,o=t.ty||0;e=new K(this.route).translate(r,o).points,this._translateConnectionPoints(r,o),(n=this.path).translate(r,o)}else{var s=i.vertices(),a=this.findAnchors(s),l=this.sourceAnchor=a.source,c=this.targetAnchor=a.target;e=this.findRoute(s,t);var u=this.findConnectionPoints(e,l,c),h=this.sourcePoint=u.source,d=this.targetPoint=u.target,f=this.findMarkerPoints(e,h,d);n=this.findPath(e,f.source||h,f.target||d)}this.route=e,this.path=n,this.metrics={}},findMarkerPoints:function(t,e,n){var i,r,o=t[0],s=t[t.length-1],a=this._markerCache;return this._V.markerSource&&(a.sourceBBox=a.sourceBBox||this._V.markerSource.getBBox(),i=L(e).move(o||n,a.sourceBBox.width*this._V.markerSource.scale().sx*-1).round()),this._V.markerTarget&&(a.targetBBox=a.targetBBox||this._V.markerTarget.getBBox(),r=L(n).move(s||e,a.targetBBox.width*this._V.markerTarget.scale().sx*-1).round()),a.sourcePoint=i||e.clone(),a.targetPoint=r||n.clone(),{source:i,target:r}},findAnchorsOrdered:function(t,e,n,i){var r,o,s,a,l=this.model,c=l.get(t),u=l.get(n),h=this.getEndView(t),d=this.getEndView(n),f=this.getEndMagnet(t),p=this.getEndMagnet(n);r=h?(s=e?new L(e):d?p:new L(u),this.getAnchor(c.anchor,h,f,s,t)):new L(c),o=d?(a=new L(i||r),this.getAnchor(u.anchor,d,p,a,n)):new L(u);var g={};return g[t]=r,g[n]=o,g},findAnchors:function(t){var e=this.model,n=t[0],i=t[t.length-1];return e.target().priority&&!e.source().priority?this.findAnchorsOrdered("target",i,"source",n):this.findAnchorsOrdered("source",n,"target",i)},findConnectionPoints:function(t,e,n){var i,r,o,s,a=t[0],l=t[t.length-1],c=this.model,u=c.get("source"),h=c.get("target"),d=this.sourceView,f=this.targetView,p=this.paper.options;if(d&&!d.isNodeConnection(this.sourceMagnet)){i=this.sourceMagnet||d.el;var g=u.connectionPoint||p.defaultConnectionPoint,m=new M(a||n,e);o=this.getConnectionPoint(g,d,i,m,"source")}else o=e;if(f&&!f.isNodeConnection(this.targetMagnet)){r=this.targetMagnet||f.el;var v=h.connectionPoint||p.defaultConnectionPoint,y=new M(l||e,n);s=this.getConnectionPoint(v,f,r,y,"target")}else s=n;return{source:o,target:s}},getAnchor:function(t,e,n,i,r){var o,s=e.isNodeConnection(n),a=this.paper.options;if(!(t=t||(s?a.defaultLinkAnchor:a.perpendicularLinks||this.options.perpendicular?{name:"perpendicular"}:a.defaultAnchor)))throw new Error("Anchor required.");if("function"==typeof t)o=t;else{var l=t.name;if("function"!=typeof(o=a[s?"linkAnchorNamespace":"anchorNamespace"][l]))throw new Error("Unknown anchor: "+l)}var c=o.call(this,e,n,i,t.args||{},r,this);return c?c.round(this.decimalsRounding):new L},getConnectionPoint:function(t,e,n,i,r){var o,s,a=i.end,l=this.paper.options;if("function"==typeof l.linkConnectionPoint){var c=n===e.el?void 0:n;if(o=l.linkConnectionPoint(this,e,c,i.start,r))return o}if(!t)return a;if("function"==typeof t)s=t;else{var u=t.name;if("function"!=typeof(s=l.connectionPointNamespace[u]))throw new Error("Unknown connection point: "+u)}return(o=s.call(this,i,e,n,t.args||{},r,this))?o.round(this.decimalsRounding):a},_translateConnectionPoints:function(t,e){var n=this._markerCache;n.sourcePoint.offset(t,e),n.targetPoint.offset(t,e),this.sourcePoint.offset(t,e),this.targetPoint.offset(t,e),this.sourceAnchor.offset(t,e),this.targetAnchor.offset(t,e)},_normalizeLabelPosition:function(t){return"number"==typeof t?{distance:t,offset:null,angle:0,args:null}:t},updateLabelPositions:function(){if(!this._V.labels)return this;if(!this.path)return this;var t=this.model,e=t.get("labels")||[];if(!e.length)return this;for(var n=t._builtins.defaultLabel.position,i=t._getDefaultLabel(),r=At({},n,this._normalizeLabelPosition(i.position)),o=0,s=e.length;o<s;o++){var a=e[o],l=At({},r,this._normalizeLabelPosition(a.position)),c=this._getLabelTransformationMatrix(l);this._labelCache[o].setAttribute("transform",Mt.matrixToTransformString(c))}return this},updateToolsPosition:function(){if(!this._V.linkTools)return this;var t="",e=this.options.linkToolsOffset,n=this.getConnectionLength();if(!Number.isNaN(n)){n<this.options.shortLinkLength&&(t="scale(.5)",e/=2);var i=this.getPointAtLength(e);if(this._toolCache.attr("transform","translate("+i.x+", "+i.y+") "+t),this.options.doubleLinkTools&&n>=this.options.longLinkLength){var r=this.options.doubleLinkToolsOffset||e;i=this.getPointAtLength(n-r),this._tool2Cache.attr("transform","translate("+i.x+", "+i.y+") "+t),this._tool2Cache.attr("visibility","visible")}else this.options.doubleLinkTools&&this._tool2Cache.attr("visibility","hidden")}return this},updateArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;if("none"===i.css(this._V.markerArrowheads.node,"display"))return this;var t=this.getConnectionLength()<this.options.shortLinkLength?.5:1;return this._V.sourceArrowhead.scale(t),this._V.targetArrowhead.scale(t),this._translateAndAutoOrientArrows(this._V.sourceArrowhead,this._V.targetArrowhead),this},updateEndProperties:function(t){var e=this.model,n=this.paper,i=t+"View",r=e.get(t),o=r&&r.id;if(!o)return this[i]=null,this.updateEndMagnet(t),!0;var s=n.getModelById(o);if(!s)throw new Error("LinkView: invalid "+t+" cell.");var a=s.findView(n);return!!a&&(this[i]=a,this.updateEndMagnet(t),!0)},updateEndMagnet:function(t){var e=t+"Magnet",n=this.getEndView(t);if(n){var i=n.getMagnetFromLinkEnd(this.model.get(t));i===n.el&&(i=null),this[e]=i}else this[e]=null},_translateAndAutoOrientArrows:function(t,e){var n=ue(this.route);t&&t.translateAndAutoOrient(this.sourcePoint,n[0]||this.targetPoint,this.paper.cells),e&&e.translateAndAutoOrient(this.targetPoint,n[n.length-1]||this.sourcePoint,this.paper.cells)},_getLabelPositionAngle:function(t){return(this.model.label(t).position||{}).angle||0},_getLabelPositionArgs:function(t){return(this.model.label(t).position||{}).args},_getDefaultLabelPositionArgs:function(){return(this.model._getDefaultLabel().position||{}).args},_mergeLabelPositionArgs:function(t,e){return null===t?null:void 0===t?null===e?null:e:At({},e,t)},addLabel:function(t,e,n,i){var r,o,s,a=0;s="number"!=typeof t?(r=t.x,o=t.y,"number"==typeof e?(a=e,n):e):(r=t,o=e,"number"==typeof n?(a=n,i):n);var l=this._getDefaultLabelPositionArgs(),c=s,u=this._mergeLabelPositionArgs(c,l),h={position:this.getLabelPosition(r,o,a,u)};return this.model.insertLabel(-1,h,s),-1},addVertex:function(t,e,n){var i="number"!=typeof t,r=i?t.x:t,o=i?t.y:e,s=i?e:n,a={x:r,y:o},l=this.getVertexIndex(r,o);return this.model.insertVertex(l,a,s),l},sendToken:function(t,e,n){var i,r,o;o=De(e)?(i=e.duration,r="reverse"===e.direction,e.connection):(i=e,r=!1,null);var s={dur:(i=i||1e3)+"ms",repeatCount:1,calcMode:"linear",fill:"freeze"};r&&(s.keyPoints="1;0",s.keyTimes="0;1");var a,l,c,u=Mt(t);if("string"==typeof o)a=this.findBySelector(o,this.el,this.selectors)[0];else{var h=this._V;a=h.connection?h.connection.node:this.el.querySelector("path")}if(!(a instanceof SVGPathElement))throw new Error("dia.LinkView: token animation requires a valid connection path.");u.appendTo(this.paper.cells).animateAlongPath(s,a),setTimeout((l=u,c=n,function(){l.remove(),"function"==typeof c&&c()}),i)},findRoute:function(t){t=t||[];var e=Kr,n=this.model.router(),i=this.paper.options.defaultRouter;if(!n){if(!i)return t.map(L);n=i}var r=le(n)?n:e[n.name];if(!le(r))throw new Error('dia.LinkView: unknown router: "'+n.name+'".');var o=n.args||{};return r.call(this,t,o,this)||t.map(L)},findPath:function(t,e,n){var i=Gi,r=this.model.connector(),o=this.paper.options.defaultConnector,s=le(r=r||o||{})?r:i[r.name];if(!le(s))throw new Error('dia.LinkView: unknown connector: "'+r.name+'".');var a=re(r.args||{});a.raw=!0;var l=s.call(this,e,n,t,a,this);return"string"==typeof l&&(l=new P(Mt.normalizePathData(l))),l},getConnection:function(){var t=this.path;return t?t.clone():null},getSerializedConnection:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("data"))return e.data;var n=t.serialize();return e.data=n},getConnectionSubdivisions:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("segmentSubdivisions"))return e.segmentSubdivisions;var n=t.getSegmentSubdivisions();return e.segmentSubdivisions=n},getConnectionLength:function(){var t=this.path;if(!t)return 0;var e=this.metrics;if(e.hasOwnProperty("length"))return e.length;var n=t.length({segmentSubdivisions:this.getConnectionSubdivisions()});return e.length=n},getPointAtLength:function(t){var e=this.path;return e?e.pointAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getPointAtRatio:function(t){var e=this.path;return e?(jt(t)&&(t=parseFloat(t)/100),e.pointAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})):null},getTangentAtLength:function(t){var e=this.path;return e?e.tangentAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getTangentAtRatio:function(t){var e=this.path;return e?e.tangentAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPoint:function(t){var e=this.path;return e?e.closestPoint(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointLength:function(t){var e=this.path;return e?e.closestPointLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointRatio:function(t){var e=this.path;return e?e.closestPointNormalizedLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getLabelPosition:function(t,e,n,i){var r,o={},s=0;(r="number"==typeof n?(s=n,i):n)&&(o.args=r);var a,l,c=!(r&&r.absoluteDistance),u=r&&r.absoluteDistance&&r.reverseDistance,h=r&&r.absoluteOffset,d=this.path,f={segmentSubdivisions:this.getConnectionSubdivisions()},p=new L(t,e),g=d.closestPointT(p,f),m=d.lengthAtT(g,f);if(c&&(m=m/this.getConnectionLength()||0),u&&(m=-1*(this.getConnectionLength()-m)||1),o.distance=m,h||(a=d.tangentAtT(g)),a)l=a.pointOffset(p);else{var v=d.pointAtT(g),y=p.difference(v);l={x:y.x,y:y.y}}return o.offset=l,o.angle=s,o},_getLabelTransformationMatrix:function(t){var e,n=0,i={};if("number"==typeof t)e=t;else{if("number"!=typeof t.distance)throw new Error("dia.LinkView: invalid label position distance.");i=t.args||{},e=t.distance,n=t.angle||0}var r=0<e&&e<=1,o=0,s={x:0,y:0};if(t.offset){var a=t.offset;"number"==typeof a&&(o=a),a.x&&(s.x=a.x),a.y&&(s.y=a.y)}var l,c=0!==s.x||0!==s.y||0===o,u=i.keepGradient,h=i.ensureLegibility,d=this.path,f={segmentSubdivisions:this.getConnectionSubdivisions()},p=r?e*this.getConnectionLength():e,g=d.tangentAtLength(p,f),m=n;if(g){if(c)(l=g.start).offset(s);else{var v=g.clone();v.rotate(g.start,-90),v.setLength(o),l=v.end}u&&(m=g.angle()+n,h&&(m=j((m+90)%180-90)))}else l=d.start,c&&l.offset(s);return Mt.createSVGMatrix().translate(l.x,l.y).rotate(m)},getLabelCoordinates:function(t){var e=this._getLabelTransformationMatrix(t);return new L(e.e,e.f)},getVertexIndex:function(t,e){for(var n=this.model.vertices(),i=this.getClosestPointLength(new L(t,e)),r=0,o=n.length;r<o;r++){var s=n[r];if(i<this.getClosestPointLength(s))break}return r},notifyPointerdown:function(t,e,n){pn.prototype.pointerdown.call(this,t,e,n),this.notify("link:pointerdown",t,e,n)},notifyPointermove:function(t,e,n){pn.prototype.pointermove.call(this,t,e,n),this.notify("link:pointermove",t,e,n)},notifyPointerup:function(t,e,n){this.notify("link:pointerup",t,e,n),pn.prototype.pointerup.call(this,t,e,n)},pointerdblclick:function(t,e,n){pn.prototype.pointerdblclick.apply(this,arguments),this.notify("link:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){pn.prototype.pointerclick.apply(this,arguments),this.notify("link:pointerclick",t,e,n)},contextmenu:function(t,e,n){pn.prototype.contextmenu.apply(this,arguments),this.notify("link:contextmenu",t,e,n)},pointerdown:function(t,e,n){switch(this.notifyPointerdown(t,e,n),t.target.getAttribute("class")){case"marker-vertex":return void this.dragVertexStart(t,e,n);case"marker-vertex-remove":case"marker-vertex-remove-area":return void this.dragVertexRemoveStart(t,e,n);case"marker-arrowhead":return void this.dragArrowheadStart(t,e,n);case"connection":case"connection-wrap":return void this.dragConnectionStart(t,e,n);case"marker-source":case"marker-target":return}this.dragStart(t,e,n)},pointermove:function(t,e,n){var i=this._dragData;switch(i&&this.eventData(t,i),this.eventData(t).action){case"vertex-move":this.dragVertex(t,e,n);break;case"label-move":this.dragLabel(t,e,n);break;case"arrowhead-move":this.dragArrowhead(t,e,n);break;case"move":this.drag(t,e,n)}i&&Jt(i,this.eventData(t)),this.notifyPointermove(t,e,n)},pointerup:function(t,e,n){var i=this._dragData;switch(i&&(this.eventData(t,i),this._dragData=null),this.eventData(t).action){case"vertex-move":this.dragVertexEnd(t,e,n);break;case"label-move":this.dragLabelEnd(t,e,n);break;case"arrowhead-move":this.dragArrowheadEnd(t,e,n);break;case"move":this.dragEnd(t,e,n)}this.notifyPointerup(t,e,n),this.checkMouseleave(t)},mouseover:function(t){pn.prototype.mouseover.apply(this,arguments),this.notify("link:mouseover",t)},mouseout:function(t){pn.prototype.mouseout.apply(this,arguments),this.notify("link:mouseout",t)},mouseenter:function(t){pn.prototype.mouseenter.apply(this,arguments),this.notify("link:mouseenter",t)},mouseleave:function(t){pn.prototype.mouseleave.apply(this,arguments),this.notify("link:mouseleave",t)},mousewheel:function(t,e,n,i){pn.prototype.mousewheel.apply(this,arguments),this.notify("link:mousewheel",t,e,n,i)},onevent:function(t,e,n,i){if(Mt(t.target).findParentByClass("link-tool",this.el)){if(t.stopPropagation(),this.can("useLinkTools")){if("remove"===e)return void this.model.remove({ui:!0});this.notify(e,t,n,i)}this.notifyPointerdown(t,n,i)}else pn.prototype.onevent.apply(this,arguments)},onlabel:function(t,e,n){this.notifyPointerdown(t,e,n),this.dragLabelStart(t,e,n),this.eventData(t).stopPropagation&&t.stopPropagation()},dragConnectionStart:function(t,e,n){if(this.can("vertexAdd")){var i=this.addVertex({x:e,y:n},{ui:!0});this.eventData(t,{action:"vertex-move",vertexIdx:i})}},dragLabelStart:function(t,e,n){if(this.can("labelMove")){var i=t.currentTarget,r=parseInt(i.getAttribute("label-idx"),10),o=this._getLabelPositionAngle(r),s=this._getLabelPositionArgs(r),a=this._getDefaultLabelPositionArgs(),l=this._mergeLabelPositionArgs(s,a);this.eventData(t,{action:"label-move",labelIdx:r,positionAngle:o,positionArgs:l,stopPropagation:!0})}else this.eventData(t,{stopPropagation:!0});this.paper.delegateDragEvents(this,t.data)},dragVertexStart:function(t,e,n){if(this.can("vertexMove")){var i=t.target,r=parseInt(i.getAttribute("idx"),10);this.eventData(t,{action:"vertex-move",vertexIdx:r})}},dragVertexRemoveStart:function(t,e,n){if(this.can("vertexRemove")){var i=t.target,r=parseInt(i.getAttribute("idx"),10);this.model.removeVertex(r)}},dragArrowheadStart:function(t,e,n){if(this.can("arrowheadMove")){var i=t.target.getAttribute("end"),r=this.startArrowheadMove(i,{ignoreBackwardsCompatibility:!0});this.eventData(t,r)}},dragStart:function(t,e,n){this.can("linkMove")&&this.eventData(t,{action:"move",dx:e,dy:n})},dragLabel:function(t,e,n){var i=this.eventData(t),r={position:this.getLabelPosition(e,n,i.positionAngle,i.positionArgs)};this.model.label(i.labelIdx,r)},dragVertex:function(t,e,n){var i=this.eventData(t);this.model.vertex(i.vertexIdx,{x:e,y:n},{ui:!0})},dragArrowhead:function(t,e,n){var i=this.eventData(t);this.paper.options.snapLinks?this._snapArrowhead(e,n,i):this._connectArrowhead(this.getEventTarget(t),e,n,i)},drag:function(t,e,n){var i=this.eventData(t);this.model.translate(e-i.dx,n-i.dy,{ui:!0}),this.eventData(t,{dx:e,dy:n})},dragLabelEnd:function(){},dragVertexEnd:function(){},dragArrowheadEnd:function(t,e,n){var i=this.eventData(t),r=this.paper;r.options.snapLinks?this._snapArrowheadEnd(i):this._connectArrowheadEnd(i,e,n),r.linkAllowed(this)?(this._finishEmbedding(i),this._notifyConnectEvent(i,t)):this._disallow(i),this._afterArrowheadMove(i)},dragEnd:function(){},_disallow:function(t){if("remove"===t.whenNotAllowed)this.model.remove({ui:!0});else this.model.set(t.arrowhead,t.initialEnd,{ui:!0})},_finishEmbedding:function(t){this.paper.options.embeddingMode&&this.model.reparent()&&(t.z=null)},_notifyConnectEvent:function(t,e){var n=t.arrowhead,i=t.initialEnd,r=this.model.prop(n);if(r&&!kn.endsEqual(i,r)){var o=this.paper;i.id&&this.notify("link:disconnect",e,o.findViewByModel(i.id),t.initialMagnet,n),r.id&&this.notify("link:connect",e,o.findViewByModel(r.id),t.magnetUnderPointer,n)}},_snapArrowhead:function(t,e,n){var i,r=this.paper.options.snapLinks.radius||50,o=this.paper.findViewsInArea({x:t-r,y:e-r,width:2*r,height:2*r}),s=n.closestView||null,a=n.closestMagnet||null;n.closestView=n.closestMagnet=null;var l,c=Number.MAX_VALUE,u=L(t,e),h=this.paper;o.forEach(function(t){"false"!==t.el.getAttribute("magnet")&&(i=t.model.getBBox().center().distance(u))<r&&i<c&&(a!==t.el&&!h.options.validateConnection.apply(h,n.validateConnectionArgs(t,null))||(c=i,n.closestView=t,n.closestMagnet=t.el)),t.$("[magnet]").each((function(e,o){var s=t.getNodeBBox(o);(i=u.distance({x:s.x+s.width/2,y:s.y+s.height/2}))<r&&i<c&&(a!==o&&!h.options.validateConnection.apply(h,n.validateConnectionArgs(t,o))||(c=i,n.closestView=t,n.closestMagnet=o))}).bind(this))},this);var d=n.closestView,f=n.closestMagnet,p=n.arrowhead,g=a!==f;if(s&&g&&s.unhighlight(a,{connecting:!0,snapping:!0}),d){if(!g)return;d.highlight(f,{connecting:!0,snapping:!0}),l=d.getLinkEnd(f,t,e,this.model,p)}else l={x:t,y:e};this.model.set(p,l||{x:t,y:e},{ui:!0})},_snapArrowheadEnd:function(t){var e=t.closestView,n=t.closestMagnet;e&&n&&(e.unhighlight(n,{connecting:!0,snapping:!0}),t.magnetUnderPointer=e.findMagnet(n)),t.closestView=t.closestMagnet=null},_connectArrowhead:function(t,e,n,i){i.eventTarget!==t&&(i.magnetUnderPointer&&i.viewUnderPointer.unhighlight(i.magnetUnderPointer,{connecting:!0}),i.viewUnderPointer=this.paper.findView(t),i.viewUnderPointer?(i.magnetUnderPointer=i.viewUnderPointer.findMagnet(t),i.magnetUnderPointer&&this.paper.options.validateConnection.apply(this.paper,i.validateConnectionArgs(i.viewUnderPointer,i.magnetUnderPointer))?i.magnetUnderPointer&&i.viewUnderPointer.highlight(i.magnetUnderPointer,{connecting:!0}):i.magnetUnderPointer=null):i.magnetUnderPointer=null),i.eventTarget=t,this.model.set(i.arrowhead,{x:e,y:n},{ui:!0})},_connectArrowheadEnd:function(t,e,n){var i=t.viewUnderPointer,r=t.magnetUnderPointer;if(r&&i){i.unhighlight(r,{connecting:!0});var o=t.arrowhead,s=i.getLinkEnd(r,e,n,this.model,o);this.model.set(o,s,{ui:!0})}},_beforeArrowheadMove:function(t){t.z=this.model.get("z"),this.model.toFront();var e=this.el.style;t.pointerEvents=e.pointerEvents,e.pointerEvents="none",this.paper.options.markAvailable&&this._markAvailableMagnets(t)},_afterArrowheadMove:function(t){null!==t.z&&(this.model.set("z",t.z,{ui:!0}),t.z=null),this.el.style.pointerEvents=t.pointerEvents,this.paper.options.markAvailable&&this._unmarkAvailableMagnets(t)},_createValidateConnectionArgs:function(t){var e,n=[];n[4]=t,n[5]=this;var i=0,r=0;e="source"===t?(i=2,"target"):(r=2,"source");var o=this.model.get(e);if(o.id){var s=n[i]=this.paper.findViewByModel(o.id),a=s.getMagnetFromLinkEnd(o);a===s.el&&(a=void 0),n[i+1]=a}return function(t,e){return n[r]=t,n[r+1]=t.el===e?void 0:e,n}},_markAvailableMagnets:function(t){function e(t,e){var n=t.paper;return n.options.validateConnection.apply(n,this.validateConnectionArgs(t,e))}var n=this.paper,i=n.model.getCells();t.marked={};for(var r=0,o=i.length;r<o;r++){var s=i[r].findView(n);if(s){var a=Array.prototype.slice.call(s.el.querySelectorAll("[magnet]"));"false"!==s.el.getAttribute("magnet")&&a.push(s.el);var l=a.filter(e.bind(t,s));if(0<l.length){for(var c=0,u=l.length;c<u;c++)s.highlight(l[c],{magnetAvailability:!0});s.highlight(null,{elementAvailability:!0}),t.marked[s.model.id]=l}}}},_unmarkAvailableMagnets:function(t){for(var e,n,i=Object.keys(t.marked),r=0,o=i.length;r<o;r++){e=i[r],n=t.marked[e];var s=this.paper.findViewByModel(e);if(s){for(var a=0,l=n.length;a<l;a++)s.unhighlight(n[a],{magnetAvailability:!0});s.unhighlight(null,{elementAvailability:!0})}}t.marked=null},startArrowheadMove:function(t,e){var n={action:"arrowhead-move",arrowhead:t,whenNotAllowed:(e=e||{}).whenNotAllowed||"revert",initialMagnet:this[t+"Magnet"]||(this[t+"View"]?this[t+"View"].el:null),initialEnd:re(this.model.get(t)),validateConnectionArgs:this._createValidateConnectionArgs(t)};return this._beforeArrowheadMove(n),!0!==e.ignoreBackwardsCompatibility&&(this._dragData=n),n}});Object.defineProperty(Wr.prototype,"sourceBBox",{enumerable:!0,get:function(){var t=this.sourceView;if(!t){var e=this.model.source();return new B(e.x,e.y)}var n=this.sourceMagnet;return t.isNodeConnection(n)?new B(this.sourceAnchor):t.getNodeBBox(n||t.el)}}),Object.defineProperty(Wr.prototype,"targetBBox",{enumerable:!0,get:function(){var t=this.targetView;if(!t){var e=this.model.target();return new B(e.x,e.y)}var n=this.targetMagnet;return t.isNodeConnection(n)?new B(this.targetAnchor):t.getNodeBBox(n||t.el)}});var $r={NONE:"sorting-none",APPROX:"sorting-approximate",EXACT:"sorting-exact"},Yr=1<<30,Xr=1<<29,qr=dn.extend({className:"paper",options:{width:800,height:600,origin:{x:0,y:0},gridSize:1,drawGrid:!1,background:!1,perpendicularLinks:!1,elementView:gn,linkView:Wr,snapLinks:!1,multiLinks:!0,guard:function(t,e){return!1},highlighting:{default:{name:"stroke",options:{padding:3}},magnetAvailability:{name:"addClass",options:{className:"available-magnet"}},elementAvailability:{name:"addClass",options:{className:"available-cell"}}},preventContextMenu:!0,preventDefaultBlankAction:!0,restrictTranslate:!1,markAvailable:!1,defaultLink:new kn,defaultConnector:{name:"normal"},defaultRouter:{name:"normal"},defaultAnchor:{name:"center"},defaultLinkAnchor:{name:"connectionRatio"},defaultConnectionPoint:{name:"bbox"},connectionStrategy:null,validateMagnet:function(t,e,n){return"passive"!==e.getAttribute("magnet")},validateConnection:function(t,e,n,i,r,o){return("target"===r?n:t)instanceof gn},embeddingMode:!1,validateEmbedding:function(t,e){return!0},findParentBy:"bbox",frontParentOnly:!0,interactive:{labelMove:!1},linkPinning:!0,allowLink:null,clickThreshold:0,moveThreshold:0,magnetThreshold:0,sorting:$r.EXACT,frozen:!1,onViewUpdate:function(t,e,n,i){e&Yr||n.mounting||i.requestConnectedLinksUpdate(t,n)},onViewPostponed:function(t,e){return this.forcePostponedViewUpdate(t,e)},viewport:null,cellViewNamespace:null,highlighterNamespace:Fi,anchorNamespace:Hr,linkAnchorNamespace:Fr,connectionPointNamespace:$i},events:{dblclick:"pointerdblclick",contextmenu:"contextmenu",mousedown:"pointerdown",touchstart:"pointerdown",mouseover:"mouseover",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousewheel:"mousewheel",DOMMouseScroll:"mousewheel","mouseenter .joint-cell":"mouseenter","mouseleave .joint-cell":"mouseleave","mouseenter .joint-tools":"mouseenter","mouseleave .joint-tools":"mouseleave","mousedown .joint-cell [event]":"onevent","touchstart .joint-cell [event]":"onevent","mousedown .joint-cell [magnet]":"onmagnet","touchstart .joint-cell [magnet]":"onmagnet","dblclick .joint-cell [magnet]":"magnetpointerdblclick","contextmenu .joint-cell [magnet]":"magnetcontextmenu","mousedown .joint-link .label":"onlabel","touchstart .joint-link .label":"onlabel","dragstart .joint-cell image":"onImageDragStart"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},svg:null,viewport:null,defs:null,tools:null,$background:null,layers:null,$grid:null,$document:null,_highlights:null,_zPivots:null,_viewportMatrix:null,_viewportTransformString:null,_updates:null,SORT_DELAYING_BATCHES:["add","to-front","to-back"],UPDATE_DELAYING_BATCHES:["translate"],MIN_SCALE:1e-6,init:function(){var t=this.options,e=this.el;t.cellViewNamespace||(t.cellViewNamespace="undefined"!=typeof joint&&be(joint,"shapes")?joint.shapes:null);var n=this.model=t.model||new Zr;this.setGrid(t.drawGrid),this.cloneOptions(),this.render(),this.setDimensions(),this.startListening(),this._views={},this._zPivots={},this.$document=i(e.ownerDocument),this._highlights={},this.resetViews(n.attributes.cells.models),!this.isFrozen()&&this.isAsync()&&this.updateViewsAsync()},_resetUpdates:function(){return this._updates={id:null,priorities:[{},{},{}],unmountedCids:[],mountedCids:[],unmounted:{},mounted:{},count:0,keyFrozen:!1,freezeKey:null,sort:!1}},startListening:function(){var t=this.model;this.listenTo(t,"add",this.onCellAdded).listenTo(t,"remove",this.onCellRemoved).listenTo(t,"change",this.onCellChange).listenTo(t,"reset",this.onGraphReset).listenTo(t,"sort",this.onGraphSort).listenTo(t,"batch:stop",this.onGraphBatchStop),this.on("cell:highlight",this.onCellHighlight).on("cell:unhighlight",this.onCellUnhighlight).on("scale translate",this.update)},onCellAdded:function(t,e,n){var i=n.position;this.isAsync()||!St(i)?this.renderView(t,n):(n.maxPosition===i&&this.freeze({key:"addCells"}),this.renderView(t,n),0===i&&this.unfreeze({key:"addCells"}))},onCellRemoved:function(t,e,n){var i=this.findViewByModel(t);i&&this.requestViewUpdate(i,Xr,i.UPDATE_PRIORITY,n)},onCellChange:function(t,e){if(t!==this.model.attributes.cells&&t.hasChanged("z")&&this.options.sorting===$r.APPROX){var n=this.findViewByModel(t);n&&this.requestViewUpdate(n,Yr,n.UPDATE_PRIORITY,e)}},onGraphReset:function(t,e){this.removeZPivots(),this.resetViews(t.models,e)},onGraphSort:function(){this.model.hasActiveBatch(this.SORT_DELAYING_BATCHES)||this.sortViews()},onGraphBatchStop:function(t){if(!this.isFrozen()){var e=t&&t.batchName,n=this.model;if(!this.isAsync()){var i=this.UPDATE_DELAYING_BATCHES;i.includes(e)&&!n.hasActiveBatch(i)&&this.updateViews(t)}var r=this.SORT_DELAYING_BATCHES;r.includes(e)&&!n.hasActiveBatch(r)&&this.sortViews()}},cloneOptions:function(){var t=this.options;t.origin=Jt({},t.origin),t.defaultConnector=Jt({},t.defaultConnector),t.highlighting=te({},t.highlighting,this.constructor.prototype.options.highlighting),!t.cellViewNamespace&&"undefined"!=typeof joint&&be(joint,"shapes")&&(t.cellViewNamespace=joint.shapes)},children:function(){var t=Mt.namespace;return[{namespaceURI:t.xhtml,tagName:"div",className:lt("paper-background"),selector:"background"},{namespaceURI:t.xhtml,tagName:"div",className:lt("paper-grid"),selector:"grid"},{namespaceURI:t.svg,tagName:"svg",attributes:{width:"100%",height:"100%","xmlns:xlink":t.xlink},selector:"svg",children:[{tagName:"defs",selector:"defs"},{tagName:"g",className:lt("layers"),selector:"layers",children:[{tagName:"g",className:lt("cells-layer viewport"),selector:"cells"},{tagName:"g",className:lt("tools-layer"),selector:"tools"}]}]}]},render:function(){this.renderChildren();var t=this.childNodes,e=this.options,n=t.svg,r=t.cells,o=t.defs,s=t.tools,a=t.layers,l=t.background,c=t.grid;return this.svg=n,this.defs=o,this.tools=s,this.cells=r,this.layers=a,this.$background=i(l),this.$grid=i(c),Mt.ensureId(n),this.viewport=r,e.background&&this.drawBackground(e.background),e.drawGrid&&this.drawGrid(),this},update:function(){return this.options.drawGrid&&this.drawGrid(),this._background&&this.updateBackgroundImage(this._background),this},matrix:function(t){var e=this.layers;if(void 0===t){var n=e.getAttribute("transform");return(this._viewportTransformString||null)===n?t=this._viewportMatrix:(t=e.getCTM(),this._viewportMatrix=t,this._viewportTransformString=n),Mt.createSVGMatrix(t)}t=Mt.createSVGMatrix(t);var i=Mt.matrixToTransformString(t);return e.setAttribute("transform",i),this._viewportMatrix=t,this._viewportTransformString=e.getAttribute("transform"),this},clientMatrix:function(){return Mt.createSVGMatrix(this.cells.getScreenCTM())},requestConnectedLinksUpdate:function(t,e){if(t instanceof pn)for(var n=t.model,i=this.model.getConnectedLinks(n),r=0,o=i.length;r<o;r++){var s=i[r],a=this.findViewByModel(s);if(a){var l=["UPDATE"];s.getTargetCell()===n&&l.push("TARGET"),s.getSourceCell()===n&&l.push("SOURCE"),this.scheduleViewUpdate(a,a.getFlag(l),a.UPDATE_PRIORITY,e)}}},forcePostponedViewUpdate:function(t,e){if(!(t&&t instanceof pn))return!1;var n=t.model;if(n.isElement())return!1;if(0==(e&t.getFlag(["SOURCE","TARGET"]))){var i=0,r=this.findViewByModel(n.getSourceCell());r&&!this.isViewMounted(r)&&(i=this.dumpView(r),t.updateEndMagnet("source"));var o=0,s=this.findViewByModel(n.getTargetCell());if(s&&!this.isViewMounted(s)&&(o=this.dumpView(s),t.updateEndMagnet("target")),0===i&&0===o)return!!this.dumpView(t)}return!1},requestViewUpdate:function(t,e,n,i){i=i||{},this.scheduleViewUpdate(t,e,n,i);var r=this.isAsync();if(!(this.isFrozen()||r&&!1!==i.async||this.model.hasActiveBatch(this.UPDATE_DELAYING_BATCHES))){var o=this.updateViews(i);r&&this.trigger("render:done",o,i)}},scheduleViewUpdate:function(t,e,n,i){var r=this._updates,o=r.priorities[n],s=(o=o||(r.priorities[n]={}))[t.cid]||0;if((s&e)!==e){s||r.count++,e&Xr&&s&Yr?o[t.cid]^=Yr:e&Yr&&s&Xr&&(o[t.cid]^=Xr),o[t.cid]|=e;var a=this.options.onViewUpdate;"function"==typeof a&&a.call(this,t,e,i||{},this)}},dumpViewUpdate:function(t){if(!t)return 0;var e=this._updates,n=t.cid,i=e.priorities[t.UPDATE_PRIORITY],r=this.registerMountedView(t)|i[n];return delete i[n],r},dumpView:function(t,e){var n=this.dumpViewUpdate(t);return n?this.updateView(t,n,e):0},updateView:function(t,e,n){if(!t)return 0;if(t instanceof pn){if(e&Xr)return this.removeView(t.model),0;e&Yr&&(this.insertView(t),e^=Yr)}return e?t.confirmUpdate(e,n||{}):0},requireView:function(t,e){var n=this.findViewByModel(t);return n?(this.dumpView(n,e),n):null},registerUnmountedView:function(t){var e=t.cid,n=this._updates;if(e in n.unmounted)return 0;var i=n.unmounted[e]|=Yr;return n.unmountedCids.push(e),delete n.mounted[e],i},registerMountedView:function(t){var e=t.cid,n=this._updates;if(e in n.mounted)return 0;n.mounted[e]=!0,n.mountedCids.push(e);var i=n.unmounted[e]||0;return delete n.unmounted[e],i},isViewMounted:function(t){return!!t&&t.cid in this._updates.mounted},dumpViews:function(t){var e=Qt({},t,{viewport:null});this.checkViewport(e),this.updateViews(e)},updateViews:function(t){for(var e,n=0,i=0,r=2;i++,n+=(e=this.updateViewsBatch(t)).updated,r=Math.min(e.priority,r),!e.empty;);return{updated:n,batches:i,priority:r}},updateViewsAsync:function(t,e){t=t||{},e=e||{processed:0,priority:2};var n=this._updates,i=n.id;if(i){zt(i);var r=this.updateViewsBatch(t),o=Qt({},t,{mountBatchSize:1e3-r.mounted,unmountBatchSize:1e3-r.unmounted}),s=this.checkViewport(o),a=s.unmounted,l=s.mounted,c=e.processed,u=n.count;0<r.updated&&(c+=r.updated+r.unmounted,r.processed=c,e.priority=Math.min(r.priority,e.priority),r.empty&&0===l?(r.unmounted+=a,r.mounted+=l,r.priority=e.priority,this.trigger("render:done",r,t),e.processed=0,n.count=0):e.processed=c);var h=t.progress;if(u&&"function"==typeof h&&h.call(this,r.empty,c,u,r,this),n.id!==i)return}n.id=Bt(this.updateViewsAsync,this,t,e)},updateViewsBatch:function(t){var e=(t=t||{}).batchSize||1/0,n=this._updates,i=0,r=0,o=0,s=0,a=2,l=!0,c=this.options,u=n.priorities,h="viewport"in t?t.viewport:c.viewport;"function"!=typeof h&&(h=null);var d=c.onViewPostponed;"function"!=typeof d&&(d=null);t:for(var f=0,p=u.length;f<p;f++){var g=u[f];for(var m in g){if(e<=i){l=!1;break t}var v=hn[m];if(v){var y=g[m];if(0==(y&Xr)){var b=m in n.unmounted;if(h&&!h.call(this,v,b,this)){b||(this.registerUnmountedView(v),v.unmount()),n.unmounted[m]|=y,delete g[m],o++;continue}b&&(y|=Yr,s++),y|=this.registerMountedView(v)}var C=this.updateView(v,y,t);0<C&&(g[m]=C,!d||!d.call(this,v,C,this)||g[m])?(r++,l=!1):(f<a&&(a=f),i++,delete g[m])}else delete g[m]}}return{priority:a,updated:i,postponed:r,unmounted:o,mounted:s,empty:l}},getUnmountedViews:function(){for(var t=this._updates,e=Object.keys(t.unmounted),n=e.length,i=new Array(n),r=0;r<n;r++)i[r]=hn[e[r]];return i},getMountedViews:function(){for(var t=this._updates,e=Object.keys(t.mounted),n=e.length,i=new Array(n),r=0;r<n;r++)i[r]=hn[e[r]];return i},checkUnmountedViews:function(t,e){var n=0;"function"!=typeof t&&(t=null);for(var i=("mountBatchSize"in(e=e||{})?e.mountBatchSize:1/0),r=this._updates,o=r.unmountedCids,s=r.unmounted,a=0,l=Math.min(o.length,i);a<l;a++){var c=o[a];if(c in s){var u=hn[c];if(u)if(!t||t.call(this,u,!1,this)){n++;var h=this.registerMountedView(u);h&&this.scheduleViewUpdate(u,h,u.UPDATE_PRIORITY,{mounting:!0})}else o.push(c)}}return o.splice(0,a),n},checkMountedViews:function(t,e){var n=0;if("function"!=typeof t)return n;for(var i=("unmountBatchSize"in(e=e||{})?e.unmountBatchSize:1/0),r=this._updates,o=r.mountedCids,s=r.mounted,a=0,l=Math.min(o.length,i);a<l;a++){var c=o[a];if(c in s){var u=hn[c];u&&(t.call(this,u,!0,this)?o.push(c):(n++,this.registerUnmountedView(u)&&u.unmount()))}}return o.splice(0,a),n},checkViewport:function(t){var e=Qt({},t,{mountBatchSize:1/0,unmountBatchSize:1/0}),n="viewport"in e?e.viewport:this.options.viewport,i=this.checkMountedViews(n,e);if(0<i){var r=this._updates.unmountedCids;e.mountBatchSize=Math.min(r.length-i,e.mountBatchSize)}return{mounted:this.checkUnmountedViews(n,e),unmounted:i}},freeze:function(t){t=t||{};var e=this._updates,n=t.key,i=this.options.frozen,r=e.freezeKey;if(n&&n!==r){if(i&&r)return;e.freezeKey=n,e.keyFrozen=i}this.options.frozen=!0;var o=e.id;e.id=null,this.isAsync()&&o&&zt(o)},unfreeze:function(t){t=t||{};var e=this._updates,n=t.key,i=e.freezeKey;n&&i&&n!==i||(e.freezeKey=null,n&&n===i&&e.keyFrozen||(this.isAsync()?(this.freeze(),this.updateViewsAsync(t)):this.updateViews(t),this.options.frozen=e.keyFrozen=!1,e.sort&&(this.sortViews(),e.sort=!1)))},isAsync:function(){return!!this.options.async},isFrozen:function(){return!!this.options.frozen},isExactSorting:function(){return this.options.sorting===$r.EXACT},onRemove:function(){this.freeze(),this.removeViews()},getComputedSize:function(){var t=this.options,e=t.width,n=t.height;return St(e)||(e=this.el.clientWidth),St(n)||(n=this.el.clientHeight),{width:e,height:n}},setDimensions:function(t,e){var n=this.options,i=void 0===t?n.width:t,r=void 0===e?n.height:e;this.options.width=i,this.options.height=r,St(i)&&(i=Math.round(i)),St(r)&&(r=Math.round(r)),this.$el.css({width:null===i?"":i,height:null===r?"":r});var o=this.getComputedSize();this.trigger("resize",o.width,o.height)},setOrigin:function(t,e){return this.translate(t||0,e||0,{absolute:!0})},fitToContent:function(t,e,n,i){n=De(t)?(t=(i=t).gridWidth||1,e=i.gridHeight||1,i.padding||0):(i=i||{},t=t||1,e=e||1,n||0),n=Ft(n);var r="contentArea"in i?new B(i.contentArea):this.getContentArea(i),o=this.scale(),s=this.translate(),a=o.sx,l=o.sy;r.x*=a,r.y*=l,r.width*=a,r.height*=l;var c=Math.max(Math.ceil((r.width+r.x)/t),1)*t,u=Math.max(Math.ceil((r.height+r.y)/e),1)*e,h=0,d=0;("negative"==i.allowNewOrigin&&r.x<0||"positive"==i.allowNewOrigin&&0<=r.x||"any"==i.allowNewOrigin)&&(h=Math.ceil(-r.x/t)*t,c+=h+=n.left),("negative"==i.allowNewOrigin&&r.y<0||"positive"==i.allowNewOrigin&&0<=r.y||"any"==i.allowNewOrigin)&&(d=Math.ceil(-r.y/e)*e,u+=d+=n.top),c+=n.right,u+=n.bottom,c=Math.max(c,i.minWidth||0),u=Math.max(u,i.minHeight||0),c=Math.min(c,i.maxWidth||Number.MAX_VALUE),u=Math.min(u,i.maxHeight||Number.MAX_VALUE);var f=this.getComputedSize(),p=c!=f.width||u!=f.height;return(h!=s.tx||d!=s.ty)&&this.translate(h,d),p&&this.setDimensions(c,u),new B(-h/a,-d/l,c/a,u/l)},scaleContentToFit:function(t){var e,n;if("contentArea"in(t=t||{})){var i=t.contentArea;e=this.localToPaperRect(i),n=new L(i)}else e=this.getContentBBox(t),n=this.paperToLocalPoint(e);if(e.width&&e.height){Qt(t,{padding:0,preserveAspectRatio:!0,scaleGrid:null,minScale:0,maxScale:Number.MAX_VALUE});var r,o=t.padding,s=t.minScaleX||t.minScale,a=t.maxScaleX||t.maxScale,l=t.minScaleY||t.minScale,c=t.maxScaleY||t.maxScale;if(t.fittingBBox)r=t.fittingBBox;else{var u=this.translate(),h=this.getComputedSize();r={x:u.tx,y:u.ty,width:h.width,height:h.height}}r=new B(r).inflate(-o);var d=this.scale(),f=r.width/e.width*d.sx,p=r.height/e.height*d.sy;if(t.preserveAspectRatio&&(f=p=Math.min(f,p)),t.scaleGrid){var g=t.scaleGrid;f=g*Math.floor(f/g),p=g*Math.floor(p/g)}f=Math.min(a,Math.max(s,f)),p=Math.min(c,Math.max(l,p));var m=this.options.origin,v=r.x-n.x*f-m.x,y=r.y-n.y*p-m.y;this.scale(f,p),this.translate(v,y)}},getContentArea:function(t){return t&&t.useModelGeometry?this.model.getBBox()||new B:Mt(this.cells).getBBox()},getContentBBox:function(t){return this.localToPaperRect(this.getContentArea(t))},getArea:function(){return this.paperToLocalRect(this.getComputedSize())},getRestrictedArea:function(){return le(this.options.restrictTranslate)?this.options.restrictTranslate.apply(this,arguments):!0===this.options.restrictTranslate?this.getArea():this.options.restrictTranslate||null},createViewForModel:function(t){var n,i,r=dt(this.options.cellViewNamespace,t.get("type")+"View",".");return i=t.isLink()?(n=this.options.linkView,Wr):(n=this.options.elementView,gn),new(n.prototype instanceof e.View?r||n:n.call(this,t)||r||i)({model:t,interactive:this.options.interactive})},removeView:function(t){var e=t.id,n=this._views,i=this._updates,r=n[e];if(r){var o=r.cid,s=i.mounted,a=i.unmounted;r.remove(),delete n[e],delete s[o],delete a[o]}return r},renderView:function(t,e){var n,i,r=t.id,o=this._views;return i=r in o?(n=o[r],Yr):((n=o[t.id]=this.createViewForModel(t)).paper=this).registerUnmountedView(n)|n.getFlag(n.initFlag),this.requestViewUpdate(n,i,n.UPDATE_PRIORITY,e),n},onImageDragStart:function(){return!1},resetViews:function(t,e){e=e||{},t=t||[],this._resetUpdates(),this.removeViews(),this.freeze({key:"reset"});for(var n=0,i=t.length;n<i;n++)this.renderView(t[n],e);this.unfreeze({key:"reset"}),this.sortViews()},removeViews:function(){ee(this._views,"remove"),this._views={}},sortViews:function(){this.isExactSorting()&&(this.isFrozen()?this._updates.sort=!0:this.sortViewsExact())},sortViewsExact:function(){var t=i(this.cells).children("[model-id]"),e=this.model.get("cells");xt(t,function(t,n){var i=e.get(t.getAttribute("model-id")),r=e.get(n.getAttribute("model-id")),o=i.attributes.z||0,s=r.attributes.z||0;return o===s?0:o<s?-1:1})},insertView:function(t){var e=this.cells;switch(this.options.sorting){case $r.APPROX:var n=t.model.get("z"),i=this.addZPivot(n);e.insertBefore(t.el,i);break;case $r.EXACT:default:e.appendChild(t.el)}},addZPivot:function(t){t=(t=+t)||0;var e=this._zPivots,n=e[t];if(n)return n;n=e[t]=document.createComment("z-index:"+(t+1));var i=-1/0;for(var r in e)(r=+r)<t&&i<r&&(i=r);var o=this.cells;if(i!==-1/0){var s=e[i];o.insertBefore(n,s.nextSibling)}else o.insertBefore(n,o.firstChild);return n},removeZPivots:function(){var t=this._zPivots,e=this.viewport;for(var n in t)e.removeChild(t[n]);this._zPivots={}},scale:function(t,e,n,i){if(void 0===t)return Mt.matrixToScale(this.matrix());void 0===e&&(e=t),void 0===n&&(i=n=0);var r=this.translate();if(n||i||r.tx||r.ty){var o=r.tx-n*(t-1),s=r.ty-i*(e-1);this.translate(o,s)}t=Math.max(t||0,this.MIN_SCALE),e=Math.max(e||0,this.MIN_SCALE);var a=this.matrix();return a.a=t,a.d=e,this.matrix(a),this.trigger("scale",t,e,n,i),this},rotate:function(t,e,n){if(void 0===t)return Mt.matrixToRotate(this.matrix());if(void 0===e){var i=this.cells.getBBox();e=i.width/2,n=i.height/2}var r=this.matrix().translate(e,n).rotate(t).translate(-e,-n);return this.matrix(r),this},translate:function(t,e){if(void 0===t)return Mt.matrixToTranslate(this.matrix());var n=this.matrix();n.e=t||0,n.f=e||0,this.matrix(n);var i=this.translate(),r=this.options.origin;return r.x=i.tx,r.y=i.ty,this.trigger("translate",i.tx,i.ty),this.options.drawGrid&&this.drawGrid(),this},findView:function(t){var e=Ae(t)?this.cells.querySelector(t):t instanceof i?t[0]:t,n=this.findAttribute("model-id",e);if(n)return this._views[n]},findViewByModel:function(t){var e=Ae(t)||St(t)?t:t&&t.id;return this._views[e]},findViewsFromPoint:function(t){return t=new L(t),this.model.getElements().map(this.findViewByModel,this).filter(function(e){return e&&e.vel.getBBox({target:this.cells}).containsPoint(t)},this)},findViewsInArea:function(t,e){e=Qt(e||{},{strict:!1}),t=new B(t);var n=this.model.getElements().map(this.findViewByModel,this),i=e.strict?"containsRect":"intersect";return n.filter(function(e){return e&&t[i](e.vel.getBBox({target:this.cells}))},this)},removeTools:function(){return this.dispatchToolsEvent("remove"),this},hideTools:function(){return this.dispatchToolsEvent("hide"),this},showTools:function(){return this.dispatchToolsEvent("show"),this},dispatchToolsEvent:function(t){for(var e,n=[],i=arguments.length-1;0<i--;)n[i]=arguments[i+1];"string"==typeof t&&(e=this).trigger.apply(e,["tools:event",t].concat(n))},getModelById:function(t){return this.model.getCell(t)},snapToGrid:function(t,e){return this.clientToLocalPoint(t,e).snapToGrid(this.options.gridSize)},localToPaperPoint:function(t,e){var n=new L(t,e);return Mt.transformPoint(n,this.matrix())},localToPaperRect:function(t,e,n,i){var r=new B(t,e,n,i);return Mt.transformRect(r,this.matrix())},paperToLocalPoint:function(t,e){var n=new L(t,e);return Mt.transformPoint(n,this.matrix().inverse())},paperToLocalRect:function(t,e,n,i){var r=new B(t,e,n,i);return Mt.transformRect(r,this.matrix().inverse())},localToClientPoint:function(t,e){var n=new L(t,e);return Mt.transformPoint(n,this.clientMatrix())},localToClientRect:function(t,e,n,i){var r=new B(t,e,n,i);return Mt.transformRect(r,this.clientMatrix())},clientToLocalPoint:function(t,e){var n=new L(t,e);return Mt.transformPoint(n,this.clientMatrix().inverse())},clientToLocalRect:function(t,e,n,i){var r=new B(t,e,n,i);return Mt.transformRect(r,this.clientMatrix().inverse())},localToPagePoint:function(t,e){return this.localToPaperPoint(t,e).offset(this.pageOffset())},localToPageRect:function(t,e,n,i){return this.localToPaperRect(t,e,n,i).offset(this.pageOffset())},pageToLocalPoint:function(t,e){var n=new L(t,e).difference(this.pageOffset());return this.paperToLocalPoint(n)},pageToLocalRect:function(t,e,n,i){var r=this.pageOffset(),o=new B(t,e,n,i);return o.x-=r.x,o.y-=r.y,this.paperToLocalRect(o)},clientOffset:function(){var t=this.svg.getBoundingClientRect();return new L(t.left,t.top)},pageOffset:function(){return this.clientOffset().offset(window.scrollX,window.scrollY)},linkAllowed:function(t){if(!(t instanceof Wr))throw new Error("Must provide a linkView.");var e=t.model,n=this.options,i=this.model,r=i.constructor.validations;return!(!n.multiLinks&&!r.multiLinks.call(this,i,e)||!n.linkPinning&&!r.linkPinning.call(this,i,e)||"function"==typeof n.allowLink&&!n.allowLink.call(this,t,this))},getDefaultLink:function(t,e){return le(this.options.defaultLink)?this.options.defaultLink.call(this,t,e):this.options.defaultLink.clone()},resolveHighlighter:function(t){var e=(t=t||{}).highlighter,n=this.options;if(void 0===e){var i=["embedding","connecting","magnetAvailability","elementAvailability"].find(function(e){return!!t[e]});e=i&&n.highlighting[i]||n.highlighting.default}if(!e)return!1;Ae(e)&&(e={name:e});var r=e.name,o=n.highlighterNamespace[r];if(!o)throw new Error('Unknown highlighter ("'+r+'")');if("function"!=typeof o.highlight)throw new Error('Highlighter ("'+r+'") is missing required highlight() method');if("function"!=typeof o.unhighlight)throw new Error('Highlighter ("'+r+'") is missing required unhighlight() method');return{highlighter:o,options:e.options||{},name:r}},onCellHighlight:function(t,e,n){if(n=this.resolveHighlighter(n)){e.id||(e.id=Mt.uniqueId());var i=n.name+e.id+JSON.stringify(n.options);if(!this._highlights[i]){var r=n.highlighter;r.highlight(t,e,Jt({},n.options)),this._highlights[i]={cellView:t,magnetEl:e,opt:n.options,highlighter:r}}}},onCellUnhighlight:function(t,e,n){if(n=this.resolveHighlighter(n)){var i=n.name+e.id+JSON.stringify(n.options),r=this._highlights[i];r&&(r.highlighter.unhighlight(r.cellView,r.magnetEl,r.opt),this._highlights[i]=null)}},pointerdblclick:function(t){t.preventDefault(),t=vt(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.snapToGrid(t.clientX,t.clientY);e?e.pointerdblclick(t,n.x,n.y):this.trigger("blank:pointerdblclick",t,n.x,n.y)}},pointerclick:function(t){if(this.eventData(t).mousemoved<=this.options.clickThreshold){t=vt(t);var e=this.findView(t.target);if(this.guard(t,e))return;var n=this.snapToGrid(t.clientX,t.clientY);e?e.pointerclick(t,n.x,n.y):this.trigger("blank:pointerclick",t,n.x,n.y)}},contextmenu:function(t){this.options.preventContextMenu&&t.preventDefault(),t=vt(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.snapToGrid(t.clientX,t.clientY);e?e.contextmenu(t,n.x,n.y):this.trigger("blank:contextmenu",t,n.x,n.y)}},pointerdown:function(t){t=vt(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.snapToGrid(t.clientX,t.clientY);e?(t.preventDefault(),e.pointerdown(t,n.x,n.y)):(this.options.preventDefaultBlankAction&&t.preventDefault(),this.trigger("blank:pointerdown",t,n.x,n.y)),this.delegateDragEvents(e,t.data)}},pointermove:function(t){var e=this.eventData(t);if(e.mousemoved||(e.mousemoved=0),!(++e.mousemoved<=this.options.moveThreshold)){t=vt(t);var n=this.snapToGrid(t.clientX,t.clientY),i=e.sourceView;i?i.pointermove(t,n.x,n.y):this.trigger("blank:pointermove",t,n.x,n.y),this.eventData(t,e)}},pointerup:function(t){this.undelegateDocumentEvents();var e=vt(t),n=this.snapToGrid(e.clientX,e.clientY),r=this.eventData(t).sourceView;r?r.pointerup(e,n.x,n.y):this.trigger("blank:pointerup",e,n.x,n.y),e.isPropagationStopped()||this.pointerclick(i.Event(t,{type:"click",data:t.data})),t.stopImmediatePropagation(),this.delegateEvents()},mouseover:function(t){t=vt(t);var e=this.findView(t.target);if(!this.guard(t,e))if(e)e.mouseover(t);else{if(this.el===t.target)return;this.trigger("blank:mouseover",t)}},mouseout:function(t){t=vt(t);var e=this.findView(t.target);if(!this.guard(t,e))if(e)e.mouseout(t);else{if(this.el===t.target)return;this.trigger("blank:mouseout",t)}},mouseenter:function(t){t=vt(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.findView(t.relatedTarget);if(e){if(n===e)return;e.mouseenter(t)}else{if(n)return;this.trigger("paper:mouseenter",t)}}},mouseleave:function(t){t=vt(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.findView(t.relatedTarget);if(e){if(n===e)return;e.mouseleave(t)}else{if(n)return;this.trigger("paper:mouseleave",t)}}},mousewheel:function(t){t=vt(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=t.originalEvent,i=this.snapToGrid(n.clientX,n.clientY),r=Math.max(-1,Math.min(1,n.wheelDelta||-n.detail));e?e.mousewheel(t,i.x,i.y,r):this.trigger("blank:mousewheel",t,i.x,i.y,r)}},onevent:function(t){var e=t.currentTarget,n=e.getAttribute("event");if(n){var i=this.findView(e);if(i){if(t=vt(t),this.guard(t,i))return;var r=this.snapToGrid(t.clientX,t.clientY);i.onevent(t,n,r.x,r.y)}}},magnetEvent:function(t,e){var n=t.currentTarget;if(n.getAttribute("magnet")){var i=this.findView(n);if(i){if(t=vt(t),this.guard(t,i))return;var r=this.snapToGrid(t.clientX,t.clientY);e.call(this,i,t,n,r.x,r.y)}}},onmagnet:function(t){this.magnetEvent(t,function(t,e,n,i,r){t.onmagnet(e,i,r)})},magnetpointerdblclick:function(t){this.magnetEvent(t,function(t,e,n,i,r){t.magnetpointerdblclick(e,n,i,r)})},magnetcontextmenu:function(t){this.options.preventContextMenu&&t.preventDefault(),this.magnetEvent(t,function(t,e,n,i,r){t.magnetcontextmenu(e,n,i,r)})},onlabel:function(t){var e=t.currentTarget,n=this.findView(e);if(n){if(t=vt(t),this.guard(t,n))return;var i=this.snapToGrid(t.clientX,t.clientY);n.onlabel(t,i.x,i.y)}},getPointerArgs:function(t){var e=vt(t),n=this.snapToGrid(e.clientX,e.clientY);return[e,n.x,n.y]},delegateDragEvents:function(t,e){e=e||{},this.eventData({data:e},{sourceView:t||null,mousemoved:0}),this.delegateDocumentEvents(null,e),this.undelegateEvents()},guard:function(t,e){return"mousedown"===t.type&&2===t.button||!(!this.options.guard||!this.options.guard(t,e))||(t.data&&void 0!==t.data.guarded?t.data.guarded:!(e&&e.model&&e.model instanceof Ze||this.svg===t.target||this.el===t.target||i.contains(this.svg,t.target)))},setGridSize:function(t){return this.options.gridSize=t,this.options.drawGrid&&this.drawGrid(),this},clearGrid:function(){return this.$grid&&this.$grid.css("backgroundImage","none"),this},_getGridRefs:function(){return this._gridCache||(this._gridCache={root:Mt("svg",{width:"100%",height:"100%"},Mt("defs")),patterns:{},add:function(t,e){Mt(this.root.node.childNodes[0]).append(e),this.patterns[t]=e,this.root.append(Mt("rect",{width:"100%",height:"100%",fill:"url(#"+t+")"}))},get:function(t){return this.patterns[t]},exist:function(t){return void 0!==this.patterns[t]}}),this._gridCache},setGrid:function(t){return this.clearGrid(),this._gridCache=null,this._gridSettings=[],(Array.isArray(t)?t:[t||{}]).forEach(function(t){this._gridSettings.push.apply(this._gridSettings,this._resolveDrawGridOption(t))},this),this},_resolveDrawGridOption:function(t){var e=this.constructor.gridPatterns;if(Ae(t)&&Array.isArray(e[t]))return e[t].map(function(t){return Jt({},t)});var n=t||{args:[{}]},i=Array.isArray(n),r=n.name;if(i||r||n.markup||(r="dot"),r&&Array.isArray(e[r])){var o=e[r].map(function(t){return Jt({},t)}),s=Array.isArray(n.args)?n.args:[n.args||{}];Qt(s[0],Ie(t,"args"));for(var a=0;a<s.length;a++)o[a]&&Jt(o[a],s[a]);return o}return i?n:[n]},drawGrid:function(t){var e=this.options.gridSize;if(e<=1)return this.clearGrid();var n=Array.isArray(t)?t:[t],i=this.matrix(),r=this._getGridRefs();this._gridSettings.forEach(function(t,o){var s="pattern_"+o,a=At(t,n[o],{sx:i.a||1,sy:i.d||1,ox:i.e||0,oy:i.f||0});a.width=e*(i.a||1)*(a.scaleFactor||1),a.height=e*(i.d||1)*(a.scaleFactor||1),r.exist(s)||r.add(s,Mt("pattern",{id:s,patternUnits:"userSpaceOnUse"},Mt(a.markup)));var l=r.get(s);le(a.update)&&a.update(l.node.childNodes[0],a);var c=a.ox%a.width;c<0&&(c+=a.width);var u=a.oy%a.height;u<0&&(u+=a.height),l.attr({x:c,y:u,width:a.width,height:a.height})});var o=(new XMLSerializer).serializeToString(r.root.node);return o="url(data:image/svg+xml;base64,"+btoa(o)+")",this.$grid.css("backgroundImage",o),this},updateBackgroundImage:function(t){var e=(t=t||{}).position||"center",n=t.size||"auto auto",i=this.scale(),r=this.translate();De(e)&&(e=r.tx+i.sx*(e.x||0)+"px "+(r.ty+i.sy*(e.y||0))+"px"),De(n)&&(n=(n=new B(n).scale(i.sx,i.sy)).width+"px "+n.height+"px"),this.$background.css({backgroundSize:n,backgroundPosition:e})},drawBackgroundImage:function(t,e){if(t instanceof HTMLImageElement){var n,i=(e=e||{}).size,r=e.repeat||"no-repeat",o=e.opacity||1,s=Math.abs(e.quality)||1,a=this.constructor.backgroundPatterns[xe(r)];if(le(a)){t.width*=s,t.height*=s;var l=a(t,e);if(!(l instanceof HTMLCanvasElement))throw new Error("dia.Paper: background pattern must return an HTML Canvas instance");n=l.toDataURL("image/png"),r="repeat",De(i)?(i.width*=l.width/t.width,i.height*=l.height/t.height):void 0===i&&(e.size={width:l.width/s,height:l.height/s})}else n=t.src,void 0===i&&(e.size={width:t.width,height:t.height});this.$background.css({opacity:o,backgroundRepeat:r,backgroundImage:"url("+n+")"}),this.updateBackgroundImage(e)}else this.$background.css("backgroundImage","")},updateBackgroundColor:function(t){this.$el.css("backgroundColor",t||"")},drawBackground:function(t){if(t=t||{},this.updateBackgroundColor(t.color),t.image){t=this._background=oe(t);var e=document.createElement("img");e.onload=this.drawBackgroundImage.bind(this,e,t),e.src=t.image}else this.drawBackgroundImage(null),this._background=null;return this},setInteractivity:function(t){this.options.interactive=t,ee(this._views,"setInteractivity",t)},isDefined:function(t){return!!this.svg.getElementById(t)},defineFilter:function(t){if(!De(t))throw new TypeError("dia.Paper: defineFilter() requires 1. argument to be an object.");var e=t.id,n=t.name;if(e=e||n+this.svg.id+ht(JSON.stringify(t)),!this.isDefined(e)){var i=Ut,r=i[n]&&i[n](t.args||{});if(!r)throw new Error("Non-existing filter "+n);var o=Jt({filterUnits:"objectBoundingBox",x:-1,y:-1,width:3,height:3},t.attrs,{id:e});Mt(r,o).appendTo(this.defs)}return e},defineGradient:function(t){if(!De(t))throw new TypeError("dia.Paper: defineGradient() requires 1. argument to be an object.");var e=t.id,n=t.type,i=t.stops;if(e=e||n+this.svg.id+ht(JSON.stringify(t)),!this.isDefined(e)){var r=Wt('<stop offset="${offset}" stop-color="${color}" stop-opacity="${opacity}"/>'),o=["<"+n+">",ue(i).map(function(t){return r({offset:t.offset,color:t.color,opacity:Number.isFinite(t.opacity)?t.opacity:1})}).join(""),"</"+n+">"].join(""),s=Jt({id:e},t.attrs);Mt(o,s).appendTo(this.defs)}return e},defineMarker:function(t){if(!De(t))throw new TypeError("dia.Paper: defineMarker() requires 1. argument to be an object.");var e=t.id;if(e=e||this.svg.id+ht(JSON.stringify(t)),!this.isDefined(e)){var n=Ie(t,"type","userSpaceOnUse");Mt("marker",{id:e,orient:"auto",overflow:"visible",markerUnits:t.markerUnits||"userSpaceOnUse"},[Mt(t.type||"path",n)]).appendTo(this.defs)}return e}},{sorting:$r,backgroundPatterns:{flipXy:function(t){var e=document.createElement("canvas"),n=t.width,i=t.height;e.width=2*n,e.height=2*i;var r=e.getContext("2d");return r.drawImage(t,0,0,n,i),r.setTransform(-1,0,0,-1,e.width,e.height),r.drawImage(t,0,0,n,i),r.setTransform(-1,0,0,1,e.width,0),r.drawImage(t,0,0,n,i),r.setTransform(1,0,0,-1,0,e.height),r.drawImage(t,0,0,n,i),e},flipX:function(t){var e=document.createElement("canvas"),n=t.width,i=t.height;e.width=2*n,e.height=i;var r=e.getContext("2d");return r.drawImage(t,0,0,n,i),r.translate(2*n,0),r.scale(-1,1),r.drawImage(t,0,0,n,i),e},flipY:function(t){var e=document.createElement("canvas"),n=t.width,i=t.height;e.width=n,e.height=2*i;var r=e.getContext("2d");return r.drawImage(t,0,0,n,i),r.translate(0,2*i),r.scale(1,-1),r.drawImage(t,0,0,n,i),e},watermark:function(t,e){e=e||{};var n=t.width,i=t.height,r=document.createElement("canvas");r.width=3*n,r.height=3*i;for(var o=r.getContext("2d"),s=St(e.watermarkAngle)?-e.watermarkAngle:-20,a=V(s),l=r.width/4,c=r.height/4,u=0;u<4;u++)for(var h=0;h<4;h++)0<(u+h)%2&&(o.setTransform(1,0,0,1,(2*u-1)*l,(2*h-1)*c),o.rotate(a),o.drawImage(t,-n/2,-i/2,n,i));return r}},gridPatterns:{dot:[{color:"#AAAAAA",thickness:1,markup:"rect",update:function(t,e){Mt(t).attr({width:e.thickness*e.sx,height:e.thickness*e.sy,fill:e.color})}}],fixedDot:[{color:"#AAAAAA",thickness:1,markup:"rect",update:function(t,e){var n=e.sx<=1?e.thickness*e.sx:e.thickness;Mt(t).attr({width:n,height:n,fill:e.color})}}],mesh:[{color:"#AAAAAA",thickness:1,markup:"path",update:function(t,e){var n,i=e.width,r=e.height,o=e.thickness;n=0<=i-o&&0<=r-o?["M",i,0,"H0 M0 0 V0",r].join(" "):"M 0 0 0 0",Mt(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}}],doubleMesh:[{color:"#AAAAAA",thickness:1,markup:"path",update:function(t,e){var n,i=e.width,r=e.height,o=e.thickness;n=0<=i-o&&0<=r-o?["M",i,0,"H0 M0 0 V0",r].join(" "):"M 0 0 0 0",Mt(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}},{color:"#000000",thickness:3,scaleFactor:4,markup:"path",update:function(t,e){var n,i=e.width,r=e.height,o=e.thickness;n=0<=i-o&&0<=r-o?["M",i,0,"H0 M0 0 V0",r].join(" "):"M 0 0 0 0",Mt(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}}]}}),Jr=dn.extend({name:null,tagName:"g",className:"tool",svgElement:!0,_visible:!0,init:function(){var t=this.name;t&&this.vel.attr("data-tool-name",t)},configure:function(t,e){return this.relatedView=t,this.paper=t.paper,this.parentView=e,this.simulateRelatedView(this.el),this.delegateEvents(),this},simulateRelatedView:function(t){t&&t.setAttribute("model-id",this.relatedView.model.id)},getName:function(){return this.name},show:function(){this.el.style.display="",this._visible=!0},hide:function(){this.el.style.display="none",this._visible=!1},isVisible:function(){return!!this._visible},focus:function(){var t=this.options.focusOpacity;isFinite(t)&&(this.el.style.opacity=t),this.parentView.focusTool(this)},blur:function(){this.el.style.opacity="",this.parentView.blurTool(this)},update:function(){},guard:function(t){var e=this.paper,n=this.relatedView;return!e||!n||e.guard(t,n)}}),Qr=dn.extend({tagName:"g",className:"tools",svgElement:!0,tools:null,options:{tools:null,relatedView:null,name:null,component:!1},configure:function(t){var e=(t=Jt(this.options,t)).tools;if(!Array.isArray(e))return this;var n=t.relatedView;if(!(n instanceof pn))return this;for(var i=this.tools=[],r=0,o=e.length;r<o;r++){var s=e[r];s instanceof Jr&&(s.configure(n,this),s.render(),this.vel.append(s.el),i.push(s))}return this},getName:function(){return this.options.name},update:function(t){t=t||{};var e=this.tools;if(e){for(var n=0,i=e.length;n<i;n++){var r=e[n];t.tool!==r.cid&&r.isVisible()&&r.update()}return this}},focusTool:function(t){var e=this.tools;if(!e)return this;for(var n=0,i=e.length;n<i;n++){var r=e[n];t===r?r.show():r.hide()}return this},blurTool:function(t){var e=this.tools;if(!e)return this;for(var n=0,i=e.length;n<i;n++){var r=e[n];r===t||r.isVisible()||(r.show(),r.update())}return this},hide:function(){return this.focusTool(null)},show:function(){return this.blurTool(null)},onRemove:function(){var t=this.tools;if(!t)return this;for(var e=0,n=t.length;e<n;e++)t[e].remove();this.tools=null},mount:function(){var t=this.options,e=t.relatedView;return e&&(t.component?e.el:e.paper.tools).appendChild(this.el),this}}),to={ElementView:gn,Graph:Zr,Cell:Ze,CellView:pn,Element:un,attributes:Ue,Link:kn,LinkView:Wr,Paper:qr,ToolView:Jr,ToolsView:Qr};function eo(t,e,n){return er.call(this.paper,{},e,n,t,this.model).anchor}function no(t,e){var n=t.model;return e?n.getBBox():n.isLink()?t.getConnection().bbox():t.getNodeUnrotatedBBox(t.el)}var io=dn.extend({tagName:"circle",svgElement:!0,className:"marker-vertex",events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onDoubleClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},attributes:{r:6,fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move"},position:function(t,e){this.vel.attr({cx:t,cy:e})},onPointerDown:function(t){this.options.guard(t)||(t.stopPropagation(),t.preventDefault(),this.options.paper.undelegateEvents(),this.delegateDocumentEvents(null,t.data),this.trigger("will-change",this,t))},onPointerMove:function(t){this.trigger("changing",this,t)},onDoubleClick:function(t){this.trigger("remove",this,t)},onPointerUp:function(t){this.trigger("changed",this,t),this.undelegateDocumentEvents(),this.options.paper.delegateEvents()}}),ro=Jr.extend({name:"vertices",options:{handleClass:io,snapRadius:20,redundancyRemoval:!0,vertexAdding:!0,stopPropagation:!0},children:[{tagName:"path",selector:"connection",className:"joint-vertices-path",attributes:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"cell"}}],handles:null,events:{"mousedown .joint-vertices-path":"onPathPointerDown","touchstart .joint-vertices-path":"onPathPointerDown"},onRender:function(){return this.options.vertexAdding&&(this.renderChildren(),this.updatePath()),this.resetHandles(),this.renderHandles(),this},update:function(){return this.relatedView.model.vertices().length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.vertexAdding&&this.updatePath(),this},resetHandles:function(){var t=this.handles;if(this.handles=[],this.stopListening(),Array.isArray(t))for(var e=0,n=t.length;e<n;e++)t[e].remove()},renderHandles:function(){for(var t=this,e=this.relatedView.model.vertices(),n=0,i=e.length;n<i;n++){var r=e[n],o=new this.options.handleClass({index:n,paper:this.paper,guard:function(e){return t.guard(e)}});o.render(),o.position(r.x,r.y),this.simulateRelatedView(o.el),o.vel.appendTo(this.el),this.handles.push(o),this.startHandleListening(o)}},updateHandles:function(){for(var t=this.relatedView.model.vertices(),e=0,n=t.length;e<n;e++){var i=t[e],r=this.handles[e];if(!r)return;r.position(i.x,i.y)}},updatePath:function(){var t=this.childNodes.connection;t&&t.setAttribute("d",this.relatedView.getSerializedConnection())},startHandleListening:function(t){var e=this.relatedView;e.can("vertexMove")&&(this.listenTo(t,"will-change",this.onHandleWillChange),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"changed",this.onHandleChanged)),e.can("vertexRemove")&&this.listenTo(t,"remove",this.onHandleRemove)},getNeighborPoints:function(t){var e=this.relatedView,n=e.model.vertices(),i=0<t?n[t-1]:e.sourceAnchor,r=t<n.length-1?n[t+1]:e.targetAnchor;return{prev:new L(i),next:new L(r)}},onHandleWillChange:function(t,e){this.focus();var n=this.relatedView,i=this.options;n.model.startBatch("vertex-move",{ui:!0,tool:this.cid}),i.stopPropagation||n.notifyPointerdown.apply(n,n.paper.getPointerArgs(e))},onHandleChanging:function(t,e){var n=this.options,i=this.relatedView,r=t.options.index,o=i.paper.getPointerArgs(e),s=o[0],a=o[1],l=o[2],c={x:a,y:l};this.snapVertex(c,r),i.model.vertex(r,c,{ui:!0,tool:this.cid}),t.position(c.x,c.y),n.stopPropagation||i.notifyPointermove(s,a,l)},onHandleChanged:function(t,e){var n=this.options,i=this.relatedView;if(n.vertexAdding&&this.updatePath(),n.redundancyRemoval){i.removeRedundantLinearVertices({ui:!0,tool:this.cid})&&this.render(),this.blur(),i.model.stopBatch("vertex-move",{ui:!0,tool:this.cid}),this.eventData(e).vertexAdded&&i.model.stopBatch("vertex-add",{ui:!0,tool:this.cid});var r=i.paper.getPointerArgs(e),o=r[0],s=r[1],a=r[2];n.stopPropagation||i.notifyPointerup(o,s,a),i.checkMouseleave(o)}},snapVertex:function(t,e){var n=this.options.snapRadius;if(0<n){var i=this.getNeighborPoints(e),r=i.prev,o=i.next;Math.abs(t.x-r.x)<n?t.x=r.x:Math.abs(t.x-o.x)<n&&(t.x=o.x),Math.abs(t.y-r.y)<n?t.y=i.prev.y:Math.abs(t.y-o.y)<n&&(t.y=o.y)}},onHandleRemove:function(t,e){var n=t.options.index,i=this.relatedView;i.model.removeVertex(n,{ui:!0}),this.options.vertexAdding&&this.updatePath(),i.checkMouseleave(vt(e))},onPathPointerDown:function(t){if(!this.guard(t)){t.stopPropagation(),t.preventDefault();var e=vt(t),n=this.paper.snapToGrid(e.clientX,e.clientY).toJSON(),i=this.relatedView;i.model.startBatch("vertex-add",{ui:!0,tool:this.cid});var r=i.getVertexIndex(n.x,n.y);this.snapVertex(n,r),i.model.insertVertex(r,n,{ui:!0,tool:this.cid}),this.render();var o=this.handles[r];this.eventData(e,{vertexAdded:!0}),o.onPointerDown(e)}},onRemove:function(){this.resetHandles()}},{VertexHandle:io}),oo=dn.extend({tagName:"g",svgElement:!0,className:"marker-segment",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},children:[{tagName:"line",selector:"line",attributes:{stroke:"#33334F","stroke-width":2,fill:"none","pointer-events":"none"}},{tagName:"rect",selector:"handle",attributes:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#33334F",stroke:"#FFFFFF","stroke-width":2}}],onRender:function(){this.renderChildren()},position:function(t,e,n,i){var r=Mt.createSVGMatrix().translate(t,e).rotate(n),o=this.childNodes.handle;o.setAttribute("transform",Mt.matrixToTransformString(r)),o.setAttribute("cursor",n%180==0?"row-resize":"col-resize");var s=i.getClosestPoint(new L(t,e)),a=this.childNodes.line;a.setAttribute("x1",t),a.setAttribute("y1",e),a.setAttribute("x2",s.x),a.setAttribute("y2",s.y)},onPointerDown:function(t){this.options.guard(t)||(this.trigger("change:start",this,t),t.stopPropagation(),t.preventDefault(),this.options.paper.undelegateEvents(),this.delegateDocumentEvents(null,t.data))},onPointerMove:function(t){this.trigger("changing",this,t)},onPointerUp:function(t){this.undelegateDocumentEvents(),this.options.paper.delegateEvents(),this.trigger("change:end",this,t)},show:function(){this.el.style.display=""},hide:function(){this.el.style.display="none"}}),so=Jr.extend({name:"segments",precision:.5,options:{handleClass:oo,segmentLengthThreshold:40,redundancyRemoval:!0,anchor:eo,snapRadius:10,snapHandle:!0},handles:null,onRender:function(){this.resetHandles();var t=this.relatedView,e=t.model.vertices();e.unshift(t.sourcePoint),e.push(t.targetPoint);for(var n=0,i=e.length;n<i-1;n++){var r=e[n],o=e[n+1],s=this.renderHandle(r,o);this.simulateRelatedView(s.el),this.handles.push(s),s.options.index=n}return this},renderHandle:function(t,e){var n=this,i=new this.options.handleClass({paper:this.paper,guard:function(t){return n.guard(t)}});return i.render(),this.updateHandle(i,t,e),i.vel.appendTo(this.el),this.startHandleListening(i),i},update:function(){return this.render(),this},startHandleListening:function(t){this.listenTo(t,"change:start",this.onHandleChangeStart),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"change:end",this.onHandleChangeEnd)},resetHandles:function(){var t=this.handles;if(this.handles=[],this.stopListening(),Array.isArray(t))for(var e=0,n=t.length;e<n;e++)t[e].remove()},shiftHandleIndexes:function(t){for(var e=this.handles,n=0,i=e.length;n<i;n++)e[n].options.index+=t},resetAnchor:function(t,e){var n=this.relatedView.model;e?n.prop([t,"anchor"],e,{rewrite:!0,ui:!0,tool:this.cid}):n.removeProp([t,"anchor"],{ui:!0,tool:this.cid})},snapHandle:function(t,e,n){var i=t.options.index,r=this.relatedView.model.vertices(),o=t.options.axis,s=r[i-2]||n.sourceAnchor,a=r[i+1]||n.targetAnchor,l=this.options.snapRadius;return Math.abs(e[o]-s[o])<l?e[o]=s[o]:Math.abs(e[o]-a[o])<l&&(e[o]=a[o]),e},onHandleChanging:function(t,e){var n=this.eventData(e),i=this.relatedView,r=i.paper,o=t.options.index-1,s=vt(e),a=r.snapToGrid(s.clientX,s.clientY),l=this.snapHandle(t,a.clone(),n),c=t.options.axis,u=this.options.snapHandle?0:a[c]-l[c],h=i.model,d=oe(h.vertices()),f=d[o],p=d[1+o],g=this.options.anchor;"function"!=typeof g&&(g=null);var m=i.sourceView,v=i.sourceBBox,y=!1,b=!1;if(f?0==o?v.containsPoint(f)?(d.shift(),this.shiftHandleIndexes(-1),y=!0):(f[c]=l[c],b=!0):f[c]=l[c]:((f=i.sourceAnchor.toJSON())[c]=l[c],v.containsPoint(f)?(f[c]=l[c],y=!0):(d.unshift(f),this.shiftHandleIndexes(1),b=!0)),g&&m){if(y){var C=n.sourceAnchor.clone();C[c]=l[c];var I=g.call(i,C,m,i.sourceMagnet||m.el,"source",i);this.resetAnchor("source",I)}b&&this.resetAnchor("source",n.sourceAnchorDef)}var E=i.targetView,T=i.targetBBox,w=!1,x=!1;if(p?o==d.length-2?T.containsPoint(p)?(d.pop(),w=!0):(p[c]=l[c],x=!0):p[c]=l[c]:((p=i.targetAnchor.toJSON())[c]=l[c],T.containsPoint(p)?w=!0:(d.push(p),x=!0)),g&&E){if(w){var _=n.targetAnchor.clone();_[c]=l[c];var D=g.call(i,_,E,i.targetMagnet||E.el,"target",i);this.resetAnchor("target",D)}x&&this.resetAnchor("target",n.targetAnchorDef)}h.vertices(d,{ui:!0,tool:this.cid}),this.updateHandle(t,f,p,u)},onHandleChangeStart:function(t,e){var n=t.options.index,i=this.handles;if(Array.isArray(i)){for(var r=0,o=i.length;r<o;r++)r!==n&&i[r].hide();this.focus();var s=this.relatedView,a=s.model;this.eventData(e,{sourceAnchor:s.sourceAnchor.clone(),targetAnchor:s.targetAnchor.clone(),sourceAnchorDef:re(a.prop(["source","anchor"])),targetAnchorDef:re(a.prop(["target","anchor"]))}),s.model.startBatch("segment-move",{ui:!0,tool:this.cid})}},onHandleChangeEnd:function(t,e){var n=this.relatedView;this.options.redundancyRemoval&&n.removeRedundantLinearVertices({ui:!0,tool:this.cid}),this.render(),this.blur(),n.model.stopBatch("segment-move",{ui:!0,tool:this.cid}),n.checkMouseleave(vt(e))},updateHandle:function(t,e,n,i){var r=Math.abs(e.x-n.x)<this.precision,o=Math.abs(e.y-n.y)<this.precision;if(r||o){var s=new M(e,n);if(s.length()<this.options.segmentLengthThreshold)t.hide();else{var a=s.midpoint(),l=r?"x":"y";a[l]+=i||0;var c=s.vector().vectorAngle(new L(1,0));t.position(a.x,a.y,c,this.relatedView),t.show(),t.options.axis=l}}else t.hide()},onRemove:function(){this.resetHandles()}},{SegmentHandle:oo}),ao=Jr.extend({tagName:"path",xAxisVector:new L(1,0),events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},onRender:function(){this.update()},update:function(){var t,e,n=this.ratio,i=this.relatedView,r=i.getTangentAtRatio(n);if(e=r?(t=r.start,r.vector().vectorAngle(this.xAxisVector)||0):(t=i.getPointAtRatio(n),0),!t)return this;var o=Mt.createSVGMatrix().translate(t.x,t.y).rotate(e);return this.vel.transform(o,{absolute:!0}),this},onPointerDown:function(t){if(!this.guard(t)){t.stopPropagation(),t.preventDefault();var e=this.relatedView;e.model.startBatch("arrowhead-move",{ui:!0,tool:this.cid}),e.can("arrowheadMove")&&(e.startArrowheadMove(this.arrowheadType),this.delegateDocumentEvents(),e.paper.undelegateEvents()),this.focus(),this.el.style.pointerEvents="none"}},onPointerMove:function(t){var e=vt(t),n=this.paper.snapToGrid(e.clientX,e.clientY);this.relatedView.pointermove(e,n.x,n.y)},onPointerUp:function(t){this.undelegateDocumentEvents();var e=this.relatedView,n=e.paper,i=vt(t),r=n.snapToGrid(i.clientX,i.clientY);e.pointerup(i,r.x,r.y),n.delegateEvents(),this.blur(),this.el.style.pointerEvents="",e.model.stopBatch("arrowhead-move",{ui:!0,tool:this.cid})}}),lo=ao.extend({name:"target-arrowhead",ratio:1,arrowheadType:"target",attributes:{d:"M -10 -8 10 0 -10 8 Z",fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move",class:"target-arrowhead"}}),co=ao.extend({name:"source-arrowhead",ratio:0,arrowheadType:"source",attributes:{d:"M 10 -8 -10 0 10 8 Z",fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move",class:"source-arrowhead"}}),uo=Jr.extend({name:"button",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},options:{distance:0,offset:0,rotate:!1},onRender:function(){this.renderChildren(this.options.markup),this.update()},update:function(){return this.position(),this},position:function(){var t=this.relatedView,e=this.vel,n=t.model.isLink()?this.getLinkMatrix():this.getElementMatrix();e.transform(n,{absolute:!0})},getElementMatrix:function(){var t=this.relatedView,e=this.options,n=e.x;void 0===n&&(n=0);var i=e.y;void 0===i&&(i=0);var r=e.offset;void 0===r&&(r={});var o=e.useModelGeometry,s=e.rotate,a=no(t,o),l=t.model.angle();s||(a=a.bbox(l));var c=r.x;void 0===c&&(c=0);var u=r.y;void 0===u&&(u=0),jt(n)&&(n=parseFloat(n)/100*a.width),jt(i)&&(i=parseFloat(i)/100*a.height);var h=Mt.createSVGMatrix().translate(a.x+a.width/2,a.y+a.height/2);return s&&(h=h.rotate(l)),h.translate(n+c-a.width/2,i+u-a.height/2)},getLinkMatrix:function(){var t=this.relatedView,e=this.options,n=e.offset;void 0===n&&(n=0);var i=e.distance;void 0===i&&(i=0);var r,o,s,a=e.rotate;s=(r=jt(i)?t.getTangentAtRatio(parseFloat(i)/100):t.getTangentAtLength(i))?(o=r.start,r.vector().vectorAngle(new L(1,0))||0):(o=t.getConnection().start,0);var l=Mt.createSVGMatrix().translate(o.x,o.y).rotate(s).translate(0,n);return a||(l=l.rotate(-s)),l},onPointerDown:function(t){if(!this.guard(t)){t.stopPropagation(),t.preventDefault();var e=this.options.action;"function"==typeof e&&e.call(this.relatedView,t,this.relatedView,this)}}}),ho=uo.extend({children:[{tagName:"circle",selector:"button",attributes:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attributes:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],options:{distance:60,offset:0,action:function(t,e,n){e.model.remove({ui:!0,tool:n.cid})}}}),fo=Jr.extend({name:"boundary",tagName:"rect",options:{padding:10,useModelGeometry:!1},attributes:{fill:"none",stroke:"#33334F","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"},onRender:function(){this.update()},update:function(){var t=this.relatedView,e=this.options,n=this.vel,i=e.useModelGeometry,r=e.rotate,o=Ft(e.padding),s=no(t,i).moveAndExpand({x:-o.left,y:-o.top,width:o.left+o.right,height:o.top+o.bottom}),a=t.model;if(a.isElement()){var l=a.angle();if(l)if(r){var c=a.getBBox().center();n.rotate(l,c.x,c.y,{absolute:!0})}else s=s.bbox(l)}return n.attr(s.toJSON()),this}}),po=Jr.extend({tagName:"g",type:null,children:[{tagName:"circle",selector:"anchor",attributes:{cursor:"pointer"}},{tagName:"rect",selector:"area",attributes:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onPointerDblClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{snap:function(t,e,n,i,r,o){var s=o.options.snapRadius,a="source"===i,l=a?0:-1,c=this.model.vertex(l)||this.getEndAnchor(a?"target":"source");return c&&(Math.abs(c.x-t.x)<s&&(t.x=c.x),Math.abs(c.y-t.y)<s&&(t.y=c.y)),t},anchor:eo,customAnchorAttributes:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttributes:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,restrictArea:!0,redundancyRemoval:!0},onRender:function(){this.renderChildren(),this.toggleArea(!1),this.update()},update:function(){var t=this.type;return this.relatedView.getEndView(t)?(this.updateAnchor(),this.updateArea(),this.el.style.display=""):this.el.style.display="none",this},updateAnchor:function(){var t=this.childNodes;if(t){var e=t.anchor;if(e){var n=this.relatedView,i=this.type,r=n.getEndAnchor(i),o=this.options,s=n.model.prop([i,"anchor"]);e.setAttribute("transform","translate("+r.x+","+r.y+")");var a=s?o.customAnchorAttributes:o.defaultAnchorAttributes;for(var l in a)e.setAttribute(l,a[l])}}},updateArea:function(){var t=this.childNodes;if(t){var e=t.area;if(e){var n,i,r,o=this.relatedView,s=this.type,a=o.getEndView(s),l=a.model,c=o.getEndMagnet(s),u=this.options.areaPadding;isFinite(u)||(u=0),a.isNodeConnection(c)?(i=0,r=(n=a.getBBox()).center()):(n=a.getNodeUnrotatedBBox(c),i=l.angle(),r=n.center(),i&&r.rotate(l.getBBox().center(),-i)),n.inflate(u),e.setAttribute("x",-n.width/2),e.setAttribute("y",-n.height/2),e.setAttribute("width",n.width),e.setAttribute("height",n.height),e.setAttribute("transform","translate("+r.x+","+r.y+") rotate("+i+")")}}},toggleArea:function(t){this.childNodes.area.style.display=t?"":"none"},onPointerDown:function(t){this.guard(t)||(t.stopPropagation(),t.preventDefault(),this.paper.undelegateEvents(),this.delegateDocumentEvents(),this.focus(),this.toggleArea(this.options.restrictArea),this.relatedView.model.startBatch("anchor-move",{ui:!0,tool:this.cid}))},resetAnchor:function(t){var e=this.type,n=this.relatedView.model;t?n.prop([e,"anchor"],t,{rewrite:!0,ui:!0,tool:this.cid}):n.removeProp([e,"anchor"],{ui:!0,tool:this.cid})},onPointerMove:function(t){var e,n=this.relatedView,i=this.type,r=n.getEndView(i),o=r.model,s=n.getEndMagnet(i),a=vt(t),l=this.paper.clientToLocalPoint(a.clientX,a.clientY),c=this.options.snap;if("function"==typeof c&&(l=c.call(n,l,r,s,i,n,this),l=new L(l)),this.options.restrictArea)if(r.isNodeConnection(s)){var u=r.getClosestPoint(l);u&&(l=u)}else{var h=r.getNodeUnrotatedBBox(s),d=o.angle(),f=o.getBBox().center(),p=l.clone().rotate(f,d);h.containsPoint(p)||(l=h.pointNearestToPoint(p).rotate(f,-d))}var g=this.options.anchor;"function"==typeof g&&(e=g.call(n,l,r,s,i,n)),this.resetAnchor(e),this.update()},onPointerUp:function(t){this.paper.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);var e=this.relatedView;this.options.redundancyRemoval&&e.removeRedundantLinearVertices({ui:!0,tool:this.cid}),e.model.stopBatch("anchor-move",{ui:!0,tool:this.cid})},onPointerDblClick:function(){this.resetAnchor(),this.update()}}),go={Vertices:ro,Segments:so,SourceArrowhead:co,TargetArrowhead:lo,SourceAnchor:po.extend({name:"source-anchor",type:"source"}),TargetAnchor:po.extend({name:"target-anchor",type:"target"}),Button:uo,Remove:ho,Boundary:fo},mo={Button:uo,Remove:ho,Boundary:fo},vo=Mt,yo=un,bo=gn.prototype,Co=yo.define("standard.Record",{size:{width:100},padding:0,items:[],itemHeight:20,itemOffset:20,itemMinLabelWidth:10,itemButtonSize:10,itemIcon:{width:16,height:16,padding:2},itemOverflow:!1,attrs:{bodiesGroups:{fill:"transparent",stroke:"none"},labelsGroups:{fill:"#333333"},buttonsGroups:{fill:"transparent",stroke:"#333333",strokeWidth:1},forksGroups:{stroke:"#333333"},groups:{groupPosition:!0},itemBodies:{groupWidth:!0,itemHighlight:{fill:"#eeeeee"}},itemLabels:{fontSize:16,textVerticalAnchor:"middle",pointerEvents:"bounding-box",itemText:{textWrap:!0,ellipsis:!0},itemHighlight:{fill:"red"}}}},{markup:[],metrics:null,markupAttributes:["items","itemHeight","itemOffset","itemIcon","itemMinLabelWidth","itemButtonSize","itemOverflow","padding"],initialize:function(){un.prototype.initialize.apply(this,arguments),this.on("change",this.onChange,this),this.buildMarkup()},anyHasChanged:function(t){return!!Array.isArray(t)&&t.some(function(t){return this.hasChanged(t)},this)},onChange:function(t,e){e.record!==this.id&&this.hasChanged("markup")&&xo("Markup can not be modified."),this.anyHasChanged(this.markupAttributes)&&this.buildMarkup(e)},buildMarkup:function(t){var e=this.metrics={},n=e.items={},i=this.attributes,r=i.itemHeight,o=i.itemOffset,s=!!i.itemOverflow,a=i.items;Array.isArray(a)||(a=[]);var l=a.length,c=0,u=oe(this.markup);Array.isArray(u)||xo("Expects Prototype JSON Markup.");for(var h=Ft(i.padding),d=0,f=0;f<l;f++){for(var p=[],g=[],m=[],v=[],y=[],b=Array.from(a[f]),C=this.createQueue(b,0,[],null),I=0,E=0;0<C.length;){var T=C.pop(),w=T.path,x=T.level,_=T.item,D=T.parent;0===x&&w.splice(1,0,f);var A=_.id,O=-1!==x,S=_.height||r,R=_.icon,k=_.items,N=!!_.highlighted,M=!!_.collapsed,P=Array.isArray(k)&&0<k.length;A||xo("Item id required."),n.hasOwnProperty(A)&&xo("Duplicated item id.");var L=n[A]={path:w,visible:O,parent:D,label:_.label,height:S,group:f,hasSubItems:P,highlighted:N,collapsed:M};if(P&&(L.children=k.map(function(t){return t.id}),Array.prototype.push.apply(C,this.createQueue(k,M||!O?-1:x+1,w,A))),O){var K=o*x;if(L.x=K+o,L.y=I,L.cx=K+o/2,L.cy=I+S/2,L.span=_.span||1,A){var B=this.getItemBodyMarkup(_,K,I,f,s&&0===f?h.left:0);p.push(B);var z=this.getItemLabelMarkup(_,K,I,f);g.push(z),P&&(m.push(this.getButtonMarkup(_,K,I,f)),M||y.push(A)),R&&(v.push(this.getIconMarkup(_,K,I,f)),L.x+=i.itemIcon.width+i.itemIcon.padding)}E=Math.max(E,L.x+i.itemMinLabelWidth),I+=S}}d=Math.max(E,d),c=Math.max(c,I);var j=[];u.push({tagName:"g",selector:this.getSelector("group",f),groupSelector:"groups",attributes:{"record-group":f},children:j}),j.push({tagName:"g",selector:this.getSelector("bodiesGroup",f),groupSelector:"bodiesGroups",children:p},{tagName:"g",selector:this.getSelector("labelsGroup",f),groupSelector:"labelsGroups",children:g}),0<y.length&&j.push({tagName:"g",selector:this.getSelector("forksGroup",f),groupSelector:"forksGroups",children:y.map(this.getForkMarkup,this)}),0<m.length&&j.push({tagName:"g",selector:this.getSelector("buttonsGroup",f),groupSelector:"buttonsGroups",children:m}),0<v.length&&j.push({tagName:"g",selector:this.getSelector("iconsGroup",f),groupSelector:"iconsGroups",children:v})}e.padding=h,e.groupsCount=l,e.overflow=s,e.minHeight=c+h.top+h.bottom,e.minWidth=d*l+h.left+h.right;var G=Jt({record:this.id},t);this.set("markup",u,G),this.autoresize(G)},autoresize:function(t){var e=this.getMinimalSize(),n=this.attributes.size.width;this.resize(Math.max(n,e.width),e.height,t)},getMinimalSize:function(){var t=this.metrics;return{width:t.minWidth,height:t.minHeight}},removeInvalidLinks:function(t){var e=this.graph;return e?e.getConnectedLinks(this).filter(this.isLinkInvalid,this).map(function(e){return e.remove(t)}):[]},isLinkInvalid:function(t){var e=this.id,n=this.metrics.items,i=t.source();if(i.id===e&&i.hasOwnProperty("port")&&!n[i.port])return!0;var r=t.target();return!(r.id!==e||!r.hasOwnProperty("port")||n[r.port])},createQueue:function(t,e,n,i){var r=t.length;return Array.from({length:r},function(o,s){var a=r-s-1;return{path:n.concat(["items",a]),item:t[a],level:e,parent:i}})},getGroupSelector:function(t){for(var e=Array.prototype.slice.call(arguments,1),n=[t],i=0,r=e.length;i<r;i++){var o=e[i];if(null!=o){Array.isArray(o)||(o=[o]);for(var s=0,a=o.length;s<a;s++)n.push(this.getSelector(t,o[s]))}}return n},getItemLabelMarkup:function(t,e,n,i){var r=this.attributes,o=r.itemOffset,s=t.height||r.itemHeight,a=t.id,l=e+o;return t.icon&&(l+=r.itemIcon.width+2*r.itemIcon.padding),{tagName:"text",className:"record-item-label",selector:this.getSelector("itemLabel",a),groupSelector:this.getGroupSelector("itemLabels",i,t.group),attributes:{x:l,y:n+s/2,"item-id":a}}},getItemBodyMarkup:function(t,e,n,i,r){var o=0;r&&(o-=r);var s={x:o,y:n,height:t.height||this.attributes.itemHeight,"item-id":t.id},a=t.span;return a&&(s["item-span"]=a),{tagName:"rect",selector:this.getSelector("itemBody",t.id),groupSelector:this.getGroupSelector("itemBodies",i,t.group),className:"record-item-body",attributes:s}},getButtonMarkup:function(t,e,n){var i=this.attributes,r=i.itemButtonSize,o=i.itemOffset,s=t.height||i.itemHeight;return{tagName:"path",className:"record-item-button",attributes:{d:this.getButtonPathData(e+o/2,n+s/2,r/2,t.collapsed),"item-id":t.id,cursor:"pointer","shape-rendering":"geometricprecision"}}},getIconMarkup:function(t,e,n){var i=this.attributes,r=i.itemOffset,o=i.itemIcon,s=t.height||i.itemHeight;return{tagName:"image",className:"record-item-icon",attributes:{x:e+r+o.padding,y:n+(s-o.height)/2,width:o.width,height:o.height,"xlink:href":t.icon}}},getForkMarkup:function(t){return{tagName:"path",attributes:{d:this.getForkPathData(t),fill:"none"}}},getButtonPathData:function(t,e,n,i){var r=["M",t-n,e-n,t+n,e-n,t+n,e+n,t-n,e+n,"Z","M",t-n/2,e,t+n/2,e];return i&&Array.prototype.push.apply(r,["M",t,e-n/2,t,e+n/2]),r.join(" ")},getForkPathData:function(t){var e=this.metrics.items;if(!e)return null;var n=e[t];if(!n)return null;var i=n.children;if(!i||0===i.length)return null;for(var r,o=this.attributes.itemButtonSize,s=[],a=0,l=i.length;a<l;a++){var c=(r=e[i[a]]).cx+(r.hasSubItems?-1:1)*o/2;s.push("M",n.cx,r.cy,c,r.cy)}return s.push("M",n.cx,n.cy+o/2,n.cx,r.cy),s.join(" ")},item:function(t,e,n){var i=this.getItemPathArray(t);return i?void 0===e?this.prop(i):this.prop(i,e,n):null},toggleItemCollapse:function(t,e){var n=this.getItemPathArray(t);if(!n)return this;n.push("collapsed");var i=!!this.prop(n);return this.prop(n,!i,e),this},toggleItemHighlight:function(t,e){var n=this.getItemPathArray(t);if(!n)return this;n.push("highlighted");var i=!!this.prop(n);return this.prop(n,!i,e),this},isItemVisible:function(t){return this.getItemCacheAttribute(t,"visible")},isItemCollapsed:function(t){return this.getItemCacheAttribute(t,"collapsed")},isItemHighlighted:function(t){return this.getItemCacheAttribute(t,"highlighted")},getItemParentId:function(t){return this.getItemCacheAttribute(t,"parent")},getItemGroupIndex:function(t){return this.getItemCacheAttribute(t,"group")},getItemPathArray:function(t){var e=this.getItemCacheAttribute(t,"path");return e?e.slice():null},getItemSide:function(t){var e=this.getItemGroupIndex(t);if(null===e)return null;var n=this.metrics,i=n.groupsCount;if(1<i){if(0===e)return"left";if(e+n.items[t].span-1==i-1)return"right"}return"middle"},getItemCacheAttribute:function(t,e){if(!e)return null;var n=this.metrics.items;if(!n)return null;var i=n[t];return i?i[e]:null},getSelector:function(t,e){return t+"_"+e},removeItem:function(t,e){var n=this.getItemPathArray(t);if(!n)return this;var i=n.pop(),r=this.prop(n).slice();return 1<r.length?(r.splice(i,1),this.prop(n,r,Jt({rewrite:!0},e))):2<n.length?this.removeProp(n,e):(i=n.pop(),(r=this.get("items").slice()).splice(i,1),this.prop(n,r,Jt({rewrite:!0},e))),this},addNextSibling:function(t,e,n){var i=this.getItemPathArray(t);if(!i)return this;var r=this.getItemParentId(t)||this.getItemGroupIndex(t),o=i[i.length-1]+1;return this.addItemAtIndex(r,o,e,n)},addPrevSibling:function(t,e,n){var i=this.getItemPathArray(t);if(!i)return this;var r=this.getItemParentId(t)||this.getItemGroupIndex(t),o=i[i.length-1];return this.addItemAtIndex(r,o,e,n)},addItemAtIndex:function(t,e,n,i){if(!n)return this;var r;switch(typeof t){case"number":var o=this.prop("items");r=["items",Math.min(Math.max(t,0),o.length)];break;case"string":if(!(r=this.getItemPathArray(t)))return this;r.push("items");break;default:xo("Requires an item id.")}var s=this.prop(r);s=Array.isArray(s)?s.slice():[];var a=Math.min(Math.max(e,0),s.length);return s.splice(a,0,n),this.prop(r,s,Jt({rewrite:!0},i))},toJSON:function(){var t=un.prototype.toJSON.apply(this,arguments);return delete t.markup,t}},{attributes:{itemText:{set:function(t,e,n,i){if(!ce(t))return null;var r=this.model,o=n.getAttribute("item-id"),s=r.metrics.items[o];if(s){var a,l,c=s.label,u=r.metrics.padding,h=r.metrics.groupsCount,d=s.x,f=(e.width-u.left-u.right)/h*s.span-d,p=new B(d,s.y,f,s.height);l=t.textWrap?(a="textWrap",{text:c,ellipsis:t.ellipsis}):(a="text",c),this.getAttributeDefinition(a).set.call(this,l,p,n,i)}}},itemHighlight:{set:function(t,e,n,i){if(!ce(t))return null;var r=this.model,o=n.getAttribute("item-id");switch(r.getItemCacheAttribute(o,"highlighted")){case!0:return t;case null:case!1:return Object.keys(t).reduce(function(t,e){return!(i.hasOwnProperty(e)||i.hasOwnProperty(xe(e)))&&n.getAttribute(e)&&(t[e]=null),t},{})}}},groupWidth:{set:function(t,e,n){var i=this.model.metrics,r=i.padding,o=i.groupsCount,s=(e.width-r.left-r.right)/o,a=n.getAttribute("item-span");if(a&&(s*=Number(a)),i.overflow){var l=Number(this.findAttribute("record-group",n));0===l&&(s+=r.left),l===o-1&&(s+=r.right)}return{width:s}}},groupPosition:{position:function(t,e,n){var i=Number(n.getAttribute("record-group")),r=this.model.metrics,o=r.groupsCount,s=r.padding,a=(e.width-s.left-s.right)/o,l=s.left+i*a,c=s.top;return new L(l,c)}}}}),Io=Co.define("standard.BorderedRecord",{padding:0,attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#000000",fill:"#FFFFFF"}}},{markup:[{tagName:"rect",selector:"body"}]}),Eo=Co.define("standard.HeaderedRecord",{padding:{top:30,left:0,right:0,bottom:0},attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#000000",fill:"#FFFFFF"},header:{refWidth:"100%",height:30,stroke:"#000000",fill:"transparent"},headerLabel:{refX:"50%",refY:15,textAnchor:"middle",textVerticalAnchor:"middle",fontSize:20,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerLabel"}]}),To=Co.prototype.markupAttributes.reduce(function(t,e){return t[e]=["UPDATE"],t},{}),wo=gn.extend({events:{"mousedown .record-item-button":"onItemButtonClick","touchstart .record-item-button":"onItemButtonClick"},presentationAttributes:gn.addPresentationAttributes(To),getLinkEnd:function(t){return{id:this.model.id,port:this.findAttribute("item-id",t)}},getMagnetFromLinkEnd:function(t){for(var e=t.port,n=this.model;e&&!n.isItemVisible(e);)e=n.getItemParentId(e);e||bo.getMagnetFromLinkEnd.apply(this,arguments);var i=n.getSelector("itemBody",e);return this.findBySelector(i,this.el,this.selectors)[0]},onItemButtonClick:function(t){t.stopPropagation(),t.preventDefault();var e=t.currentTarget.getAttribute("item-id");this.model.toggleItemCollapse(e,{ui:!0})}});function xo(t){throw new Error("shapes.standard.Record: "+t)}var _o={Record:Co,BorderedRecord:Io,HeaderedRecord:Eo,RecordView:wo,BorderedRecordView:wo,HeaderedRecordView:wo},Do=un.define("basic.Generic",{attrs:{".":{fill:"#ffffff",stroke:"none"}}}),Ao=(Do.define("basic.Rect",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:100,height:60},text:{fill:"#000000",text:"","font-size":14,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><rect/></g><text/></g>'}),gn.extend({presentationAttributes:gn.addPresentationAttributes({attrs:["SCALE"]}),confirmUpdate:function(){var t=gn.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"SCALE")&&(this.resize(),t=this.removeFlag(t,"SCALE")),t}}),Do.define("basic.Text",{attrs:{text:{"font-size":18,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><text/></g></g>'}),Do.define("basic.Circle",{size:{width:60,height:60},attrs:{circle:{fill:"#ffffff",stroke:"#000000",r:30,cx:30,cy:30},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g><text/></g>'}),Do.define("basic.Ellipse",{size:{width:60,height:40},attrs:{ellipse:{fill:"#ffffff",stroke:"#000000",rx:30,ry:20,cx:30,cy:20},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse/></g><text/></g>'}),Do.define("basic.Polygon",{size:{width:60,height:40},attrs:{polygon:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'}),Do.define("basic.Polyline",{size:{width:60,height:40},attrs:{polyline:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polyline/></g><text/></g>'}),Do.define("basic.Image",{attrs:{text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><image/></g><text/></g>'}),Do.define("basic.Path",{size:{width:60,height:60},attrs:{path:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle",ref:"path","ref-x":.5,"ref-dy":10,fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><path/></g><text/></g>'}).define("basic.Rhombus",{attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5,"ref-dy":null,"y-alignment":"middle"}}}),mn.test("svgforeignobject")),Oo=Do.define("basic.TextBlock",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000","font-size":14,"font-family":"Arial, helvetica, sans-serif"},".content":{text:"","ref-x":.5,"ref-y":.5,"y-alignment":"middle","x-alignment":"middle"}},content:""},{markup:['<g class="rotatable">','<g class="scalable"><rect/></g>',Ao?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>',"</g>"].join(""),initialize:function(){this.listenTo(this,"change:size",this.updateSize),this.listenTo(this,"change:content",this.updateContent),this.updateSize(this,this.get("size")),this.updateContent(this,this.get("content")),Do.prototype.initialize.apply(this,arguments)},updateSize:function(t,e){this.attr({".fobj":Jt({},e),div:{style:Jt({},e)}})},updateContent:function(t,e){Ao?this.attr({".content":{html:Ct(e)}}):this.attr({".content":{text:e}})},setForeignObjectSize:function(){this.updateSize.apply(this,arguments)},setDivContent:function(){this.updateContent.apply(this,arguments)}}),So=gn.extend({presentationAttributes:Ao?gn.prototype.presentationAttributes:gn.addPresentationAttributes({content:["CONTENT"],size:["CONTENT"]}),initFlag:["RENDER","CONTENT"],confirmUpdate:function(){var t=gn.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"CONTENT")&&(this.updateContent(this.model),t=this.removeFlag(t,"CONTENT")),t},update:function(t,e){var n=this.model;if(Ao)gn.prototype.update.call(this,n,e);else{var i=Ie(e||n.get("attrs"),".content");gn.prototype.update.call(this,n,i),e&&!be(e,".content")||this.updateContent(n,e)}},updateContent:function(t,e){var n=At({},(e||t.get("attrs"))[".content"]);n=Ie(n,"text");var i=bt(t.get("content"),t.get("size"),n,{svgDocument:this.paper.svg}),r=ft({},".content",n,"/");r[".content"].text=i,gn.prototype.update.call(this,t,r)}}),Ro=Do.extend({markup:['<clipPath class="clip"><rect/></clipPath>','<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="axis">','<g class="y-axis"><path/><g class="ticks"></g></g>','<g class="x-axis"><path/><g class="ticks"></g></g>','<g class="markings"></g>',"</g>",'<g class="data"><g class="series"></g></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>','<line class="guideline x-guideline" /><line class="guideline y-guideline" />',"</g>","</g>"].join(""),tickMarkup:'<g class="tick"><line/><text/></g>',pointMarkup:'<g class="point"><circle/><text/></g>',barMarkup:'<path class="bar"/>',markingMarkup:'<g class="marking"><rect/><text/></g>',serieMarkup:'<g><clipPath class="serie-clip"><rect/></clipPath><path/><g class="bars"></g><g class="points"></g></g>',legendItemMarkup:'<g class="legend-item"><circle/><text/></g>',defaults:qt({type:"chart.Plot",attrs:{".data path":{fill:"none",stroke:"black"},".data .bars rect":{fill:"none",stroke:"black"},".background rect":{fill:"white",stroke:"#e5e5e5",opacity:1},".background text":{fill:"black",text:"No data available.",ref:".","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":10,"text-anchor":"middle","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":23,"text-anchor":"middle","y-alignment":"middle","font-size":10},".point":{display:"inline-block"},".point circle":{r:2,stroke:"black",fill:"black",opacity:.3},".point text":{fill:"black","font-size":8,"text-anchor":"middle",display:"none"},".axis path":{fill:"none",stroke:"black"},".axis .tick":{fill:"none",stroke:"black"},".y-axis .tick line":{fill:"none",stroke:"black",x2:2,y2:0,opacity:1},".x-axis .tick line":{fill:"none",stroke:"black",x2:0,y2:-3,opacity:1},".y-axis .tick text":{fill:"black",stroke:"none","font-size":10,"text-anchor":"end"},".x-axis .tick text":{fill:"black",stroke:"none","font-size":10,"text-anchor":"middle"},".y-axis .tick text > tspan":{dy:"-.5em",x:-5},".x-axis .tick text > tspan":{dy:".5em",x:0},".axis .markings":{fill:"black",stroke:"none","fill-opacity":1},".axis .markings text":{fill:"black","text-anchor":"end","font-size":10,dy:-5,dx:-5},".guideline":{"pointer-events":"none",display:"none"},".x-guideline":{stroke:"black",visibility:"hidden"},".y-guideline":{stroke:"black",visibility:"hidden"},".legend":{"ref-x":10,"ref-y":10},".legend-item text":{fill:"black",transform:"translate(14, 0)","font-size":11},".legend-item circle":{r:5,transform:"translate(5,5)"},".legend-item":{cursor:"pointer"},".legend-item.disabled circle":{fill:"gray"},".legend-item.disabled text":{opacity:.5}}},Do.prototype.defaults),legendPosition:function(t,e){e=e||{},this.trigger("batch:start"),[".legend/ref-x",".legend/ref-y",".legend/ref-dx",".legend/ref-dy",".legend/x-alignment",".legend/y-alignment"].forEach(function(t){this.removeAttr(t,{silent:!0})},this);var n=e.padding||10,i={n:{".legend":{"ref-x":.5,"x-alignment":-.5,"ref-y":n}},ne:{".legend":{"ref-dx":-n,"x-alignment":-.999,"ref-y":n}},e:{".legend":{"ref-dx":-n,"x-alignment":-.999,"ref-y":.5,"y-alignment":-.5}},se:{".legend":{"ref-dx":-n,"ref-dy":-n,"x-alignment":-.999,"y-alignment":-.999}},s:{".legend":{"ref-x":.5,"ref-dy":-n,"x-alignment":-.5,"y-alignment":-.999}},sw:{".legend":{"ref-x":n,"ref-dy":-n,"y-alignment":-.999}},w:{".legend":{"ref-x":n,"ref-y":.5,"y-alignment":-.5}},nw:{".legend":{"ref-x":n,"ref-y":n}},nnw:{".legend":{"ref-x":n,"ref-y":-n,"y-alignment":-.999}},nn:{".legend":{"ref-x":.5,"ref-y":-n,"x-alignment":-.5,"y-alignment":-.999}},nne:{".legend":{"ref-dx":-n,"ref-y":-n,"x-alignment":-.999,"y-alignment":-.999}},nnee:{".legend":{"ref-dx":n,"ref-y":-n,"y-alignment":-.999}},nee:{".legend":{"ref-y":n,"ref-dx":n}},ee:{".legend":{"ref-dx":n,"ref-y":.5,"y-alignment":-.5}},see:{".legend":{"ref-dx":n,"ref-dy":-n,"y-alignment":-.999}},ssee:{".legend":{"ref-dx":n,"ref-dy":n}},sse:{".legend":{"ref-dx":-n,"ref-dy":n,"x-alignment":-.999}},ss:{".legend":{"ref-x":.5,"ref-dy":n,"x-alignment":-.5}},ssw:{".legend":{"ref-x":n,"ref-dy":n}},ssww:{".legend":{"ref-x":-n,"ref-dy":n,"x-alignment":-.999}},sww:{".legend":{"ref-x":-n,"ref-dy":-n,"x-alignment":-.999,"y-alignment":-.999}},ww:{".legend":{"ref-x":-n,"ref-y":.5,"x-alignment":-.999,"y-alignment":-.5}},nww:{".legend":{"ref-x":-n,"ref-y":n,"x-alignment":-.999}},nnww:{".legend":{"ref-x":-n,"ref-y":-n,"x-alignment":-.999,"y-alignment":-.999}}};i[t]&&this.attr(i[t]),this.trigger("batch:stop")},addPoint:function(t,e,n){n=n||{};var i=this.get("series"),r=ue(i).findIndex(function(t){return t.name===e});if(-1===r)throw new Error("Serie "+e+" was not found.");var o=oe(i[r]);o.data.push(t),Number.isFinite(n.maxLen)&&o.data.length>n.maxLen&&o.data.shift(),(i=i.slice())[r]=o,this.set("series",i,n)},lastPoint:function(t){var e=ue(this.get("series")).find(function(e){return e&&e.name===t}).data;return e[e.length-1]},firstPoint:function(t){return ue(this.get("series")).find(function(e){return e&&e.name===t}).data[0]}}),ko=gn.extend({events:{mousemove:"onMouseMove",mouseout:"onMouseOut"},presentationAttributes:gn.addPresentationAttributes({series:["UPDATE"],interpolate:["UPDATE"],padding:["UPDATE"],canvas:["UPDATE"],markings:["UPDATE"],axis:["UPDATE"]}),initialize:function(){gn.prototype.initialize.apply(this,arguments),this.on("cell:pointerdown",this.onPointerDown,this),this._disabledSeries=[]},renderMarkup:function(){gn.prototype.renderMarkup.apply(this,arguments),this.elDataClipPath=this.$(".clip")[0],this.elDataClipPathRect=this.elDataClipPath.firstChild,this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForeground=this.$(".foreground")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elDataSeries=this.$(".data .series")[0],this.elYAxisPath=this.$(".y-axis path")[0],this.elYAxisTicks=this.$(".y-axis .ticks")[0],this.elXAxisPath=this.$(".x-axis path")[0],this.elXAxisTicks=this.$(".x-axis .ticks")[0],this.elMarkings=this.$(".axis .markings")[0],this.elXGuideline=this.$(".x-guideline")[0],this.elYGuideline=this.$(".y-guideline")[0],this.elLegend=this.$(".legend")[0],this.elLegendItems=this.$(".legend-items")[0],this.elTick=Mt(this.model.tickMarkup),this.elMarking=Mt(this.model.markingMarkup),this.elLegendItem=Mt(this.model.legendItemMarkup),this.elPoint=Mt(this.model.pointMarkup),this.elBar=Mt(this.model.barMarkup),this.elSerie=Mt(this.model.serieMarkup),this.elDataClipPath.id="clip_"+this.cid,Mt(this.$(".data")[0]).attr("clip-path","url(#"+this.elDataClipPath.id+")"),Mt(this.elMarkings).attr("clip-path","url(#"+this.elDataClipPath.id+")")},update:function(){var t=this.filterSeries();this.calculateStats(t);var e,n=this.model.get("size"),r=n.width,o=n.height;this.canvas=Jt({x:0,y:0,width:r,height:o},this.model.get("canvas"));var s={top:0,right:0,bottom:0,left:0},a=this.model.get("padding");e=De(a)?Jt({},s,a):void 0!==a?{top:a,right:2*a,bottom:2*a,left:a}:s,this.canvas=Y(this.canvas).moveAndExpand(Y(e.left,e.top,-e.right,-e.bottom));var l={x:0,y:0,width:r,height:o};Mt(this.elDataClipPathRect).attr(l),Mt(this.elBackgroundRect).attr(l),Mt(this.elForegroundRect).attr(l),this.updateAxis(),this.updateMarkings(),this.isEmpty()?i(this.elBackgroundText).show():i(this.elBackgroundText).hide(),this.updateSeries(t),this.updateLegend(),gn.prototype.update.apply(this,arguments)},calculateStats:function(t){t=t||this.model.get("series");var e=[],n=[],i={},r={},o={};ue(t).forEach(function(t,s){var a,l=o[t.name||s]||(o[t.name||s]={});l.decreasingX=!0,l.decreasingY=!0,l.nonDecreasingX=!0,l.nonDecreasingY=!0,we(t.data,function(o){l.minX=void 0===l.minX?o.x:Math.min(l.minX,o.x),l.maxX=void 0===l.maxX?o.x:Math.max(l.maxX,o.x),l.minY=void 0===l.minY?o.y:Math.min(l.minY,o.y),l.maxY=void 0===l.maxY?o.y:Math.max(l.maxY,o.y),a&&(l.decreasingX=l.decreasingX&&o.x<a.x,l.decreasingY=l.decreasingY&&o.y<a.y,l.nonDecreasingX=l.nonDecreasingX&&o.x>=a.x,l.nonDecreasingY=l.nonDecreasingY&&o.y>=a.y),e.includes(o.x)||e.push(o.x),n.includes(o.y)||n.push(o.y),(i[o.x]||(i[o.x]=[])).push({serie:t,x:o.x,y:o.y}),(r[o.y]||(r[o.y]=[])).push({serie:t,x:o.x,y:o.y}),a=o})});var s=this.model.get("axis")||{},a=s["x-axis"]||{},l=s["y-axis"]||{};this.stats={minX:void 0===a.min?e.reduce(function(t,e){return e<t?e:t},1/0):a.min,maxX:void 0===a.max?e.reduce(function(t,e){return t<e?e:t},-1/0):a.max,minY:void 0===l.min?n.reduce(function(t,e){return e<t?e:t},1/0):l.min,maxY:void 0===l.max?n.reduce(function(t,e){return t<e?e:t},-1/0):l.max,bySerie:o,xValues:e,yValues:n,xMap:i,yMap:r}},isEmpty:function(){return!this.stats.xValues.length},updateSeries:function(t){if(t=t||this.model.get("series"),this.elDataSeries.textContent="",!this.isEmpty()){var e=[this.stats.minX,this.stats.maxX],n=[this.stats.minY,this.stats.maxY],i=[this.canvas.x,this.canvas.x+this.canvas.width],r=[this.canvas.y+this.canvas.height,this.canvas.y],o=this.model.get("attrs");ue(t).forEach(function(t,s){var a=t.data,l=[],c=this.elSerie.clone().attr("class",t.name||"serie-"+s);Mt(this.elDataSeries).append(c),we(a,(function(s){var a=z.linear(e,i,s.x),c=z.linear(n,r,s.y);l.push({x:a,y:c}),o[".point"]&&"none"!==o[".point"].display&&this.renderPoint(s,t),t.bars&&this.renderBar(s,t)}).bind(this));var u=c.findOne(".serie-clip"),h=this.model.get("size"),d=this.stats.bySerie[t.name||s],f=z.linear(e,i,d.minX),p=z.linear(e,i,d.maxX);u.findOne("rect").attr(Y(f,0,p-f,h.height)),t.bars||c.findOne("path").attr({d:this.seriePathData(l,t,s),"clip-path":"url(#"+u.node.id+")"})},this)}},seriePathClipData:function(t,e){var n=this.model.get("size"),i=t[0];return["M",i.x,i.y,"V",n.height+10].join(" ")},renderBar:function(t,e){var n=[this.stats.minX,this.stats.maxX],i=[this.stats.minY,this.stats.maxY],r=[this.canvas.x,this.canvas.x+this.canvas.width],o=[this.canvas.y+this.canvas.height,this.canvas.y],s=z.linear(n,r,t.x),a=z.linear(i,o,t.y),l=e.bars.barWidth||.8,c=1<l?l:this.canvas.width/(this.stats.maxX-this.stats.minX)*l,u=z.linear(i,o,0)-a;i[0]===i[1]&&(a=this.canvas.y+this.canvas.height,u=0);var h=t["top-rx"]||e.bars["top-rx"],d=t["top-ry"]||e.bars["top-ry"],f=t["bottom-rx"]||e.bars["bottom-rx"],p=t["bottom-ry"]||e.bars["bottom-ry"],g={left:s,middle:s-c/2,right:s-c}[e.bars.align||"middle"],m=this.elBar.clone();m.attr({"data-serie":e.name,"data-x":t.x,"data-y":t.y,d:Mt.rectToPath({x:g,y:a,width:c,height:u,"top-rx":h,"top-ry":d,"bottom-rx":f,"bottom-ry":p})});var v=e.name||"serie-"+this.model.get("series").indexOf(e);return Mt(this.elDataSeries).findOne("."+v+" .bars").append(m),m.node},renderPoint:function(t,e){var n=[this.stats.minX,this.stats.maxX],i=[this.stats.minY,this.stats.maxY],r=[this.canvas.x,this.canvas.x+this.canvas.width],o=[this.canvas.y+this.canvas.height,this.canvas.y],s=z.linear(n,r,t.x),a=z.linear(i,o,t.y);i[0]===i[1]&&(a=this.canvas.y+this.canvas.height);var l=this.elPoint.clone();l.attr({"data-serie":e.name,"data-x":t.x,"data-y":t.y}),l.findOne("circle").attr({cx:s,cy:a}),l.findOne("text").attr({x:s,dy:a}).text(this.pointLabel(t,e));var c=e.name||"serie-"+this.model.get("series").indexOf(e);return Mt(this.elDataSeries).findOne("."+c+" .points").append(l),l.node},seriePathData:function(t,e,n){var i,r,o=t.length,s=[this.stats.minY,this.stats.maxY];if(s[0]===s[1])for(i=0;i<o;i++)t[i].y=this.canvas.y+this.canvas.height;switch(void 0===e.interpolate?this.model.get("interpolate"):e.interpolate){case"bezier":r=new P(R.throughPoints(t));break;case"step":for((r=new P).appendSegment(P.createSegment("M",t[0].x,t[0].y)),i=1;i<o;i++)r.appendSegment(P.createSegment("L",(t[i-1].x+t[i].x)/2,t[i-1].y)),r.appendSegment(P.createSegment("L",(t[i-1].x+t[i].x)/2,t[i].y));r.appendSegment(P.createSegment("L",t[o-1].x,t[o-1].y));break;case"stepBefore":for((r=new P).appendSegment(P.createSegment("M",t[0].x,t[0].y)),i=1;i<o;i++)r.appendSegment(P.createSegment("L",t[i-1].x,t[i].y)),r.appendSegment(P.createSegment("L",t[i].x,t[i].y));break;case"stepAfter":for((r=new P).appendSegment(P.createSegment("M",t[0].x,t[0].y)),i=1;i<o;i++)r.appendSegment(P.createSegment("L",t[i].x,t[i-1].y)),r.appendSegment(P.createSegment("L",t[i].x,t[i].y));break;default:for((r=new P).appendSegment(P.createSegment("M",t[0].x,t[0].y)),i=1;i<o;i++)r.appendSegment(P.createSegment("L",t[i].x,t[i].y))}return this.fixPathForFill(r,t,e,n).serialize()},fixPathForFill:function(t,e,n,i){if(0===e.length)return t;if(n.hideFillBoundaries)return t;if(!this.stats.bySerie[n.name||i].nonDecreasingX)return t;var r=t.getSegment(0);t.replaceSegment(0,P.createSegment("L",r.end.x,r.end.y));var o=n.fillPadding&&n.fillPadding.left||0,s=n.fillPadding&&n.fillPadding.right||0,a=n.fillPadding&&n.fillPadding.bottom||10,l=this.model.get("size"),c=e[0],u=e[e.length-1];return t.insertSegment(0,P.createSegment("M",u.x+s,l.height+a)),t.insertSegment(1,P.createSegment("L",c.x-o,l.height+a)),t.insertSegment(2,P.createSegment("L",c.x-o,c.y)),n.showRightFillBoundary&&(t.appendSegment(P.createSegment("L",u.x+s,u.y)),t.appendSegment(P.createSegment("Z"))),t},updateAxis:function(){var t=this.model.get("axis"),e=this.model.get("size"),n=e.height,i=e.width;if(Mt(this.elXAxisPath).attr("d",["M",0,n,"L",i,n].join(" ")),Mt(this.elYAxisPath).attr("d",["M",0,0,"L",0,n].join(" ")),this.elXAxisTicks.textContent="",this.elYAxisTicks.textContent="",!this.isEmpty()){var r=[this.stats.minX,this.stats.maxX],o=[this.stats.minY,this.stats.maxY],s=[this.canvas.x,this.canvas.x+this.canvas.width],a=[0,this.canvas.height],l=t&&t["y-axis"]||{},c=t&&t["x-axis"]||{};(function(t,e,n,i){function r(t,e,n){t.translate(e,n.height),Mt(this.elXAxisTicks).append(t)}function o(t,e,n){return z.linear(t,e,n)}function s(t){return t}if(t.ticks){var a=this.canvas.width/(e.width-2*this.canvas.x);u.call(this,t,e,n,i,o,r,s,a)}else{var l=this.stats.xValues;(function(t,e,n,i,r,o,s,a){a.forEach(function(a,l){l%(t.tickStep||1)==0&&h.call(this,t,e,n,i,r,o,s,a)},this)}).call(this,t,e,n,i,o,r,s,l)}}).call(this,c,e,r,s),(function(t,e,n,i){var r=this.canvas.height/e.height;u.call(this,t,e,n,i,function(t,e,n){return t[0]===t[1]?this.canvas.y+this.canvas.height:z.linear(t,e,n)},function(t,e){t.translate(0,e),Mt(this.elYAxisTicks).append(t)},function(t,e,n){return e[1]-(t-e[0])+(z.linear(n,e,this.canvas.y)-e[0])},r)}).call(this,l,e,o,a)}function u(t,e,n,i,r,o,s,a){var l=n[1]-n[0],c=t.ticks||11;0==l&&(c=1);for(var u=l/c/a,d=n[0],f=0;f<c;f++)h.call(this,t,e,n,i,r,o,s,d),d+=u}function h(t,e,n,i,r,o,s,a){var l=this.elTick.clone(),c=r.call(this,n,i,a);if(!(c>e.width)){o.call(this,l,c,e);var u=s.call(this,a,n,i);l.findOne("text").text(this.tickLabel(u,t))}}},tickLabel:function(t,e){if(le(e.tickFormat))return e.tickFormat(t);var n=e.tickFormat||".1f";return Zt.number(n,t)+(le(e.tickSuffix)?e.tickSuffix(t):e.tickSuffix||"")},pointLabel:function(t,e){if(le(e.pointFormat))return e.pointFormat(t);var n=e.pointFormat||".1f";return Zt.number(n,t.y)+(e.pointSuffix||"")},updateMarkings:function(){this.elMarkings.textContent="";var t=this.model.get("markings");if(t&&0!==t.length){var e=this.model.get("size"),n=e.width,i=e.height,r=[this.stats.minX,this.stats.maxX],o=[this.stats.minY,this.stats.maxY],s=[this.canvas.x,this.canvas.x+this.canvas.width],a=[this.canvas.y,this.canvas.y+this.canvas.height];ue(t).forEach(function(t,e){var c=t.start||t.end,u=t.end||t.start,h=Math.min(l(c.x,this.stats.minX),l(u.x,this.stats.minX)),d=Math.max(l(c.x,this.stats.maxX),l(u.x,this.stats.maxX)),f=Math.min(l(c.y,this.stats.minY),l(u.y,this.stats.minY)),p=Math.max(l(c.y,this.stats.maxY),l(u.y,this.stats.maxY)),g=void 0===c.x||void 0===u.x,m=void 0===c.y||void 0===u.y;g&&(s=[0,n]),m&&(a=[0,i]);var v=z.linear(r,s,h),y=z.linear(r,s,d),b=z.linear(o,a,f),C=z.linear(o,a,p),I=v,E=a[1]-C+a[0],T=y-v,w=C-b;if(o[0]===o[1]&&f===p){if(o[0]!==f)return;E=this.canvas.y+this.canvas.height,w=1}T=Math.max(T,1),w=Math.max(w,1);var x=this.elMarking.clone();x.findOne("rect").attr({x:I,y:E,width:T,height:w}),x.findOne("text").text(t.label||"").attr({x:I+T,y:E});var _=x.attr("class")+" "+(t.name||"marking-"+e);x.attr(Jt({class:_},t.attrs)),Mt(this.elMarkings).append(x)},this)}function l(t,e){return void 0===t?e:t}},updateLegend:function(){var t=this.model.get("series");this.elLegendItems.textContent="",ue(t).forEach(function(t,e){if((!le(t.showLegend)||t.showLegend(t,this.stats.bySerie[t.name||e]))&&!1!==t.showLegend){var n=this.elLegendItem.clone();this._disabledSeries.includes(t.name)&&n.addClass("disabled"),n.attr("data-serie",t.name),n.findOne("circle").attr({fill:this.getSerieColor(t.name)}),n.findOne("text").text(t.label||t.name),n.translate(0,e*(t.legendLabelLineHeight||16)),Mt(this.elLegendItems).append(n)}},this)},getSerieColor:function(t){var e=this.model.get("attrs"),n=Object.keys(e).find(function(e){return e.includes(t)});return n?e[n].stroke||e[n].fill:"black"},hideSerie:function(t){this._disabledSeries.includes(t)||this._disabledSeries.push(t);var e=this.filterSeries();this.update(e)},showSerie:function(t){this._disabledSeries=ge(this._disabledSeries,t);var e=this.filterSeries();this.update(e)},filterSeries:function(t){return t=t||this.model.get("series"),ue(t).filter(function(t){return!this._disabledSeries.includes(t.name)},this)},onPointerDown:function(t,e,n){var r=i(t.target).closest(".legend-item")[0];r&&(Mt(r).toggleClass("disabled"),Mt(r).hasClass("disabled")?this.hideSerie(Mt(r).attr("data-serie")):this.showSerie(Mt(r).attr("data-serie")))},onMouseMove:function(t){this.showGuidelines(t.clientX,t.clientY,t)},onMouseOut:function(t){this.hideGuidelines(),this.trigger("mouseout",t)},showGuidelines:function(t,e,n){var i=this.model.get("angle"),r=this.model.getBBox(),o=new L(Mt(this.paper.layers).toLocalPoint(t,e)).rotate(r.center(),i);if(Y(r).containsPoint(o)){var s=this.model.get("size"),a=o.x-r.x,l=o.y-r.y;Mt(this.elXGuideline).attr({x1:a,y1:0,x2:a,y2:s.height,visibility:"visible"}),Mt(this.elYGuideline).attr({x1:0,y1:l,x2:s.width,y2:l,visibility:"visible"});var c=z.linear([this.canvas.x,this.canvas.x+this.canvas.width],[this.stats.minX,this.stats.maxX],a),u=z.linear([this.canvas.y,this.canvas.y+this.canvas.height],[this.stats.minY,this.stats.maxY],l),h={x:c,y:this.stats.minY+this.stats.maxY-u},d={x:t,y:e},f=this.closestPoints(c);this.trigger("mouseover",h,d,f,n)}},closestPoints:function(t){var e=ne(this.stats.xValues,t),n=this.stats.xValues[e],i=this.stats.xValues[e-1],r=void 0===i||Math.abs(t-n)<Math.abs(t-i)?n:i;return this.stats.xMap[r]},hideGuidelines:function(){Mt(this.elXGuideline).attr("visibility","hidden"),Mt(this.elYGuideline).attr("visibility","hidden")}}),No=Do.extend({markup:['<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="data"></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>',"</g>","</g>"].join(""),sliceMarkup:'<g class="slice"/>',sliceFillMarkup:'<path class="slice-fill"/>',sliceBorderMarkup:'<path class="slice-border"/>',sliceInnerLabelMarkup:'<text class="slice-inner-label"/>',legendSerieMarkup:'<g class="legend-serie"><text/></g>',legendSliceMarkup:'<g class="legend-slice"><circle/><text/></g>',defaults:qt({type:"chart.Pie",size:{width:200,height:200},pieHole:0,serieDefaults:{startAngle:0,degree:360,label:null,showLegend:!0,labelLineHeight:6},sliceDefaults:{innerLabel:"{percentage:.0f}%",innerLabelMargin:6,legendLabel:"{label}: {value}",legendLabelLineHeight:6,legendLabelMargin:14,offset:0,onClickEffect:{type:"offset",offset:20},onHoverEffect:null},series:[],attrs:{".background > rect":{opacity:0},".background > text":{fill:"black",text:"No data available.",ref:".background > rect","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":6,"text-anchor":"start","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":18,"text-anchor":"start","y-alignment":"middle","font-size":10},".data":{ref:".background","ref-x":.5,"ref-y":.5},".slice":{cursor:"pointer"},".slice > .slice-fill":{stroke:"#ffffff","stroke-width":1,"fill-opacity":1},".slice.hover > .slice-fill":{"fill-opacity":.8},".slice > .slice-border":{"stroke-width":6,"stroke-opacity":.4,"fill-opacity":1,fill:"none",display:"none"},".slice.hover > .slice-border":{display:"block"},".slice > .slice-inner-label":{"text-anchor":"middle","font-size":"12",stroke:"none","stroke-width":"0",fill:"#ffffff"},".slice > .slice-inner-label > tspan":{dy:"-.5em"},".legend":{"ref-dx":20,"ref-y":5},".legend-serie text":{fill:"grey",transform:"translate(2, 0)","font-size":13},".legend-slice":{cursor:"pointer"},".legend-slice text":{"font-weight":"normal",fill:"black","font-size":11},".legend-slice.hover text":{"font-weight":"bold"},".legend-slice circle":{r:5,transform:"translate(5,5)"}}},Do.prototype.defaults),addSlice:function(t,e,n){n=n||{},e=e||0;var i=this.get("series");void 0===i[e]&&(i[e]={data:[]});var r=oe(i[e]);r.data.push(t),n=1<((i=i.slice())[e]=r).data.length?Jt(n,{changedSerieIndex:e}):n,this.set("series",i,n)},editSlice:function(t,e,n,i){i=i||{},n=n||0;var r=this.get("series");if(void 0===r[n]||void 0===r[n].data[e])throw new Error("Slice "+e+" on serie "+n+" was not found.");var o=oe(r[n]);o.data[e]=Jt(o.data[e],t),(r=r.slice())[n]=o,this.set("series",r,Jt(i,{changedSerieIndex:n}))}}),Mo=gn.extend({events:{"mouseover .slice":"onMouseOverSlice","mouseout .slice":"onMouseOverSlice","mousemove .slice":"onMouseMoveSlice","mouseover .legend-slice":"onEventLegendItem","mouseout .legend-slice":"onEventLegendItem"},presentationAttributes:gn.addPresentationAttributes({series:["UPDATE"],serieDefaults:["UPDATE"],sliceDefaults:["UPDATE"],pieHole:["UPDATE"]}),initialize:function(){gn.prototype.initialize.apply(this,arguments),this.on("cell:pointerclick",this.onClickSlice,this),this.on("cell:pointerclick",this.onEventLegendItem,this)},renderMarkup:function(){gn.prototype.renderMarkup.apply(this,arguments),this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elLegendItems=this.$(".legend-items")[0],this.elPie=this.$(".data")[0],this.elSlice=Mt(this.model.sliceMarkup),this.elSliceFill=Mt(this.model.sliceFillMarkup),this.elSliceBorder=Mt(this.model.sliceBorderMarkup),this.elSliceInnerLabel=Mt(this.model.sliceInnerLabelMarkup),this.elLegendSerie=Mt(this.model.legendSerieMarkup),this.elLegendSlice=Mt(this.model.legendSliceMarkup)},update:function(t,e,n){var r=(n=n||{}).changedSerieIndex,o=this.calculateSeries(r);r in o?i(this.elPie).find(".serie-"+r).remove():i(this.elPie).empty();var s=this.model.get("size");Mt(this.elBackgroundRect).attr(s),Mt(this.elForegroundRect).attr(s),o.length?i(this.elBackgroundText).hide():i(this.elBackgroundText).show(),ue(o).forEach(function(t,e){void 0!==r&&r!==e||we(t.data,this.updateSlice.bind(this))},this),this.updateLegend(),gn.prototype.update.apply(this,arguments)},calculateSeries:function(t){var e=oe(this.model.get("series")),n=this.model.get("serieDefaults"),i=this.model.get("sliceDefaults"),r=this.model.get("size"),o=Math.min(r.width,r.height)/2,s=this.model.get("pieHole"),a=o,l=(o-(s=1<s?s:o*s))/e.length;return this._series=e.map(function(e,r){if(void 0!==t&&t!==r)return e;var o=(e=Qt(e,n)).startAngle,s=e.data.reduce(function(t,e){return t+e.value},0),c=e.degree/s||0,u=100/s;return e.data=e.data.map(function(t,e){(t=Qt(t,Ie(i,"offset","onClickEffect","onHoverEffect"))).outerRadius=a,t.innerRadius=a-l,r||((t=Qt(t,Ee(i,"offset","onClickEffect","onHoverEffect"))).isOuter=!0,t.offset=1<t.offset?t.offset:t.offset*t.outerRadius,t.onClickEffect.offset=1<t.onClickEffect.offset?t.onClickEffect.offset:t.onClickEffect.offset*t.outerRadius),t.serieIndex=r,t.sliceIndex=e,t.innerLabelMargin=t.innerLabelMargin<-1||1<t.innerLabelMargin?t.innerLabelMargin:t.innerLabelMargin*t.outerRadius,t.percentage=t.value*u;var n=t.value*c;return t.degree={angle:n,start:o,end:n+o},t.rad={angle:V(t.degree.angle,!0),start:V(t.degree.start,!0),end:V(t.degree.end,!0)},t.middleangle=(t.rad.start+t.rad.end)/2,o=t.degree.end,t}),a-=l,e}),this._series},updateLegend:function(){var t=this._series;this.elLegendItems.textContent="";var e=0,n=parseInt(this.model.attr(".legend-serie text/font-size"),10),i=parseInt(this.model.attr(".legend-slice text/font-size"),10);ue(t).forEach(function(t,r){if(t.showLegend){if(t.label){var o=this.elLegendSerie.clone();t.name&&o.addClass(t.name),o.attr({"data-serie":r}),o.findOne("text").text(t.label),o.translate(0,e),Mt(this.elLegendItems).append(o),e+=n+t.labelLineHeight}we(t.data,(function(t,n){var o=this.elLegendSlice.clone(),s=this.getSliceFillColor(n,r);t.name&&o.addClass(t.name),o.attr({"data-serie":r,"data-slice":n}),o.findOne("text").text(Zt.string(t.legendLabel,t)),o.findOne("text").translate(t.legendLabelMargin),o.translate(0,e),e+=i+t.legendLabelLineHeight,De(s)?this.applyGradient(o.findOne("circle"),"fill",s):o.findOne("circle").attr({fill:s}),Mt(this.elLegendItems).append(o)}).bind(this))}},this)},applyGradient:function(t,e,n){var r=Ae(t)?this.findBySelector(t):i(t).toArray(),o=this.paper.defineGradient(n);r.forEach(function(t){Mt(t).attr(e,"url(#"+o+")")})},updateSlice:function(t){var e=this.elSlice.clone();Mt(this.elPie).append(e);var n=this.elSliceFill.clone(),i=this.getSliceFillColor(t.sliceIndex,t.serieIndex);n.attr({fill:i,d:Mt.createSlicePathData(t.innerRadius,t.outerRadius,t.rad.start,t.rad.end)}),e.append(n),De(i)&&this.applyGradient("#"+n.attr("id"),"fill",i);var r=this.elSliceBorder.clone(),o=parseInt(this.model.attr(".slice > .slice-border/stroke-width"),10),s=W.fromPolar(t.outerRadius+o/2,-t.rad.start,W(0,0)),a=W.fromPolar(t.outerRadius+o/2,-t.rad.end,W(0,0));r.attr({stroke:i,d:this.drawArc(s,a,t.outerRadius+o/2,t.rad.start,t.rad.end)}),e.append(r),De(i)&&this.applyGradient("#"+r.attr("id"),"stroke",i);var l=this.elSliceInnerLabel.clone();l.text(Zt.string(t.innerLabel,t)),e.append(l);var c=l.bbox(),u=t.outerRadius-c.width/2-t.innerLabelMargin;l.translate(u*Math.cos(-t.middleangle),-u*Math.sin(-t.middleangle)),e.attr({"data-serie":t.serieIndex,"data-slice":t.sliceIndex,"data-value":t.value});var h=this._series[t.serieIndex].name;return h&&e.addClass(h),t.name&&e.addClass(t.name),e.addClass("serie-"+t.serieIndex+" slice-"+t.sliceIndex),t.isOuter&&(e.addClass("outer"),t.offset&&(e.addClass("clicked"),this.effectOnSlice(e,t,{type:"offset",offset:t.offset}))),e},getSliceFillColor:function(t,e){e=e||0;var n=this.model.get("attrs"),i=Object.keys(n).find(function(n){return-1<n.indexOf(".serie-"+e+".slice-"+t+" > .slice-fill")});return i?n[i].fill:this._series[e].data[t].fill},onMouseMoveSlice:function(t){var e=Mt(t.currentTarget),n=e.attr("data-serie"),i=e.attr("data-slice"),r=this._series[n].data[i];this.trigger(t.type,r,t)},mouseOverSlice:function(t,e){e=e||0;var n=Mt(this.$('.slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0]),i=this._series[e].data[t];n.toggleClass("hover"),i.isOuter&&!se(i.onHoverEffect)&&this.effectOnSlice(n,i,i.onHoverEffect,!n.hasClass("hover"));var r=Mt(this.$('.legend-slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0]);r&&r.toggleClass("hover");var o=Object.keys(this.model.get("attrs")).filter(function(t){return-1<t.indexOf(".slice")||-1<t.indexOf(".legend-slice")});gn.prototype.update.call(this,this.model,Ee(this.model.get("attrs"),o))},onMouseOverSlice:function(t){var e=Mt(t.currentTarget),n=e.attr("data-serie"),i=e.attr("data-slice");this.mouseOverSlice(i,n);var r=this._series[n].data[i];this.trigger(t.type,r,t)},clickSlice:function(t,e){e=e||0;var n=Mt(this.$('.slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0]),i=this._series[e].data[t];i.isOuter&&(n.hasClass("clicked")?(n.removeClass("clicked"),this.model.get("series")[e].data[t].offset=0,this.effectOnSlice(n,i,i.onClickEffect,!0)):(n.addClass("clicked"),this.model.get("series")[e].data[t].offset=i.onClickEffect.offset,this.effectOnSlice(n,i,i.onClickEffect)))},onClickSlice:function(t){var e=Mt(i(t.target).closest(".slice.outer")[0]);if(e){var n=e.attr("data-serie"),r=e.attr("data-slice");this.clickSlice(r,n);var o=this._series[n].data[r];this.trigger(t.type,o,t)}},onEventLegendItem:function(t){var e=Mt(i(t.target).closest(".legend-slice")[0]);if(e){var n=e.attr("data-serie"),r=e.attr("data-slice");switch(t.type){case"click":this.clickSlice(r,n);break;case"mouseover":case"mouseout":this.mouseOverSlice(r,n)}}},effectOnSlice:function(t,e,n,i){switch(i=i||!1,n.type){case"enlarge":i?t.scale(1):t.scale(n.scale||1.05);break;case"offset":i?t.translate(0,0,{absolute:!0}):t.translate(n.offset*Math.cos(-e.middleangle),-n.offset*Math.sin(-e.middleangle))}},svgArcMax:2*Math.PI-1e-6,drawArc:function(t,e,n,i,r){var o=0,s=1,a=r-i;return a>Math.PI&&(o=1,a>=this.svgArcMax&&(s=o=0)),"M"+t.x+","+t.y+" A"+n+","+n+" 0 "+o+","+s+" "+e.x+","+e.y}}),Po=No.extend({defaults:qt({type:"chart.Knob",sliceDefaults:{legendLabel:"{value:.0f}",outer:{offsetOnClick:0}},pieHole:.7,value:0,attrs:{".legend":{"ref-x":.5,"ref-y":.5,"ref-dx":null,"x-alignment":-.5,"y-alignment":-.5},".legend-slice text":{"font-size":30},".legend-slice circle":{display:"none"},".slice-inner-label":{display:"none"},".slice-fill":{stroke:"none"}}},No.prototype.defaults),initialize:function(){this.set("series",this.getKnobSeries(),{silent:!0}),No.prototype.initialize.apply(this,arguments),this.on("change:value change:min change:max change:fill",this.updateKnob,this)},getKnobSeries:function(){var t=Array.isArray(this.get("value"))?this.get("value"):[this.get("value")],e=Array.isArray(this.get("fill"))?this.get("fill"):[this.get("fill")],n=Array.isArray(this.get("min"))?this.get("min"):[this.get("min")],i=Array.isArray(this.get("max"))?this.get("max"):[this.get("max")];return t.map(function(t,r){var o=void 0===n[r]?n[0]:n[r],s=void 0===i[r]?i[0]:i[r],a=void 0===e[r]?e[0]:e[r];return{degree:z.linear([o,s],[0,360],t),data:[{value:t,fill:a}],showLegend:!(0<r)}})},updateKnob:function(){this.set("series",this.getKnobSeries())}}),Lo=Mo,Ko=Do.extend({markup:['<g class="rotatable">','<g class="scalable">','<g class="background"><rect/></g>','<g class="cells"/>','<g class="foreground"/>',"</g>",'<g class="labels">','<g class="rows"/>','<g class="columns"/>',"</g>","</g>"].join(""),cellMarkup:'<rect class="cell"/>',labelMarkup:'<text class="label"/>',gridLineMarkup:'<path class="grid-line"/>',defaults:qt({type:"chart.Matrix",attrs:{".background rect":{fill:"#eeeeee"},".grid-line":{stroke:"white","stroke-width":2},".label":{fill:"black","alignment-baseline":"middle"},".labels .rows .label":{"text-anchor":"end"},".labels .columns .label":{"text-anchor":"start"}}},Do.prototype.defaults)}),Bo=gn.extend({presentationAttributes:gn.addPresentationAttributes({size:["LABELS"],cells:["MARKUP","LABELS"]}),initFlag:["LABELS"].concat(gn.prototype.initFlag),confirmUpdate:function(){var t=gn.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"MARKUP")&&(this.renderMarkup(),t=this.removeFlag(t,"MARKUP")),this.hasFlag(t,"LABELS")&&(this.renderLabels(),t=this.removeFlag(t,"LABELS")),t},renderMarkup:function(){gn.prototype.renderMarkup.apply(this,arguments),this.elCells=this.$(".cells")[0],this.elRowLabels=this.$(".labels .rows")[0],this.elColumnLabels=this.$(".labels .columns")[0],this.elForeground=this.$(".foreground")[0],this.elCell=Mt(this.model.cellMarkup),this.elGridLine=Mt(this.model.gridLineMarkup);var t=this.model.get("cells")||[],e=this.model.get("size");this.elBackgroundRect=this.$(".background rect")[0],Mt(this.elBackgroundRect).attr(e);var n=e.height/t.length,i=e.width/t.length,r=document.createDocumentFragment();this.elCells.textContent="",this.elForeground.textContent="";for(var o,s,a,l,c,u=document.createDocumentFragment(),h=0;h<t.length;h++)for((a=this.elGridLine.clone()).addClass("horizontal"),a.attr("d","M 0 "+h*n+" "+e.width+" "+h*n),u.appendChild(a.node),o=t[h],s=0;s<o.length;s++)0===h&&((a=this.elGridLine.clone()).addClass("vertical"),a.attr("d","M "+s*i+" 0 "+s*i+" "+e.height),u.appendChild(a.node)),(l=o[s])&&((c=this.elCell.clone()).attr(Jt({x:s*i,y:h*n,width:i,height:n},l)),r.appendChild(c.node));this.elForeground.appendChild(u),this.elCells.appendChild(r)},renderLabels:function(){this.elLabel=Mt(this.model.labelMarkup);var t,e,n=this.model.get("cells")||[],i=this.model.get("labels")||{},r=i.rows||[],o=i.columns||[],s=this.model.get("size"),a=s.height/n.length,l=s.width/n.length;this.elRowLabels.textContent="",this.elColumnLabels.textContent="";for(var c,u,h=document.createDocumentFragment(),d=0;d<r.length;d++)t=i.rows[d],(e=this.elLabel.clone()).text(t.text),e.attr(Jt({x:-(i.padding||5),y:d*a+a/2,"text-anchor":"end","dominant-baseline":"central","font-size":a,"data-row":d},Ie(t,"text"))),h.appendChild(e.node);this.elRowLabels.appendChild(h);for(var f=document.createDocumentFragment(),p=0;p<o.length;p++)t=i.columns[p],e=this.elLabel.clone(),c=p*l+l/2,u=-(i.padding||5),e.attr("x",c),e.text(t.text),e.attr(Jt({y:u,"text-anchor":"start","dominant-baseline":"central","font-size":l,"data-column":p},Ie(t,"text"))),e.rotate(-90,c,u),f.appendChild(e.node);this.elColumnLabels.appendChild(f)}}),zo={Plot:Ro,PlotView:ko,Pie:No,PieView:Mo,Knob:Po,KnobView:Lo,Matrix:Ko,MatrixView:Bo},jo={none:"",message:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDUxMiA1MTIiIGhlaWdodD0iNTEycHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB3aWR0aD0iNTEycHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGQ9Ik00NzkuOTk4LDY0SDMyQzE0LjMyOSw2NCwwLDc4LjMxMiwwLDk2djMyMGMwLDE3LjY4OCwxNC4zMjksMzIsMzIsMzJoNDQ3Ljk5OEM0OTcuNjcxLDQ0OCw1MTIsNDMzLjY4OCw1MTIsNDE2Vjk2ICBDNTEyLDc4LjMxMiw0OTcuNjcxLDY0LDQ3OS45OTgsNjR6IE00MTYsMTI4TDI1NiwyNTZMOTYsMTI4SDQxNnogTTQ0OCwzODRINjRWMTYwbDE5MiwxNjBsMTkyLTE2MFYzODR6Ii8+PC9zdmc+",plus:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIyLjUsMTRIMTR2OC41YzAsMC4yNzYtMC4yMjQsMC41LTAuNSwwLjVoLTRDOS4yMjQsMjMsOSwyMi43NzYsOSwyMi41VjE0SDAuNSAgQzAuMjI0LDE0LDAsMTMuNzc2LDAsMTMuNXYtNEMwLDkuMjI0LDAuMjI0LDksMC41LDlIOVYwLjVDOSwwLjIyNCw5LjIyNCwwLDkuNSwwaDRDMTMuNzc2LDAsMTQsMC4yMjQsMTQsMC41VjloOC41ICBDMjIuNzc2LDksMjMsOS4yMjQsMjMsOS41djRDMjMsMTMuNzc2LDIyLjc3NiwxNCwyMi41LDE0eiIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+",cross:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGQ9Ik0yMi4yNDUsNC4wMTVjMC4zMTMsMC4zMTMsMC4zMTMsMC44MjYsMCwxLjEzOWwtNi4yNzYsNi4yN2MtMC4zMTMsMC4zMTItMC4zMTMsMC44MjYsMCwxLjE0bDYuMjczLDYuMjcyICBjMC4zMTMsMC4zMTMsMC4zMTMsMC44MjYsMCwxLjE0bC0yLjI4NSwyLjI3N2MtMC4zMTQsMC4zMTItMC44MjgsMC4zMTItMS4xNDIsMGwtNi4yNzEtNi4yNzFjLTAuMzEzLTAuMzEzLTAuODI4LTAuMzEzLTEuMTQxLDAgIGwtNi4yNzYsNi4yNjdjLTAuMzEzLDAuMzEzLTAuODI4LDAuMzEzLTEuMTQxLDBsLTIuMjgyLTIuMjhjLTAuMzEzLTAuMzEzLTAuMzEzLTAuODI2LDAtMS4xNGw2LjI3OC02LjI2OSAgYzAuMzEzLTAuMzEyLDAuMzEzLTAuODI2LDAtMS4xNEwxLjcwOSw1LjE0N2MtMC4zMTQtMC4zMTMtMC4zMTQtMC44MjcsMC0xLjE0bDIuMjg0LTIuMjc4QzQuMzA4LDEuNDE3LDQuODIxLDEuNDE3LDUuMTM1LDEuNzMgIEwxMS40MDUsOGMwLjMxNCwwLjMxNCwwLjgyOCwwLjMxNCwxLjE0MSwwLjAwMWw2LjI3Ni02LjI2N2MwLjMxMi0wLjMxMiwwLjgyNi0wLjMxMiwxLjE0MSwwTDIyLjI0NSw0LjAxNXoiLz48L3N2Zz4=",user:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIyLDIwLjk5OGgtMWMwLDAtMSwwLTEtMVYxNy41YzAtMC4yNzctMC4yMjQtMC41LTAuNS0wLjVTMTksMTcuMjIzLDE5LDE3LjUgIGwtMC4wMDgsNC4yOTVjMCwwLjYwOS0yLjAxLDIuMjA1LTYuNDkyLDIuMjA1cy02LjQ5Mi0xLjU5Ni02LjQ5Mi0yLjIwNUw2LDE3LjVDNiwxNy4yMjMsNS43NzYsMTcsNS41LDE3UzUsMTcuMjIzLDUsMTcuNXYyLjQ5OCAgYzAsMS0xLDEtMSwxSDNjMCwwLTEsMC0xLTFWMTUuNzVjMC0yLjkyMiwyLjg5Mi01LjQwMSw2LjkzLTYuMzQxYzAsMCwxLjIzNCwxLjEwNywzLjU3LDEuMTA3czMuNTctMS4xMDcsMy41Ny0xLjEwNyAgYzQuMDM4LDAuOTQsNi45MywzLjQxOSw2LjkzLDYuMzQxdjQuMjQ4QzIzLDIwLjk5OCwyMiwyMC45OTgsMjIsMjAuOTk4eiBNMTIuNDc3LDljLTIuNDg1LDAtNC41LTIuMDE1LTQuNS00LjVTOS45OTEsMCwxMi40NzcsMCAgczQuNSwyLjAxNSw0LjUsNC41UzE0Ljk2Miw5LDEyLjQ3Nyw5eiIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+",circle:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3gULEBE3DEP64QAAAwlJREFUaN7dmktrU0EUx38ZmmBbfEIL2hSjkYKC1EW6EDFudC+404/gE6WKSvGxERQfIH4AX1T9EOKrCrYurVrbgsZWoaBVixDbpC6ci+Fyz9ybZG478cBs7syc+Z+5c86c+c8ksCPrgW1ADtgEbARafG1+AW+AYWAIGADGWUTZAJwHxoD5GssocA7ILiTwLcADoFQHcH8pAfeB7jiBtwO3gLJF4P5S1mO02wa/C5iMEbi/TAI7bYE/Y3m5VLOs+sLAJULqrgKHIxhZBp4DT4FX2jkLGoinq1M7fg7YDmwFVATd14CjFboiy5UIs/QBOAmka/izaeCU1hE2zuVqlZ8IUfgVOAA0WViiTcBBrdM0Zm9UhTuAOYOiRzXOeJh0Ak8M484B+TAlK4BPBiU3gWSMoTqpw6g0fgFYblJww9D5dojT25IEcMeA47rUsdsQLp9FmPmURSNSOqpJS2lzUKd+ocN3IBNx5mz+oXXADwHTXX/jjMFxjy1iwtgrYJoF1lY27BMafozZaaMspYKA7XRlw7f1xt4Y5biA7bXXIGv4TW0OGNCmsQRhzCidlwTJADDlgAFTwAuhLq+AHqHyMe6IhKVHAV1C5ZBDBkhYupThPPreIQNGJTJBGXKLLw4Z8NmQu/Fb8PCkQwakBIxFRWPLvAJmhMpWh4AuFb7PKGBaqFzjkAGrhe/TSjNrQZJ1yAAJy5gCRoTKnEMGSFhGFDBoOBu7IhKWQe8wLRFLHQ6A7zCcFNNK59vvAjoqYK8DBuwTCLBhTUD8Hweahj9S2jjU297VqzrU26BVmi2yEjXRKg1PbHnpqYla7AeWxAi+GbhHHdSit2mYyN2XQQ5kQTJ6Y6qL3PUkCr2+H7v0+jcs0eueRLngGNeKa9mxY73g8JzpEtHusorAQ/7e+e7WUWIl//jSVTrK7QEu6KgW9d7tYr3B44iBWPJfkZZ8pZ4r2VngkC0HywMTLNwN5YSBcKtZWoGzernEBbyox2iJc6Np2KcGfnHisYet1CDouc2yCjbhp07MrD+3+QNxi4JkAscRswAAAABJRU5ErkJggg==",service:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB1RJREFUeNrMWltMVFcUHZAIRSAkSFACITRAVbQ/DVhHiRZC2y9jotFgqgmxKqShKdFCggZbEpP2h1Q/oLUg8GH0xy/LKwpDEEFsjKCM8kYkgAhTpggDMzCc7kX2mGF677w80J5khbnnntc+Zz/W2ReNxvsSQLhPWCBYGPhdTdjg7aBCCI/gVSfu+CHBfPz48ba7d+82AocOHfqT6mYIEV6Oua4CfE6YHxsbeyS49Pf3P6C6RYJ2vQTwVTtKHx+fXYRzhM0qTbYR/g4JCQmyVYSFhQXTHyMhUWXMzTzmTo3MorATHxH0eEXAriYrtCmNiop6tby8bLCdgNVqfR0ZGTlC735RaJ/EY+HhGSFhTVSIyg7CIO3mRHNzs44WOYydJuQQ/AjxhJ9hsFqt9qlwKElJSRB8nvAjIYYN+hucDMbCmMHBwZP03E/YLlUAKh8TnoSHh49NT0+vLG5paWk0JyfnPu9cJ8EUGho6cfTo0fbBwcFWRwH6+vpaYcy0yCk26Hb0zc7ObsFYaIOxaY5xqn9M2ClTgGw8wqM4LuzevXu6xMTEnitXrjTOz8/3Chfl7du3Ly5fvtyUkJDQrzRedXV1I2/KWZkCwCDrsMMWi+WV46Sk42+EhwV24VhnNpuHaY43NFct5pRtA7tw9BkZGQ/peVHIL+bDhw8/YrtKXJM4QOVrVNfV1TXKXr2d6mTK8EI+tk4KPrszNjY2mIJTiK+vb5iK+zX29vbqW1paLNRe7N271590PpF+hyq1hzpt3bpVTE5ODlDfFIU5FdfiTRxAkDKVlpY2QI2VVNvOHUIVXjJmUEcC6Rz7keGLffv2CdoMK5/AogzupCZA8aZNmwxkbEMKi18sKSmxqcF1QjohmgF6UYl3LPw7GxoYGBAbN24U+fn5puLi4qWqqqoBGdwJxZ+J2ZeEXF6U9dixYw+VdLi1tbWJF3/aycBn0aa9vb3J1q++vl4EBARAfYRM7oTSwpFzjjAeExMznJ6e/mRkZORfAoA20Mn8Re3KFAaD9zpH2MzP13GK1GcafSl+iIiICGEymd6Nh4BG7SbVNgNj8Zg7nQmwdPLkybahoaG22dnZbntu41i6u7sh7CzhM1fciZCKTUEf9M3KyhLJycnYBCGTO6FYmpqa3HKX5eXlDWysUW5wp0K0LSoqasvLyxP+/v7ixIkTQjZ3WhFAR8UbAdzgTmY/Pz9rfHy8KCgoEKOjo0I2d1pxzxhAr9e3GI3GZ87ogp0KpbriTrdv3+6ghS9XVlYaFxYWxFpxJ5QaltxMeAOOf+DAgQ4VI55mIy53hzuRx7GuNXfSsM5FwJURzhBK3HSjZ/8P3MmrQIYgxUJUcvDKx/OtW7c61ps7ObtSziHiqlEJ0AU+VqgfPI8lOjraajAYVNUGKgg7Kisra4RDwG9bnFAqZMTjcBBI3ziLA0ovQPL0cXFxg6STU84W1NPT8+DSpUtt8DY3btwwqqm2p9zJ1q+wsBAqC7uL9EQA3H+Fu+41NzdXkPELMmQhizvZeSc9bQ5OucAtATiKLsAPK+0KXCKIWW1trSBSJjIzM8EwxYULF4RM7mRf0tLSnrCX/JXwLW9CLPO4VVfKcHAj4kMvldwZ6ojzr5CywMBAsWXLFrFnz54VmjAxMSE84U4KQqziTvYFapqSktIJnkbtXjNvW+DU5ioB8vDIOrlq7Xfu3GmgINNHl47lixcvIiO3QszsuY273ElFgFXcSSVGTBFfew7eBv4GHucoAHz6Y+I1r23UgFRmED6e1QD8XZBOW7zlTk4EgE28rKioaHBnbNgnPJ+vw8UGrO8rcoVzdJ2MqKmp0ZEbC7l58yaSWacJn0LqoKCgcc1/XOg0nHqhBDt6XI+TsXvnNXdycQJpUCHouzOagTkxN9/mrKqZAE7QgloEOtR7zZ1cCFABRqpkxNgIMuKnmIsvQGaOJ9UepzLelzupjJnlzI2mpqZ28KKvcspHy2vY4I0AMrhTDOMLQhXeXbt2zftAJikd7yl3AmZAxXFK3lIJH08lUUo++aBSo+ki7vQBGaHTRBjdwJ7TghGENFqtNoAuPTvUEmFkDxN0Z7ZSkBymvlqltUj5DOQpd/Kk4HbG6pct5fuYp9xJQlk8depUK1/8P5EqgDvcydPV4g6gVMcutNmWd5IlgEvuhA8ixJl63LjU64uKinS4g+AW5niauE+wKn0vUwB3uNMcvM+RI0faQcKU0ioHDx60pVWMtmQWvj9jLFtaBXNwWmWXbBvYThiAO8TO8UIMHHAQaOIIPyEQ7d+/v9NRgN27d3exfv/AhG4D9zVgLIzJ7heJrW3SjdgVd7Jr8zsybfZUATyKU4tXVXKt9Txml2pqUdbXdDXuZPf+OySPkX+1CQBixtzmjEqfQL6tJaqtxU/ix3I9n4JaeUEInZmZGSHasVIxNTU1wx9TulTGNNGf35zN67eOFL6X4Hv+/Hkr3aN14PNEPYL5atgvjde4+1HBy3/PaXb49xwwzD/eZyP/EWAAQ3AUnjpOYHIAAAAASUVORK5CYII="},Go={initialize:function(){this._parent=(this._parent||this).constructor.__super__,this._parent.initialize.apply(this,arguments),this.listenTo(this,"change:icon",this._onIconChange),this._onIconChange(this,this.get("icon")||"none")},_onIconChange:function(t,e){if(!be(jo,e))throw"BPMN: Unknown icon: "+e;t.attr({image:{"xlink:href":jo[e],dataIconType:e}})}},Fo={initialize:function(){this._parent=(this._parent||this).constructor.__super__,this._parent.initialize.apply(this,arguments),this.listenTo(this,"change:subProcess",this._onSubProcessChange),this._onSubProcessChange(this,this.get("subProcess")||null)},_onSubProcessChange:function(t,e){t.attr({".sub-process":{visibility:e?"visible":"hidden","data-sub-process":e||""}})}},Vo=So,Ho=Oo.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body outer"/><rect class="body inner"/></g>',mn.test("svgforeignobject")?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>','<path class="sub-process"/><image class="icon"/></g>'].join(""),defaults:qt({size:{width:100,height:100},type:"bpmn.Activity",attrs:{rect:{rx:8,ry:8,width:100,height:100},".body":{fill:"#ffffff",stroke:"#000000"},".inner":{transform:"scale(0.9,0.9) translate(5,5)"},path:{d:"M 0 0 L 30 0 30 30 0 30 z M 15 4 L 15 26 M 4 15 L 26 15",ref:".inner","ref-x":.5,"ref-dy":-30,"x-alignment":"middle",stroke:"#000000",fill:"transparent"},image:{ref:".inner","ref-x":5,width:20,height:20}},activityType:"task",subProcess:null},Oo.prototype.defaults),initialize:function(){Oo.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:activityType",this.onActivityTypeChange),this.listenTo(this,"change:subProcess",this.onSubProcessChange),this.onSubProcessChange(this,this.get("subProcess")),this.onActivityTypeChange(this,this.get("activityType"))},onActivityTypeChange:function(t,e){switch(e){case"task":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":1,"stroke-dasharray":"none"},path:{ref:".outer"},image:{ref:".outer"}});break;case"transaction":t.attr({".inner":{visibility:"visible"},".outer":{"stroke-width":1,"stroke-dasharray":"none"},path:{ref:".inner"},image:{ref:".inner"}});break;case"event-sub-process":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":1,"stroke-dasharray":"1,2"},path:{ref:".outer"},image:{ref:".outer"}});break;case"call-activity":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":5,"stroke-dasharray":"none"},path:{ref:".outer"},image:{ref:".outer"}});break;default:throw"BPMN: Unknown Activity Type: "+e}},onSubProcessChange:function(t,e){e?t.attr({".fobj div":{style:{verticalAlign:"baseline",paddingTop:10}},image:{"ref-dy":-25,"ref-y":""},".content":{"ref-y":10,"y-alignment":null}}):t.attr({".fobj div":{style:{verticalAlign:"middle",paddingTop:0}},image:{"ref-dy":"","ref-y":5},".content":{"ref-y":.5,"y-alignment":"middle"}})}}).extend(Go).extend(Fo),Uo=So,Zo=Oo.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body"/></g>',mn.test("svgforeignobject")?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>','<path class="stroke"/></g>'].join(""),defaults:qt({size:{width:100,height:100},type:"bpmn.Annotation",attrs:{rect:{width:100,height:100},".body":{"fill-opacity":.1,fill:"#ffffff",stroke:"none"},".fobj div":{style:{textAlign:"left",paddingLeft:10}},".stroke":{stroke:"#000000",fill:"none","stroke-width":3}},wingLength:20},Oo.prototype.defaults),initialize:function(){Oo.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:size",this.onSizeChange),this.onSizeChange(this,this.get("size"))},onSizeChange:function(t,e){t.attr(".stroke",{d:t.getStrokePathData(e.width,e.height,t.get("wingLength"))})},getStrokePathData:function(t,e,n){return["M",n=Math.min(n,t),"0 L 0 0 0",e,n,e].join(" ")}}),Wo=un.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/><image/></g></g><text class="label"/>',defaults:qt({type:"bpmn.Gateway",size:{width:80,height:80},attrs:{".body":{points:"40,0 80,40 40,80 0,40",fill:"#ffffff",stroke:"#000000"},".label":{text:"",ref:".body","ref-x":.5,"ref-dy":20,"y-alignment":"middle","x-alignment":"middle","font-size":14,"font-family":"Arial, helvetica, sans-serif",fill:"#000000"},image:{width:40,height:40,"xlink:href":"",transform:"translate(20,20)"}}},un.prototype.defaults)}).extend(Go),$o=un.extend({markup:'<g class="rotatable"><g class="scalable"><circle class="body outer"/><circle class="body inner"/><image/></g><text class="label"/></g>',defaults:qt({type:"bpmn.Event",size:{width:60,height:60},attrs:{".body":{fill:"#ffffff",stroke:"#000000"},".outer":{"stroke-width":1,r:30,transform:"translate(30,30)"},".inner":{"stroke-width":1,r:26,transform:"translate(30,30)"},image:{width:40,height:40,"xlink:href":"",transform:"translate(10,10)"},".label":{text:"",fill:"#000000","font-family":"Arial","font-size":14,ref:".outer","ref-x":.5,"ref-dy":20,"x-alignment":"middle","y-alignment":"middle"}},eventType:"start"},un.prototype.defaults),initialize:function(){un.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:eventType",this.onEventTypeChange),this.onEventTypeChange(this,this.get("eventType"))},onEventTypeChange:function(t,e){switch(e){case"start":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":1}});break;case"end":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":5}});break;case"intermediate":t.attr({".inner":{visibility:"visible"},".outer":{"stroke-width":1}});break;default:throw"BPMN: Unknown Event Type: "+e}}}).extend(Go),Yo=un.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body"/></g>','<svg overflow="hidden" class="blackbox-wrap"><text class="blackbox-label"/></svg>','<rect class="header"/><text class="label"/>','<g class="lanes"/>',"</g>"].join(""),laneMarkup:'<g class="lane"><rect class="lane-body"/><rect class="lane-header"/><text class="lane-label"/></g>',defaults:qt({type:"bpmn.Pool",size:{width:600,height:300},attrs:{".body":{fill:"#ffffff",stroke:"#000000",width:500,height:200,"pointer-events":"stroke"},".header":{fill:"#ffffff",stroke:"#000000",width:20,ref:".body","ref-height":1,"pointer-events":"visiblePainted"},".label":{fill:"#000000",transform:"rotate(-90)",ref:".header","ref-x":10,"ref-y":.5,"font-family":"Arial","font-size":14,"x-alignment":"middle","text-anchor":"middle"},".lane-body":{fill:"#ffffff",stroke:"#000000","pointer-events":"stroke"},".lane-header":{fill:"#ffffff",stroke:"#000000","pointer-events":"visiblePainted"},".lane-label":{fill:"#000000",transform:"rotate(-90)","text-anchor":"middle","font-family":"Arial","font-size":13},".blackbox-wrap":{ref:".body","ref-width":1,"ref-height":1},".blackbox-label":{text:"Black Box","text-anchor":"middle",transform:"translate(0,-7)"},".blackbox-label > tspan":{dx:"50%",dy:"50%"}}},un.prototype.defaults)}),Xo=gn.extend({options:{headerWidth:20},presentationAttributes:gn.addPresentationAttributes({lanes:["LANES"]}),confirmUpdate:function(){var t=gn.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"LANES")&&(this.renderLanes(this.model.get("lanes")),t=this.removeFlag(t,["LANES"])),t},update:function(){return void 0===this.lanesAttrs?this.renderLanes(this.model.get("lanes")):gn.prototype.update.call(this,this.model,At({},this.model.get("attrs"),this.lanesAttrs||{}))},renderMarkup:function(){gn.prototype.renderMarkup.apply(this,arguments),this.$lanes=this.$(".lanes"),this.laneMarkup=Mt(this.model.laneMarkup)},renderLanes:function(t){t=t||{};var e=void(this.index=0)===t.headerWidth?this.options.headerWidth:t.headerWidth;this.lanesAttrs={".header":{width:e},".label":{text:t.label||""}},this.$lanes.empty(),t.sublanes&&this.renderSublanes(t.sublanes,e,0,1,"lanes"),this.update(this.model,At({},this.model.get("attrs"),this.lanesAttrs))},calculateRatios:function(t,e){for(var n=0,i=[],r=[],o=0,s=t.length;o<s;o++){var a=t[o].ratio;Number.isFinite(a)?(n+=a/10,r[o]=a/10/e):i.push(o)}for(var l=Math.max(1-n,0)*e/i.length,c=0,u=i.length;c<u;c++)r[i[c]]=l;return r},renderSublanes:function(t,e,n,i,r){var o=this.options.headerWidth,s=r+"/sublanes/",a=this.calculateRatios(t,i);ue(t).reduce((function(t,i,r){var l="lane"+this.index,c="."+l+" .lane-body",u="."+l+" .lane-header",h="."+l+" .lane-label";i.name&&(l+=" "+i.name);var d=s+r,f=this.laneMarkup.clone().addClass(l).attr({"data-lane-path":d,"data-lane-index":this.index});this.$lanes.append(f.node);var p=a[r],g=void 0===i.headerWidth?o:i.headerWidth,m=n+t;return this.lanesAttrs[c]={ref:".body","ref-height":p,"ref-width":-e,"ref-x":e,"ref-y":m},this.lanesAttrs[u]={width:g,ref:".body","ref-height":p,"ref-x":e,"ref-y":m},this.lanesAttrs[h]={text:i.label,ref:u,"ref-x":10,"ref-y":.5,"x-alignment":"middle"},this.index++,i.sublanes&&this.renderSublanes(i.sublanes,e+g,m,p,d),t+p}).bind(this),0)}}),qo=un.extend({markup:'<g class="rotatable"><g class="scalable"><rect class="body"/></g><rect class="label-rect"/><g class="label-group"><svg overflow="hidden" class="label-wrap"><text class="label"/></svg></g></g>',defaults:qt({type:"bpmn.Group",size:{width:200,height:200},attrs:{".body":{width:200,height:200,stroke:"#000000","stroke-dasharray":"6,6","stroke-width":2,fill:"transparent",rx:15,ry:15,"pointer-events":"stroke"},".label-rect":{ref:".body","ref-width":.6,"ref-x":.4,"ref-y":-30,height:25,fill:"#ffffff",stroke:"#000000"},".label-group":{ref:".label-rect","ref-x":0,"ref-y":0},".label-wrap":{ref:".label-rect","ref-width":1,"ref-height":1},".label":{text:"",x:"50%",y:"1.3em","text-anchor":"middle","font-family":"Arial","font-size":14,fill:"#000000"}}},un.prototype.defaults)}),Jo=un.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/></g><text class="label"/></g>',defaults:qt({type:"bpmn.DataObject",size:{width:60,height:80},attrs:{".body":{points:"20,0 60,0 60,80 0,80 0,20 20,0 20,20 0,20",stroke:"#000000",fill:"#ffffff"},".label":{ref:".body","ref-x":.5,"ref-dy":5,text:"","text-anchor":"middle"}}},un.prototype.defaults)}),Qo=un.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/></g><text class="label"/><path class="sub-process"/></g>',defaults:qt({type:"bpmn.Conversation",size:{width:100,height:100},attrs:{".body":{points:"25,0 75,0 100,50 75,100 25,100 0,50",stroke:"#000000",fill:"#ffffff"},".label":{text:"",ref:".body","ref-x":.5,"ref-dy":5,"text-anchor":"middle"},path:{d:"M 0 0 L 30 0 30 30 0 30 z M 15 4 L 15 26 M 4 15 L 26 15",ref:".body","ref-x":.5,"ref-dy":-30,"x-alignment":"middle",fill:"#ffffff",stroke:"#000000","fill-opacity":0}},conversationType:"conversation"},un.prototype.defaults),initialize:function(){un.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:conversationType",this.onConversationTypeChange),this.onConversationTypeChange(this,this.get("conversationType"))},onConversationTypeChange:function(t,e){switch(e){case"conversation":t.attr("polygon/stroke-width",1);break;case"call-conversation":t.attr("polygon/stroke-width",4);break;default:throw"BPMN: Unknown Conversation Type: "+e}}}).extend(Fo),ts=Oo.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body"/></g>',mn.test("svgforeignobject")?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>','<text class="label"/><path class="sub-process"/><g class="participants"/>',"</g>"].join(""),participantMarkup:'<g class="participant"><rect class="participant-rect"/><text class="participant-label"/></g>',defaults:qt({type:"bpmn.Choreography",size:{width:60,height:80},attrs:{rect:{},".body":{width:60,height:80,stroke:"#000000",fill:"#ffffff"},".label":{ref:".body","ref-x":.5,"ref-dy":5,text:"","text-anchor":"middle"},".participant-rect":{stroke:"#000000",fill:"#aaaaaa",ref:".body","ref-width":1},".participant-label":{"text-anchor":"middle",ref:".participant_0 .participant-rect","ref-x":.5,"ref-y":.5,"y-alignment":"middle"},".sub-process":{d:"M 0 0 L 30 0 30 30 0 30 z M 15 4 L 15 26 M 4 15 L 26 15",ref:".body","ref-x":.5,"ref-dy":-30,"x-alignment":"middle",fill:"transparent",stroke:"#000000"}},participants:[],initiatingParticipant:0},Oo.prototype.defaults)}).extend(Fo),es=So.extend({options:{participantHeight:20},presentationAttributes:So.addPresentationAttributes({participants:"PARTICIPANTS",initiatingParticipant:"INIT_PARTICIPANT"}),initFlag:["PARTICIPANTS"].concat(So.prototype.initFlag),confirmUpdate:function(){var t=So.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"PARTICIPANTS")?(this.renderParticipants(this.model.get("participants")),t=this.removeFlag(t,["PARTICIPANTS","INIT_PARTICIPANT"])):(this.hasFlag(t,"INIT_PARTICIPANT")&&(this.layoutAndUpdate(),t=this.removeFlag(t,"INIT_PARTICIPANT")),t)},update:function(){return void 0===this.participantsAttrs?this.renderParticipants(this.model.get("participants")):(this.layoutAndUpdate(),this)},render:function(){this.participantsAttrs=void 0,gn.prototype.render.apply(this,arguments)},renderMarkup:function(){gn.prototype.renderMarkup.apply(this,arguments),this.$participants=this.$(".participants"),this.participantMarkup=Mt(this.model.participantMarkup)},renderParticipants:function(t){this.$participants.empty(),this.participantsAttrs={},ue(t).forEach(function(t,e){var n="participant_"+e,i="."+n;this.participantsAttrs[i+" .participant-rect"]={height:this.options.participantHeight},this.participantsAttrs[i+" .participant-label"]={text:t},this.$participants.append(this.participantMarkup.clone().addClass(n).node)},this),this.layoutAndUpdate()},layoutAndUpdate:function(){var t=this.model.get("participants")||[],e=t.length,n=this.options.participantHeight,i=this.model.get("size").height,r=Math.max(0,i-n*e),o=0,s=this.model.get("initiatingParticipant"),a=Math.max(St(s)?Math.abs(s):t.indexOf(s),0),l=Math.min(a,e-2);ue(t).forEach(function(t,e){var i=".participant_"+e;this.participantsAttrs[i]={transform:"translate(0,"+o+")"},this.participantsAttrs[i+" .participant-rect"].fill=a==e?this.model.attr(".body/fill"):this.model.attr(".participant-rect/fill"),this.participantsAttrs[i+" .participant-rect"].stroke=a==e?this.model.attr(".body/stroke"):this.model.attr(".participant-rect/stroke"),o+=n+(l==e?r:0)},this);var c=e<2?0:l-e+1;this.participantsAttrs[".sub-process"]={"ref-dy":Math.max(-i,c*n-30)};var u=e<2?0:l+1;this.participantsAttrs[".fobj div"]={style:{height:r,paddingTop:n*u}},this.participantsAttrs[".content"]={"ref-y":n*u+r/2};var h=At({},this.model.get("attrs"),this.participantsAttrs||{});pt(h,"div/html"),So.prototype.update.call(this,this.model,h)}}),ns=un.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/></g><text class="label"/></g>',defaults:qt({type:"bpmn.Message",size:{width:60,height:40},attrs:{".body":{points:"0,0 60,0 60,40 0,40 0,0 60,0 30,20 0,0",stroke:"#000000",fill:"#ffffff"},".label":{ref:".body","ref-x":.5,"ref-dy":5,text:"","text-anchor":"middle"}}},un.prototype.defaults)}),is=kn.extend({defaults:{type:"bpmn.Flow",attrs:{".marker-source":{d:"M 0 0"},".marker-target":{d:"M 10 0 L 0 5 L 10 10 z",fill:"#000000"},".connection":{"stroke-dasharray":" ","stroke-width":1},".connection-wrap":{style:"",onMouseOver:"",onMouseOut:""}},flowType:"normal"},initialize:function(){kn.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:flowType",this.onFlowTypeChange),this.onFlowTypeChange(this,this.get("flowType"))},onFlowTypeChange:function(t,e){var n;switch(e){case"default":n={".marker-source":{d:"M 0 5 L 20 5 M 20 0 L 10 10",fill:"none"}};break;case"conditional":n={".marker-source":{d:"M 20 8 L 10 0 L 0 8 L 10 16 z",fill:"#FFF"}};break;case"normal":n={};break;case"message":n={".marker-target":{fill:"#FFF"},".connection":{"stroke-dasharray":"4,4"}};break;case"association":n={".marker-target":{d:"M 0 0"},".connection":{"stroke-dasharray":"4,4"}};break;case"conversation":n={".marker-target":{d:"M 0 0"},".connection":{"stroke-width":"7px"},".connection-wrap":{style:"stroke: #fff; stroke-width: 5px; opacity: 1;",onMouseOver:"var s=this.style;s.stroke='#000';s.strokeWidth=15;s.opacity=.4",onMouseOut:"var s=this.style;s.stroke='#fff';s.strokeWidth=5;s.opacity=1"}};break;default:throw"BPMN: Unknown Flow Type: "+e}n.root={dataFlowType:e},t.attr(At({},this.defaults.attrs,n))}}),rs={icons:jo,IconInterface:Go,SubProcessInterface:Fo,ActivityView:Vo,Activity:Ho,AnnotationView:Uo,Annotation:Zo,Gateway:Wo,Event:$o,Pool:Yo,PoolView:Xo,Group:qo,DataObject:Jo,Conversation:Qo,Choreography:ts,ChoreographyView:es,Message:ns,Flow:is},os={exportElement:function(t){return t.size()},exportLink:function(t){var e=t.get("labelSize")||{};return{minLen:t.get("minLen")||1,weight:t.get("weight")||1,labelpos:t.get("labelPosition")||"c",labeloffset:t.get("labelOffset")||0,width:e.width||0,height:e.height||0}},importElement:function(t,e,n){var i=this.getCell(e),r=n.node(e);t.setPosition?t.setPosition(i,r):i.set("position",{x:r.x-r.width/2,y:r.y-r.height/2})},importLink:function(t,e,n){var i=this.getCell(e.name),r=n.edge(e),o=r.points||[],s=new K(o);if(t.setVertices||t.setLinkVertices)if(le(t.setVertices))t.setVertices(i,o);else{s.simplify({threshold:.001});var a=s.points.map(function(t){return t.toJSON()}),l=a.length;i.set("vertices",a.slice(1,l-1))}if(t.setLabels&&"x"in r&&"y"in r){var c={x:r.x,y:r.y};if(le(t.setLabels))t.setLabels(i,c,o);else{var u=s.closestPointLength(c),h=s.pointAtLength(u),d=u/s.length(),f=new L(c).difference(h).toJSON();i.label(0,{position:{distance:d,offset:f}})}}},layout:function(t,e){var n;n=t instanceof Zr?t:(new Zr).resetCells(t,{dry:!0,sort:!1});var i=(e=Qt(e||{},{resizeClusters:!(t=null),clusterPadding:10,exportElement:this.exportElement,exportLink:this.exportLink})).dagre||("undefined"!=typeof dagre?dagre:void 0);if(void 0===i)throw new Error('The the "dagre" utility is a mandatory dependency.');var r=os.toGraphLib(n,{graphlib:e.graphlib,directed:!0,multigraph:!0,compound:!0,setNodeLabel:e.exportElement,setEdgeLabel:e.exportLink,setEdgeName:function(t){return t.id}}),o={},s=e.marginX||0,a=e.marginY||0;if(e.rankDir&&(o.rankdir=e.rankDir),e.align&&(o.align=e.align),e.nodeSep&&(o.nodesep=e.nodeSep),e.edgeSep&&(o.edgesep=e.edgeSep),e.rankSep&&(o.ranksep=e.rankSep),e.ranker&&(o.ranker=e.ranker),s&&(o.marginx=s),a&&(o.marginy=a),r.setGraph(o),i.layout(r,{debugTiming:!!e.debugTiming}),n.startBatch("layout"),os.fromGraphLib(r,{importNode:this.importElement.bind(n,e),importEdge:this.importLink.bind(n,e)}),e.resizeClusters){var l=r.nodes().filter(function(t){return 0<r.children(t).length}).map(n.getCell.bind(n)).sort(function(t,e){return e.getAncestors().length-t.getAncestors().length});ee(l,"fitEmbeds",{padding:e.clusterPadding})}n.stopBatch("layout");var c=r.graph();return new B(s,a,Math.abs(c.width-2*s),Math.abs(c.height-2*a))},fromGraphLib:function(t,e){var n=(e=e||{}).importNode||Oe,i=e.importEdge||Oe,r=this instanceof Zr?this:new Zr;return t.nodes().forEach(function(i){n.call(r,i,t,r,e)}),t.edges().forEach(function(n){i.call(r,n,t,r,e)}),r},toGraphLib:function(t,e){var n=(e=e||{}).graphlib||("undefined"!=typeof graphlib?graphlib:void 0);if(void 0===n)throw new Error('The the "graphlib" utility is a mandatory dependency.');for(var i=Ee(e,"directed","compound","multigraph"),r=new n.Graph(i),o=e.setNodeLabel||Oe,s=e.setEdgeLabel||Oe,a=e.setEdgeName||Oe,l=t.get("cells"),c=0,u=l.length;c<u;c++){var h=l.at(c);if(h.isLink()){var d=h.get("source"),f=h.get("target");if(!d.id||!f.id)break;r.setEdge(d.id,f.id,s(h),a(h))}else if(r.setNode(h.id,o(h)),r.isCompound()&&h.has("parent")){var p=h.get("parent");l.has(p)&&r.setParent(h.id,p)}}return r}};Zr.prototype.toGraphLib=function(t){return os.toGraphLib(this,t)},Zr.prototype.fromGraphLib=function(t,e){return os.fromGraphLib.call(this,t,e)};var ss={Port:Qe,PortLabel:an,DirectedGraph:os},as=e.Model.extend({defaults:{linkDistance:10,linkStrength:1,charge:10,x:0,y:0},cacheAttribute:"_fcache",initialize:function(){var t,e,n=this.get("graph");if(Array.isArray(n)){var i=n;t=[],e=[];for(var r=0,o=i.length;r<o;r++){var s=i[r];s.isLink()?t.push(s):e.push(s)}}else e=n.getElements(),t=n.getLinks();this.links=t,this.elements=e,this.x=this.get("x"),this.y=this.get("y"),this.width=this.get("width"),this.height=this.get("height"),this.gravityCenter=this.get("gravityCenter"),this.t=1,this.energy=1/0,this.progress=0},start:function(){var t=this.width,e=this.height,n=this.x,i=this.y;this.elements.forEach(function(r){var o=H(n,n+t),s=H(i,i+e);r.position(o,s,{forceDirected:!0});var a=r[this.cacheAttribute]={};a.charge=r.get("charge")||this.get("charge"),a.weight=r.get("weight")||1,a.x=a.px=o,a.y=a.py=s,a.fx=0,a.fy=0},this),this.links.forEach(function(t){var e=t[this.cacheAttribute]={};e.source=t.getSourceElement(),e.target=t.getTargetElement(),e.strength=t.get("strength")||this.get("linkStrength"),e.distance=t.get("distance")||this.get("linkDistance")},this)},step:function(){if(.99*this.t<.005)return this.notifyEnd();var t,e,n,i,r,o,s,a,l,c,u,h=this.cacheAttribute,d=this.width,f=this.height,p=this.x,g=this.y,m=this.gravityCenter,v=this.energy,y=this.energy=0,b=0,C=0,I=0,E=this.elements.length,T=this.links.length;for(t=0;t<E-1;t++)for(y+=(n=this.elements[t][h]).x,b+=n.y,e=t+1;e<E;e++)s=(r=(i=this.elements[e][h]).x-n.x)*r+(o=i.y-n.y)*o,a=Math.sqrt(s),c=(l=this.t*n.charge/s)*r,u=l*o,n.fx-=c,n.fy-=u,i.fx+=c,i.fy+=u,this.energy+=c*c+u*u;var w,x,_,D,A,O,S=this.elements[E-1][h];for(y+=S.x,b+=S.y,t=0;t<T;t++)n=(w=this.links[t][h]).source[h],s=(r=(i=w.target[h]).x-n.x)*r+(o=i.y-n.y)*o,a=Math.sqrt(s),c=(x=this.t*w.strength*(a-w.distance)/a)*r,u=x*o,_=n.weight/(n.weight+i.weight),n.x+=c*(1-_),n.y+=u*(1-_),i.x-=c*_,i.y-=u*_,this.energy+=c*c+u*u;for(t=0;t<E;t++)O={x:(A=(D=this.elements[t])[h]).x,y:A.y},m&&(O.x+=(m.x-O.x)*this.t*.1,O.y+=(m.y-O.y)*this.t*.1),O.x+=A.fx,O.y+=A.fy,O.x=Math.max(p,Math.min(p+d,O.x)),O.y=Math.max(g,Math.min(p+f,O.y)),O.x+=.9*(A.px-O.x),O.y+=.9*(A.py-O.y),A.px=O.x,A.py=O.y,A.fx=A.fy=0,A.x=O.x,A.y=O.y,C+=A.x,I+=A.y,this.notify(D,t,O);this.t=this.cool(this.t,this.energy,v);var R=y-C,k=b-I;Math.sqrt(R*R+k*k)<1&&this.notifyEnd()},cool:function(t,e,n){return e<n?(this.progress+=1,5<=this.progress?(this.progress=0,t/.99):t):(this.progress=0,.99*t)},notify:function(t,e,n){t.set("position",n,{forceDirected:!0})},notifyEnd:function(){this.trigger("end")}}),ls={layout:function(t,e){var n;n=t instanceof Zr?t:(new Zr).resetCells(t,{dry:!0,sort:!1}),t=null,e=e||{};var i=n.getElements(),r=e.columns||1,o=Math.ceil(i.length/r),s=e.dx||0,a=e.dy||0,l=void 0===e.centre||!1!==e.centre,c=!!e.resizeToFit,u=e.marginX||0,h=e.marginY||0,d=[],f=e.columnWidth;if("compact"===f)for(var p=0;p<r;p++){var g=this._elementsAtColumn(i,p,r);d.push(this._maxDim(g,"width")+s)}else{f&&!Ae(f)||(f=this._maxDim(i,"width")+s);for(var m=0;m<r;m++)d.push(f)}var v=this._accumulate(d,u),y=[],b=e.rowHeight;if("compact"===b)for(var C=0;C<o;C++){var I=this._elementsAtRow(i,C,r);y.push(this._maxDim(I,"height")+a)}else{b&&!Ae(b)||(b=this._maxDim(i,"height")+a);for(var E=0;E<o;E++)y.push(b)}var T=this._accumulate(y,h);n.startBatch("layout"),i.forEach(function(t,n){var i=n%r,o=Math.floor(n/r),u=d[i],h=y[o],f=0,p=0,g=t.get("size");if(c){var m=u-2*s,b=h-2*a,C=g.height*(g.width?m/g.width:1),I=g.width*(g.height?b/g.height:1);h<C?m=I:b=C,g={width:m,height:b},t.set("size",g,e)}l&&(f=(u-g.width)/2,p=(h-g.height)/2),t.position(v[i]+s+f,T[o]+a+p,e)}),n.stopBatch("layout")},_maxDim:function(t,e){return t.reduce(function(t,n){return Math.max(n.get("size")[e],t)},0)},_elementsAtRow:function(t,e,n){for(var i=[],r=n*e,o=r+n;r<o;r++)i.push(t[r]);return i},_elementsAtColumn:function(t,e,n){for(var i=[],r=e,o=t.length;r<o;r+=n)i.push(t[r]);return i},_accumulate:function(t,e){return t.reduce(function(t,e,n){return t.push(t[n]+e),t},[e||0])}};function cs(t,e,n){n=Qt(n||{},{siblingGap:0}),this.width=0,this.height=0,this.layoutAreas=this.sortLayoutAreas(t),this.parentArea=e,this.siblingGap=n.siblingGap,this.exists()&&this.computeSize(n)}Jt(cs.prototype,{sortLayoutAreas:function(t){var e=fe(t,"siblingRank");return e.forEach(function(t,e){t.siblingRank=e}),e},move:function(t,e){for(var n=0,i=this.layoutAreas.length;n<i;n++)this.layoutAreas[n].dx+=t,this.layoutAreas[n].dy+=e},exists:function(){return 0<this.layoutAreas.length},sumGaps:function(t){return Math.max(this.layoutAreas.length-1,0)*t},getSiblingRankByPoint:function(t){if(!this.exists())return-1;var e=this.findAreaByPoint(t);return e?e.siblingRank-1:this.layoutAreas.length-1},getFirstChildConnectionPoints:function(){return[]},getConnectionPoints:function(t,e){if(!this.exists())return this.getFirstChildConnectionPoints(t);var n={dx:t.x-this.parentArea.rootCX,dy:t.y-this.parentArea.rootCY};return this.layoutAreas[0].getRootVertices(n,e)},getParentConnectionPoint:function(){var t=this.parentArea,e=this.proxyLayoutArea("getConnectionPoint",t.rootSize);return W(t.rootCX,t.rootCY).offset(e.x,e.y)},getChildConnectionPoint:function(t,e){var n=this.proxyLayoutArea("getConnectionPoint",e);return W(t).difference(n)},proxyLayoutArea:function(t){var e=Array.prototype.slice.call(arguments,1);return Ts.fromDirection(this.direction).prototype[t].apply(this.parentArea,e)}}),cs.extend=e.Model.extend;var us=cs.extend({getTopDY:function(){return-this.height/2},findAreaByPoint:function(t){return this.layoutAreas.find(function(e){return e.rootCY>t.y})},computeSize:function(t){this.height=this.sumGaps(t.siblingGap);var e=this.layoutAreas;this.height+=e.reduce(function(t,e){return t+e.height+e.prevSiblingGap+e.nextSiblingGap},0),e.reduce((function(e,n){return this.width=Math.max(this.width,n.getExtendedWidth()),n.dy+=e+n.getCY(),e+n.prevSiblingGap+n.height+n.nextSiblingGap+t.siblingGap}).bind(this),this.getTopDY())},getYTowardsParent:function(){return this.parentArea.rootCY},getXTowardsParent:function(){var t=this.parentArea;return t.rootCX+this.LRSign*(t.rootSize.width/2+t.gap)},getNeighborPointFromRank:function(t){var e,n=this.siblingGap;if(this.exists()){var i=this.layoutAreas[t],r=this.layoutAreas[t+1];e=i?r?(i.y+i.height+r.y)/2:i.y+i.height+n/2:r.y-n/2}else e=this.getYTowardsParent();return{x:this.getXTowardsParent(),y:e}}}),hs=us.extend({direction:"L",LRSign:-1}),ds=us.extend({direction:"R",LRSign:1}),fs={getXTowardsParent:function(){var t=this.parentArea;return t.rootCX+this.LRSign*t.gap},getYTowardsParent:function(){var t=this.parentArea,e=t.getLRHeight(t.siblings)/2;return e+=Math.min(t.firstChildGap,this.siblingGap/2),t.rootCY+this.TBSign*e},getFirstChildConnectionPoints:function(t){return[W(this.parentArea.rootCX,t.y)]},getChildConnectionPoint:function(t,e){return W(t).offset(-this.LRSign*e.width/2,0)},getParentConnectionPoint:function(){var t=this.parentArea;return W(t.rootCX,t.rootCY).offset(0,this.TBSign*(t.rootSize.height-t.rootMargin)/2)}},ps={getTopDY:function(){return 0}},gs={getTopDY:function(){return-this.height}},ms=us.extend({direction:"BR",LRSign:1,TBSign:1});Jt(ms.prototype,fs,ps);var vs=us.extend({direction:"BL",LRSign:-1,TBSign:1});Jt(vs.prototype,fs,ps);var ys=us.extend({direction:"TR",LRSign:1,TBSign:-1});Jt(ys.prototype,fs,gs);var bs=us.extend({direction:"TL",LRSign:-1,TBSign:-1});Jt(bs.prototype,fs,gs);var Cs=cs.extend({getLeftDX:function(){return-this.width/2},findAreaByPoint:function(t){return this.layoutAreas.find(function(e){return e.rootCX>t.x})},computeSize:function(t){this.width=this.sumGaps(t.siblingGap);var e=this.layoutAreas;this.width+=e.reduce(function(t,e){return t+e.width+e.prevSiblingGap+e.nextSiblingGap},0),e.reduce((function(e,n){return this.height=Math.max(this.height,n.getExtendedHeight()),n.dx+=e+n.getCX(),e+n.prevSiblingGap+n.width+n.nextSiblingGap+t.siblingGap}).bind(this),this.getLeftDX())},getNeighborPointFromRank:function(t){var e;if(this.exists()){var n=this.layoutAreas[t],i=this.layoutAreas[t+1];e=n?i?(n.x+n.width+i.x)/2:n.x+n.width+this.siblingGap/2:i.x-this.siblingGap/2}else e=this.parentArea.rootCX;return{x:e,y:this.getYTowardsParent()}}}),Is=Cs.extend({direction:"T",getYTowardsParent:function(){var t=this.parentArea;return t.rootCY-t.getLRHeight()/2-t.gap}}),Es=Cs.extend({direction:"B",getYTowardsParent:function(){var t=this.parentArea;return t.rootCY+t.getLRHeight()/2+t.gap}});function Ts(t,e){this.root=t;var n=Jt({},e,this.getRootAttributes(t,e.attributeNames)),i=e.gap||0;Qt(n,{parentGap:i,siblingGap:i,firstChildGap:i}),this.siblingRank=n.siblingRank,this.rootOffset=n.rootOffset,this.rootMargin=n.rootMargin,this.siblingGap=n.siblingGap,this.gap=this.parentGap=n.parentGap,this.nextSiblingGap=n.nextSiblingGap,this.prevSiblingGap=n.prevSiblingGap,this.firstChildGap=n.firstChildGap,this.dx=0,this.dy=0,this.width=0,this.height=0}function ws(){this.options={handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElement"},icon:null},{name:"direction",position:"se",events:{pointerdown:"directionSwap"},icon:null}],bbox:function(t){return t.paper.localToPaperPoint(t.getPointAtRatio(.5))},typeCssName:"type-link",tinyThreshold:-1,smallThreshold:-1,boxContent:!1}}Jt(Ts,{create:function(t,e,n){return new(Ts.fromDirection(t,n))(e,n)},fromDirection:function(t,e){var n;switch(t){case"L":n=_s;break;case"T":n=Ds;break;case"R":n=xs;break;case"B":n=As;break;case"BR":n=Os;break;case"BL":n=Ss;break;case"TR":n=Rs;break;case"TL":n=ks;break;default:n=Ts}return n}}),Jt(Ts.prototype,{direction:null,compute:function(t){this.childAreas=t,this.computeRelativePosition(this.root,t)},getHeight:function(t,e){return this.getTHeight(t)+this.getBHeight(t)+this.getLRHeight()},getWidth:function(t,e){var n=Math.max(t.T.width,t.B.width)/2;return Math.max(this.getLWidth(t,e)+e.width/2,n)+Math.max(this.getRWidth(t,e)+e.width/2,n)},getLRHeight:function(){return Math.max(this.rootSize.height,this.siblings.L.height,this.siblings.R.height)},getTHeight:function(t){return t.T.height+this.getTXHeight(t)},getBHeight:function(t){return t.B.height+this.getBXHeight(t)},getXLRWidth:function(t,e){return this.getLWidth(t,e)+e.width+this.getRWidth(t,e)},getXRWidth:function(t,e){var n=Math.max(t.BR.width,t.TR.width);return 0<n&&(n-=e.width/2),n},getTXHeight:function(t){var e=Math.max(t.TR.height,t.TL.height);return 0<e&&(e+=this.firstChildGap),e},getBXHeight:function(t){var e=Math.max(t.BR.height,t.BL.height);return 0<e&&(e+=this.firstChildGap),e},getXLWidth:function(t,e){var n=Math.max(t.BL.width,t.TL.width);return 0<n&&(n-=e.width/2),n},getRWidth:function(t,e){return Math.max(t.R.width,this.getXRWidth(t,e))},getLWidth:function(t,e){return Math.max(t.L.width,this.getXLWidth(t,e))},getTBOverlap:function(t,e){var n=Math.max(t.T.width,t.B.width);return 0<n&&(n-=e.width,n/=2),n},getRootDX:function(t,e){var n=this.getTBOverlap(t,e),i=Math.max(this.getLWidth(t,e),n);return(i-=Math.max(this.getRWidth(t,e),n))/2},getMinimalGap:function(t){return Math.min(t.siblingGap,this.firstChildGap,this.parentGap)},getBBox:function(t){var e=Y(this),n=t&&t.expandBy;return n&&e.moveAndExpand({x:-n,y:-n,width:2*n,height:2*n}),e},containsPoint:function(t,e){return this.getBBox(e).containsPoint(t)},getLayoutSiblings:function(t){return this.siblings[t]},getExtendedWidth:function(){return this.width+this.gap+this.rootOffset},getExtendedHeight:function(){return this.height+this.gap+this.rootOffset},findMinimalAreaByPoint:function(t,e){return this.containsPoint(t,e)?(this.childAreas.some(function(i){return!!(n=i.findMinimalAreaByPoint(t,e))}),n||this):null;var n},getType:function(){return Object.keys(this.siblings).reduce((function(t,e){return this.siblings[e].exists()?t.concat(e):t}).bind(this),[]).sort().join("-")},getRootAttributes:function(t,e){var n={rootOffset:t.get(e.offset||"offset")||0,rootMargin:t.get(e.margin||"margin")||0,prevSiblingGap:t.get(e.prevSiblingGap||"prevSiblingGap")||0,nextSiblingGap:t.get(e.nextSiblingGap||"nextSiblingGap")||0},i=t.get(e.siblingRank||"siblingRank");St(i)&&(n.siblingRank=i);var r=t.get(e.firstChildGap||"firstChildGap");return St(r)&&(n.firstChildGap=r),n},getRootSize:function(t,e){var n=t.size();return n[this.marginDimension]+=e,n},createSiblings:function(t,e){var n=de(t,"direction");return{L:new hs(n.L,this,e),T:new Is(n.T,this,e),R:new ds(n.R,this,e),B:new Es(n.B,this,e),BR:new ms(n.BR,this,e),BL:new vs(n.BL,this,e),TR:new ys(n.TR,this,e),TL:new bs(n.TL,this,e)}},computeSize:function(t,e){return{width:this.getWidth(t,e),height:this.getHeight(t,e)}},computeOrigin:function(){var t=this.siblings,e=this.rootSize,n=Math.max(this.getLWidth(t,e)+e.width/2,this.getXLWidth(t,e)+e.width/2,t.T.width/2,t.B.width/2);return{x:this.rootCX-n,y:this.rootCY-this.getTHeight(t)-this.getLRHeight()/2}},moveSiblings:function(t,e){if(this.hasHorizontalSiblings(t)){var n=e.width/2;t.L.move(-n,0),t.R.move(n,0)}if(this.hasVerticalSiblings(t)){var i=this.getLRHeight()/2;t.T.move(0,-i),t.B.move(0,i),t.BR.move(0,i),t.BL.move(0,i),t.B.move(0,this.getBXHeight(t)),t.TR.move(0,-i),t.TL.move(0,-i),t.T.move(0,-this.getTXHeight(t))}},moveRootToConnectionPoint:function(t){var e=this.getConnectionPoint(t);this.dx+=e.x,this.dy+=e.y},computeRelativePosition:function(t,e){var n=this.siblings=this.createSiblings(e,{siblingGap:this.siblingGap}),i=this.rootSize=this.getRootSize(t,this.rootMargin);Jt(this,this.computeSize(n,i)),this.moveSiblings(n,i),this.moveRootToConnectionPoint(i),this.moveRootBehindSiblings(n,i),this.moveRootFromParent()},computeAbsolutePosition:function(){if(this.parentArea)this.rootCX=this.parentArea.rootCX+this.dx,this.rootCY=this.parentArea.rootCY+this.dy,this.level=this.parentArea.level+1;else{var t=this.root.getBBox().center();this.rootCX=t.x,this.rootCY=t.y,this.level=0}Jt(this,this.computeOrigin())},hasVerticalSiblings:function(t){return t.T.exists()||t.B.exists()||t.BR.exists()||t.BL.exists()||t.TR.exists()||t.TL.exists()},hasHorizontalSiblings:function(t){return t.L.exists()||t.R.exists()},isSourceArea:function(){return!this.parentArea},isSinkArea:function(){return 0===this.childAreas.length},getRootPosition:function(){var t=this.root.get("size");return{x:this.rootCX-t.width/2,y:this.rootCY-t.height/2}},getRootVertices:function(t,e){if(e=e||{},0===(t=t||this)[this.deltaCoordinate]||!this.parentArea)return[];var n,i=this.parentArea.getInnerSize();if(!e.ignoreSiblings&&this.hasSiblingsBetweenParent()){var r=this.siblings[this.oppositeDirection];n=this.getRelativeVerticesAvoidingSiblings(i,t,r)}else n=this.getRelativeVertices(i,t);return ee(n,"offset",this.parentArea.rootCX,this.parentArea.rootCY)},getInnerSize:function(){return{width:this.rootSize.width,height:this.getLRHeight()}},getConnectionPoint:function(){return null},getRelativeVertices:function(){return null},moveRootFromParent:function(){},moveRootBehindSiblings:function(){},hasSiblingsBetweenParent:function(){return!this.isSourceArea()&&this.siblings[this.oppositeDirection].exists()},getCY:function(){return this.height/2+this.prevSiblingGap},getCX:function(){return this.width/2+this.prevSiblingGap}}),Ts.extend=e.Model.extend;var xs=Ts.extend({direction:"R",oppositeDirection:"L",deltaCoordinate:"dx",marginDimension:"height",getConnectionPoint:function(t){return W(t.width/2,0)},moveRootBehindSiblings:function(t,e){this.dx+=Math.max(this.getLWidth(t,e),this.getTBOverlap(t,e)),this.dy+=(this.getTHeight(t)-this.getBHeight(t))/2},moveRootFromParent:function(){this.dx+=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var n=this.getConnectionPoint(t),i=this.parentGap/2;return[n.clone().offset(i,0),n.clone().offset(i,e.dy)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=this.getConnectionPoint(t),r=n.siblingGap/2,o=0<this.dx?-1:1,s=e.dy+o*(n.height+r)/2,a=e.dy+o*this.rootSize.height/4,l=this.gap/2,c=1.5*l+Math.max(this.getLWidth(this.siblings,this.rootSize),this.getTBOverlap(this.siblings,this.rootSize));return[i.clone().offset(l,0),i.clone().offset(l,s),i.clone().offset(c,s),i.clone().offset(c,a)]}}),_s=Ts.extend({direction:"L",oppositeDirection:"R",deltaCoordinate:"dx",marginDimension:"height",getConnectionPoint:function(t){return W(-t.width/2,0)},moveRootBehindSiblings:function(t,e){this.dx-=Math.max(this.getRWidth(t,e),this.getTBOverlap(t,e)),this.dy+=(this.getTHeight(t)-this.getBHeight(t))/2},moveRootFromParent:function(){this.dx-=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var n=this.getConnectionPoint(t),i=-this.parentGap/2;return[n.clone().offset(i,0),n.clone().offset(i,e.dy)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=this.getConnectionPoint(t),r=0<this.dx?-1:1,o=e.dy+r*(n.height+n.siblingGap/2)/2,s=e.dy+r*this.rootSize.height/4,a=this.gap/2,l=1.5*a+Math.max(this.getRWidth(this.siblings,this.rootSize),this.getTBOverlap(this.siblings,this.rootSize));return[i.clone().offset(-a,0),i.clone().offset(-a,o),i.clone().offset(-l,o),i.clone().offset(-l,s)]}}),Ds=Ts.extend({direction:"T",oppositeDirection:"B",deltaCoordinate:"dy",marginDimension:"width",getConnectionPoint:function(t){return W(0,-t.height/2)},moveRootBehindSiblings:function(t,e){this.dx+=this.getRootDX(t,e),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2),this.dy-=this.getBHeight(t)},moveRootFromParent:function(){this.dy-=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var n=this.getConnectionPoint(t),i=-this.getTXHeight(this.parentArea.siblings)-this.parentGap/2;return[n.clone().offset(0,i),n.clone().offset(e.dx,i)]},getRelativeVerticesAvoidingSiblings:function(t,e){var n=this.getConnectionPoint(t),i=this.siblings,r=i.B,o=this.getTXHeight(this.parentArea.siblings)+this.parentGap/2,s=o+r.height;s+=this.getBXHeight(this.siblings)+this.parentGap/4;var a=this.dy<0?-1:1,l=i[0<a?"BR":"BL"].width,c=e.dx;c+=a*(Math.max(l,r.width/2)+r.siblingGap/4);var u=e.dx+a*this.rootSize.width/4;return[n.clone().offset(0,-o),n.clone().offset(c,-o),n.clone().offset(c,-s),n.clone().offset(u,-s)]}}),As=Ts.extend({direction:"B",oppositeDirection:"T",deltaCoordinate:"dy",marginDimension:"width",getConnectionPoint:function(t){return W(0,t.height/2)},moveRootBehindSiblings:function(t,e){this.dx+=this.getRootDX(t,e),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){this.dy+=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var n=this.getConnectionPoint(t),i=this.getBXHeight(this.parentArea.siblings)+this.parentGap/2;return[n.clone().offset(0,i),n.clone().offset(e.dx,i)]},getRelativeVerticesAvoidingSiblings:function(t,e){var n=this.getConnectionPoint(t),i=this.siblings,r=i.T,o=this.getBXHeight(this.parentArea.siblings)+this.parentGap/2,s=o+r.height;s+=this.getTXHeight(i)+this.parentGap/4;var a=this.dy<0?-1:1,l=i[0<a?"TR":"TL"].width,c=e.dx;c+=a*(Math.max(l,r.width/2)+r.siblingGap/4);var u=e.dx+a*this.rootSize.width/4;return[n.clone().offset(0,o),n.clone().offset(c,o),n.clone().offset(c,s),n.clone().offset(u,s)]}}),Os=Ts.extend({direction:"BR",oppositeDirection:"L",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return W(0,t.height/2)},getCY:function(){return this.prevSiblingGap},moveRootBehindSiblings:function(t,e){var n=Math.max(t.T.width,t.B.width);this.dx+=Math.max(this.getLWidth(t,e),(n-e.width)/2),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy+=t.firstChildGap),this.dx+=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){return[this.getConnectionPoint(t).clone().offset(0,e.dy-t.height/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=e.dx-this.rootSize.width/4,r=e.dy;return r+=Math.max(n.height,this.rootSize.height)/2,r+=this.getMinimalGap(n)/2,[W(0,r),W(i,r)]}}),Ss=Ts.extend({direction:"BL",oppositeDirection:"R",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return W(0,t.height/2)},getCY:function(){return this.prevSiblingGap},moveRootBehindSiblings:function(t,e){var n=Math.max(t.T.width,t.B.width);this.dx-=Math.max(this.getRWidth(t,e),(n-e.width)/2),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy+=t.firstChildGap),this.dx-=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){return[this.getConnectionPoint(t).clone().offset(0,e.dy-t.height/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=e.dx+this.rootSize.width/4,r=e.dy;return r+=Math.max(n.height,this.rootSize.height)/2,r+=this.getMinimalGap(n)/2,[W(0,r),W(i,r)]}}),Rs=Ts.extend({direction:"TR",oppositeDirection:"L",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return W(0,t.height/2)},getCY:function(){return this.height-this.rootSize.height+this.prevSiblingGap},moveRootBehindSiblings:function(t,e){this.dx+=Math.max(this.getLWidth(t,e),this.getTBOverlap(t,e)),this.dy-=this.getBHeight(t),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy-=t.firstChildGap),this.dx+=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){return[this.getConnectionPoint(t).clone().offset(0,e.dy-t.height/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=e.dx-this.rootSize.width/4,r=e.dy;return r-=Math.max(n.height,this.rootSize.height)/2,r-=this.getMinimalGap(n)/2,[W(0,r),W(i,r)]}}),ks=Ts.extend({direction:"TL",oppositeDirection:"R",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return W(0,t.height/2)},getCY:function(){return this.height-this.rootSize.height+this.prevSiblingGap},moveRootBehindSiblings:function(t,e){this.dx-=Math.max(this.getRWidth(t,e),this.getTBOverlap(t,e)),this.dy-=this.getBHeight(t),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy-=t.firstChildGap),this.dx-=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){return[this.getConnectionPoint(t).clone().offset(0,e.dy-t.height/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=e.dx+this.rootSize.width/4,r=e.dy;return r-=Math.max(n.height,this.rootSize.height)/2,r-=this.getMinimalGap(n)/2,[W(0,r),W(i,r)]}}),Ns={rotate:function(t){var e="LRBT",n=e.indexOf(t[0])-e.indexOf(t[1]);return function(t){var i=e.indexOf(t);return 0<=i?e[(4+i-n)%4]:t}},flip:function(t){var e=t[0],n=t[1];return function(t){return t===e?n:t===n?e:t}},straighten:function(t){return function(){return t[1]}}},Ms=e.Model.extend({defaults:{graph:void 0,gap:20,parentGap:20,siblingGap:20,firstChildGap:20,direction:"R",directionRule:Ns.straighten,updatePosition:function(t,e,n){t.set("position",e,n)},updateVertices:function(t,e,n){t.set("vertices",e,n)},updateAttributes:null,filter:null,attributeNames:{}},initialize:function(){this._cacheOptions(this.attributes),this.layoutAreas={}},layout:function(t){this.layoutAreas={};for(var e=this.getGraphSources(t),n=0,i=e.length;n<i;n++)this.layoutTree(e[n],t);return this.trigger("layout:done",t),this},layoutTree:function(t,e){(e=e||{}).treeLayout=!0;var n=this._computeLayoutAreas(t,null,e);return this._computeAbsolutePositions(n),this._updateCells(n,e),this},getLayoutBBox:function(){return this.getRootLayoutAreas().reduce(function(t,e){var n=e.getBBox();return t?t.union(n):n},null)},getLayoutArea:function(t){return this.layoutAreas[t.id||t]||null},getRootLayoutAreas:function(){return this.getGraphSources().map(this.getLayoutArea,this)},getGraphSources:function(t){var e=this.graph.getSources();return this.filter&&0<e.length&&(e=this.filter(e,null,t)||e),e},getMinimalRootAreaByPoint:function(t){var e=this.getRootLayoutAreas().filter(function(e){return e.containsPoint(t)});return se(e)?null:e.reduce(function(t,e){return e.width*e.height<t.min&&(t.min=e.width*e.height,t.item=e),t},{min:1/0,item:void 0}).item},_computeLayoutAreas:function(t,e,n){var i=e?e.direction:this.get("direction"),r=t.get(this.getAttributeName("direction"))||i,o=Ts.create(r,t,this.attributes);o.parentArea=e,o.link=this.graph.getConnectedLinks(t,{inbound:!0})[0];var s=this._getChildren(t,n);this.layoutAreas[t.id]=o;for(var a=[],l=0,c=s.length;l<c;l++)a.push(this._computeLayoutAreas(s[l],o,n));return o.compute(a),o},_cacheOptions:function(t){["updateAttributes","updateVertices","updatePosition","filter"].forEach(function(e){this[e]=le(t[e])?t[e]:null},this),this.graph=t.graph},_getChildren:function(t,e){if(this.layoutAreas[t.id])return[];var n=this.graph.getNeighbors(t,{outbound:!0});return this.filter&&0<n.length&&(n=this.filter(n,t,e)||n),n},_computeAbsolutePositions:function(t){t.computeAbsolutePosition(t);for(var e=0,n=t.childAreas.length;e<n;e++)this._computeAbsolutePositions(t.childAreas[e])},_updateCells:function(t,e){var n=t.root,i=t.link||null;i&&(this.updatePosition&&this.updatePosition(n,t.getRootPosition(),e),this.updateVertices&&this.updateVertices(i,t.getRootVertices(),e)),this.changeSiblingRank(n,t.siblingRank,e),this.updateAttributes&&this.updateAttributes(t,n,i,e);for(var r=0,o=t.childAreas.length;r<o;r++)this._updateCells(t.childAreas[r],e)},updateDirections:function(t,e,n){n=n||{};var i=this.getAttributeName("direction"),r=this.get("directionRule")(e);this.graph.search(t,(function(t,e){if(0!==e){var o=r(t.get(i));this.changeDirection(t,o,n)}}).bind(this),{outbound:!0})},reconnectElement:function(t,e,n){n=n||{};var i=this.getLayoutArea(t),r=i.link;if(r){r.set("source",{id:e.id||e},n);var o=i.direction,s=n.direction||o,a=n.siblingRank||void 0;return this.changeSiblingRank(t,a,n),this.changeDirection(t,s,n),o!==s&&this.updateDirections(t,[o,n.direction],n),!0}return!1},changeSiblingRank:function(t,e,n){t.set(this.getAttributeName("siblingRank"),e,n)},changeDirection:function(t,e,n){t.set(this.getAttributeName("direction"),e,n)},getAttributeName:function(t){return this.get("attributeNames")[t]||t},getAttribute:function(t,e){return t.get(this.getAttributeName(e))},prepare:function(){return this}},{directionRules:Ns}),Ps={ForceDirected:as,GridLayout:ls,TreeLayout:Ms},Ls=e.Collection.extend({LOCAL_STORAGE_KEY:"joint.ui.Clipboard.cells",defaults:{useLocalStorage:!0},copyElements:function(t,e,n){this.options=Jt({},this.defaults,n),n=this.options;var i=t.toArray(),r=fe(e.cloneSubgraph(i,n),function(t){return t.isLink()?2:1});return this.reset(r),n.useLocalStorage&&window.localStorage&&localStorage.setItem(this.LOCAL_STORAGE_KEY,JSON.stringify(this.toJSON())),i},cutElements:function(t,e,n){var i=this.copyElements(t,e,n);return e.trigger("batch:start",{batchName:"cut"}),ee(i,"remove"),e.trigger("batch:stop",{batchName:"cut"}),i},pasteCells:function(t,e){if((e=Qt(e||{},this.options)).useLocalStorage&&window.localStorage){var n=JSON.parse(localStorage.getItem(this.LOCAL_STORAGE_KEY));if(n){var i={cells:n},r=t.get("cells").cellNamespace,o=new Zr([],{cellNamespace:r}).fromJSON(i,{sort:!1,dry:!0});this.reset(o.getCells())}}var s=this.map((function(t){return this.modifyCell(t,e)}).bind(this));return t.trigger("batch:start",{batchName:"paste"}),t.addCells(s),t.trigger("batch:stop",{batchName:"paste"}),this.copyElements(this,t),s},clear:function(){this.options={},this.reset([]),window.localStorage&&localStorage.removeItem(this.LOCAL_STORAGE_KEY)},modifyCell:function(t,e){return t.unset("z"),t.isLink()&&e.link&&t.set(e.link),e.translate&&t.translate(e.translate.dx||20,e.translate.dy||20),t.collection=null,t}}),Ks=dn.extend({className:"select-box",events:{"click .select-box-selection":"onToggle"},options:{options:[],width:void 0,openPolicy:"auto",target:null,keyboardNavigation:!0,selected:void 0,selectBoxOptionsClass:void 0,disabled:!1},init:function(){this.options.target=this.options.target||document.body,Te(this,"onOutsideClick","onOptionSelect"),i(document).on("click.selectBox",this.onOutsideClick),this.$el.data("view",this),void 0===this.options.selected?this.selection=ue(this.options.options).find(function(t){return!0===t.selected})||this.options.options[0]:this.selection=this.options.options[this.options.selected]},render:function(){return this.$el.empty(),this.$selection=null,this.renderSelection(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions();var t=this.options,e={selectBoxView:this,parentClassName:Ce(this,"className")||null,extraClassName:Ce(t,"selectBoxOptionsClass")||null,options:t.options};t.width&&(e.width=t.width),t.theme&&(e.theme=t.theme);var n=this.optionsView=new this.constructor.OptionsView(e);n.render(),this.listenTo(n,"option:select",this.onOptionSelect),this.listenTo(n,"option:hover",this.onOptionHover),this.listenTo(n,"options:mouseout",this.onOptionsMouseOut),this.$options=n.$el,this.$optionsArrow=n.$arrow,this.$target=i(t.target)},onOptionHover:function(t,e){this.trigger("option:hover",t,e)},onOptionsMouseOut:function(t){this.trigger("options:mouseout",t)},onOptionSelect:function(t,e){this.select(t,e)},removeOptions:function(){this.optionsView&&(this.stopListening(this.optionsView),this.optionsView.remove(),this.optionsView=null)},renderSelection:function(t){if(this.$selection||(this.$selection=i("<div/>",{class:"select-box-selection"}),this.$el.append(this.$selection)),this.$selection.empty(),t){var e=this.constructor.OptionsView.prototype.renderOptionContent.call(void 0,t);this.$selection.append(e)}else if(this.options.placeholder){var n=i("<div/>",{class:"select-box-placeholder",html:this.options.placeholder});this.$selection.append(n)}},onToggle:function(t){this.toggle()},onOutsideClick:function(t){!this.el.contains(t.target)&&this.$el.hasClass("opened")&&this.close()},getSelection:function(){return this.selection},getSelectionValue:function(t){return(t=t||this.selection)&&(void 0===t.value?t.content:t.value)},getSelectionIndex:function(){return ue(this.options.options).findIndex((function(t){return t===this.selection}).bind(this))},select:function(t,e){this.selection=this.options.options[t],this.renderSelection(this.selection),this.trigger("option:select",this.selection,t,e),this.close()},selectByValue:function(t,e){for(var n=this.options.options||[],i=0;i<n.length;i++){var r=n[i];if(void 0===r.value&&r.content===t)return this.select(i,e);if(void 0!==r.value&&ae(r.value,t))return this.select(i,e)}},isOpen:function(){return this.$el.hasClass("opened")},toggle:function(){this.isOpen()?this.close():this.open()},position:function(){var t=this.$(".select-box-selection"),e=t.outerHeight(),n=t.offset(),r=n.left,o=n.top,s=this.$options.outerHeight(),a={left:0,top:0};this.options.target!==document.body?((a=this.$target.offset()).width=this.$target.outerWidth(),a.height=this.$target.outerHeight(),a.left-=this.$target.scrollLeft(),a.top-=this.$target.scrollTop()):(a.width=i(window).width(),a.height=i(window).height());var l=r,c="auto",u=this.options.openPolicy;switch("selected"!==u||this.selection||(u="auto"),u){case"above":c=o-s;break;case"coverAbove":c=o-s+e;break;case"below":c=o+e;break;case"coverBelow":c=o;break;case"selected":c=o-this.$options.find(".selected").position().top;break;default:c=o-this.$target.scrollTop()+s>a.top+a.height?o-s+e:o}l-=a.left,c-=a.top,this.$options.css({left:l,top:c})},open:function(){this.isDisabled()||(this.renderOptions(),this.$options.appendTo(this.options.target),this.$options.addClass("rendered"),this.position(),this.$el.addClass("opened"),this.respectWindowBoundaries(),this.alignOptionsArrow())},respectWindowBoundaries:function(){var t=this.calculateElOverflow(this.$options),e={left:0,top:0};this.$options.outerWidth()<=this.$target.innerWidth()&&(t.left&&t.right||(t.left?e.left=t.left:t.right&&(e.left=-t.right))),this.$options.outerHeight()<=this.$target.innerHeight()&&(t.top&&t.bottom||(t.top?e.top=t.top:t.bottom&&(e.top=-t.bottom))),this.$options.css({left:"+="+e.left,top:"+="+e.top})},alignOptionsArrow:function(){var t=this.$el[0].getBoundingClientRect(),e=this.$options[0].getBoundingClientRect(),n=t.left+t.width/2;n-=e.left,n-=this.$optionsArrow.outerWidth()/2,this.$optionsArrow.css({left:n})},close:function(){this.removeOptions(),this.$el.removeClass("opened"),this.trigger("close")},onRemove:function(){this.removeOptions(),i(document).off(".selectBox",this.onOutsideClick)},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.close(),this.$el.addClass("disabled")},onSetTheme:function(t,e){this.$options&&(t&&this.$options.removeClass(this.themeClassNamePrefix+t),this.$options.addClass(this.themeClassNamePrefix+e))},calculateElOverflow:function(t,e){e=e||window,t instanceof i&&(t=t[0]),e instanceof i&&(e=e[0]);var n,r={},o=t.getBoundingClientRect();if(e===window){var s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;n={width:s,height:a,left:0,top:0,right:s,bottom:a}}else n=e.getBoundingClientRect();return["left","top"].forEach(function(t){r[t]=Math.min(0,o[t]-n[t])}),["right","bottom"].forEach(function(t){r[t]=Math.min(0,n[t]-o[t])}),we(r,function(t,e){r[e]=Math.abs(Math.round(t))}),r}},{OptionsView:dn.extend({events:{"mouseover .select-box-option":"onOptionHover","click .select-box-option":"onOptionClick"},className:function(){var t=["select-box-options"],e=this.options.parentClassName;return e&&t.push(e),t.join(" ")},init:function(){Te(this,"onMouseout","onKeydown"),i(document).on({"keydown.selectBoxOptions":this.onKeydown,"mouseleave.selectBoxOptions mouseout.selectBoxOptions":this.onMouseout})},render:function(){var t=this.options.extraClassName;return t&&this.$el.addClass(t),this.options.width&&this.$el.css("width",this.options.width),ue(this.options.options).forEach(function(t,e){var n=this.renderOption(t,e);this.options.selectBoxView.selection===t&&n.addClass("selected hover"),this.$el.append(n)},this),this.$arrow=i("<div/>").addClass("select-box-options-arrow").appendTo(this.$el),this},renderOption:function(t,e){var n=this.renderOptionContent(t);return n.addClass("select-box-option"),n.data("index",e),n},renderOptionContent:function(t){var e=i("<div/>",{class:"select-box-option-content",html:t.content});return t.icon&&e.prepend(i("<img/>",{class:"select-box-option-icon",src:t.icon})),e},select:function(t,e){this.trigger("option:select",t,e)},hover:function(t){var e=this.options.options[t];this.markOptionHover(t),this.trigger("option:hover",e,t)},onOptionClick:function(t){var e=this.getOptionIndex(t.target);this.select(e,{ui:!0})},onOptionHover:function(t){var e=this.getOptionIndex(t.target);this.hover(e)},onMouseout:function(t){this.trigger("options:mouseout",t)},onKeydown:function(t){var e=this.options.selectBoxView;if(e.options.keyboardNavigation&&e.isOpen()){var n;switch(t.which){case 39:case 40:n=1;break;case 38:case 37:n=-1;break;case 13:var i=this.getOptionHoverIndex();return void(0<=i&&this.select(i));case 27:return e.close();default:return}t.preventDefault();var r=this.getOptionHoverIndex()+n,o=this.options.options;r<0&&(r=o.length-1),r>=o.length&&(r=0),this.hover(r)}},onRemove:function(){i(document).off(".selectBoxOptions")},markOptionHover:function(t){this.$el.find(".hover").removeClass("hover"),i(this.$el.find(".select-box-option")[t]).addClass("hover")},getOptionHoverIndex:function(){return this.$el.find(".select-box-option.hover").index()},getOptionIndex:function(t){return i(t).closest(".select-box-option").data("index")}})}),Bs=Ks.extend({className:"select-box color-palette",position:function(){var t=this.$(".select-box-selection"),e=t.outerHeight(),n=t.offset(),r=n.left,o=n.top+e;if(this.options.target!==document.body){this.$target=this.$target||i(this.options.target);var s=this.$target.offset();r-=s.left-this.$target.scrollLeft(),o-=s.top-this.$target.scrollTop()}this.$options.css({left:r,top:o})}},{OptionsView:Ks.OptionsView.extend({renderOptionContent:function(t){var e=i("<div/>",{class:"select-box-option-content"});return e.css("background-color",t.content),t.icon&&e.prepend(i("<img/>",{class:"select-box-option-icon",src:t.icon})),e}})}),zs=dn.extend({className:"context-toolbar",eventNamespace:"context-toolbar",events:{"click .tool":"onToolPointerdown"},options:{padding:20,autoClose:!0,vertical:!1},documentEvents:{mousedown:"onDocumentPointerdown",touchstart:"onDocumentPointerdown"},init:function(){Te(this,"onDocumentPointerdown")},render:function(){var t=this.options,e=this.constructor;return e.opened&&e.close(),t.autoClose&&setTimeout(this.delegateAutoCloseEvents.bind(this),0),t.type&&this.$el.attr("data-type",t.type),this.$el.toggleClass("joint-vertical",!!t.vertical),this.getRoot().append(this.$el),this.renderContent(),this.position(),e.opened=this},delegateAutoCloseEvents:function(){this.delegateDocumentEvents(),document.addEventListener("mousedown",this.onDocumentPointerdown,!0),document.addEventListener("touchstart",this.onDocumentPointerdown,!0)},undelegateAutoCloseEvents:function(){this.undelegateDocumentEvents(),document.removeEventListener("mousedown",this.onDocumentPointerdown,!0),document.removeEventListener("touchstart",this.onDocumentPointerdown,!0)},renderContent:function(){var t=i("<div/>",{class:"tools"});this.options.tools&&ue(this.options.tools).forEach(function(e){var n;n=e.icon?i("<img/>",{src:e.icon}):e.content;var r=i("<button/>",{class:"tool",html:n,"data-action":e.action});e.attrs&&r.attr(e.attrs),t.append(r)}),this.$el.append(t)},getRoot:function(){return i(this.options.root||document.documentElement)},position:function(){var t=wt(this.options.target),e=wt(this.getRoot()),n=this.$el.outerWidth(),i=t.x+t.width/2-n/2,r=t.y+t.height+this.options.padding;i-=e.x,r-=e.y,this.$el.css({left:i,top:r})},onRemove:function(){this.undelegateAutoCloseEvents(),this.constructor.opened=void 0},onToolPointerdown:function(t){var e=i(t.currentTarget).attr("data-action");e&&this.trigger("action:"+e,t)},onDocumentPointerdown:function(t){var e=this.options.target,n=t.target;this.el.contains(n)||e.contains(n)||e===n||(this.constructor.close(),this.remove())}},{opened:void 0,close:function(){this.opened&&(this.opened.remove(),this.opened=void 0)},update:function(){this.opened&&this.opened.position()}}),js=dn.extend({className:"dialog",events:{"click .bg":"action","click .btn-close":"action","click .controls button":"action","mousedown .titlebar":"onDragStart","touchstart .titlebar":"onDragStart"},options:{draggable:!1,closeButtonContent:"&times;",closeButton:!0,inlined:!1,modal:!0,width:0,title:"",buttons:null,type:"",content:null},init:function(){Te(this,"onDrag","onDragEnd"),this.buttons=this.options.buttons},render:function(){var t=i("<div/>",{class:"bg","data-action":"close"}),e=i("<div/>",{class:"fg"}),n=i("<div/>",{class:"titlebar"}),r=i("<div/>",{class:"body"}),o=i("<button/>",{class:"btn-close","data-action":"close",html:this.options.closeButtonContent}),s=i("<div/>",{class:"controls"});if(this.$el.toggleClass("draggable",!!this.options.draggable),this.options.type&&this.$el.attr("data-type",this.options.type),this.options.inlined&&this.$el.addClass("inlined"),this.options.modal&&this.$el.addClass("modal"),this.options.width&&e.width(this.options.width),this.options.title?n.append(this.options.title):n.addClass("empty"),this.options.content&&r.append(this.options.content),this.buttons){var a=[],l=[],c=[];this.buttons.forEach(function(t){var e=i("<button/>",{class:"control-button",html:t.content,"data-action":t.action});t.position?"left"===t.position?(e.addClass(t.position),c.push(e)):"center"===t.position?(e.addClass(t.position),l.push(e)):(e.addClass(t.position),a.push(e)):a.push(e)}),a.reverse().forEach(function(t){s.append(t)}),c.forEach(function(t){s.append(t)}),l.forEach(function(t){s.append(t)})}return e.append(n,r,s),this.options.closeButton&&e.append(o),this.$el.empty().append(t,e),this},open:function(t){return this.delegateEvents(),this.on("action:close",this.close,this),i(document.body).on({"mousemove.dialog touchmove.dialog":this.onDrag,"mouseup.dialog touchend.dialog":this.onDragEnd}),i(t||document.body).append(this.render().el),this.$el.addClass("rendered"),this},close:function(){return this.remove(),this},onRemove:function(){i(document.body).off(".dialog",this.onDrag).off(".dialog",this.onDragStart)},action:function(t){var e=i(t.target).closest("[data-action]").attr("data-action");e&&this.trigger("action:"+e)},onDragStart:function(t){this.options.draggable&&(t=vt(t),this._dx=t.clientX,this._dy=t.clientY,this._dragging=!0)},onDrag:function(t){if(this._dragging){t=vt(t);var e=this.$(".fg"),n=e.offset();e.css({top:n.top+(t.clientY-this._dy),left:n.left+(t.clientX-this._dx),margin:0}),this._dx=t.clientX,this._dy=t.clientY}},onDragEnd:function(){this._dragging=!1}}),Gs=js.extend({className:js.prototype.className+" flash-message",options:At({},js.prototype.options,{closeButton:!0,modal:!1,cascade:!0,closeAnimation:{delay:2e3,duration:200,easing:"swing",properties:{opacity:0}},openAnimation:{duration:200,easing:"swing",properties:{opacity:1}}}),init:function(){Te(this,"startCloseAnimation"),js.prototype.init.apply(this,arguments),this.on("close:animation:complete",this.close,this)},open:function(){js.prototype.open.apply(this,arguments);var t=this.$(".fg");return this._foregroundHeight=t.height(),this.addToCascade(),t.css("height",0),this.startOpenAnimation(),this.options.closeAnimation&&this.options.closeAnimation.delay&&setTimeout(this.startCloseAnimation,this.options.closeAnimation.delay),this},close:function(){return js.prototype.close.apply(this,arguments),this.removeFromCascade(),this},addToCascade:function(){if(this.options.cascade){var t=this.constructor.top;this.$(".fg").css("top",t),this.constructor.top+=this._foregroundHeight+this.constructor.padding}this.constructor.opened.push(this)},removeFromCascade:function(){if(this.options.cascade){for(var t=this.constructor.opened,e=!1,n=0;n<t.length;n++){var i=t[n];if(i.options.cascade&&e){var r=parseInt(i.$(".fg").css("top"),10);i.$(".fg").css("top",r-this._foregroundHeight-this.constructor.padding)}i===this&&(e=!0)}e&&(this.constructor.top-=this._foregroundHeight+this.constructor.padding)}this.constructor.opened=ge(this.constructor.opened,this)},startCloseAnimation:function(){this.$(".fg").animate(this.options.closeAnimation.properties,Jt({complete:(function(){this.trigger("close:animation:complete")}).bind(this)},this.options.closeAnimation))},startOpenAnimation:function(){this.$(".fg").animate(Jt({},this.options.openAnimation.properties,{height:this._foregroundHeight}),Jt({complete:(function(){this.trigger("open:animation:complete")}).bind(this)},this.options.openAnimation))}},{top:20,padding:15,opened:[],open:function(t,e,n){return new Gs(Jt({title:e,type:"info",content:t},n=n||{})).open(n.target)},close:function(){ee(this.opened,"close")}}),Fs=dn.extend({className:"free-transform",events:{"mousedown .resize":"startResizing","mousedown .rotate":"startRotating","touchstart .resize":"startResizing","touchstart .rotate":"startRotating"},DIRECTIONS:["nw","n","ne","e","se","s","sw","w"],POSITIONS:["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],options:{cellView:void 0,rotateAngleGrid:15,preserveAspectRatio:!1,minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,allowOrthogonalResize:!0,allowRotation:!0,clearAll:!0,clearOnBlankPointerdown:!0},init:function(){var t=this.options;t.cellView?Qt(t,{cell:t.cellView.model,paper:t.cellView.paper,graph:t.cellView.paper.model}):t.paper&&t.cell&&Qt(t,{cellView:t.cell.findView(t.paper),graph:t.paper.model}),Te(this,"update","remove","pointerup","pointermove");var e=t.paper,n=t.graph;t.clearAll&&this.constructor.clear(e),i(document.body).on("mousemove touchmove",this.pointermove),i(document).on("mouseup touchend",this.pointerup),this.listenTo(n,"all",this.update),this.listenTo(e,"scale translate",this.update),this.listenTo(n,"reset",this.remove),this.listenTo(t.cell,"remove",this.remove),t.clearOnBlankPointerdown&&this.listenTo(e,"blank:pointerdown",this.remove),e.$el.append(this.el),this.constructor.registerInstanceToPaper(this,e)},renderHandles:function(){var t=i("<div/>").prop("draggable",!1),e=t.clone().addClass("rotate"),n=this.POSITIONS.map(function(e){return t.clone().addClass("resize").attr("data-position",e)});this.$el.empty().append(n,e)},render:function(){this.renderHandles(),this.$el.attr("data-type",this.options.cell.get("type")),this.$el.toggleClass("no-orthogonal-resize",this.options.preserveAspectRatio||!this.options.allowOrthogonalResize),this.$el.toggleClass("no-rotation",!this.options.allowRotation),this.update()},update:function(){var t=this.options.paper.matrix(),e=this.options.cell.getBBox();e.x*=t.a,e.x+=t.e,e.y*=t.d,e.y+=t.f,e.width*=t.a,e.height*=t.d;var n=j(this.options.cell.get("angle")||0),r="rotate("+n+"deg)";this.$el.css({width:e.width+4,height:e.height+4,left:e.x-3,top:e.y-3,transform:r,"-webkit-transform":r,"-ms-transform":r});var o=Math.floor(n*(this.DIRECTIONS.length/360));if(o!=this._previousDirectionsShift){var s=this.DIRECTIONS.slice(o).concat(this.DIRECTIONS.slice(0,o));this.$(".resize").removeClass(this.DIRECTIONS.join(" ")).each(function(t,e){i(e).addClass(s[t])}),this._previousDirectionsShift=o}},calculateTrueDirection:function(t){var e=this.options.cell,n=j(e.get("angle")),i=this.POSITIONS.indexOf(t);return i+=Math.floor(n*(this.POSITIONS.length/360)),i%=this.POSITIONS.length,this.POSITIONS[i]},startResizing:function(t){t.stopPropagation(),this.options.graph.startBatch("free-transform",{freeTransform:this.cid});var e=i(t.target).data("position"),n=this.calculateTrueDirection(e),r=0,o=0;e.split("-").forEach(function(t){r={left:-1,right:1}[t]||r,o={top:-1,bottom:1}[t]||o});var s=this.toValidResizeDirection(e),a={"top-right":"bottomLeft","top-left":"corner","bottom-left":"topRight","bottom-right":"origin"}[s];this._initial={angle:j(this.options.cell.get("angle")||0),resizeX:r,resizeY:o,selector:a,direction:s,relativeDirection:e,trueDirection:n},this._action="resize",this.startOp(t.target)},toValidResizeDirection:function(t){return{top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[t]||t},startRotating:function(t){t.stopPropagation(),this.options.graph.startBatch("free-transform",{freeTransform:this.cid});var e=this.options.cell.getBBox().center(),n=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY});this._initial={centerRotation:e,modelAngle:j(this.options.cell.get("angle")||0),startAngle:W(n).theta(e)},this._action="rotate",this.startOp(t.target)},pointermove:function(t){if(this._action){t=vt(t);var e=this.options,n=e.paper.snapToGrid({x:t.clientX,y:t.clientY}),i=e.paper.options.gridSize,r=e.cell,o=this._initial;switch(this._action){case"resize":var s=r.getBBox(),a=W(n).rotate(s.center(),o.angle).difference(s[o.selector]()),l=o.resizeX?a.x*o.resizeX:s.width,c=o.resizeY?a.y*o.resizeY:s.height;if(l=G(l,i),c=G(c,i),l=Math.max(l,e.minWidth||i),c=Math.max(c,e.minHeight||i),l=Math.min(l,e.maxWidth),c=Math.min(c,e.maxHeight),e.preserveAspectRatio){var u=s.width*c/s.height,h=s.height*l/s.width;l<u?c=h:l=u}s.width==l&&s.height==c||r.resize(l,c,{freeTransform:this.cid,direction:o.direction,relativeDirection:o.relativeDirection,trueDirection:o.trueDirection,ui:!0,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,preserveAspectRatio:e.preserveAspectRatio});break;case"rotate":var d=o.startAngle-W(n).theta(o.centerRotation);r.rotate(G(o.modelAngle+d,e.rotateAngleGrid),!0)}}},pointerup:function(t){this._action&&(this.stopOp(),this.options.graph.stopBatch("free-transform",{freeTransform:this.cid}),this._action=null,this._initial=null)},onRemove:function(){i(document.body).off("mousemove touchmove",this.pointermove),i(document).off("mouseup touchend",this.pointerup),Fs.unregisterInstanceFromPaper(this,this.options.paper)},startOp:function(t){t&&(i(t).addClass("in-operation"),this._elementOp=t),this.$el.addClass("in-operation"),this.options.paper.undelegateEvents()},stopOp:function(){this._elementOp&&(i(this._elementOp).removeClass("in-operation"),this._elementOp=null),this.$el.removeClass("in-operation"),this.options.paper.delegateEvents()}},{instancesByPaper:{},clear:function(t){t.trigger("freetransform:create"),this.removeInstancesForPaper(t)},removeInstancesForPaper:function(t){ee(this.getInstancesForPaper(t),"remove")},getInstancesForPaper:function(t){return this.instancesByPaper[t.cid]||{}},registerInstanceToPaper:function(t,e){this.instancesByPaper[e.cid]||(this.instancesByPaper[e.cid]={}),this.instancesByPaper[e.cid][t.cid]=t},unregisterInstanceFromPaper:function(t,e){this.instancesByPaper[e.cid]&&(this.instancesByPaper[e.cid][t.cid]=null)}});function Vs(){this.options={handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElement"},icon:null},{name:"resize",position:"se",events:{pointerdown:"startResizing",pointermove:"doResize",pointerup:"stopBatch"},icon:null},{name:"clone",position:"n",events:{pointerdown:"startCloning",pointermove:"doClone",pointerup:"stopCloning"},icon:null},{name:"link",position:"e",events:{pointerdown:"startLinking",pointermove:"doLink",pointerup:"stopLinking"},icon:null},{name:"fork",position:"ne",events:{pointerdown:"startForking",pointermove:"doFork",pointerup:"stopForking"},icon:null},{name:"unlink",position:"w",events:{pointerdown:"unlinkElement"},icon:null},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"},icon:null}],bbox:function(t,e){return t.getBBox({useModelGeometry:e.options.useModelGeometry})},typeCssName:"type-element",tinyThreshold:40,smallThreshold:80,boxContent:function(t,e){var n=Wt("x: <%= x %>, y: <%= y %>, width: <%= width %>, height: <%= height %>, angle: <%= angle %>"),i=t.model,r=i.getBBox();return n({x:Math.floor(r.x),y:Math.floor(r.y),width:Math.floor(r.width),height:Math.floor(r.height),angle:Math.floor(i.get("angle")||0)})},magnet:function(t){return t.el},loopLinkPreferredSide:"top",loopLinkWidth:40,rotateAngleGrid:15,rotateEmbeds:!1,linkAttributes:{},smoothLinks:void 0}}function Hs(){Te(this,"handleKey"),this.parser=new $s,this.enable()}ws.prototype.directionSwap=function(){var t=this.options.cellView.model;t.set({source:t.get("target"),target:t.get("source")},{halo:this.cid})},Vs.prototype.startLinking=function(t,e,n){this.startBatch();var i=this.options,r=i.paper,o=i.graph,s=this.createLinkConnectedToSource();s.set({target:{x:e,y:n}}).addTo(o,{validation:!1,halo:this.cid,async:!1}),r.undelegateEvents(),(this._linkView=s.findView(r)).startArrowheadMove("target",{whenNotAllowed:"remove"})},Vs.prototype.startForking=function(t,e,n){var i=this.options,r=i.paper,o=i.graph;this.startBatch();var s=i.clone(i.cellView.model,{fork:!0});if(!(s instanceof Ze))throw new Error('ui.Halo: option "clone" has to return a cell.');this.centerElementAtCursor(s,e,n),s.addTo(o,{halo:this.cid,async:!1});var a=this.createLinkConnectedToSource(),l=s.findView(r),c=this.getElementMagnet(l,"target"),u=this.getLinkEnd(l,c);a.set("target",u).addTo(o,{halo:this.cid,async:!1}),l.pointerdown(t,e,n),this.eventData(t,{cloneView:l})},Vs.prototype.getElementMagnet=function(t,e){var n=this.options.magnet;if(le(n)){var i=n.call(this,t,e);if(i instanceof SVGElement)return i}throw new Error("ui.Halo: magnet() has to return an SVGElement.")},Vs.prototype.getLinkEnd=function(t,e){var n={id:t.model.id};if(e!==t.el){var i=e.getAttribute("port");i?n.port=i:n.selector=t.getSelector(e)}return n},Vs.prototype.createLinkConnectedToSource=function(){var t=this.options,e=t.paper,n=t.cellView,i=this.getElementMagnet(n,"source"),r=this.getLinkEnd(n,i),o=e.getDefaultLink(n,i).set("source",r);return o.attr(t.linkAttributes),Ot(t.smoothLinks)&&o.set("smooth",t.smoothLinks),o},Vs.prototype.startResizing=function(t){this.startBatch(),this._flip=[1,0,0,1,1,0,0,1][Math.floor(j(this.options.cellView.model.get("angle"))/45)]},Vs.prototype.startRotating=function(t,e,n){this.startBatch();var i=this.options.cellView.model,r=i.getBBox().center(),o=[i];this.options.rotateEmbeds&&i.getEmbeddedCells({deep:!0}).reduce(function(t,e){return e.isElement()&&t.push(e),t},o),this.eventData(t,{center:r,elements:o,rotationStartAngles:o.map(function(t){return t.angle()}),clientStartAngle:new L(e,n).theta(r)})},Vs.prototype.doResize=function(t,e,n,i,r){var o=this.options.cellView.model.get("size"),s=Math.max(o.width+(this._flip?i:r),1),a=Math.max(o.height+(this._flip?r:i),1);this.options.cellView.model.resize(s,a,{absolute:!0})},Vs.prototype.doRotate=function(t,e,n){var i=this.eventData(t),r=i.clientStartAngle-new L(e,n).theta(i.center);i.elements.forEach(function(t,e){var n=i.rotationStartAngles[e],o=G(n+r,this.options.rotateAngleGrid);t.rotate(o,!0,i.center,{halo:this.cid})},this)},Vs.prototype.doClone=function(t,e,n){var i=this.eventData(t).cloneView;i&&i.pointermove(t,e,n)},Vs.prototype.startCloning=function(t,e,n){var i=this.options;this.startBatch();var r=i.clone(i.cellView.model,{clone:!0});if(!(r instanceof Ze))throw new Error('ui.Halo: option "clone" has to return a cell.');this.centerElementAtCursor(r,e,n),r.addTo(i.graph,{halo:this.cid,async:!1});var o=r.findView(i.paper);o.pointerdown(t,e,n),this.eventData(t,{cloneView:o})},Vs.prototype.centerElementAtCursor=function(t,e,n){var i=t.getBBox().center(),r=e-i.x,o=n-i.y;t.translate(r,o)},Vs.prototype.doFork=function(t,e,n){var i=this.eventData(t).cloneView;i&&i.pointermove(t,e,n)},Vs.prototype.doLink=function(t,e,n){this._linkView&&this._linkView.pointermove(t,e,n)},Vs.prototype.stopLinking=function(t,e,n){var i=this._linkView;if(i){i.pointerup(t,e,n);var r=i.model;r.hasLoop()&&this.makeLoopLink(r),this.stopBatch(),this.triggerAction("link","add",r),this._linkView=null}this.options.paper.delegateEvents()},Vs.prototype.stopForking=function(t,e,n){var i=this.eventData(t).cloneView;i&&i.pointerup(t,e,n),this.stopBatch()},Vs.prototype.stopCloning=function(t,e,n){var i=this.eventData(t).cloneView;i&&i.pointerup(t,e,n),this.stopBatch()},Vs.prototype.unlinkElement=function(t){this.startBatch(),this.options.graph.removeLinks(this.options.cellView.model),this.stopBatch()},Vs.prototype.makeLoopLink=function(t){var e,n,i=this.options.loopLinkWidth,r=this.options.paper.options,o=Y({x:0,y:0,width:r.width,height:r.height}),s=this.options.paper.paperToLocalRect(this.options.cellView.getBBox());ie([this.options.loopLinkPreferredSide,"top","bottom","left","right"]).find(function(t){var r,a=0,l=0;switch(t){case"top":r=W(s.x+s.width/2,s.y-i),a=i/2;break;case"bottom":r=W(s.x+s.width/2,s.y+s.height+i),a=i/2;break;case"left":r=W(s.x-i,s.y+s.height/2),l=i/2;break;case"right":r=W(s.x+s.width+i,s.y+s.height/2),l=i/2}return e=W(r).offset(-a,-l),n=W(r).offset(a,l),o.containsPoint(e)&&o.containsPoint(n)},this)&&t.set("vertices",[e,n])};var Us=dn.extend({PIE_INNER_RADIUS:20,PIE_OUTER_RADIUS:50,className:"halo",events:{"mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown","mousedown .pie-toggle":"onPieTogglePointerDown","touchstart .pie-toggle":"onPieTogglePointerDown"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup"},options:{clearAll:!0,clearOnBlankPointerdown:!0,useModelGeometry:!1,clone:function(t,e){return t.clone().unset("z")},type:"surrounding",pieSliceAngle:45,pieStartAngleOffset:0,pieIconSize:14,pieToggles:[{name:"default",position:"e"}]},init:function(){var t=this.options,e=t.cellView,n=e.model,i=n.isLink()?new ws:new Vs;Jt(this,Ie(i,"options"));var r=e.paper,o=r.model;Qt(t,i.options,{paper:r,graph:o}),Te(this,"render","update"),t.clearAll&&this.constructor.clear(r),this.listenTo(o,"reset",this.remove),this.listenTo(n,"remove",this.remove),this.listenTo(r,"halo:create",this.remove),t.clearOnBlankPointerdown&&this.listenTo(r,"blank:pointerdown",this.remove),this.listenTo(o,"all",this.update),this.listenTo(r,"scale translate",this.update),this.handles=[],ue(t.handles).forEach(this.addHandle,this)},render:function(){var t=this.options;switch(this.$el.empty(),this.$handles=i("<div/>").addClass("handles").appendTo(this.el),this.$box=i("<label/>").addClass("box").appendTo(this.el),this.$pieToggles={},this.$el.addClass(t.type),this.$el.addClass(this.cellTypeCssClass()),this.$el.attr("data-type",t.cellView.model.get("type")),this.$handles.append(ue(this.handles).map(this.renderHandle,this)),t.type){case"toolbar":case"surrounding":this.hasHandle("fork")&&this.toggleFork();break;case"pie":ue(this.options.pieToggles).forEach(function(t){var e=i("<div/>");e.addClass("pie-toggle "+(t.position||"e")),e.attr("data-name",t.name),_t(e,t.attrs),e.appendTo(this.el),this.$pieToggles[t.name]=e},this);break;default:throw new Error("ui.Halo: unknown type")}return this.update(),this.$el.addClass("animate").appendTo(t.paper.el),this.setPieIcons(),this},setPieIcons:function(){"pie"===this.options.type&&this.$el.find(".handle").each((function(t,e){var n,r=i(e),o=r.attr("data-action"),s=this.getHandle(o);if(!s||!s.icon){var a=window.getComputedStyle(e,":before").getPropertyValue("content");a&&"none"!==a&&0<(n=r.find(".slice-text-icon")).length&&Mt(n[0]).text(a.replace(/['"]/g,""));var l=r.css("background-image");if(l){var c=l.match(/url\(['"]?([^'"]+)['"]?\)/);if(c){var u=c[1];0<(n=r.find(".slice-img-icon")).length&&Mt(n[0]).attr("xlink:href",u)}}}}).bind(this))},update:function(){if(this.isRendered()){this.updateBoxContent();var t=this.getBBox();this.$el.toggleClass("tiny",t.width<this.options.tinyThreshold&&t.height<this.options.tinyThreshold),this.$el.toggleClass("small",!this.$el.hasClass("tiny")&&t.width<this.options.smallThreshold&&t.height<this.options.smallThreshold),this.$el.css({width:t.width,height:t.height,left:t.x,top:t.y}),this.hasHandle("unlink")&&this.toggleUnlink()}},getBBox:function(){var t=this.options.cellView,e=this.options.bbox,n=le(e)?e(t,this):e;return n=Qt({},n,{x:0,y:0,width:1,height:1}),Y(n)},cellTypeCssClass:function(){return this.options.typeCssName},updateBoxContent:function(){var t=this.options.boxContent,e=this.options.cellView;if(le(t)){var n=t.call(this,e,this.$box[0]);n&&this.$box.html(n)}else t?this.$box.html(t):this.$box.remove()},extendHandles:function(t){we(t,(function(t){var e=this.getHandle(t.name);e&&Jt(e,t)}).bind(this))},addHandles:function(t){return ue(t).forEach(this.addHandle,this),this},addHandle:function(t){return this.getHandle(t.name)||(this.handles.push(t),we(t.events,(function(e,n){Ae(e)?this.on("action:"+t.name+":"+n,this[e],this):this.on("action:"+t.name+":"+n,e)}).bind(this)),this.$handles&&this.renderHandle(t).appendTo(this.$handles)),this},renderHandle:function(t){var e=this.getHandleIdx(t.name),n=i("<div/>").addClass("handle").addClass(t.name).attr("data-action",t.name).prop("draggable",!1);switch(this.options.type){case"toolbar":case"surrounding":n.addClass(t.position),t.content&&n.html(t.content);break;case"pie":var r=this.PIE_OUTER_RADIUS,o=this.PIE_INNER_RADIUS,s=(r+o)/2,a=W(r,r),l=V(this.options.pieSliceAngle),c=e*l+V(this.options.pieStartAngleOffset),u=c+l,h=Mt.createSlicePathData(o,r,c,u),d=Mt("svg").addClass("slice-svg"),f=Mt("path").attr("d",h).translate(r,r).addClass("slice"),p=W.fromPolar(s,-c-l/2,a),g=this.options.pieIconSize,m=Mt("image").attr(p).addClass("slice-img-icon");p.y=p.y+g-2;var v=Mt("text",{"font-size":g}).attr(p).addClass("slice-text-icon");m.attr({width:g,height:g}),m.translate(-g/2,-g/2),v.translate(-g/2,-g/2),d.append([f,m,v]),n.append(d.node)}return t.icon&&this.setHandleIcon(n,t.icon),_t(n,t.attrs),n},setHandleIcon:function(t,e){switch(this.options.type){case"pie":var n=t.find(".slice-img-icon");Mt(n[0]).attr("xlink:href",e);break;case"toolbar":case"surrounding":t.css("background-image","url("+e+")")}},removeHandles:function(){for(;this.handles.length;)this.removeHandle(this.handles[0].name);return this},removeHandle:function(t){var e=this.getHandleIdx(t),n=this.handles[e];return n&&(we(n.events,(function(e,n){this.off("action:"+t+":"+n)}).bind(this)),this.$(".handle."+t).remove(),this.handles.splice(e,1)),this},changeHandle:function(t,e){var n=this.getHandle(t);return n&&(this.removeHandle(t),this.addHandle(At({name:t},n,e))),this},hasHandle:function(t){return-1!==this.getHandleIdx(t)},getHandleIdx:function(t){return ue(this.handles).findIndex(function(e){return e.name===t})},getHandle:function(t){return ue(this.handles).find(function(e){return e.name===t})},toggleHandle:function(t,e){var n=this.getHandle(t);if(n){var i=this.$(".handle."+t);void 0===e&&(e=!i.hasClass("selected")),i.toggleClass("selected",e);var r=e?n.iconSelected:n.icon;r&&this.setHandleIcon(i,r)}return this},selectHandle:function(t){return this.toggleHandle(t,!0)},deselectHandle:function(t){return this.toggleHandle(t,!1)},deselectAllHandles:function(){return ue(this.handles).forEach(function(t){this.deselectHandle(t.name)},this),this},onHandlePointerDown:function(t){var e=this._action=i(t.target).closest(".handle").attr("data-action");if(e){t.preventDefault(),t.stopPropagation(),t=vt(t);var n=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY}),r=n.x,o=n.y;this._localX=r,this._localY=o,"mousedown"===(this._evt=t).type&&2===t.button?this.triggerAction(e,"contextmenu",t,r,o):(this.triggerAction(e,"pointerdown",t,r,o),this.delegateDocumentEvents(null,t.data))}},onPieTogglePointerDown:function(t){t.stopPropagation();var e=i(t.target).closest(".pie-toggle").attr("data-name");this.isOpen(e)||this.isOpen()&&this.toggleState(),this.toggleState(e)},triggerAction:function(t,e,n){var i=Array.prototype.slice.call(arguments,2);i.unshift("action:"+t+":"+e),this.trigger.apply(this,i)},stopBatch:function(){var t=this.options.graph;t.hasActiveBatch("halo")&&t.stopBatch("halo",{halo:this.cid})},startBatch:function(){this.options.graph.startBatch("halo",{halo:this.cid})},pointermove:function(t){if(this._action){t.preventDefault(),t.stopPropagation(),t=vt(t);var e=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY}),n=e.x-this._localX,i=e.y-this._localY;this._localX=e.x,this._localY=e.y,this._evt=t,this.triggerAction(this._action,"pointermove",t,e.x,e.y,n,i)}},pointerup:function(t){var e=this._action;if(e){this._action=null,this._evt=null;var n=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY});this.triggerAction(e,"pointerup",t,n.x,n.y),this.undelegateDocumentEvents()}},onRemove:function(){this._action&&this._evt&&this.pointerup(this._evt),this.stopBatch()},onSetTheme:function(){this.setPieIcons()},removeElement:function(){this.options.cellView.model.remove()},toggleUnlink:function(){var t=0<this.options.graph.getConnectedLinks(this.options.cellView.model).length;this.$handles.children(".unlink").toggleClass("hidden",!t)},toggleFork:function(){var t=this.options.cellView.model.clone(),e=this.options.paper.createViewForModel(t),n=this.options.paper.options.validateConnection(this.options.cellView,null,e,null,"target");this.$handles.children(".fork").toggleClass("hidden",!n),e.remove(),t=null},toggleState:function(t){if(this.isRendered()){var e=this.$el;if(we(this.$pieToggles,function(t){t.removeClass("open")}),this.isOpen())this.trigger("state:close",t),e.removeClass("open");else{if(this.trigger("state:open",t),t){var n=ue(this.options.pieToggles).find(function(e){return e.name===t});n&&e.attr({"data-pie-toggle-position":n.position,"data-pie-toggle-name":n.name}),this.$pieToggles[t].addClass("open")}e.addClass("open")}}},isOpen:function(t){return!!this.isRendered()&&(t?this.$pieToggles[t].hasClass("open"):this.$el.hasClass("open"))},isRendered:function(){return void 0!==this.$box}},{clear:function(t){t.trigger("halo:create")}}),Zs=dn.extend({className:"select-button-group",events:{"click .select-button-group-button":"onSelect","mouseover .select-button-group-button":"onOptionHover",mouseleave:"onMouseOut","mousedown .select-button-group-button":"pointerdown","touchstart .select-button-group-button":"pointerdown","mouseup .select-button-group-button":"pointerup","touchend .select-button-group-button":"pointerup"},options:{options:[],disabled:!1,multi:!1,selected:void 0,singleDeselect:!1,noSelectionValue:void 0,width:void 0,buttonWidth:void 0,buttonHeight:void 0,iconWidth:void 0,iconHeight:void 0},init:function(){Te(this,"onSelect","pointerup"),this.$el.data("view",this);var t=this.options.options,e=this.options.multi,n=this.options.selected;if(void 0===n){var i=ue(t).filter(function(t){return t&&!0===t.selected});this.selection=e?i:i[0]}else this.selection=e?Array.isArray(n)?t.filter(function(t,e){return n.includes(e)}):[t[n]]:t[n]},render:function(){return this.renderOptions(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions(),ue(this.options.options).forEach(function(t,e){var n=this.options.multi?this.selection.includes(t):this.selection===t,i=this.renderOption(t,e,n);this.$el.append(i),n&&i.addClass("selected")},this)},removeOptions:function(){this.$el.empty()},renderOption:function(t,e,n){var i=this.renderOptionContent(t,n);i.data("index",e);var r=t.buttonWidth||this.options.buttonWidth;r&&i.css("width",r);var o=t.buttonHeight||this.options.buttonHeight;return o&&i.css("height",o),i},renderOptionContent:function(t,e){var n=i("<div/>",{class:"select-button-group-button",html:t.content});if(t.icon||e&&t.iconSelected){var r=i("<img/>",{class:"select-button-group-button-icon",src:e&&t.iconSelected?t.iconSelected:t.icon}),o=t.iconWidth||this.options.iconWidth;o&&r.css("width",o);var s=t.iconHeight||this.options.iconHeight;s&&r.css("height",s),n.prepend(r)}return _t(n,t.attrs),n},getOptionIndex:function(t){return i(t).closest(".select-button-group-button").data("index")},onSelect:function(t){if(!this.isDisabled()){var e=this.getOptionIndex(t.target);this.select(e,{ui:!0})}},onOptionHover:function(t){if(!this.isDisabled()){var e=this.getOptionIndex(t.target);this.trigger("option:hover",this.options.options[e],e)}},onMouseOut:function(t){this.isDisabled()||this.trigger("mouseout",t)},getSelection:function(){return this.selection},getSelectionValue:function(t){t=t||this.selection;var e=this.options.noSelectionValue;if(this.options.multi){var n=ue(t);return 0===n.length?void 0!==e?e:[]:n.map(function(t){var e=t.value;return void 0!==e?e:t.content})}if(!t)return void 0!==e?e:void 0;var i=t.value;return void 0!==i?i:t.content},select:function(t,e){var n=i(this.$(".select-button-group-button")[t]),r=this.options.options[t],o=null,s=null,a=null,l=null;if(this.options.multi)n.toggleClass("selected"),n.hasClass("selected")?(a=t,l=r,-1===this.selection.indexOf(r)&&this.selection.push(r),r.iconSelected&&n.find(".select-button-group-button-icon").attr("src",r.iconSelected)):(o=t,s=r,this.selection=ge(this.selection,r),r.iconSelected&&n.find(".select-button-group-button-icon").attr("src",r.icon));else{var c=this.$(".selected"),u=c.index(),h=this.options.options[u];n.toggleClass("selected"),n.hasClass("selected")?(h&&(o=u,s=h,c.removeClass("selected"),h.iconSelected&&c.find(".select-button-group-button-icon").attr("src",h.icon)),a=t,l=r,(this.selection=r).iconSelected&&n.find(".select-button-group-button-icon").attr("src",r.iconSelected)):this.options.singleDeselect?(o=t,s=r,this.selection=void 0,r.iconSelected&&n.find(".select-button-group-button-icon").attr("src",r.icon)):n.addClass("selected")}var d=Jt({},e);d.deselectedIndex=o,d.deselectedOption=s,d.selectedIndex=a,d.selectedOption=l,this.trigger("option:select",this.selection,t,d)},selectByValue:function(t,e){Array.isArray(t)||(t=[t]);for(var n=this.options.options||[],i=0;i<n.length;i++){var r=n[i];(void 0===r.value&&t.includes(r.content)||void 0!==r.value&&t.find(function(t){return ae(t,r.value)}))&&this.select(i,e)}},deselect:function(){this.$(".selected").removeClass("selected"),this.options.multi?this.selection=[]:this.selection=void 0},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},pointerdown:function(t){var e=this.getOptionIndex(t.target);i(this.$(".select-button-group-button")[e]).addClass("is-in-action"),i(document).on("mouseup.select-button-group touchend.select-button-group",this.pointerup)},pointerup:function(){this.$(".is-in-action").removeClass("is-in-action"),i(document).off("mouseup.select-button-group touchend.select-button-group")}}),Ws=dn.extend({className:"inspector",options:{cellView:void 0,cell:void 0,live:!0,validateInput:function(t,e,n,i){return!t.validity||t.validity.valid},renderFieldContent:void 0,renderLabel:void 0,operators:{},multiOpenGroups:!0,stateKey:function(t){return t.id}},events:{"change [data-attribute]:not([data-custom-field])":"onChangeInput","click .group-label":"onGroupLabelClick","click .btn-list-add":"addListItem","click .btn-list-del":"deleteListItem","mousedown .field":"pointerdown","touchstart .field":"pointerdown","focusin .field":"pointerfocusin","focusout .field":"pointerfocusout"},HTMLEntities:{lt:"<",gt:">",amp:"&",nbsp:" ",quot:'"',cent:"\xa2",pound:"\xa3",euro:"\u20ac",yen:"\xa5",copy:"\xa9",reg:"\xae"},init:function(){var t=this.options.groups=this.options.groups||{};Te(this,"stopBatchCommand","pointerup","onContentEditableBlur","replaceHTMLEntity"),this.widgets={},this._attributeKeysInUse=[],this.flatAttributes=this.flattenInputs(this.options.inputs),this.expandAttributes=this.expandAttrs(this.options.inputs||{}),this._when={},this._bound={};var e=Object.keys(this.flatAttributes).map(function(t){var e=this.flatAttributes[t];if(e.when){var n={expression:e.when,path:t};this.extractExpressionPaths(n.expression).forEach(function(t){(this._when[t]||(this._when[t]=[])).push(n)},this)}return this.needsResolving(e)&&(this._bound[t]=e.options),e.path=t,e},this);for(var n in t){var i=t[n];i&&t.hasOwnProperty(n)&&this.extractExpressionPaths(i.when).forEach(function(t){this._when[t]||(this._when[t]=[])},this)}var r=fe(e,"index");this.groupedFlatAttributes=fe(r,(function(t){var e=this.options.groups[t.group];return e&&e.index||Number.MAX_VALUE}).bind(this)),this.listenTo(this.getModel(),"all",this.onCellChange,this)},cacheInputs:function(){var t={};Array.from(this.$("[data-attribute]")).forEach(function(e){var n=i(e),r=n.attr("data-attribute");t[r]=n},this),this._byPath=t,this._attributeKeysInUse=this.getAttributeKeysInUse()},updateGroupsVisibility:function(){for(var t=this.$groups,e=0,n=t.length;e<n;e++){var r=i(t[e]),o=r.attr("data-name"),s=this.options.groups[o],a=0===r.find("> .field:not(.hidden)").length;r.toggleClass("empty",a);var l=!(!s||!s.when||this.isExpressionValid(s.when));r.toggleClass("hidden",l)}},expandAttrs:function(t){for(var e={},n=Object.keys(t),i=0;i<n.length;i++){var r=n[i],o=t[r];ft(e,r.split("/"),ce(o)?this.expandAttrs(o):o)}return e},flattenInputs:function(t){return Lt(t,"/",function(t){return"string"==typeof t.type})},getModel:function(){return this.options.cell||this.options.cellView.model},onCellChange:function(t,e,n,i){if((i=i||{}).inspector!=this.cid)switch(t){case"remove":this.remove();break;case"change:position":this.updateInputPosition();break;case"change:size":this.updateInputSize();break;case"change:angle":this.updateInputAngle();break;case"change:source":case"change:target":case"change:vertices":break;default:var r="change:";if(t.slice(0,7)===r){var o=t.slice(7);this._attributeKeysInUse.includes(o)&&this.render({refresh:!0})}}},render:function(t){var e,n=t&&t.refresh;n&&this.options.storeGroupsState&&this.storeGroupsState(),this.$el.empty(),this.removeWidgets();var r,o=[];return this.groupedFlatAttributes.forEach(function(t){if(e!==t.group){var i=this.options.groups[t.group];r=this.renderGroup({name:t.group,label:i&&i.label}),n||(i&&i.closed?this.closeGroup(r,{init:!0}):this.openGroup(r,{init:!0})),o.push(r)}this.renderTemplate(r,t,t.path),e=t.group},this),this.$document=i(this.el.ownerDocument),this.$groups=i(o),this.$el.append(o),n&&this.options.restoreGroupsState&&this.restoreGroupsState(),this.afterRender(),this},getAttributeKeysInUse:function(){var t=Object.keys(this._byPath).map(function(t){return t.substring(0,t.indexOf("/"))||t}),e=ue(this._bound),n=Object.keys(this._when);return ie([].concat(t,e,n))},getCellAttributeValue:function(t,e){var n=dt(this.getModel().attributes,t,"/");if(!(e=e||this.flatAttributes[t]))return n;if(void 0===n&&void 0!==e.defaultValue&&(n=e.defaultValue),e.valueRegExp){if(void 0===n)throw new Error("Inspector: defaultValue must be present when valueRegExp is used.");var i=n.match(new RegExp(e.valueRegExp));n=i&&i[2]}return n},resolvableTypes:["select","select-box","color-palette","select-button-group"],needsResolving:function(t){return!!t&&-1<this.resolvableTypes.indexOf(t.type)&&Ae(t.options)},resolveBindings:function(t){if(-1<this.resolvableTypes.indexOf(t.type)){var e=t.options||[];Ae(e)&&(e=dt(this.getModel().attributes,e,"/")||[]),De(e[0])||(e=ue(e).map(function(t){return{value:t,content:t}})),t.items=e}},updateBindings:function(t){var e=Object.keys(this._bound).reduce((function(e,n){var i=this._bound[n];return 0===t.indexOf(i)&&e.push(n),e}).bind(this),[]);se(e)||(e.forEach(function(t){this.renderTemplate(null,this.flatAttributes[t],t,{replace:!0})},this),this.afterRender())},renderFieldContent:function(t,e,n){var r,o,s,a,l;if(le(this.options.renderFieldContent)&&(r=this.options.renderFieldContent(t,e,n,this)))return i(r).attr({"data-attribute":e,"data-type":t.type,"data-custom-field":!0});switch(t.type){case"select-box":s=ue(t.items).findIndex(function(e){var i=e.value,r=n;if(void 0===i&&e.content===r)return!0;var o=t.key;return o&&(r=dt(r,o,"/"),i=dt(i,o,"/")),ae(i,r)});var c=Jt({theme:this.options.theme},Ie(t,"type","group","index","selectBoxOptionsClass","options"),{options:t.items,selected:s,selectBoxOptionsClass:[lt("inspector-select-box-options"),t.selectBoxOptionsClass].filter(function(t){return!!t}).join(" ")});(o=new Ks(c)).$el.attr({"data-attribute":e,"data-type":t.type,"data-overwrite":t.overwrite}),o.render(),l=this.renderOwnLabel(t,e),r=i("<div/>").append(l,o.el),t.previewMode?(a=o.selection,o.on("options:mouseout close",function(){o.selection=a,this.processInput(o.$el,{previewCancel:!0,dry:!0})},this),o.on("option:hover",function(t,e){o.selection=t,this.processInput(o.$el,{dry:!0})},this),o.on("option:select",function(t,e){var n=void 0===a?void 0:o.getSelectionValue(a),i=n===o.getSelectionValue(t);this.processInput(o.$el,{previewDone:!0,dry:i,originalValue:n}),a=t},this)):o.on("option:select",function(t,e){this.processInput(o.$el)},this),this.widgets[e]=o;break;case"color-palette":s=ue(t.items).findIndex(function(t){return t.value===n||void 0===t.value&&t.content===n});var u=Jt({theme:this.options.theme},Ie(t,"type","group","index","options"),{options:t.items,selected:s});(o=new Bs(u)).$el.attr({"data-attribute":e,"data-type":t.type}),o.render(),l=this.renderOwnLabel(t,e),r=i("<div/>").append(l,o.el),t.previewMode?(a=o.selection,o.on("options:mouseout close",function(){o.selection=a,this.processInput(o.$el,{previewCancel:!0,dry:!0})},this),o.on("option:hover",function(t,e){o.selection=t,this.processInput(o.$el,{dry:!0})},this),o.on("option:select",function(t,e){var n=void 0===a?void 0:o.getSelectionValue(a),i=n===o.getSelectionValue(t);this.processInput(o.$el,{previewDone:!0,dry:i,originalValue:n}),a=t},this)):o.on("option:select",function(t,e){this.processInput(o.$el)},this),this.widgets[e]=o;break;case"select-button-group":t.multi?(s=[],ue(t.items).forEach(function(e,i){var r=void 0===e.value?e.content:e.value,o=t.key;o&&(r=dt(r,o,"/")),ue(n).find(function(t){return o&&(t=dt(t,o,"/")),ae(r,t)})&&s.push(i)})):s=ue(t.items).findIndex(function(e){var i=e.value,r=n;if(void 0===i&&e.content===r)return!0;var o=t.key;return o&&(r=dt(r,o,"/"),i=dt(i,o,"/")),ae(i,r)});var h=Jt({theme:this.options.theme},Ie(t,"type","group","index","options"),{options:t.items,selected:s});(o=new Zs(h)).$el.attr({"data-attribute":e,"data-type":t.type,"data-overwrite":t.overwrite}),o.render(),l=this.renderOwnLabel(t,e),r=i("<div/>").append(l,o.el),t.previewMode?(a=o.selection,o.on("mouseout",function(){o.selection=a,this.processInput(o.$el,{previewCancel:!0,dry:!0})},this),o.on("option:hover",function(e,n){t.multi?o.selection=ie(o.selection.concat([e])):o.selection=e,this.processInput(o.$el,{dry:!0})},this),o.on("option:select",function(t,e){var n=void 0===a?void 0:o.getSelectionValue(a),i=o.getSelectionValue(t),r=ae(n,i);this.processInput(o.$el,{previewDone:!0,dry:r,originalValue:n}),a=t},this)):o.on("option:select",function(t,e){this.processInput(o.$el)},this),this.widgets[e]=o;break;default:r=this.renderOwnFieldContent({options:t,type:t.type,overwrite:t.overwrite,label:t.label||e,attribute:e,value:n})}return r},renderGroup:function(t){t=t||{};var e=i("<div/>").addClass("group").attr("data-name",t.name),n=i("<h3/>").addClass("group-label").text(t.label||t.name);return e.append(n)},renderOwnLabel:function(t,e){var n,r=this.options.renderLabel;if("function"==typeof r&&(n=r(t,e,this)),void 0!==n)return i(n);switch(t.type){case"select-box":case"color-palette":case"select-button-group":return i("<label/>").html(t.label||e);default:return i("<label/>").text(t.label||e)}},renderOwnFieldContent:function(t){var e,n,r,o,s,a,l;switch(l=this.renderOwnLabel(t.options,t.attribute),t.type){case"number":n=i("<input/>",{type:"number",min:t.options.min,max:t.options.max,step:t.options.step}).val(t.value),e=[l,i("<div/>").addClass("input-wrapper").append(n)];break;case"range":l.addClass("with-output"),r=i("<output/>").text(t.value),o=i("<span/>").addClass("units").text(t.options.unit),(n=i("<input/>",{type:"range",name:t.type,min:t.options.min,max:t.options.max,step:t.options.step}).val(t.value)).on("change input",function(){r.text(n.val())}),e=[l,r,o,n];break;case"textarea":n=i("<textarea/>").text(t.value),e=[l,i("<div/>").addClass("input-wrapper").append(n)];break;case"content-editable":var c=Ae(t.value)?t.value.replace(/\n/g,"<br>"):"";n=i("<div/>").prop("contenteditable",!0).css("display","inline-block").html(c).on("blur",this.onContentEditableBlur),e=[l,i("<div/>").addClass("input-wrapper").append(n)];break;case"select":var u=t.options.items;n=i("<select/>"),t.options.multiple&&n.prop({size:t.options.size||u.length,multiple:!0}),ue(u).forEach(function(e){var r=i("<option/>",{value:e.value}).text(e.content);!function(e){return t.options.multiple?ue(t.value).find(function(t){return ae(e,t)}):ae(e,t.value)}(e.value)||r.attr("selected","selected"),n.append(r)}),e=[l,n];break;case"toggle":s=i("<span><i/></span>"),n=i("<input/>",{type:"checkbox"}).prop("checked",!!t.value),e=[l,i("<div/>").addClass(t.type).append(n,s)];break;case"color":e=[l,n=i("<input/>",{type:"color"}).val(t.value)];break;case"text":n=i("<input/>",{type:"text"}).val(t.value),e=[l,i("<div/>").addClass("input-wrapper").append(n)];break;case"object":n=i("<div/>"),a=i("<div/>").addClass("object-properties"),e=[l,n.append(a)];break;case"list":s=i("<button/>").addClass("btn-list-add").text(t.options.addButtonLabel||"+"),a=i("<div/>").addClass("list-items"),e=[l,(n=i("<div/>")).append(s,a)]}return n&&n.addClass(t.type).attr({"data-type":t.type,"data-attribute":t.attribute,"data-overwrite":t.overwrite}),i.fn.append.apply(i("<div>"),e).children()},onContentEditableBlur:function(t){var e=i("<input/>",{disabled:!0,tabIndex:-1,style:{width:"1px",height:"1px",border:"none",margin:0,padding:0}}).appendTo(this.$el);e.focus(),e[0].setSelectionRange(0,0),e.blur().remove(),i(t.target).trigger("change")},replaceHTMLEntity:function(t,e){return this.HTMLEntities[e]||""},renderObjectProperty:function(t){return i("<div/>",{"data-property":(t=t||{}).property,class:"object-property"})},renderListItem:function(t){t=t||{};var e=i("<button/>").addClass("btn-list-del").text(t.options.removeButtonLabel||"-");return i("<div/>",{"data-index":t.index,class:"list-item"}).append(e)},renderFieldContainer:function(t){return i("<div/>",{"data-field":(t=t||{}).path,class:"field "+t.type+"-field"})},renderTemplate:function(t,e,n,i){t=t||this.$el,i=i||{},this.resolveBindings(e);var r=this.renderFieldContainer({path:n,type:e.type});e.when&&!this.isExpressionValid(e.when)&&(r.addClass("hidden"),e.when.otherwise&&e.when.otherwise.unset&&this.unsetProperty(n));var o=this.getCellAttributeValue(n,e),s=this.renderFieldContent(e,n,o);if(r.append(s),_t(r,e.attrs),"list"===e.type){ue(o).forEach(function(t,i){var r=this.renderListItem({index:i,options:e});this.renderTemplate(r,e.item,n+"/"+i),s.children(".list-items").append(r)},this);var a=o&&o.length,l=e&&e.min,c=e&&e.max;this.fixListButtons(s,a,l,c)}else if("object"===e.type){var u=this.flattenInputs(e.properties),h=Object.keys(u).map(function(t){var e=this[t];return e.path=t,e},u);(h=fe(h,function(t){return t.index})).forEach(function(t){var e=this.renderObjectProperty({property:t.path});this.renderTemplate(e,t,n+"/"+t.path),s.children(".object-properties").append(e)},this)}i.replace?t.find('[data-field="'+n+'"]').replaceWith(r):t.append(r)},updateInputPosition:function(){var t=this._byPath["position/x"],e=this._byPath["position/y"],n=this.getModel().get("position");t&&t.val(n.x),e&&e.val(n.y)},updateInputSize:function(){var t=this._byPath["size/width"],e=this._byPath["size/height"],n=this.getModel().get("size");t&&t.val(n.width),e&&e.val(n.height)},updateInputAngle:function(){var t=this._byPath.angle,e=this.getModel().get("angle");t&&t.val(e)},validateInput:function(t,e,n){switch(t){case"select-box":case"color-palette":var i=this.widgets[n];return!!i&&-1!==i.getSelectionIndex();case"select-button-group":return!!this.widgets[n];default:return this.options.validateInput(e,n,t,this)}},onChangeInput:function(t){t.target===t.currentTarget&&this.processInput(i(t.target))},processInput:function(t,e){var n=t.attr("data-attribute"),i=t.attr("data-type");if(this.validateInput(i,t[0],n)){this.options.live&&this.updateCell(t,n,e);var r=this.getFieldValue(t[0],i),o=this.parse(i,r,t[0]);this.trigger("change:"+n,o,t[0],e)}},updateDependants:function(t){ue(this._when[t]).forEach(function(t){var e=this._byPath[t.path],n=e.closest(".field"),i=n.hasClass("hidden"),r=this.isExpressionValid(t.expression);n.toggleClass("hidden",!r),t.expression.otherwise&&t.expression.otherwise.unset&&this.options.live&&(r?i&&this.updateCell(e,t.path):(this.unsetProperty(t.path),this.renderTemplate(null,this.flatAttributes[t.path],t.path,{replace:!0}),this.afterRender()))},this)},unsetProperty:function(t,e){var n=this.getModel(),i=t.split("/"),r=i[0],o=i.slice(1).join("/");if((e=e||{}).inspector=this.cid,e["inspector_"+this.cid]=!0,"attrs"==t)n.removeAttr(o,e);else if(t==r)n.unset(r,e);else{var s=pt(At({},n.get(r)),o,"/");n.set(r,s,e)}},getOptions:function(t){if(0!==t.length){var e=t.attr("data-attribute");return this.getOptionsFromPath(e)}},markForRemoval:function(t,e){var n=this.findParentListByPath(t);if(n){var i=t.substr(n.length+1),r=parseInt(i,10);Number.isFinite(r)&&(e.remove[n]=e.remove[n]||[],e.remove[n].includes(r)||e.remove[n].push(r))}},markForUpdate:function(t,e,n,i){var r=t.substr(i.length+1);e.update[i]&&ft(e.update[i].value,r,n,"/")},updateCell:function(t,e,n){var i=this.getModel(),r={};t?r[e]=t:r=this._byPath,this.startBatchCommand();var o={},s={update:{},remove:{}};we(r,(function(t,e){if(!t.closest(".field").hasClass("hidden")){var n=t.attr("data-type"),r=t.attr("data-overwrite"),a="false"!==r&&void 0!==r,l=t.hasClass("remove");switch(n){case"list":case"object":l&&this.markForRemoval(e,s);break;default:if(!this.validateInput(n,t[0],e))return;var c=this.getFieldValue(t[0],n),u=this.parse(n,c,t[0]),h=this.getOptionsFromPath(e);if(h.valueRegExp&&(u=(dt(i.attributes,e,"/")||h.defaultValue).replace(new RegExp(h.valueRegExp),"$1"+u+"$3")),l)this.markForRemoval(e,s);else{var d=h.parent;if(d&&"object"===d.type&&void 0!==d.overwrite&&!1!==d.overwrite){var f={},p=e.split("/");f[p[p.length-1]]=u,s.update[d.path]={value:f,overwrite:!0}}else o[e]={value:u,overwrite:a}}}}}).bind(this)),we(o,(function(t,e){this.setProperty(e,t.value,Jt({overwrite:t.overwrite},n)),this.updateBindings(e),this.updateDependants(e)}).bind(this)),fe(Object.keys(s.remove),function(t){return t.split("/").length}).reverse().forEach((function(t){var e=s.remove[t];this.removeProperty(t,e,Jt({rewrite:!0},n))}).bind(this)),we(s.update,(function(t,e){this.setProperty(e,this.compactDeep(t.value),Jt({rewrite:!0,overwrite:t.overwrite},n)),this.updateBindings(e),this.updateDependants(e)}).bind(this)),this.updateGroupsVisibility(),this.stopBatchCommand()},compactDeep:function(t){return Array.isArray(t)?t.reduce((function(t,e){return e&&t.push(this.compactDeep(e)),t}).bind(this),[]):t},findParentListByPath:function(t){var e=t.split("/");e.pop();for(var n=e;n.length;){var i=this.getOptionsFromPath(n.join("/"));if(i&&"list"===i.type)return e.slice(0,n.length).join("/");n.pop()}return null},getOptionsFromPath:function(t){for(var e,n=t.split("/"),i=this.expandAttributes,r=[];n.length;){var o,s=o;if(i&&"object"===i.type?o="properties":(o=n.shift(),!n.length&&"list"!==i.type||(e=i,r.push(o))),o=Number.isNaN(parseInt(o))||"list"!==i.type?o:"item",Object(i)!==i||!(o in i)&&!i[t])return{};i=i[o]||i[t]}return i=Jt({},i),(e=Jt({},e)).path=r.join("/"),s&&"properties"===s&&(e.type="object"),i.parent=e,i},getFieldValue:function(t,e){if(le(this.options.getFieldValue)){var n=this.options.getFieldValue(t,e,this);if(n)return n.value}var r=i(t);switch(e){case"select-box":case"color-palette":case"select-button-group":var o=r.attr("data-attribute");return this.widgets[o].getSelectionValue();case"content-editable":return r.html().replace(/((<br\s*\/*>)?<\/div>)|(((&nbsp;)|(<br\s*\/*>))?<\/p>)|(<br\s*\/*>)/gi,"\n").replace(/(<([^>]+)>)/gi,"").replace(/&(\w+);/gi,this.replaceHTMLEntity).replace(/\n$/,"");default:return r.val()}},removeProperty:function(t,e,n){var i=this.getModel(),r=Ze.prototype.prop,o=r.call(i,t);if(o){var s=o.reduce(function(t,n,i){return e.includes(i)||t.push(n),t},[]),a=this.flatAttributes[t];Array.isArray(s)&&0===s.length&&!a&&(s=null),r.call(i,t,s,n)}},setProperty:function(t,e,n){(n=n||{}).inspector=this.cid;var i=Ze.prototype.prop,r=this.getModel(),o=n.overwrite||!1;if(n.previewDone&&i.call(r,t,n.originalValue,{rewrite:!0,silent:!0}),void 0===e)Ze.prototype.removeProp.call(r,t,n);else{var s;if(De(e)&&!o){var a=i.call(r,t);s=At(Array.isArray(e)?[]:{},a,e)}else s=re(e);o&&(n.rewrite=!0),i.call(r,t,s,n)}},parse:function(t,e,n){switch(t){case"number":case"range":e=parseFloat(e);break;case"toggle":e=n.checked}return e},startBatchCommand:function(){if(!this.inBatch){this.inBatch=!0;var t=this.getModel();t instanceof Ze&&t.startBatch("inspector",{cid:this.cid})}},stopBatchCommand:function(){if(this.inBatch){var t=this.getModel();t instanceof Ze&&t.stopBatch("inspector",{cid:this.cid}),this.inBatch=!1}},afterRender:function(){this.cacheInputs(),this.updateGroupsVisibility(),this.trigger("render")},addListItem:function(t){var e=i(t.target).parent("[data-attribute]"),n=this.getOptions(e),r=e.children(".list-items"),o=r.children(".list-item"),s=o.last(),a=(0===s.length?-1:parseInt(s.attr("data-index"),10))+1,l=this.renderListItem({index:a,options:n}),c=e.attr("data-attribute")+"/"+a;this.renderTemplate(l,n.item,c),r.append(l),l.find("input:first").focus();var u=(o=r.children(".list-item")).not(".remove").length;this.fixListButtons(e,u,n.min,n.max),this.afterRender(),this.options.live&&this.updateCell()},deleteListItem:function(t){var e=i(t.target),n=e.closest("[data-attribute]"),r=this.getOptions(n),o=e.closest(".list-item");o.hide(),o.addClass("remove"),o.find("[data-field]").each(function(){i(this).hide().addClass("remove")}),o.find("[data-attribute]").each(function(){i(this).hide().addClass("remove")});var s=n.children(".list-items").children(".list-item").not(".remove").length;this.fixListButtons(n,s,r.min,r.max),this.afterRender(),this.options.live&&this.updateCell()},fixListButtons:function(t,e,n,i){var r,o,s=t.children(".btn-list-add");r=e,"number"!=typeof(o=i)||"number"!=typeof r||r<o?s.removeClass("hidden"):s.addClass("hidden");var a,l,c=t.children(".list-items").children(".list-item").children(".btn-list-del");a=e,"number"!=typeof(l=n)||l<=0||!("number"!=typeof a||a<=0)&&l<a?c.removeClass("hidden"):c.addClass("hidden")},bindDocumentEvents:function(){var t=this.getEventNamespace();this.$document.on("mouseup"+t+" touchend"+t,this.pointerup)},unbindDocumentEvents:function(){this.$document.off(this.getEventNamespace())},pointerdown:function(t){this.bindDocumentEvents(),this.startBatchCommand(),this._$activeField=i(t.currentTarget).addClass("is-in-action")},pointerup:function(){this.unbindDocumentEvents(),this.stopBatchCommand(),this._$activeField&&(this._$activeField.removeClass("is-in-action"),this._$activeField=null)},pointerfocusin:function(t){t.stopPropagation(),i(t.currentTarget).addClass("is-focused")},pointerfocusout:function(t){t.stopPropagation(),i(t.currentTarget).removeClass("is-focused")},onRemove:function(){this.unbindDocumentEvents(),this.removeWidgets(),this===this.constructor.instance&&(this.constructor.instance=null)},removeWidgets:function(){var t=this.widgets;for(var e in t)t[e].remove();this.widgets={}},onGroupLabelClick:function(t){t.preventDefault(),this.options.multiOpenGroups||this.closeGroups();var e=i(t.target).closest(".group");this.toggleGroup(e)},toggleGroup:function(t){var e=Ae(t)?this.$('.group[data-name="'+t+'"]'):i(t);e.hasClass("closed")?this.openGroup(e):this.closeGroup(e)},closeGroup:function(t,e){e=e||{};var n=Ae(t)?this.$('.group[data-name="'+t+'"]'):i(t);!e.init&&n.hasClass("closed")||(n.addClass("closed"),this.trigger("group:close",n.data("name"),e))},openGroup:function(t,e){e=e||{};var n=Ae(t)?this.$('.group[data-name="'+t+'"]'):i(t);(e.init||n.hasClass("closed"))&&(n.removeClass("closed"),this.trigger("group:open",n.data("name"),e))},closeGroups:function(){for(var t=0,e=this.$groups.length;t<e;t++)this.closeGroup(this.$groups[t])},openGroups:function(){for(var t=0,e=this.$groups.length;t<e;t++)this.openGroup(this.$groups[t])},COMPOSITE_OPERATORS:["not","and","or","nor"],PRIMITIVE_OPERATORS:["eq","ne","regex","text","lt","lte","gt","gte","in","nin","equal"],_isComposite:function(t){return 0<ve(this.COMPOSITE_OPERATORS,Object.keys(t)).length},_isPrimitive:function(t){var e=Object.keys(this.options.operators).concat(this.PRIMITIVE_OPERATORS);return 0<ve(e,Object.keys(t)).length},_evalCustomPrimitive:function(t,e,n){return!!this.options.operators[t].apply(this,[this.getModel(),e].concat(n))},_evalPrimitive:function(t){return Object.keys(t).reduce((function(e,n){var i=t[n];return Object.keys(i).reduce((function(t,e){var r=i[e],o=this.getCellAttributeValue(e);if(le(this.options.operators[n]))return this._evalCustomPrimitive(n,o,r);switch(n){case"eq":return r==o;case"ne":return r!=o;case"regex":return new RegExp(r).test(o);case"text":return!r||Ae(o)&&-1<o.toLowerCase().indexOf(r);case"lt":return o<r;case"lte":return o<=r;case"gt":return r<o;case"gte":return r<=o;case"in":return Array.isArray(r)&&r.includes(o);case"nin":return Array.isArray(r)&&!r.includes(o);case"equal":return ae(r,o);default:return t}}).bind(this),!1)}).bind(this),!1)},_evalExpression:function(t){return this._isPrimitive(t)?this._evalPrimitive(t):Object.keys(t).reduce((function(e,n){var i=t[n];if("not"==n)return!this._evalExpression(i);var r=ue(i).map(this._evalExpression,this);switch(n){case"and":return r.every(function(t){return!!t});case"or":return r.some(function(t){return!!t});case"nor":return!r.some(function(t){return!!t});default:return e}}).bind(this),!1)},_extractVariables:function(t){return Array.isArray(t)||this._isComposite(t)?ue(t).reduce((function(t,e){return t.concat(this._extractVariables(e))}).bind(this),[]):ue(t).reduce(function(t,e){return Object.keys(e)},[])},isExpressionValid:function(t){return t=Ie(t,"otherwise","dependencies"),this._evalExpression(t)},extractExpressionPaths:function(t){var e=t&&t.dependencies||[];return t=Ie(t,"otherwise","dependencies"),ie(this._extractVariables(t).concat(e))},getGroupsStateKey:function(){if(le(this.options.stateKey))return this.options.stateKey(this.getModel());throw new Error("Inspector: Option stateKey must be a function")},storeGroupsState:function(){var t=this.getGroupsStateKey(),e=ue(this.$(".group.closed"));Ws.groupStates[t]=e.map(function(t){return i(t).attr("data-name")})},getGroupsState:function(){return Ws.groupStates[this.getGroupsStateKey()]},restoreGroupsState:function(){function t(t,e){we(e.options.groups,(function(e,n){t(e,n)?this.closeGroup(n):this.openGroup(n)}).bind(e))}var e=this.getGroupsStateKey();Ws.groupStates[e]?t(function(t,n){return Ws.groupStates[e].includes(n)},this):t(function(t){return t.closed},this)}},{groupStates:{},instance:null,create:function(t,e){Qt(e=e||{},{restoreGroupsState:!0,storeGroupsState:!0});var n=e.cell||e.cellView.model,r=this.instance;return r&&r.getModel()===n||(r&&r.el.parentNode&&(e.storeGroupsState&&r.storeGroupsState(),r.updateCell(),r.remove()),r=new this(e).render(),this.instance=r,i(t).html(r.el),e.restoreGroupsState&&r.restoreGroupsState()),r},close:function(){var t=this.instance;t&&t.remove()}});Jt(Hs.prototype,e.Events),Hs.prototype.on=function(t,n,i){return e.Events.on.call(this,this.normalizeEvent(t),n,i),this},Hs.prototype.off=function(t,n,i){var r=t?this.normalizeEvent(t):null;return e.Events.off.call(this,r,n,i),this},Hs.prototype.normalizeEvent=function(t){if("object"!=typeof t)return this.normalizeShortcut(t);for(var e=Object.keys(t),n={},i=0,r=e.length;i<r;i++){var o=e[i];n[this.normalizeEvent(o)]=t[o]}return n},Hs.prototype.normalizeShortcut=function(t){if("all"===t.toLowerCase())return t;for(var e=this.parser.toEventObjectList(t),n=[],i=0;i<e.length;i++)n.push(this.hash(e[i]));return n.join(" ")},Hs.prototype.enable=function(){window.addEventListener?(document.addEventListener("keydown",this.handleKey,!1),document.addEventListener("keypress",this.handleKey,!1),document.addEventListener("keyup",this.handleKey,!1)):window.attachEvent&&(document.attachEvent("keydown",this.handleKey,!1),document.attachEvent("keypress",this.handleKey,!1),document.attachEvent("keyup",this.handleKey,!1))},Hs.prototype.disable=function(){window.removeEventListener?(document.removeEventListener("keydown",this.handleKey,!1),document.removeEventListener("keypress",this.handleKey,!1),document.removeEventListener("keyup",this.handleKey,!1)):window.detachEvent&&(document.detachEvent("keydown",this.handleKey,!1),document.detachEvent("keypress",this.handleKey,!1),document.detachEvent("keyup",this.handleKey,!1))},Hs.prototype.isActive=function(t,e){return this.isModifierActive(t,e)},Hs.prototype.isModifierActive=function(t,e){for(var n=this.parser.toEventObjectList(t),i=0;i<n.length;i++)if(n[i].modifiersCompare(e))return!0;return!1},Hs.prototype.hash=function(t){function e(t){return t?1:0}return[t.type,":",t.which,e(t.shiftKey),e(t.ctrlKey),e(t.altKey),e(t.metaKey)].join("")},Hs.prototype.handleKey=function(t){if(!this.isUnsupportedElement(t)){var n=ea.fromNative(t);e.Events.trigger.call(this,this.hash(n),t)}},Hs.prototype.isUnsupportedElement=function(t){var e=t.target||t.srcElement;if(e){var n=e.tagName.toUpperCase();return"INPUT"===n||"SELECT"===n||"TEXTAREA"===n||e.isContentEditable}return!1};var $s=function(){};$s.prototype={constructor:$s,parseEventString:function(t){var e,n,i=(t=t||"").split("+"),r=new ea(0);for(n=0;n<i.length;n++){e=i[n];var o=this.getModifierPropertyName(e);o&&(r[o]=!0),1!==i.length&&void 0!==o||(r.which=$s.getCode(e))}return r},toEventObjectList:function(t){return t.replace(/\s*\+\s*/gi,"+").split(" ").map(this.composeEventObject,this)},composeEventObject:function(t){var e=t.split(":"),n=Qs.KEYDOWN,i=e[0];if(1<e.length&&(i=e[1],n=e[0]),-1===ta.indexOf(n))throw t+": invalid shortcut definition";var r=this.parseEventString(i);return n===Qs.KEYUP&&Xs[r.which]&&(r[Xs[r.which]]=!1),r.setType(n)},getModifierPropertyName:function(t){var e=Ys[t];return Xs[e]}},$s.getCode=function(t){return Js[t]||t.toUpperCase().charCodeAt(0)};var Ys={"\u21e7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91,meta:91},Xs={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"},qs={226:"\\",57392:"ctrl",63289:"num",59:";",61:"=",173:"-"},Js={backspace:8,tab:9,shift:16,ctrl:17,alt:18,meta:91,clear:12,enter:13,return:13,esc:27,escape:27,capslock:20,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,insert:45,ins:45,pageup:33,pagedown:34,plus:187,minus:189,"-":189,",":188,".":190,"/":191,"`":192,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123};Jt(Hs,{keyMap:Js,modifierMap:Xs,modifiers:Ys,charCodeAlternatives:qs});var Qs={KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup"},ta=[Qs.KEYPRESS,Qs.KEYDOWN,Qs.KEYUP],ea=function(t,e,n,i,r,o){this.which=t,this.shiftKey=e||!1,this.ctrlKey=n||!1,this.altKey=i||!1,this.metaKey=r||!1,this.type=o||Qs.KEYDOWN};ea.fromNative=function(t){var e=t.which;t.type===Qs.KEYPRESS&&(e=String.fromCharCode(t.which).toUpperCase().charCodeAt(0)),qs[e]&&(e=$s.getCode(qs[e]));var n=new ea(e,t.shiftKey,t.ctrlKey,t.altKey,t.metaKey,t.type);return t.type===Qs.KEYUP&&Xs[e]&&(n[Xs[e]]=!1),n},ea.prototype.modifiersCompare=function(t){return!(this.shiftKey&&this.shiftKey!==t.shiftKey||this.ctrlKey&&this.ctrlKey!==t.ctrlKey||this.altKey&&this.altKey!==t.altKey||this.metaKey&&this.metaKey!==t.metaKey)},ea.prototype.setType=function(t){return this.type=t,this};var na=js.extend({className:js.prototype.className+" lightbox",options:At({},js.prototype.options,{closeButton:!0,modal:!0,downloadable:!1,downloadAction:"download",fileName:"Image",closeAnimation:{delay:2e3,duration:200,easing:"swing",properties:{opacity:0}},top:100,windowArea:.8,openAnimation:!1}),init:function(){if(Te(this,"startCloseAnimation","positionAndScale"),js.prototype.init.apply(this,arguments),this.options.image&&(this.$image=i("<img/>").on("load",this.positionAndScale),this.options.content=this.$image),this.options.downloadable){var t={action:this.options.downloadAction,content:"Download",position:"center"};this.buttons=Array.isArray(this.buttons)?this.buttons.slice():[],this.buttons.push(t)}this.on("action:"+this.options.downloadAction,this.download),i(window).on("resize",this.positionAndScale),this.on("close:animation:complete",this.remove,this)},open:function(){return js.prototype.open.apply(this,arguments),this.$image&&this.$image.attr("src",this.options.image),this.positionAndScale(),this.startOpenAnimation(),this},positionAndScale:function(){var t=this.$(".fg"),e=this.$(".body > img"),n=this.$(".titlebar"),i=this.$(".controls"),r=this.options.windowArea,o=window.innerWidth*r;this.$el.css("margin-top",this.options.top),n.css("width",o);var s=n.height(),a=i.height(),l=window.innerHeight*r-this.options.top-s-a;t.css({width:o,height:l});var c=e.width(),u=e.height();t.css({width:c,height:u}),n.css("width","auto"),n.hasClass("empty")||i.css("top",n.outerHeight())},download:function(){Tt(this.options.image,(function(t,e){Et(e,this.options.fileName)}).bind(this))},close:function(){return this.options.closeAnimation?this.startCloseAnimation():js.prototype.close.apply(this,arguments),this},onRemove:function(){js.prototype.onRemove.apply(this,arguments),i(window).off("resize",this.positionAndScale),this.$image&&this.$image.off("load",this.positionAndScale)},startCloseAnimation:function(){this.$el.animate(this.options.closeAnimation.properties,Jt({complete:(function(){this.trigger("close:animation:complete")}).bind(this)},this.options.closeAnimation))},startOpenAnimation:function(){this.$el.animate(Jt({},this.options.openAnimation.properties,{height:this._foregroundHeight}),Jt({complete:(function(){this.trigger("open:animation:complete")}).bind(this)},this.options.openAnimation))}}),ia=dn.extend({className:"navigator",events:{mousedown:"startAction",touchstart:"startAction","mousedown .joint-paper":"scrollTo","touchstart .joint-paper":"scrollTo"},documentEvents:{mousemove:"doAction",touchmove:"doAction",mouseup:"stopAction",touchend:"stopAction"},options:{paperConstructor:qr,paperOptions:{},zoomOptions:null,zoom:{min:.5,max:2},width:300,height:200,padding:10},init:function(){this.options.zoomOptions?this.options.zoom=Jt({},this.options.zoom,this.options.zoomOptions):this.options.zoom&&(this.options.zoom=Qt({},this.options.zoom,this.constructor.prototype.options.zoom)),Te(this,"updateCurrentView","doAction","stopAction","scrollTo"),this.updateCurrentView=he(this.updateCurrentView,0);var t=this.options.paperScroller;t.$el.on("scroll"+this.getEventNamespace(),this.updateCurrentView);var e=this.sourcePaper=t.options.paper;this.listenTo(e,"resize",this.updatePaper),this.targetPaper=new this.options.paperConstructor(At({model:e.model,interactive:!1,frozen:!0},this.options.paperOptions))},render:function(){if(this.targetPaper.$el.appendTo(this.el),this.targetPaper.unfreeze(),this.$currentView=i("<div>").addClass("current-view"),this.options.zoom){var t=i("<div>").addClass("current-view-control");this.$currentView.append(t)}return this.$el.append(this.$currentView).css({width:this.options.width,height:this.options.height,padding:this.options.padding}),this.updatePaper(this.sourcePaper.options.width,this.sourcePaper.options.height),this},updatePaper:function(t,e){var n=this.sourcePaper.options.origin,i=this.sourcePaper.scale(),r=this.options.width-2*this.options.padding,o=this.options.height-2*this.options.padding;t/=i.sx,e/=i.sy;var s=this.ratio=Math.min(r/t,o/e),a=n.x*s/i.sx,l=n.y*s/i.sy;t*=s,e*=s,this.targetPaper.setDimensions(t,e),this.targetPaper.setOrigin(a,l),this.targetPaper.scale(s,s),this.updateCurrentView()},updateCurrentView:function(){var t=this.ratio,e=this.sourcePaper.scale(),n=this.options.paperScroller,i=n.clientToLocalPoint(0,0),r=this.targetPaper.$el.position(),o=this.targetPaper.translate();o.ty=o.ty||0,this.currentViewGeometry={top:r.top+i.y*t+o.ty,left:r.left+i.x*t+o.tx,width:n.$el.innerWidth()*t/e.sx,height:n.$el.innerHeight()*t/e.sy},this.$currentView.css(this.currentViewGeometry)},startAction:function(t){var e=(t=vt(t)).clientX,n=t.clientY,r=i(t.target).hasClass("current-view-control")?"zooming":"panning",o=this.options,s=this.currentViewGeometry,a=this.sourcePaper,l=o.paperScroller;this.delegateDocumentEvents(null,{action:r,startClientX:e,startClientY:n,startScrollLeft:l.el.scrollLeft,startScrollTop:l.el.scrollTop,startZoom:l.zoom(),startGeometry:s,startScale:a.scale()})},doAction:function(t){var e=(t=vt(t)).clientX,n=t.clientY,i=t.data,r=this.sourcePaper,o=this.options,s=this.ratio,a=i.action,l=i.startClientX,c=i.startClientY,u=i.startScrollLeft,h=i.startScrollTop,d=i.startZoom,f=i.startGeometry,p=i.startScale,g=i.frameId,m=o.paperScroller,v=o.zoom;switch(a){case"panning":var y=r.scale(),b=(e-l)*y.sx,C=(n-c)*y.sy;m.el.scrollLeft=u+b/s,m.el.scrollTop=h+C/s;break;case"zooming":var I=1+(l-e)/f.width/p.sx;zt(g),i.frameId=Bt(function(){m.zoom(I*d,Qt({absolute:!0},v))})}},stopAction:function(){this.undelegateDocumentEvents()},scrollTo:function(t){t=vt(t);var e,n,i=this.targetPaper.translate();if(i.ty=i.ty||0,void 0===t.offsetX){var r=this.targetPaper.$el.offset();e=t.pageX-r.left,n=t.pageY-r.top}else e=t.offsetX,n=t.offsetY;var o=(e-i.tx)/this.ratio,s=(n-i.ty)/this.ratio;this.options.paperScroller.center(o,s)},onRemove:function(){this.targetPaper.remove(),this.options.paperScroller.$el.off(this.getEventNamespace())}}),ra=dn.extend({className:"paper-scroller",options:{paper:void 0,padding:function(){var t=this.getClientSize(),e=Math.max(this.options.minVisiblePaperSize,1)||1,n={};return n.left=n.right=Math.max(t.width-e,0),n.top=n.bottom=Math.max(t.height-e,0),n},minVisiblePaperSize:50,autoResizePaper:!1,baseWidth:void 0,baseHeight:void 0,contentOptions:void 0,cursor:"default"},_padding:{left:0,top:0},init:function(){Te(this,"startPanning","stopPanning","pan","onBackgroundEvent");var t=this.options.paper,e=t.scale();this._sx=e.sx,this._sy=e.sy,void 0===this.options.baseWidth&&(this.options.baseWidth=t.options.width),void 0===this.options.baseHeight&&(this.options.baseHeight=t.options.height),this.$background=i("<div/>").addClass("paper-scroller-background").css({width:t.options.width,height:t.options.height}).append(t.el).appendTo(this.el),this.listenTo(t,"scale",this.onScale).listenTo(t,"resize",this.onResize).listenTo(t,"beforeprint beforeexport",this.storeScrollPosition).listenTo(t,"afterprint afterexport",this.restoreScrollPosition),this.options.autoResizePaper&&(t.isAsync()?this.listenTo(t,"render:done",this.onPaperRenderDone):this.listenTo(t.model,"change add remove reset",this.adjustPaper)),this.delegateBackgroundEvents(),this.setCursor(this.options.cursor)},onPaperRenderDone:function(t){t.priority<2&&this.adjustPaper()},lock:function(){return this.$el.css("overflow","hidden"),this},unlock:function(){return this.$el.css("overflow","scroll"),this},setCursor:function(t){if("grab"===t)this.$el.css("cursor","");else this.$el.css("cursor",t);return this.$el.attr("data-cursor",t),this.options.cursor=t,this},delegateBackgroundEvents:function(t){t=t||Ce(this.options.paper,"events");var e=this.paperEvents=Object.keys(t||{}).reduce((function(e,n){var i=t[n];return-1===n.indexOf(" ")&&(e[n]=le(i)?i:this.options.paper[i]),e}).bind(this),{});return Object.keys(e).forEach(function(t){this.delegate(t,{guarded:!1},this.onBackgroundEvent)},this),this},onBackgroundEvent:function(t){if(this.$background.is(t.target)){var e=this.paperEvents[t.type];le(e)&&e.apply(this.options.paper,arguments)}},onResize:function(){this._center&&this.center(this._center.x,this._center.y)},onScale:function(t,e,n,i){this.adjustScale(t,e),this._sx=t,this._sy=e,(n||i)&&this.center(n,i),"function"==typeof this.options.contentOptions&&this.adjustPaper()},storeScrollPosition:function(){this._scrollLeftBeforePrint=this.el.scrollLeft,this._scrollTopBeforePrint=this.el.scrollTop},restoreScrollPosition:function(){this.el.scrollLeft=this._scrollLeftBeforePrint,this.el.scrollTop=this._scrollTopBeforePrint,this._scrollLeftBeforePrint=null,this._scrollTopBeforePrint=null},beforePaperManipulation:function(){(mn.test("msie")||mn.test("msedge"))&&this.$el.css("visibility","hidden")},afterPaperManipulation:function(){(mn.test("msie")||mn.test("msedge"))&&this.$el.css("visibility","visible")},clientToLocalPoint:function(t,e){var n=this.options.paper.matrix();return t+=this.el.scrollLeft-this._padding.left-n.e,t/=n.a,e+=this.el.scrollTop-this._padding.top-n.f,e/=n.d,new L(t,e)},localToBackgroundPoint:function(t,e){var n=new L(t,e),i=this.options.paper.matrix(),r=this._padding;return Mt.transformPoint(n,i).offset(r.left,r.top)},adjustPaper:function(){var t=this.getClientSize();this._center=this.clientToLocalPoint(t.width/2,t.height/2);var e=this.options.contentOptions;"function"==typeof e&&(e=e.call(this,this));var n=Jt({gridWidth:this.options.baseWidth,gridHeight:this.options.baseHeight,allowNewOrigin:"negative"},e);return this.options.paper.fitToContent(this.transformContentOptions(n)),this},adjustScale:function(t,e){var n=this.options.paper.options,i=t/this._sx,r=e/this._sy;this.options.paper.setOrigin(n.origin.x*i,n.origin.y*r),this.options.paper.setDimensions(n.width*i,n.height*r)},transformContentOptions:function(t){var e=this._sx,n=this._sy;return t.gridWidth&&(t.gridWidth*=e),t.gridHeight&&(t.gridHeight*=n),t.minWidth&&(t.minWidth*=e),t.minHeight&&(t.minHeight*=n),De(t.padding)?t.padding={left:(t.padding.left||0)*e,right:(t.padding.right||0)*e,top:(t.padding.top||0)*n,bottom:(t.padding.bottom||0)*n}:St(t.padding)&&(t.padding=t.padding*e),t},center:function(t,e,n){var i,r=this.options.paper.matrix(),o=-r.e,s=-r.f,a=o+this.options.paper.options.width,l=s+this.options.paper.options.height,c=St(t),u=St(e);if(c||u){i=n;var h=this.getVisibleArea().center();c?t*=r.a:t=h.x,u?e*=r.d:e=h.y}else i=t,t=(o+a)/2,e=(s+l)/2;var d=this.getClientSize(),f=this.getPadding(),p=d.width/2,g=d.height/2,m=p-f.left-t+o,v=p-f.right+t-a,y=g-f.top-e+s,b=g-f.bottom+e-l;return this.addPadding(Math.max(m,0),Math.max(v,0),Math.max(y,0),Math.max(b,0)),this.scroll(t,e,i),this},centerContent:function(t){return this.positionContent("center",t)},centerElement:function(t,e){return this.checkElement(t,"centerElement"),this.positionElement(t,"center",e)},positionContent:function(t,e){var n=this.options.paper.getContentArea();return this.positionRect(n,t,e)},positionElement:function(t,e,n){this.checkElement(t,"positionElement");var i=t.getBBox();return this.positionRect(i,e,n)},positionRect:function(t,e,n){var i;switch(e){case"center":return i=t.center(),this.positionPoint(i,"50%","50%",n);case"top":return i=t.topMiddle(),this.positionPoint(i,"50%",0,n);case"top-right":return i=t.topRight(),this.positionPoint(i,"100%",0,n);case"right":return i=t.rightMiddle(),this.positionPoint(i,"100%","50%",n);case"bottom-right":return i=t.bottomRight(),this.positionPoint(i,"100%","100%",n);case"bottom":return i=t.bottomMiddle(),this.positionPoint(i,"50%","100%",n);case"bottom-left":return i=t.bottomLeft(),this.positionPoint(i,0,"100%",n);case"left":return i=t.leftMiddle(),this.positionPoint(i,0,"50%",n);case"top-left":return i=t.topLeft(),this.positionPoint(i,0,0,n);default:throw new Error("Provided positionName ('"+e+"') was not recognized.")}},positionPoint:function(t,e,n,i){var r=Ft((i=i||{}).padding),o=new B(this.getClientSize()),s=o.clone().moveAndExpand({x:r.left,y:r.top,width:-r.right-r.left,height:-r.top-r.bottom}),a=jt(e);e=parseFloat(e),a&&(e=e/100*Math.max(0,s.width)),e<0&&(e=s.width+e);var l=jt(n);n=parseFloat(n),l&&(n=n/100*Math.max(0,s.height)),n<0&&(n=s.height+n);var c=s.origin().offset(e,n),u=o.center().difference(c),h=this.zoom(),d=u.scale(1/h,1/h),f=t.clone().offset(d);return this.center(f.x,f.y,i)},scroll:function(t,e,n){var i=this.options.paper.matrix(),r=this.getClientSize(),o={};if(St(t)){var s=r.width/2;o.scrollLeft=t-s+i.e+(this._padding.left||0)}if(St(e)){var a=r.height/2;o.scrollTop=e-a+i.f+(this._padding.top||0)}n&&n.animation?this.$el.animate(o,n.animation):this.$el.prop(o)},scrollToContent:function(t){var e=this.options.paper.getContentArea().center(),n=this._sx,i=this._sy;return e.x*=n,e.y*=i,this.scroll(e.x,e.y,t)},scrollToElement:function(t,e){this.checkElement(t,"scrollToElement");var n=t.getBBox().center(),i=this._sx,r=this._sy;return n.x*=i,n.y*=r,this.scroll(n.x,n.y,e)},addPadding:function(t,e,n,i){var r=this.getPadding(),o=this._padding={left:Math.round(r.left+(t||0)),top:Math.round(r.top+(n||0)),bottom:Math.round(r.bottom+(i||0)),right:Math.round(r.right+(e||0))};return this.$background.css({width:o.left+this.options.paper.options.width+o.right,height:o.top+this.options.paper.options.height+o.bottom}),this.options.paper.$el.css({left:o.left,top:o.top}),this},zoom:function(t,e){if(void 0===t)return this._sx;e=e||{};var n,i,r=this.getClientSize(),o=this.clientToLocalPoint(r.width/2,r.height/2),s=t,a=t;if(e.absolute||(s+=this._sx,a+=this._sy),e.grid&&(s=Math.round(s/e.grid)*e.grid,a=Math.round(a/e.grid)*e.grid),e.max&&(s=Math.min(e.max,s),a=Math.min(e.max,a)),e.min&&(s=Math.max(e.min,s),a=Math.max(e.min,a)),void 0===e.ox||void 0===e.oy)n=o.x,i=o.y;else{var l=s/this._sx,c=a/this._sy;n=e.ox-(e.ox-o.x)/l,i=e.oy-(e.oy-o.y)/c}return this.beforePaperManipulation(),this.options.paper.scale(s,a),this.center(n,i),this.afterPaperManipulation(),this},zoomToRect:function(t,e){void 0===e&&(e={}),t=new B(t);var n=this.options.paper,i=Jt({},n.options.origin);e.fittingBBox=e.fittingBBox||Jt({},new L(i),{width:this.$el.width(),height:this.$el.height()}),e.contentArea=t,this.beforePaperManipulation(),n.scaleContentToFit(e);var r=t.center();return this.center(r.x,r.y),this.afterPaperManipulation(),this},zoomToFit:function(t){void 0===t&&(t={});var e=this.options.paper.getContentArea(t);return this.zoomToRect(e,t),this},transitionClassName:"transition-in-progress",transitionEventName:"transitionend.paper-scroller-transition",transitionToPoint:function(t,e,n){De(t)&&(n=e,e=t.y,t=t.x),n=n||{};var i,r,o=this._sx,s=Math.max(n.scale||o,1e-6),a=this.getClientSize(),l=new L(t,e),c=this.clientToLocalPoint(a.width/2,a.height/2);if(o===s){var u=c.difference(l).scale(o,o).round();i="translate("+u.x+"px,"+u.y+"px)"}else{var h=s/(o-s)*l.distance(c),d=c.clone().move(l,h),f=this.localToBackgroundPoint(d).round();i="scale("+s/o+")",r=f.x+"px "+f.y+"px"}return this.$el.addClass(this.transitionClassName),this.$background.off(this.transitionEventName).on(this.transitionEventName,(function(t){var e=this.paperScroller;e.syncTransition(this.scale,{x:this.x,y:this.y});var n=this.onTransitionEnd;le(n)&&n.call(e,t)}).bind({paperScroller:this,scale:s,x:t,y:e,onTransitionEnd:n.onTransitionEnd})).css({transition:"transform",transitionDuration:n.duration||"1s",transitionDelay:n.delay,transitionTimingFunction:n.timingFunction,transformOrigin:r,transform:i}),this},syncTransition:function(t,e){return this.beforePaperManipulation(),this.options.paper.scale(t),this.removeTransition().center(e.x,e.y),this.afterPaperManipulation(),this},removeTransition:function(){return this.$el.removeClass(this.transitionClassName),this.$background.off(this.transitionEventName).css({transition:"",transitionDuration:"",transitionDelay:"",transitionTimingFunction:"",transform:"",transformOrigin:""}),this},transitionToRect:function(t,e){void 0===e&&(e={}),t=new B(t);var n=e.maxScale||1/0,i=e.minScale||Number.MIN_VALUE,r=e.scaleGrid||null,o=e.visibility||1,s=e.center?new L(e.center):t.center(),a=this.getClientSize(),l=a.width*o,c=a.height*o,u=new B({x:s.x-l/2,y:s.y-c/2,width:l,height:c}).maxRectUniformScaleToFit(t,s);return u=Math.min(u,n),r&&(u=Math.floor(u/r)*r),u=Math.max(i,u),this.transitionToPoint(s,Qt({scale:u},e)),this},startPanning:function(t){t=vt(t),this._clientX=t.clientX,this._clientY=t.clientY,this.$el.addClass("is-panning"),this.trigger("pan:start",t),i(document.body).on({"mousemove.panning touchmove.panning":this.pan,"mouseup.panning touchend.panning":this.stopPanning}),i(window).on("mouseup.panning",this.stopPanning)},pan:function(t){var e=(t=vt(t)).clientX-this._clientX,n=t.clientY-this._clientY;this.el.scrollTop-=n,this.el.scrollLeft-=e,this._clientX=t.clientX,this._clientY=t.clientY},stopPanning:function(t){i(document.body).off(".panning"),i(window).off(".panning"),this.$el.removeClass("is-panning"),this.trigger("pan:stop",t)},getClientSize:function(){return{width:this.el.clientWidth,height:this.el.clientHeight}},getPadding:function(){var t=this.options.padding;return le(t)&&(t=t.call(this)),Ft(t)},getVisibleArea:function(){var t=this.options.paper.matrix(),e=this.getClientSize(),n={x:this.el.scrollLeft||0,y:this.el.scrollTop||0,width:e.width,height:e.height},i=Mt.transformRect(n,t.inverse());return i.x-=(this._padding.left||0)/this._sx,i.y-=(this._padding.top||0)/this._sy,new B(i)},isElementVisible:function(t,e){this.checkElement(t,"isElementVisible");var n=(e=e||{}).strict?"containsRect":"intersect";return!!this.getVisibleArea()[n](t.getBBox())},isPointVisible:function(t){return this.getVisibleArea().containsPoint(t)},checkElement:function(t,e){if(!(t&&t instanceof un))throw new TypeError("ui.PaperScroller."+e+"() accepts instance of dia.Element only")},onRemove:function(){this.stopPanning()}});mn.addTest("msie",function(){var t=window.navigator.userAgent;return-1!==t.indexOf("MSIE")||-1!==t.indexOf("Trident")}),mn.addTest("msedge",function(){return/Edge\/\d+/.test(window.navigator.userAgent)});var oa=dn.extend({tagName:"g",svgElement:!0,className:"path-drawer",events:{"mousedown .start-point":"onStartPointPointerDown",mousedown:"onPointerDown","touchstart .start-point":"onStartPointPointerDown",touchstart:"onPointerDown",dblclick:"onDoubleClick",contextmenu:"onContextMenu"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{pathAttributes:{class:null,fill:"#ffffff",stroke:"#000000","stroke-width":1,"pointer-events":"none"},startPointMarkup:'<circle r="5"/>',snapRadius:0},init:function(){var t=this.svgTarget=Mt(this.options.target);this.$document=i(t.node.ownerDocument),this.action="awaiting-input",this.render()},onRemove:function(){var t=this.pathNode;t&&Mt(t).remove(),this.clear()},clear:function(){var t=this.pathNode;t&&t.pathSegList.numberOfItems<=1&&Mt(t).remove(),this.svgStart.remove(),this.svgControl.remove(),this.pathNode=null,this.undelegateDocumentEvents(),this.action="awaiting-input",this.trigger("clear")},render:function(){var t=this.options;return this.svgPathTemplate=Mt("path").attr(t.pathAttributes),this.svgStart=Mt(t.startPointMarkup).addClass("start-point"),this.svgControl=Mt("path").addClass("control-path"),this.vel.append(Mt("rect",{x:0,y:0,width:"100%",height:"100%",fill:"transparent",stroke:"none"})),this.svgTarget.append(this.el),this},createPath:function(t,e){var n=this.svgPathTemplate.clone(),i=this.pathNode=n.node,r=this.svgStart.translate(t,e,{absolute:!0});this.trigger("path:create",i),this.addMoveSegment(t,e),this.vel.before(n),this.vel.append(r)},closePath:function(){var t=this.pathNode,e=t.pathSegList.getItem(0),n=t.pathSegList.getItem(t.pathSegList.numberOfItems-1);n.pathSegType==SVGPathSeg.PATHSEG_LINETO_ABS?t.pathSegList.replaceItem(t.createSVGPathSegClosePath(),t.pathSegList.numberOfItems-1):(n.x=e.x,n.y=e.y,t.pathSegList.appendItem(t.createSVGPathSegClosePath())),this.finishPath("path:close")},finishPath:function(t){var e=this.pathNode;e&&0<this.numberOfVisibleSegments()?(this.trigger("path:finish",e),this.trigger(t,e)):this.trigger("path:abort",e),this.clear()},numberOfVisibleSegments:function(){var t=this.pathNode,e=t.pathSegList.numberOfItems;return e-=1,t.pathSegList.getItem(t.pathSegList.numberOfItems-1).pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH&&(e-=1),e},addMoveSegment:function(t,e){var n=this.pathNode,i=n.createSVGPathSegMovetoAbs(t,e);n.pathSegList.appendItem(i),this.trigger("path:segment:add",n),this.trigger("path:move-segment:add",n)},addLineSegment:function(t,e){var n=this.pathNode,i=n.createSVGPathSegLinetoAbs(t,e);n.pathSegList.appendItem(i),this.trigger("path:segment:add",n),this.trigger("path:line-segment:add",n)},addCurveSegment:function(t,e,n,i,r,o){var s=this.pathNode,a=s.createSVGPathSegCurvetoCubicAbs(t,e,n,i,r||t,o||e);s.pathSegList.appendItem(a),this.trigger("path:segment:add",s),this.trigger("path:curve-segment:add",s)},adjustLastSegment:function(t,e,n,i,r,o){var s=this.pathNode,a=this.options.snapRadius;if(a){var l=this.snapLastSegmentCoordinates(t,e,a);t=l.x,e=l.y}var c=s.pathSegList.getItem(s.pathSegList.numberOfItems-1);null!==t&&(c.x=t),null!==e&&(c.y=e),null!==n&&(c.x1=n),null!==i&&(c.y1=i),null!==r&&(c.x2=r),null!==o&&(c.y2=o),this.trigger("path:edit",s),this.trigger("path:last-segment:adjust",s)},snapLastSegmentCoordinates:function(t,e,n){for(var i=this.pathNode,r=!1,o=!1,s=t,a=e,l=i.pathSegList.numberOfItems-2;0<=l&&(!r||!o);l--){var c=i.pathSegList.getItem(l),u=c.x,h=c.y;!r&&Math.abs(u-t)<n&&(s=u,r=!0),!o&&Math.abs(h-e)<n&&(a=h,o=!0)}return new L(s,a)},removeLastSegment:function(){var t=this.pathNode;t.pathSegList.removeItem(t.pathSegList.numberOfItems-1),this.trigger("path:edit",t),this.trigger("path:last-segment:remove",t)},findControlPoint:function(t,e){var n=this.pathNode,i=n.pathSegList.getItem(n.pathSegList.numberOfItems-1);return W(t,e).reflection(i)},replaceLastSegmentWithCurve:function(){var t=this.pathNode,e=t.pathSegList.getItem(t.pathSegList.numberOfItems-1),n=t.pathSegList.getItem(t.pathSegList.numberOfItems-2),i=t.createSVGPathSegCurvetoCubicAbs(e.x,e.y,n.x,n.y,e.x,e.y);t.pathSegList.replaceItem(i,t.pathSegList.numberOfItems-1),this.trigger("path:edit",t),this.trigger("path:last-segment:replace-with-curve",t)},adjustControlPath:function(t,e,n,i){var r=this.pathNode,o=this.svgControl.node;o.pathSegList.initialize(o.createSVGPathSegMovetoAbs(t,e)),o.pathSegList.appendItem(o.createSVGPathSegLinetoAbs(n,i)),this.vel.append(o),this.trigger("path:interact",r),this.trigger("path:control:adjust",r)},removeControlPath:function(){var t=this.pathNode,e=this.svgControl.node;e.pathSegList.clear(),this.vel.append(e),this.trigger("path:interact",t),this.trigger("path:control:remove",t)},onPointerDown:function(t){var e=vt(t);if(e.stopPropagation(),!(1<e.which)&&!(1<e.originalEvent.detail)&&this.el.parentNode){var n=this.vel.toLocalPoint(e.clientX,e.clientY);switch(this.action){case"awaiting-input":this.createPath(n.x,n.y),this.action="path-created",this.delegateDocumentEvents();break;case"adjusting-line-end":this.action="awaiting-line-end";break;case"adjusting-curve-end":this.action="awaiting-curve-control-2"}this._timeStamp=e.timeStamp}},MOVEMENT_DETECTION_THRESHOLD:150,onPointerMove:function(t){var e=vt(t);if(e.stopPropagation(),"awaiting-input"!=this.action){var n,i,r=this.vel.toLocalPoint(e.clientX,e.clientY),o=this._timeStamp;if(o)if(o&&e.timeStamp-o<this.MOVEMENT_DETECTION_THRESHOLD)switch(this.action){case"path-created":n=this.svgStart.translate(),this.adjustControlPath(n.tx,n.ty,r.x,r.y);break;case"awaiting-line-end":case"adjusting-curve-control-1":this.adjustLastSegment(r.x,r.y);break;case"awaiting-curve-control-2":this.adjustLastSegment(r.x,r.y,null,null,r.x,r.y)}else switch(this.action){case"path-created":this.action="adjusting-curve-control-1";break;case"awaiting-line-end":this.replaceLastSegmentWithCurve(),this.action="adjusting-curve-control-2";break;case"awaiting-curve-control-2":this.action="adjusting-curve-control-2";break;case"adjusting-curve-control-1":n=this.svgStart.translate(),this.adjustControlPath(n.tx,n.ty,r.x,r.y);break;case"adjusting-curve-control-2":i=this.findControlPoint(r.x,r.y),this.adjustLastSegment(null,null,null,null,i.x,i.y),this.adjustControlPath(i.x,i.y,r.x,r.y)}else switch(this.action){case"adjusting-line-end":this.adjustLastSegment(r.x,r.y);break;case"adjusting-curve-end":this.adjustLastSegment(r.x,r.y,null,null,r.x,r.y)}}},onPointerUp:function(t){this._timeStamp=null;var e=vt(t);if(e.stopPropagation(),!(1<e.which||1<e.originalEvent.detail)){var n=this.vel.toLocalPoint(e.clientX,e.clientY);switch(this.action){case"path-created":case"awaiting-line-end":this.addLineSegment(n.x,n.y),this.action="adjusting-line-end";break;case"awaiting-curve-control-2":this.removeControlPath(),this.addLineSegment(n.x,n.y),this.action="adjusting-line-end";break;case"adjusting-curve-control-1":case"adjusting-curve-control-2":this.addCurveSegment(n.x,n.y,n.x,n.y),this.action="adjusting-curve-end"}}},onStartPointPointerDown:function(t){var e=vt(t);e.stopPropagation(),1<e.which||1<e.originalEvent.detail||this.closePath()},onDoubleClick:function(t){var e=vt(t);e.preventDefault(),e.stopPropagation(),1<e.which||this.pathNode&&0<this.numberOfVisibleSegments()&&(this.removeLastSegment(),this.finishPath("path:stop"))},onContextMenu:function(t){var e=vt(t);e.preventDefault(),e.stopPropagation(),1<e.originalEvent.detail||this.pathNode&&0<this.numberOfVisibleSegments()&&(this.removeLastSegment(),this.finishPath("path:stop"))}}),sa=dn.extend({tagName:"g",svgElement:!0,className:"path-editor",events:{"mousedown .anchor-point":"onAnchorPointPointerDown","mousedown .control-point":"onControlPointPointerDown","mousedown .segment-path":"onSegmentPathPointerDown","touchstart .anchor-point":"onAnchorPointPointerDown","touchstart .control-point":"onControlPointPointerDown","touchstart .segment-path":"onSegmentPathPointerDown","dblclick .anchor-point":"onAnchorPointDoubleClick","dblclick .control-point":"onControlPointDoubleClick","dblclick .segment-path":"onSegmentPathDoubleClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{anchorPointMarkup:'<circle r="2.5"/>',controlPointMarkup:'<circle r="2.5"/>'},init:function(){var t=this.pathNode=Mt(this.options.pathElement).normalizePath().node;this.segList=t.pathSegList,this.svgRoot=Mt(t.ownerSVGElement),this.$document=i(t.ownerDocument),this.render()},onRemove:function(){this.undelegateDocumentEvents(),this.clear()},clear:function(){this.vel.empty(),this.directionPaths=[],this.segmentPaths=[],this.controlPoints=[],this.anchorPoints=[],this._subPathIndices=[0],this.trigger("clear",this.pathNode)},_transformPoint:function(t,e,n){return Mt.transformPoint(new L(t,e),n)},_getPathCTM:function(){return this.pathNode.getCTM()},render:function(){this.clear();var t,e,n,i=this.vel,r=this._getPathCTM(),o=Mt(this.options.anchorPointMarkup).addClass("anchor-point"),s=Mt(this.options.controlPointMarkup).addClass("control-point"),a=Mt('<path class="direction-path"/>'),l=Mt('<path class="segment-path"/>'),c=this.segList,u=this.anchorPoints,h=this.controlPoints,d=this.directionPaths,f=this.segmentPaths,p=this._subPathIndices;for(n=e=t=0;t<c.numberOfItems;t++){var g=c.getItem(t),m=this._transformPoint(g.x,g.y,r),v=m.x,y=m.y;if(g.pathSegType!=SVGPathSeg.PATHSEG_CLOSEPATH&&(u[t]=o.clone().attr({index:t,cx:v,cy:y})),g.pathSegType!=SVGPathSeg.PATHSEG_MOVETO_ABS){var b=l.clone().attr("index",t).node;switch(b.pathSegList.initialize(b.createSVGPathSegMovetoAbs(e,n)),g.pathSegType){case SVGPathSeg.PATHSEG_CLOSEPATH:var C=c.getItem(p[0]),I=this._transformPoint(C.x,C.y,r);v=I.x,y=I.y,b.pathSegList.appendItem(b.createSVGPathSegLinetoAbs(v,y)),p.unshift(t+1);break;case SVGPathSeg.PATHSEG_LINETO_ABS:b.pathSegList.appendItem(b.createSVGPathSegLinetoAbs(v,y));break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:var E=this._transformPoint(g.x1,g.y1,r),T=s.clone().attr({index:t,"attribute-index":1,cx:E.x,cy:E.y}),w=this._transformPoint(g.x2,g.y2,r),x=s.clone().attr({index:t,"attribute-index":2,cx:w.x,cy:w.y});h[t]=[T,x],b.pathSegList.appendItem(b.createSVGPathSegCurvetoCubicAbs(v,y,E.x,E.y,w.x,w.y)),d[t]=[a.clone().attr("d",["M",e,n,"L",E.x,E.y].join(" ")),a.clone().attr("d",["M",v,y,"L",w.x,w.y].join(" "))]}f[t]=b}e=v,n=y}var _=[];f.forEach(function(t){t&&_.push(t)}),d.forEach(function(t){t&&Array.prototype.push.apply(_,t)}),u.forEach(function(t){t&&_.push(t)}),h.forEach(function(t){t&&Array.prototype.push.apply(_,t)}),i.append(_),this.svgRoot.append(i)},startMoving:function(t){var e=vt(t),n=this.$point=i(e.target);this.prevClientX=e.clientX,this.prevClientY=e.clientY;var r=parseInt(this.$point.attr("index"),10);if(this.trigger("path:interact"),n.hasClass("anchor-point"))this.trigger("path:anchor-point:select",r);else if(n.hasClass("control-point")){var o=parseInt(this.$point.attr("attribute-index"),10);this.trigger("path:control-point:select",r,o)}else this.trigger("path:segment:select",r);e.stopPropagation(),e.preventDefault(),this.index=void 0,this.controlPointIndex=void 0,this.segPoint=void 0,this.pathEditedEventType=void 0},move:function(t){var e=this.$point;if(e){var n=vt(t),i=n.clientX-this.prevClientX,r=n.clientY-this.prevClientY,o=parseInt(e.attr("index"),10);if(e.hasClass("anchor-point"))this.adjustAnchorPoint(o,i,r,n);else if(e.hasClass("control-point")){var s=parseInt(e.attr("attribute-index"),10);this.adjustControlPoint(o,s,i,r,n)}else this.adjustSegment(o,i,r,n);this.prevClientX=n.clientX,this.prevClientY=n.clientY}},adjustSegment:function(t,e,n,i,r){void 0===r&&(r={});var o=r.dry;void 0===o&&(o=void 0),this.adjustAnchorPoint(t-1,e,n,{dry:!0}),this.adjustAnchorPoint(t,e,n,{dry:!0}),o||(this.pathEditedEventType="path:segment:adjust",this.index=t,this.trigger("path:editing",this.pathNode,i),this.trigger("path:segment:adjusting",this.pathNode,i,{index:t}))},adjustControlPoint:function(t,e,n,i,r,o){void 0===o&&(o={});var s=o.dry;void 0===s&&(s=void 0);var a=this._getPathCTM(),l=this.segList,c=l.getItem(t),u=this.controlPoints,h=a.inverse();h.e=0,h.f=0;var d=this._transformPoint(n,i,h),f="x"+e,p="y"+e;c[f]+=d.x,c[p]+=d.y;var g=this._transformPoint(c[f],c[p],a),m=new L(g);if(u[t][e-1].attr({cx:g.x,cy:g.y}).hasClass("locked")){var v=this.getBoundIndex(t,e),y=1===e?2:1,b=l.getItem(v),C="x"+y,I="y"+y,E=new L(1===e?b.x:c.x,1===e?b.y:c.y),T=new L(c[f],c[p]),w=E.distance(new L(b[C],b[I])),x=E.move(T,w);b[C]=x.x,b[I]=x.y;var _=this._transformPoint(b[C],b[I],a);u[v][y-1].attr({cx:_.x,cy:_.y}),this.updateDirectionPaths(v),this.updateSegmentPath(v)}this.updateDirectionPaths(t),this.updateSegmentPath(t),s||(this.pathEditedEventType="path:control-point:adjust",this.index=t,this.controlPointIndex=e,this.segPoint=m,this.trigger("path:editing",this.pathNode,r),this.trigger("path:control-point:adjusting",this.pathNode,r,{index:t,controlPointIndex:e,segPoint:m}))},findSubpathIndex:function(t){for(var e=this._subPathIndices,n=0,i=e.length;n<i;n++)if(e[n]<t)return e[n]},findReversedSubpathIndex:function(t){for(var e=this._subPathIndices,n=e.length-1;0<=n;n--)if(e[n]>t)return e[n]},adjustAnchorPoint:function(t,e,n,i,r){void 0===r&&(r={});var o=r.dry;void 0===o&&(o=void 0);var s=this._getPathCTM(),a=this.segList,l=a.getItem(t);l.pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH&&(t=this.findSubpathIndex(t),l=a.getItem(t));var c=this.anchorPoints,u=this.controlPoints,h=c.length-1;if((0===t||t===h)&&u[1]&&u[h]){var d=u[1][0],f=u[h][1];d&&d.hasClass("locked")&&d.removeClass("locked"),f&&f.hasClass("locked")&&f.removeClass("locked")}var p=s.inverse();p.e=0,p.f=0;var g=this._transformPoint(e,n,p);l.x+=g.x,l.y+=g.y;var m=this._transformPoint(l.x,l.y,s),v=new L(m);if(c[t].attr({cx:m.x,cy:m.y}),l.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS){l.x2+=g.x,l.y2+=g.y;var y=this._transformPoint(l.x2,l.y2,s);u[t][1].attr({cx:y.x,cy:y.y})}var b=t+1<a.numberOfItems?a.getItem(t+1):0;if(b){if(b.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS){b.x1+=g.x,b.y1+=g.y;var C=this._transformPoint(b.x1,b.y1,s);u[t+1][0].attr({cx:C.x,cy:C.y}),this.updateDirectionPaths(t+1)}this.updateSegmentPath(t+1)}this.updateDirectionPaths(t),this.updateSegmentPath(t),o||(this.pathEditedEventType="path:anchor-point:adjust",this.index=t,this.segPoint=v,this.trigger("path:editing",this.pathNode,i),this.trigger("path:anchor-point:adjusting",this.pathNode,i,{index:t,segPoint:v}))},updateDirectionPaths:function(t){var e=this._getPathCTM(),n=this.segList,i=n.getItem(t),r=this._transformPoint(i.x,i.y,e),o=0<t?n.getItem(t-1):null,s=o?this._transformPoint(o.x,o.y,e):null,a=this.directionPaths[t];Array.isArray(a)&&a.forEach(function(t,n){n++;var a=this._transformPoint(i["x"+n],i["y"+n],e);t.attr("d",["M",1<n||!o?r.x:s.x,1<n||!o?r.y:s.y,a.x,a.y].join(" "))},this)},updateSegmentPath:function(t){var e=this.segList;if(this._subPathIndices.includes(t)){var n=this.findReversedSubpathIndex(t)||e.numberOfItems;if(n--,e.getItem(n).pathSegType!=SVGPathSeg.PATHSEG_CLOSEPATH)return;t=n}var i=this.segmentPaths[t];if(i){var r=this._getPathCTM(),o=e.getItem(t-1),s=this._transformPoint(o.x,o.y,r),a=i.createSVGPathSegMovetoAbs(s.x,s.y);i.pathSegList.initialize(a);var l=e.getItem(t),c=this._transformPoint(l.x,l.y,r);switch(l.pathSegType){case SVGPathSeg.PATHSEG_CLOSEPATH:var u=e.getItem(this.findSubpathIndex(t)),h=this._transformPoint(u.x,u.y,r);a=i.createSVGPathSegLinetoAbs(h.x,h.y);break;case SVGPathSeg.PATHSEG_LINETO_ABS:a=i.createSVGPathSegLinetoAbs(c.x,c.y);break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:var d=this._transformPoint(l.x1,l.y1,r),f=this._transformPoint(l.x2,l.y2,r);a=i.createSVGPathSegCurvetoCubicAbs(c.x,c.y,d.x,d.y,f.x,f.y)}i.pathSegList.appendItem(a)}},stopMoving:function(t){var e=vt(t);if(this.$point=void 0,this.pathEditedEventType){var n=this.pathNode,i=this.index,r=this.controlPointIndex,o=this.segPoint;this.trigger("path:edit",n,e),this.trigger(this.pathEditedEventType,n,e,{index:i,controlPointIndex:r,segPoint:o})}this.index=void 0,this.controlPointIndex=void 0,this.segPoint=void 0,this.pathEditedEventType=void 0},createAnchorPoint:function(t){var e=vt(t),n=Mt(e.target).attr("index"),i=this.pathNode,r=this.segList,o=Mt(i).toLocalPoint(e.pageX,e.pageY),s=r.getItem(n),a=r.getItem(n-1);switch(s.pathSegType){case SVGPathSeg.PATHSEG_CLOSEPATH:var l=r.getItem(0),c=new L(a.x,a.y),u=new L(l.x,l.y),h=new M(c,u).closestPoint(o);r.insertItemBefore(i.createSVGPathSegLinetoAbs(h.x,h.y),n);break;case SVGPathSeg.PATHSEG_LINETO_ABS:var d=new L(a.x,a.y),f=new L(s.x,s.y),p=new M(d,f).closestPoint(o);r.insertItemBefore(i.createSVGPathSegLinetoAbs(p.x,p.y),n);break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:var g=new L(a.x,a.y),m=new L(s.x1,s.y1),v=new L(s.x2,s.y2),y=new L(s.x,s.y),b=new R(g,m,v,y),C=b.closestPointT(o),I=b.divideAtT(C);r.insertItemBefore(i.createSVGPathSegCurvetoCubicAbs(I[0].end.x,I[0].end.y,I[0].controlPoint1.x,I[0].controlPoint1.y,I[0].controlPoint2.x,I[0].controlPoint2.y),n),s.x1=I[1].controlPoint1.x,s.y1=I[1].controlPoint1.y,s.x2=I[1].controlPoint2.x,s.y2=I[1].controlPoint2.y}this.render(),this.trigger("path:edit",i,e),this.trigger("path:anchor-point:create",i,e)},removeAnchorPoint:function(t){var e,n,r=vt(t),o=parseInt(i(r.target).attr("index"),10),s=this.pathNode,a=this.segList,l=a.getItem(o);switch(l.pathSegType){case SVGPathSeg.PATHSEG_MOVETO_ABS:e=a.getItem(o+1),n=s.createSVGPathSegMovetoAbs(e.x,e.y),a.replaceItem(n,o+1),a.removeItem(o);break;case SVGPathSeg.PATHSEG_LINETO_ABS:a.removeItem(o);break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:o+1<=a.numberOfItems-1&&(e=a.getItem(o+1)).pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS&&(e.x1=l.x1,e.y1=l.y1),a.removeItem(o)}this.render(),this.trigger("path:edit",s,r),this.trigger("path:anchor-point:remove",s,r);var c=a.numberOfItems;a.getItem(a.numberOfItems-1).pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH&&(c-=1),c<2&&this.trigger("path:invalid",s,r)},lockControlPoint:function(t){var e=vt(t),n=i(e.target),r=parseInt(n.attr("index")),o=parseInt(n.attr("attribute-index"),10),s=this.getBoundIndex(r,o),a=1===o?2:1,l=this.controlPoints[s];if(l){var c=n.hasClass("locked");n.toggleClass("locked"),l[a-1].toggleClass("locked"),this.trigger("path:interact"),c?this.trigger("path:control-point:unlock",r,o):(this.trigger("path:control-point:lock",r,o),this.adjustControlPoint(r,o,0,0,{dry:!0}))}},getBoundIndex:function(t,e){var n,i,r,o,s,a=this.segList,l=this.anchorPoints,c=l.length-1;return 1===e?0==(n=t-1)&&(i=a.numberOfItems-1,r=a.getItem(i).pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH,o=l[0].attr("cx")===l[c].attr("cx"),s=l[0].attr("cy")===l[c].attr("cy"),r&&o&&s&&(n=c)):(n=t+1)===1+c&&(i=a.numberOfItems-1,r=a.getItem(i).pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH,o=l[0].attr("cx")===l[c].attr("cx"),s=l[0].attr("cy")===l[c].attr("cy"),r&&o&&s&&(n=1)),n},getControlPointLockedStates:function(){for(var t=this.controlPoints,e=[],n=0;n<t.length;n++)if(t[n]){e[n]=[];for(var i=0;i<=1;i++)if(t[n][i]){var r=i+1;t[n][i].hasClass("locked")?e[n][r]=!0:e[n][r]=!1}}return e},setControlPointLockedStates:function(t){for(var e=this.controlPoints,n=0;n<e.length;n++)if(t[n]&&e[n])for(var i=1;i<=2;i++)t[n][i]&&e[n][i-1]&&(!0===t[n][i]?e[n][i-1].addClass("locked"):e[n][i-1].removeClass("locked"))},convertSegmentPath:function(t){var e=vt(t),n=Mt(e.target).attr("index"),i=this.pathNode,r=this.segList,o=r.getItem(n);switch(o.pathSegType){case SVGPathSeg.PATHSEG_CLOSEPATH:var s=r.getItem(n-1),a=r.getItem(0);r.insertItemBefore(i.createSVGPathSegCurvetoCubicAbs(a.x,a.y,s.x,s.y,a.x,a.y),n);break;case SVGPathSeg.PATHSEG_LINETO_ABS:var l=r.getItem(n-1);r.replaceItem(i.createSVGPathSegCurvetoCubicAbs(o.x,o.y,l.x,l.y,o.x,o.y),n);break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:r.replaceItem(i.createSVGPathSegLinetoAbs(o.x,o.y),n)}this.render(),this.trigger("path:edit",i,e),this.trigger("path:segment:convert",i,e)},addClosePathSegment:function(t){var e=vt(t),n=parseInt(i(e.target).attr("index"),10),r=this.segList;if((0===n||n===r.numberOfItems-1)&&r.getItem(r.numberOfItems-1).pathSegType!=SVGPathSeg.PATHSEG_CLOSEPATH){var o=this.pathNode;r.appendItem(o.createSVGPathSegClosePath()),this.render(),this.trigger("path:edit",o,e),this.trigger("path:closepath-segment:add",o,e)}},removeClosePathSegment:function(t){var e=vt(t),n=Mt(e.target).attr("index"),i=this.segList;if(i.getItem(n).pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH){var r=this.pathNode;i.removeItem(n),this.render(),this.trigger("path:edit",r,e),this.trigger("path:closepath-segment:remove",r,e)}},isMoreThanFirstClick:function(){return this.clickCounter=this.clickCounter||0,this.clickCounter+=1,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){this.clickCounter=0},400),2<=this.clickCounter&&(this.clickCounter=0,clearTimeout(this.timeout),!0)},onAnchorPointPointerDown:function(t){var e=vt(t);e.stopPropagation(),1===e.which&&(this.isMoreThanFirstClick()||(this.startMoving(e),this.delegateDocumentEvents()))},onControlPointPointerDown:function(t){var e=vt(t);e.stopPropagation(),1===e.which&&(this.isMoreThanFirstClick()||(this.startMoving(e),this.delegateDocumentEvents()))},onSegmentPathPointerDown:function(t){var e=vt(t);e.stopPropagation(),1===e.which&&(this.isMoreThanFirstClick()||(this.startMoving(e),this.delegateDocumentEvents()))},onPointerMove:function(t){var e=vt(t);e.stopPropagation(),this.move(e)},onPointerUp:function(t){this.undelegateDocumentEvents();var e=vt(t);e.stopPropagation(),this.stopMoving(e)},onAnchorPointDoubleClick:function(t){var e=vt(t);e.stopPropagation(),e.preventDefault(),1===e.which&&this.removeAnchorPoint(e)},onControlPointDoubleClick:function(t){var e=vt(t);e.stopPropagation(),e.preventDefault(),1===e.which&&this.lockControlPoint(e)},onSegmentPathDoubleClick:function(t){var e=vt(t);e.stopPropagation(),e.preventDefault(),1===e.which&&this.createAnchorPoint(e)}}),aa=zs.extend({className:"popup",eventNamespace:"popup",events:{},renderContent:function(){var t=le(this.options.content)?this.options.content(this.el):this.options.content;t&&this.$el.html(t)}}),la=dn.extend({options:{paper:void 0,graph:void 0,boxContent:function(t){return Wt("<%= length %> elements selected.")({length:this.model.length})},handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElements"}},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"}},{name:"resize",position:"se",events:{pointerdown:"startResizing",pointermove:"doResize",pointerup:"stopBatch"}}],useModelGeometry:!1,strictSelection:!1,rotateAngleGrid:15,allowTranslate:!0},className:"selection",events:{"mousedown .selection-box":"onSelectionBoxPointerDown","touchstart .selection-box":"onSelectionBoxPointerDown","mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown"},documentEvents:{mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},_action:null,init:function(){this.options.model&&(this.options.collection=this.options.model);var t=this.collection=this.options.collection||this.collection||new e.Collection;if(t.comparator||(t.comparator=this.constructor.depthComparator,t.sort()),this.model=t,!this.options.paper)throw new Error("Selection: paper required");Qt(this.options,{graph:this.options.paper.model}),Te(this,"startSelecting","stopSelecting","adjustSelection","pointerup"),this.options.paper.$el.append(this.$el),this._boxCount=0,this.$selectionWrapper=this.createSelectionWrapper(),this.handles=[],ue(this.options.handles).forEach(this.addHandle,this),this.startListening()},startListening:function(){var t=this.options.paper;this.listenTo(t,"scale translate",this.onPaperTransformation);var e=this.options.graph;this.listenTo(e,"reset",this.cancelSelection),this.listenTo(e,"change remove",this.onGraphChange);var n=this.collection;this.listenTo(n,"remove",this.onRemoveElement),this.listenTo(n,"reset",this.onResetElements),this.listenTo(n,"add",this.onAddElement)},onPaperTransformation:function(){this.updateSelectionBoxes({async:!1})},onGraphChange:function(t,e){e.selection!==this.cid&&this.updateSelectionBoxes()},cancelSelection:function(){this.model.reset([],{ui:!0})},addHandle:function(t){this.handles.push(t);var e=i("<div/>",{class:"handle "+(t.position||"")+" "+(t.name||""),"data-action":t.name});return t.icon&&e.css("background-image","url("+t.icon+")"),e.html(t.content||""),_t(e,t.attrs),this.$selectionWrapper.append(e),we(t.events,(function(e,n){Ae(e)?this.on("action:"+t.name+":"+n,this[e],this):this.on("action:"+t.name+":"+n,e)}).bind(this)),this},stopSelecting:function(t){var e,n=this.options.paper,i=this.eventData(t).action;switch(i){case"selecting":var r=this.$el.offset(),o=this.$el.width(),s=this.$el.height();e=n.pageToLocalPoint(r.left,r.top);var a=n.scale();o/=a.sx,s/=a.sy;var l=Y(e.x,e.y,o,s),c=this.getElementsInSelectedArea(l),u=this.options.filter;Array.isArray(u)?c=c.filter(function(t){return!u.includes(t.model)&&!u.includes(t.model.get("type"))}):le(u)&&(c=c.filter(function(t){return!u(t.model)}));var h=c.map(function(t){return t.model});this.model.reset(h,{ui:!0});break;case"translating":this.options.graph.stopBatch("selection-translate"),e=n.snapToGrid(t.clientX,t.clientY),this.notify("selection-box:pointerup",t,e.x,e.y);break;default:i||this.cancelSelection()}this._action=null},removeHandle:function(t){var e=ue(this.handles).findIndex(function(e){return e.name===t}),n=this.handles[e];return n&&(we(n.events,(function(e,n){this.off("action:"+t+":"+n)}).bind(this)),this.$(".handle."+t).remove(),this.handles.splice(e,1)),this},startSelecting:function(t){t=vt(t),this.cancelSelection();var e,n,r=this.options.paper.el;if(null!=t.offsetX&&null!=t.offsetY&&i.contains(r,t.target))e=t.offsetX,n=t.offsetY;else{var o=i(r).offset(),s=r.scrollLeft,a=r.scrollTop;e=t.clientX-o.left+window.pageXOffset+s,n=t.clientY-o.top+window.pageYOffset+a}this.$el.css({width:1,height:1,left:e,top:n}),this.showLasso(),this.eventData(t,{action:"selecting",clientX:t.clientX,clientY:t.clientY,offsetX:e,offsetY:n}),this.delegateDocumentEvents(null,t.data),this._action="selecting"},changeHandle:function(t,e){var n=ue(this.handles).find(function(e){return e&&e.name===t});return n&&(this.removeHandle(t),this.addHandle(At({name:t},n,e))),this},onSelectionBoxPointerDown:function(t){t.stopPropagation(),t=vt(t),this.options.allowTranslate&&this.startTranslatingSelection(t),this.eventData(t,{activeElementView:this.getCellView(t.target)});var e=this.options.paper.snapToGrid(t.clientX,t.clientY);this.notify("selection-box:pointerdown",t,e.x,e.y),this.delegateDocumentEvents(null,t.data)},startTranslatingSelection:function(t){this.options.graph.startBatch("selection-translate");var e=this.options.paper.snapToGrid(t.clientX,t.clientY);this.eventData(t,{action:"translating",snappedClientX:e.x,snappedClientY:e.y}),this._action="translating"},adjustSelection:function(t){var e,n;t=vt(t);var i=this.eventData(t),r=i.action;switch(r){case"selecting":e=t.clientX-i.clientX,n=t.clientY-i.clientY;var o=parseInt(this.$el.css("left"),10),s=parseInt(this.$el.css("top"),10);this.$el.css({left:e<0?i.offsetX+e:o,top:n<0?i.offsetY+n:s,width:Math.abs(e),height:Math.abs(n)});break;case"translating":var a=this.options.paper.snapToGrid(t.clientX,t.clientY),l=a.x,c=a.y;e=l-i.snappedClientX,n=c-i.snappedClientY;var u=this.options.paper.getRestrictedArea();if(u){var h=this.model.toArray(),d=this.options.graph.getCellsBBox(h),f=u.x-d.x,p=u.y-d.y,g=u.x+u.width-(d.x+d.width),m=u.y+u.height-(d.y+d.height);e<f&&(e=f),n<p&&(n=p),g<e&&(e=g),m<n&&(n=m)}if(e||n){if(this.translateSelectedElements(e,n),this.boxesUpdated)1<this.model.length&&this.updateSelectionBoxes();else{var v=this.options.paper.scale();this.$el.children(".selection-box").add(this.$selectionWrapper).css({left:"+="+e*v.sx,top:"+="+n*v.sy})}i.snappedClientX=l,i.snappedClientY=c}this.notify("selection-box:pointermove",t,l,c);break;default:r&&this.pointermove(t)}this.boxesUpdated=!1},translateSelectedElements:function(t,e){var n={};this.model.each((function(i){if(!n[i.id]){var r={selection:this.cid};i.translate(t,e,r),i.getEmbeddedCells({deep:!0}).forEach(function(t){n[t.id]=!0}),this.options.graph.getConnectedLinks(i).forEach(function(i){n[i.id]||(i.translate(t,e,r),n[i.id]=!0)})}}).bind(this))},notify:function(t,e){var n=this.eventData(e),i=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t,n.activeElementView].concat(i))},getElementsInSelectedArea:function(t){var e=this.options.paper,n={strict:this.options.strictSelection};return this.options.useModelGeometry?e.model.findModelsInArea(t,n).map(e.findViewByModel,e).filter(function(t){return!!t}):e.findViewsInArea(t,n)},pointerup:function(t){var e=this.eventData(t).action;e&&(this.triggerAction(e,"pointerup",t),this.stopSelecting(t),this.undelegateDocumentEvents(),this._action=null)},destroySelectionBox:function(t){this.$('[data-model="'+t.get("id")+'"]').remove(),0===this.$el.children(".selection-box").length&&this.hide(),this._boxCount=Math.max(0,this._boxCount-1)},hide:function(){this.$el.removeClass("lasso selected")},showSelected:function(){this.$el.addClass("selected")},showLasso:function(){this.$el.addClass("lasso")},destroyAllSelectionBoxes:function(){this.hide(),this.$el.children(".selection-box").remove(),this._boxCount=0},createSelectionBox:function(t){var e=t.findView(this.options.paper);if(e){var n=e.getBBox({useModelGeometry:this.options.useModelGeometry});i("<div/>").addClass("selection-box").attr("data-model",t.get("id")).css({left:n.x,top:n.y,width:n.width,height:n.height}).appendTo(this.el),this.showSelected(),this._boxCount++}},createSelectionWrapper:function(){var t=i("<div/>",{class:"selection-wrapper"}),e=i("<div/>",{class:"box"});return t.append(e),t.attr("data-selection-length",this.model.length),this.$el.prepend(t),t},updateSelectionWrapper:function(){var t={x:1/0,y:1/0},e={x:0,y:0};if(this.model.each((function(n){var i=this.options.paper.findViewByModel(n);if(i){var r=i.getBBox({useModelGeometry:this.options.useModelGeometry});t.x=Math.min(t.x,r.x),t.y=Math.min(t.y,r.y),e.x=Math.max(e.x,r.x+r.width),e.y=Math.max(e.y,r.y+r.height)}}).bind(this)),this.$selectionWrapper.css({left:t.x,top:t.y,width:e.x-t.x,height:e.y-t.y}).attr("data-selection-length",this.model.length),le(this.options.boxContent)){var n=this.$(".box"),i=this.options.boxContent.call(this,n[0]);i&&n.html(i)}},updateSelectionBoxes:function(t){0!==this.collection.length&&(this.boxesUpdated=!0,this.options.paper.requestViewUpdate(this,1,this.UPDATE_PRIORITY,t))},confirmUpdate:function(){this._updateSelectionBoxes()},_updateSelectionBoxes:function(){if(this._boxCount){this.hide();for(var t=this.$el.children(".selection-box"),e=0,n=t.length;e<n;e++){var r=t[e],o=i(r).remove().attr("data-model"),s=this.model.get(o);s&&this.createSelectionBox(s)}this.updateSelectionWrapper()}},onHandlePointerDown:function(t){var e=i(t.currentTarget).attr("data-action");e&&(t.preventDefault(),t.stopPropagation(),t=vt(t),this.triggerAction(e,"pointerdown",t),this.eventData(t,{action:e,clientX:t.clientX,clientY:t.clientY,startClientX:t.clientX,startClientY:t.clientY}),this.delegateDocumentEvents(null,t.data),this._action=e)},getCellView:function(t){var e=this.model.get(t.getAttribute("data-model"));return e&&e.findView(this.options.paper)},pointermove:function(t){var e=this.eventData(t),n=e.action;if(n){var i=this.options.paper.snapToGrid(t.clientX,t.clientY),r=this.options.paper.snapToGrid(e.clientX,e.clientY),o=i.x-r.x,s=i.y-r.y;this.triggerAction(n,"pointermove",t,o,s,t.clientX-e.startClientX,t.clientY-e.startClientY),e.clientX=t.clientX,e.clientY=t.clientY}},triggerAction:function(t,e,n){var i=Array.prototype.slice.call(arguments,2);i.unshift("action:"+t+":"+e),this.trigger.apply(this,i)},onRemoveElement:function(t){this.destroySelectionBox(t),this.updateSelectionWrapper()},onResetElements:function(t){this.destroyAllSelectionBoxes(),t.each(this.createSelectionBox.bind(this)),this.updateSelectionWrapper()},onAddElement:function(t){this.createSelectionBox(t),this.updateSelectionWrapper()},removeElements:function(t){var e=this.collection.toArray();this.cancelSelection(),this.options.graph.removeCells(e,{selection:this.cid})},startRotating:function(t){this.options.graph.trigger("batch:start");var e=this.options.graph.getCellsBBox(this.model.models).center(),n=this.options.paper.snapToGrid(t.clientX,t.clientY),i=this.model.toArray().reduce(function(t,e){return t[e.id]=j(e.get("angle")||0),t},{});this.eventData(t,{center:e,clientAngle:W(n).theta(e),initialAngles:i})},startResizing:function(t){var e=this.options.paper,n=this.options.graph,i=e.options.gridSize,r=this.model.toArray(),o=n.getCellsBBox(r),s=ee(r,"getBBox"),a=s.reduce(function(t,e){return e.width<t?e.width:t},1/0),l=s.reduce(function(t,e){return e.height<t?e.height:t},1/0);this.eventData(t,{cells:n.getSubgraph(r),bbox:o,minWidth:i*o.width/a,minHeight:i*o.height/l}),n.trigger("batch:start")},doResize:function(t,e,n){var i=this.eventData(t),r=i.bbox,o=r.width,s=r.height,a=Math.max(o+e,i.minWidth),l=Math.max(s+n,i.minHeight);(.001<Math.abs(o-a)||.001<Math.abs(s-l))&&(this.options.graph.resizeCells(a,l,i.cells,{selection:this.cid}),r.width=a,r.height=l,this.updateSelectionBoxes())},doRotate:function(t){var e=this.eventData(t),n=this.options.rotateAngleGrid,i=this.options.paper.snapToGrid(t.clientX,t.clientY),r=e.clientAngle-W(i).theta(e.center);.001<Math.abs(r)&&(this.collection.each((function(t){var i=G(e.initialAngles[t.id]+r,n);t.rotate(i,!0,e.center,{selection:this.cid})}).bind(this)),this.updateSelectionBoxes())},stopBatch:function(){this.options.graph.trigger("batch:stop")},getAction:function(){return this._action}},{depthComparator:function(t){return t.getAncestors().length}}),ca=la,ua=dn.extend({options:{paper:void 0,distance:10},className:"snaplines",documentEvents:{mouseup:"hide",touchend:"hide"},init:function(){Te(this,"hide"),this.render(),this.startListening(),this.prepareFilters()},render:function(){var t=this.$horizontal=i("<div>").addClass("snapline horizontal"),e=this.$vertical=i("<div>").addClass("snapline vertical");this.$el.hide().append([t,e]).appendTo(this.options.paper.el)},startListening:function(){this.stopListening(),this.listenTo(this.options.paper,"element:pointerdown",this.captureCursorOffset),this.listenTo(this.options.paper,"element:pointermove",this.snapWhileMoving),this.listenTo(this.options.paper.model,"batch:stop",this.onBatchStop),this.delegateDocumentEvents()},prepareFilters:function(){this.filterTypes={},this.filterCells={},this.filterFunction=void 0,Array.isArray(this.options.filter)?this.options.filter.forEach(function(t){Ae(t)?this.filterTypes[t]=!0:this.filterCells[t.id]=!0},this):le(this.options.filter)&&(this.filterFunction=this.options.filter)},onBatchStop:function(t){"resize"===(t=t||{}).batchName&&this.snapWhileResizing(t.cell,t)},captureCursorOffset:function(t,e,n,i){var r=t.getDelegatedView();if(r&&this.canElementMove(r)){var o=r.model.get("position");this._cursorOffset={x:n-o.x,y:i-o.y}}},snapWhileResizing:function(t,e){if(e.ui&&!e.snapped&&e.direction&&e.trueDirection){var n=this.options.paper.findViewByModel(t);if(n&&n.model.isElement()){var i=t.getBBox(),r=i.bbox(t.get("angle")),o=r.origin(),s=r.corner(),a=j(t.get("angle")),l=this.options.distance,c=null,u=null,h={vertical:0,horizontal:0},d=e.direction,f=e.trueDirection,p=e.relativeDirection;if(-1!==f.indexOf("right")?h.vertical=s.x:h.vertical=o.x,-1!==f.indexOf("bottom")?h.horizontal=s.y:h.horizontal=o.y,this.options.paper.model.getElements().find(function(e){if(e.id===t.id||e.isEmbeddedIn(t)||this.filterTypes[e.get("type")]||this.filterCells[e.id]||this.filterFunction&&this.filterFunction(e))return!1;var n=e.getBBox().bbox(e.get("angle")),i=n.origin(),r=n.corner(),o={vertical:[i.x,r.x],horizontal:[i.y,r.y]};return we(o,function(t,e){t=(t=t.map(function(t){return{position:t,distance:Math.abs(t-h[e])}})).filter(function(t){return t.distance<l}),t=fe(t,function(t){return t.distance}),o[e]=t}),null===c&&0<o.vertical.length&&(c=o.vertical[0].position),null===u&&0<o.horizontal.length&&(u=o.horizontal[0].position),St(c)&&St(u)},this),this.hide(),St(c)||St(u)){var g=0;St(c)&&(g=-1!==f.indexOf("right")?c-r.corner().x:r.origin().x-c);var m=0;St(u)&&(m=-1!==f.indexOf("bottom")?u-r.corner().y:r.origin().y-u);var v=0,y=0;if(a%90){var b;b=0<=a&&a<90?1:90<=a&&a<180?4:180<=a&&a<270?3:2,u&&c&&(g<m?(m=0,u=null):(g=0,c=null));var C=V(a%90);g&&(v=3===b?g/Math.cos(C):g/Math.sin(C)),m&&(y=3===b?m/Math.cos(C):m/Math.sin(C));var I=1===b||3===b;switch(p){case"top":case"bottom":y=m?m/(I?Math.cos(C):Math.sin(C)):g/(I?Math.sin(C):Math.cos(C));break;case"left":case"right":v=g?g/(I?Math.cos(C):Math.sin(C)):m/(I?Math.sin(C):Math.cos(C))}}else y=90===a||270===a?(v=m,g):(v=g,m);switch(p){case"top":case"bottom":v=0;break;case"left":case"right":y=0}var E=this.options.paper.options.gridSize,T=Math.max(i.width+v,E),w=Math.max(i.height+y,E);e.minWidth&&e.minWidth>E&&(T=Math.max(T,e.minWidth)),e.minHeight&&e.minHeight>E&&(w=Math.max(w,e.minHeight)),e.maxWidth&&(T=Math.min(T,e.maxWidth)),e.maxHeight&&(w=Math.min(w,e.maxHeight)),e.preserveAspectRatio&&(y<v?w=T*(i.height/i.width):T=w*(i.width/i.height)),T===i.width&&w===i.height||t.resize(T,w,{snaplines:this.cid,restrictedArea:this.options.paper.getRestrictedArea(n),direction:d,relativeDirection:p,trueDirection:f,snapped:!0});var x=t.getBBox().bbox(a);c&&1<Math.abs(x.x-c)&&1<Math.abs(x.width+x.x-c)&&(c=null),u&&1<Math.abs(x.y-u)&&1<Math.abs(x.height+x.y-u)&&(u=null),this.show({vertical:c,horizontal:u})}}}},canElementMove:function(t){return t&&t.model.isElement()&&t.can("elementMove")},snapWhileMoving:function(t,e,n,i){var r=t.eventData(e).delegatedView||t;if(this.canElementMove(r)){var o=r.model,s=o.get("position"),a=o.get("size"),l=Y(Jt({x:n-this._cursorOffset.x,y:i-this._cursorOffset.y},a)),c=l.center(),u=l.bbox(o.get("angle")),h=u.origin(),d=u.corner(),f=this.options.distance,p=null,g=null,m=0,v=0;if(this.options.paper.model.getElements().find(function(t){if(t===o||t.isEmbeddedIn(o)||this.filterTypes[t.get("type")]||this.filterCells[t.id]||this.filterFunction&&this.filterFunction(t))return!1;var e=t.getBBox().bbox(t.get("angle")),n=e.center(),i=e.origin(),r=e.corner();return null===p&&(Math.abs(n.x-c.x)<f?(p=n.x,m=.5):Math.abs(i.x-h.x)<f?p=i.x:Math.abs(i.x-d.x)<f?(p=i.x,m=1):Math.abs(r.x-d.x)<f?(p=r.x,m=1):Math.abs(r.x-h.x)<f&&(p=r.x)),null===g&&(Math.abs(n.y-c.y)<f?(g=n.y,v=.5):Math.abs(i.y-h.y)<f?g=i.y:Math.abs(i.y-d.y)<f?(g=i.y,v=1):Math.abs(r.y-d.y)<f?(g=r.y,v=1):Math.abs(r.y-h.y)<f&&(g=r.y)),St(p)&&St(g)},this),this.hide(),St(p)||St(g)){St(p)&&(u.x=p-m*u.width),St(g)&&(u.y=g-v*u.height);var y=u.center(),b=y.x-l.width/2,C=y.y-l.height/2;o.translate(b-s.x,C-s.y,{restrictedArea:this.options.paper.getRestrictedArea(r),snapped:!0}),this.show({vertical:p,horizontal:g})}}},show:function(t){t=t||{};var e=this.options.paper.matrix();t.horizontal?this.$horizontal.css("top",t.horizontal*e.d+e.f).show():this.$horizontal.hide(),t.vertical?this.$vertical.css("left",t.vertical*e.a+e.e).show():this.$vertical.hide(),this.$el.show()},hide:function(){this.$el.hide()}}),ha={options:function(){return{columnWidth:this.options.width/2-10,columns:2,rowHeight:80,resizeToFit:!0,dy:10,dx:10}},layoutGroup:function(t,e){var n=this.options.layout;if(e=e||{},!ls)throw new Error("joint.ui.Stencil: joint.layout.GridLayout is not available.");ls.layout(t,Jt({},n,e.layout))}},da=dn.extend({className:"stencil",events:{"click .btn-expand":"openGroups","click .btn-collapse":"closeGroups","click .groups-toggle > .group-label":"openGroups","click .group > .group-label":"onGroupLabelClick","touchstart .group > .group-label":"onGroupLabelClick","input .search":"onSearch","focusin .search":"pointerFocusIn","focusout .search":"pointerFocusOut"},documentEvents:{mousemove:"onDrag",touchmove:"onDrag",mouseup:"onDragEnd",touchend:"onDragEnd",touchcancel:"onDragEnd"},options:{width:200,height:800,label:"Stencil",groups:null,groupsToggleButtons:!1,dropAnimation:!1,search:null,layout:null,snaplines:null,scaleClones:!1,dragStartClone:function(t){return t.clone()},dragEndClone:function(t){return t.clone()},layoutGroup:null,paperOptions:null,paperDragOptions:null},DEFAULT_GROUP:"__default__",init:function(){this.setPaper(this.options.paperScroller||this.options.paper),this.graphs={},this.papers={},this.$groups={},this.onSearch=he(this.onSearch,200),this.delegateEvents(),this.initializeLayout()},initializeLayout:function(){var t=this.options.layout;t&&(le(t)?this.layoutGroup=t:(this.layoutGroup=ha.layoutGroup.bind(this),this.options.layout=De(t)?t:{},Qt(this.options.layout,ha.options.call(this))))},setPaper:function(t){var e=this.options;if(t instanceof qr)e.paperScroller=null,e.paper=t,e.graph=t.model;else{if(!("function"==typeof ra&&t instanceof ra))throw new Error("Stencil: paper required");e.paperScroller=t,e.paper=t.options.paper,e.graph=t.options.paper.model}},renderContent:function(){return i("<div/>").addClass("content")},renderPaperDrag:function(){return i("<div/>").addClass("stencil-paper-drag")},renderSearch:function(){return i("<div/>").addClass("search-wrap").append(i("<input/>",{type:"search",placeholder:"search"}).addClass("search"))},renderToggleAll:function(){return[i("<div/>").addClass("groups-toggle").append(i("<label/>").addClass("group-label").html(this.options.label)).append(i("<button/>",{text:"+"}).addClass("btn btn-expand")).append(i("<button/>",{text:"-"}).addClass("btn btn-collapse"))]},renderElementsContainer:function(){return i("<div/>").addClass("elements")},renderGroup:function(t){t=t||{};var e=i("<div/>").addClass("group").attr("data-name",t.name).toggleClass("closed",!!t.closed),n=i("<h3/>").addClass("group-label").html(t.label||t.name),r=this.renderElementsContainer();return e.append(n,r)},render:function(){var t=this.options;this.$content=this.renderContent(),this.$paperDrag=this.renderPaperDrag(),this.$el.empty().append(this.$paperDrag,this.$content),t.search&&this.$el.addClass("searchable").prepend(this.renderSearch()),t.groupsToggleButtons&&this.$el.addClass("collapsible").prepend(this.renderToggleAll());var e,n=Object.keys(t.groups||{}),i=0<n.length;if(t.paperOptions&&!le(t.paperOptions)&&t.paperOptions.model)throw new Error("ui.Stencil: the `paperOptions` has to be a function if there is the property `model` defined.");if(i)fe(n,(function(t){return this[t].index}).bind(t.groups)).forEach(function(n){var i=this.options.groups[n],r=this.$groups[n]=this.renderGroup({name:n,label:i.label,closed:i.closed}).appendTo(this.$content);if(i.paperOptions&&i.paperOptions.model)throw new Error("ui.Stencil: the `model` property is not allowed in the `paperOptions` for the groups.");e=Ce(t,"paperOptions")||{};var o=Jt({},e,i.paperOptions,{el:r.find(".elements"),model:e.model||new Zr,width:i.width||t.width,height:i.height||t.height,interactive:!1,preventDefaultBlankAction:!1}),s=new qr(o);this.graphs[n]=o.model,this.papers[n]=s},this);else{var r=this.renderElementsContainer().appendTo(this.$content);e=Ce(t,"paperOptions")||{};var o=new qr(Jt({},e,{el:r,model:e.model||new Zr,width:t.width,height:t.height,interactive:!1,preventDefaultBlankAction:!1}));this.graphs[this.DEFAULT_GROUP]=o.model,this.papers[this.DEFAULT_GROUP]=o}e=Ce(t,"paperOptions")||{};var s=Ce(t,"paperDragOptions")||{},a=this._graphDrag=s.model||e.model||new Zr;return this._paperDrag=new qr(Jt({},t.paperDragOptions,{el:this.$paperDrag,width:1,height:1,model:a})),this.startListening(),this},startListening:function(){this.stopListening(),we(this.papers,(function(t){this.listenTo(t,"cell:pointerdown",this.onDragStart)}).bind(this))},load:function(t,e){Array.isArray(t)?this.loadGroup(t,e):De(t)&&we(this.options.groups,(function(e,n){t[n]&&this.loadGroup(t[n],n)}).bind(this))},loadGroup:function(t,e){var n=this.getGraph(e);n.resetCells(t);var i=this.options.height;if(e&&(i=this.getGroup(e).height),this.isLayoutEnabled()&&this.layoutGroup(n,this.getGroup(e)),!i){var r=this.getPaper(e);r.fitToContent({minWidth:r.options.width,gridHeight:1,padding:this.options.paperPadding||10})}},isLayoutEnabled:function(){return!!this.options.layout},getGraph:function(t){var e=this.graphs[t||this.DEFAULT_GROUP];if(!e)throw new Error("Stencil: group "+t+" does not exist.");return e},getPaper:function(t){return this.papers[t||this.DEFAULT_GROUP]},preparePaperForDragging:function(t,e,n){var i=this._paperDrag,r=this._graphDrag;i.$el.addClass("dragging").appendTo(document.body);var o=this.options.dragStartClone(t.model).position(0,0),s=5,a=this.options.snaplines;if(a&&(s+=a.options.distance),a||this.options.scaleClones){var l=this.options.paper.scale();i.scale(l.sx,l.sy),s*=Math.max(l.sx,l.sy)}else i.scale(1,1);this.clearClone(),this.options.dropAnimation&&this._paperDrag.$el.stop(!0,!0),r.resetCells([o.position(0,0)]);var c=o.findView(i);c.stopListening(),i.fitToContent({padding:s,allowNewOrigin:"any"});var u=c.getBBox(),h=this._cloneGeometryBBox=c.getBBox({useModelGeometry:!0});this._cloneViewDeltaOrigin=h.origin().difference(u.origin()),this._cloneBBox=o.getBBox(),this._clone=o,this._cloneView=c,this._paperDragPadding=s,this._paperDragInitialOffset=this.setPaperDragOffset(e,n)},setPaperDragOffset:function(t,e){var n=document.body.scrollTop||document.documentElement.scrollTop,i=this._cloneViewDeltaOrigin,r=this._cloneGeometryBBox,o=this._paperDragPadding||5,s={left:t-i.x-r.width/2-o,top:e-i.y-r.height/2-o+n};return this._paperDrag.$el.offset(s),s},setCloneLocalPosition:function(t,e){var n=this.options.paper.clientToLocalPoint({x:t,y:e}),i=this._cloneBBox;return n.x-=i.width/2,n.y-=i.height/2,this._clone.set("position",n),n},onDragStart:function(t,e){e.preventDefault(),this.options.graph.startBatch("stencil-drag"),this.$el.addClass("dragging"),this.preparePaperForDragging(t,e.clientX,e.clientY);var n=this.setCloneLocalPosition(e.clientX,e.clientY),i=this._cloneView,r=this.options.snaplines;r&&(r.captureCursorOffset(this._cloneView,e,n.x,n.y),i.listenTo(this._clone,"change:position",this.onCloneSnapped.bind(this))),this.delegateDocumentEvents(null,e.data)},onCloneSnapped:function(t,e,n){if(n.snapped){var i=this._cloneBBox;t.position(i.x+n.tx,i.y+n.ty,{silent:!0}),this._cloneView.translate(),t.set("position",e,{silent:!0}),this._cloneSnapOffset={x:n.tx,y:n.ty}}else this._cloneSnapOffset=null},onDrag:function(t){var e=this._cloneView;if(e){t.preventDefault();var n=(t=vt(t)).clientX,i=t.clientY;this.setPaperDragOffset(n,i);var r=this.setCloneLocalPosition(n,i),o=this.options.paper.options.embeddingMode,s=this.options.snaplines,a=(o||s)&&this.insideValidArea({x:n,y:i});if(o){e.eventData(t,{paper:this.options.paper});var l=e.eventData(t);a?e.processEmbedding(l):e.clearEmbedding(l)}s&&(a?s.snapWhileMoving(e,t,r.x,r.y):s.hide())}},onDragEnd:function(t){var e=this._clone;if(e){t=vt(t);var n=this._cloneView,i=this._cloneBBox,r=this._cloneSnapOffset,o=i.x,s=i.y;r&&(o+=r.x,s+=r.y),e.position(o,s,{silent:!0});var a=this.options.dragEndClone(e);this.drop(a,{x:t.clientX,y:t.clientY})?this.onDropEnd(e):this.onDropInvalid(t,a),this.options.paper.options.embeddingMode&&n&&(n.eventData(t,{model:a,paper:this.options.paper}),n.finalizeEmbedding(n.eventData(t))),this.options.graph.stopBatch("stencil-drag")}},onDropEnd:function(t){this._clone===t&&(this.clearClone(),this.$el.append(this._paperDrag.$el),this.$el.removeClass("dragging"),this._paperDrag.$el.removeClass("dragging"))},clearClone:function(){this._clone&&(this._clone.remove(),this._clone=null,this._cloneView=null,this._cloneSnapOffset=null,this._paperDragInitialOffset=null,this._paperDragPadding=null)},onDropInvalid:function(t,e){var n=this._clone;if(n){t=vt(t),e=e||this.options.dragEndClone(n),this.trigger("drop:invalid",t,e);var i=this.options.dropAnimation;if(i){var r=De(i)?i.duration:150,o=De(i)?i.easing:"swing";this._cloneView=null,this._paperDrag.$el.animate(this._paperDragInitialOffset,r,o,this.onDropEnd.bind(this,n))}else this.onDropEnd(n)}},insideValidArea:function(t){var e,n=this.options.paper,i=this.options.paperScroller,r=this.getDropArea(this.$el);if(i)if(i.options.autoResizePaper)e=this.getDropArea(i.$el);else{var o=this.getDropArea(i.$el);e=this.getDropArea(n.$el).intersect(o)}else e=this.getDropArea(n.$el);return!(!e||!e.containsPoint(t)||r.containsPoint(t))},getDropArea:function(t){var e=t.offset(),n=document.body.scrollTop||document.documentElement.scrollTop,i=document.body.scrollLeft||document.documentElement.scrollLeft;return Y({x:e.left+parseInt(t.css("border-left-width"),10)-i,y:e.top+parseInt(t.css("border-top-width"),10)-n,width:t.innerWidth(),height:t.innerHeight()})},drop:function(t,e){var n=this.options.paper,i=this.options.graph;if(this.insideValidArea(e)){var r=n.clientToLocalPoint(e),o=t.getBBox();r.x+=o.x-o.width/2,r.y+=o.y-o.height/2;var s=this._cloneSnapOffset?1:n.options.gridSize;return t.set("position",{x:G(r.x,s),y:G(r.y,s)}),t.unset("z"),i.addCell(t,{stencil:this.cid}),!0}return!1},filter:function(t,e){var n=Object.keys(this.papers).reduce((function(n,i){var r=this.papers[i],o=i===this.DEFAULT_GROUP?null:i,s=r.model.getCells().filter((function(n){var i;i=le(e)?e.call(this,n,t,o,this):this.isCellMatched(n,t,e,t.toLowerCase()!==t);var s=r.findViewByModel(n);return s&&s.vel.toggleClass("unmatched",!i),i}).bind(this)),a=!se(s),l=this.options,c=((Ce(l,"paperOptions")||{}).model||new Zr).resetCells(s);return this.trigger("filter",c,i,t),this.isLayoutEnabled()&&this.layoutGroup(c,this.getGroup(i)),this.$groups[i]&&this.$groups[i].toggleClass("unmatched",!a),r.fitToContent({gridWidth:1,gridHeight:1,padding:l.paperPadding||10}),n||a}).bind(this),!1);this.$el.toggleClass("not-found",!n)},isCellMatched:function(t,e,n,i){return!e||Object.keys(n).some(function(r){var o=n[r];return("*"==r||t.get("type")==r)&&o.some(function(n){var r=dt(t.attributes,n,"/");return null!=r&&(r=r.toString(),i||(r=r.toLowerCase()),0<=r.indexOf(e))})})},getGroup:function(t){return this.options.groups&&this.options.groups[t]||{}},onSearch:function(t){this.filter(t.target.value,this.options.search)},pointerFocusIn:function(){this.$el.addClass("is-focused")},pointerFocusOut:function(){this.$el.removeClass("is-focused")},onGroupLabelClick:function(t){if("touchstart"===t.type)this._groupLabelClicked=!0;else if(this._groupLabelClicked&&"click"===t.type)return void(this._groupLabelClicked=!1);var e=i(t.target).closest(".group");this.toggleGroup(e.data("name"))},toggleGroup:function(t){this.isGroupOpen(t)?this.closeGroup(t):this.openGroup(t)},closeGroup:function(t){var e=this.$groups[t];e&&this.isGroupOpen(t)&&(this.trigger("group:close",t),e.addClass("closed"))},openGroup:function(t){var e=this.$groups[t];e&&!this.isGroupOpen(t)&&(this.trigger("group:open",t),e.removeClass("closed"))},isGroupOpen:function(t){var e=this.$groups[t];return!!e&&!e.hasClass("closed")},closeGroups:function(){Object.keys(this.$groups).forEach(function(t){this.closeGroup(t)},this)},openGroups:function(){Object.keys(this.$groups).forEach(function(t){this.openGroup(t)},this)},onRemove:function(){ee(this.papers,"remove"),this.papers={},this._paperDrag&&(this._paperDrag.remove(),this._paperDrag=null),this.undelegateDocumentEvents()}}),fa=dn.extend({options:{text:void 0,newlineCharacterBBoxWidth:10,placeholder:void 0,focus:!0,debug:!1,selectAllThreshold:20,useNativeSelection:!0,annotateUrls:!1,urlAnnotation:{attrs:{class:"url-annotation",fill:"lightblue","text-decoration":"underline"}},textareaAttributes:{autocorrect:"off",autocomplete:"off",autocapitalize:"off",spellcheck:"false",tabindex:"0"}},className:"text-editor",events:{"keyup textarea":"onKeyup","input textarea":"onInput","copy textarea":"onCopy","cut textarea":"onCut","paste textarea":"onPaste","mousedown .char-selection-box":"onMousedown","dblclick .char-selection-box":"onDoubleClick","click .char-selection-box":"onTripleClick"},selection:{start:null,end:null},selecting:!1,init:function(){Te(this,"onMousedown","onMousemove","onMouseup","onDoubleClick","onTripleClick","onKeydown","onAfterPaste","onAfterKeydown");var t=this.options.text;if(!t)throw new Error("ui.TextEditor: text option is mandatory");this.setTextElement(t),i(document.body).on("mousemove",this.onMousemove),i(document.body).on("mouseup",this.onMouseup),i(document.body).on("keydown",this.onKeydown),this.$viewport=i(t),this.options.annotations&&this.setAnnotations(this.options.annotations)},setTextElement:function(t){this.$elText&&this.unbindTextElement(),this.options.text=t,this.$elText=i(t),this.$elText.on("mousedown",this.onMousedown),this.$elText.on("dblclick",this.onDoubleClick),this.$elText.on("click",this.onTripleClick)},render:function(t){this.$caret=i("<div>",{class:"caret"}),this.$selection=i("<div>"),this.$selectionBox=i("<div>",{class:"char-selection-box"}),this.$el.append(this.$caret,this.$selection),this.$textareaContainer=i("<div>",{class:"textarea-container"}),this.$textarea=i("<textarea>",this.options.textareaAttributes),this.textarea=this.$textarea[0],this._textContent=this.textarea.value=this.getTextContent(),this._textareaValueBeforeInput=this.textarea.value,this.$textareaContainer.append(this.textarea),this.options.focus&&this.$el.append(this.$textareaContainer),i(t||document.body).append(this.$el);var e=Mt(this.options.text).bbox();return this.$textareaContainer.css({left:e.x,top:e.y}),this.focus(),Mt(this.options.text).attr("cursor","text"),this.selectAll(),this},annotateURLBeforeCaret:function(t){var e=this.getURLBoundary(Math.max(t-1,0));return!!e&&(this.annotateURL(this.getAnnotations()||[],e[0],e[1]),!0)},hasSelection:function(){return St(this.selection.start)&&St(this.selection.end)&&this.selection.start!==this.selection.end},textContentHasChanged:function(){return this._textContent!==this.textarea.value},restoreTextAreaSelectionDirection:function(){this._selectionDirection&&(this.textarea.selectionDirection=this._selectionDirection)},storeSelectionDirection:function(){this._selectionDirection=this.textarea.selectionDirection},onKeydown:function(t){this.options.debug&&console.log("onKeydown(): ",t.keyCode),this.isModifierKey(t)||(this.hasSelection()&&(this.deselect(),this.restoreTextAreaSelectionDirection()),setTimeout(this.onAfterKeydown,0),this._copied=!1,this._selectionStartBeforeInput=this.textarea.selectionStart,this._selectionEndBeforeInput=this.textarea.selectionEnd)},onAfterKeydown:function(){this.textarea===document.activeElement&&(this.storeSelectionDirection(),this.updateSelectionFromTextarea())},updateSelectionFromTextarea:function(){var t=this.textarea,e=t.selectionStart,n=t.selectionEnd;e===n?this.setCaret(e):this.select(e,n)},textSelectionHasChanged:function(){var t=this.selection,e=this.textarea;return!(!t||!e||t.start===e.selectionStart&&t.end===e.selectionEnd)},isModifierKey:function(t){return[16,18,17,91].some(function(e){return t.which===e})},isArrowKey:function(t){return 37<=t.which&&t.which<=40},onKeyup:function(t){if(this.textContentHasChanged()&&this.onInput(t),this.textSelectionHasChanged()&&!this.isArrowKey(t)){var e=this.textarea;e.selectionEnd!==e.selectionStart&&this.updateSelectionFromTextarea()}},onCopy:function(t){this._copied||this.copyToClipboard()},onCut:function(t){this._copied||this.copyToClipboard()},copyToClipboard:function(){document.queryCommandSupported&&document.queryCommandSupported("copy")&&(this._copied=!0,document.execCommand("copy"))},onInput:function(t){if(this.textContentHasChanged()){var e=this.textarea.value.length-this._textareaValueBeforeInput.length,n={start:this._selectionStartBeforeInput,end:this._selectionEndBeforeInput},i={start:this.textarea.selectionStart,end:this.textarea.selectionEnd};this.options.debug&&console.log("onInput()",t,"selectionBeforeInput",n,"selectionAfterInput",i,"diffLength",e);var r=this.inferTextOperationType(n,i,e),o=!1,s=this.getAnnotations();if(this.options.annotateUrls&&"insert"===r){var a=this.textarea.value.substr(n.start,e);this.options.debug&&console.log("onInput()","inserted text",a),/\s/.test(a)&&(o=this.annotateURLBeforeCaret(n.start))&&(s=this.shiftAnnotations(s,i.end,e))}if(s&&(o||(s=this.annotate(s,n,i,e)),this.options.debug&&console.log("onInput()","modified annotations",s),this._currentAnnotationAttributes&&"insert"===r)){var l={start:n.start,end:i.end,attrs:this._currentAnnotationAttributes};s.push(l),this._currentAnnotationAttributes=void 0,this.options.debug&&console.log("onInput()","insert annotation",l,"final annotations",s)}this._annotations=s,this.trigger("text:change",this.textarea.value,this._textareaValueBeforeInput,s,n,i),this._selectionBeforeInput=i,this._textareaValueBeforeInput=this.textarea.value,this._textContent=this.textarea.value}},onPaste:function(t){this.options.debug&&console.log("onPaste()"),this._textareaValueBeforeInput=this.textarea.value,setTimeout(this.onAfterPaste,0)},onAfterPaste:function(){this.setCaret(this.textarea.selectionStart)},onMousedown:function(t){if(3!==t.originalEvent.detail){this.options.debug&&console.log("onMousedown()");var e=this.getCharNumFromEvent(t);this.startSelecting(),this.select(e),t.preventDefault(),t.stopPropagation()}},onMousemove:function(t){if(this.selectionInProgress()){this.options.debug&&console.log("onMousemove()");var e=this.getCharNumFromEvent(t);this.storeSelectionDirection(),this.select(null,e),t.preventDefault(),t.stopPropagation()}},onMouseup:function(t){this.selectionInProgress()&&(this.options.debug&&console.log("onMouseup()"),this.stopSelecting(),this.trigger("select:changed",this.selection.start,this.selection.end))},onDoubleClick:function(t){this.options.debug&&console.log("onDoubleClick()");var e=this.getCharNumFromEvent(t),n=this.getWordBoundary(e);this.select(n[0],n[1]),t.preventDefault(),t.stopPropagation()},onTripleClick:function(t){3===t.originalEvent.detail&&(this.options.debug&&console.log("onTripleClick()"),this.hideCaret(),this.selectAll(),t.preventDefault(),t.stopPropagation())},findAnnotationsUnderCursor:function(t,e){return Mt.findAnnotationsAtIndex(t,e)},findAnnotationsInSelection:function(t,e,n){return Mt.findAnnotationsBetweenIndexes(t,e,n)},inferTextOperationType:function(t,e,n){return t.start===t.end&&e.start===e.end&&0<n?"insert":t.start===t.end&&e.start===e.end&&n<=0?"delete-single":t.start!==t.end&&e.start===e.end&&e.start===t.start?"delete":t.start!==t.end&&e.start!==t.start?"delete-insert":void 0},annotate:function(t,e,n,i){var r=[],o=this.inferTextOperationType(e,n,i);return ue(t).forEach(function(t){var s,a;switch(o){case"insert":t.start<e.start&&e.start<=t.end?t.end+=i:t.start>=e.start&&(t.start+=i,t.end+=i);break;case"delete-single":t.start<e.start&&e.start<=t.end&&e.start!==n.start||t.start<=e.start&&e.start<t.end&&e.start===n.start?t.end+=i:t.start>=e.start&&(t.start+=i,t.end+=i);break;case"delete":t.start<=e.start&&e.start<=t.end?e.end<=t.end?t.end+=i:t.end+=n.start-t.end:t.start>=e.start&&t.start<e.end?(s=t.end-t.start,a=e.end-t.start,t.start=e.start,t.end=t.start+s-a):t.start>=e.end&&(t.start+=i,t.end+=i);break;case"delete-insert":if(t.start<=e.start&&e.start<=t.end)e.start<t.end&&(e.end>t.end?t.end=n.end:t.end=n.end+(t.end-e.end));else if(t.start>=e.start&&t.start<=e.end){var l=n.start-e.start;a=e.end-t.start,s=t.end-t.start,t.start=e.start+l,t.end=t.start+s-a}else t.start>=e.start&&t.end<=e.end?t.start=t.end=0:t.start>=e.end&&(t.start+=i,t.end+=i);break;default:this.options.debug&&console.log("ui.TextEditor: Unknown text operation.")}t.end>t.start&&r.push(t)},this),r},shiftAnnotations:function(t,e,n){return Mt.shiftAnnotations(t,e,n)},setCurrentAnnotation:function(t){this._currentAnnotationAttributes=t},setAnnotations:function(t){this._annotations=t},getAnnotations:function(){return this._annotations},getCombinedAnnotationAttrsAtIndex:function(t,e){var n={};return ue(e).forEach(function(e){(void 0===e.start&&void 0===e.end||t>=e.start&&t<e.end)&&Mt.mergeAttrs(n,e.attrs)}),n},getSelectionAttrs:function(t,e){var n=t.start,i=t.end;if(n===i&&0===n)return this.getCombinedAnnotationAttrsAtIndex(n,e);if(n===i)return this.getCombinedAnnotationAttrsAtIndex(n-1,e);for(var r,o=n;o<i;o++){var s=this.getCombinedAnnotationAttrsAtIndex(o,e);if(r&&!ae(r,s)){r=Lt(Mt.mergeAttrs({},r)),s=Lt(Mt.mergeAttrs({},s));var a={};we(s,function(t,e){r[e]===s[e]&&ft(a,e,t)}),r=a}else r=s}return r},getTextContent:function(){var t=this.options.text,e=Mt(t).find(".v-line");return 0===e.length?t.textContent:e.reduce(function(t,e,n,i){var r=e.node.textContent;return e.hasClass("v-empty-line")&&(r=""),n===i.length-1?t+r:t+r+"\n"},"")},startSelecting:function(){this.selecting=!0},stopSelecting:function(){this.selecting=!1},selectionInProgress:function(){return!0===this.selecting},selectAll:function(){return this.select(0,this.getNumberOfChars())},select:function(t,e){return this.options.debug&&console.log("select(",t,e,")"),void 0===e&&(e=t),St(t)&&(this.selection.start=t),St(e)&&(this.selection.end=e),St(this.selection.end)||(this.selection.end=this.selection.start),St(this.selection.start)&&St(this.selection.end)&&(this.selection.start===this.selection.end?(this.clearSelection(),this.focus(),this.setCaret(this.selection.start)):(this.hideCaret(),this.renderSelection(this.selection.start,this.selection.end)),this.trigger("select:change",this.selection.start,this.selection.end)),this},setTextAreaSelection:function(t,e){var n={start:t,end:e};n=this.normalizeSelectionRange(n),this.textarea.focus(),this.textarea.selectionStart=n.start,this.textarea.selectionEnd=n.end},renderSelection:function(t,e){this.options.debug&&console.log("renderSelection()");var n={start:t,end:e};if(n=this.normalizeSelectionRange(n),this.clearSelection(),this.options.useNativeSelection){this.$viewport&&(this._viewportUserSelectBefore=this.$viewport.css("user-select"),this.$viewport.css({"-webkit-user-select":"all","-moz-user-select":"all","user-select":"all"}));var i=n.end-n.start;this.selectTextInElement(this.options.text,n.start,i)}else this.renderSelectionBoxes(n.start,n.end)},normalizeSelectionStartAndLength:function(t,e,n){var i=t.substr(0,e),r=t.substr(e,n);e-=this.countLineBreaks(i),n-=this.countLineBreaks(r);var o=this.countEmptyLines(i);return n+=o,n-=o,{start:e+=o,length:n+=this.countEmptyLines(r)}},selectTextInElement:function(t,e,n){if(le(t.selectSubString)&&this.selectTextInElementUsingSelectSubString(t,e,n),!this.actualSelectionMatchesExpectedSelection(e,n))try{this.selectTextInElementUsingRanges(t,e,n)}catch(u){this.options.debug&&console.log(u),le(t.selectSubString)&&this.selectTextInElementUsingSelectSubString(t,e,n)}},selectTextInElementUsingSelectSubString:function(t,e,n){var i=this.normalizeSelectionStartAndLength(this.getTextContent(),e,n);try{t.selectSubString(i.start,i.length)}catch(t){this.options.debug&&console.log(t)}},selectTextInElementUsingRanges:function(t,e,n){var i=window.getSelection();i.removeAllRanges();var r=this.normalizeSelectionStartAndLength(this.getTextContent(),e,n);e=0+r.start,n=0+r.length;for(var o,s,a,l,c,u,h=this.getTextNodesFromDomElement(t),d=0,f=e+n;0<n&&0<h.length;)l=(a=d)+(o=h.shift()).length,(e<=a&&a<f||e<l&&l<=f||a<=e&&e<l||a<f&&f<=l)&&(c=Math.max(e-a,0),u=Math.min(c+Math.min(n,o.length),l),(s=document.createRange()).setStart(o,c),s.setEnd(o,u),i.addRange(s),n-=u-c),d+=o.length},actualSelectionMatchesExpectedSelection:function(t,e){var n=window.getSelection().toString();return this.getExpectedSelectedContent(t,e)===n.replace(/\s/g," ")},getExpectedSelectedContent:function(t,e){var n=this.getTextContent().substr(t,e);return 0===n.search(/(\n\r|\r|\n)/)&&(n="-"+n),(n=(n=n.replace(/(\n\r|\r|\n){2,}/g,function(t){return Array.from({length:t.length-1},function(){return"-"}).join("")})).replace(/\n\r|\r|\n/g,"")).replace(/\s/g," ")},getTextNodesFromDomElement:function(t){for(var e=[],n=0,i=t.childNodes.length;n<i;n++){var r=t.childNodes[n];void 0!==r.tagName?e=e.concat(this.getTextNodesFromDomElement(r)):e.push(r)}return e},renderSelectionBoxes:function(t,e){this.options.debug&&console.log("renderSelectionBoxes()"),this.$selection.empty();for(var n,i,r,o=this.getFontSize(),s=this.getTextTransforms(),a=s.rotation,l=t;l<e;l++){var c=this.$selectionBox.clone();try{r=this.getCharBBox(l)}catch(n){this.trigger("select:out-of-range",t,e);break}i&&0===a&&Math.round(r.y)===Math.round(i.y)&&Math.round(r.height)===Math.round(i.height)&&Math.round(r.x)===Math.round(i.x+i.width)?n.css({width:"+="+r.width}):(c.css({left:r.x,top:r.y-r.height,width:r.width,height:r.height,"-webkit-transform":"rotate("+a+"deg)","-webkit-transform-origin":"0% 100%","-moz-transform":"rotate("+a+"deg)","-moz-transform-origin":"0% 100%"}),this.$selection.append(c),n=c),i=r}r&&this.$textareaContainer.css({left:r.x,top:r.y-o*s.scaleY})},clearSelection:function(){return this.options.debug&&console.log("clearSelection()"),this.$selection.empty(),this.options.text.selectSubString&&(this.$viewport&&this._viewportUserSelectBefore&&this.$viewport.css({"-webkit-user-select":this._viewportUserSelectBefore,"-moz-user-select":this._viewportUserSelectBefore,"user-select":this._viewportUserSelectBefore}),window.getSelection().removeAllRanges()),this},deselect:function(){return this.options.debug&&console.log("deselect()"),this.stopSelecting(),this.clearSelection(),this.setTextAreaSelection(this.selection.start,this.selection.end),this},getSelectionStart:function(){return this.selection.start},getSelectionEnd:function(){return this.selection.end},getSelectionRange:function(){return this.normalizeSelectionRange(this.selection)},normalizeSelectionRange:function(t){return(t=re(t)).start>t.end&&(t.end=[t.start,t.start=t.end][0]),t},getSelectionLength:function(){var t=this.getSelectionRange();return t.end-t.start},getSelection:function(){var t=this.getSelectionRange();return this.getTextContent().slice(t.start,t.end)},getWordBoundary:function(t){for(var e=this.textarea.value,n=/\W/,i=t;i;){if(n.test(e[i])){i+=1;break}i-=1}for(var r=this.getNumberOfChars(),o=t;o<r&&!n.test(e[o]);)o+=1;return i<o?[i,o]:[o,i]},getURLBoundary:function(t){for(var e=this.textarea.value,n=/\s/,i=t;i;){if(n.test(e[i])){i+=1;break}i-=1}for(var r=this.getNumberOfChars(),o=t;o<=r&&!n.test(e[o]);)o+=1;if(/[-a-zA-Z0-9@:%_+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_+.~#?&//=]*)?/.test(e.substring(i,o)))return[i,o]},annotateURL:function(t,e,n){var i=this.textarea.value.substring(e,n),r=Jt({url:i},this.options.urlAnnotation);return r.start=e,r.end=n,ae(r,t[t.length-1])||t.push(r),t},getCharBBox:function(t){if(this.isLineEnding(t)){var e=this.getCharBBox(t-1);return e.x=e.x2,e.y=e.y2,e.width=this.options.newlineCharacterBBoxWidth||10,e}this.ensureTextVisibility();var n=this.realToSvgCharNum(t),i=this.options.text,r=i.getStartPositionOfChar(n),o=i.getEndPositionOfChar(n),s=i.getExtentOfChar(n);r=this.localToScreenCoordinates(r),o=this.localToScreenCoordinates(o);var a=this.getTextTransforms();return{x:r.x,y:r.y,width:s.width*a.scaleX,height:s.height*a.scaleY,x2:o.x,y2:o.y}},realToSvgCharNum:function(t){for(var e=0,n=0;n<=t;n++)this.isLineEnding(n)&&(e+=1);return t-e},selectionStartToSvgCharNum:function(t){return t-this.nonEmptyLinesBefore(t)},isLineEnding:function(t){var e=this.textarea.value;return"\n"===e[t]&&0<t&&"\n"!==e[t-1]},svgToRealCharNum:function(t){for(var e=0,n=0;n<=t+e;n++)this.isLineEnding(n)&&(e+=1);return t+e},ensureTextVisibility:function(){i(this.options.text).show()},localToScreenCoordinates:function(t){return Mt.transformPoint(t,this.options.text.getCTM())},getNumberOfChars:function(){return this.getTextContent().length},getCharNumFromEvent:function(t){this.ensureTextVisibility();var e=this.options.text,n=t.clientX,i=t.clientY,r=Mt(e).toLocalPoint(n,i),o=e.getCharNumAtPosition(r);if(o<0){var s=Mt(e).getBBox(),a=s.containsPoint(r);if(!a&&this.hasSelection()&&s.clone().inflate(this.options.selectAllThreshold).containsPoint(r))return this.selection.end;var l=a?r:s.pointNearestToPoint(r),c=Mt.createSVGPoint(l.x,l.y),u=e.getCharNumAtPosition(c);if(-1<u)return this.svgToRealCharNum(u);var h,d=0<r.x,f=s.x,p=s.x+s.width,g=f+p/2;do{c.x=g;var m=e.getCharNumAtPosition(c);-1<m&&(u=m),h=g,d&&-1<m||!d&&-1===m?(g=(g+p)/2,f=h):(g=(f+g)/2,p=h)}while(1<Math.abs(h-g));return-1<u?this.svgToRealCharNum(u)+(d?1:0):r.x<0&&r.y<s.y+s.height?0:this.getNumberOfChars()}var v=this.localToScreenCoordinates(r),y=this.getCharBBox(this.svgToRealCharNum(o));return Math.abs(y.x-v.x)<Math.abs(y.x+y.width-v.x)?this.svgToRealCharNum(o):this.svgToRealCharNum(o)+1},lineNumber:function(t){var e=this.textarea.value.substr(0,t);return this.countLineBreaks(e)},emptyLinesBefore:function(t){for(var e=this.textarea.value.split(/\n\r|\r|\n/g),n=0,i=this.lineNumber(t)-1;0<=i;i--)e[i]||(n+=1);return n},countLineBreaks:function(t){return(t.match(/\n\r|\r|\n/g)||[]).length},countEmptyLines:function(t){var e=(t.match(/(\n\r|\r|\n){2,}/g)||[]).reduce(function(t,e){return t+(e.length-1)},0);return 0===t.search(/(\n\r|\r|\n)/)&&e++,e},nonEmptyLinesBefore:function(t){return this.lineNumber(t)-this.emptyLinesBefore(t)},isEmptyLine:function(t){return!this.textarea.value.split(/\n\r|\r|\n/g)[t]},isEmptyLineUnderSelection:function(t){var e=this.lineNumber(t);return this.isEmptyLine(e)},getTextTransforms:function(){var t=this.options.text.getCTM();return Mt.decomposeMatrix(t)},getFontSize:function(){return parseInt(Mt(this.options.text).attr("font-size"),10)},getTextAnchor:function(){return Mt(this.options.text).attr("text-anchor")||""},setCaret:function(t,e){this.ensureTextVisibility(),De(t)&&(e=t,t=void 0),e=e||{};var n,i=this.options.text,r=this.getNumberOfChars(),o=this.selection.start,s=this.textarea.value;void 0!==t&&(t=Math.min(Math.max(t,0),r),o=this.selection.start=this.selection.end=t),e.silent||this.trigger("caret:change",o),this.setTextAreaSelection(o,o),this.options.debug&&console.log("setCaret(",t,e,")","selectionStart",o,"isLineEnding",this.isLineEnding(o),"isEmptyLineUnderSelection",this.isEmptyLineUnderSelection(o),"svgCharNum",this.selectionStartToSvgCharNum(o),"nonEmptyLinesBefore",this.nonEmptyLinesBefore(o));try{var a;n=this.isEmptyLineUnderSelection(o)||!this.isLineEnding(o)&&s.length!==o?(a=this.selectionStartToSvgCharNum(o),i.getStartPositionOfChar(a)):(a=this.selectionStartToSvgCharNum(o)-1,i.getEndPositionOfChar(a))}catch(t){this.trigger("caret:out-of-range",o),n={x:0,y:0}}var l=this.localToScreenCoordinates(n),c=this.getTextTransforms(),u=c.rotation,h=this.getFontSize()*c.scaleY;return this.options.placeholder&&this.$caret.toggleClass("placeholder",0===r),this.$caret.css({left:l.x,top:l.y-h,height:h,"line-height":h+"px","font-size":h+"px","-webkit-transform":"rotate("+u+"deg)","-webkit-transform-origin":"0% 100%","-moz-transform":"rotate("+u+"deg)","-moz-transform-origin":"0% 100%"}).attr({"text-anchor":this.getTextAnchor()}).show(),this.$textareaContainer.css({left:l.x,top:l.y-h}),this.focus(),this},focus:function(){return this.options.debug&&console.log("focus()"),this.showCaret(),this},blur:function(){return this.options.debug&&console.log("blur()"),this.hideCaret(),this},showCaret:function(){return this.options.debug&&console.log("showCaret()"),this.$caret.show(),this},hideCaret:function(){return this.options.debug&&console.log("hideCaret()"),this.$caret.hide(),this},unbindTextElement:function(){this.$elText.off("mousedown",this.onMousedown),this.$elText.off("dblclick",this.onDoubleClick),this.$elText.off("click",this.onTripleClick)},onRemove:function(){this.deselect(),this.unbindTextElement(),i(document.body).off("mousemove",this.onMousemove),i(document.body).off("mouseup",this.onMouseup),i(document.body).off("keydown",this.onKeydown),Mt(this.options.text).attr("cursor","")}},Jt({getTextElement:function(t){var e=t.tagName.toUpperCase();if("TEXT"===e||"TSPAN"===e||"TEXTPATH"===e)return"TEXT"===e?t:this.getTextElement(t.parentNode)},edit:function(t,e){var n=this,i=!1!==(e=e||{}).update;this.options=Jt({},e,{update:i});var r=this.getTextElement(t);if(r){var o;this.close(),this.ed=new fa(Jt({text:r},e)),this.ed.on("all",this.trigger,this);var s=e.cellView;if(s){if(o=s.paper.el,this.cellViewUnderEdit=s,this.cellViewUnderEditInteractiveOption=this.cellViewUnderEdit.options.interactive,this.cellViewUnderEdit.options.interactive=!1,e.annotationsProperty&&!this.ed.getAnnotations()){var a=this.cellViewUnderEdit.model.prop(e.annotationsProperty);a&&this.ed.setAnnotations(this.deepCloneAnnotations(a))}}else o=Mt(r).svg().parentNode;return i&&this.ed.on("text:change",function(t,e,i){s?n.updateCellView(s,t,i):n.updateSVGTextNode(r,t,i)}),this.ed.render(o),this}this.options.debug&&console.log("ui.TextEditor: cannot find a text element.")},updateCellView:function(t,e,n){var i=this.options,r=i.textProperty,o=i.annotationsProperty,s=this.ed.cid,a=t.model;r&&a.prop(r,e,{textEditor:s,async:!1}),o&&a.prop(o,this.deepCloneAnnotations(n),{rewrite:!0,textEditor:s,async:!1})},updateSVGTextNode:function(t,e,n){Mt(t).text(e,{annotations:n})},close:function(){if(this.ed){if(this.ed.options.annotateUrls){var t=this.ed.getSelectionStart();this.findAnnotationsUnderCursor().find(function(t){return!!t.url&&t})||this.ed.annotateURLBeforeCaret(t)&&this.applyAnnotations(this.getAnnotations())}this.ed.remove(),this.cellViewUnderEdit&&(this.cellViewUnderEdit.options.interactive=this.cellViewUnderEditInteractiveOption),this.ed=this.cellViewUnderEdit=this.cellViewUnderEditInteractiveOption=void 0}},applyAnnotations:function(t){var e=this.options,n=this.ed;if(n&&e.update){e.cellView&&e.annotationsProperty?(e.cellView.model.prop(e.annotationsProperty,this.deepCloneAnnotations(t),{rewrite:!0,textEditor:n.cid}),n.setAnnotations(t)):Mt(n.options.text).text(n.getTextContent(),{annotations:t});var i=this.getSelectionRange();0<this.getSelectionLength()?n.select(i.start,i.end):n.setCaret()}},deepCloneAnnotations:function(t){try{return JSON.parse(JSON.stringify(t))}catch(t){return}},proxy:function(t,e){if(this.ed)return this.ed[t].apply(this.ed,e)},setCurrentAnnotation:function(t){return this.proxy("setCurrentAnnotation",arguments)},getAnnotations:function(){return this.proxy("getAnnotations",arguments)},setCaret:function(){return this.proxy("setCaret",arguments)},deselect:function(){return this.proxy("deselect",arguments)},selectAll:function(){return this.proxy("selectAll",arguments)},select:function(){return this.proxy("select",arguments)},getNumberOfChars:function(){return this.proxy("getNumberOfChars",arguments)},getCharNumFromEvent:function(){return this.proxy("getCharNumFromEvent",arguments)},getWordBoundary:function(){return this.proxy("getWordBoundary",arguments)},findAnnotationsUnderCursor:function(){return this.proxy("findAnnotationsUnderCursor",[this.ed.getAnnotations(),this.ed.getSelectionStart()])},findAnnotationsInSelection:function(){if(this.ed){var t=this.ed.getSelectionRange();return this.proxy("findAnnotationsInSelection",[this.ed.getAnnotations(),t.start,t.end])}},getSelectionAttrs:function(t){if(this.ed){var e=this.ed.getSelectionRange();return this.proxy("getSelectionAttrs",[e,t])}},getSelectionLength:function(){return this.proxy("getSelectionLength",arguments)},getSelectionRange:function(){return this.proxy("getSelectionRange",arguments)}},e.Events)),pa=dn.extend({className:"widget",references:[],constructor:function(t,e){this.availableReferences=e||{},dn.prototype.constructor.call(this,t)},updateAttrs:function(t){_t(this.$el,t)},bindEvents:function(){},validateReferences:function(){var t=this.references||[],e=[];return t.forEach(function(t){void 0===this.availableReferences[t]&&e.push(t)},this),e},getReference:function(t){return this.availableReferences[t]},getReferences:function(){return this.availableReferences},enable:function(){},disable:function(){},isDisabled:function(){return!1}}),ga=pa.extend({tagName:"label",events:{"change .input":"onChange",mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick"},documentEvents:{mouseup:"pointerup",touchend:"pointerup"},init:function(){Te(this,"pointerup")},render:function(){var t=this.options,e=i("<span/>").text(t.label||"");return this.$input=i("<input/>",{type:"checkbox",class:"input"}).prop("checked",!!t.value),this.$span=i("<span/>"),this.$el.append([e,this.$input,this.$span]),this},onChange:function(t){this.trigger("change",!!t.target.checked,t)},pointerdown:function(t){t=vt(t),this.$el.addClass("is-in-action"),this.trigger("pointerdown",t),this.delegateDocumentEvents()},pointerclick:function(t){t=vt(t),this.trigger("pointerclick",t)},pointerup:function(t){t=vt(t),this.undelegateDocumentEvents(),this.trigger("pointerup",t),this.$el.removeClass("is-in-action"),"touchend"===t.type&&(this.$input.trigger("click"),t.preventDefault())},isDisabled:function(){return this.$input.prop("disabled")},enable:function(){this.$el.removeClass("disabled"),this.$input.prop("disabled",!1)},disable:function(){this.$el.addClass("disabled"),this.$input.prop("disabled",!0)}}),ma=pa.extend({tagName:"label",events:{"change input.toggle":"onChange","click input.toggle":"pointerclick",mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup"},documentEvents:{mouseup:"pointerup",touchend:"pointerup"},init:function(){Te(this,"pointerup")},render:function(){var t=this.options,e=i("<span/>").text(t.label||""),n=i("<span><i/></span>");this.$input=i("<input/>",{type:"checkbox",class:"toggle"}).prop("checked",!!t.value);var r=i("<div/>").addClass(t.type);return this.$el.append([e,r.append(this.$input,n)]),this},onChange:function(t){this.trigger("change",!!t.target.checked,t)},pointerclick:function(t){t=vt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=vt(t),this.$el.addClass("is-in-action"),this.trigger("pointerdown",t),this.delegateDocumentEvents()},pointerup:function(t){t=vt(t),this.undelegateDocumentEvents(),this.$el.removeClass("is-in-action"),this.trigger("pointerup",t),"touchend"===t.type&&(this.$input.trigger("click"),t.preventDefault())},isDisabled:function(){return this.$input.prop("disabled")},enable:function(){this.$el.removeClass("disabled"),this.$input.prop("disabled",!1)},disable:function(){this.$el.addClass("disabled"),this.$input.prop("disabled",!0)}}),va=pa.extend({render:function(){return this.options.width&&this.$el.css({width:this.options.width}),this}}),ya=pa.extend({tagName:"label",render:function(){return this.$el.text(this.options.text),this}}),ba=pa.extend({events:{"change .input":"onChange","input .input":"onChange"},render:function(){var t,e=this.options;return this.$output=i("<output/>").text(e.value),t=i("<span/>").addClass("units").text(e.unit),this.$input=i("<input/>",{type:"range",name:e.type,min:e.min,max:e.max,step:e.step,class:"input"}).val(e.value),this.$el.append([this.$input,this.$output,t]),this},onChange:function(t){var e=this.getValue();e!==this.currentValue&&(this.currentValue=e,this.$output.text(e),this.trigger("change",e,t))},getValue:function(){return parseInt(this.$input.val(),10)},setValue:function(t,e){void 0===e&&(e={}),this.$input.val(t),e.silent?(t=this.getValue(),this.currentValue=t,this.$output.text(t)):this.$input.trigger("change")},isDisabled:function(){return this.$input.prop("disabled")},enable:function(){this.$input.prop("disabled",!1)},disable:function(){this.$input.prop("disabled",!0)}}),Ca=pa.extend({render:function(){var t=Ie(this.options,"type","group","index");return this.selectBox=new Ks(t),this.selectBox.render().$el.appendTo(this.el),this},bindEvents:function(){this.selectBox.on("all",this.trigger,this)},isDisabled:function(){return this.selectBox.isDisabled()},enable:function(){this.selectBox.enable()},disable:function(){this.selectBox.disable()}}),Ia=pa.extend({events:{mousedown:"pointerdown",mouseup:"pointerup",touchend:"pointerup",touchstart:"pointerdown",click:"pointerclick"},tagName:"button",render:function(){var t=this.options;return this.$el.text(t.text),this},pointerclick:function(t){t=vt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=vt(t),this.trigger("pointerdown",t)},pointerup:function(t){t=vt(t),this.trigger("pointerup",t),"touchend"===t.type&&(this.$el.trigger("click"),t.preventDefault())},isDisabled:function(){return this.$el.prop("disabled")},enable:function(){this.$el.prop("disabled",!1)},disable:function(){this.$el.prop("disabled",!0)}}),Ea=pa.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout"},tagName:"div",render:function(){var t=this.options;return this.$label=i("<label/>").text(t.label),this.$text=i("<input/>",{type:"text",class:"input"}).val(t.value),this.$input=i("<div/>").addClass("input-wrapper").append(this.$text),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t=vt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=vt(t),this.trigger("pointerdown",t),"touchstart"===t.type&&this.$text.trigger("focus")},pointerup:function(t){t=vt(t),this.trigger("pointerup",t),"touchend"===t.type&&(this.$text.trigger("click"),t.preventDefault())},pointerfocusin:function(t){t=vt(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=vt(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)},isDisabled:function(){return this.$text.prop("disabled")},enable:function(){this.$text.prop("disabled",!1)},disable:function(){this.$text.prop("disabled",!0)}}),Ta=pa.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout"},tagName:"div",render:function(){var t=this.options;return this.$label=i("<label/>").text(t.label),this.$number=i("<input/>",{type:"number",class:"number",max:t.max,min:t.min}).val(t.value),this.$input=i("<div/>").addClass("input-wrapper").append(this.$number),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t=vt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=vt(t),this.trigger("pointerdown",t),"touchstart"===t.type&&this.$number.trigger("focus")},pointerup:function(t){t=vt(t),this.trigger("pointerup",t),"touchend"===t.type&&(this.$number.trigger("click"),t.preventDefault())},pointerfocusin:function(t){t=vt(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=vt(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)},isDisabled:function(){return this.$number.prop("disabled")},enable:function(){this.$number.prop("disabled",!1)},disable:function(){this.$number.prop("disabled",!0)}}),wa=pa.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout"},tagName:"div",render:function(){var t=this.options;return this.$label=i("<label/>").text(t.label),this.$textarea=i("<textarea/>",{class:"textarea"}).text(t.value),this.$input=i("<div/>").addClass("input-wrapper").append(this.$textarea),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t.preventDefault(),t=vt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=vt(t),this.trigger("pointerdown",t),"touchstart"===t.type&&this.$textarea.focus()},pointerup:function(t){t=vt(t),this.trigger("pointerup",t),"touchend"===t.type&&(this.$textarea.trigger("click"),t.preventDefault())},pointerfocusin:function(t){t=vt(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=vt(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)},isDisabled:function(){return this.$textarea.prop("disabled")},enable:function(){this.$textarea.prop("disabled",!1)},disable:function(){this.$textarea.prop("disabled",!0)}}),xa=pa.extend({render:function(){var t=Ie(this.options,"type","group","index");return this.selectButtonGroup=new Zs(t),this.selectButtonGroup.render().$el.appendTo(this.el),this},bindEvents:function(){this.selectButtonGroup.on("all",this.trigger,this)},isDisabled:function(){return this.selectButtonGroup.isDisabled()},enable:function(){this.selectButtonGroup.enable()},disable:function(){this.selectButtonGroup.disable()}}),_a=Ia.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},bindEvents:function(){var t=this;if(this.options.autoToggle){var e=this.getReferences().paperScroller;this.updateAvailability(e),this.listenTo(e.options.paper,"scale",function(){return t.updateAvailability(e)})}},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoom(e.step,{max:e.max,grid:e.step}),Ia.prototype.pointerdown.call(this,t)},updateAvailability:function(t){t.zoom()<this.options.max?this.enable():this.disable()}}),Da=Ia.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},bindEvents:function(){var t=this;if(this.options.autoToggle){var e=this.getReferences().paperScroller;this.updateAvailability(e),this.listenTo(e.options.paper,"scale",function(){return t.updateAvailability(e)})}},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoom(-e.step,{min:e.min,grid:e.step}),Ia.prototype.pointerdown.call(this,t)},updateAvailability:function(t){t.zoom()>this.options.min?this.enable():this.disable()}}),Aa=Ia.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoomToFit({padding:20,scaleGrid:e.step,minScale:e.min,maxScale:e.max}),Ia.prototype.pointerdown.call(this,t)}}),Oa=ba.extend({references:["paperScroller"],options:{min:20,max:500,step:20,value:100,unit:" %"},bindEvents:function(){var t=this,e=this.getReferences().paperScroller;this.on("change",function(t){e.zoom(t/100,{absolute:!0,grid:this.options.step/100})},this),this.listenTo(e.options.paper,"scale",function(e){t.setValue(Math.floor(100*e),{silent:!0})})}}),Sa=Ia.extend({references:["commandManager"],bindEvents:function(){var t=this;if(this.options.autoToggle){var e=this.getReferences().commandManager;this.updateAvailability(e),this.listenTo(e,"stack",function(){return t.updateAvailability(e)})}},pointerclick:function(){this.getReferences().commandManager.undo()},updateAvailability:function(t){t.hasUndo()?this.enable():this.disable()}}),Ra=Ia.extend({references:["commandManager"],bindEvents:function(){var t=this;if(this.options.autoToggle){var e=this.getReferences().commandManager;this.updateAvailability(e),this.listenTo(e,"stack",function(){return t.updateAvailability(e)})}},pointerclick:function(){this.getReferences().commandManager.redo()},updateAvailability:function(t){t.hasRedo()?this.enable():this.disable()}}),ka=Ia.extend({onRender:function(){var t=this.target=i(this.options.target)[0];t&&!i.contains(window.top.document,t)&&this.$el.hide()},pointerclick:function(){Dt(this.target)}}),Na={checkbox:ga,toggle:ma,separator:va,label:ya,range:ba,selectBox:Ca,button:Ia,inputText:Ea,inputNumber:Ta,textarea:wa,selectButtonGroup:xa,zoomIn:_a,zoomOut:Da,zoomToFit:Aa,zoomSlider:Oa,undo:Sa,redo:Ra,fullscreen:ka};function Ma(t){t=t||{},this.comparator=t.comparator||function(t,e){return t-e},this.index={},this.data=t.data||[],this.heapify()}pa.create=function(t,e){var n=xe(Ae(t)?t:t.type);if(!le(Na[n]))throw new Error('Widget: unable to find widget: "'+n+'"');var i=new Na[n](t,e),r=i.validateReferences(e);if(0<r.length)throw new Error('Widget: "'+n+'" missing dependency: '+r.join(", "));return i.render(),i.updateAttrs(t.attrs),i.bindEvents(),i.$el.attr("data-type",n),t.name&&i.$el.attr("data-name",t.name),i};var Pa=dn.extend({options:{autoToggle:!1},align:["left","right"],className:"toolbar",defaultGroup:"default",widgets:[],groupViews:[],init:function(){this.tools=ue(this.options.tools),this.groups=this.options.groups||{}},getWidgetByName:function(t){return this.widgets.find(function(e){return e.options.name===t})},getWidgets:function(){return this.widgets},groupsWithItemsPairs:function(){var t={};this.tools.forEach(function(e){var n=e.group||this.defaultGroup;t[n]=t[n]||{items:[],group:{}},t[n].items.push(e),t[n].group=this.groups[n]||{}},this);for(var e=Object.keys(t),n=[],i=0,r=e.length;i<r;i++){var o=e[i];n.push([o,t[o]])}var s=fe(n,function(t){return t[1].group.index});return fe(s,function(t){return t[1].group.align||"left"})},render:function(){var t=this.groupsWithItemsPairs(),e=!1;return t.forEach(function(t){var n=t[0],i=t[1],r=this.renderGroup(n,i);!e&&i.group.align&&"right"===i.group.align&&(e=!0,r.addClass("group-first")),r.appendTo(this.el)},this),this},renderGroup:function(t,e){var n=this.options,i=n.references,r=n.autoToggle,o=new La({name:t,align:e.group.align,items:e.items,references:i,autoToggle:r});return this.groupViews.push(o),o.on("all",(function(){this.trigger.apply(this,arguments)}).bind(this)),o.render(),this.widgets=this.widgets.concat(o.widgets),o.$el},onRemove:function(){ee(this.groupViews,"off"),ee(this.groupViews,"remove")}}),La=dn.extend({className:"toolbar-group",init:function(){this.widgets=[]},onRender:function(){this.$el.attr("data-group",this.options.name),this.$el.addClass(this.options.align),this.renderItems()},renderItems:function(){ue(this.options.items).forEach(function(t){var e=this.createWidget(t);this.$el.append(e.$el)},this)},createWidget:function(t){var e=this.options,n=e.references,i=e.autoToggle,r=Ae(t)?{autoToggle:i,type:t}:Object.assign({autoToggle:i},t),o=pa.create(r,n);return o.on("all",(function(e){var n=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t.name+":"+e].concat(n))}).bind(this)),this.widgets.push(o),o},onRemove:function(){ee(this.widgets,"off"),ee(this.widgets,"remove")}}),Ka=dn.extend({className:"tooltip",options:{left:void 0,right:void 0,top:void 0,bottom:void 0,position:void 0,positionSelector:void 0,direction:"auto",minResizedWidth:100,padding:0,rootTarget:null,target:null,trigger:"hover",viewport:{selector:null,padding:0},dataAttributePrefix:"tooltip",template:'<div class="tooltip-arrow"/><div class="tooltip-arrow-mask"/><div class="tooltip-content"/>',animation:!1},init:function(){this.eventNamespace=("."+this.className+this.cid).replace(/ /g,"_"),this.settings={},this.container=document.body;var t=this.options,e=t.trigger,n=t.rootTarget,r=t.target,o=t.animation;void 0===o&&(o=!1);var s=e.split(" ");Te(this,"render","hide","show","toggle","isVisible","position"),n?(this.$rootTarget=i(n),s.forEach(function(t){switch(t){case"click":this.$rootTarget.on("click"+this.eventNamespace,this.options.target,this.toggle);break;case"hover":this.$rootTarget.on("mouseover"+this.eventNamespace,this.options.target,this.render);break;case"focus":this.$rootTarget.on("focusin"+this.eventNamespace,this.options.target,this.render)}},this)):(this.$target=i(r),s.forEach(function(t){switch(t){case"click":this.$target.on("click"+this.eventNamespace,this.toggle);break;case"hover":this.$target.on("mouseover"+this.eventNamespace,this.render);break;case"focus":this.$target.on("focusin"+this.eventNamespace,this.render)}},this)),o&&this.animate(o),this.$el.append(this.options.template)},animate:function(t){void 0===t&&(t={});var e=t.duration;void 0===e&&(e="500ms");var n=t.delay;void 0===n&&(n="400ms");var i=t.timingFunction;void 0===i&&(i="ease"),this.$el.addClass("animated").css({animationDelay:n,animationDuration:e,animationTimingFunction:i})},onRemove:function(){this.options.rootTarget?this.$rootTarget.off(this.eventNamespace):this.$target.off(this.eventNamespace)},hide:function(){var t=this.settings;t&&(this.unbindHideActions(t.currentTarget),this.$el.removeClass(t.className),this.$el.remove())},show:function(t){this.render(t||{target:this.options.target})},toggle:function(t){this.isVisible()?this.hide():this.show(t)},isVisible:function(){return document.body.contains(this.el)},render:function(t){var e,n=void 0!==t.x&&void 0!==t.y?t:null,r=i(t.target).closest(this.options.target)[0],o=this.settings=this.getTooltipSettings(r);o.currentTarget=r,this.bindHideActions(r),e=n?{x:n.x,y:n.y,width:1,height:1}:wt(r),this.$(".tooltip-content").html(o.content),this.$el.hide(),this.$el.removeClass("left right top bottom"),this.$el.addClass(o.className),i(this.container).append(this.$el);var s=this.$("img");s.length?s.on("load",(function(){this.position(e),this.$el.addClass("rendered")}).bind(this)):(this.position(e),this.$el.addClass("rendered"))},getTooltipSettings:function(t){var e=this.loadDefinitionFromElementData(t);return this.evaluateOptions(t,e)},unbindHideActions:function(t){var e=this.eventNamespace+".remove";i(t).off(e),clearInterval(this.interval)},bindHideOnRemoveTarget:function(t){clearInterval(this.interval),this.interval=setInterval((function(){i.contains(document,t)||(clearInterval(this.interval),this.hide())}).bind(this),500)},bindHideActions:function(t){var e=this.settings,n=i(t),r=this.eventNamespace+".remove";this.bindHideOnRemoveTarget(t),this.options.trigger.split(" ").forEach(function(t){var i={hover:["mouseout","mousedown"],focus:["focusout"]}[t]||[];e.hideTrigger&&(i=e.hideTrigger.split(" ")||[]),i.forEach(function(t){n.on(t+r,this.hide)},this)},this)},evaluateOptions:function(t,e){var n=Jt({},e=e||{},this.options);return we(n,function(i,r){var o=le(i)?i(t):i;n[r]=null==o?e[r]:o}),this.normalizePosition(n),n},loadDefinitionFromElementData:function(t){if(!t)return{};var e=this.getAllAttrs(t,"data-"+this.options.dataAttributePrefix),n={};return we(e,function(t,e){""===e&&(e="content"),function(t){return"left"===t||"bottom"===t||"top"===t||"right"===t}(e)||(n[e]=t)}),n},getAllAttrs:function(t,e){for(var n=e||"",i=t.attributes,r={},o=0,s=i.length;o<s;o++){var a=i[o];a&&a.name.startsWith(n)&&(r[xe(a.name.slice(n.length))]=a.value)}return r},normalizePosition:function(t){var e=t.left||t.right||t.top||t.bottom;!t.position&&e&&(t.left&&(t.position="left"),t.right&&(t.position="right"),t.top&&(t.position="top"),t.bottom&&(t.position="bottom")),!t.positionSelector&&e&&(t.positionSelector=e)},position:function(t){var e=this.settings;this.$el.show(),this.$el.css("width","auto");var n=wt(this.container),i=this.getTooltipBBox(t,n);this.$el.css({left:i.x,top:i.y,width:i.width||"auto"});var r={};"left"===e.position||"right"===e.position?r.top=t.y+t.height/2-i.y:"top"===e.position||"bottom"===e.position?r.left=t.x+t.width/2-i.x:r.top=t.y+t.height/2-i.y,r.top-=n.y,r.left-=n.x,this.$(".tooltip-arrow, .tooltip-arrow-mask").removeAttr("style").css(r),e.direction&&"off"!==e.direction&&this.$el.addClass("auto"===e.direction?e.position||"left":e.direction)},getViewportViewBBox:function(){var t=this.settings,e=wt(t.viewport.selector?i(t.currentTarget).closest(t.viewport.selector):"html");if(!t.viewport.selector){var n=i(window);e.width=n.width()+n.scrollLeft(),e.height=n.height()+n.scrollTop()}var r=t.viewport.padding||0;return e.x+=r,e.y+=r,e.width-=2*r,e.height-=2*r,e},basePositions:{left:function(t,e){var n={x:e.positionedBBox.x+e.positionedBBox.width+e.padding,y:e.targetBBox.y+e.targetBBox.height/2-e.tooltipBBox.height/2};if(t){var i=e.viewport.x+e.viewport.width-n.x;if(i>e.minWidth&&i<e.tooltipBBox.width+e.padding&&(n.width=i),i<e.minWidth)return this.settings.position="right",this.basePositions.right(!1,e)}return n},right:function(t,e){var n={x:e.positionedBBox.x-e.tooltipBBox.width-e.padding,y:e.targetBBox.y+e.targetBBox.height/2-e.tooltipBBox.height/2};if(t){var i=e.positionedBBox.x-e.padding-e.viewport.x;if(i>e.minWidth&&i<e.tooltipBBox.width+e.padding&&(n.width=i,n.x=e.viewport.x),i<e.minWidth)return this.settings.position="left",this.basePositions.left(!1,e)}return n},top:function(t,e){var n={x:e.targetBBox.x+e.targetBBox.width/2-e.tooltipBBox.width/2,y:e.positionedBBox.y+e.positionedBBox.height+e.padding};return t&&e.viewport.y+e.viewport.height-(e.positionedBBox.y+e.positionedBBox.height+e.padding)<e.tooltipBBox.height?(this.settings.position="bottom",this.basePositions.bottom(!1,e)):n},bottom:function(t,e){var n={x:e.targetBBox.x+e.targetBBox.width/2-e.tooltipBBox.width/2,y:e.positionedBBox.y-e.tooltipBBox.height-e.padding};return t&&e.positionedBBox.y-e.padding-e.viewport.y<e.tooltipBBox.height?(this.settings.position="top",this.basePositions.top(!1,e)):n}},getTooltipBBox:function(t,e){var n=this.settings,r=i(n.positionSelector),o=r[0]?wt(r[0]):t,s=this.measureTooltipElement(),a=this.getViewportViewBBox(),l=n.position||"left",c=n.padding,u=Math.min(n.minResizedWidth,s.width+c),h={padding:c,targetBBox:t,positionedBBox:o,tooltipBBox:s,viewport:a},d=this.basePositions[l].call(this,0<u,h);return d.x-=e.x,d.y-=e.y,d.y<a.y?d.y=a.y:d.y+s.height>a.y+a.height&&(d.y=a.y+a.height-s.height),d.x<a.x?d.x=a.x:d.x+s.width>a.x+a.width&&(d.x=a.x+a.width-s.width),d},measureTooltipElement:function(){var t=this.$el.clone().appendTo(i("body")).css({left:-1e3,top:-500}),e={width:t.outerWidth(),height:t.outerHeight()};return t.remove(),e}}),Ba=dn.extend({MINIMAL_PREVIEW_SIZE:10,className:"tree-layout",documentEvents:{mousemove:"onPointermove",touchmove:"onPointermove",mouseup:"onPointerup",touchend:"onPointerup"},options:{previewAttrs:{parent:{rx:2,ry:2}},useModelGeometry:!1,clone:function(t){return t.clone()},canInteract:function(){return!0},validateConnection:null,paperConstructor:qr,paperOptions:null,reconnectElements:null,translateElements:null},init:function(){this.toggleDefaultInteraction(!1),this.startListening(),this.render(),this.onSetTheme(null,this.theme)},startListening:function(){var t=this.options.paper;this.listenTo(t,"element:pointerdown",this.canInteract(this.onPointerdown))},toggleDefaultInteraction:function(t){this.options.paper.setInteractivity(t)},render:function(){var t=this.options.paper;this.$activeBox=i("<div>").addClass("tree-layout-box active hidden").appendTo(this.el);var e=Jt({},this.options.paperOptions,{interactive:!1,width:"100%",height:"100%"});return this.draggingPaper=new this.options.paperConstructor(e),this.draggingPaper.undelegateEvents(),this.$translateBox=i("<div>").addClass("tree-layout-box translate hidden").append(this.draggingPaper.render().el).appendTo(this.el),this.$mask=i("<div>").addClass("tree-layout-mask"),this.svgViewport=Mt(t.cells),this.svgPreviewChild=Mt(this.renderChildPreview()).attr(this.options.previewAttrs.child||{}).addClass("tree-layout-preview child"),this.svgPreviewConnection=Mt(this.renderConnectionPreview()).attr(this.options.previewAttrs.link||{}).addClass("tree-layout-preview link"),this.svgPreviewParent=Mt(this.renderParentPreview()).attr(this.options.previewAttrs.parent||{}).addClass("tree-layout-preview parent"),this.svgPreview=Mt("g").addClass("tree-layout-preview-group").append([this.svgPreviewConnection,this.svgPreviewParent,this.svgPreviewChild]),this.$el.appendTo(t.el),this},renderChildPreview:function(){return Mt("circle")},renderParentPreview:function(){return Mt("rect")},renderConnectionPreview:function(){return Mt("path")},onSetTheme:function(t,e){[this.svgPreview,this.$mask].forEach(function(n){n&&(t&&n.removeClass(this.themeClassNamePrefix+t),n.addClass(this.themeClassNamePrefix+e))},this)},onRemove:function(){this.svgPreview.remove()},toggleDropping:function(t){this.$mask.toggleClass("dropping-not-allowed",!t),this.$translateBox.toggleClass("no-drop",!t)},canDrop:function(){return this.isActive()&&!this.$translateBox.hasClass("no-drop")},isActive:function(){return!this.$translateBox.hasClass("hidden")},_startDrag:function(t,e,n){var i=this.options.paper;this.$mask.appendTo(i.el),this.toggleDropping(!1),this.ctm=i.matrix();var r=t[0],o=r.findView(i).getBBox({useModelGeometry:this.options.useModelGeometry});this.updateBox(this.$translateBox,Qt({x:e,y:n},o)),this.updateBox(this.$activeBox,o),this.$activeBox.removeClass("hidden"),this.$translateBox.removeClass("hidden"),this.prepareDraggingPaper(r)},updateBox:function(t,e){t.css({width:e.width,height:e.height,left:e.x,top:e.y})},positionTranslateBox:function(t){var e=Mt.transformPoint(t,this.ctm);this.$translateBox.css({left:e.x,top:e.y})},prepareDraggingPaper:function(t){var e=this.options.clone(t).position(0,0);this.draggingPaper.scale(this.ctm.a,this.ctm.d),this.draggingPaper.model.resetCells([e])},_doDrag:function(t,e,n){var i,r,o=this.model,s={x:e,y:n};if(this.candidate&&(this.candidate=null,this.hidePreview()),this.positionTranslateBox(s),(i=o.getMinimalRootAreaByPoint(s))&&(r=i.findMinimalAreaByPoint(s,{expandBy:Math.min(o.get("siblingGap"),o.get("gap"))/2})),r){var a=this.findDirection(r,s),l=r.getLayoutSiblings(a),c=l.getSiblingRankByPoint(s);ue(t).every(function(t){return this.isConnectionValid(t,l,c)},this)?(this.candidate={id:r.root.id,direction:a,siblingRank:c},this.updatePreview(l,c),this.showPreview(),this.toggleDropping(!0)):this.toggleDropping(!1)}else this.toggleDropping(!0)},_finishDrag:function(t,e,n){this.$mask.remove().removeClass("dropping-not-allowed");var i=this.candidate,r=this.options;if(i){var o=r.reconnectElements;"function"==typeof o?o.apply(this,[t,r.paper.getModelById(i.id),i.siblingRank,i.direction,this]):this.reconnectElements(t,i),this.candidate=null}else if(this.canDrop()){var s=r.translateElements;"function"==typeof s?s.call(this,t,e,n,this):this.translateElements(t,e,n)}this.$activeBox.addClass("hidden"),this.$translateBox.addClass("hidden"),this.hidePreview()},reconnectElement:function(t,e){var n=e.siblingRank+.5,i={direction:e.direction,siblingRank:n,ui:!0};if(!this.model.reconnectElement(t,e.id,i)){var r=this.options.paper,o=r.getDefaultLink(t.findView(r));o.set({source:{id:e.id},target:{id:t.id}}),o.addTo(r.model,i),this.model.changeSiblingRank(t,n,i),this.model.changeDirection(t,e.direction,i);var s=this.model.getAttribute(t,"direction");this.model.updateDirections(t,[s,e.direction],i)}},reconnectElements:function(t,e){t.forEach(function(t){this.reconnectElement(t,e)},this),this.layout()},translateElement:function(t,e,n){var i=this.model.graph.getConnectedLinks(t,{inbound:!0});ee(i,"remove");var r=t.get("size");t.set("position",{x:e-r.width/2,y:n-r.height/2},{ui:!0})},translateElements:function(t,e,n){t.forEach(function(t){this.translateElement(t,e,n)},this),this.layout()},layout:function(){this.model.layout({ui:!0,treeLayoutView:this.cid})},updatePreview:function(t,e){var n=t.parentArea.root,i=Math.max(this.model.get("siblingGap")/2,this.MINIMAL_PREVIEW_SIZE),r={width:i,height:i},o=t.getNeighborPointFromRank(e),s=t.getConnectionPoints(o,{ignoreSiblings:!0}),a=t.getParentConnectionPoint(),l=t.getChildConnectionPoint(o,r);this.updateParentPreview(n.position(),n.size(),n),this.updateChildPreview(o,r),this.updateConnectionPreview(a,l,s)},showPreview:function(){this.svgViewport.append(this.svgPreview)},hidePreview:function(){this.svgPreview.remove()},updateParentPreview:function(t,e){this.svgPreviewParent.attr({x:t.x,y:t.y,width:e.width,height:e.height})},updateChildPreview:function(t,e){this.svgPreviewChild.attr({cx:t.x,cy:t.y,r:e.width/2})},updateConnectionPreview:function(t,e,n){this.svgPreviewConnection.attr({d:ji(t,e,n,{})})},findDirection:function(t,e){var n,i=t.root.get("layout")||t.getType();switch(i){case"BL-BR":case"TL-TR":case"L-R":return n=i.split("-"),e.x>t.rootCX?n[1]:n[0];case"BL-TL":case"BR-TR":case"B-T":return n=i.split("-"),e.y>t.rootCY?n[0]:n[1];case"L":case"R":case"T":case"B":case"TR":case"TL":case"BR":case"BL":return i;default:return t.direction}},isConnectionValid:function(t,e,n){var i=e.parentArea.root;if(t.id==i.id)return!1;if(this.model.graph.isSuccessor(t,e.parentArea.root))return!1;var r=this.model.getLayoutArea(t);if(r.parentArea&&r.parentArea==e.parentArea&&r.direction==e.direction){var o=r.siblingRank-n;if(0==o||1==o)return!1}var s=this.options.validateConnection;return"function"!=typeof s||s.call(this,t,i,this)},canInteract:function(t){return(function(e){this.options.canInteract(e)&&t.apply(this,arguments)}).bind(this)},startDragging:function(t){var e=Array.isArray(t)?t:[t];se(e)||this.delegateDocumentEvents(null,{moveCounter:0,draggedElements:e})},onPointerdown:function(t){this.startDragging(t.model)},onPointermove:function(t){var e=t.data,n=this.options.paper,i=n.clientToLocalPoint({x:t.clientX,y:t.clientY});e.moveCounter===n.options.clickThreshold?this._startDrag(e.draggedElements,i.x,i.y):e.moveCounter>n.options.clickThreshold&&this._doDrag(e.draggedElements,i.x,i.y),e.moveCounter++},onPointerup:function(t){var e=t.data,n=this.options.paper;if(e.moveCounter>=n.options.clickThreshold){var i=n.clientToLocalPoint({x:t.clientX,y:t.clientY});this._finishDrag(e.draggedElements,i.x,i.y)}this.undelegateDocumentEvents()}}),za={PathDrawer:oa,Clipboard:Ls,ContextToolbar:zs,Dialog:js,FlashMessage:Gs,FreeTransform:Fs,Halo:Us,Inspector:Ws,Keyboard:Hs,Lightbox:na,Navigator:ia,PaperScroller:ra,ColorPalette:Bs,PathEditor:sa,Popup:aa,SelectBox:Ks,SelectButtonGroup:Zs,Selection:la,SelectionView:ca,Snaplines:ua,Stencil:da,TextEditor:fa,Toolbar:Pa,Tooltip:Ka,TreeLayoutView:Ba,widgets:Na,Widget:pa},ja={Local:{prefix:"joint.storage",insert:function(t,e,n){var i=e.id||gt(),r=this.loadIndex(t);-1===r.keys.indexOf(i)&&r.keys.push(i),this.setItem(this.docKey(t,i),e),this.setItem(this.indexKey(t),r),this.callback(n,null,Jt({},e,{id:i}))},find:function(t,e,n){var i=this.loadIndex(t),r=[];if(se(e))i.keys.forEach(function(e){var i=this.getItem(this.docKey(t,e));i||this.callback(n,new Error("Storage incosistency. No document found for an ID "+e+" from index.")),r.push(i)},this),this.callback(n,null,r);else if(e.id){var o=this.getItem(this.docKey(t,e.id));this.callback(n,null,o?[o]:[])}else this.callback(n,null,[])},remove:function(t,e,n){var i=this.loadIndex(t);se(e)?(i.keys.forEach(function(e){localStorage.removeItem(this.docKey(t,e))},this),localStorage.removeItem(this.indexKey(t)),this.callback(n,null)):e.id&&(i.keys=i.keys.filter(function(t){return t!==e.id}),localStorage.removeItem(this.docKey(t,e.id)),this.setItem(this.indexKey(t),i),this.callback(n,null))},callback:function(t,e,n){t&&setTimeout(function(){t(e,n)},1)},setItem:function(t,e){localStorage.setItem(t,JSON.stringify(e))},getItem:function(t){var e=localStorage.getItem(t);return e?JSON.parse(e):e},loadIndex:function(t){var e=this.getItem(this.indexKey(t))||{};return e.keys=e.keys||[],e},docKey:function(t,e){return this.prefix+"."+t+".docs."+e},indexKey:function(t){return this.prefix+"."+t+".index"}}};function Ga(t,e,n){n=n||function(t,e){return 1};var i={};i[e]=0;var r,o,s,a,l={},c=new Ma;for(var u in t)u!==e&&(i[u]=1/0),c.insert(i[u],u,u);for(var h={};!c.isEmpty();)for(h[r=c.remove()]=!0,o=t[r]||[],s=0;s<o.length;s++)h[u=o[s]]||(a=i[r]+n(r,u))<i[u]&&(i[u]=a,l[u]=r,c.updatePriority(u,a));return l}Ma.prototype.isEmpty=function(){return 0===this.data.length},Ma.prototype.insert=function(t,e,n){var i={priority:t,value:e};this.data.push(i);var r=this.data.length-1;n&&(i.id=n,this.index[n]=r),this.bubbleUp(r)},Ma.prototype.peek=function(){return this.data[0]&&this.data[0].value},Ma.prototype.peekPriority=function(){return this.data[0]&&this.data[0].priority},Ma.prototype.updatePriority=function(t,e){var n=this.index[t];if(null==n)throw new Error("Node with id "+t+" was not found in the heap.");var i=this.data,r=i[n].priority,o=this.comparator(e,r);o<0?(i[n].priority=e,this.bubbleUp(n)):0<o&&(i[n].priority=e,this.bubbleDown(n))},Ma.prototype.remove=function(){var t=this.data,e=t[0],n=t.pop();return this.index[t.length]=null,0<t.length&&((t[0]=n).id&&(this.index[n.id]=0),this.bubbleDown(0)),e&&e.value},Ma.prototype.heapify=function(){for(var t=0;t<this.data.length;t++)this.bubbleUp(t)},Ma.prototype.bubbleUp=function(t){for(var e,n,i=this.data;0<t&&(e=t-1>>>1,this.comparator(i[t].priority,i[e].priority)<0);)n=i[e],i[e]=i[t],i[t].id&&(this.index[i[t].id]=e),i[t]=n,i[t].id&&(this.index[i[t].id]=t),t=e},Ma.prototype.bubbleDown=function(t){for(var e=this.data,n=e.length-1;;){var i=1+(t<<1),r=1+i,o=t;if(i<=n&&this.comparator(e[i].priority,e[o].priority)<0&&(o=i),r<=n&&this.comparator(e[r].priority,e[o].priority)<0&&(o=r),o===t)break;var s=e[o];e[o]=e[t],e[t].id&&(this.index[e[t].id]=o),e[t]=s,e[t].id&&(this.index[e[t].id]=t),t=o}};var Fa={PriorityQueue:Ma,Dijkstra:Ga};function Va(t,e,n){if(n=n||{},void 0===t)throw new Error("The the dia.Paper is a mandatory option.");t.trigger("beforeexport",n);var r=Mt(t.svg).clone(),o=r.node,s=r.findOne("."+lt("layers")),a=n.area||t.paperToLocalRect(t.getContentBBox()),l=n.preserveDimensions;l&&r.attr({width:l.width||a.width,height:l.height||a.height}),r.removeAttr("style").attr("viewBox",[a.x,a.y,a.width,a.height].join(" ")),s.removeAttr("transform"),!1!==n.useComputedStyles&&function(t,e){for(var n=Array.from(t.querySelectorAll("*")),r=Array.from(e.querySelectorAll("*")),o=t.ownerDocument,s=o.styleSheets.length,a=[],l=s-1;0<=l;l--)a[l]=o.styleSheets[l],o.styleSheets[l].disabled=!0;var c={};n.forEach(function(t,e){var n=window.getComputedStyle(t,null),i={};we(n,function(t){i[t]=n.getPropertyValue(t)}),c[e]=i}),s!=o.styleSheets.length&&a.forEach(function(t,e){o.styleSheets[e]=t});for(var u=0;u<s;u++)o.styleSheets[u].disabled=!1;var h={};n.forEach(function(t,e){var n=window.getComputedStyle(t,null),i=c[e],r={};we(n,function(t){isNaN(t)&&n.getPropertyValue(t)!==i[t]&&(r[t]=n.getPropertyValue(t))}),h[e]=r}),r.forEach(function(t,e){i(t).css(h[e])})}(t.svg,o);var c=n.stylesheet;function u(){var i=n.beforeSerialize;if("function"==typeof i){var r=i.call(t,o,t);r instanceof SVGElement&&(o=r)}e(function(t){return(new XMLSerializer).serializeToString(t).replace(/&nbsp;/g,"\xa0")}(o))}if(Ae(c)&&function(t,e){var n=t.ownerDocument.implementation.createDocument(null,"xml",null);Mt(t).prepend(Mt("style",{type:"text/css"},[n.createCDATASection(e)]))}(r.node,c),t.trigger("afterexport",n),n.convertImagesToDataUris){var h=r.find("image").map(tl);i.when.apply(i,h).then(function(){return u()})}else u()}qr.prototype.print=function(t){var e=$a(t),n=Ua.call(this,e),i={sheetSizePx:Za(e)};e.ready(n,(function(e){Ha.call(this,e,t)}).bind(this),i)},qr.prototype.preparePrintArea=function(t,e){this.trigger("beforeprint",e);var n=i("<div/>").addClass("printarea"),r=i("<div/>").addClass(lt("print-paper")).css("position","relative");e.size&&n.addClass("printarea-size-"+e.size);var o=Mt(this.svg).clone(),s=o.findOne("."+lt("layers"));r.append(o.node);var a=Za(e),l=this.getArea(),c=this.scale(),u=c.sx,h=c.sy,d=this.translate(),f=d.tx,p=d.ty,g=Mt.createSVGMatrix().translate(f/u,p/h),m=Wa(l,t,a),v=m.scaleToFit,y=m.bBox;return r.css({left:0,top:0}),o.attr({width:y.width*v,height:y.height*v,style:"position:relative",viewBox:[y.x,y.y,y.width,y.height].join(" ")}),s.attr("transform",Mt.matrixToTransformString(g)),n.append([r.append([o.node])]),n.addClass("preview"),{$el:n,sheetSizePx:a}};var Ha=function(t,e){if(t){var n=i(document.body);n.addClass("joint-print");var r=this.$el.children().detach();t.forEach(function(t){t.removeClass("preview").addClass("print-ready").appendTo(n)});var o=!1,s=(function(){o||(o=!0,n.removeClass("joint-print"),t.forEach(function(t){t.remove()}),this.$el.append(r),i("#print-styles").remove(),this.trigger("afterprint",e),i(window).off("afterprint",s))}).bind(this);i(window).one("afterprint",s),setTimeout(s,200),window.print()}},Ua=function(t){var e,n=Xa.call(this,t),i=[];if(t.poster)for(var r=Ja(n,t.poster),o=qa(n,r),s=0;s<o.length;s++)e=this.preparePrintArea(o[s],t),i.push(e.$el);else e=this.preparePrintArea(n,t),i.push(e.$el);if(e){var a={width:e.sheetSizePx.cssWidth,height:e.sheetSizePx.cssHeight};Ya(a,t)}return i},Za=function(t){var e=Ft(t.margin),n=t.sheet;e.unit=t.marginUnit,n.unit=t.sheetUnit;var i="calc("+n.width+n.unit+" - "+(e.left+e.right)+e.unit+")",r="calc("+n.height+n.unit+" - "+(e.top+e.bottom)+e.unit+")",o=Qa.measure(i,r,"");return{cssWidth:i,cssHeight:r,width:o.width,height:o.height}},Wa=function(t,e,n){var i=new B({x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}),r=i.width/i.height,o=n.width/n.height;return{bBox:i,scaleToFit:o<r?n.width/i.width:n.height/i.height,fitHorizontal:o<r}},$a=function(t){var e=te({},t,{area:null,poster:!1,sheet:{width:210,height:297},sheetUnit:"mm",ready:function(t,e,n){e(t)},margin:.4,marginUnit:"in",padding:5});return e.area||(e.printingAll=!0),e},Ya=function(t,e){var n=function(t){return Object.keys(t).map(function(e){return e+":"+t[e]}).join(";")+";"}(t),r=Ft(e.margin),o=e.marginUnit;!function(t){var e=i("#print-styles"),n='<style type="text/css" id="print-styles">'+t+"</style>";e.length?e.html(t):i("head").append(n)}(["@media print {",".printarea.print-ready {",n,"}","@page {","margin:"+[r.top+o,r.right+o,r.bottom+o,r.left+o].join(" ")+";","size:"+(e.sheet.width+e.sheet.unit)+" "+(e.sheet.height+e.sheet.unit),"}",".printarea.preview {",n,"}","}"].join(""))},Xa=function(t){var e=t.area;if(!e){var n=Ft(t.padding);e=this.getContentArea().moveAndExpand({x:-n.left,y:-n.top,width:n.left+n.right,height:n.top+n.bottom})}return e},qa=function(t,e){for(var n,i=e.width,r=e.height,o=[],s=0,a=0,l=0,c=0;s<t.height;){for(;a<t.width&&(n=B(t.x+a,t.y+s,i,r),o.push(n),a+=i,!(200<c));)c++;if(c=a=0,s+=r,200<l)break;l++}return o},Ja=function(t,e){var n={width:e.width,height:e.height};return n.width||(n.width=Math.ceil(t.width/(e.columns||1))),n.height||(n.height=Math.ceil(t.height/(e.rows||1))),n},Qa={supportedUnits:{px:function(t){return t},mm:function(t){return this.millimeterSize*t},cm:function(t){return this.millimeterSize*t*10},in:function(t){return this.millimeterSize*t*25.4},pt:function(t){return this.millimeterSize*(25.4*t/72)},pc:function(t){return this.millimeterSize*(25.4*t/6)}},measure:function(t,e,n){n=n||"";var r=i("<div/>").css({display:"inline-block",position:"absolute",left:-15e3,top:-15e3,width:t+n,height:e+n}).appendTo(document.body),o={width:r.width(),height:r.height()};return r.remove(),o},toPx:function(t,e){if(this.millimeterSize||(this.millimeterSize=this.measure(1,1,"mm").width),e=(e||"").toLowerCase(),!this.supportedUnits[e])throw new Error("Unsupportted unit "+e);return this.supportedUnits[e].call(this,t)}};function tl(t){var e=i.Deferred();return Tt(t.attr("xlink:href")||t.attr("href"),function(n,i){!n&&i&&t.attr("xlink:href",i),e.resolve()}),e.promise()}function el(t,e){var n=_e("svg_output");Va(t,function(t){var e=window.open("",n,"menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes"),i="data:image/svg+xml,"+encodeURIComponent(t);e.document.write('<img src="'+i+'" style="max-height:100%" />')},Jt({convertImagesToDataUris:!0},e))}function nl(t,e,n){if(void 0===n&&(n={}),void 0===t)throw new Error("The the dia.Paper is a mandatory argument.");var i=n.canvg||("undefined"!=typeof canvg?canvg:void 0),r=function(t,e){var n=function(t){var e=Ft(t.padding);return t.width&&t.height&&(e.left+e.right>=t.width&&(e.left=e.right=0),e.top+e.bottom>=t.height&&(e.top=e.bottom=0)),e}(e),i=Y({x:-n.left,y:-n.top,width:n.left+n.right,height:n.top+n.bottom});if(e.width&&e.height){var r=t.width+n.left+n.right,o=t.height+n.top+n.bottom;i.scale(r/e.width,o/e.height)}return B(t).moveAndExpand(i)}(n.area||t.paperToLocalRect(t.getContentBBox()),n),o=function(t,e){return{width:Math.max(Math.round(t.width*e),1),height:Math.max(Math.round(t.height*e),1)}}(St(n.width)&&St(n.height)?n:r,function(t){var e=1;if(void 0!==t&&(e=parseFloat(t),!Number.isFinite(e)||0===e))throw new Error("dia.Paper: invalid raster size ("+t+")");return e}(n.size));if(!function(t,e){var n=document.createElement("canvas");n.width=t,n.height=e;var i=t-1,r=e-1,o=n.getContext("2d");try{o.fillStyle="rgb(1,1,1)",o.fillRect(i,r,1,1);var s=o.getImageData(i,r,1,1).data;if(1!==s[0]||1!==s[1]||1!==s[2])return!1}catch(t){return!1}return!0}(o.width,o.height))throw new Error("dia.Paper: raster size exceeded.");var s,a=new Image;a.onload=function(){var t,r,l;function c(){(l=document.createElement("canvas")).width=o.width,l.height=o.height,(r=l.getContext("2d")).fillStyle=n.backgroundColor||"white",r.fillRect(0,0,o.width,o.height)}function u(){t=l.toDataURL(n.type,n.quality),e(t),h()}function h(){l.svg&&le(l.svg.stop)&&setTimeout(l.svg.stop,1)}c();try{r.drawImage(a,0,0,o.width,o.height),u()}catch(t){if(void 0===i)return void console.error("Canvas tainted. Canvg library required.");c();var d={ignoreDimensions:!0,ignoreClear:!0,ignoreMouse:!0,ignoreAnimation:!0,offsetX:0,offsetY:0,useCORS:!0};i(l,s,Jt(d,{forceRedraw:(function(){return!this.called&&(this.called=!0)}).bind({called:!1}),renderCallback:function(){try{u()}catch(t){h(),s=function(t){return t.replace(/<image[^>]*>/g,function(t){var e=t.match(/href="([^"]*)"/),n=e&&e[1],i="data:image/svg+xml";if(n&&n.substr(0,18)===i){var r=atob(n.substr(n.indexOf(",")+1));return r.substr(r.indexOf("<svg"))}return t})}(s),c(),i(l,s,Jt(d,{renderCallback:u}))}}}))}},Va(t,function(t){s=t,a.src="data:image/svg+xml,"+encodeURIComponent(t)},{paper:t,convertImagesToDataUris:!0,beforeSerialize:n.beforeSerialize,area:r,useComputedStyles:n.useComputedStyles,stylesheet:n.stylesheet,preserveDimensions:{width:o.width,height:o.height}})}function il(t,e,n){(n=n||{}).type="image/png",nl(t,e,n)}function rl(t,e,n){(n=n||{}).type="image/jpeg",nl(t,e,n)}function ol(t,e){var n=_e("png_output");il(t,function(t){window.open("",n,"menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes").document.write('<img src="'+t+'"/>')},Jt({padding:10},e))}qr.prototype.toSVG=function(){for(var t=arguments.length,e=Array(t);t--;)e[t]=arguments[t];return Va.apply(this,[this].concat(e))},qr.prototype.openAsSVG=function(){for(var t=arguments.length,e=Array(t);t--;)e[t]=arguments[t];return el.apply(this,[this].concat(e))},qr.prototype.openAsPNG=function(t){for(var e=arguments.length,n=Array(e);e--;)n[e]=arguments[e];return ol.apply(this,[this].concat(n))},qr.prototype.toJPEG=function(t,e){for(var n=arguments.length,i=Array(n);n--;)i[n]=arguments[n];return rl.apply(this,[this].concat(i))},qr.prototype.toPNG=function(t,e){for(var n=arguments.length,i=Array(n);n--;)i[n]=arguments[n];return il.apply(this,[this].concat(i))},qr.prototype.toDataURL=function(t,e){for(var n=arguments.length,i=Array(n);n--;)i[n]=arguments[n];return nl.apply(this,[this].concat(i))};var sl={toCellsArray:function(t,e,n){var i=(new DOMParser).parseFromString(t,"text/xml");if("parsererror"==i.documentElement.nodeName)throw new Error("Error while parsing GEXF file.");var r=Array.from(i.documentElement.querySelectorAll("node")),o=Array.from(i.documentElement.querySelectorAll("edge")),s=[];return r.forEach(function(t){var n=parseFloat(t.querySelector("size").getAttribute("value")),i=e({id:t.getAttribute("id"),width:n,height:n,label:t.getAttribute("label")});s.push(i)}),o.forEach(function(t){var e=n({source:t.getAttribute("source"),target:t.getAttribute("target")});s.unshift(e)}),s},toSVG:Va,openAsSVG:el,toDataURL:nl,toPNG:il,toJPEG:rl,openAsPNG:ol};if("undefined"!=typeof module&&module.exports)var al=require("ws").Server,ll=require("ws"),cl=require("url");function ul(t){if(this.options=t,!this.options||!this.options.graph)throw new Error("Channel: missing a graph.");this.options.ttl=this.options.ttl||60,this.options.healthCheckInterval=this.options.healthCheckInterval||36e5,this.options.reconnectInterval=this.options.reconnectInterval||1e4,this.options.serverShouldSendGraph=void 0===this.options.serverShouldSendGraph||this.options.serverShouldSendGraph,this._isClient=!!this.options.url,this._clients=[],this.messageQueue=[],this.id=this.options.id||(this._isClient?"c_":"s_")+gt(),this.state={},this.state[this.id]=0,this.sites={},this.sites[this.id]={socket:void 0,outgoing:[],ttl:this.options.ttl},this.initialize()}function hl(t){if(this.options=t,!this.options.port)throw new Error("ChannelHub: missing a port.");this.initialize()}ll=ll||"undefined"!=typeof window&&window.WebSocket,Jt(ul.prototype,e.Events),ul.prototype.initialize=function(){this.options.graph.on("all",this.onGraphChange.bind(this)),this._isClient?this.connectClient():this.options.port&&(this.server=new al({port:this.options.port}),this.server.on("connection",this.onConnection.bind(this))),this._isClient||(this._healthCheckInterval=setInterval(this.healthCheck.bind(this),this.options.healthCheckInterval))},ul.prototype.connectClient=function(){var t=this.options.url+"/?channelId="+this.id+"&state="+JSON.stringify(this.state)+(this.options.query?"&query="+JSON.stringify(this.options.query):"");0<this.options.debugLevel&&this.log("connectClient",t);var e=new ll(t);e.onopen=this.onConnection.bind(this,e),e.onclose=this.onClose.bind(this,e)},ul.prototype.close=function(){this._reconnectTimeout&&clearTimeout(this._reconnectTimeout),this._healthCheckInterval&&clearInterval(this._healthCheckInterval),this._closed=!0,we(this.sites,function(t){t.socket&&t.socket.close()}),this.server&&this.server.close()},ul.prototype.healthCheck=function(){if(0<this.options.debugLevel){var t=Object.keys(this.sites).reduce((function(t,e){return t[e]=this[e].ttl,t}).bind(this.sites),{});this.log("healthCheck",t)}we(this.sites,(function(t,e){e!==this.id&&(t.socket&&1===t.socket.readyState?t.ttl=this.options.ttl:t.ttl-=1,t.ttl<=0&&(this.sites=Ie(this.sites,e),this.state=Ie(this.state,e)))}).bind(this))},ul.prototype.onConnection=function(t,e){if(this._clients.push(t),this.trigger("open",t),this._isClient)(this.sites[this.id].socket=t).onmessage=(function(e){this.onMessage(t,e.data)}).bind(this);else{var n=t.upgradeReq||e,i=cl.parse(n.url,!0).query.channelId;if(this.sites[i])this.sites[i].socket=t;else if(1<this.debugLevel&&this.log("new_site",i),this.sites[i]={socket:t,outgoing:[],ttl:this.options.ttl},this.state[i]=0,this.options.serverShouldSendGraph){var r={channelId:this.id,state:JSON.parse(JSON.stringify(this.state)),action:"graph",graph:this.options.graph.toJSON()};this.messageQueue.push({type:"op",data:r,source:this.id,target:[i]}),this.send()}t.on("message",this.onMessage.bind(this,t)),t.on("close",this.onClose.bind(this,t))}},ul.prototype.onClose=function(t){var e=this._clients.indexOf(t);-1!==e&&this._clients.splice(e,1),this._isClient&&!this._closed&&(this._reconnectTimeout&&clearTimeout(this._reconnectTimeout),this._reconnectTimeout=setTimeout(this.connectClient.bind(this),this.options.reconnectInterval)),this.trigger("close",t)},ul.prototype.onMessage=function(t,e){this.trigger("message:received",e),1<this.options.debugLevel&&this.log("message",e);try{e=JSON.parse(e)}catch(t){return console.error("Channel: message parsing failed.",t)}if("notification"==e.type)return this.trigger(e.data.event,e.data.data),this.sendNotification(e);var n,i,r=e.data;"graph"===(this._isClient||(i=this.sites[r.channelId],r=this.receive(i,r.channelId,r)),n=this.sites[this.id],r=this.receive(n,this.id,r)).action?this.state[r.channelId]=r.state[r.channelId]:this.state[r.channelId]=(this.state[r.channelId]||0)+1,1<this.options.debugLevel&&this.log("new state",this.state),this.execute(r),we(this.sites,(function(t,e){e!==this.id&&e!==r.channelId&&this.receive(t,e,r)}).bind(this)),this._isClient||(e.op=r,this.messageQueue.push(e),this.broadcast(e)),this.trigger("message:processed",e)},ul.prototype.receive=function(t,e,n){if(!t)return n;1<this.options.debugLevel&&this.log("receive",e,n),1<this.options.debugLevel&&this.log("outgoing",t.outgoing),t.outgoing=t.outgoing.filter(function(t){return t.state[t.channelId]>=(n.state[t.channelId]||0)}),1<this.options.debugLevel&&this.log("outgoing.length",t.outgoing.length);for(var i=0;i<t.outgoing.length;i++){var r=t.outgoing[i],o=this.transform(n,r);n=o[0],t.outgoing[i]=o[1]}return n},ul.prototype.transform=function(t,e){return 1<this.options.debugLevel&&this.log("transform",t,e),"change:target"===t.action&&"remove"===e.action&&t.cell.target.id===e.cell.id&&(t.cell.target={x:0,y:0}),"change:source"===t.action&&"remove"===e.action&&t.cell.source.id===e.cell.id&&(t.cell.source={x:0,y:0}),[t,e]},ul.prototype.execute=function(t){var e;switch(t.action){case"add":this.options.graph.addCell(t.cell,{remote:!0});break;case"remove":(e=this.options.graph.getCell(t.cell.id))&&e.remove({remote:!0,disconnectLinks:!0});break;case"graph":this.options.graph.fromJSON(t.graph);break;default:var n=t.action.substr(7);(e=this.options.graph.getCell(t.cell.id))&&e.set(n,t.cell[n],{remote:!0})}},ul.prototype.broadcast=function(t){this._isClient?t.target=Object.keys(this.sites):t.target=Object.keys(Ie(this.sites,this.id,t.source)),this.send()},ul.prototype.send=function(){if(!this._paused){for(var t=[],e=0;e<this.messageQueue.length;e++){var n=this.messageQueue[e];this.sendMessage(n)&&t.push(e)}t.forEach(function(t){this.messageQueue.splice(t,1)},this)}},ul.prototype.sendMessage=function(t){1<this.debugLevel&&this.log("sendMessage",t);var e=[];return t.target.forEach(function(n,i){var r=this.sites[n];if(!r)return e.push(i);r.socket&&1===r.socket.readyState&&(1<this.debugLevel&&this.log("sendMessage",n,t),r.socket.send(JSON.stringify(t)),e.push(i))},this),e.forEach(function(e){t.target.splice(e,1)}),!t.target.length},ul.prototype.log=function(t,e){var n="Channel ["+this.id+"] "+t.toUpperCase()+": ";console.log.apply(console,[n].concat(Array.prototype.slice.call(arguments,1)))},ul.prototype.pause=function(){this._paused=!0},ul.prototype.unpause=function(){this._paused=!1,this.send()},ul.prototype.notify=function(t,e){var n={type:"notification",source:this.id,data:{event:t,data:e}};this.sendNotification(n)},ul.prototype.sendNotification=function(t){this._isClient?t.target=Object.keys(this.sites):t.target=Object.keys(Ie(this.sites,this.id,t.source)),this.sendMessage(t)},ul.prototype.onGraphChange=function(t,e,n,i){if(!(i&&i.remote||"add"!==t&&"remove"!==t&&"change:"!==t.substr(0,7))){var r={channelId:this.id,state:JSON.parse(JSON.stringify(this.state)),action:t,cell:e.toJSON()},o={type:"op",data:r,source:this.id};1<this.options.debugLevel&&this.log("generate",o),this.messageQueue.push(o),this.broadcast(o),this.sites[this.id].outgoing.push(r),this.state[this.id]++}},Jt(hl.prototype,e.Events),hl.prototype.initialize=function(){this.server=new al({port:this.options.port}),this.server.on("connection",this.onConnection.bind(this))},hl.prototype.onConnection=function(t,e){var n=t.upgradeReq||e,i={query:cl.parse(n.url,!0).query};if(!this.router)throw new Error("ChannelHub: missing a router.");var r=!1,o=this.router(i,function(n,i){if(n)throw new Error(n);i&&!r&&(i.onConnection(t,e),r=!0)});o instanceof ul&&(o.onConnection(t,e),r=!0)},hl.prototype.route=function(t){this.router=t},hl.prototype.close=function(){this.server.close()};var dl={Channel:ul,ChannelHub:hl},fl=e.Model.extend({initialize:function(t){this._map={},this._commandManager=t.commandManager,this.listenTo(this._commandManager,"add",this._onCommand)},defaults:{cancelInvalid:!0},_onCommand:function(t){return Array.isArray(t)?t.find(function(t){return!this._validateCommand(t)},this):this._validateCommand(t)},_validateCommand:function(t){return!(!t.options||!1!==t.options.validation)||(ue(this._map[t.action]).forEach(function(n){var i=0;!function r(o){var s=n[i++];try{if(!s)return void(e=o);s(o,t,r)}catch(o){r(o)}}(e)}),!e||(this.get("cancelInvalid")&&this._commandManager.cancel(),this.trigger("invalid",e),!1));var e},validate:function(t){var e=Array.prototype.slice.call(arguments,1);return e.forEach(function(e){if(!le(e))throw new Error(t+" requires callback functions.")}),t.split(" ").forEach(function(t){(this._map[t]=this._map[t]||[]).push(e)},this),this}}),pl=e.Model.extend({defaults:{cmdBeforeAdd:null,cmdNameRegex:/^(?:add|remove|change:\w+)$/,applyOptionsList:["propertyPath"],revertOptionsList:["propertyPath"]},PREFIX_LENGTH:7,initialize:function(t){Te(this,"initBatchCommand","storeBatchCommand"),this.graph=t.graph,this.reset(),this.listen()},listen:function(){this.listenTo(this.graph,"all",this.addCommand,this),this.listenTo(this.graph,"batch:start",this.initBatchCommand,this),this.listenTo(this.graph,"batch:stop",this.storeBatchCommand,this)},createCommand:function(t){return{action:void 0,data:{id:void 0,type:void 0,previous:{},next:{}},batch:t&&t.batch}},push:function(t,e){this.redoStack=[],t.batch?(this.lastCmdIndex=Math.max(this.lastCmdIndex,0),this.trigger("batch",t)):(this.undoStack.push(t),this.notifyStackChange("push",t,e),this.trigger("add",t))},addCommand:function(t,e,n,i){if((!i||!i.dry)&&this.get("cmdNameRegex").test(t)&&("function"!=typeof this.get("cmdBeforeAdd")||this.get("cmdBeforeAdd").apply(this,arguments))){var r=void 0,o=e instanceof Zr;if(this.batchCommand){r=this.batchCommand[Math.max(this.lastCmdIndex,0)];var s=o&&!r.graphChange||r.data.id!==e.id,a=r.action!==t;if(0<=this.lastCmdIndex&&(s||a)){var l=this.batchCommand.findIndex(function(n,i){return(o&&n.graphChange||n.data.id===e.id)&&n.action===t});l<0||"add"===t||"remove"===t?r=this.createCommand({batch:!0}):(r=this.batchCommand[l],this.batchCommand.splice(l,1)),this.lastCmdIndex=this.batchCommand.push(r)-1}}else r=this.createCommand({batch:!1});if("add"===t||"remove"===t)return r.action=t,r.data.id=e.id,r.data.type=e.attributes.type,r.data.attributes=At({},e.toJSON()),r.options=i||{},void this.push(r,i);var c=t.substr(this.PREFIX_LENGTH);r.batch&&r.action||(r.action=t,r.data.previous[c]=re(e.previous(c)),r.options=i||{},o?r.graphChange=!0:(r.data.id=e.id,r.data.type=e.attributes.type)),r.data.next[c]=re(e.get(c)),this.push(r,i)}},initBatchCommand:function(){this.batchCommand?this.batchLevel++:(this.batchCommand=[this.createCommand({batch:!0})],this.lastCmdIndex=-1,this.batchLevel=0)},storeBatchCommand:function(t){if(this.batchCommand&&this.batchLevel<=0){var e=this.filterBatchCommand(this.batchCommand);0<e.length&&(this.redoStack=[],this.undoStack.push(e),this.notifyStackChange("push",e,t),this.trigger("add",e)),this.batchCommand=null,this.lastCmdIndex=null,this.batchLevel=null}else this.batchCommand&&0<this.batchLevel&&this.batchLevel--},filterBatchCommand:function(t){for(var e=t.slice(),n=[];0<e.length;){var i=e.shift(),r=i.data.id;if(null!=i.action&&(null!=r||i.graphChange)){if("add"===i.action){var o=e.findIndex(function(t){return"remove"===t.action&&t.data&&t.data.id===r});if(0<=o){e=e.filter(function(t,e){return o<e||t.data.id!==r});continue}}else if("remove"===i.action){var s=e.findIndex(function(t){return"add"===t.action&&t.data&&t.data.id==r});if(0<=s){e.splice(s,1);continue}}else if(0===i.action.indexOf("change")&&ae(i.data.previous,i.data.next))continue;n.push(i)}}return n},revertCommand:function(t,e){var n;this.stopListening(),n=Array.isArray(t)?this.constructor.sortBatchCommands(t):[t];for(var i=this.graph,r=n.length-1;0<=r;r--){var o=n[r],s=o.graphChange?i:i.getCell(o.data.id),a=Jt({commandManager:this.id||this.cid},e,Ee(o.options,this.get("revertOptionsList")));switch(o.action){case"add":s.remove(a);break;case"remove":i.addCell(o.data.attributes,a);break;default:var l=o.action.substr(this.PREFIX_LENGTH);s.set(l,o.data.previous[l],a)}}this.listen()},applyCommand:function(t,e){var n;this.stopListening(),n=Array.isArray(t)?this.constructor.sortBatchCommands(t):[t];for(var i=this.graph,r=0;r<n.length;r++){var o=n[r],s=o.graphChange?i:i.getCell(o.data.id),a=Jt({commandManager:this.id||this.cid},e,Ee(o.options,this.get("applyOptionsList")));switch(o.action){case"add":i.addCell(o.data.attributes,a);break;case"remove":s.remove(a);break;default:var l=o.action.substr(this.PREFIX_LENGTH);s.set(l,o.data.next[l],a)}}this.listen()},undo:function(t){var e=this.undoStack.pop();e&&(this.revertCommand(e,t),this.redoStack.push(e),this.notifyStackChange("undo",e,t))},redo:function(t){var e=this.redoStack.pop();e&&(this.applyCommand(e,t),this.undoStack.push(e),this.notifyStackChange("redo",e,t))},cancel:function(t){var e=this.undoStack.pop();e&&(this.revertCommand(e,t),this.redoStack=[],this.notifyStackChange("cancel",e,t))},reset:function(t){this.undoStack=[],this.redoStack=[],this.notifyStackChange("reset",null,t)},hasUndo:function(){return 0<this.undoStack.length},hasRedo:function(){return 0<this.redoStack.length},notifyStackChange:function(t,e,n){var i,r;void 0===n&&(n={}),r=e?[Array.isArray(e)?e:[e],n]:[n],(i=this).trigger.apply(i,["stack:"+t].concat(r)),this.trigger("stack",n)}},{sortBatchCommands:function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n],r=null;if("add"===i.action)for(var o=i.data.id,s=0;s<n;s++)if(t[s].data.id===o){r=s;break}null!==r?e.splice(r,0,i):e.push(i)}return e}});Zr.prototype.constructTree=function(t,e,n,i){i=i||[];var r=le(e.children)?e.children(t):t[e.children||"children"];return n||(n=e.makeElement(t),i.push(n)),ue(r).forEach(function(t){var r=e.makeElement(t),o=e.makeLink(n,r);i.push(r,o),this.constructTree(t,e,r,i)},this),i},Zr.prototype.shortestPath=function(t,e,n){n=n||{};var i={};this.getLinks().forEach(function(t){var e=t.get("source").id,r=t.get("target").id;i[e]||(i[e]=[]),i[r]||(i[r]=[]),i[e].push(r),n.directed||i[r].push(e)});var r=Ga(i,t.id||t,n.weight),o=[],s=e.id||e;for(r[s]&&o.push(s);s=r[s];)o.unshift(s);return o};var gl={Validator:fl,CommandManager:pl},ml=Jt({},ss,Ps),vl={standard:Jt({},Zn,_o),uml:Ri,pn:xi,fsa:Ti,erd:Ei,logic:hi,chess:di,org:wi,devs:Xn,basic:Rn,bpmn:rs,chart:zo},yl=Jt({},to,gl);t.V=Mt,t.Vectorizer=vo,t.alg=Fa,t.anchors=Hr,t.com=dl,t.config=Pt,t.connectionPoints=$i,t.connectionStrategies=nr,t.connectors=Gi,t.dia=yl,t.elementTools=mo,t.env=mn,t.format=sl,t.g=Nt,t.highlighters=Fi,t.layout=ml,t.linkAnchors=Fr,t.linkTools=go,t.mvc=fn,t.routers=Kr,t.setTheme=function(t,e){ee(hn,"setTheme",t,e=e||{}),dn.prototype.defaultTheme=t},t.shapes=vl,t.storage=ja,t.ui=za,t.util=$e,t.version="3.1.1",t.versionRappid="3.1.1",Object.defineProperty(t,"__esModule",{value:!0})}),"undefined"!=typeof joint)var g=joint.g,V=joint.V;
//# sourceMappingURL=scripts.js.map