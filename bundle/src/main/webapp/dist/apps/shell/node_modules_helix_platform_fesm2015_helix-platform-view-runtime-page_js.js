(self.webpackChunkhelix=self.webpackChunkhelix||[]).push([["node_modules_helix_platform_fesm2015_helix-platform-view-runtime-page_js"],{"./node_modules/@helix/platform/fesm2015/helix-platform-approval-components.js":(e,t,i)=>{"use strict";i.r(t),i.d(t,{ApprovalConsoleComponent:()=>Ce,ApprovalConsoleModule:()=>we,ApprovalConsoleRegistrationModule:()=>Se});var n=i("./node_modules/@angular/core/fesm2015/core.js"),o=i("./node_modules/@angular/common/fesm2015/common.js"),r=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-api.js"),a=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-api.js"),s=i("rxjs"),l=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-components.js"),d=i("./node_modules/@helix/platform/fesm2015/helix-platform-record-api.js"),c=i("./node_modules/@ngx-translate/core/fesm2015/ngx-translate-core.js"),p=i("lodash"),m=i("./node_modules/@angular/common/fesm2015/http.js"),u=i("./node_modules/rxjs/_esm2015/operators/index.js"),f=i("./node_modules/@helix/platform/fesm2015/helix-platform-ui-kit.js"),h=i("./node_modules/@bmc-ux/adapt-angular/fesm2015/bmc-ux-adapt-angular.js"),g=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-components.js"),v=i("./node_modules/@angular/forms/fesm2015/forms.js"),y=i("./node_modules/moment-es6/index.js"),x=i("./node_modules/@helix/platform/fesm2015/helix-platform-utils.js"),b=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-runtime.js");function C(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"strong"),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](2,"div",9),n["\u0275\u0275text"](3),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e.displayValue),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",e.value," ")}}function S(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",13),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.approval.console.overwrite-justification-reason.warning")," "))}function w(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-empty-state",3),n["\u0275\u0275pipe"](1,"translate")),2&e&&n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](1,1,"com.bmc.arsys.rx.client.approval.console.no-request-selected.message"))}function D(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",6),2&e){const e=t.$implicit;n["\u0275\u0275propertyInterpolate"]("label",e.label),n["\u0275\u0275propertyInterpolate"]("value",e.value)}}function R(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",4),n["\u0275\u0275template"](1,D,1,2,"rx-read-only-field",5),n["\u0275\u0275elementEnd"]()),2&e){const e=t.ngIf,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("hidden",!i.approvalRequest),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e)}}const I=function(e){return{busy:e}},F=["requestApproversGrid"];function E(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-empty-state",2),n["\u0275\u0275pipe"](1,"translate")),2&e&&n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](1,1,"com.bmc.arsys.rx.client.approval.console.no-request-selected.message"))}function M(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-record-grid",3,4),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("config",e.gridConfig$)}}function A(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"strong"),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](2,"div",11),n["\u0275\u0275text"](3),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e.displayValue),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",e.value," ")}}const O=["requestQuestionsGrid"];function P(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-empty-state",3),n["\u0275\u0275pipe"](1,"translate")),2&e&&n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](1,1,"com.bmc.arsys.rx.client.approval.console.no-request-selected.message"))}function T(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",4),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().askNewQuestion()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("disabled",e.isNewQuestionButtonDisabled()),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.approval.console.questions.new.label"),"\n")}}function V(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-record-grid",5,6),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("config",e.gridConfig$)}}const N=["requestCommentsGrid"];function k(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-empty-state",3),n["\u0275\u0275pipe"](1,"translate")),2&e&&n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](1,1,"com.bmc.arsys.rx.client.approval.console.no-request-selected.message"))}function j(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",4),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().addNewComment()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.approval.console.comments.new.label"),"\n"))}function _(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-record-grid",5,6),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("config",e.gridConfig$)}}const B=["requestAttachmentsGrid"];function $(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-empty-state",2),n["\u0275\u0275pipe"](1,"translate")),2&e&&n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](1,1,"com.bmc.arsys.rx.client.approval.console.no-request-selected.message"))}function L(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-record-grid",3,4),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("config",e.gridConfig$)}}const G=["requestDetailsTabs"],q=["resolvedFieldCellTemplate"],U=["definitionNameCellTemplate"],z=["approvalRequestsGrid"];function X(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-tab-panel",22),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]().ngIf;n["\u0275\u0275propertyInterpolate"]("adapt-tab-title",e.label),n["\u0275\u0275property"]("badge",i[e.countType])("badge-type",e.badgeType)}}function W(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-tabset",20),n["\u0275\u0275listener"]("tab-active-changed",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().fetchApprovalRequests(t)}),n["\u0275\u0275template"](1,X,1,3,"adapt-tab-panel",21),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("tab-active",0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.approvalRequestTypes)}}function H(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-record-grid",23,24),n["\u0275\u0275listener"]("dataLoaded",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onDataLoaded()}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("config",e.gridConfig$)}}function Q(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span"),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"]("(",e.currentRequestId,")")}}function J(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-approval-request-approvers",25),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("approvalRequest",e.selectedApprovalRequest)("gridType",e.selectedApprovalRequestsTab.gridType)}}function K(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-approval-request-questions",26),n["\u0275\u0275listener"]("questionSubmitted",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onQuestionSubmitted()}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("approvalRequest",e.selectedApprovalRequest)("gridType",e.selectedApprovalRequestsTab.gridType)("requestsTabStatus",e.selectedApprovalRequestsTab.status)}}function Y(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-approval-request-comments",25),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("approvalRequest",e.selectedApprovalRequest)("gridType",e.selectedApprovalRequestsTab.gridType)}}function Z(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-approval-request-attachments",25),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("approvalRequest",e.selectedApprovalRequest)("gridType",e.selectedApprovalRequestsTab.gridType)}}function ee(e,t){if(1&e&&(n["\u0275\u0275text"](0),n["\u0275\u0275pipe"](1,"rxDefinitionNamePipe")),2&e){const e=t.dataItem,i=t.column;n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](1,1,e[i.field]),"\n")}}function te(e,t){if(1&e&&n["\u0275\u0275text"](0),2&e){const e=t.dataItem,i=t.column;n["\u0275\u0275textInterpolate1"](" ",e.resolvedDisplayValues[i.field],"\n")}}class ie extends a.DataPage{constructor(e){super(e,"com.bmc.arsys.rx.approval.application.datapage.SignatureDetailDataPageQuery"),this.injector=e}}var ne,oe,re;ie.\u0275fac=function(e){return new(e||ie)(n["\u0275\u0275inject"](n.Injector))},ie.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ie,factory:ie.\u0275fac,providedIn:"root"}),function(e){e.Pending="Pending",e.Hold="On Hold",e.MoreInfo="More Information",e.RequestMoreInfo="Request More Information",e.NeedsAttention="Needs Attention",e.Approved="Approved",e.Rejected="Rejected",e.Cancelled="Cancelled",e.Error="Error",e.Closed="Closed"}(ne||(ne={})),function(e){e.ApprovalRequests="approvalRequests",e.NeedAttentionRequests="needAttentionRequests"}(oe||(oe={})),function(e){e.Approved="Approved",e.Rejected="Rejected",e.OnHold="OnHold",e.Reassign="Reassign"}(re||(re={}));const ae={approvalServerCommand:"com.bmc.arsys.rx.approval.application.command.ApprovalServerCommand",approvalCommandForm:"AP:Signature",approvalUserNameField:101,approvalRequestTypes:{pending:{status:ne.Pending,countType:"pendingCount",gridType:oe.ApprovalRequests,badgeType:"warning",labelKey:"com.bmc.arsys.rx.client.approval.console.request.pending.label"},onHold:{status:ne.Hold,countType:"holdCount",gridType:oe.ApprovalRequests,badgeType:"warning",labelKey:"com.bmc.arsys.rx.client.approval.console.request.hold.label"},moreInfo:{status:ne.RequestMoreInfo,countType:"moreInformationCount",gridType:oe.ApprovalRequests,badgeType:"info",labelKey:"com.bmc.arsys.rx.client.approval.console.request.more-info.label"},needAttention:{status:ne.NeedsAttention,countType:"needAttentionCount",gridType:oe.NeedAttentionRequests,badgeType:"warning",labelKey:"com.bmc.arsys.rx.client.approval.console.request.needs-attention.label"},approved:{status:ne.Approved,countType:"approvedCount",gridType:oe.ApprovalRequests,badgeType:"success",labelKey:"com.bmc.arsys.rx.client.approval.console.request.approved.label"},rejected:{status:ne.Rejected,countType:"rejectedCount",gridType:oe.ApprovalRequests,badgeType:"danger",labelKey:"com.bmc.arsys.rx.client.approval.console.request.rejected.label"},cancelled:{status:ne.Cancelled,countType:"cancelledCount",gridType:oe.ApprovalRequests,badgeType:"secondary",labelKey:"com.bmc.arsys.rx.client.approval.console.request.canceled.label"},error:{status:ne.Error,countType:"errorCount",gridType:oe.ApprovalRequests,badgeType:"danger",labelKey:"com.bmc.arsys.rx.client.approval.console.request.errored.label"},closed:{status:ne.Closed,countType:"closedCount",gridType:oe.ApprovalRequests,badgeType:"secondary",labelKey:"com.bmc.arsys.rx.client.approval.console.request.closed.label"}},approvalRequestsGrid:{fields:{application:"application",summary:"summary",requester:"requester",status:"status",request:"request",createDateSig:"createDateSig",process:"process",signatureInstanceID:"signatureInstanceID",justificationReasonField:"justification",sigTermStateDate:"sigTermStateDate",signatureID:"signatureID",otherDetail1:"otherDetail1",otherDetail2:"otherDetail2",otherDetail3:"otherDetail3",otherDetail4:"otherDetail4",justificationRequired:"justificationRequired",canReassign:"canReassign",processInstanceId:"processInstanceId",ifMultipleApprovers:"ifMultipleApprovers",actingAs:"actingAs"}},needAttentionRequestsGrid:{definition:"AP:More Information",fields:{fromUser:"2",toUser:"4",description:"14506",application:"10050",requestID:"10051",attachment:"14893",question:"13300",response:"13301",state:"11016"}},requestDetailsGrid:{definition:"AP:QCI-Detail-Join",approverDefinition:"AP:PreviewInfo",questionDefinition:"AP:Question-Comment-Info",questionTypeValue:0,commentTypeValue:1,fields:{from:2,to:4,application:11001,type:11002,signatureID:11003,request:11004,requestNumber:13334,process:1e4,response:11005,question:11006,attachment:11011,approver:14201}}};class se extends a.DataPage{constructor(e){super(e,"com.bmc.arsys.rx.approval.application.datapage.ApprovalUsersDataPageQuery"),this.injector=e}}se.\u0275fac=function(e){return new(e||se)(n["\u0275\u0275inject"](n.Injector))},se.\u0275prov=n["\u0275\u0275defineInjectable"]({token:se,factory:se.\u0275fac,providedIn:"root"});class le{constructor(e,t,i,n,o){this.httpClient=e,this.rxSignatureDetailDataPageService=t,this.rxCurrentUserService=i,this.rxRecordInstanceUtilsService=n,this.rxApprovalUsersDataPageService=o}getApprovalRequestCounts(){return this.httpClient.get(`/api/${a.RX_APPLICATION.approvalBundleId}/rx/application/approval/counts?ignoreAlternateUser=false`)}getRequestLabelDetails(e,t){return this.httpClient.get(`/api/${a.RX_APPLICATION.approvalBundleId}/rx/application/approval/labels/${encodeURIComponent(e)}/${encodeURIComponent(t)}`)}getCurrentRequestDetails(e,t){return this.rxSignatureDetailDataPageService.get({params:{request:e,application:t,ignoreAssignedUser:!0}}).pipe((0,u.map)(e=>e.data[0]))}approveRequest(e){return this.httpClient.post(a.RX_RESOURCE_URLS.command,{resourceType:ae.approvalServerCommand,commands:e})}rejectRequest(e){return this.httpClient.post(a.RX_RESOURCE_URLS.command,{resourceType:ae.approvalServerCommand,commands:e})}holdRequest(e){return this.httpClient.post(a.RX_RESOURCE_URLS.command,{resourceType:ae.approvalServerCommand,commands:e})}reassignRequest(e){return this.httpClient.post(a.RX_RESOURCE_URLS.command,{resourceType:ae.approvalServerCommand,commands:e})}getCommandPayload(e,t){return{formName:ae.approvalCommandForm,requestID:t,command:e}}saveQuestion(e,t){return this.httpClient.post(`/api/${a.RX_APPLICATION.approvalBundleId}/rx/application/approval/moreinformation/${t}`,e)}saveAttachment(e,t){return this.httpClient.post(`${d.RX_RECORD_DEFINITION.recordInstanceAttachment}/${encodeURIComponent(ae.needAttentionRequestsGrid.definition)}/${t}`,e)}getApprovalUsers(e,t,i){const n={startIndex:e,pageSize:t,propertySelection:["loginName","fullName"]};return n.queryExpression=`'${ae.approvalUserNameField}'!="${this.rxCurrentUserService.getName()}"`,i&&(n.queryExpression+=` AND ('${d.RX_RECORD_DEFINITION.coreFieldIds.description}' LIKE "%${this.rxRecordInstanceUtilsService.escapeTextWildcards(i)}%" OR '${ae.approvalUserNameField}' LIKE "%${this.rxRecordInstanceUtilsService.escapeTextWildcards(i)}%")`),this.rxApprovalUsersDataPageService.get({params:Object.assign({startIndex:e,pageSize:t},n)}).pipe((0,u.map)(e=>({totalSize:e.totalSize,options:e.data.map(({fullName:e,loginName:t})=>({displayValue:e,value:t}))})))}}le.\u0275fac=function(e){return new(e||le)(n["\u0275\u0275inject"](m.HttpClient),n["\u0275\u0275inject"](ie),n["\u0275\u0275inject"](a.RxCurrentUserService),n["\u0275\u0275inject"](d.RxRecordInstanceUtilsService),n["\u0275\u0275inject"](se))},le.\u0275prov=n["\u0275\u0275defineInjectable"]({token:le,factory:le.\u0275fac,providedIn:"root"});class de extends f.RxModalClass{constructor(e,t,i,n,o){super(i,o),this.translateService=e,this.rxNotificationService=t,this.activeModalRef=i,this.rxApprovalConsoleService=n,this.injector=o,this.selectedUser=[],this.userLoaderFunc=this.getApprovalUsers.bind(this)}isDirty(){return!!this.selectedUser.length}reassign(){this.allowDismiss=!1;const e=(0,p.map)(this.activeModalRef.getData().selectedRequestInstanceIds,e=>Object.assign({assignToApprovers:this.selectedUser[0].value},this.rxApprovalConsoleService.getCommandPayload(re.Reassign,e)));this.rxApprovalConsoleService.reassignRequest(e).pipe((0,u.finalize)(()=>{this.allowDismiss=!0})).subscribe(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.approval.console.request.reassigned.message")),this.activeModalRef.close(!0)})}cancel(){this.activeModalRef.dismiss(h.DismissReasons.CLOSE_BTN)}getApprovalUsers(e,t,i){return this.rxApprovalConsoleService.getApprovalUsers(e,t,i)}optionFormatter(e){return`${e.value} ${e.displayValue}`}}de.\u0275fac=function(e){return new(e||de)(n["\u0275\u0275directiveInject"](c.TranslateService),n["\u0275\u0275directiveInject"](a.RxNotificationService),n["\u0275\u0275directiveInject"](h.ActiveModalRef),n["\u0275\u0275directiveInject"](le),n["\u0275\u0275directiveInject"](n.Injector))},de.\u0275cmp=n["\u0275\u0275defineComponent"]({type:de,selectors:[["rx-approval-request-reassign"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:17,vars:21,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","rx-id","x-button",1,"close","dp-close",3,"disabled","click"],[1,"modal-body"],[1,"form-group","d-block",3,"label","ngModel","optionLoader","required","template","optionFormatter","ngModelChange"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",1,"mr-2",3,"adaptInlineLoader","disabled","click"],["adapt-button","","type","button","btn-type","secondary","rx-id","cancel-button",3,"disabled","click"],["optionTemplate",""],[1,"text-secondary"]],template:function(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"h5",1),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",2),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",3),n["\u0275\u0275elementStart"](6,"rx-select-with-pagination",4),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.selectedUser=e}),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](8,"div",5),n["\u0275\u0275elementStart"](9,"button",6),n["\u0275\u0275listener"]("click",function(){return t.reassign()}),n["\u0275\u0275text"](10),n["\u0275\u0275pipe"](11,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](12,"button",7),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](13),n["\u0275\u0275pipe"](14,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](15,C,4,2,"ng-template",null,8,n["\u0275\u0275templateRefExtractor"])),2&e){const e=n["\u0275\u0275reference"](16);n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,13,"com.bmc.arsys.rx.client.approval.console.request.reassign-dialog.title")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",!t.allowDismiss),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](7,15,"com.bmc.arsys.rx.client.approval.console.request.reassign.label")),n["\u0275\u0275property"]("ngModel",t.selectedUser)("optionLoader",t.userLoaderFunc)("required",!0)("template",e)("optionFormatter",t.optionFormatter),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("adaptInlineLoader",!t.allowDismiss)("disabled",!t.selectedUser.length||!t.allowDismiss),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](11,17,"com.bmc.arsys.rx.client.common.save.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",!t.allowDismiss),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](14,19,"com.bmc.arsys.rx.client.common.cancel.label")," ")}},directives:[g.RxSelectWithPaginationComponent,v.NgControlStatus,v.NgModel,v.RequiredValidator,h.AdaptButtonComponent,h.AdaptInlineStandaloneDirective],pipes:[c.TranslatePipe],encapsulation:2});class ce extends f.RxModalClass{constructor(e,t,i,n,o,r){super(e,r),this.activeModalRef=e,this.rxRecordInstanceService=t,this.rxNotificationService=i,this.translateService=n,this.rxApprovalConsoleService=o,this.injector=r,this.request=this.activeModalRef.getData().selectedRequest,this.attachment=[],this.enableCustomDownload=!0,this.existingAttachmentName=this.request[ae.needAttentionRequestsGrid.fields.attachment],this.downloadAttachment=()=>{this.rxRecordInstanceService.downloadAttachment(ae.needAttentionRequestsGrid.definition,Number(ae.needAttentionRequestsGrid.fields.attachment),this.request[d.RX_RECORD_DEFINITION.coreFieldIds.id],this.request[ae.needAttentionRequestsGrid.fields.attachment])}}isDirty(){return!this.isSaveButtonDisabled()}ngOnInit(){super.ngOnInit(),this.existingAttachmentName&&(this.attachment=this.getExistingFile())}sendResponse(){this.allowDismiss=!1,this.rxRecordInstanceService.get(ae.needAttentionRequestsGrid.definition,this.request[d.RX_RECORD_DEFINITION.coreFieldIds.id]).pipe((0,u.switchMap)(e=>(e.setFieldValue(Number(ae.needAttentionRequestsGrid.fields.response),this.response),this.rxRecordInstanceService.save(e))),(0,u.tap)(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.approval.console.question-response-dialog.response-added.message"))}),(0,u.switchMap)(()=>{if(this.shouldSaveAttachment){const e=new FormData;return e.append(ae.needAttentionRequestsGrid.fields.attachment,this.attachment[0].data,this.attachment[0].data.name),this.rxApprovalConsoleService.saveAttachment(e,this.request[d.RX_RECORD_DEFINITION.coreFieldIds.id])}return(0,s.of)(null)}),(0,u.finalize)(()=>{this.allowDismiss=!0})).subscribe(()=>{this.activeModalRef.close(!0)})}onRemovedFileFromQueue(){this.enableCustomDownload=!1}onAfterFilesAdded(){this.shouldSaveAttachment=!0}cancel(){this.activeModalRef.dismiss(h.DismissReasons.CLOSE_BTN)}getExistingFile(){return[{data:new File([],this.existingAttachmentName),inUploading:!1,inDeleting:!1,uploaded:100,error:!1,errorText:"",allowDeletion:!0}]}isSaveButtonDisabled(){var e;return!this.allowDismiss||!this.response||this.existingAttachmentName&&!(null===(e=this.attachment[0])||void 0===e?void 0:e.data)}}ce.\u0275fac=function(e){return new(e||ce)(n["\u0275\u0275directiveInject"](h.ActiveModalRef),n["\u0275\u0275directiveInject"](d.RxRecordInstanceService),n["\u0275\u0275directiveInject"](a.RxNotificationService),n["\u0275\u0275directiveInject"](c.TranslateService),n["\u0275\u0275directiveInject"](le),n["\u0275\u0275directiveInject"](n.Injector))},ce.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ce,selectors:[["rx-approval-request-question-response"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:21,vars:36,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","rx-id","x-button",1,"close","dp-close",3,"disabled","click"],[1,"modal-body"],[1,"d-block","form-group",3,"label","value"],["rows","2",1,"d-block","form-group",3,"label","ngModel","required","autofocus","ngModelChange"],["adaptRequired","",3,"ngModel","required","showMaxSizeRestriction","enableCustomDownload","customDownload","reusable","label","ngModelChange","removedFileFromQueue","afterFilesAdded"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",1,"mr-2",3,"disabled","adaptInlineLoader","click"],["adapt-button","","type","button","btn-type","secondary","rx-id","cancel-button",3,"disabled","click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"h5",1),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",2),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",3),n["\u0275\u0275element"](6,"rx-read-only-field",4),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275element"](8,"rx-read-only-field",4),n["\u0275\u0275pipe"](9,"translate"),n["\u0275\u0275elementStart"](10,"adapt-rx-textarea",5),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.response=e}),n["\u0275\u0275pipe"](11,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](12,"adapt-rx-uploader",6),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.attachment=e})("removedFileFromQueue",function(){return t.onRemovedFileFromQueue()})("afterFilesAdded",function(){return t.onAfterFilesAdded()}),n["\u0275\u0275pipe"](13,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](14,"div",7),n["\u0275\u0275elementStart"](15,"button",8),n["\u0275\u0275listener"]("click",function(){return t.sendResponse()}),n["\u0275\u0275text"](16),n["\u0275\u0275pipe"](17,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](18,"button",9),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](19),n["\u0275\u0275pipe"](20,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,22,"com.bmc.arsys.rx.client.approval.console.question-response-dialog.title")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",!t.allowDismiss),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](7,24,"com.bmc.arsys.rx.client.approval.console.question-response-dialog.to-field.label")),n["\u0275\u0275propertyInterpolate"]("value",t.request[2]),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](9,26,"com.bmc.arsys.rx.client.common.question.label")),n["\u0275\u0275propertyInterpolate"]("value",t.request[13300]),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](11,28,"com.bmc.arsys.rx.client.approval.console.question-response-dialog.response-field.label")),n["\u0275\u0275property"]("ngModel",t.response)("required",!0)("autofocus",!0),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](13,30,"com.bmc.arsys.rx.client.common.attachment.label")),n["\u0275\u0275property"]("ngModel",t.attachment)("required",t.existingAttachmentName)("showMaxSizeRestriction",!1)("enableCustomDownload",t.enableCustomDownload)("customDownload",t.downloadAttachment)("reusable",!0),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("disabled",t.isSaveButtonDisabled())("adaptInlineLoader",!t.allowDismiss),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](17,32,"com.bmc.arsys.rx.client.common.save.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",!t.allowDismiss),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](20,34,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[f.ReadOnlyFieldComponent,h.AdaptRxTextareaComponent,v.NgControlStatus,v.NgModel,v.RequiredValidator,h.AdaptRxUploaderComponent,h.AdaptButtonComponent,h.AdaptInlineStandaloneDirective],pipes:[c.TranslatePipe],styles:["[_nghost-%COMP%]     rx-read-only-field .read-only-content{max-height:9em;overflow-y:auto;word-break:break-all;white-space:pre-wrap}[_nghost-%COMP%]     adapt-rx-uploader .adapt-uploader-file-uploaded{display:none}"]});class pe extends f.RxModalClass{constructor(e,t,i,n,o){super(e,o),this.activeModalRef=e,this.rxNotificationService=t,this.translateService=i,this.rxApprovalConsoleService=n,this.injector=o,this.currentRequestIndex=0,this.requests=[],this.title=this.activeModalRef.getData().modalTitle,this.commandType=this.activeModalRef.getData().commandType}isDirty(){return(0,p.some)(this.requests,e=>e.reason)}ngOnInit(){super.ngOnInit(),this.requests=(0,p.map)(this.activeModalRef.getData().selectedRequests,e=>({requestId:e[ae.approvalRequestsGrid.fields.request],requestSignatureInstanceId:e[ae.approvalRequestsGrid.fields.signatureInstanceID],reason:null,isReasonRequired:"TO_APPROVE_OR_REJECT"===e.justificationRequired||this.commandType===re.Approved&&"TO_APPROVE"===e.justificationRequired||this.commandType===re.Rejected&&"TO_REJECT"===e.justificationRequired}))}isSaveButtonDisabled(){return!this.allowDismiss||(0,p.some)(this.requests,e=>e.isReasonRequired&&this.isReasonEmpty(e.reason))&&!this.shouldApplySameReasonToAll}goToPreviousRequest(){this.currentRequestIndex--}goToNextRequest(){this.currentRequestIndex++}saveRequests(){this.allowDismiss=!1;const e=this.requests[this.currentRequestIndex].reason,t=[...(0,p.map)(this.requests,t=>Object.assign({justificationOrReason:this.shouldApplySameReasonToAll?e:t.reason},this.rxApprovalConsoleService.getCommandPayload(this.commandType,t.requestSignatureInstanceId)))];this.rxApprovalConsoleService.rejectRequest(t).pipe((0,u.finalize)(()=>{this.allowDismiss=!0})).subscribe(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant(this.commandType===re.Rejected?"com.bmc.arsys.rx.client.approval.console.request.rejected.message":"com.bmc.arsys.rx.client.approval.console.request.approved.message")),this.activeModalRef.close(!0)})}cancel(){this.activeModalRef.dismiss(h.DismissReasons.CLOSE_BTN)}isReasonEmpty(e){return!(0,p.trim)(e)}}pe.\u0275fac=function(e){return new(e||pe)(n["\u0275\u0275directiveInject"](h.ActiveModalRef),n["\u0275\u0275directiveInject"](a.RxNotificationService),n["\u0275\u0275directiveInject"](c.TranslateService),n["\u0275\u0275directiveInject"](le),n["\u0275\u0275directiveInject"](n.Injector))},pe.\u0275cmp=n["\u0275\u0275defineComponent"]({type:pe,selectors:[["rx-approval-request-action-reason-input"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:25,vars:36,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","rx-id","x-button",1,"close","dp-close",3,"disabled","click"],[1,"modal-body"],["rx-id","request-id",1,"form-group","d-block",3,"label","ngModel","readonly","ngModelChange"],["rx-id","justification-reason","rows","2",1,"d-block","form-group",3,"label","ngModel","required","autofocus","ngModelChange"],["rx-id","all-request-reason",1,"d-block","mb-2",3,"ngModel","disabled","label","ngModelChange"],["class","text-warning",4,"ngIf"],[1,"modal-footer"],["type","button","adapt-button","","btn-type","secondary","rx-id","previous-button",1,"mr-2",3,"disabled","click"],["type","button","adapt-button","","btn-type","secondary","rx-id","next-button",1,"mr-auto",3,"disabled","click"],["type","button","adapt-button","","btn-type","primary","rx-id","save-button",1,"mr-2",3,"disabled","adaptInlineLoader","click"],["adapt-button","","type","button","btn-type","secondary","rx-id","cancel-button",3,"disabled","click"],[1,"text-warning"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"h5",1),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",2),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"div",3),n["\u0275\u0275elementStart"](5,"adapt-rx-textfield",4),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.requests[t.currentRequestIndex].requestId=e}),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](7,"adapt-rx-textarea",5),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.requests[t.currentRequestIndex].reason=e}),n["\u0275\u0275pipe"](8,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](9,"adapt-rx-switch",6),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.shouldApplySameReasonToAll=e}),n["\u0275\u0275pipe"](10,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](11,S,3,3,"div",7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](12,"div",8),n["\u0275\u0275elementStart"](13,"button",9),n["\u0275\u0275listener"]("click",function(){return t.goToPreviousRequest()}),n["\u0275\u0275text"](14),n["\u0275\u0275pipe"](15,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](16,"button",10),n["\u0275\u0275listener"]("click",function(){return t.goToNextRequest()}),n["\u0275\u0275text"](17),n["\u0275\u0275pipe"](18,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](19,"button",11),n["\u0275\u0275listener"]("click",function(){return t.saveRequests()}),n["\u0275\u0275text"](20),n["\u0275\u0275pipe"](21,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](22,"button",12),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](23),n["\u0275\u0275pipe"](24,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",t.title," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",!t.allowDismiss),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](6,22,"com.bmc.arsys.rx.client.approval.configuration.grid.column.requestId")),n["\u0275\u0275property"]("ngModel",t.requests[t.currentRequestIndex].requestId)("readonly",!0),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](8,24,"com.bmc.arsys.rx.client.approval.justification-reason.label")),n["\u0275\u0275property"]("ngModel",t.requests[t.currentRequestIndex].reason)("required",t.requests[t.currentRequestIndex].isReasonRequired)("autofocus",!0),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](10,26,"com.bmc.arsys.rx.client.approval.console.apply-common-justification-reason.label")),n["\u0275\u0275property"]("ngModel",t.shouldApplySameReasonToAll)("disabled",t.isReasonEmpty(t.requests[t.currentRequestIndex].reason)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.shouldApplySameReasonToAll),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",0===t.currentRequestIndex||t.shouldApplySameReasonToAll),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](15,28,"com.bmc.arsys.rx.client.common.previous-step.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",t.currentRequestIndex===t.requests.length-1||t.shouldApplySameReasonToAll),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](18,30,"com.bmc.arsys.rx.client.common.next-step.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",t.isSaveButtonDisabled())("adaptInlineLoader",!t.allowDismiss),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](21,32,"com.bmc.arsys.rx.client.common.save.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",!t.allowDismiss),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](24,34,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[h.AdaptRxTextfieldComponent,v.NgControlStatus,v.NgModel,h.AdaptRxTextareaComponent,v.RequiredValidator,h.AdaptRxSwitchComponent,o.NgIf,h.AdaptButtonComponent,h.AdaptInlineStandaloneDirective],pipes:[c.TranslatePipe],encapsulation:2});class me{constructor(e){this.datePipe=e}formatValue(e){const t="h:mm:ss A",i="M/D/YYYY";return!/^\d+$/.test(e)&&(0,y.default)(e,[`${i} ${t}`,y.default.ISO_8601],!0).isValid()?e=this.datePipe.transform(new Date(e),"medium"):(0,y.default)(e,i,!0).isValid()?e=this.datePipe.transform(new Date(e),"mediumDate"):(0,y.default)(e,t,!0).isValid()&&(e=(0,y.default)(e,t).format("HH:mm A")),e}}me.\u0275fac=function(e){return new(e||me)(n["\u0275\u0275inject"](o.DatePipe))},me.\u0275prov=n["\u0275\u0275defineInjectable"]({token:me,factory:me.\u0275fac});class ue{constructor(e,t,i,n,o){this.rxApprovalConsoleHelperService=e,this.rxDefinitionNameService=t,this.datePipe=i,this.translateService=n,this.rxApprovalConsoleService=o,this.approvalRequest$=new s.Subject,this.allRequestFields$=this.approvalRequest$.pipe((0,u.tap)(()=>{this.busy=s.NEVER.subscribe()}),(0,u.switchMap)(e=>this.gridType===oe.NeedAttentionRequests?this.rxApprovalConsoleService.getCurrentRequestDetails(e[ae.needAttentionRequestsGrid.fields.requestID],e[ae.needAttentionRequestsGrid.fields.application]):(0,s.of)(e)),(0,u.switchMap)(e=>(0,s.combineLatest)([(0,s.of)(e),this.rxApprovalConsoleService.getRequestLabelDetails(e.application,e.process)])),(0,u.map)(([e,t])=>{const i=[{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.request-id.label"),value:e.resolvedDisplayValues.request||e.request},{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.requester.label"),value:e.resolvedDisplayValues.requester||e.requester},{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.request-date.label"),value:this.datePipe.transform(e.createDateSig,"medium")},{label:this.translateService.instant("com.bmc.arsys.rx.client.common.description.label"),value:e.resolvedDisplayValues.summary||e.summary},{label:this.translateService.instant("com.bmc.arsys.rx.client.common.status.label"),value:this.statuses[e.status]},{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.status-date.label"),value:this.datePipe.transform(e.sigTermStateDate,"medium")}];e.actionDate&&i.push({label:"",value:this.datePipe.transform(e.actionDate,"medium")}),e.justification&&i.push({label:this.translateService.instant("com.bmc.arsys.rx.client.approval.justification-reason.label"),value:e.justification});const n={14508:e.resolvedDisplayValues.otherDetail1,14509:e.resolvedDisplayValues.otherDetail2,14510:e.resolvedDisplayValues.otherDetail3,14511:e.resolvedDisplayValues.otherDetail4};return(0,p.forEach)(t,(e,o)=>{e&&i.push({label:t[o],value:this.rxApprovalConsoleHelperService.formatValue(n[o])})}),i.push({label:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.activity-log.label"),value:`${this.rxDefinitionNameService.getDisplayName(e.application)} ${e.resolvedDisplayValues.request||e.request}, ${e.resolvedDisplayValues.requester||e.requester}`}),i}),(0,u.tap)(()=>{this.busy=s.EMPTY.subscribe()})),this.statuses={[ne.Pending]:this.translateService.instant(ae.approvalRequestTypes.pending.labelKey),[ne.RequestMoreInfo]:this.translateService.instant(ae.approvalRequestTypes.moreInfo.labelKey),[ne.Hold]:this.translateService.instant(ae.approvalRequestTypes.onHold.labelKey),[ne.MoreInfo]:this.translateService.instant(ae.approvalRequestTypes.moreInfo.labelKey),[ne.NeedsAttention]:this.translateService.instant(ae.approvalRequestTypes.needAttention.labelKey),[ne.Approved]:this.translateService.instant(ae.approvalRequestTypes.approved.labelKey),[ne.Rejected]:this.translateService.instant(ae.approvalRequestTypes.rejected.labelKey),[ne.Cancelled]:this.translateService.instant(ae.approvalRequestTypes.cancelled.labelKey),[ne.Error]:this.translateService.instant(ae.approvalRequestTypes.error.labelKey),[ne.Closed]:this.translateService.instant(ae.approvalRequestTypes.closed.labelKey)}}ngOnChanges(e){var t;(null===(t=e.approvalRequest)||void 0===t?void 0:t.currentValue)&&this.approvalRequest$.next(e.approvalRequest.currentValue)}}ue.\u0275fac=function(e){return new(e||ue)(n["\u0275\u0275directiveInject"](me),n["\u0275\u0275directiveInject"](a.RxDefinitionNameService),n["\u0275\u0275directiveInject"](o.DatePipe),n["\u0275\u0275directiveInject"](c.TranslateService),n["\u0275\u0275directiveInject"](le))},ue.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ue,selectors:[["rx-approval-request-general-details"]],inputs:{approvalRequest:"approvalRequest",gridType:"gridType"},features:[n["\u0275\u0275NgOnChangesFeature"]],decls:4,vars:7,consts:[[3,"options"],["type","alerts",3,"label",4,"ngIf"],["class","pt-2 pl-3",3,"hidden",4,"ngIf"],["type","alerts",3,"label"],[1,"pt-2","pl-3",3,"hidden"],["class","d-block form-group",3,"label","value",4,"ngFor","ngForOf"],[1,"d-block","form-group",3,"label","value"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"rx-busy-indicator",0),n["\u0275\u0275template"](1,w,2,3,"adapt-empty-state",1),n["\u0275\u0275template"](2,R,2,2,"div",2),n["\u0275\u0275pipe"](3,"async")),2&e&&(n["\u0275\u0275property"]("options",n["\u0275\u0275pureFunction1"](5,I,t.busy)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.approvalRequest),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](3,3,t.allRequestFields$)))},directives:[f.RxBusyIndicatorComponent,o.NgIf,h.AdaptEmptyStateComponent,o.NgForOf,f.ReadOnlyFieldComponent],pipes:[o.AsyncPipe,c.TranslatePipe],styles:["[_nghost-%COMP%]{display:block;position:relative;min-height:65%}"]});class fe{constructor(e,t,i){this.translateService=e,this.rxApprovalConsoleService=t,this.rxRecordInstanceDataPageService=i}ngOnInit(){this.gridConfig$=(0,s.of)({enableRowSelection:null,getData:e=>this.getApproversData(e),columns:this.getColumns(),getRecordDefinition:()=>(0,s.of)(this.getRecordDefinition()),recordDefinitionName:ae.requestDetailsGrid.approverDefinition,styles:"flex-fill"})}ngOnChanges(e){var t,i;(null===(t=e.approvalRequest)||void 0===t?void 0:t.currentValue)&&(null===(i=this.requestApproversGrid)||void 0===i||i.api.refresh().subscribe())}getApproversData(e){return(0,s.iif)(()=>this.gridType===oe.NeedAttentionRequests,this.rxApprovalConsoleService.getCurrentRequestDetails(this.approvalRequest[ae.needAttentionRequestsGrid.fields.requestID],this.approvalRequest[ae.needAttentionRequestsGrid.fields.application]),(0,s.of)(this.approvalRequest)).pipe((0,u.switchMap)(t=>this.rxRecordInstanceDataPageService.post({params:(0,p.omit)(Object.assign(Object.assign({},e),{shouldIncludeTotalSize:!0,[ae.requestDetailsGrid.fields.requestNumber]:t[ae.approvalRequestsGrid.fields.request],[ae.requestDetailsGrid.fields.process]:t[ae.approvalRequestsGrid.fields.process]}),["searchText","propertySelection"])})))}getRecordDefinition(){return{fieldDefinitions:[{id:ae.requestDetailsGrid.fields.approver,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:d.RX_RECORD_DEFINITION.coreFieldIds.status,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.selection,optionNamesById:{0:this.translateService.instant(ae.approvalRequestTypes.pending.labelKey),1:this.translateService.instant(ae.approvalRequestTypes.approved.labelKey),2:this.translateService.instant(ae.approvalRequestTypes.rejected.labelKey),3:this.translateService.instant(ae.approvalRequestTypes.onHold.labelKey),4:this.translateService.instant(ae.approvalRequestTypes.moreInfo.labelKey),5:this.translateService.instant(ae.approvalRequestTypes.cancelled.labelKey),6:this.translateService.instant(ae.approvalRequestTypes.error.labelKey),7:this.translateService.instant(ae.approvalRequestTypes.closed.labelKey)}}]}}getColumns(){return[{index:0,fieldId:ae.requestDetailsGrid.fields.approver.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.approvers.grid.approver.title"),filterable:!1,sortable:!1},{index:1,fieldId:d.RX_RECORD_DEFINITION.coreFieldIds.status.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.common.status.label")}]}}fe.\u0275fac=function(e){return new(e||fe)(n["\u0275\u0275directiveInject"](c.TranslateService),n["\u0275\u0275directiveInject"](le),n["\u0275\u0275directiveInject"](d.RxRecordInstanceDataPageService))},fe.\u0275cmp=n["\u0275\u0275defineComponent"]({type:fe,selectors:[["rx-approval-request-approvers"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](F,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.requestApproversGrid=e.first)}},inputs:{approvalRequest:"approvalRequest",gridType:"gridType"},features:[n["\u0275\u0275NgOnChangesFeature"]],decls:2,vars:2,consts:[["type","objects",3,"label",4,"ngIf"],[3,"config",4,"ngIf"],["type","objects",3,"label"],[3,"config"],["requestApproversGrid",""]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,E,2,3,"adapt-empty-state",0),n["\u0275\u0275template"](1,M,2,1,"rx-record-grid",1)),2&e&&(n["\u0275\u0275property"]("ngIf",!t.approvalRequest),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.approvalRequest))},directives:[o.NgIf,h.AdaptEmptyStateComponent,l.RecordGridComponent],pipes:[c.TranslatePipe],styles:["[_nghost-%COMP%]     rx-record-grid .adapt-table-search-toolbar-container{display:none}"]});class he extends f.RxModalClass{constructor(e,t,i,n,o){super(n,o),this.rxApprovalConsoleService=e,this.rxNotificationService=t,this.translateService=i,this.activeModalRef=n,this.injector=o,this.selectedUser=[],this.userLoaderFunc=this.getApprovalUsers.bind(this),this.attachment=[]}isDirty(){var e,t;return!!(this.question||(null===(e=this.attachment[0])||void 0===e?void 0:e.data)||(null===(t=this.selectedUser[0])||void 0===t?void 0:t.value))}saveQuestion(){var e;this.allowDismiss=!1;const t=new FormData,i=this.activeModalRef.getData().selectedRequest;t.append("to",this.selectedUser[0].value),t.append("question",this.question),t.append("application",i.application),t.append("applicationRequestId",i.resolvedDisplayValues.request),t.append("signatureID",i.signatureID),(null===(e=this.attachment[0])||void 0===e?void 0:e.data)&&t.append("attachment",this.attachment[0].data,this.attachment[0].data.name),this.rxApprovalConsoleService.saveQuestion(t,"question").pipe((0,u.finalize)(()=>{this.allowDismiss=!0})).subscribe(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.approval.console.questions.question-added.message")),this.activeModalRef.close(!0)})}cancel(){this.activeModalRef.dismiss(h.DismissReasons.CLOSE_BTN)}getApprovalUsers(e,t,i){return this.rxApprovalConsoleService.getApprovalUsers(e,t,i)}optionFormatter(e){return`${e.value} ${e.displayValue}`}}he.\u0275fac=function(e){return new(e||he)(n["\u0275\u0275directiveInject"](le),n["\u0275\u0275directiveInject"](a.RxNotificationService),n["\u0275\u0275directiveInject"](c.TranslateService),n["\u0275\u0275directiveInject"](h.ActiveModalRef),n["\u0275\u0275directiveInject"](n.Injector))},he.\u0275cmp=n["\u0275\u0275defineComponent"]({type:he,selectors:[["rx-approval-request-question"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:21,vars:33,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","rx-id","x-button",1,"close","dp-close",3,"disabled","click"],[1,"modal-body"],[1,"form-group","d-block",3,"label","ngModel","optionLoader","required","template","optionFormatter","ngModelChange"],["rows","2",1,"d-block","form-group",3,"label","ngModel","required","autofocus","ngModelChange"],["adaptRequired","",3,"ngModel","enableDnD","showMaxSizeRestriction","label","ngModelChange"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",1,"mr-2",3,"disabled","adaptInlineLoader","click"],["adapt-button","","type","button","btn-type","secondary","rx-id","cancel-button",3,"disabled","click"],["optionTemplate",""],[1,"text-secondary"]],template:function(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"h5",1),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",2),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",3),n["\u0275\u0275elementStart"](6,"rx-select-with-pagination",4),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.selectedUser=e}),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](8,"adapt-rx-textarea",5),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.question=e}),n["\u0275\u0275pipe"](9,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"adapt-rx-uploader",6),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.attachment=e}),n["\u0275\u0275pipe"](11,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](12,"div",7),n["\u0275\u0275elementStart"](13,"button",8),n["\u0275\u0275listener"]("click",function(){return t.saveQuestion()}),n["\u0275\u0275text"](14),n["\u0275\u0275pipe"](15,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](16,"button",9),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](17),n["\u0275\u0275pipe"](18,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](19,A,4,2,"ng-template",null,10,n["\u0275\u0275templateRefExtractor"])),2&e){const e=n["\u0275\u0275reference"](20);n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,21,"com.bmc.arsys.rx.client.approval.console.questions.new.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",!t.allowDismiss),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](7,23,"com.bmc.arsys.rx.client.common.send-to.label")),n["\u0275\u0275property"]("ngModel",t.selectedUser)("optionLoader",t.userLoaderFunc)("required",!0)("template",e)("optionFormatter",t.optionFormatter),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](9,25,"com.bmc.arsys.rx.client.common.question.label")),n["\u0275\u0275property"]("ngModel",t.question)("required",!0)("autofocus",!0),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](11,27,"com.bmc.arsys.rx.client.common.attachment.label")),n["\u0275\u0275property"]("ngModel",t.attachment)("enableDnD",!0)("showMaxSizeRestriction",!1),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("disabled",!t.selectedUser.length||!t.question||!t.allowDismiss)("adaptInlineLoader",!t.allowDismiss),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](15,29,"com.bmc.arsys.rx.client.common.save.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",!t.allowDismiss),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](18,31,"com.bmc.arsys.rx.client.common.cancel.label")," ")}},directives:[g.RxSelectWithPaginationComponent,v.NgControlStatus,v.NgModel,v.RequiredValidator,h.AdaptRxTextareaComponent,h.AdaptRxUploaderComponent,h.AdaptButtonComponent,h.AdaptInlineStandaloneDirective],pipes:[c.TranslatePipe],encapsulation:2});class ge{constructor(e,t,i,o,r,a){this.translateService=e,this.rxRecordInstanceService=t,this.rxModalService=i,this.adaptModalService=o,this.rxApprovalConsoleService=r,this.rxRecordInstanceDataPageService=a,this.questionSubmitted=new n.EventEmitter}ngOnInit(){this.gridConfig$=(0,s.of)({enableRowSelection:null,getData:e=>this.getQuestionData(e),columns:this.getQuestionColumns(),getRecordDefinition:()=>(0,s.of)(this.getQuestionRecordDefinition()),recordDefinitionName:ae.requestDetailsGrid.definition,styles:"flex-fill"})}ngOnChanges(e){var t,i;(null===(t=e.approvalRequest)||void 0===t?void 0:t.currentValue)&&(null===(i=this.requestQuestionsGrid)||void 0===i||i.api.refresh().subscribe())}isNewQuestionButtonDisabled(){return!(0,p.includes)([ne.Pending,ne.Hold],this.requestsTabStatus)}askNewQuestion(){this.rxModalService.openModal({content:he,size:"sm",data:{selectedRequest:this.approvalRequest}}).then(e=>{e&&this.questionSubmitted.emit()}).catch(p.noop)}getQuestionData(e){return(0,s.iif)(()=>this.gridType===oe.NeedAttentionRequests,this.rxApprovalConsoleService.getCurrentRequestDetails(this.approvalRequest[ae.needAttentionRequestsGrid.fields.requestID],this.approvalRequest[ae.needAttentionRequestsGrid.fields.application]),(0,s.of)(this.approvalRequest)).pipe((0,u.switchMap)(t=>this.rxRecordInstanceDataPageService.post({params:(0,p.omit)(Object.assign(Object.assign({},e),{shouldIncludeTotalSize:!0,[ae.requestDetailsGrid.fields.application]:t.application,[ae.requestDetailsGrid.fields.type]:ae.requestDetailsGrid.questionTypeValue,[ae.requestDetailsGrid.fields.request]:t.request}),["searchText"])})))}getQuestionColumns(){return[{index:0,fieldId:ae.requestDetailsGrid.fields.to.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.questions.grid.column.question-to.title")},{index:1,fieldId:ae.requestDetailsGrid.fields.from.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.common.from.label")},{index:2,fieldId:ae.requestDetailsGrid.fields.question.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.common.question.label"),clickable:!0,actions:[{name:(e,t)=>{this.showQuestionDetails(t)}}],filterable:!1,sortable:!1},{index:3,fieldId:ae.requestDetailsGrid.fields.response.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.questions.grid.column.response.title"),filterable:!1,sortable:!1},{index:4,fieldId:d.RX_RECORD_DEFINITION.coreFieldIds.id.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.common.id.label"),visible:!1,filterable:!1},{index:5,fieldId:ae.requestDetailsGrid.fields.attachment.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.common.attachment.label"),clickable:!0,actions:[{name:(e,t)=>{this.rxRecordInstanceService.downloadAttachment(ae.requestDetailsGrid.questionDefinition,Number(ae.requestDetailsGrid.fields.attachment),t[d.RX_RECORD_DEFINITION.coreFieldIds.id].split("|")[0],t[ae.requestDetailsGrid.fields.attachment])}}]}]}getQuestionRecordDefinition(){return{fieldDefinitions:[{id:ae.requestDetailsGrid.fields.to,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.requestDetailsGrid.fields.from,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.requestDetailsGrid.fields.question,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.requestDetailsGrid.fields.response,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.requestDetailsGrid.fields.attachment,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.attachment},{id:d.RX_RECORD_DEFINITION.coreFieldIds.id,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character}]}}showQuestionDetails(e){this.adaptModalService.open({title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.question-response-dialog.title"),content:f.ReadOnlyFieldsModalComponent,size:"sm",data:{fields:[{label:this.translateService.instant("com.bmc.arsys.rx.client.common.send-to.label"),value:e[ae.requestDetailsGrid.fields.to]},{label:this.translateService.instant("com.bmc.arsys.rx.client.common.question.label"),value:e[ae.requestDetailsGrid.fields.question]},{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.question-response-dialog.response-field.label"),value:e[ae.requestDetailsGrid.fields.response]||this.translateService.instant("com.bmc.arsys.rx.client.approval.console.question-response-dialog.not-responded.message")}]}}).catch(p.noop)}}ge.\u0275fac=function(e){return new(e||ge)(n["\u0275\u0275directiveInject"](c.TranslateService),n["\u0275\u0275directiveInject"](d.RxRecordInstanceService),n["\u0275\u0275directiveInject"](f.RxModalService),n["\u0275\u0275directiveInject"](h.AdaptModalService),n["\u0275\u0275directiveInject"](le),n["\u0275\u0275directiveInject"](d.RxRecordInstanceDataPageService))},ge.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ge,selectors:[["rx-approval-request-questions"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](O,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.requestQuestionsGrid=e.first)}},inputs:{approvalRequest:"approvalRequest",requestsTabStatus:"requestsTabStatus",gridType:"gridType"},outputs:{questionSubmitted:"questionSubmitted"},features:[n["\u0275\u0275NgOnChangesFeature"]],decls:3,vars:3,consts:[["type","rules",3,"label",4,"ngIf"],["type","button","class","p-0 mb-2 d-icon-plus_circle align-self-start","adapt-button","","btn-type","tertiary","rx-id","new-question-button",3,"disabled","click",4,"ngIf"],[3,"config",4,"ngIf"],["type","rules",3,"label"],["type","button","adapt-button","","btn-type","tertiary","rx-id","new-question-button",1,"p-0","mb-2","d-icon-plus_circle","align-self-start",3,"disabled","click"],[3,"config"],["requestQuestionsGrid",""]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,P,2,3,"adapt-empty-state",0),n["\u0275\u0275template"](1,T,3,4,"button",1),n["\u0275\u0275template"](2,V,2,1,"rx-record-grid",2)),2&e&&(n["\u0275\u0275property"]("ngIf",!t.approvalRequest),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.approvalRequest),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.approvalRequest))},directives:[o.NgIf,h.AdaptEmptyStateComponent,h.AdaptButtonComponent,l.RecordGridComponent],pipes:[c.TranslatePipe],encapsulation:2});class ve extends f.RxModalClass{constructor(e,t,i,n,o){super(e,o),this.activeModalRef=e,this.translateService=t,this.rxNotificationService=i,this.rxApprovalConsoleService=n,this.injector=o,this.attachment=[]}isDirty(){var e;return!(!this.comment&&!(null===(e=this.attachment[0])||void 0===e?void 0:e.data))}saveComment(){var e;this.allowDismiss=!1;const t=new FormData,i=this.activeModalRef.getData().selectedRequest;t.append("comments",this.comment),t.append("application",i.application),t.append("applicationRequestId",i.resolvedDisplayValues.request),t.append("signatureID",i.signatureID),(null===(e=this.attachment[0])||void 0===e?void 0:e.data)&&t.append("attachment",this.attachment[0].data,this.attachment[0].data.name),this.rxApprovalConsoleService.saveQuestion(t,"comment").pipe((0,u.finalize)(()=>{this.allowDismiss=!0})).subscribe(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.approval.console.comments.comment-added.message")),this.activeModalRef.close(!0)})}cancel(){this.activeModalRef.dismiss(h.DismissReasons.CLOSE_BTN)}isCommentEmpty(){return!(0,p.trim)(this.comment)}}ve.\u0275fac=function(e){return new(e||ve)(n["\u0275\u0275directiveInject"](h.ActiveModalRef),n["\u0275\u0275directiveInject"](c.TranslateService),n["\u0275\u0275directiveInject"](a.RxNotificationService),n["\u0275\u0275directiveInject"](le),n["\u0275\u0275directiveInject"](n.Injector))},ve.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ve,selectors:[["rx-approval-request-comment"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:17,vars:25,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","rx-id","x-button",1,"close","dp-close",3,"disabled","click"],[1,"modal-body"],["rows","3",1,"d-block","form-group",3,"label","ngModel","required","autofocus","ngModelChange"],["adaptRequired","",3,"ngModel","enableDnD","showMaxSizeRestriction","label","ngModelChange"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",1,"mr-2",3,"disabled","adaptInlineLoader","click"],["adapt-button","","type","button","btn-type","secondary","rx-id","cancel-button",3,"disabled","click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"h5",1),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",2),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",3),n["\u0275\u0275elementStart"](6,"adapt-rx-textarea",4),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.comment=e}),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](8,"adapt-rx-uploader",5),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.attachment=e}),n["\u0275\u0275pipe"](9,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"div",6),n["\u0275\u0275elementStart"](11,"button",7),n["\u0275\u0275listener"]("click",function(){return t.saveComment()}),n["\u0275\u0275text"](12),n["\u0275\u0275pipe"](13,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](14,"button",8),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](15),n["\u0275\u0275pipe"](16,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,15,"com.bmc.arsys.rx.client.approval.console.comments.new.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",!t.allowDismiss),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](7,17,"com.bmc.arsys.rx.client.common.comment.label")),n["\u0275\u0275property"]("ngModel",t.comment)("required",!0)("autofocus",!0),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](9,19,"com.bmc.arsys.rx.client.common.attachment.label")),n["\u0275\u0275property"]("ngModel",t.attachment)("enableDnD",!0)("showMaxSizeRestriction",!1),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("disabled",t.isCommentEmpty()||!t.allowDismiss)("adaptInlineLoader",!t.allowDismiss),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](13,21,"com.bmc.arsys.rx.client.common.save.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",!t.allowDismiss),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](16,23,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[h.AdaptRxTextareaComponent,v.NgControlStatus,v.NgModel,v.RequiredValidator,h.AdaptRxUploaderComponent,h.AdaptButtonComponent,h.AdaptInlineStandaloneDirective],pipes:[c.TranslatePipe],encapsulation:2});class ye extends a.DataPage{constructor(e){super(e,"com.bmc.arsys.rx.approval.application.datapage.ApprovalQCIDataPageQuery"),this.injector=e}}ye.\u0275fac=function(e){return new(e||ye)(n["\u0275\u0275inject"](n.Injector))},ye.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ye,factory:ye.\u0275fac,providedIn:"root"});class xe{constructor(e,t,i,n,o,r,a){this.rxApprovalQCIDataPageService=e,this.rxModalService=t,this.rxApprovalConsoleService=i,this.adaptModalService=n,this.rxDataPageService=o,this.rxRecordInstanceService=r,this.translateService=a}ngOnInit(){this.gridConfig$=(0,s.of)({enableRowSelection:null,getData:e=>this.getCommentData(e),columns:this.getCommentColumns(),getRecordDefinition:()=>(0,s.of)(this.getCommentRecordDefinition()),recordDefinitionName:ae.requestDetailsGrid.definition,styles:"flex-fill"})}ngOnChanges(e){var t,i;(null===(t=e.approvalRequest)||void 0===t?void 0:t.currentValue)&&(null===(i=this.requestCommentsGrid)||void 0===i||i.api.refresh().subscribe())}addNewComment(){this.rxModalService.openModal({content:ve,size:"sm",data:{selectedRequest:this.selectedRequest}}).then(e=>{e&&this.requestCommentsGrid.api.refresh().subscribe()}).catch(p.noop)}getCommentData(e){return(0,s.iif)(()=>this.gridType===oe.NeedAttentionRequests,this.rxApprovalConsoleService.getCurrentRequestDetails(this.approvalRequest[ae.needAttentionRequestsGrid.fields.requestID],this.approvalRequest[ae.needAttentionRequestsGrid.fields.application]),(0,s.of)(this.approvalRequest)).pipe((0,u.tap)(e=>{this.selectedRequest=e}),(0,u.switchMap)(t=>this.rxApprovalQCIDataPageService.get({params:(0,p.omit)(Object.assign(Object.assign({},e),{shouldIncludeTotalSize:!0,[ae.requestDetailsGrid.fields.application]:t.application,[ae.requestDetailsGrid.fields.signatureID]:t.signatureID,[ae.requestDetailsGrid.fields.type]:ae.requestDetailsGrid.commentTypeValue,[ae.requestDetailsGrid.fields.request]:t.request}),["searchText"])})))}getCommentColumns(){return[{index:1,fieldId:ae.requestDetailsGrid.fields.from.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.submitter.label")},{index:2,fieldId:ae.requestDetailsGrid.fields.response.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.common.comment.label"),clickable:!0,actions:[{name:(e,t)=>{this.showCommentDetails(t)}}],sortable:!1},{index:3,fieldId:ae.requestDetailsGrid.fields.attachment.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.common.attachment.label"),clickable:!0,actions:[{name:(e,t)=>{this.rxRecordInstanceService.downloadAttachment(ae.requestDetailsGrid.questionDefinition,Number(ae.requestDetailsGrid.fields.attachment),t[d.RX_RECORD_DEFINITION.coreFieldIds.id].split("|")[0],t[ae.requestDetailsGrid.fields.attachment])}}]},{index:4,fieldId:d.RX_RECORD_DEFINITION.coreFieldIds.id.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.common.id.label"),visible:!1,filterable:!1}]}getCommentRecordDefinition(){return{fieldDefinitions:[{id:ae.requestDetailsGrid.fields.from,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.requestDetailsGrid.fields.response,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.requestDetailsGrid.fields.attachment,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.attachment},{id:d.RX_RECORD_DEFINITION.coreFieldIds.id,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character}]}}showCommentDetails(e){this.adaptModalService.open({title:this.translateService.instant("com.bmc.arsys.rx.client.common.comment.label"),content:f.ReadOnlyFieldsModalComponent,data:{fields:[{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.submitter.label"),value:e[ae.requestDetailsGrid.fields.from]},{label:this.translateService.instant("com.bmc.arsys.rx.client.common.comment.label"),value:e[ae.requestDetailsGrid.fields.response]}]},size:"sm"}).catch(p.noop)}}xe.\u0275fac=function(e){return new(e||xe)(n["\u0275\u0275directiveInject"](ye),n["\u0275\u0275directiveInject"](f.RxModalService),n["\u0275\u0275directiveInject"](le),n["\u0275\u0275directiveInject"](h.AdaptModalService),n["\u0275\u0275directiveInject"](a.RxDataPageFactoryService),n["\u0275\u0275directiveInject"](d.RxRecordInstanceService),n["\u0275\u0275directiveInject"](c.TranslateService))},xe.\u0275cmp=n["\u0275\u0275defineComponent"]({type:xe,selectors:[["rx-approval-request-comments"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](N,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.requestCommentsGrid=e.first)}},inputs:{approvalRequest:"approvalRequest",gridType:"gridType"},features:[n["\u0275\u0275NgOnChangesFeature"]],decls:3,vars:3,consts:[["type","events",3,"label",4,"ngIf"],["type","button","class","p-0 mb-2 d-icon-plus_circle align-self-start","adapt-button","","btn-type","tertiary","rx-id","new-comment-button",3,"click",4,"ngIf"],[3,"config",4,"ngIf"],["type","events",3,"label"],["type","button","adapt-button","","btn-type","tertiary","rx-id","new-comment-button",1,"p-0","mb-2","d-icon-plus_circle","align-self-start",3,"click"],[3,"config"],["requestCommentsGrid",""]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,k,2,3,"adapt-empty-state",0),n["\u0275\u0275template"](1,j,3,3,"button",1),n["\u0275\u0275template"](2,_,2,1,"rx-record-grid",2)),2&e&&(n["\u0275\u0275property"]("ngIf",!t.approvalRequest),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.approvalRequest),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.approvalRequest))},directives:[o.NgIf,h.AdaptEmptyStateComponent,h.AdaptButtonComponent,l.RecordGridComponent],pipes:[c.TranslatePipe],encapsulation:2});class be{constructor(e,t,i,n){this.rxApprovalConsoleService=e,this.translateService=t,this.rxRecordInstanceService=i,this.rxRecordInstanceDataPageService=n}ngOnInit(){this.gridConfig$=(0,s.of)({enableRowSelection:null,getData:e=>this.getAttachmentData(e),columns:this.getAttachmentColumns(),getRecordDefinition:()=>(0,s.of)(this.getAttachmentRecordDefinition()),recordDefinitionName:ae.requestDetailsGrid.definition,styles:"flex-fill"})}ngOnChanges(e){var t,i;(null===(t=e.approvalRequest)||void 0===t?void 0:t.currentValue)&&(null===(i=this.requestAttachmentsGrid)||void 0===i||i.api.refresh().subscribe())}getAttachmentData(e){return(0,s.iif)(()=>this.gridType===oe.NeedAttentionRequests,this.rxApprovalConsoleService.getCurrentRequestDetails(this.approvalRequest[ae.needAttentionRequestsGrid.fields.requestID],this.approvalRequest[ae.needAttentionRequestsGrid.fields.application]),(0,s.of)(this.approvalRequest)).pipe((0,u.switchMap)(t=>this.rxRecordInstanceDataPageService.post({params:(0,p.omit)(Object.assign(Object.assign({},e),{shouldIncludeTotalSize:!0,[ae.requestDetailsGrid.fields.application]:t.application,[ae.requestDetailsGrid.fields.request]:t.request}),["searchText","propertySelection"])}).pipe((0,u.map)(e=>(e.data=(0,p.reject)(e.data,e=>!e[ae.requestDetailsGrid.fields.attachment]),e)))))}getAttachmentColumns(){return[{index:0,fieldId:ae.requestDetailsGrid.fields.from.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.submitter.label")},{index:1,fieldId:ae.requestDetailsGrid.fields.attachment.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.attachments.grid.file-name.title"),clickable:!0,actions:[{name:(e,t)=>{this.rxRecordInstanceService.downloadAttachment(ae.requestDetailsGrid.questionDefinition,Number(ae.requestDetailsGrid.fields.attachment),t[d.RX_RECORD_DEFINITION.coreFieldIds.id].split("|")[0],t[ae.requestDetailsGrid.fields.attachment])}}]},{index:2,fieldId:d.RX_RECORD_DEFINITION.coreFieldIds.id.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.common.id.label"),visible:!1,filterable:!1}]}getAttachmentRecordDefinition(){return{fieldDefinitions:[{id:ae.requestDetailsGrid.fields.from,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.requestDetailsGrid.fields.attachment,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.attachment},{id:d.RX_RECORD_DEFINITION.coreFieldIds.id,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character}]}}}be.\u0275fac=function(e){return new(e||be)(n["\u0275\u0275directiveInject"](le),n["\u0275\u0275directiveInject"](c.TranslateService),n["\u0275\u0275directiveInject"](d.RxRecordInstanceService),n["\u0275\u0275directiveInject"](d.RxRecordInstanceDataPageService))},be.\u0275cmp=n["\u0275\u0275defineComponent"]({type:be,selectors:[["rx-approval-request-attachments"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](B,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.requestAttachmentsGrid=e.first)}},inputs:{approvalRequest:"approvalRequest",gridType:"gridType"},features:[n["\u0275\u0275NgOnChangesFeature"]],decls:2,vars:2,consts:[["type","grid",3,"label",4,"ngIf"],[3,"config",4,"ngIf"],["type","grid",3,"label"],[3,"config"],["requestAttachmentsGrid",""]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,$,2,3,"adapt-empty-state",0),n["\u0275\u0275template"](1,L,2,1,"rx-record-grid",1)),2&e&&(n["\u0275\u0275property"]("ngIf",!t.approvalRequest),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.approvalRequest))},directives:[o.NgIf,h.AdaptEmptyStateComponent,l.RecordGridComponent],pipes:[c.TranslatePipe],encapsulation:2});class Ce extends b.BaseViewComponent{constructor(e,t,i,n,o,r,a,l,c,m,f,h,g){super(),this.rxStringService=e,this.rxApprovalConsoleHelperService=t,this.rxCurrentUserService=i,this.translateService=n,this.rxModalService=o,this.rxNotificationService=r,this.rxApprovalConsoleService=a,this.rxRecordInstanceService=l,this.adaptModalService=c,this.rxSignatureDetailDataPageService=m,this.recordGridFilterService=f,this.rxRecordInstanceDataPageService=h,this.rxDefinitionNameService=g,this.selectedApprovalRequestsTab=ae.approvalRequestTypes.pending,this.approvalRequestTypes=(0,p.map)(ae.approvalRequestTypes,e=>Object.assign(Object.assign({},e),{label:this.translateService.instant(e.labelKey)})),this.dataLoaded$=new s.Subject,this.attentionGridParams={recorddefinition:ae.needAttentionRequestsGrid.definition,[d.RX_RECORD_DEFINITION.coreFieldIds.assignee]:this.rxCurrentUserService.getName(),[d.RX_RECORD_DEFINITION.coreFieldIds.status]:"0",[ae.needAttentionRequestsGrid.fields.state]:"0"},this.needAttentionRequestCount$=this.rxRecordInstanceDataPageService.post({params:this.attentionGridParams}),this.availableRequestCount$=this.dataLoaded$.pipe((0,u.switchMap)(()=>(0,s.forkJoin)([this.rxApprovalConsoleService.getApprovalRequestCounts(),this.needAttentionRequestCount$]))).pipe((0,u.map)(([e,t])=>Object.assign(Object.assign({},e),{needAttentionCount:t.totalSize}))),this.activeTabIndex=0,this.selectedRecordsInSequence=[]}ngOnInit(){this.updateGridConfig()}onDataLoaded(){var e;null===(e=this.gridSubscription)||void 0===e||e.unsubscribe(),this.gridSubscription=this.approvalRequestsGrid.adaptTable.selectionChange.subscribe(e=>{const t=(0,p.isNil)(this.selectedApprovalRequest)?e[0]:e[e.length-1];this.isReassignButtonDisabled=(0,p.some)(e,e=>"No"===e.canReassign),this.selectedRecordsInSequence=this.approvalRequestsGrid.api.getSelectedRows(!0),this.selectedRecordIndex=(0,p.findIndex)(this.selectedRecordsInSequence,{[r.RowDataItemIdFieldName]:null==t?void 0:t[r.RowDataItemIdFieldName]}),this.selectedApprovalRequest=t}),this.dataLoaded$.next()}approveRequest(){this.rxModalService.openModal({content:pe,size:"sm",data:{commandType:re.Approved,selectedRequests:this.approvalRequestsGrid.api.getSelectedRows(),modalTitle:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.approve-request-dialog.title")}}).then(e=>{e&&this.reloadGridData()}).catch(p.noop)}rejectRequest(){this.rxModalService.openModal({content:pe,size:"sm",data:{commandType:re.Rejected,selectedRequests:this.approvalRequestsGrid.api.getSelectedRows(),modalTitle:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.reject-request-dialog.title")}}).then(e=>{e&&this.reloadGridData()}).catch(p.noop)}holdRequest(){this.rxModalService.confirm({title:this.translateService.instant("com.bmc.arsys.rx.client.common.warning.label"),modalStyle:f.RX_MODAL.modalStyles.warning,message:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.request.hold-dialog.message")}).then(e=>{if(e){const e=(0,p.map)(this.approvalRequestsGrid.api.getSelectedRows(),e=>this.rxApprovalConsoleService.getCommandPayload(re.OnHold,e[ae.approvalRequestsGrid.fields.signatureInstanceID]));this.rxApprovalConsoleService.holdRequest(e).subscribe(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.approval.console.request.hold-success.message")),this.reloadGridData()})}})}reassignRequest(){this.rxModalService.openModal({content:de,size:"sm",data:{selectedRequestInstanceIds:(0,p.map)(this.approvalRequestsGrid.api.getSelectedRows(),e=>e.signatureInstanceID)}}).then(e=>{e&&this.reloadGridData()}).catch(p.noop)}isHoldButtonDisabled(){return this.selectedApprovalRequestsTab.status===ne.Hold}get currentRequestId(){var e,t;return(null===(e=this.selectedApprovalRequest)||void 0===e?void 0:e.request)||(null===(t=this.selectedApprovalRequest)||void 0===t?void 0:t[ae.needAttentionRequestsGrid.fields.requestID])}get selectedApprovalRequestCount(){var e,t;return(null===(t=null===(e=this.approvalRequestsGrid)||void 0===e?void 0:e.api)||void 0===t?void 0:t.getSelectedRowCount())||0}fetchApprovalRequests(e){this.approvalRequestsGrid.adaptTableConfig.selectedItems=[],this.selectedApprovalRequest=null,this.selectedApprovalRequestsTab=this.approvalRequestTypes[e.index],this.updateGridConfig()}showNextRequestDetails(){this.selectedApprovalRequest=this.selectedRecordsInSequence[++this.selectedRecordIndex]}showPreviousRequestDetails(){this.selectedApprovalRequest=this.selectedRecordsInSequence[--this.selectedRecordIndex]}isPreviousButtonDisabled(){return 0===this.selectedApprovalRequestCount||this.selectedRecordIndex<=0}isNextButtonDisabled(){return 0===this.selectedApprovalRequestCount||this.selectedRecordIndex===this.selectedRecordsInSequence.length-1}isApprovalRequestGrid(){return this.selectedApprovalRequestsTab.gridType===oe.ApprovalRequests}isNeedAttentionGrid(){return this.selectedApprovalRequestsTab.gridType===oe.NeedAttentionRequests}onTabChanged(e){e.event&&(this.activeTabIndex=e.index)}needAttentionGridColumns(){return[{index:0,fieldId:ae.needAttentionRequestsGrid.fields.fromUser,title:this.translateService.instant("com.bmc.arsys.rx.client.common.from.label")},{index:1,fieldId:ae.needAttentionRequestsGrid.fields.toUser,title:this.translateService.instant("com.bmc.arsys.rx.client.common.send-to.label")},{index:2,fieldId:ae.needAttentionRequestsGrid.fields.description,title:this.translateService.instant("com.bmc.arsys.rx.client.common.description.label"),clickable:!0,actions:[{name:(e,t)=>{this.openQuestionResponseDialog(t)}}]},{index:3,fieldId:ae.needAttentionRequestsGrid.fields.application,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.needs-attention.grid.column.application.title"),cellTemplate:this.definitionNameCellTemplate},{index:4,fieldId:ae.needAttentionRequestsGrid.fields.requestID,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.needs-attention.grid.column.request.title")},{index:5,fieldId:ae.needAttentionRequestsGrid.fields.attachment,title:this.translateService.instant("com.bmc.arsys.rx.client.common.attachment.label"),clickable:!0,actions:[{name:(e,t)=>{this.rxRecordInstanceService.downloadAttachment(ae.needAttentionRequestsGrid.definition,Number(ae.needAttentionRequestsGrid.fields.attachment),t[d.RX_RECORD_DEFINITION.coreFieldIds.id],t[ae.needAttentionRequestsGrid.fields.attachment])}}]},{index:6,fieldId:ae.needAttentionRequestsGrid.fields.question,title:this.translateService.instant("com.bmc.arsys.rx.client.common.question.label"),visible:!1,filterable:!1,sortable:!1},{index:7,fieldId:d.RX_RECORD_DEFINITION.coreFieldIds.id.toString(),title:this.translateService.instant("com.bmc.arsys.rx.client.common.id.label"),visible:!1,filterable:!1}]}ngOnDestroy(){this.dataLoaded$.complete(),this.gridSubscription.unsubscribe()}onQuestionSubmitted(){this.reloadGridData()}getData(e){const t=this.recordGridFilterService.generateTextFilterQuery(e.searchText,this.approvalRequestsGrid.adaptTableConfig.columns),i=(0,p.cloneDeep)(this.approvalRequestsGrid.state.advancedFiltering.selectedFilters),n=(0,p.find)(i,{filterOptionId:ae.approvalRequestsGrid.fields.application});if(n){const e=(0,p.find)(this.approvalRequestsGrid.state.advancedFiltering.selectedFilters,{filterOptionId:ae.approvalRequestsGrid.fields.application});e.value.filterValue=(0,p.map)(e.value.filterValue,e=>this.rxDefinitionNameService.getDisplayName(e)),n.value.filterValue=(0,p.map)(n.value.filterValue,e=>`%${e}`)}const o=this.recordGridFilterService.addQueries(this.approvalRequestsGrid.buildQueryByAdvancedFilters(i),t);return o&&(e.queryExpression=o),e.propertySelection.push(ae.approvalRequestsGrid.fields.ifMultipleApprovers),this.rxSignatureDetailDataPageService.get({params:(0,p.omit)(Object.assign(Object.assign({},e),{status:this.selectedApprovalRequestsTab.status,shouldIncludeTotalSize:!0,ignoreAlternateUser:!1,propertySelection:e.propertySelection.filter(e=>e!==ae.approvalRequestsGrid.fields.actingAs)}),["searchText","recorddefinition"])}).pipe((0,u.tap)(e=>{e.data.forEach(e=>{e.otherDetail1=this.rxApprovalConsoleHelperService.formatValue(e.otherDetail1),e.otherDetail2=this.rxApprovalConsoleHelperService.formatValue(e.otherDetail2),e.otherDetail3=this.rxApprovalConsoleHelperService.formatValue(e.otherDetail3),e.otherDetail4=this.rxApprovalConsoleHelperService.formatValue(e.otherDetail4)})}))}getNeedAttentionData(e){const t=(0,p.omit)(Object.assign(Object.assign({},this.attentionGridParams),e),["searchText"]);return this.rxRecordInstanceDataPageService.post({params:t})}updateGridConfig(){this.shouldShowGrid=!1,this.gridConfig$=this.prepareGridConfiguration(),setTimeout(()=>{this.shouldShowGrid=!0})}prepareGridConfiguration(){const e={enableFiltering:!0,enableRowSelection:l.RowSelectionMode.Multiple};return this.isApprovalRequestGrid()?(0,s.of)(Object.assign(Object.assign({},e),{actionButtons:this.getActionButtons(),getData:e=>this.getData(e),columns:this.getColumns(),getRecordDefinition:()=>(0,s.of)(this.getRecordDefinition()),recordIdField:ae.approvalRequestsGrid.fields.signatureInstanceID,styles:"flex-fill",guid:`ap-${this.rxStringService.toRxId(this.selectedApprovalRequestsTab.status)}-grid`})):this.isNeedAttentionGrid()?(0,s.of)(Object.assign(Object.assign({},e),{recordDefinitionName:ae.needAttentionRequestsGrid.definition,getData:e=>this.getNeedAttentionData(e),columns:this.needAttentionGridColumns(),styles:"flex-fill",guid:"ap-need-attention-grid"})):void 0}getActionButtons(){return(0,p.includes)([ne.Pending,ne.RequestMoreInfo,ne.Hold],this.selectedApprovalRequestsTab.status)?[{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.button.approve.label"),style:"success",iconCls:"check_circle_o",size:"small",actions:[{name:()=>this.approveRequest()}]},{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.button.reject.label"),style:"critical",iconCls:"cross_circle_o",size:"small",actions:[{name:()=>this.rejectRequest()}]},{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.button.hold.label"),style:"warning",iconCls:"pause_circle_o",size:"small",disabled:()=>this.isHoldButtonDisabled(),actions:[{name:()=>this.holdRequest()}]},{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.button.reassign.label"),iconCls:"user_arrow_o",style:"secondary",size:"small",disabled:()=>this.isReassignButtonDisabled,actions:[{name:()=>this.reassignRequest()}]}]:[]}reloadGridData(){this.selectedApprovalRequest=null,this.approvalRequestsGrid.api.refresh().subscribe()}openQuestionResponseDialog(e){this.rxModalService.openModal({content:ce,size:"sm",data:{selectedRequest:e}}).then(e=>{e&&this.reloadGridData()}).catch(p.noop)}getColumns(){return[{fieldId:ae.approvalRequestsGrid.fields.application,title:this.translateService.instant("com.bmc.arsys.rx.client.common.record-definition.label"),cellTemplate:this.definitionNameCellTemplate},{fieldId:ae.approvalRequestsGrid.fields.summary,title:this.translateService.instant("com.bmc.arsys.rx.client.common.description.label"),cellTemplate:this.resolvedFieldCellTemplate,sortable:!1},{fieldId:ae.approvalRequestsGrid.fields.requester,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.requester.label"),cellTemplate:this.resolvedFieldCellTemplate,sortable:!0},{fieldId:ae.approvalRequestsGrid.fields.status,title:this.translateService.instant("com.bmc.arsys.rx.client.common.status.label"),filterable:!1,sortable:!1},{fieldId:ae.approvalRequestsGrid.fields.request,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.request-id.label"),cellTemplate:this.resolvedFieldCellTemplate,sortable:!0},{fieldId:ae.approvalRequestsGrid.fields.actingAs,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.grid.column.acting-as.title"),filterable:!1,searchable:!1,sortable:!1},{fieldId:ae.approvalRequestsGrid.fields.createDateSig,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.request-date.label"),visible:!1,filterable:!1},{fieldId:ae.approvalRequestsGrid.fields.process,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.grid.column.process.title"),visible:!1,filterable:!1},{fieldId:ae.approvalRequestsGrid.fields.signatureInstanceID,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.grid.column.signature-instance-id.title"),visible:!1,filterable:!1},{fieldId:ae.approvalRequestsGrid.fields.justificationReasonField,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.grid.column.justification.title"),visible:!1,filterable:!1,sortable:!1},{fieldId:ae.approvalRequestsGrid.fields.sigTermStateDate,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.grid.column.status-updated-on.title"),visible:!1,filterable:!1},{fieldId:ae.approvalRequestsGrid.fields.signatureID,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.grid.column.signature-id.title"),visible:!1,filterable:!1},{fieldId:ae.approvalRequestsGrid.fields.otherDetail1,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.grid.column.other-detail1.title"),visible:!1,filterable:!1,sortable:!1},{fieldId:ae.approvalRequestsGrid.fields.otherDetail2,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.grid.column.other-detail2.title"),visible:!1,filterable:!1,sortable:!1},{fieldId:ae.approvalRequestsGrid.fields.otherDetail3,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.grid.column.other-detail3.title"),visible:!1,filterable:!1,sortable:!1},{fieldId:ae.approvalRequestsGrid.fields.otherDetail4,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.grid.column.other-detail4.title"),visible:!1,filterable:!1,sortable:!1},{fieldId:ae.approvalRequestsGrid.fields.justificationRequired,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.justification.require-on.label"),visible:!1,filterable:!1},{fieldId:ae.approvalRequestsGrid.fields.processInstanceId,title:this.translateService.instant("com.bmc.arsys.rx.client.approval.console.grid.column.process-instance-id.title"),visible:!1,filterable:!1,sortable:!1}]}getRecordDefinition(){return{fieldDefinitions:[{id:ae.approvalRequestsGrid.fields.application,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.summary,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.requester,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.status,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.selection,optionNamesById:{[ne.Pending]:this.translateService.instant(ae.approvalRequestTypes.pending.labelKey),[ne.RequestMoreInfo]:this.translateService.instant(ae.approvalRequestTypes.moreInfo.labelKey),[ne.Approved]:this.translateService.instant(ae.approvalRequestTypes.approved.labelKey),[ne.Rejected]:this.translateService.instant(ae.approvalRequestTypes.rejected.labelKey),[ne.Cancelled]:this.translateService.instant(ae.approvalRequestTypes.cancelled.labelKey),[ne.Error]:this.translateService.instant(ae.approvalRequestTypes.error.labelKey),[ne.Hold]:this.translateService.instant(ae.approvalRequestTypes.onHold.labelKey),[ne.Closed]:this.translateService.instant(ae.approvalRequestTypes.closed.labelKey)}},{id:ae.approvalRequestsGrid.fields.request,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.actingAs,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.createDateSig,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.dateTime},{id:ae.approvalRequestsGrid.fields.process,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.signatureInstanceID,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.justificationReasonField,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.sigTermStateDate,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.dateTime},{id:ae.approvalRequestsGrid.fields.signatureID,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.otherDetail1,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.otherDetail2,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.otherDetail3,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.otherDetail4,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character},{id:ae.approvalRequestsGrid.fields.justificationRequired,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.selection,optionNamesById:{[a.JustificationRequirement.RequiredForApproval]:this.translateService.instant("com.bmc.arsys.rx.client.approval.justification.require-on.approval.label"),[a.JustificationRequirement.RequiredForRejection]:this.translateService.instant("com.bmc.arsys.rx.client.approval.justification.require-on.rejection.label"),[a.JustificationRequirement.RequiredForApprovalOrRejection]:this.translateService.instant("com.bmc.arsys.rx.client.approval.justification.require-on.approval-rejection.label"),[a.JustificationRequirement.NotRequired]:this.translateService.instant("com.bmc.arsys.rx.client.common.not-applicable.label")}},{id:ae.approvalRequestsGrid.fields.processInstanceId,resourceType:d.RX_RECORD_DEFINITION.resourceTypes.character}]}}}Ce.\u0275fac=function(e){return new(e||Ce)(n["\u0275\u0275directiveInject"](x.RxStringService),n["\u0275\u0275directiveInject"](me),n["\u0275\u0275directiveInject"](a.RxCurrentUserService),n["\u0275\u0275directiveInject"](c.TranslateService),n["\u0275\u0275directiveInject"](f.RxModalService),n["\u0275\u0275directiveInject"](a.RxNotificationService),n["\u0275\u0275directiveInject"](le),n["\u0275\u0275directiveInject"](d.RxRecordInstanceService),n["\u0275\u0275directiveInject"](h.AdaptModalService),n["\u0275\u0275directiveInject"](ie),n["\u0275\u0275directiveInject"](l.RxRecordGridFilterService),n["\u0275\u0275directiveInject"](d.RxRecordInstanceDataPageService),n["\u0275\u0275directiveInject"](a.RxDefinitionNameService))},Ce.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Ce,selectors:[["rx-approval-console"]],viewQuery:function(e,t){if(1&e&&(n["\u0275\u0275viewQuery"](G,5),n["\u0275\u0275viewQuery"](q,7),n["\u0275\u0275viewQuery"](U,7),n["\u0275\u0275viewQuery"](z,5)),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.requestDetailsTabs=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.resolvedFieldCellTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.definitionNameCellTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.approvalRequestsGrid=e.first)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:37,vars:35,consts:[[1,"row","h-100"],[1,"col-12","col-md-7","d-flex","flex-column","flex-fill","h-100"],[1,"mt-0"],["type","pills","rx-id","approval-requests-tabs",3,"tab-active","tab-active-changed",4,"ngIf"],[3,"config","dataLoaded",4,"ngIf"],[1,"col-12","col-md-5","mt-4","mt-md-0","d-flex","flex-column","flex-fill","h-100"],[1,"mb-1"],["type","button","adapt-button","","btn-type","secondary","size","small","rx-id","prev-button",1,"d-icon-left-angle_left","mr-2",3,"disabled","click"],["type","button","adapt-button","","btn-type","secondary","size","small","rx-id","next-button",1,"d-icon-left-angle_right","mr-3",3,"disabled","click"],[1,"d-inline-block","my-0","align-middle"],[4,"ngIf"],["type","pills","rx-id","request-details-tabs",1,"d-flex","flex-column","flex-fill","h-100",3,"tab-active","tab-active-changed"],["requestDetailsTabs",""],["badge-type","primary",3,"adapt-tab-title"],[3,"approvalRequest","gridType"],[3,"adapt-tab-title"],["class","d-flex flex-column flex-fill h-100",3,"approvalRequest","gridType",4,"ngIf"],["class","d-flex flex-column flex-fill h-100",3,"approvalRequest","gridType","requestsTabStatus","questionSubmitted",4,"ngIf"],["definitionNameCellTemplate",""],["resolvedFieldCellTemplate",""],["type","pills","rx-id","approval-requests-tabs",3,"tab-active","tab-active-changed"],[3,"adapt-tab-title","badge","badge-type",4,"ngFor","ngForOf"],[3,"adapt-tab-title","badge","badge-type"],[3,"config","dataLoaded"],["approvalRequestsGrid",""],[1,"d-flex","flex-column","flex-fill","h-100",3,"approvalRequest","gridType"],[1,"d-flex","flex-column","flex-fill","h-100",3,"approvalRequest","gridType","requestsTabStatus","questionSubmitted"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275elementStart"](2,"h2",2),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](5,W,2,2,"adapt-tabset",3),n["\u0275\u0275pipe"](6,"async"),n["\u0275\u0275template"](7,H,2,1,"rx-record-grid",4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](8,"div",5),n["\u0275\u0275elementStart"](9,"div",6),n["\u0275\u0275elementStart"](10,"button",7),n["\u0275\u0275listener"]("click",function(){return t.showPreviousRequestDetails()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](11,"button",8),n["\u0275\u0275listener"]("click",function(){return t.showNextRequestDetails()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](12,"h2",9),n["\u0275\u0275text"](13),n["\u0275\u0275pipe"](14,"translate"),n["\u0275\u0275template"](15,Q,2,1,"span",10),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](16,"adapt-tabset",11,12),n["\u0275\u0275listener"]("tab-active-changed",function(e){return t.onTabChanged(e)}),n["\u0275\u0275elementStart"](18,"adapt-tab-panel",13),n["\u0275\u0275pipe"](19,"translate"),n["\u0275\u0275element"](20,"rx-approval-request-general-details",14),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](21,"adapt-tab-panel",15),n["\u0275\u0275pipe"](22,"translate"),n["\u0275\u0275template"](23,J,1,2,"rx-approval-request-approvers",16),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](24,"adapt-tab-panel",15),n["\u0275\u0275pipe"](25,"translate"),n["\u0275\u0275template"](26,K,1,3,"rx-approval-request-questions",17),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](27,"adapt-tab-panel",15),n["\u0275\u0275pipe"](28,"translate"),n["\u0275\u0275template"](29,Y,1,2,"rx-approval-request-comments",16),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](30,"adapt-tab-panel",15),n["\u0275\u0275pipe"](31,"translate"),n["\u0275\u0275template"](32,Z,1,2,"rx-approval-request-attachments",16),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](33,ee,2,3,"ng-template",null,18,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](35,te,1,1,"ng-template",null,19,n["\u0275\u0275templateRefExtractor"])),2&e&&(n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate"](n["\u0275\u0275pipeBind1"](4,19,"com.bmc.arsys.rx.client.approval.console.requests.title")),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](6,21,t.availableRequestCount$)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.shouldShowGrid),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("disabled",t.isPreviousButtonDisabled()),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",t.isNextButtonDisabled()),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](14,23,"com.bmc.arsys.rx.client.approval.console.request-details.title")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.currentRequestId),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("tab-active",0),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("adapt-tab-title",n["\u0275\u0275pipeBind1"](19,25,"com.bmc.arsys.rx.client.common.general-items.label")),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("approvalRequest",t.selectedApprovalRequest)("gridType",t.selectedApprovalRequestsTab.gridType),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("adapt-tab-title",n["\u0275\u0275pipeBind1"](22,27,"com.bmc.arsys.rx.client.approval.console.approvers.title")),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",1===t.activeTabIndex),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("adapt-tab-title",n["\u0275\u0275pipeBind1"](25,29,"com.bmc.arsys.rx.client.approval.console.questions.label")),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",2===t.activeTabIndex),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("adapt-tab-title",n["\u0275\u0275pipeBind1"](28,31,"com.bmc.arsys.rx.client.approval.console.comments.title")),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",3===t.activeTabIndex),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("adapt-tab-title",n["\u0275\u0275pipeBind1"](31,33,"com.bmc.arsys.rx.client.approval.console.attachments.title")),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",4===t.activeTabIndex))},directives:[o.NgIf,h.AdaptButtonComponent,h.AdaptTabsComponent,h.AdaptTabsPanelComponent,ue,o.NgForOf,l.RecordGridComponent,fe,ge,xe,be],pipes:[c.TranslatePipe,o.AsyncPipe,a.RxDefinitionNamePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{display:block;padding:1rem;height:100%}[_nghost-%COMP%]  adapt-tabset .tab-content{padding:.5rem 0 0}[_nghost-%COMP%]  rx-record-grid{height:100%}[_nghost-%COMP%]  rx-record-grid .rx-action-button_success button{background:#89c341;border-color:#78ac36}[_nghost-%COMP%]  rx-record-grid .rx-action-button_success button:hover{background-color:#78ac36}[_nghost-%COMP%]  rx-record-grid .rx-action-button_critical button{background:#f83200;border-color:#d72b00}[_nghost-%COMP%]  rx-record-grid .rx-action-button_critical button:hover{background-color:#d72b00}[_nghost-%COMP%]  rx-record-grid .rx-action-button_warning button{color:#313538;background:#f1b521;border-color:#e3a50e}[_nghost-%COMP%]  rx-record-grid .rx-action-button_warning button:hover{background-color:#e3a50e}[_nghost-%COMP%]  rx-record-grid .rx-action-button_warning button:disabled{color:#313538;background-color:#f6cf6f}']});class Se{constructor(e,t){this.componentFactoryResolver=e,this.rxViewComponentRegistryService=t,t.register({type:"rx-approval-console",componentFactory:this.componentFactoryResolver.resolveComponentFactory(Ce),name:"Approval console",isPageComponent:!0,availableInBundles:[a.RX_APPLICATION.approvalBundleId]})}}Se.\u0275fac=function(e){return new(e||Se)(n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](r.RxViewComponentRegistryService))},Se.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Se,declarations:[Ce,ue,de,fe,ge,xe,be,ce,he,ve,pe],imports:[o.CommonModule,l.RecordGridModule,h.AdaptButtonModule,h.AdaptDropdownModule,v.FormsModule,c.TranslateModule,h.AdaptTabsModule,f.ReadOnlyFieldModule,f.RxBusyIndicatorModule,a.RxDefinitionModule,g.RxSelectWithPaginationModule,h.AdaptEmptyStateModule,h.AdaptRxTextareaModule,h.AdaptRxUploaderModule,h.AdaptBusyModule,h.AdaptDownloadModule,h.AdaptRxLabelModule,h.AdaptRxSwitchModule,h.AdaptAlertModule,h.AdaptRxTextfieldModule]}),Se.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[me],imports:[[o.CommonModule,l.RecordGridModule,h.AdaptButtonModule,h.AdaptDropdownModule,v.FormsModule,c.TranslateModule,h.AdaptTabsModule,f.ReadOnlyFieldModule,f.RxBusyIndicatorModule,a.RxDefinitionModule,g.RxSelectWithPaginationModule,h.AdaptEmptyStateModule,h.AdaptRxTextareaModule,h.AdaptRxUploaderModule,h.AdaptBusyModule,h.AdaptDownloadModule,h.AdaptRxLabelModule,h.AdaptRxSwitchModule,h.AdaptAlertModule,h.AdaptRxTextfieldModule]]});class we{}we.\u0275fac=function(e){return new(e||we)},we.\u0275mod=n["\u0275\u0275defineNgModule"]({type:we,imports:[Se]}),we.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[],imports:[[Se]]})},"./node_modules/@helix/platform/fesm2015/helix-platform-dataload-components.js":(e,t,i)=>{"use strict";i.r(t),i.d(t,{DataImportComponent:()=>ve,DataImportRegistrationModule:()=>ye,DataloadModule:()=>ke});var n=i("./node_modules/@angular/core/fesm2015/core.js"),o=i("./node_modules/@angular/common/fesm2015/common.js"),r=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-api.js"),a=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-api.js"),s=i("./node_modules/@angular/forms/fesm2015/forms.js"),l=i("./node_modules/@ngx-translate/core/fesm2015/ngx-translate-core.js"),d=i("rxjs"),c=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-components.js"),p=i("./node_modules/@helix/platform/fesm2015/helix-platform-record-api.js"),m=i("./node_modules/@helix/platform/fesm2015/helix-platform-utils.js"),u=i("lodash"),f=i("./node_modules/@helix/platform/fesm2015/helix-platform-ui-kit.js"),h=i("./node_modules/@angular/common/fesm2015/http.js"),g=i("./node_modules/@bmc-ux/adapt-angular/fesm2015/bmc-ux-adapt-angular.js"),v=i("./node_modules/rxjs/_esm2015/operators/index.js"),y=i("./node_modules/@bmc-ux/adapt-table/fesm2015/bmc-ux-adapt-table.js"),x=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-components.js"),b=i("./node_modules/@helix/platform/fesm2015/helix-platform-association-api.js");function C(e,t){1&e&&n["\u0275\u0275element"](0,"rx-line-loader")}function S(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.fileUploadedNotProcessedMsg," ")}}const w=function(e){return{content:e,type:"inline",variant:"warning"}};function D(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-alert",8),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("config",n["\u0275\u0275pureFunction1"](1,w,e.processStartInfo))}}function R(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"div",4),n["\u0275\u0275template"](2,S,2,1,"div",5),n["\u0275\u0275template"](3,D,1,3,"adapt-alert",6),n["\u0275\u0275element"](4,"adapt-table",7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.ngIf,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",i.fileUploadedNotProcessedMsg),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",i.processStartInfo),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("hidden",i.fileUploadedNotProcessedMsg)("columns",i.columns)("bordered",!0)("value",e)("wrapCellText",!0)}}const I=["dataImportConfigurationForm"],F=function(e){return{"mr-3":e}};function E(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-rx-radiobutton",17),2&e){const e=t.$implicit,i=t.index;n["\u0275\u0275property"]("value",e.value)("label",e.displayValue)("ngClass",n["\u0275\u0275pureFunction1"](3,F,0===i))}}function M(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-definition-picker",18),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.name=t})("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onDefinitionChange(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("options",e.recordPickerOptions)("ngModel",e.currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.name)}}function A(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-definition-picker",19),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.name=t})("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onDefinitionChange(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("options",e.associationPickerOptions)("ngModel",e.currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.name)}}function O(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",27),n["\u0275\u0275elementStart"](1,"div",21),n["\u0275\u0275element"](2,"adapt-rx-control-label",22),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"div",28),n["\u0275\u0275element"](5,"adapt-rx-control-label",22),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](3,2,"com.bmc.arsys.rx.client.dataload.import.wizard.tabs.data-mapping.source-fields.label")),n["\u0275\u0275advance"](3),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](6,4,"com.bmc.arsys.rx.client.dataload.import.wizard.tabs.data-mapping.target-fields.label")))}function P(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",29),n["\u0275\u0275element"](1,"div",30),n["\u0275\u0275elementEnd"]())}const T=function(){return{standalone:!0}},V=function(e){return{"text-tertiary":e}};function N(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",31),n["\u0275\u0275elementStart"](1,"div",32),n["\u0275\u0275elementStart"](2,"adapt-rx-select",33),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.sourceField.fieldName=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](3).updateDataChangesToSheetMapContext()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](3,"div",34),n["\u0275\u0275elementStart"](4,"div",32),n["\u0275\u0275elementStart"](5,"adapt-rx-select",35),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.targetField=t})("onSelectionChange",function(t){const i=n["\u0275\u0275restoreView"](e).index;return n["\u0275\u0275nextContext"](3).onTargetFieldSelection(t,i)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](6,"div",36),n["\u0275\u0275elementStart"](7,"button",37),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).index;return n["\u0275\u0275nextContext"](3).removeMapping(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](3);n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngModel",e.sourceField.fieldName)("options",i.sourceFieldNameList)("required",!0)("enableFilter",!0)("ngModelOptions",n["\u0275\u0275pureFunction0"](14,T)),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngModel",e.targetField)("options",i.targetFieldList)("optionFormatter",i.optionFormatter)("required",!0)("enableFilter",!0)("disabled",i.isRequiredTargetField(e.targetField))("ngModelOptions",n["\u0275\u0275pureFunction0"](15,T)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",i.isRequiredTargetField(e.targetField))("ngClass",n["\u0275\u0275pureFunction1"](16,V,i.isRequiredTargetField(e.targetField)))}}function k(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"div",20),n["\u0275\u0275elementStart"](2,"div",21),n["\u0275\u0275element"](3,"adapt-rx-control-label",22),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",21),n["\u0275\u0275elementStart"](6,"button",23),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).addFieldMapping()}),n["\u0275\u0275text"](7),n["\u0275\u0275pipe"](8,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](9,O,7,6,"div",24),n["\u0275\u0275template"](10,P,2,0,"div",25),n["\u0275\u0275template"](11,N,8,18,"div",26),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](3),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](4,5,"com.bmc.arsys.rx.client.dataload.import.wizard.tabs.data-mapping.mapping-title.title")),n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](8,7,"com.bmc.arsys.rx.client.dataload.import.wizard.tabs.data-mapping.types.manual-mapping.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",e.currentSheetDataImportMapping.configurations.definitionMappings.fieldMappings.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.areFieldsLoading),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.currentSheetDataImportMapping.configurations.definitionMappings.fieldMappings)}}function j(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",10),n["\u0275\u0275elementStart"](1,"button",11),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().autoMapping()}),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"adapt-rx-radiobutton-group",12),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.type=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onDefinitionTypeChange()}),n["\u0275\u0275pipe"](5,"translate"),n["\u0275\u0275template"](6,E,1,5,"adapt-rx-radiobutton",13),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](7,M,1,2,"rx-definition-picker",14),n["\u0275\u0275template"](8,A,1,2,"rx-definition-picker",15),n["\u0275\u0275template"](9,k,12,9,"div",16),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",e.areFieldsLoading),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,8,"com.bmc.arsys.rx.client.dataload.import.wizard.tabs.data-mapping.types.auto-mapping.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](5,10,"com.bmc.arsys.rx.client.common.definition.label")),n["\u0275\u0275property"]("ngModel",e.currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.type),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",e.definitionTypeOptions),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.type===e.definitionTypes.record),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.type===e.definitionTypes.association),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.name)}}function _(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-select",38),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().selectedMatchDuplicateByFields=t}),n["\u0275\u0275pipe"](1,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](1,9,"com.bmc.arsys.rx.client.dataload.import.wizard.tabs.duplicate-handling.match-by.label")),n["\u0275\u0275property"]("ngModel",e.selectedMatchDuplicateByFields)("options",e.matchDuplicateByFields)("multiple",!0)("enableFilter",!0)("selectAllButton",!0)("deselectAllButton",!0)("optionFormatter",e.optionFormatter)("required",!e.shouldGenerateNewIdForDuplicateRecords())}}const B=function(e){return{"d-block form-group":e}};function $(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-checkbox",39),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.isSelected=t}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=t.index;n["\u0275\u0275propertyInterpolate"]("label",e.name),n["\u0275\u0275propertyInterpolate"]("name","data-option"+e.id),n["\u0275\u0275property"]("ngModel",e.isSelected)("ngClass",n["\u0275\u0275pureFunction1"](5,B,2===i)),n["\u0275\u0275attribute"]("rx-id","data-option"+e.id)}}function L(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",40),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate2"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.common.example.label"),": ",e.timeFormatExample," ")}}function G(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"strong"),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](2,"div",40),n["\u0275\u0275text"](3),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e.name),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"]("e.g. ",e.example,"")}}function q(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-textfield",8),n["\u0275\u0275listener"]("onFocus",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().updateWizardButtons()}),n["\u0275\u0275pipe"](1,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](1,2,"com.bmc.arsys.rx.client.dataload.import.attachment-type.zip.content-file.label")),n["\u0275\u0275property"]("autofocus",!0))}function U(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",9),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.common.example.label")," Worksheet.xlsx "))}const z=function(e){return{busy:e}},X=["grid"],W=["recordNamesCellTemplate"],H=["statusInfoCellTemplate"];function Q(e,t){if(1&e&&n["\u0275\u0275text"](0),2&e){const e=t.dataItem,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275textInterpolate1"](" ",i.getRecordNames(e),"\n")}}function J(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"a",5),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).dataItem;return n["\u0275\u0275nextContext"]().showStatusInfo(t)}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.common.action-view.label")))}function K(e,t){1&e&&n["\u0275\u0275element"](0,"rx-line-loader")}function Y(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.exportConfiguredNotProcessedMsg," ")}}function Z(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-alert",8),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("config",n["\u0275\u0275pureFunction1"](1,w,e.processStartInfo))}}function ee(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"div",4),n["\u0275\u0275template"](2,Y,2,1,"div",5),n["\u0275\u0275template"](3,Z,1,3,"adapt-alert",6),n["\u0275\u0275element"](4,"adapt-table",7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.ngIf,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",i.exportConfiguredNotProcessedMsg),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",i.processStartInfo),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("hidden",i.exportConfiguredNotProcessedMsg)("columns",i.columns)("bordered",!0)("value",e)("wrapCellText",!0)}}function te(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-radiobutton",23),n["\u0275\u0275listener"]("checkedChange",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().index;return n["\u0275\u0275nextContext"]().clearFieldsSelection(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=t.index;n["\u0275\u0275property"]("value",e.value)("label",e.displayValue)("ngClass",n["\u0275\u0275pureFunction1"](3,F,0===i))}}function ie(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-definition-picker",24),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().$implicit.name=t})("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index;return n["\u0275\u0275nextContext"]().onDefinitionChange(t,i)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("options",t.recordPickerOptions)("ngModel",e.name)}}function ne(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-definition-picker",25),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().$implicit.name=t})("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index;return n["\u0275\u0275nextContext"]().onDefinitionChange(t,i)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("options",t.associationPickerOptions)("ngModel",e.name)}}function oe(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-select",27),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).$implicit.criteria.fields=t}),n["\u0275\u0275pipe"](1,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().ngIf,t=n["\u0275\u0275nextContext"](),i=t.$implicit,o=t.index,r=n["\u0275\u0275nextContext"]();n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](1,10,"com.bmc.arsys.rx.client.dataload.export.new-configuration.fields.label")),n["\u0275\u0275property"]("ngModel",i.criteria.fields)("options",e)("required",!0)("multiple",!0)("enableFilter",!0)("selectAllButton",!0)("deselectAllButton",!0)("optionFormatter",r.optionFormatter),n["\u0275\u0275attribute"]("rx-id","definition-"+o+"_fields")}}function re(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275template"](1,oe,2,12,"adapt-rx-select",26),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.type===t.definitionTypes.record)}}function ae(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",28),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"]().openExportingDataPreview(t)}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("disabled",t.isPreviewDisabled(e)),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.dataload.export.new-configuration.preview-data.label")," ")}}function se(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",11),n["\u0275\u0275elementStart"](1,"span",12),n["\u0275\u0275elementStart"](2,"button",13),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).index;return n["\u0275\u0275nextContext"]().remove(t)}),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"adapt-accordion-tab",14),n["\u0275\u0275elementStart"](6,"adapt-rx-radiobutton-group",15),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.type=t}),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275template"](8,te,1,5,"adapt-rx-radiobutton",16),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](9,ie,1,2,"rx-definition-picker",17),n["\u0275\u0275template"](10,ne,1,2,"rx-definition-picker",18),n["\u0275\u0275elementStart"](11,"div",19),n["\u0275\u0275template"](12,re,2,1,"div",20),n["\u0275\u0275pipe"](13,"async"),n["\u0275\u0275elementStart"](14,"rx-expression-form-control",21),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.criteria.filter=t})("events",function(){const t=n["\u0275\u0275restoreView"](e).index;return n["\u0275\u0275nextContext"]().onExpressionEvent(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](15,ae,3,4,"button",22),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=t.index,o=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](4,12,"com.bmc.arsys.rx.client.common.remove.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](7,14,"com.bmc.arsys.rx.client.dataload.export.new-configuration.definition.label")),n["\u0275\u0275property"]("ngModel",e.type)("required",!0),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",o.definitionTypeOptions),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.type===o.definitionTypes.record),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.type===o.definitionTypes.association),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("hidden",!e.name),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](13,16,o.definitionFields$[i])),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("options",o.dataFilterExpressionOptions)("ngModel",e.criteria.filter),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.type===o.definitionTypes.record)}}function le(e,t){if(1&e&&n["\u0275\u0275text"](0),2&e){const e=t.dataItem,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275textInterpolate1"](" ",i.getRecordNames(e),"\n")}}function de(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"a",5),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).dataItem;return n["\u0275\u0275nextContext"]().showStatusInfo(t)}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.common.action-view.label")))}const ce="[_nghost-%COMP%]{display:block;padding:1rem;height:100%}[_nghost-%COMP%]  rx-record-grid{height:100%}",pe={recordDefinitionName:"com.bmc.arsys.rx.dataload:Data Load Files",archiveTrueValue:1,uploadFileStepId:"uploadDataFile",temporaryStepConfig:{id:"temporaryStep",name:"",componentFactory:null},attachmentTypes:{xlsx:{value:1,extension:"xlsx"},zip:{value:2,extension:"zip"}},fields:{importJobName:536870913,uploadedOn:536870914,importJobDescription:536870915,dataFile:536870916,attachmentOut:536870917,message:536870918,attachmentType:536870919,archivedWorksheetFileName:536870920,isArchived:536870921,mappingConfig:536870923},dataStatuses:{all:-1,queued:6,new:0,processing:1,processed:2,stopping:7,stopped:8,errored:3},mergeOptions:{generateNewIds:1,rejectDuplicates:2,generateNewIdsForDuplicates:3,updateRecords:4,replaceRecords:5}};class me{constructor(e){this.httpClient=e,this.url=`/api/${a.RX_APPLICATION.dataloadBundleId}/rx/application/dataload/`}runLoadProcess(e){return this.httpClient.post(`${this.url}${e}`,{})}stopDataProcessing(e){return this.httpClient.post(`${this.url}stop/${e}`,{})}getDataRecordWorksheet(e){return this.httpClient.get(`${this.url}${e}/input_file_conf`)}getEmptyCurrentSheetDataMapConfig(e){return{name:e,configurations:{definitionMappings:{targetDefinition:{type:null,name:null},fieldMappings:[]},dataHandlingOptions:[],timeFormatOptions:null,duplicateHandlingOptions:{matchDuplicateBy:[],handleDuplicateBy:null}}}}}me.\u0275fac=function(e){return new(e||me)(n["\u0275\u0275inject"](h.HttpClient))},me.\u0275prov=n["\u0275\u0275defineInjectable"]({token:me,factory:me.\u0275fac,providedIn:"root"});class ue{constructor(e,t,i,n,o){this.datePipe=e,this.rxTranslateService=t,this.rxJsonParserService=i,this.activeModalRef=n,this.rxRecordInstanceDataPageService=o,this.statusData$=this.rxRecordInstanceDataPageService.post({params:{[p.RX_RECORD_DEFINITION.coreFieldIds.id]:this.activeModalRef.getData().dataRecordId,recorddefinition:pe.recordDefinitionName}}).pipe((0,v.map)(e=>{e.data[0][p.RX_RECORD_DEFINITION.coreFieldIds.status]===pe.dataStatuses.processing&&(this.processStartInfo=`${this.rxTranslateService.instant("com.bmc.arsys.rx.client.dataload.process-started.message")} ${this.datePipe.transform(e.data[0][p.RX_RECORD_DEFINITION.coreFieldIds.modifiedDate],"medium")}`);const t=(0,u.get)(this.rxJsonParserService.tryParseJson(e.data[0][pe.fields.message],[]),"dataLoadProgressStatus");return t?(0,u.map)(t,e=>Object.assign(Object.assign({},e),{updateTime:this.datePipe.transform(e.updateTime,"medium")})):(this.fileUploadedNotProcessedMsg=e.data[0][pe.fields.message],[])})),this.columns=[{field:"updateTime",header:this.rxTranslateService.instant("com.bmc.arsys.rx.client.dataload.status-info-grid.column.updated-date.title"),sortable:!1,width:"20%"},{field:"status",header:this.rxTranslateService.instant("com.bmc.arsys.rx.client.common.status.label"),width:"20%"},{field:"message",header:this.rxTranslateService.instant("com.bmc.arsys.rx.client.common.message.label"),width:"80%"}]}close(){this.activeModalRef.close()}}ue.\u0275fac=function(e){return new(e||ue)(n["\u0275\u0275directiveInject"](o.DatePipe),n["\u0275\u0275directiveInject"](l.TranslateService),n["\u0275\u0275directiveInject"](m.RxJsonParserService),n["\u0275\u0275directiveInject"](g.ActiveModalRef),n["\u0275\u0275directiveInject"](p.RxRecordInstanceDataPageService))},ue.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ue,selectors:[["dl-import-record-status-info"]],decls:8,vars:7,consts:[["loaderTemplate",""],[4,"ngIf","ngIfElse"],[1,"modal-footer"],["adapt-button","","btn-type","secondary","rx-id","close-button","type","button",3,"click"],[1,"data-status-info"],[4,"ngIf"],[3,"config",4,"ngIf"],["rx-id","imported-status-info-grid",3,"hidden","columns","bordered","value","wrapCellText"],[3,"config"]],template:function(e,t){if(1&e&&(n["\u0275\u0275template"](0,C,1,0,"ng-template",null,0,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](2,R,5,7,"div",1),n["\u0275\u0275pipe"](3,"async"),n["\u0275\u0275elementStart"](4,"div",2),n["\u0275\u0275elementStart"](5,"button",3),n["\u0275\u0275listener"]("click",function(){return t.close()}),n["\u0275\u0275text"](6),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275reference"](1);n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](3,3,t.statusData$))("ngIfElse",e),n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](7,5,"com.bmc.arsys.rx.client.common.close.label")," ")}},directives:[o.NgIf,g.AdaptButtonComponent,f.RxLineLoaderComponent,y.AdaptTableComponent,g.AdaptAlertComponent],pipes:[o.AsyncPipe,l.TranslatePipe],styles:[".data-status-info[_ngcontent-%COMP%]{padding:15px}"]});class fe{constructor(e){this.httpClient=e,this.url=`/api/${a.RX_APPLICATION.dataloadBundleId}/rx/application/dataexport/`}isRecordDefinitionResponse(e){return!(0,u.isUndefined)(e.fieldDefinitions)}startDataExport(e){return this.httpClient.post(`${this.url}${e}`,{})}}fe.\u0275fac=function(e){return new(e||fe)(n["\u0275\u0275inject"](h.HttpClient))},fe.\u0275prov=n["\u0275\u0275defineInjectable"]({token:fe,factory:fe.\u0275fac,providedIn:"root"});class he{constructor(e,t,i,n,o,r,a,s,l,c){this.dataImportService=e,this.dataExportService=t,this.rxRecordDefinitionCacheService=i,this.changeDetectorRef=n,this.rxModalService=o,this.rxWizardModalComponent=r,this.definitionNameService=a,this.translateService=s,this.rxAssociationDefinitionService=l,this.rxNotificationService=c,this.sourceFieldNameList=[],this.targetFieldList=[],this.definitionTypes={record:"record",association:"association"},this.definitionTypeOptions=[{value:this.definitionTypes.record,displayValue:this.translateService.instant("com.bmc.arsys.rx.client.definition-type.record.label")},{value:this.definitionTypes.association,displayValue:this.translateService.instant("com.bmc.arsys.rx.client.definition-type.association.label")}],this.recordPickerOptions={label:"",definitionType:x.RxDefinitionPickerType.Record,availableDefinitionPickerStates:{definitionButtonsGroups:[x.RX_DEFINITION_PICKER.definitionScopes.all],search:x.RX_DEFINITION_PICKER.definitionScopes.all}},this.associationPickerOptions={label:"",definitionType:x.RxDefinitionPickerType.Association,availableDefinitionPickerStates:{definitionButtonsGroups:[x.RX_DEFINITION_PICKER.definitionScopes.all],search:x.RX_DEFINITION_PICKER.definitionScopes.all}},this.destroyed$=new d.ReplaySubject(1),this.duplicateHandlingOptions=[{id:pe.mergeOptions.generateNewIds,name:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.wizard.tabs.duplicate-handling.handle-by.generating-new-id-for-all")},{id:pe.mergeOptions.generateNewIdsForDuplicates,name:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.wizard.tabs.duplicate-handling.handle-by.generating-new-id-for-duplicates")},{id:pe.mergeOptions.rejectDuplicates,name:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.wizard.tabs.duplicate-handling.handle-by.rejecting-duplicate")},{id:pe.mergeOptions.replaceRecords,name:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.wizard.tabs.duplicate-handling.handle-by.replacing-existing-records")},{id:pe.mergeOptions.updateRecords,name:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.wizard.tabs.duplicate-handling.handle-by.updating-old-with-new")}],this.dataOptions=[{id:1,name:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.wizard.tabs.options.remove-leading-spaces-and-tabs"),isSelected:!1},{id:2,name:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.wizard.tabs.options.remove-trailing-spaces-and-tabs"),isSelected:!1},{id:3,name:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.wizard.tabs.options.truncate-long-strings"),isSelected:!1}],this.matchDuplicateByFields=[],this.selectedMatchDuplicateByFields=[],this.dateTimeFormatOptions=[{id:1,name:"dd/MM/yy",example:"25/11/21"},{id:2,name:"dd/MM/yyyy",example:"25/11/2021"},{id:3,name:"MM/dd/yyyy",example:"11/25/2021"},{id:4,name:"yyyy/MM/dd",example:"2021/11/25"},{id:5,name:"yyyy-MM-dd'T'HH:mm:ss:SSSZ",example:"2021-11-25T11:12:13:000+0530"}]}ngOnInit(){this.excelSheetName=this.options.sheetName,this.currentSheetDataImportMapping=this.dataImportService.getEmptyCurrentSheetDataMapConfig(this.excelSheetName),this.currentExcelSheetConfiguration=this.context.excelSheetsConfiguration[this.excelSheetName],this.sourceFieldNameList=(0,u.map)(this.currentExcelSheetConfiguration.fields,"name"),this.currentSheetDataImportMapping.configurations.duplicateHandlingOptions.handleDuplicateBy=[(0,u.find)(this.duplicateHandlingOptions,{id:pe.mergeOptions.generateNewIds})];Boolean(this.context.clonedConfigurationInstanceId)&&this.context.isClonedConfigMatched?(this.currentSheetDataImportMapping=(0,u.cloneDeep)(this.getRefactoredClonedConfiguration((0,u.find)(this.context.dataImportContext.dataImportConfigurations.sheets,{name:this.excelSheetName}))),setTimeout(()=>this.updateDataChangesToSheetMapContext()),this.getRecordDefinitionName()?this.loadTargetAndOtherFields(!1,!1):this.setTypeFromExcelSheet()):this.setTypeFromExcelSheet()}ngAfterViewInit(){this.dataImportConfigurationForm.control.valueChanges.pipe((0,v.distinctUntilChanged)(),(0,v.takeUntil)(this.destroyed$)).subscribe(e=>setTimeout(()=>this.updateDataChangesToSheetMapContext()))}removeMapping(e){this.currentSheetDataImportMapping.configurations.definitionMappings.fieldMappings.splice(e,1)}addFieldMapping(e=null,t=null){this.currentSheetDataImportMapping.configurations.definitionMappings.fieldMappings.push({sourceField:{fieldName:e?[e]:null},targetField:t?[t]:null}),this.updateWizardButtons()}setDefinitionTypeNameFromExcelSheet(){this.setTypeFromExcelSheet(),this.currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.name=this.currentExcelSheetConfiguration.definition.value}setTypeFromExcelSheet(){this.currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.type=this.getTypeFromExcelSheet()}autoMapping(){this.clearMappingFields(),this.setDefinitionTypeNameFromExcelSheet(),this.loadTargetAndOtherFields(!0)}loadTargetAndOtherFields(e=!1,t=!1){this.areFieldsLoading=!0,this.requiredFieldNames=[],(0,d.iif)(()=>this.isDefinitionTypeRecord(),this.rxRecordDefinitionCacheService.getRecordDefinition(this.getRecordDefinitionName()),this.rxAssociationDefinitionService.get(this.getRecordDefinitionName())).pipe((0,v.map)(e=>{this.dataExportService.isRecordDefinitionResponse(e)?this.targetFieldList=e.fieldDefinitions.sort(function(e,t){if(e.fieldOption===p.RecordFieldOption.Required&&!e.defaultValue)return-1;t.name.localeCompare(e.name)}).map(e=>(this.isMappingFieldDefinitionRequired(e)&&(this.requiredFieldNames.push(e.name),t&&this.addFieldMapping(null,{name:e.name,_fieldId:e.id})),{name:e.name,_fieldId:e.id})):this.targetFieldList=[{name:e.nodeAName||"",_fieldId:e.nodeAKeys[0]||""},{name:e.nodeBName||"",_fieldId:e.nodeBKeys[0]}].filter(e=>e.name)}),(0,v.tap)(()=>{e&&this.generateAutoMappingFields()}),(0,v.finalize)(()=>{this.areFieldsLoading=!1})).subscribe(()=>{this.currentSheetDataImportMapping.configurations.definitionMappings.fieldMappings=(0,u.sortBy)(this.currentSheetDataImportMapping.configurations.definitionMappings.fieldMappings,e=>(0,u.get)(e,"targetField[0].name"))})}isMappingFieldDefinitionRequired(e){return e.fieldOption===p.RecordFieldOption.Required&&!e.defaultValue}generateAutoMappingFields(){(0,u.forEach)(this.sourceFieldNameList,e=>{const t=this.targetFieldList.find(t=>e===t.name||e===String(t._fieldId));t?this.addFieldMapping(e,t):this.addFieldMapping(e,null)});const e=(0,u.flatten)((0,u.map)(this.currentSheetDataImportMapping.configurations.definitionMappings.fieldMappings,"targetField"));(0,u.forEach)(this.targetFieldList,t=>{!(0,u.find)(e,{name:t.name})&&this.isRequiredTargetField(t)&&this.addFieldMapping(null,t)})}onDefinitionChange(e){this.clearMappingFields(),e&&(this.definitionNameService.getBundleId(e)?this.loadTargetAndOtherFields(!1,!0):this.showInvalidDefinitionSelectedMsg())}clearMappingFields(){this.currentSheetDataImportMapping.configurations.definitionMappings.fieldMappings=[]}getRecordDefinitionName(e){return e?this.currentExcelSheetConfiguration.definition.value:this.currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.name}clearDefinitionSelection(){this.changeDetectorRef.detectChanges(),this.currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.name=null}onDefinitionTypeChange(){this.clearMappingFields(),this.clearDefinitionSelection()}showInvalidDefinitionSelectedMsg(){this.rxNotificationService.addErrorMessage(this.translateService.instant("com.bmc.arsys.rx.client.dataload.global-record-not-allowed.message")),this.clearDefinitionSelection()}isDefinitionTypeRecord(){return this.currentSheetDataImportMapping.configurations.definitionMappings.targetDefinition.type===this.definitionTypes.record}optionFormatter(e){return e.name}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}isStepActive(){var e;return this.rxWizardModalComponent.api.isCurrentStepActive(null===(e=this.currentExcelSheetConfiguration)||void 0===e?void 0:e.stepId)}onTargetFieldSelection(e,t){(0,u.flow)(e=>(0,u.filter)(e,(e,i)=>i!==t),t=>(0,u.find)(t,t=>{var i,n;return t.targetField&&(null===(i=null==t?void 0:t.targetField[0])||void 0===i?void 0:i.name)===(null===(n=e.options[0])||void 0===n?void 0:n.name)}),e=>e)(this.currentSheetDataImportMapping.configurations.definitionMappings.fieldMappings)?(this.rxNotificationService.addErrorMessage(this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.wizard.target-field-already-selected.message.title")),e.preventDefault()):setTimeout(()=>this.updateDataChangesToSheetMapContext())}isRequiredTargetField(e){return(0,u.includes)(this.requiredFieldNames,(null==e?void 0:e.name)||(0,u.get)(e,"[0].name"))}shouldGenerateNewIdForDuplicateRecords(){var e;return this.currentSheetDataImportMapping.configurations.duplicateHandlingOptions.handleDuplicateBy&&1===(null===(e=this.currentSheetDataImportMapping.configurations.duplicateHandlingOptions.handleDuplicateBy[0])||void 0===e?void 0:e.id)}onTabActivated(e){if(1===e.index){this.matchDuplicateByFields=(0,u.flow)(e=>(0,u.map)(e,"targetField"),u.compact,u.flatten)(this.currentSheetDataImportMapping.configurations.definitionMappings.fieldMappings);const e=(0,u.find)(this.matchDuplicateByFields,{_fieldId:p.RX_RECORD_DEFINITION.coreFieldIds.id});e&&!this.selectedMatchDuplicateByFields.length&&(this.selectedMatchDuplicateByFields=[e]),this.selectedMatchDuplicateByFields=(0,u.intersectionBy)(this.matchDuplicateByFields,this.selectedMatchDuplicateByFields,"name")}}getTypeFromExcelSheet(){return(0,u.lowerCase)(this.currentExcelSheetConfiguration.definition.name)}get timeFormatExample(){var e;return this.currentSheetDataImportMapping.configurations.timeFormatOptions&&(null===(e=this.currentSheetDataImportMapping.configurations.timeFormatOptions[0])||void 0===e?void 0:e.example)}areFieldMappingsInvalid(){return(0,u.some)(this.currentSheetDataImportMapping.configurations.definitionMappings.fieldMappings,e=>!e.sourceField.fieldName||!e.targetField)}updateWizardButtons(){this.rxWizardModalComponent.config.options.allowFinish=this.rxWizardModalComponent.activeTabIndex===this.rxWizardModalComponent.config.options.steps.length-1,this.dataImportConfigurationForm.invalid||this.areFieldMappingsInvalid()?(this.rxWizardModalComponent.api.disableNextButton(),this.rxWizardModalComponent.api.disableFinishButton()):(this.rxWizardModalComponent.api.enableNextButton(),this.rxWizardModalComponent.api.enableFinishButton())}updateDataChangesToSheetMapContext(){this.updateWizardButtons(),this.rxWizardModalComponent.api.markDirty();const e=(0,u.cloneDeep)(this.currentSheetDataImportMapping.configurations);(0,u.filter)(e.definitionMappings.fieldMappings,e=>e.targetField).forEach(e=>{e.sourceField={fieldName:(0,u.get)(e.sourceField,"fieldName[0]")},e.targetField=e.targetField[0]}),e.duplicateHandlingOptions.handleDuplicateBy=(0,u.get)(e.duplicateHandlingOptions.handleDuplicateBy,"[0].id"),this.shouldGenerateNewIdForDuplicateRecords()?e.duplicateHandlingOptions.matchDuplicateBy=[]:e.duplicateHandlingOptions.matchDuplicateBy=(0,u.map)(this.selectedMatchDuplicateByFields,e=>({_fieldId:e._fieldId,name:e.name})),e.dataHandlingOptions=this.dataOptions.filter(e=>e.isSelected).map(e=>e.id),e.timeFormatOptions=(0,u.get)(e.timeFormatOptions,"[0].name");(0,u.find)(this.context.dataImportContext.dataImportConfigurations.sheets,{name:this.excelSheetName}).configurations=e}getRefactoredClonedConfiguration(e){return(0,u.forEach)(e.configurations.definitionMappings.fieldMappings,e=>{e.targetField=[e.targetField],e.sourceField.fieldName=[e.sourceField.fieldName]}),this.dataOptions.forEach(t=>{t.isSelected=(0,u.includes)(e.configurations.dataHandlingOptions,t.id)}),e.configurations.timeFormatOptions=e.configurations.timeFormatOptions?[(0,u.find)(this.dateTimeFormatOptions,{name:e.configurations.timeFormatOptions})]:[],e.configurations.duplicateHandlingOptions.handleDuplicateBy=e.configurations.duplicateHandlingOptions.handleDuplicateBy?[(0,u.find)(this.duplicateHandlingOptions,{id:e.configurations.duplicateHandlingOptions.handleDuplicateBy})]:[(0,u.find)(this.duplicateHandlingOptions,{id:pe.mergeOptions.generateNewIds})],e.configurations.duplicateHandlingOptions.matchDuplicateBy.length&&(this.selectedMatchDuplicateByFields=e.configurations.duplicateHandlingOptions.matchDuplicateBy),e}}he.\u0275fac=function(e){return new(e||he)(n["\u0275\u0275directiveInject"](me),n["\u0275\u0275directiveInject"](fe),n["\u0275\u0275directiveInject"](p.RxRecordDefinitionCacheService),n["\u0275\u0275directiveInject"](n.ChangeDetectorRef),n["\u0275\u0275directiveInject"](f.RxModalService),n["\u0275\u0275directiveInject"](x.RxWizardModalComponent),n["\u0275\u0275directiveInject"](a.RxDefinitionNameService),n["\u0275\u0275directiveInject"](l.TranslateService),n["\u0275\u0275directiveInject"](b.RxAssociationDefinitionService),n["\u0275\u0275directiveInject"](a.RxNotificationService))},he.\u0275cmp=n["\u0275\u0275defineComponent"]({type:he,selectors:[["dl-data-import-mapping-step"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](I,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.dataImportConfigurationForm=e.first)}},inputs:{context:"context",options:"options"},decls:19,vars:27,consts:[["dataImportConfigurationForm","ngForm"],["type","pills",3,"tab-active","tab-active-changed"],[3,"adapt-tab-title"],["class","mt-2",4,"ngIf"],["name","handleDuplicatesBy","rx-id","handle-duplicates-by",1,"d-block","form-group","mt-2",3,"label","ngModel","options","optionFormatter","ngModelChange"],["class","d-block form-group","name","matchDuplicatesBy","rx-id","match-duplicates-by",3,"label","ngModel","options","multiple","enableFilter","selectAllButton","deselectAllButton","optionFormatter","required","ngModelChange",4,"ngIf"],[3,"ngModel","label","ngClass","name","ngModelChange",4,"ngFor","ngForOf"],["name","dateFormat","rx-id","date-format",1,"d-block","mb-1",3,"label","ngModel","options","optionFormatter","optionContentTemplate","ngModelChange"],["class","text-tertiary",4,"ngIf"],["optionTemplate",""],[1,"mt-2"],["adapt-button","","btn-type","primary","type","button","rx-id","auto-mapping","size","small",1,"d-icon-left-arrow_schema","form-group",3,"disabled","click"],["name","definitionType","rx-id","definition-type",3,"ngModel","label","ngModelChange"],["class","radio-inline m-0",3,"value","label","ngClass",4,"ngFor","ngForOf"],["class","d-block form-group","rx-id","record-definition-picker","name","recordDefinitionName",3,"options","ngModel","ngModelChange",4,"ngIf"],["class","d-block form-group","rx-id","association-definition-picker","name","associationDefinitionName",3,"options","ngModel","ngModelChange",4,"ngIf"],[4,"ngIf"],[1,"radio-inline","m-0",3,"value","label","ngClass"],["rx-id","record-definition-picker","name","recordDefinitionName",1,"d-block","form-group",3,"options","ngModel","ngModelChange"],["rx-id","association-definition-picker","name","associationDefinitionName",1,"d-block","form-group",3,"options","ngModel","ngModelChange"],[1,"row","border-bottom","form-group"],[1,"col-6"],[3,"label"],["adapt-button","","btn-type","tertiary","type","button","rx-id","add-mapping",1,"d-icon-left-plus_circle","float-right","py-0","px-2",3,"click"],["class","row",4,"ngIf"],["class","loader-container",4,"ngIf"],["class","row no-gutters",4,"ngFor","ngForOf"],[1,"row"],[1,"col-6","pl-0"],[1,"loader-container"],[1,"loader-section"],[1,"row","no-gutters"],[1,"col-5"],["rx-id","source-field-names",1,"d-block","form-group",3,"ngModel","options","required","enableFilter","ngModelOptions","ngModelChange"],[1,"col-1","d-icon-arrow_right","text-tertiary","mt-2","text-center"],["rx-id","target-fields",1,"d-block","form-group",3,"ngModel","options","optionFormatter","required","enableFilter","disabled","ngModelOptions","ngModelChange","onSelectionChange"],[1,"col-1","pl-3"],["adapt-button","","btn-type","tertiary","type","button","rx-id","remove-mapping-button",1,"d-icon-minus_circle","text-danger","form-group","px-0",3,"disabled","ngClass","click"],["name","matchDuplicatesBy","rx-id","match-duplicates-by",1,"d-block","form-group",3,"label","ngModel","options","multiple","enableFilter","selectAllButton","deselectAllButton","optionFormatter","required","ngModelChange"],[3,"ngModel","label","ngClass","name","ngModelChange"],[1,"text-tertiary"]],template:function(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"form",null,0),n["\u0275\u0275elementStart"](2,"adapt-tabset",1),n["\u0275\u0275listener"]("tab-active-changed",function(e){return t.onTabActivated(e)}),n["\u0275\u0275elementStart"](3,"adapt-tab-panel",2),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275template"](5,j,10,12,"div",3),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](6,"adapt-tab-panel",2),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275elementStart"](8,"adapt-rx-select",4),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.currentSheetDataImportMapping.configurations.duplicateHandlingOptions.handleDuplicateBy=e}),n["\u0275\u0275pipe"](9,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](10,_,2,11,"adapt-rx-select",5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](11,"adapt-tab-panel",2),n["\u0275\u0275pipe"](12,"translate"),n["\u0275\u0275template"](13,$,1,7,"adapt-rx-checkbox",6),n["\u0275\u0275elementStart"](14,"adapt-rx-select",7),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.currentSheetDataImportMapping.configurations.timeFormatOptions=e}),n["\u0275\u0275pipe"](15,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](16,L,3,4,"div",8),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](17,G,4,2,"ng-template",null,9,n["\u0275\u0275templateRefExtractor"])),2&e){const e=n["\u0275\u0275reference"](18);n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("tab-active",0),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("adapt-tab-title",n["\u0275\u0275pipeBind1"](4,17,"com.bmc.arsys.rx.client.dataload.import.wizard.tabs.data-mapping.title")),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.isStepActive()),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("adapt-tab-title",n["\u0275\u0275pipeBind1"](7,19,"com.bmc.arsys.rx.client.dataload.import.wizard.tabs.duplicate-handling.title")),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](9,21,"com.bmc.arsys.rx.client.dataload.import.wizard.tabs.duplicate-handling.handle-by.label")),n["\u0275\u0275property"]("ngModel",t.currentSheetDataImportMapping.configurations.duplicateHandlingOptions.handleDuplicateBy)("options",t.duplicateHandlingOptions)("optionFormatter",t.optionFormatter),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.shouldGenerateNewIdForDuplicateRecords()),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("adapt-tab-title",n["\u0275\u0275pipeBind1"](12,23,"com.bmc.arsys.rx.client.common.options.label")),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",t.dataOptions),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](15,25,"com.bmc.arsys.rx.client.dataload.import.wizard.tabs.options.date-format.label")),n["\u0275\u0275property"]("ngModel",t.currentSheetDataImportMapping.configurations.timeFormatOptions)("options",t.dateTimeFormatOptions)("optionFormatter",t.optionFormatter)("optionContentTemplate",e),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.timeFormatExample)}},directives:[s["\u0275NgNoValidate"],s.NgControlStatusGroup,s.NgForm,g.AdaptTabsComponent,g.AdaptTabsPanelComponent,o.NgIf,g.AdaptRxSelectComponent,s.NgControlStatus,s.NgModel,o.NgForOf,g.AdaptButtonComponent,g.AdaptRxRadiobuttonGroupComponent,g.AdaptRxRadiobuttonComponent,o.NgClass,x.RxDefinitionPickerComponent,g.AdaptRxControlLabelComponent,s.RequiredValidator,g.AdaptRxCheckboxComponent],pipes:[l.TranslatePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]  adapt-rx-radiobutton .radio{margin:8px 0}[_nghost-%COMP%]  .dropdown-item{white-space:normal;word-break:break-all}adapt-rx-select[_ngcontent-%COMP%], rx-definition-picker[_ngcontent-%COMP%]{max-width:400px}']});class ge{constructor(e,t,i,n,o,r,a,s,l){this.rxRecordInstanceService=e,this.rxNotificationService=t,this.dataImportService=i,this.rxModalService=n,this.translateService=o,this.formBuilder=r,this.rxWizardModalComponent=a,this.rxWizardService=s,this.componentFactoryResolver=l,this.isWorksheetProcessed=!1,this.destroyed$=new d.ReplaySubject(1),this.processCustomizedImport$=new d.Subject,this.saveDataFileConfiguration=this.processCustomizedImport$.pipe((0,v.takeUntil)(this.destroyed$),(0,v.tap)(()=>{this.busy=d.NEVER.subscribe()}),(0,v.switchMap)(()=>this.isWorksheetProcessed?(0,d.of)(null):(0,d.iif)(()=>!!this.context.createdRecordInstanceId,this.rxRecordInstanceService.get(pe.recordDefinitionName,this.context.createdRecordInstanceId),this.rxRecordInstanceService.getNew(pe.recordDefinitionName)).pipe((0,v.switchMap)(e=>(this.updateRecordInstanceFields(e),this.context.createdRecordInstanceId?this.rxRecordInstanceService.save(e):this.rxRecordInstanceService.create(e))),(0,v.tap)(e=>{this.context.createdRecordInstanceId||(this.context.createdRecordInstanceId=null==e?void 0:e.id)}))),(0,v.switchMap)(()=>this.isWorksheetProcessed?(0,d.of)(null):this.dataImportService.getDataRecordWorksheet(this.context.createdRecordInstanceId)),(0,v.withLatestFrom)((0,d.timer)(0).pipe((0,v.switchMap)(()=>{var e;return(null===(e=this.context)||void 0===e?void 0:e.clonedConfigurationInstanceId)?this.rxRecordInstanceService.get(pe.recordDefinitionName,this.context.clonedConfigurationInstanceId):(0,d.of)(null)}))),(0,v.tap)(()=>{this.busy.unsubscribe()}),(0,v.switchMap)(([e,t])=>{if(this.isWorksheetProcessed)return(0,d.of)({gotoNextStep:!0});if(null==e?void 0:e.sheets){if(this.isWorksheetProcessed=!0,this.uploadedExcelSheets=e.sheets,this.rxWizardModalComponent.api.removeStep(1),(0,u.forEach)(this.uploadedExcelSheets,e=>{const t=(0,u.camelCase)(e.sheetName);e.configurations.stepId=t,this.context.excelSheetsConfiguration[e.sheetName]=e.configurations,this.rxWizardModalComponent.api.addStep({id:t,name:e.sheetName,options:{sheetName:e.sheetName},componentFactory:this.componentFactoryResolver.resolveComponentFactory(he)}),this.context.dataImportContext.dataImportConfigurations.sheets.push(this.dataImportService.getEmptyCurrentSheetDataMapConfig(e.sheetName))}),this.context.clonedConfigurationInstanceId){const i=JSON.parse(t.fieldInstances[pe.fields.mappingConfig].value)||{dataImportConfigurations:{sheets:[]}},n=i.dataImportConfigurations.sheets.filter(t=>!e.sheets.some(e=>e.sheetName===t.name));return i.dataImportConfigurations.sheets.length!==e.sheets.length||n.length?(0,d.from)(this.rxModalService.confirm({title:this.translateService.instant("com.bmc.arsys.rx.client.common.warning.label"),modalStyle:f.RX_MODAL.modalStyles.warning,message:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.configuration-mismatch.message"),buttons:{confirmButton:this.translateService.instant("com.bmc.arsys.rx.client.common.cancel.label"),dismissButton:this.translateService.instant("com.bmc.arsys.rx.client.common.continue.label")}})).pipe((0,v.switchMap)(e=>(0,d.iif)(()=>e,this.deleteCreatedDataImportInstance(),(0,d.of)({recordDeleted:!1}))),(0,v.tap)(e=>{e.recordDeleted?(this.rxWizardModalComponent.api.markPristine(),this.rxWizardModalComponent.close()):this.goToDataConfigurationStep()})):(this.context.dataImportContext.dataImportConfigurations.sheets=i.dataImportConfigurations.sheets,this.context.isClonedConfigMatched=!0,(0,d.of)({gotoNextStep:!0}))}return(0,d.of)({gotoNextStep:!0})}return this.isWorksheetProcessed=!1,this.uploadDataFileForm.markAsDirty(),this.rxNotificationService.addErrorMessage(this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.invalid-attachment-uploaded-error.message")),this.deleteCreatedDataImportInstance()})).subscribe(e=>{e.gotoNextStep&&setTimeout(()=>this.goToDataConfigurationStep())})}ngOnInit(){this.rxWizardModalComponent.next$.pipe((0,v.filter)(e=>e===pe.uploadFileStepId),(0,v.takeUntil)(this.destroyed$)).subscribe(()=>{this.saveDataloadFileAndProceedToConfigurations()}),this.rxWizardModalComponent.api.disableNextButton(),this.uploadDataFileForm=this.formBuilder.group({importJobName:[null,[s.Validators.required,s.Validators.maxLength(254)]],importJobDescription:[null,s.Validators.maxLength(254)],dataFile:null,archivedWorksheetFileName:[null,[s.Validators.required,s.Validators.maxLength(254)]]}),this.uploadDataFileForm.valueChanges.pipe((0,v.distinctUntilChanged)(),(0,v.takeUntil)(this.destroyed$)).subscribe(()=>{this.updateWizardButtons();const e={importJobName:this.uploadDataFileForm.get("importJobName").value,importJobDescription:this.uploadDataFileForm.get("importJobDescription").value,attachmentType:this.isZipAttachmentUploaded?pe.attachmentTypes.zip.value:pe.attachmentTypes.xlsx.value,archivedWorksheetFileName:this.uploadDataFileForm.get("archivedWorksheetFileName").value};this.rxWizardModalComponent.api.updateContext({importJobInfo:e})})}updateWizardButtons(){this.uploadDataFileForm.pristine||this.uploadDataFileForm.invalid?this.rxWizardModalComponent.api.disableNextButton():this.rxWizardModalComponent.api.enableNextButton()}saveDataloadFile(){this.rxWizardModalComponent.api.disableNextButton(),this.uploadDataFileForm.markAsPristine(),this.rxWizardModalComponent.api.markPristine(),this.rxRecordInstanceService.getNew(pe.recordDefinitionName).pipe((0,v.switchMap)(e=>(this.updateRecordInstanceFields(e),this.rxRecordInstanceService.create(e)))).subscribe(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.data-record-saved.message")),this.rxWizardModalComponent.close()})}saveDataloadFileAndProceedToConfigurations(){this.isCustomizedImportStarted=!0,this.rxWizardModalComponent.api.disableNextButton(),this.uploadDataFileForm.markAsPristine(),this.processCustomizedImport$.next()}handleWorksheetNameInput(){this.isZipAttachmentUploaded?this.uploadDataFileForm.get("archivedWorksheetFileName").enable():this.uploadDataFileForm.get("archivedWorksheetFileName").disable()}onAfterFilesAdded(e){e.length&&(this.isWorksheetProcessed=!1,this.isZipAttachmentUploaded=this.isZipExtension(e[0].data.name),this.handleWorksheetNameInput())}onRemovedFileFromQueue(){this.isZipAttachmentUploaded=!1,this.handleWorksheetNameInput(),this.uploadDataFileForm.controls.archivedWorksheetFileName.setValue("")}getAllowedTypes(){return[pe.attachmentTypes.zip.extension,pe.attachmentTypes.xlsx.extension]}isZipExtension(e){return e.split(".").pop().toLowerCase()===pe.attachmentTypes.zip.extension}deleteCreatedDataImportInstance(){return this.rxRecordInstanceService.delete(pe.recordDefinitionName,this.context.createdRecordInstanceId).pipe((0,v.tap)(()=>{this.context.createdRecordInstanceId=null}),(0,v.map)(()=>({recordDeleted:!0})))}goToDataConfigurationStep(){this.rxWizardModalComponent.next(!0)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}updateRecordInstanceFields(e){e.setFieldValue(pe.fields.importJobName,this.uploadDataFileForm.get("importJobName").value),e.setFieldValue(pe.fields.importJobDescription,this.uploadDataFileForm.get("importJobDescription").value),e.setFieldValue(pe.fields.attachmentType,this.isZipAttachmentUploaded?pe.attachmentTypes.zip.value:pe.attachmentTypes.xlsx.value),e.setFieldValue(pe.fields.dataFile,this.uploadDataFileForm.get("dataFile").value[0].data),e.setFieldValue(pe.fields.archivedWorksheetFileName,this.uploadDataFileForm.get("archivedWorksheetFileName").value)}}ge.\u0275fac=function(e){return new(e||ge)(n["\u0275\u0275directiveInject"](p.RxRecordInstanceService),n["\u0275\u0275directiveInject"](a.RxNotificationService),n["\u0275\u0275directiveInject"](me),n["\u0275\u0275directiveInject"](f.RxModalService),n["\u0275\u0275directiveInject"](l.TranslateService),n["\u0275\u0275directiveInject"](s.FormBuilder),n["\u0275\u0275directiveInject"](x.RxWizardModalComponent),n["\u0275\u0275directiveInject"](x.RxWizardService),n["\u0275\u0275directiveInject"](n.ComponentFactoryResolver))},ge.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ge,selectors:[["dl-upload-data-file-step"]],inputs:{context:"context"},decls:13,vars:23,consts:[[3,"options"],[1,"d-flex","flex-column","flex-fill","h-100",3,"formGroup"],["formControlName","importJobName","rx-id","import-job-name",1,"d-block","form-group",3,"label","autofocus"],["formControlName","importJobDescription","rx-id","import-job-description",1,"d-block","form-group",3,"label"],["formControlName","dataFile","rx-id","data-file",1,"d-block","form-group",3,"label","required","showMaxSizeRestriction","allowedTypes","afterFilesAdded","removedFileFromQueue"],["class","d-block mb-1","formControlName","archivedWorksheetFileName","rx-id","archived-worksheet-file-name",3,"label","autofocus","onFocus",4,"ngIf"],["class","text-tertiary form-group",4,"ngIf"],["adapt-button","","type","button","btn-type","primary","rx-id","quick-import-button",1,"mt-auto","align-self-end",3,"disabled","click"],["formControlName","archivedWorksheetFileName","rx-id","archived-worksheet-file-name",1,"d-block","mb-1",3,"label","autofocus","onFocus"],[1,"text-tertiary","form-group"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"rx-busy-indicator",0),n["\u0275\u0275elementStart"](1,"form",1),n["\u0275\u0275element"](2,"adapt-rx-textfield",2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275element"](4,"adapt-rx-textfield",3),n["\u0275\u0275pipe"](5,"translate"),n["\u0275\u0275elementStart"](6,"adapt-rx-uploader",4),n["\u0275\u0275listener"]("afterFilesAdded",function(e){return t.onAfterFilesAdded(e)})("removedFileFromQueue",function(){return t.onRemovedFileFromQueue()}),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](8,q,2,4,"adapt-rx-textfield",5),n["\u0275\u0275template"](9,U,3,3,"div",6),n["\u0275\u0275elementStart"](10,"button",7),n["\u0275\u0275listener"]("click",function(){return t.saveDataloadFile()}),n["\u0275\u0275text"](11),n["\u0275\u0275pipe"](12,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("options",n["\u0275\u0275pureFunction1"](21,z,t.busy)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("formGroup",t.uploadDataFileForm),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](3,13,"com.bmc.arsys.rx.client.dataload.import.import-job-name.label")),n["\u0275\u0275property"]("autofocus",!0),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](5,15,"com.bmc.arsys.rx.client.dataload.import.import-job-description.label")),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](7,17,"com.bmc.arsys.rx.client.dataload.import.data-file.label")),n["\u0275\u0275property"]("required",!0)("showMaxSizeRestriction",!1)("allowedTypes",t.getAllowedTypes()),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.isZipAttachmentUploaded),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.isZipAttachmentUploaded),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",t.uploadDataFileForm.pristine||t.uploadDataFileForm.invalid||t.isCustomizedImportStarted),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](12,19,"com.bmc.arsys.rx.client.dataload.import.wizard.quick-data-import.label")," "))},directives:[f.RxBusyIndicatorComponent,s["\u0275NgNoValidate"],s.NgControlStatusGroup,s.FormGroupDirective,g.AdaptRxTextfieldComponent,s.NgControlStatus,s.FormControlName,g.AdaptRxUploaderComponent,s.RequiredValidator,o.NgIf,g.AdaptButtonComponent],pipes:[l.TranslatePipe],styles:["[_nghost-%COMP%]{position:relative;display:block;height:100%}"]});class ve{constructor(e,t,i,n,o,r,a,s,l,d,c){this.componentFactoryResolver=e,this.rxModalService=t,this.rxDefinitionNameService=i,this.rxNotificationService=n,this.rxWizardService=o,this.translateService=r,this.rxRecordInstanceService=a,this.adaptModalService=s,this.rxJsonParserService=l,this.dataImportService=d,this.rxRecordInstanceDataPageService=c,this.hostClass="d-flex mh-100 flex-column"}ngOnInit(){this.gridConfig$=(0,d.of)({guid:"dl-import-grid",actionButtons:[{label:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.grid.load-data.label"),style:"tertiary",iconCls:"arrow_right_square_input",actions:[{name:()=>{this.loadDataFromSelectedRecords()}}],disabled:()=>!(0,u.some)(this.grid.api.getSelectedRows(),this.isNewOrStoppedRecord)},{label:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.clone-configuration.label"),style:"tertiary",icon:"files_copy_o",actions:[{name:()=>{this.cloneDataImportConfiguration()}}],disabled:()=>1!==this.grid.api.getSelectedRows().length},{label:this.translateService.instant("com.bmc.arsys.rx.client.common.delete.label"),style:"tertiary",icon:"trash",actions:[{name:()=>{this.deleteSelectedDataRecords()}}]},{label:this.translateService.instant("com.bmc.arsys.rx.client.common.archive.label"),style:"tertiary",iconCls:"file_o_archive",actions:[{name:()=>{this.archiveSelectedDataRecords()}}],disabled:()=>this.areAllSelectedArchived()},{label:this.translateService.instant("com.bmc.arsys.rx.client.common.stop.label"),style:"tertiary",iconCls:"pause",actions:[{name:()=>this.stopSelectedRecordProcessing()}],disabled:()=>!(0,u.some)(this.grid.api.getSelectedRows(),this.isProcessingOrQueuedRecord)}],recordDefinitionName:pe.recordDefinitionName,enableRowSelection:c.RowSelectionMode.Multiple,columns:this.getColumns(),getData:e=>this.getData(e),styles:"flex-fill"})}getData(e){return this.rxRecordInstanceDataPageService.post({params:Object.assign({},(0,u.omit)(Object.assign(Object.assign({},e),{propertySelection:[String(pe.fields.importJobName),String(pe.fields.uploadedOn),String(pe.fields.importJobDescription),String(pe.fields.dataFile),String(pe.fields.attachmentOut),String(p.RX_RECORD_DEFINITION.coreFieldIds.status),String(pe.fields.isArchived),String(pe.fields.mappingConfig),String(p.RX_RECORD_DEFINITION.coreFieldIds.id)]}),["searchText"]))})}isNewOrStoppedRecord(e){return e[p.RX_RECORD_DEFINITION.coreFieldIds.status]===pe.dataStatuses.new||e[p.RX_RECORD_DEFINITION.coreFieldIds.status]===pe.dataStatuses.stopped}areAllSelectedArchived(){return(0,u.every)(this.grid.api.getSelectedRows(),e=>1===e[pe.fields.isArchived])}newDataImport(e=null){this.dataloadWizardContext={clonedConfigurationInstanceId:e,createdRecordInstanceId:null,isClonedConfigMatched:!1,dataImportContext:{dataImportConfigurations:{sheets:[]}},excelSheetsConfiguration:{}},this.rxWizardService.open({context:this.dataloadWizardContext,options:{title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.wizard.title"),finishButtonLabel:this.translateService.instant("com.bmc.arsys.rx.client.common.save.label"),steps:[{id:pe.uploadFileStepId,name:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.wizard.steps.upload-data-file.label"),componentFactory:this.componentFactoryResolver.resolveComponentFactory(ge),handlesNext:!0},pe.temporaryStepConfig]}}).then(e=>{e?this.savePrepareDataImportConfiguration():this.grid.api.refresh().subscribe()})}loadDataFromSelectedRecords(){(0,u.filter)(this.grid.api.getSelectedRows(),this.isNewOrStoppedRecord).length<this.grid.api.getSelectedRows().length?this.rxModalService.confirm({title:this.translateService.instant("com.bmc.arsys.rx.client.common.warning.label"),modalStyle:f.RX_MODAL.modalStyles.default,message:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.already-loaded-data-warning.message")}).then(e=>{e&&this.loadDataFromFile()}):this.loadDataFromFile()}isProcessingOrQueuedRecord(e){return e[p.RX_RECORD_DEFINITION.coreFieldIds.status]===pe.dataStatuses.processing||e[p.RX_RECORD_DEFINITION.coreFieldIds.status]===pe.dataStatuses.queued}stopSelectedRecordProcessing(){(0,u.filter)(this.grid.api.getSelectedRows(),this.isProcessingOrQueuedRecord).length!==this.grid.api.getSelectedRows().length?this.rxModalService.confirm({title:this.translateService.instant("com.bmc.arsys.rx.client.common.warning.label"),modalStyle:f.RX_MODAL.modalStyles.default,message:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.stop-data-processing-warning.message")}).then(e=>{e&&this.stopRecordProcessing()}):this.stopRecordProcessing()}stopRecordProcessing(){const e=(0,u.filter)(this.grid.api.getSelectedRows(),this.isProcessingOrQueuedRecord).map(e=>this.dataImportService.stopDataProcessing(e[p.RX_RECORD_DEFINITION.coreFieldIds.id]));(0,d.forkJoin)(e).subscribe(()=>{this.grid.api.refresh().subscribe()})}deleteSelectedDataRecords(){this.rxModalService.confirm({title:this.translateService.instant("com.bmc.arsys.rx.client.common.warning.label"),modalStyle:f.RX_MODAL.modalStyles.default,message:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.delete-import-record-confirmation.message")}).then(e=>{if(e){const e=(0,u.map)(this.grid.api.getSelectedRows(),e=>this.rxRecordInstanceService.delete(pe.recordDefinitionName,e[p.RX_RECORD_DEFINITION.coreFieldIds.id]));(0,d.forkJoin)(e).subscribe(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.delete-import-record-success.message")),this.grid.api.refresh().subscribe()})}})}archiveSelectedDataRecords(){this.rxModalService.confirm({title:this.translateService.instant("com.bmc.arsys.rx.client.common.warning.label"),modalStyle:f.RX_MODAL.modalStyles.default,message:this.translateService.instant("com.bmc.arsys.rx.client.dataload.archive-records-warning.message")}).then(e=>{if(e){const e=(0,u.filter)(this.grid.api.getSelectedRows(),{[pe.fields.isArchived]:0}).map(e=>this.rxRecordInstanceService.get(pe.recordDefinitionName,e[p.RX_RECORD_DEFINITION.coreFieldIds.id]).pipe((0,v.switchMap)(t=>(t.id=e[p.RX_RECORD_DEFINITION.coreFieldIds.id],t.displayId=e[p.RX_RECORD_DEFINITION.coreFieldIds.displayId],t.setFieldValue(pe.fields.isArchived,pe.archiveTrueValue),this.rxRecordInstanceService.save(t)))));(0,d.forkJoin)(e).subscribe(()=>{this.grid.api.refresh().subscribe()})}})}cloneDataImportConfiguration(){this.newDataImport(this.grid.api.getFirstSelectedRow()[p.RX_RECORD_DEFINITION.coreFieldIds.id])}loadDataFromFile(){const e=(0,u.filter)(this.grid.api.getSelectedRows(),this.isNewOrStoppedRecord).map(e=>this.dataImportService.runLoadProcess(e[p.RX_RECORD_DEFINITION.coreFieldIds.id]));(0,d.forkJoin)(e).subscribe(()=>{this.grid.api.refresh().subscribe()})}getRecordNames(e){return(0,u.map)((0,u.get)(this.rxJsonParserService.tryParseJson(e[pe.fields.mappingConfig]),"dataImportConfigurations.sheets"),"configurations.definitionMappings.targetDefinition.name").filter(Boolean).map(e=>this.rxDefinitionNameService.getDisplayName(e)).join(", ")}showStatusInfo(e){this.adaptModalService.open({title:this.translateService.instant("com.bmc.arsys.rx.client.common.status.label"),content:ue,data:{dataRecordId:e[p.RX_RECORD_DEFINITION.coreFieldIds.id]},size:"lg"}).catch(u.noop)}getColumns(){return[{fieldId:String(pe.fields.importJobName),title:this.translateService.instant("com.bmc.arsys.rx.client.common.name.label")},{fieldId:String(pe.fields.uploadedOn),title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.wizard.steps.uploaded-on.label")},{fieldId:String(pe.fields.importJobDescription),title:this.translateService.instant("com.bmc.arsys.rx.client.common.description.label")},{fieldId:String(pe.fields.mappingConfig),title:this.translateService.instant("com.bmc.arsys.rx.client.common.definitions.label"),cellTemplate:this.recordNamesCellTemplate,sortable:!1},{fieldId:String(pe.fields.dataFile),title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.grid.data-load-input.title"),sortable:!1,filterable:!1,clickable:!0,actions:[{name:(e,t)=>{this.rxRecordInstanceService.downloadAttachment(pe.recordDefinitionName,pe.fields.dataFile,t[p.RX_RECORD_DEFINITION.coreFieldIds.id],t[pe.fields.dataFile])}}]},{fieldId:String(pe.fields.attachmentOut),title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.import.grid.data-load-result.title"),sortable:!1,filterable:!1,clickable:!0,actions:[{name:(e,t)=>{this.rxRecordInstanceService.downloadAttachment(pe.recordDefinitionName,pe.fields.attachmentOut,t[p.RX_RECORD_DEFINITION.coreFieldIds.id],t[pe.fields.attachmentOut])}}]},{fieldId:String(p.RX_RECORD_DEFINITION.coreFieldIds.status),title:this.translateService.instant("com.bmc.arsys.rx.client.common.status.label")},{fieldId:String(pe.fields.isArchived),title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.grid.column.archived-record.title")},{fieldId:String(pe.fields.message),title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.grid.column.status-message.title"),cellTemplate:this.statusInfoCellTemplate,alignment:c.RecordGridColumnAlignment.Center,filterable:!1,sortable:!1},{fieldId:String(p.RX_RECORD_DEFINITION.coreFieldIds.id),visible:!1,title:this.translateService.instant("com.bmc.arsys.rx.client.common.id.label")}]}savePrepareDataImportConfiguration(){this.rxRecordInstanceService.get(pe.recordDefinitionName,this.dataloadWizardContext.createdRecordInstanceId).pipe((0,v.switchMap)(e=>(e.setFieldValue(pe.fields.mappingConfig,JSON.stringify(this.dataloadWizardContext.dataImportContext)),e.setFieldValue(pe.fields.importJobName,this.dataloadWizardContext.importJobInfo.importJobName),e.setFieldValue(pe.fields.importJobDescription,this.dataloadWizardContext.importJobInfo.importJobDescription),e.setFieldValue(pe.fields.attachmentType,this.dataloadWizardContext.importJobInfo.attachmentType),e.setFieldValue(pe.fields.archivedWorksheetFileName,this.dataloadWizardContext.importJobInfo.archivedWorksheetFileName),this.rxRecordInstanceService.save(e))),(0,v.switchMap)(()=>this.grid.api.refresh())).subscribe()}}ve.\u0275fac=function(e){return new(e||ve)(n["\u0275\u0275directiveInject"](n.ComponentFactoryResolver),n["\u0275\u0275directiveInject"](f.RxModalService),n["\u0275\u0275directiveInject"](a.RxDefinitionNameService),n["\u0275\u0275directiveInject"](a.RxNotificationService),n["\u0275\u0275directiveInject"](x.RxWizardService),n["\u0275\u0275directiveInject"](l.TranslateService),n["\u0275\u0275directiveInject"](p.RxRecordInstanceService),n["\u0275\u0275directiveInject"](g.AdaptModalService),n["\u0275\u0275directiveInject"](m.RxJsonParserService),n["\u0275\u0275directiveInject"](me),n["\u0275\u0275directiveInject"](p.RxRecordInstanceDataPageService))},ve.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ve,selectors:[["dl-data-import"]],viewQuery:function(e,t){if(1&e&&(n["\u0275\u0275viewQuery"](X,5),n["\u0275\u0275viewQuery"](W,7),n["\u0275\u0275viewQuery"](H,7)),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.grid=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.recordNamesCellTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.statusInfoCellTemplate=e.first)}},hostVars:2,hostBindings:function(e,t){2&e&&n["\u0275\u0275classMap"](t.hostClass)},decls:9,vars:4,consts:[["adapt-button","","type","button","btn-type","tertiary","rx-id","new-import-button",1,"d-icon-plus_circle","px-0","align-self-start",3,"click"],[3,"config"],["grid",""],["recordNamesCellTemplate",""],["statusInfoCellTemplate",""],["href","javascript:void(0)",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"button",0),n["\u0275\u0275listener"]("click",function(){return t.newDataImport()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](3,"rx-record-grid",1,2),n["\u0275\u0275template"](5,Q,1,1,"ng-template",null,3,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](7,J,3,3,"ng-template",null,4,n["\u0275\u0275templateRefExtractor"])),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.dataload.import.new-import.title"),"\n"),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("config",t.gridConfig$))},directives:[g.AdaptButtonComponent,c.RecordGridComponent],pipes:[l.TranslatePipe],styles:["[_nghost-%COMP%]{display:block;padding:1rem;height:100%}[_nghost-%COMP%]  rx-record-grid{height:100%}"]});class ye{constructor(e,t){this.componentFactoryResolver=e,this.rxViewComponentRegistryService=t,t.register({type:"dl-dataload-data-import",componentFactory:this.componentFactoryResolver.resolveComponentFactory(ve),name:"Data import",isPageComponent:!0,availableInBundles:[a.RX_APPLICATION.dataloadBundleId]})}}ye.\u0275fac=function(e){return new(e||ye)(n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](r.RxViewComponentRegistryService))},ye.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ye,declarations:[ve,ue,ge,he],imports:[g.AdaptButtonModule,o.CommonModule,s.FormsModule,l.TranslateModule,c.RecordGridModule,g.AdaptPopoverModule,y.AdaptTableModule,f.RxLineLoaderModule,g.AdaptRxTextfieldModule,g.AdaptRxUploaderModule,g.AdaptRxSelectModule,s.ReactiveFormsModule,g.AdaptTabsModule,g.AdaptRxRadiobuttonModule,x.RxDefinitionPickerModule,g.AdaptRxLabelModule,g.AdaptAlertModule,g.AdaptRxCheckboxModule,f.RxBusyIndicatorModule]}),ye.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[g.AdaptButtonModule,o.CommonModule,s.FormsModule,l.TranslateModule,c.RecordGridModule,g.AdaptPopoverModule,y.AdaptTableModule,f.RxLineLoaderModule,g.AdaptRxTextfieldModule,g.AdaptRxUploaderModule,g.AdaptRxSelectModule,s.ReactiveFormsModule,g.AdaptTabsModule,g.AdaptRxRadiobuttonModule,x.RxDefinitionPickerModule,g.AdaptRxLabelModule,g.AdaptAlertModule,g.AdaptRxCheckboxModule,f.RxBusyIndicatorModule]]});const xe="com.bmc.arsys.rx.dataload:Data Export Form",be=1,Ce="associationDefinitionDataFilter",Se={name:536870913,generatedFile:536870914,startTime:536870915,endTime:536870916,progressDetail:536870917,message:536870918,configurations:536870919,isArchive:536870920,fileName:536870921,configDescription:536870922},we={new:0,processing:1,processed:2,failed:3};class De{constructor(e,t,i,n,o){this.datePipe=e,this.rxTranslateService=t,this.rxJsonParserService=i,this.activeModalRef=n,this.rxRecordInstanceDataPageService=o,this.statusData$=this.rxRecordInstanceDataPageService.post({params:{[p.RX_RECORD_DEFINITION.coreFieldIds.id]:this.activeModalRef.getData().dataRecordId,recorddefinition:xe}}).pipe((0,v.map)(e=>{e.data[0][p.RX_RECORD_DEFINITION.coreFieldIds.status]===we.processing&&(this.processStartInfo=`${this.rxTranslateService.instant("com.bmc.arsys.rx.client.dataload.process-started.message")} ${this.datePipe.transform(e.data[0][p.RX_RECORD_DEFINITION.coreFieldIds.modifiedDate],"medium")}`);const t=(0,u.get)(this.rxJsonParserService.tryParseJson(e.data[0][Se.message],[]),"dataExportProgressStatus");return t?(0,u.map)(t,e=>Object.assign(Object.assign({},e),{updateTime:this.datePipe.transform(e.updateTime,"medium")})):(this.exportConfiguredNotProcessedMsg=e.data[0][Se.message],[])})),this.columns=[{field:"updateTime",header:this.rxTranslateService.instant("com.bmc.arsys.rx.client.dataload.status-info-grid.column.updated-date.title"),sortable:!1,width:"20%"},{field:"status",header:this.rxTranslateService.instant("com.bmc.arsys.rx.client.common.status.label"),width:"20%"},{field:"message",header:this.rxTranslateService.instant("com.bmc.arsys.rx.client.common.message.label"),width:"80%"}]}close(){this.activeModalRef.close()}}De.\u0275fac=function(e){return new(e||De)(n["\u0275\u0275directiveInject"](o.DatePipe),n["\u0275\u0275directiveInject"](l.TranslateService),n["\u0275\u0275directiveInject"](m.RxJsonParserService),n["\u0275\u0275directiveInject"](g.ActiveModalRef),n["\u0275\u0275directiveInject"](p.RxRecordInstanceDataPageService))},De.\u0275cmp=n["\u0275\u0275defineComponent"]({type:De,selectors:[["dl-export-record-status-info"]],decls:8,vars:7,consts:[["loaderTemplate",""],[4,"ngIf","ngIfElse"],[1,"modal-footer"],["adapt-button","","btn-type","secondary","rx-id","close-button","type","button",3,"click"],[1,"data-status-info"],[4,"ngIf"],[3,"config",4,"ngIf"],["rx-id","exported-status-info-grid",3,"hidden","columns","bordered","value","wrapCellText"],[3,"config"]],template:function(e,t){if(1&e&&(n["\u0275\u0275template"](0,K,1,0,"ng-template",null,0,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](2,ee,5,7,"div",1),n["\u0275\u0275pipe"](3,"async"),n["\u0275\u0275elementStart"](4,"div",2),n["\u0275\u0275elementStart"](5,"button",3),n["\u0275\u0275listener"]("click",function(){return t.close()}),n["\u0275\u0275text"](6),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275reference"](1);n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](3,3,t.statusData$))("ngIfElse",e),n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](7,5,"com.bmc.arsys.rx.client.common.close.label")," ")}},directives:[o.NgIf,g.AdaptButtonComponent,f.RxLineLoaderComponent,y.AdaptTableComponent,g.AdaptAlertComponent],pipes:[o.AsyncPipe,l.TranslatePipe],styles:[".data-status-info[_ngcontent-%COMP%]{padding:15px}"]});class Re extends a.RxExpressionConfigurator{constructor(e){super(),this.injector=e,this.translateService=this.injector.get(l.TranslateService),this.rxDefinitionNameService=this.injector.get(a.RxDefinitionNameService),this.rxRecordDefinitionCacheService=this.injector.get(p.RxRecordDefinitionCacheService),this.rxAssociationDefinitionCacheService=this.injector.get(b.RxAssociationDefinitionCacheService),this.commonDataDictionary$=(0,d.of)([{label:this.translateService.instant("com.bmc.arsys.rx.client.common.general-items.label"),children:[{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.expression-editor.data-dictionary.values.general-group.pill.current-user.title"),icon:"d-icon-dollar",expression:"$USER$"},{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.expression-editor.data-dictionary.values.general-group.pill.current-date.title"),icon:"d-icon-dollar",expression:"$DATE$"},{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.expression-editor.data-dictionary.values.general-group.pill.current-time.title"),icon:"d-icon-dollar",expression:"$TIME$"},{label:this.translateService.instant("com.bmc.arsys.rx.client.approval.expression-editor.data-dictionary.values.general-group.pill.current-date-time.title"),icon:"d-icon-dollar",expression:"$TIMESTAMP$"}]}])}geDataDefinitionField(e,t){return t?(0,d.iif)(()=>"record"===e,this.rxRecordDefinitionCacheService.getRecordDefinition(t),this.rxAssociationDefinitionCacheService.getAssociationDefinition(t).pipe((0,v.map)(e=>e.nodeAId),(0,v.switchMap)(e=>this.rxRecordDefinitionCacheService.getRecordDefinition(e)))).pipe((0,v.withLatestFrom)(this.commonDataDictionary$),(0,v.map)(([e,t])=>[...t,{label:this.rxDefinitionNameService.getDisplayName(e.name),children:e.fieldDefinitions.map(e=>({label:e.name,icon:"d-icon-field_text",expression:`'${e.id}'`}))}])):(0,d.of)([])}}class Ie{constructor(e,t){this.activeModalRef=e,this.rxRecordInstanceDataPageService=t,this.gridContext=this.activeModalRef.getData()}ngOnInit(){this.gridConfig=(0,d.of)({recordDefinitionName:this.gridContext.definitionName,enableRowSelection:c.RowSelectionMode.Multiple,columns:(0,u.sortBy)(this.gridContext.selectedFields,"visibleOnPreviewPriority").map((e,t)=>({title:e.name,fieldId:e.id.toString(),visible:t<9})),styles:"flex-fill h-100",getData:e=>this.getData(e)})}getData(e){return e.queryExpression=[e.queryExpression,this.gridContext.queryFilter].filter(Boolean).join("AND"),this.rxRecordInstanceDataPageService.post({params:(0,u.omit)(Object.assign({},e),["searchText"])})}close(){this.activeModalRef.dismiss(g.DismissReasons.CLOSE_BTN)}}Ie.\u0275fac=function(e){return new(e||Ie)(n["\u0275\u0275directiveInject"](g.ActiveModalRef),n["\u0275\u0275directiveInject"](p.RxRecordInstanceDataPageService))},Ie.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Ie,selectors:[["dl-export-data-preview"]],decls:6,vars:4,consts:[[1,"p-4","data-preview-modal-body"],[3,"config"],[1,"modal-footer"],["adapt-button","","type","button","btn-type","secondary","rx-id","close-button",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275element"](1,"rx-record-grid",1),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](2,"div",2),n["\u0275\u0275elementStart"](3,"button",3),n["\u0275\u0275listener"]("click",function(){return t.close()}),n["\u0275\u0275text"](4),n["\u0275\u0275pipe"](5,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("config",t.gridConfig),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](5,2,"com.bmc.arsys.rx.client.common.close.label")," "))},directives:[c.RecordGridComponent,g.AdaptButtonComponent],pipes:[l.TranslatePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.data-preview-modal-body[_ngcontent-%COMP%]{overflow:auto;flex-grow:1;height:645px}']});class Fe extends f.RxModalClass{constructor(e,t,i,n,o,r,a,s,l,c,p){super(c,p),this.rxFieldDefinitionService=e,this.rxRecordInstanceService=t,this.rxRecordDefinitionService=i,this.adaptModalService=n,this.rxNotificationService=o,this.rxExpressionEditorService=r,this.translateService=a,this.changeDetectorRef=s,this.definitionNameService=l,this.dockedPanelContext=c,this.injector=p,this.index$=new d.BehaviorSubject(null),this.recordDefinitionNames$=[],this.definitionFields$=[],this.destroyed$=new d.ReplaySubject(1),this.exportConfiguration={exportConfigName:null,exportConfigDescription:null,definitions:[]},this.recordPickerOptions={label:"",definitionType:x.RxDefinitionPickerType.Record,availableDefinitionPickerStates:{definitionButtonsGroups:[x.RX_DEFINITION_PICKER.definitionScopes.all],search:x.RX_DEFINITION_PICKER.definitionScopes.all},required:!0},this.associationPickerOptions={label:"",definitionType:x.RxDefinitionPickerType.Association,availableDefinitionPickerStates:{definitionButtonsGroups:[x.RX_DEFINITION_PICKER.definitionScopes.all],search:x.RX_DEFINITION_PICKER.definitionScopes.all},required:!0},this.definitionTypes={record:"record",association:"association"},this.definitionTypeOptions=[{value:this.definitionTypes.record,displayValue:this.translateService.instant("com.bmc.arsys.rx.client.definition-type.record.label")},{value:this.definitionTypes.association,displayValue:this.translateService.instant("com.bmc.arsys.rx.client.definition-type.association.label")}]}ngOnInit(){super.ngOnInit(),this.expressionConfigurator=new Re(this.injector),this.expressionConfigurator.configureForProperty({propertyPath:Ce,dataDictionary$:this.index$.pipe((0,v.switchMap)(e=>this.recordDefinitionNames$[e].pipe((0,v.switchMap)(t=>this.expressionConfigurator.geDataDefinitionField(this.exportConfiguration.definitions[e].type,t))))),operators:this.expressionConfigurator.getOperatorRowsByGroup(a.ExpressionOperatorGroup.All)}),this.dataFilterExpressionOptions={label:this.translateService.instant("com.bmc.arsys.rx.client.dataload.export.new-configuration.data-filters.label"),dataDictionary$:this.expressionConfigurator.getDataDictionary(Ce),operators:this.expressionConfigurator.getOperators(Ce)}}addDefinition(){this.markAsDirty();const e=this.exportConfiguration.definitions.length;this.recordDefinitionNames$[e]=new d.BehaviorSubject(null),this.definitionFields$[e]=this.recordDefinitionNames$[e].pipe((0,v.takeUntil)(this.destroyed$),(0,v.switchMap)(t=>(0,d.iif)(()=>t&&this.exportConfiguration.definitions[e].type===this.definitionTypes.record,this.rxRecordDefinitionService.get(t),(0,d.of)({fieldDefinitions:[]}))),(0,v.map)(e=>e.fieldDefinitions.sort((e,t)=>this.rxFieldDefinitionService.isCoreField(e)?-1:this.rxFieldDefinitionService.isCoreField(t)?1:e.fieldOption===p.RX_RECORD_DEFINITION.fieldOptions.required?-1:t.fieldOption===p.RX_RECORD_DEFINITION.fieldOptions.required?1:Number(e.id)-Number(t.id)).map((e,t)=>({name:e.name,id:e.id,disabled:e.fieldOption===p.RX_RECORD_DEFINITION.fieldOptions.required&&null===e.defaultValue,visibleOnPreviewPriority:t}))),(0,v.tap)(t=>{this.exportConfiguration.definitions[e].criteria.fields=t.filter(e=>e.disabled).map(e=>Object.assign({},e))})),this.exportConfiguration.definitions.push({type:"record",name:null,criteria:{filter:null,fields:[]}})}remove(e){this.exportConfiguration.definitions.splice(e,1)}cancel(){this.dockedPanelContext.dismiss(g.DismissReasons.CLOSE_BTN)}onDefinitionChange(e,t){e&&!this.definitionNameService.getBundleId(e)?(this.rxNotificationService.addErrorMessage(this.translateService.instant("com.bmc.arsys.rx.client.dataload.global-record-not-allowed.message")),this.changeDetectorRef.detectChanges(),this.exportConfiguration.definitions[t].name=null):(this.exportConfiguration.definitions[t].criteria.filter=null,this.index$.next(t),this.recordDefinitionNames$[t].next(e))}onExpressionEvent(e){this.index$.next(e),this.rxExpressionEditorService.openEditor({property:{path:Ce,value:this.exportConfiguration.definitions[e].criteria.filter,label:this.translateService.instant("com.bmc.arsys.rx.client.dataload.export.new-configuration.data-filters.label")},expressionConfigurator:this.expressionConfigurator,legend:[{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.keyword.label"),icon:"d-icon-dollar"},{label:this.translateService.instant("com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.add-data.expression-editor.legend.activity-result.label"),icon:"d-icon-field_text"}]}).subscribe(t=>{this.exportConfiguration.definitions[e].criteria.filter=t.value||null})}isSaveButtonDisabled(){return this.isSaveInProgress||!this.exportConfiguration.definitions.length||(0,u.some)(this.exportConfiguration.definitions,e=>e.type===this.definitionTypes.record&&(!e.name||!e.criteria.fields.length)||e.type===this.definitionTypes.association&&!e.name)}saveExportConfiguration(){this.isSaveInProgress=!0,this.rxRecordInstanceService.getNew(xe).pipe((0,v.switchMap)(e=>(e.setFieldValue(Se.name,this.exportConfiguration.exportConfigName),e.setFieldValue(Se.configDescription,this.exportConfiguration.exportConfigDescription),e.setFieldValue(Se.configurations,JSON.stringify({definitions:(0,u.map)((0,u.cloneDeep)(this.exportConfiguration.definitions),e=>(e.criteria.fields=(0,u.map)(e.criteria.fields,e=>({id:e.id,name:e.name})),e))})),this.rxRecordInstanceService.create(e))),(0,v.finalize)(()=>{this.isSaveInProgress=!1})).subscribe(()=>{this.dockedPanelContext.close(null)})}clearFieldsSelection(e){this.exportConfiguration.definitions[e].name=null,this.exportConfiguration.definitions[e].criteria.filter=null,this.exportConfiguration.definitions[e].criteria.fields=[]}openExportingDataPreview(e){this.adaptModalService.open({title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.export.new-configuration.preview-data.label"),content:Ie,size:"lg",data:{definitionName:e.name,selectedFields:e.criteria.fields,queryFilter:e.criteria.filter}}).catch(u.noop)}isPreviewDisabled(e){return!e.name||!e.criteria.fields.length}ngOnDestroy(){(0,u.forEach)(this.recordDefinitionNames$,e=>e.complete()),this.index$.complete(),this.destroyed$.next(),this.destroyed$.complete()}optionFormatter(e){return e.name}}Fe.\u0275fac=function(e){return new(e||Fe)(n["\u0275\u0275directiveInject"](p.RxFieldDefinitionService),n["\u0275\u0275directiveInject"](p.RxRecordInstanceService),n["\u0275\u0275directiveInject"](p.RxRecordDefinitionService),n["\u0275\u0275directiveInject"](g.AdaptModalService),n["\u0275\u0275directiveInject"](a.RxNotificationService),n["\u0275\u0275directiveInject"](x.RxExpressionEditorService),n["\u0275\u0275directiveInject"](l.TranslateService),n["\u0275\u0275directiveInject"](n.ChangeDetectorRef),n["\u0275\u0275directiveInject"](a.RxDefinitionNameService),n["\u0275\u0275directiveInject"](g.DockedPanelContext),n["\u0275\u0275directiveInject"](n.Injector))},Fe.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Fe,selectors:[["dl-data-export-configuration"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:19,vars:23,consts:[[1,"dp-body"],["rx-id","export-config-name","name","exportConfigName","maxlength","254",1,"form-group","d-block",3,"label","ngModel","required","autofocus","ngModelChange"],["exportConfigName","ngModel"],["rx-id","export-config-description","name","exportConfigDescription","maxlength","254",1,"form-group","d-block",3,"label","ngModel","ngModelChange"],["exportConfigDescription","ngModel"],["adapt-button","","type","button","btn-type","tertiary","rx-id","add-definition-button",1,"d-icon-plus_circle","px-0",3,"click"],[3,"multiselect"],["class","position-relative form-group",4,"ngFor","ngForOf"],[1,"dp-footer"],["type","button","adapt-button","","btn-type","primary","rx-id","save-button",1,"mr-2",3,"adaptInlineLoader","disabled","click"],["type","button","adapt-button","","btn-type","secondary","rx-id","cancel-button",3,"click"],[1,"position-relative","form-group"],[1,"actions"],["adapt-button","","size","small","type","button",1,"d-icon-left-cross_adapt","py-0","pr-3","btn","btn-sm",3,"click"],["isOpen","true",1,"w-100","d-block"],[3,"ngModel","label","required","ngModelChange"],["class","radio-inline m-0",3,"value","label","ngClass","checkedChange",4,"ngFor","ngForOf"],["class","d-block form-group","rx-id","record-definition-picker",3,"options","ngModel","ngModelChange",4,"ngIf"],["class","d-block form-group","rx-id","association-definition-picker",3,"options","ngModel","ngModelChange",4,"ngIf"],[3,"hidden"],[4,"ngIf"],["rx-id","data-filter",1,"d-block","form-group",3,"options","ngModel","ngModelChange","events"],["type","button","adapt-button","","btn-type","secondary","rx-id","preview-button",3,"disabled","click",4,"ngIf"],[1,"radio-inline","m-0",3,"value","label","ngClass","checkedChange"],["rx-id","record-definition-picker",1,"d-block","form-group",3,"options","ngModel","ngModelChange"],["rx-id","association-definition-picker",1,"d-block","form-group",3,"options","ngModel","ngModelChange"],["class","d-block form-group",3,"ngModel","label","options","required","multiple","enableFilter","selectAllButton","deselectAllButton","optionFormatter","ngModelChange",4,"ngIf"],[1,"d-block","form-group",3,"ngModel","label","options","required","multiple","enableFilter","selectAllButton","deselectAllButton","optionFormatter","ngModelChange"],["type","button","adapt-button","","btn-type","secondary","rx-id","preview-button",3,"disabled","click"]],template:function(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"adapt-rx-textfield",1,2),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.exportConfiguration.exportConfigName=e})("ngModelChange",function(){return t.markAsDirty()}),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"adapt-rx-textfield",3,4),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.exportConfiguration.exportConfigDescription=e})("ngModelChange",function(){return t.markAsDirty()}),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](7,"button",5),n["\u0275\u0275listener"]("click",function(){return t.addDefinition()}),n["\u0275\u0275text"](8),n["\u0275\u0275pipe"](9,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"adapt-accordion",6),n["\u0275\u0275template"](11,se,16,18,"div",7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](12,"div",8),n["\u0275\u0275elementStart"](13,"button",9),n["\u0275\u0275listener"]("click",function(){return t.saveExportConfiguration()}),n["\u0275\u0275text"](14),n["\u0275\u0275pipe"](15,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](16,"button",10),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](17),n["\u0275\u0275pipe"](18,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275reference"](2),i=n["\u0275\u0275reference"](5);n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](3,13,"com.bmc.arsys.rx.client.common.name.label")),n["\u0275\u0275property"]("ngModel",t.exportConfiguration.exportConfigName)("required",!0)("autofocus",!0),n["\u0275\u0275advance"](3),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](6,15,"com.bmc.arsys.rx.client.common.description.label")),n["\u0275\u0275property"]("ngModel",t.exportConfiguration.exportConfigDescription),n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](9,17,"com.bmc.arsys.rx.client.dataload.export.new-configuration.add-definition-button.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("multiselect",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",t.exportConfiguration.definitions),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("adaptInlineLoader",t.isSaveInProgress)("disabled",e.invalid||i.invalid||t.isSaveButtonDisabled()),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](15,19,"com.bmc.arsys.rx.client.common.save.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](18,21,"com.bmc.arsys.rx.client.common.cancel.label")," ")}},directives:[g.AdaptRxTextfieldComponent,s.MaxLengthValidator,s.NgControlStatus,s.NgModel,s.RequiredValidator,g.AdaptButtonComponent,g.AdaptAccordionComponent,o.NgForOf,g.AdaptInlineStandaloneDirective,g.AdaptAccordionTabComponent,g.AdaptRxRadiobuttonGroupComponent,o.NgIf,x.ExpressionFormControlComponent,g.AdaptRxRadiobuttonComponent,o.NgClass,x.RxDefinitionPickerComponent,g.AdaptRxSelectComponent],pipes:[l.TranslatePipe,o.AsyncPipe],styles:[".actions[_ngcontent-%COMP%]{position:absolute;top:4px;right:35px;z-index:1}"]});class Ee{constructor(e,t,i,n,o,r,a,s){this.dataExportService=e,this.rxModalService=t,this.translateService=i,this.rxDefinitionNameService=n,this.adaptModalService=o,this.rxJsonParserService=r,this.rxNotificationService=a,this.rxRecordInstanceService=s,this.hostClass="d-flex mh-100 flex-column"}ngOnInit(){this.gridConfig$=(0,d.of)({guid:"dl-export-grid",actionButtons:[{label:this.translateService.instant("com.bmc.arsys.rx.client.dataload.export.export-data.label"),style:"tertiary",iconCls:"arrow_right_square_input",actions:[{name:()=>this.startDataExportProcess()}]},{label:this.translateService.instant("com.bmc.arsys.rx.client.common.archive.label"),style:"tertiary",iconCls:"file_o_archive",actions:[{name:()=>{this.archiveExportRecords()}}],disabled:()=>(0,u.every)(this.grid.api.getSelectedRows(),e=>e[Se.isArchive]===be)},{label:this.translateService.instant("com.bmc.arsys.rx.client.common.delete.label"),style:"tertiary",icon:"trash",actions:[{name:()=>{this.deleteExportRecords()}}]}],recordDefinitionName:xe,enableRowSelection:c.RowSelectionMode.Multiple,columns:this.getColumns(),styles:"flex-fill"})}startDataExportProcess(){this.grid.api.getSelectedRows().filter(e=>e[p.RX_RECORD_DEFINITION.coreFieldIds.status]===we.new).length!==this.grid.api.getSelectedRows().length?this.rxModalService.confirm({title:this.translateService.instant("com.bmc.arsys.rx.client.common.warning.label"),modalStyle:f.RX_MODAL.modalStyles.warning,message:this.translateService.instant("com.bmc.arsys.rx.client.dataload.export.data-already-exported-warning.message")}).then(e=>{e&&this.startDataExport()}):this.startDataExport()}startDataExport(){const e=(0,u.map)(this.grid.api.getSelectedRows(),e=>this.dataExportService.startDataExport(e[p.RX_RECORD_DEFINITION.coreFieldIds.id]));(0,d.forkJoin)(e).subscribe(()=>{this.grid.api.refresh().subscribe()})}getRecordNames(e){return(0,u.map)((0,u.get)(this.rxJsonParserService.tryParseJson(e[Se.configurations],[]),"definitions"),"name").filter(Boolean).map(e=>this.rxDefinitionNameService.getDisplayName(e)).join(", ")}deleteExportRecords(){this.rxModalService.confirm({title:this.translateService.instant("com.bmc.arsys.rx.client.common.warning.label"),modalStyle:f.RX_MODAL.modalStyles.warning,message:this.translateService.instant("com.bmc.arsys.rx.client.dataload.export.delete-data-warning.message")}).then(e=>{if(e){const e=(0,u.map)(this.grid.api.getSelectedRows(),e=>this.rxRecordInstanceService.delete(xe,e[p.RX_RECORD_DEFINITION.coreFieldIds.id]));(0,d.forkJoin)(e).subscribe(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.dataload.export.delete-export-record-success.message")),this.grid.api.refresh().subscribe()})}})}archiveExportRecords(){this.rxModalService.confirm({title:this.translateService.instant("com.bmc.arsys.rx.client.common.warning.label"),modalStyle:f.RX_MODAL.modalStyles.default,message:this.translateService.instant("com.bmc.arsys.rx.client.dataload.archive-records-warning.message")}).then(e=>{if(e){const e=(0,u.filter)(this.grid.api.getSelectedRows(),{[Se.isArchive]:0}).map(e=>this.rxRecordInstanceService.get(xe,e[p.RX_RECORD_DEFINITION.coreFieldIds.id]).pipe((0,v.switchMap)(t=>(t.id=e[p.RX_RECORD_DEFINITION.coreFieldIds.id],t.displayId=e[p.RX_RECORD_DEFINITION.coreFieldIds.displayId],t.setFieldValue(Se.isArchive,be),this.rxRecordInstanceService.save(t)))));(0,d.forkJoin)(e).subscribe(()=>{this.grid.api.refresh().subscribe()})}})}newExport(){this.rxModalService.openDockedPanel({title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.export.new-configuration.label"),content:Fe,data:{}}).then(()=>{this.grid.api.refresh().subscribe()}).catch(u.noop)}showStatusInfo(e){this.adaptModalService.open({title:this.translateService.instant("com.bmc.arsys.rx.client.common.status.label"),content:De,data:{dataRecordId:e[p.RX_RECORD_DEFINITION.coreFieldIds.id]},size:"lg"}).catch(u.noop)}getColumns(){return[{fieldId:String(Se.name),title:this.translateService.instant("com.bmc.arsys.rx.client.common.name.label")},{fieldId:String(Se.endTime),title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.export.grid.column.exported-on.title")},{fieldId:String(Se.configDescription),title:this.translateService.instant("com.bmc.arsys.rx.client.common.description.label")},{fieldId:String(Se.configurations),title:this.translateService.instant("com.bmc.arsys.rx.client.common.definitions.label"),sortable:!1,cellTemplate:this.recordNamesCellTemplate},{fieldId:String(Se.generatedFile),title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.export.grid.column.export-output-file.title"),sortable:!1,filterable:!1,clickable:!0,actions:[{name:(e,t)=>{this.rxRecordInstanceService.downloadAttachment(xe,Se.generatedFile,t[p.RX_RECORD_DEFINITION.coreFieldIds.id],t[Se.generatedFile])}}]},{fieldId:String(p.RX_RECORD_DEFINITION.coreFieldIds.status),title:this.translateService.instant("com.bmc.arsys.rx.client.common.status.label")},{fieldId:String(Se.isArchive),title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.grid.column.archived-record.title")},{fieldId:String(Se.message),title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.grid.column.status-message.title"),sortable:!1,filterable:!1,cellTemplate:this.statusInfoCellTemplate},{fieldId:String(p.RX_RECORD_DEFINITION.coreFieldIds.id),title:this.translateService.instant("com.bmc.arsys.rx.client.common.id.label"),visible:!1}]}}Ee.\u0275fac=function(e){return new(e||Ee)(n["\u0275\u0275directiveInject"](fe),n["\u0275\u0275directiveInject"](f.RxModalService),n["\u0275\u0275directiveInject"](l.TranslateService),n["\u0275\u0275directiveInject"](a.RxDefinitionNameService),n["\u0275\u0275directiveInject"](g.AdaptModalService),n["\u0275\u0275directiveInject"](m.RxJsonParserService),n["\u0275\u0275directiveInject"](a.RxNotificationService),n["\u0275\u0275directiveInject"](p.RxRecordInstanceService))},Ee.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Ee,selectors:[["dl-data-export"]],viewQuery:function(e,t){if(1&e&&(n["\u0275\u0275viewQuery"](X,5),n["\u0275\u0275viewQuery"](W,7),n["\u0275\u0275viewQuery"](H,7)),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.grid=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.recordNamesCellTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.statusInfoCellTemplate=e.first)}},hostVars:2,hostBindings:function(e,t){2&e&&n["\u0275\u0275classMap"](t.hostClass)},decls:9,vars:4,consts:[["adapt-button","","type","button","btn-type","tertiary","rx-id","new-export-button",1,"d-icon-plus_circle","px-0","align-self-start",3,"click"],[3,"config"],["grid",""],["recordNamesCellTemplate",""],["statusInfoCellTemplate",""],["href","javascript:void(0)",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"button",0),n["\u0275\u0275listener"]("click",function(){return t.newExport()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](3,"rx-record-grid",1,2),n["\u0275\u0275template"](5,le,1,1,"ng-template",null,3,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](7,de,3,3,"ng-template",null,4,n["\u0275\u0275templateRefExtractor"])),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.dataload.export.new.label"),"\n"),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("config",t.gridConfig$))},directives:[g.AdaptButtonComponent,c.RecordGridComponent],pipes:[l.TranslatePipe],styles:[ce]});class Me{constructor(e,t){this.componentFactoryResolver=e,this.rxViewComponentRegistryService=t,t.register({type:"dl-dataload-data-export",componentFactory:this.componentFactoryResolver.resolveComponentFactory(Ee),name:"Data export",isPageComponent:!0,availableInBundles:[a.RX_APPLICATION.dataloadBundleId]})}}Me.\u0275fac=function(e){return new(e||Me)(n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](r.RxViewComponentRegistryService))},Me.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Me,declarations:[Ee,De,Fe,Ie],imports:[g.AdaptButtonModule,o.CommonModule,s.FormsModule,l.TranslateModule,c.RecordGridModule,f.RxLineLoaderModule,g.AdaptAlertModule,y.AdaptTableModule,s.ReactiveFormsModule,g.AdaptRxTextfieldModule,g.AdaptAccordionModule,x.RxDefinitionPickerModule,g.AdaptRxRadiobuttonModule,g.AdaptRxSelectModule,x.ExpressionFormControlModule,g.AdaptBusyModule]}),Me.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[g.AdaptButtonModule,o.CommonModule,s.FormsModule,l.TranslateModule,c.RecordGridModule,f.RxLineLoaderModule,g.AdaptAlertModule,y.AdaptTableModule,s.ReactiveFormsModule,g.AdaptRxTextfieldModule,g.AdaptAccordionModule,x.RxDefinitionPickerModule,g.AdaptRxRadiobuttonModule,g.AdaptRxSelectModule,x.ExpressionFormControlModule,g.AdaptBusyModule]]});const Ae="com.bmc.arsys.rx.dataload:Data Load Template",Oe={templateName:8,dataLoadTemplateVersion:304412331,dataloadTemplateDescription:304412341,template:304412351,isActive:304412361,bundleFriendlyName:304412371,bundleId:61001},Pe={xlsx:"xlsx",zip:"zip"};class Te extends f.RxModalClass{constructor(e,t,i,n,o,r,s){super(r,o),this.translateService=e,this.rxNotificationService=t,this.rxGlobalCacheService=i,this.rxRecordInstanceService=n,this.injector=o,this.dockedPanelContext=r,this.formBuilder=s,this.destroyed$=new d.ReplaySubject(1),this.isEditMode=this.dockedPanelContext.getData().isEditMode,this.enableCustomDownload=!0,this.applicationOptions$=this.rxGlobalCacheService.getBundleDescriptors().pipe((0,v.takeUntil)(this.destroyed$),(0,v.map)(e=>e.filter(e=>![a.RX_APPLICATION.innovationStudioBundleId,a.RX_APPLICATION.standardlib].includes(e.id)).sort((e,t)=>e.friendlyName.localeCompare(t.friendlyName)).map(e=>({displayValue:e.friendlyName,value:e.id})))),this.downloadAttachment=()=>{this.rxRecordInstanceService.downloadAttachment(Ae,Oe.template,this.dockedPanelContext.getData().templateRecordInstanceId,this.recordInstance.fieldInstances[Oe.template].value)}}isDirty(){return this.dataTemplateForm.dirty}ngOnInit(){super.ngOnInit(),this.dataTemplateForm=this.formBuilder.group({application:[[],s.Validators.required],templateName:[null,[s.Validators.required,s.Validators.maxLength(254)]],version:[null,[s.Validators.required,s.Validators.maxLength(254)]],isActive:null,description:[null,s.Validators.maxLength(500)],template:[null,s.Validators.required]}),this.dataTemplateForm.get("isActive").setValue(0),this.busy=(0,d.iif)(()=>this.isEditMode,this.rxRecordInstanceService.get(Ae,this.dockedPanelContext.getData().templateRecordInstanceId),this.rxRecordInstanceService.getNew(Ae)).pipe((0,v.tap)(e=>{this.recordInstance=e,this.isEditMode&&this.setTemplateFormValues()}),(0,v.switchMap)(()=>(0,d.iif)(()=>this.isEditMode,this.applicationOptions$.pipe((0,v.take)(1)),(0,d.of)([]))),(0,v.map)(e=>(0,u.find)(e,{displayValue:this.recordInstance.fieldInstances[Oe.bundleFriendlyName].value})),(0,v.tap)(e=>{this.isEditMode&&this.dataTemplateForm.get("application").setValue([e])})).subscribe()}setTemplateFormValues(){this.dataTemplateForm.get("templateName").setValue(this.recordInstance.fieldInstances[Oe.templateName].value),this.dataTemplateForm.get("version").setValue(this.recordInstance.fieldInstances[Oe.dataLoadTemplateVersion].value),this.dataTemplateForm.get("isActive").setValue(this.recordInstance.fieldInstances[Oe.isActive].value),this.dataTemplateForm.get("description").setValue(this.recordInstance.fieldInstances[Oe.dataloadTemplateDescription].value),this.dataTemplateForm.get("template").setValue([{data:new File([],this.recordInstance.fieldInstances[Oe.template].value),inUploading:!1,inDeleting:!1,uploaded:100,error:!1,errorText:"",allowDeletion:!0}])}optionFormatter(e){return e.displayValue}saveTemplate(){this.recordInstance.setFieldValue(Oe.bundleFriendlyName,this.dataTemplateForm.get("application").value[0].displayValue),this.recordInstance.setFieldValue(Oe.bundleId,this.dataTemplateForm.get("application").value[0].value),this.recordInstance.setFieldValue(Oe.templateName,this.dataTemplateForm.get("templateName").value),this.recordInstance.setFieldValue(Oe.dataLoadTemplateVersion,this.dataTemplateForm.get("version").value),this.recordInstance.setFieldValue(Oe.isActive,this.dataTemplateForm.get("isActive").value),this.recordInstance.setFieldValue(Oe.dataloadTemplateDescription,this.dataTemplateForm.get("description").value),this.recordInstance.setFieldValue(Oe.template,this.dataTemplateForm.get("template").value[0].data),this.isEditMode?this.rxRecordInstanceService.save(this.recordInstance).subscribe(()=>this.successCallback()):this.rxRecordInstanceService.create(this.recordInstance).subscribe(()=>this.successCallback())}onRemovedFileFromQueue(){this.enableCustomDownload=!1}cancel(){this.dockedPanelContext.dismiss(g.DismissReasons.CLOSE_BTN)}successCallback(){this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.dataload.templates.template-saved.message")),this.dockedPanelContext.close(null)}getAllowedTypes(){return[Pe.xlsx,Pe.zip]}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}Te.\u0275fac=function(e){return new(e||Te)(n["\u0275\u0275directiveInject"](l.TranslateService),n["\u0275\u0275directiveInject"](a.RxNotificationService),n["\u0275\u0275directiveInject"](a.RxGlobalCacheService),n["\u0275\u0275directiveInject"](p.RxRecordInstanceService),n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](g.DockedPanelContext),n["\u0275\u0275directiveInject"](s.FormBuilder))},Te.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Te,selectors:[["dl-data-template-editor"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:47,consts:[[3,"options"],[1,"dp-body"],[3,"formGroup"],["rx-id","application","formControlName","application",1,"form-group","d-block",3,"label","options","optionFormatter","autofocus"],["rx-id","template-name","formControlName","templateName",1,"form-group","d-block",3,"label"],["rx-id","version","formControlName","version",1,"form-group","d-block",3,"label"],["formControlName","isActive",3,"label"],[3,"value","label"],["rx-id","description","formControlName","description","rows","4",1,"form-group","d-block",3,"label"],["formControlName","template",3,"label","showMaxSizeRestriction","enableCustomDownload","customDownload","reusable","allowedTypes","removedFileFromQueue"],[1,"dp-footer"],["type","button","adapt-button","","btn-type","primary","rx-id","save-button",1,"mr-2",3,"disabled","click"],["type","button","adapt-button","","btn-type","secondary","rx-id","cancel-button",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"rx-busy-indicator",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275elementStart"](2,"form",2),n["\u0275\u0275element"](3,"adapt-rx-select",3),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275pipe"](5,"async"),n["\u0275\u0275element"](6,"adapt-rx-textfield",4),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275element"](8,"adapt-rx-textfield",5),n["\u0275\u0275pipe"](9,"translate"),n["\u0275\u0275elementStart"](10,"adapt-rx-radiobutton-group",6),n["\u0275\u0275pipe"](11,"translate"),n["\u0275\u0275element"](12,"adapt-rx-radiobutton",7),n["\u0275\u0275pipe"](13,"translate"),n["\u0275\u0275element"](14,"adapt-rx-radiobutton",7),n["\u0275\u0275pipe"](15,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](16,"adapt-rx-textarea",8),n["\u0275\u0275pipe"](17,"translate"),n["\u0275\u0275elementStart"](18,"adapt-rx-uploader",9),n["\u0275\u0275listener"]("removedFileFromQueue",function(){return t.onRemovedFileFromQueue()}),n["\u0275\u0275pipe"](19,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](20,"div",10),n["\u0275\u0275elementStart"](21,"button",11),n["\u0275\u0275listener"]("click",function(){return t.saveTemplate()}),n["\u0275\u0275text"](22),n["\u0275\u0275pipe"](23,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](24,"button",12),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](25),n["\u0275\u0275pipe"](26,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("options",n["\u0275\u0275pureFunction1"](45,z,t.busy)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("formGroup",t.dataTemplateForm),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](4,23,"com.bmc.arsys.rx.client.common.application.label")),n["\u0275\u0275property"]("options",n["\u0275\u0275pipeBind1"](5,25,t.applicationOptions$))("optionFormatter",t.optionFormatter)("autofocus",!0),n["\u0275\u0275advance"](3),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](7,27,"com.bmc.arsys.rx.client.dataload.templates.template-name.label")),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](9,29,"com.bmc.arsys.rx.client.common.version.label")),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](11,31,"com.bmc.arsys.rx.client.dataload.templates.is-active-template.label")),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](13,33,"com.bmc.arsys.rx.client.common.yes.label")),n["\u0275\u0275property"]("value",1),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](15,35,"com.bmc.arsys.rx.client.common.no.label")),n["\u0275\u0275property"]("value",0),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](17,37,"com.bmc.arsys.rx.client.common.description.label")),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](19,39,"com.bmc.arsys.rx.client.common.template.label")),n["\u0275\u0275property"]("showMaxSizeRestriction",!1)("enableCustomDownload",t.enableCustomDownload)("customDownload",t.downloadAttachment)("reusable",!0)("allowedTypes",t.getAllowedTypes()),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("disabled",t.dataTemplateForm.pristine||t.dataTemplateForm.invalid),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](23,41,"com.bmc.arsys.rx.client.common.save.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](26,43,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[f.RxBusyIndicatorComponent,s["\u0275NgNoValidate"],s.NgControlStatusGroup,s.FormGroupDirective,g.AdaptRxSelectComponent,s.NgControlStatus,s.FormControlName,g.AdaptRxTextfieldComponent,g.AdaptRxRadiobuttonGroupComponent,g.AdaptRxRadiobuttonComponent,g.AdaptRxTextareaComponent,g.AdaptRxUploaderComponent,g.AdaptButtonComponent],pipes:[l.TranslatePipe,o.AsyncPipe],styles:["[_nghost-%COMP%]     adapt-rx-uploader .adapt-uploader-file-uploaded{display:none}"]});class Ve{constructor(e,t,i,n){this.rxNotificationService=e,this.rxModalService=t,this.translateService=i,this.rxRecordInstanceService=n,this.hostClass="d-flex mh-100 flex-column",this.showDeprecated=!1}ngOnInit(){this.gridConfig$=(0,d.of)({guid:"dl-templates-grid",actionButtons:[{label:this.translateService.instant("com.bmc.arsys.rx.client.common.delete.label"),style:"tertiary",icon:"trash",actions:[{name:()=>{this.deleteSelectedDataTemplate()}}]}],recordDefinitionName:Ae,enableRowSelection:c.RowSelectionMode.Multiple,columns:this.getColumns(),getRecordDefinition:()=>(0,d.of)(this.getRecordDefinition()),styles:"flex-fill"})}deleteSelectedDataTemplate(){this.rxModalService.confirm({title:this.translateService.instant("com.bmc.arsys.rx.client.common.warning.label"),modalStyle:f.RX_MODAL.modalStyles.default,message:this.translateService.instant("com.bmc.arsys.rx.client.dataload.templates.template-delete-warning.message")}).then(e=>{if(e){const e=(0,u.map)(this.grid.api.getSelectedRows(),e=>this.rxRecordInstanceService.delete(Ae,e[p.RX_RECORD_DEFINITION.coreFieldIds.id]));(0,d.forkJoin)(e).subscribe(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.dataload.templates.template-delete-success.message")),this.grid.api.refresh().subscribe()})}})}getColumns(){return[{fieldId:String(Oe.templateName),title:this.translateService.instant("com.bmc.arsys.rx.client.common.name.label"),clickable:!0,actions:[{name:(e,t)=>{this.editDataTemplate(t)}}]},{fieldId:String(Oe.bundleFriendlyName),title:this.translateService.instant("com.bmc.arsys.rx.client.common.application.label")},{fieldId:String(Oe.dataloadTemplateDescription),title:this.translateService.instant("com.bmc.arsys.rx.client.common.description.label")},{fieldId:String(Oe.dataLoadTemplateVersion),title:this.translateService.instant("com.bmc.arsys.rx.client.common.version.label")},{fieldId:String(Oe.template),title:this.translateService.instant("com.bmc.arsys.rx.client.common.download.label"),sortable:!1,filterable:!1,clickable:!0,actions:[{name:(e,t)=>{this.rxRecordInstanceService.downloadAttachment(Ae,Oe.template,t[p.RX_RECORD_DEFINITION.coreFieldIds.id],t[Oe.template])}}]},{fieldId:String(Oe.isActive),title:this.translateService.instant("com.bmc.arsys.rx.client.dataload.templates.is-active-template.label"),visible:!1},{fieldId:String(p.RX_RECORD_DEFINITION.coreFieldIds.id),title:this.translateService.instant("com.bmc.arsys.rx.client.common.id.label"),visible:!1}]}editDataTemplate(e){this.openDockedPanel(!0,e[p.RX_RECORD_DEFINITION.coreFieldIds.id])}createDataTemplate(){this.openDockedPanel(!1)}openDockedPanel(e,t){return this.rxModalService.openDockedPanel({title:this.translateService.instant("com.bmc.arsys.rx.client.common.template.label"),content:Te,data:{isEditMode:e,templateRecordInstanceId:t}}).then(()=>{this.grid.api.refresh().subscribe()}).catch(u.noop)}getRecordDefinition(){return{fieldDefinitions:[{id:Oe.templateName,resourceType:p.RX_RECORD_DEFINITION.resourceTypes.character},{id:Oe.bundleFriendlyName,resourceType:p.RX_RECORD_DEFINITION.resourceTypes.character},{id:Oe.isActive,resourceType:p.RX_RECORD_DEFINITION.resourceTypes.selection,optionNamesById:{1:this.translateService.instant("com.bmc.arsys.rx.client.common.yes.label"),0:this.translateService.instant("com.bmc.arsys.rx.client.common.no.label")}},{id:Oe.dataloadTemplateDescription,resourceType:p.RX_RECORD_DEFINITION.resourceTypes.character},{id:Oe.dataLoadTemplateVersion,resourceType:p.RX_RECORD_DEFINITION.resourceTypes.character},{id:Oe.template,resourceType:p.RX_RECORD_DEFINITION.resourceTypes.character},{id:p.RX_RECORD_DEFINITION.coreFieldIds.id,resourceType:p.RX_RECORD_DEFINITION.resourceTypes.character}]}}}Ve.\u0275fac=function(e){return new(e||Ve)(n["\u0275\u0275directiveInject"](a.RxNotificationService),n["\u0275\u0275directiveInject"](f.RxModalService),n["\u0275\u0275directiveInject"](l.TranslateService),n["\u0275\u0275directiveInject"](p.RxRecordInstanceService))},Ve.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Ve,selectors:[["dl-data-templates"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](X,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.grid=e.first)}},hostVars:2,hostBindings:function(e,t){2&e&&n["\u0275\u0275classMap"](t.hostClass)},decls:5,vars:4,consts:[["adapt-button","","type","button","btn-type","tertiary","rx-id","new-template-button",1,"d-icon-plus_circle","px-0","align-self-start",3,"click"],[3,"config"],["grid",""]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"button",0),n["\u0275\u0275listener"]("click",function(){return t.createDataTemplate()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](3,"rx-record-grid",1,2)),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.dataload.templates.new-template.label"),"\n"),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("config",t.gridConfig$))},directives:[g.AdaptButtonComponent,c.RecordGridComponent],pipes:[l.TranslatePipe],styles:[ce]});class Ne{constructor(e,t){this.componentFactoryResolver=e,this.rxViewComponentRegistryService=t,t.register({type:"dl-dataload-data-templates",componentFactory:this.componentFactoryResolver.resolveComponentFactory(Ve),name:"Data templates",isPageComponent:!0,availableInBundles:[a.RX_APPLICATION.dataloadBundleId]})}}Ne.\u0275fac=function(e){return new(e||Ne)(n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](r.RxViewComponentRegistryService))},Ne.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ne,declarations:[Ve,Te],imports:[g.AdaptButtonModule,o.CommonModule,s.FormsModule,l.TranslateModule,c.RecordGridModule,g.AdaptRxSelectModule,s.ReactiveFormsModule,g.AdaptRxTextfieldModule,g.AdaptRxRadiobuttonModule,g.AdaptRxUploaderModule,g.AdaptRxTextareaModule,f.RxBusyIndicatorModule]}),Ne.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[g.AdaptButtonModule,o.CommonModule,s.FormsModule,l.TranslateModule,c.RecordGridModule,g.AdaptRxSelectModule,s.ReactiveFormsModule,g.AdaptRxTextfieldModule,g.AdaptRxRadiobuttonModule,g.AdaptRxUploaderModule,g.AdaptRxTextareaModule,f.RxBusyIndicatorModule]]});class ke{}ke.\u0275fac=function(e){return new(e||ke)},ke.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ke,imports:[ye,Me,Ne]}),ke.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[],imports:[[ye,Me,Ne]]})},"./node_modules/@helix/platform/fesm2015/helix-platform-view-actions.js":(e,t,i)=>{"use strict";i.r(t),i.d(t,{ApplyGridFilterViewActionModule:()=>P,AssociateViewActionModule:()=>U,AvcAssociateActionModule:()=>X,CloseViewActionModule:()=>H,DeleteRecordsViewActionModule:()=>J,DisassociateViewActionModule:()=>Z,EditRecordsViewActionModule:()=>oe,LaunchProcessDesignerActionModule:()=>Ee,LaunchProcessViewActionModule:()=>le,LaunchUrlViewActionModule:()=>me,OpenViewActionModule:()=>G,ProcessDesignerElementPickerModule:()=>Re,RX_OPEN_VIEW:()=>T,RefreshViewActionModule:()=>fe,RxApplyGridFilterActionName:()=>E,RxApplyGridFilterViewActionService:()=>M,RxAssociateViewActionService:()=>N,RxAvcAssociateActionService:()=>z,RxCloseViewActionService:()=>W,RxDeleteRecordsViewActionService:()=>Q,RxDisassociateViewActionService:()=>K,RxEditRecordsViewActionService:()=>ne,RxLaunchProcessDesignerActionService:()=>we,RxLaunchProcessViewActionService:()=>se,RxLaunchUrlViewActionService:()=>de,RxOpenViewActionService:()=>V,RxOpenViewModelHelperService:()=>$,RxProcessDesignerElementPickerComponent:()=>De,RxRefreshViewActionService:()=>ue,RxSaveViewActionService:()=>he,RxSetPropertyViewActionService:()=>ve,RxUnknownViewActionDesignManager:()=>Ae,RxUnknownViewActionService:()=>Me,SaveViewActionModule:()=>ge,SetPropertyViewActionModule:()=>Ce,UnknownViewActionModule:()=>Pe,ViewActionsDesignModule:()=>ke,ViewActionsModule:()=>Te});var n=i("./node_modules/@angular/core/fesm2015/core.js"),o=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-api.js"),r=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-api.js"),a=i("./node_modules/@helix/platform/fesm2015/helix-platform-utils.js"),s=i("rxjs"),l=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-designer.js"),d=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-components.js"),c=i("./node_modules/rxjs/_esm2015/operators/index.js"),p=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-components.js"),m=i("./node_modules/@helix/platform/fesm2015/helix-platform-record-api.js"),u=i("lodash"),f=i("./node_modules/@helix/platform/fesm2015/helix-platform-association-api.js"),h=i("./node_modules/@angular/router/fesm2015/router.js"),g=i("./node_modules/@bmc-ux/adapt-angular/fesm2015/bmc-ux-adapt-angular.js"),v=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-runtime.js"),y=i("./node_modules/@angular/common/fesm2015/common.js"),x=i("./node_modules/@ngx-translate/core/fesm2015/ngx-translate-core.js"),b=i("./node_modules/@helix/platform/fesm2015/helix-platform-ui-kit.js"),C=i("./node_modules/@angular/forms/fesm2015/forms.js"),S=i("./node_modules/@helix/platform/fesm2015/helix-platform-process-api.js"),w=i("./node_modules/@angular/platform-browser/fesm2015/platform-browser.js");function D(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",8),n["\u0275\u0275element"](1,"adapt-rx-textarea",9),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.common.messages.label")),n["\u0275\u0275property"]("ngModel",e.data.details)}}function R(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",2),n["\u0275\u0275element"](1,"div",3),n["\u0275\u0275elementEnd"]())}const I=["dropdownButton"];function F(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"span",8),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().clearDefinition(t)}),n["\u0275\u0275elementEnd"]()}}const E="rxApplyGridFilterAction";class M{execute(e){return e.targetApi?e.targetApi.applyFilters?(e.targetApi.applyFilters(e.filters,e.mode),s.EMPTY):((0,s.throwError)(new a.RxError(`${E}: target component does not support applyFilters API.`)),s.EMPTY):(0,s.throwError)(new a.RxError("rxApplyGridFilterAction: component is not specified."))}}M.\u0275fac=function(e){return new(e||M)},M.\u0275prov=n["\u0275\u0275defineInjectable"]({token:M,factory:M.\u0275fac,providedIn:"root"});class A extends l.RxViewDesignerActionModel{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.viewDesignerFacade=this.injector.get(l.ViewDesignerFacade),this.rxRecordDefinitionCacheService=this.injector.get(m.RxRecordDefinitionCacheService),this.rxRecordGridDesignUtilsService=this.injector.get(p.RxRecordGridDesignUtilsService),this.rxRecordGridFilterSelectHelperService=this.injector.get(p.RxRecordGridFilterSelectHelperService),this.sandbox.children$.pipe((0,c.first)(),(0,c.withLatestFrom)(this.sandbox.actionProperties$.pipe((0,c.pluck)("filters"))),(0,c.takeUntil)(this.sandbox.destroyed$)).subscribe(([e,t])=>{const i=this.rxRecordGridDesignUtilsService.getBasicRecordGridFiltersFromChildData(e);this.sandbox.updateActionProperties({filterValue:{basicFilters:i,filtersJson:t}})});this.sandbox.actionProperties$.pipe((0,c.pluck)("filterValue"),(0,c.distinctUntilChanged)()).pipe((0,c.skip)(1),(0,c.takeUntil)(this.sandbox.destroyed$)).subscribe(({filtersJson:e,basicFilters:t})=>{const i=this.rxRecordGridDesignUtilsService.getGridFilterComponentPayloads(t);this.sandbox.setChildren(i),this.sandbox.updateActionProperties({filters:e})});const i=this.sandbox.actionProperties$.pipe((0,c.pluck)("mode"),(0,c.distinctUntilChanged)()),n=this.sandbox.actionProperties$.pipe((0,c.pluck)("targetApi"),(0,c.distinctUntilChanged)()).pipe((0,c.map)(A.extractGuidFromExpression));(0,s.merge)(n.pipe((0,c.skip)(1)),i.pipe((0,c.filter)(e=>e===o.ApplyGridFilterMode.Clear))).pipe((0,c.takeUntil)(this.sandbox.destroyed$)).subscribe(()=>{this.sandbox.updateActionProperties({filterValue:{basicFilters:null,filtersJson:null}})});const r=n.pipe((0,c.switchMap)(e=>e?this.viewDesignerFacade.getComponent(e):(0,s.of)(null)),(0,c.map)(e=>(null==e?void 0:e.type)===p.RX_RECORD_GRID.type?e.data:null)),a=r.pipe((0,c.map)(e=>{var t;return null!==(t=null==e?void 0:e.recordDefinitionName)&&void 0!==t?t:null}),(0,c.switchMap)(e=>e?this.rxRecordDefinitionCacheService.getRecordDefinition(e):(0,s.of)(null))),d=r.pipe((0,c.map)(e=>{var t;return null!==(t=null==e?void 0:e.columns)&&void 0!==t?t:[]})),u=a.pipe((0,c.withLatestFrom)(d),(0,c.map)(([e,t])=>{const i=t.filter(e=>e.filterable).map(e=>e.fieldId);return e?Object.assign(Object.assign({},e),{fieldDefinitions:e.fieldDefinitions.filter(e=>i.includes(String(e.id)))}):null})),f=d.pipe((0,c.map)(e=>this.rxRecordGridFilterSelectHelperService.getNamedFilterOptionsFromColumns(e)));(0,s.combineLatest)([u,i]).pipe((0,c.withLatestFrom)(f,d),(0,c.takeUntil)(this.sandbox.destroyed$)).subscribe(([[e,t],i,n])=>{this.sandbox.setActionPropertyEditorConfig(this.getActionEditorConfig(e,i,t,n))})}static getInitialProperties(e){return Object.assign({targetApi:null,mode:o.ApplyGridFilterMode.Append,filterValue:{filtersJson:null,basicFilters:null}},e)}getPropertiesByName(){return(0,u.omit)(super.getPropertiesByName(),"filterValue")}getActionEditorConfig(e,t,i,n){const a=new r.Tooltip("<b>Begin</b><p>Begin a batch of filter updates.</p><br><b>Append</b><p>Applied filters are added with the AND operator; existing filters for the specified fields are removed.</p><br><b>Remove</b><p>Existing filters are removed if they match the applied filters.</p><br><b>Overwrite</b><p>All existing filters are replaced with the applied filters.</p><br><b>Merge</b><p>Existing filters with a range of values are replaced with the matching applied filters; existing filters for the other fields are combined with the matching applied filters using the OR operator; applied filters for new fields are added with the AND operator.</p><br><b>Clear</b><p>All existing filters are removed.</p><br><b>End</b><p>Apply all pending filter updates executed in a batch.</p>");a.maxWidth=310;const s=[{name:"targetApi",component:d.ExpressionFormControlComponent,options:{label:"Record grid",dataDictionary$:this.expressionConfigurator.getDataDictionary(),operators:this.expressionConfigurator.getOperators(),isRequired:!0}},{name:"mode",component:d.RadioFormControlComponent,options:{label:"Mode",tooltip:a,items:[{label:"Begin",value:o.ApplyGridFilterMode.Begin},{label:"Append",value:o.ApplyGridFilterMode.Append},{label:"Remove",value:o.ApplyGridFilterMode.Remove},{label:"Overwrite",value:o.ApplyGridFilterMode.Overwrite},{label:"Merge",value:o.ApplyGridFilterMode.Merge},{label:"Clear",value:o.ApplyGridFilterMode.Clear},{label:"End",value:o.ApplyGridFilterMode.End}]}}],l={name:"filterValue",component:p.RecordGridFilterSelectControlComponent,options:{primaryRecordDefinition:e,selectedFieldIds:n.map(e=>e.fieldId),namedFilterOptions:t,anchorDisabled:!e}},c={name:"emptyFilterMessage",component:d.ValidationFormControlComponent,options:{text:"Record grid expression required to define a filter.",messageType:d.MessageType.Error,customStyle:{"margin-top":"-1rem"}}};return(0,u.includes)([o.ApplyGridFilterMode.Begin,o.ApplyGridFilterMode.End,o.ApplyGridFilterMode.Clear],i)||(s.push(l),e||s.push(c)),s}static extractGuidFromExpression(e){var t;const i=null==e?void 0:e.match(/^\${view\.components\.([0-9a-z-]+)\.api}$/);return null!==(t=i&&i[1])&&void 0!==t?t:null}}class O{constructor(e,t){this.rxJsonParserService=e,this.rxRecordGridFilterHelperService=t}adaptDefinition({componentDefinitions:e,propertiesByName:t}){const i=e.map(e=>{let t=e.propertiesByName.value;const i=this.rxJsonParserService.tryParseJson(t);return i&&i[o.RecordGridNamedFilterOptionKey]&&(t=i),{guid:e.guid,fieldId:e.propertiesByName.fieldId,value:t}});t.filters=this.rxRecordGridFilterHelperService.getRecordGridFilterDataFromPredefinedFilter(t.filters,i)}}O.\u0275fac=function(e){return new(e||O)(n["\u0275\u0275inject"](a.RxJsonParserService),n["\u0275\u0275inject"](p.RxRecordGridFilterHelperService))},O.\u0275prov=n["\u0275\u0275defineInjectable"]({token:O,factory:O.\u0275fac,providedIn:"root"});class P{constructor(e,t,i,n){this.rxViewActionRegistryService=e,this.rxApplyGridFilterViewActionService=t,this.rxApplyGridFilterViewActionDefinitionAdapterService=i,this.rxViewActionDefinitionAdapterRegistryService=n,this.rxViewActionRegistryService.register({name:E,label:"Apply grid filter",bundleId:r.RX_APPLICATION.platformBundleId,service:t,designModel:A,parameters:[{name:"targetApi",label:"Record grid",isRequired:!0,enableExpressionEvaluation:!0},{name:"mode",label:"Mode"},{name:"filters"}]}),n.registerRuntimeAdapter(E,this.rxApplyGridFilterViewActionDefinitionAdapterService)}}P.\u0275fac=function(e){return new(e||P)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](M),n["\u0275\u0275inject"](O),n["\u0275\u0275inject"](o.RxViewActionDefinitionAdapterRegistryService))},P.\u0275mod=n["\u0275\u0275defineNgModule"]({type:P}),P.\u0275inj=n["\u0275\u0275defineInjector"]({});const T={actionName:"rxOpenViewAction",modalSize:o.OpenViewActionModalSize,type:o.OpenViewActionType,launchBehavior:o.OpenViewActionLaunchBehavior};class V{constructor(e,t,i,n,o){this.adaptDockedPanelService=e,this.adaptModalService=t,this.router=i,this.rxRuntimeViewUtilsService=n,this.rxViewActionUtilsService=o}execute(e){const t=(0,u.transform)(e.viewParams,(e,t,i)=>{e[i]=(0,u.isObject)(t)?JSON.stringify(t):String(null!=t?t:"")},{});return this.rxRuntimeViewUtilsService.isViewCancellable(e.viewDefinitionName).pipe((0,c.switchMap)(i=>{let n;const o={configuration:{viewDefinitionName:e.viewDefinitionName,inputParams:t,onRegisterApi(e){n=e}},title:e.presentation.title,notification:e.presentation.notification,isCancellable:i},r={beforeDismiss:e=>{const t=!Object.values(g.DismissReasons).includes(e);return t||e===g.DismissReasons.BACKDROP_CLICK&&!i||n.cancel().pipe((0,c.take)(1),(0,c.catchError)(e=>e?(0,s.throwError)(e):s.EMPTY)).subscribe(),t},blockKeyboard:!i,content:v.RuntimeViewModalComponent,size:e.presentation.modalSize,data:o};switch(e.presentation.type){case T.type.FullWidth:return this.openFullWidth(e.presentation.launchBehavior,e.viewDefinitionName,t);case T.type.CenteredModal:return this.adaptModalService.open(r);case T.type.DockedLeftModal:return this.adaptDockedPanelService.open((0,u.defaults)({direction:g.DockedPanelDirection.LEFT},r));case T.type.DockedRightModal:return this.adaptDockedPanelService.open((0,u.defaults)({direction:g.DockedPanelDirection.RIGHT},r));default:return this.openFullWidth(e.presentation.launchBehavior,e.viewDefinitionName,t)}}))}openFullWidth(e,t,i){const n=this.rxViewActionUtilsService.generateViewUrl(t,i);return e===T.launchBehavior.NewWindow?(window.open(`${window.location.pathname}#${n}`),(0,s.throwError)(null)):(0,s.from)(this.router.navigateByUrl(n)).pipe((0,c.switchMapTo)((0,s.throwError)(null)))}}V.\u0275fac=function(e){return new(e||V)(n["\u0275\u0275inject"](g.AdaptDockedPanelService),n["\u0275\u0275inject"](g.AdaptModalService),n["\u0275\u0275inject"](h.Router),n["\u0275\u0275inject"](v.RxRuntimeViewUtilsService),n["\u0275\u0275inject"](o.RxViewActionUtilsService))},V.\u0275prov=n["\u0275\u0275defineInjectable"]({token:V,factory:V.\u0275fac,providedIn:"root"});class N{constructor(e,t,i,n,o){this.rxAssociationInstanceService=e,this.rxOpenViewActionService=t,this.rxAssociationDefinitionService=i,this.rxLogService=n,this.rxViewActionUtilsService=o}execute(e){return e.associatedRecordId?(0,s.forkJoin)([this.getInstanceIds(e),this.rxAssociationDefinitionService.get(e.associationDefinitionName)]).pipe((0,c.switchMap)(([t,i])=>{let n=[],o=[];return t.length?(e.associationDefinitionRole===f.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA.value?(n=t,o=[e.associatedRecordId]):e.associationDefinitionRole===f.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.value&&(n=[e.associatedRecordId],o=t),i.cardinality===f.RX_ASSOCIATION_DEFINITION.cardinality.oneToOne.value?(n=n[0],o=o[0]):i.cardinality===f.RX_ASSOCIATION_DEFINITION.cardinality.oneToMany.value&&(n=n[0]),this.rxAssociationInstanceService.associateRecords(e.associationDefinitionName,n,o,e.useDefaultRoles,e.nodeARole,e.nodeBRole).pipe((0,c.mapTo)(t))):(0,s.of)(t)})):(0,s.throwError)(new a.RxError("rxAssociateAction: Associated Record ID is not defined."))}getInstanceIds(e){return this.rxOpenViewActionService.execute({presentation:{modalSize:T.modalSize.Large,type:T.type.DockedRightModal},viewDefinitionName:e.viewDefinitionName,viewParams:null}).pipe((0,c.map)(e=>{const t=(0,u.flow)(e=>(0,u.map)(e,e=>this.rxViewActionUtilsService.extractRecordIds(e)),u.flatten,u.compact,u.uniq)(e);return this.rxLogService.debug(`RxAssociateAction: associating ${t.length} record(s)`),t}))}}N.\u0275fac=function(e){return new(e||N)(n["\u0275\u0275inject"](f.RxAssociationInstanceService),n["\u0275\u0275inject"](V),n["\u0275\u0275inject"](f.RxAssociationDefinitionService),n["\u0275\u0275inject"](r.RxLogService),n["\u0275\u0275inject"](o.RxViewActionUtilsService))},N.\u0275prov=n["\u0275\u0275defineInjectable"]({token:N,factory:N.\u0275fac,providedIn:"root"});class k{constructor(){this.modalSizeMap={small:T.modalSize.Small,medium:T.modalSize.Medium,large:T.modalSize.Large}}adaptDefinition(e){const t=(0,u.get)(e,"propertiesByName",{});if(t.name===T.actionName){const e=t.presentation.modalSize;this.modalSizeMap[e]&&(t.presentation.modalSize=this.modalSizeMap[e])}}}k.\u0275fac=function(e){return new(e||k)},k.\u0275prov=n["\u0275\u0275defineInjectable"]({token:k,factory:k.\u0275fac,providedIn:"root"});const j=[{id:o.OpenViewActionModalSize.Xsmall,name:"Extra Small (450 px)"},{id:o.OpenViewActionModalSize.Small,name:"Small (650 px)"},{id:o.OpenViewActionModalSize.Medium,name:"Medium (800 px)"},{id:o.OpenViewActionModalSize.Large,name:"Large (1024 px)"},{id:o.OpenViewActionModalSize.Xlarge,name:"Extra Large (1200 px)"},{id:o.OpenViewActionModalSize.Xxlarge,name:"Extra Extra Large (1600 px)"},{id:o.OpenViewActionModalSize.FullSize,name:"Full Size"}],_=[{id:o.OpenViewActionType.FullWidth,name:"Full width"},{id:o.OpenViewActionType.CenteredModal,name:"Centered modal"},{id:o.OpenViewActionType.DockedLeftModal,name:"Docked left modal"},{id:o.OpenViewActionType.DockedRightModal,name:"Docked right modal"}],B=[{id:o.OpenViewActionLaunchBehavior.NewWindow,name:"Open in a new tab"},{id:o.OpenViewActionLaunchBehavior.SameWindow,name:"Open in the same tab"}];class ${getOpenViewInspector(e,t,i,n){const a=e.map(e=>({name:`viewParams.${e.name}`,component:d.ExpressionFormControlComponent,options:{label:e.name,dataDictionary$:n.getDataDictionary(e.name),operators:n.getOperators(e.name)}})),s=t===o.OpenViewActionType.FullWidth,l=t===o.OpenViewActionType.CenteredModal&&i===o.OpenViewActionModalSize.FullSize;return[{name:"viewDefinitionName",component:d.RxDefinitionPickerComponent,options:{label:"View",required:!0,definitionType:d.RxDefinitionPickerType.View}},...a,{name:"presentation.type",component:d.SelectFormControlComponent,options:{label:"Presentation",tooltip:new r.Tooltip("Select how to display the view in the application."),options:_,sortAlphabetically:!1}},...s?[{name:"presentation.launchBehavior",component:d.SelectFormControlComponent,options:{label:"Launch behavior",options:B,sortAlphabetically:!0}}]:[{name:"presentation.modalSize",component:d.SelectFormControlComponent,options:{label:"Size",options:t===o.OpenViewActionType.CenteredModal?j:j.filter(e=>e.id!==o.OpenViewActionModalSize.FullSize),sortAlphabetically:!1}},...l?[]:[{name:"presentation.title",component:d.TextFormControlComponent,options:{label:"Title"}}]]]}}$.\u0275fac=function(e){return new(e||$)},$.\u0275prov=n["\u0275\u0275defineInjectable"]({token:$,factory:$.\u0275fac,providedIn:"root"});class L extends l.RxViewDesignerActionModel{constructor(e,t){super(e,t),this.sandbox=t,this.rxViewDefinitionCacheService=this.injector.get(o.RxViewDefinitionCacheService),this.rxOpenViewModelHelperService=this.injector.get($);const i=this.sandbox.actionProperties$.pipe((0,c.pluck)("viewDefinitionName"),(0,c.distinctUntilChanged)()),n=this.sandbox.actionProperties$.pipe((0,c.pluck)("presentation.type"),(0,c.distinctUntilChanged)()),r=this.sandbox.actionProperties$.pipe((0,c.pluck)("presentation.modalSize"),(0,c.distinctUntilChanged)());(0,s.combineLatest)([i,n,r]).pipe((0,c.switchMap)(([e,t,i])=>this.getActionEditorConfig(e,t,i))).subscribe(e=>this.sandbox.setActionPropertyEditorConfig(e)),i.pipe((0,c.switchMap)(e=>this.getViewOutputParams(e))).subscribe(e=>{this.sandbox.setActionOutputDataDictionary(e.map(({name:e})=>({label:e,expression:this.getOutputExpressionForPropertyPath(e)})))}),n.pipe((0,c.skip)(1)).subscribe(e=>{let t=this.sandbox.getActionProperties();e===o.OpenViewActionType.FullWidth?(t["presentation.launchBehavior"]=o.OpenViewActionLaunchBehavior.SameWindow,t=(0,u.omit)(t,["presentation.modalSize","presentation.title"])):(t=(0,u.omit)(t,["presentation.launchBehavior"]),t["presentation.modalSize"]&&this.sandbox.getActionPropertyValue("presentation.modalSize")!==o.OpenViewActionModalSize.FullSize||(t["presentation.modalSize"]=o.OpenViewActionModalSize.Medium)),this.sandbox.setActionProperties(t)}),r.pipe((0,c.skip)(1)).subscribe(e=>{e===o.OpenViewActionModalSize.FullSize&&this.sandbox.setActionProperties((0,u.omit)(this.sandbox.getActionProperties(),["presentation.title"]))})}static getInitialProperties(e){return Object.assign({viewDefinitionName:null,"presentation.type":o.OpenViewActionType.FullWidth,"presentation.launchBehavior":o.OpenViewActionLaunchBehavior.SameWindow},e)}getActionEditorConfig(e,t,i){return this.getViewInputParams(e).pipe((0,c.map)(e=>this.rxOpenViewModelHelperService.getOpenViewInspector(e,t,i,this.expressionConfigurator)))}getViewInputParams(e){return e?this.rxViewDefinitionCacheService.getViewDefinition(e).pipe((0,c.pluck)("inputParams")):(0,s.of)([])}getViewOutputParams(e){return e?this.rxViewDefinitionCacheService.getViewDefinition(e).pipe((0,c.pluck)("outputParams")):(0,s.of)([])}}class G{constructor(e,t,i,n){this.rxViewActionDefinitionAdapterRegistryService=e,this.openViewDefinitionAdapterService=t,this.rxViewActionRegistryService=i,this.rxOpenViewActionService=n,this.rxViewActionRegistryService.register({name:T.actionName,label:"Open view",bundleId:r.RX_APPLICATION.platformBundleId,service:this.rxOpenViewActionService,designModel:L,parameters:[{name:"viewDefinitionName",label:"View",isRequired:!0},{name:"viewParams",enableExpressionEvaluation:!0},{name:"presentation",attributes:[{name:"title",localizable:!0}]}]}),e.registerRuntimeAdapter(T.actionName,this.openViewDefinitionAdapterService)}}G.\u0275fac=function(e){return new(e||G)(n["\u0275\u0275inject"](o.RxViewActionDefinitionAdapterRegistryService),n["\u0275\u0275inject"](k),n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](V))},G.\u0275mod=n["\u0275\u0275defineNgModule"]({type:G,imports:[y.CommonModule,v.RuntimeViewModule,g.AdaptDockedPanelModule]}),G.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[y.CommonModule,v.RuntimeViewModule,g.AdaptDockedPanelModule]]});class q extends l.RxViewDesignerActionModel{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.rxRecordDefinitionCacheService=this.injector.get(m.RxRecordDefinitionCacheService),this.rxDefinitionNameService=this.injector.get(r.RxDefinitionNameService),this.rxAssociationDefinitionService=this.injector.get(f.RxAssociationDefinitionService);const i=this.sandbox.actionProperties$.pipe((0,c.pluck)("recordDefinitionName"),(0,c.distinctUntilChanged)()),n=this.sandbox.actionProperties$.pipe((0,c.pluck)("associationDefinitionName"),(0,c.distinctUntilChanged)()),o=i.pipe((0,c.switchMap)(e=>e?this.rxRecordDefinitionCacheService.getRecordAssociationDefinitions(e).pipe((0,c.map)(t=>t[e].map(e=>({id:e.name,name:this.rxDefinitionNameService.getDisplayName(e.name)})))):(0,s.of)([]))),a=n.pipe((0,c.switchMap)(e=>e?this.rxAssociationDefinitionService.get(e):(0,s.of)(null)),(0,c.shareReplay)(1)),l=a.pipe((0,c.map)(e=>!!e&&e.nodeAId===e.nodeBId)),d=a.pipe((0,c.map)(e=>!!e&&e.cardinality===f.RX_ASSOCIATION_DEFINITION.cardinality.manyToMany.value)),p=this.sandbox.actionProperties$.pipe((0,c.pluck)("useDefaultRoles"),(0,c.map)(Boolean),(0,c.distinctUntilChanged)());p.pipe((0,c.distinctUntilChanged)(),(0,c.skip)(1)).subscribe(e=>{e&&this.sandbox.setActionProperties((0,u.omit)(this.sandbox.getActionProperties(),["nodeARole","nodeBRole"]))});const h=a.pipe((0,c.map)(e=>e?[{id:f.RxAssociatedRecordNodeSide.NodeA,name:e.nodeAName||f.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA.defaultName},{id:f.RxAssociatedRecordNodeSide.NodeB,name:e.nodeBName||f.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.defaultName}]:[]));i.pipe((0,c.skip)(1)).subscribe(()=>{this.sandbox.updateActionProperties({associationDefinitionName:null,associationDefinitionRole:null})}),a.pipe((0,c.skip)(1),(0,c.withLatestFrom)(l,i)).subscribe(([e,t,i])=>{if(e&&!t){const t=i===e.nodeAId?f.RxAssociatedRecordNodeSide.NodeA:f.RxAssociatedRecordNodeSide.NodeB;this.sandbox.updateActionProperties({associationDefinitionRole:t})}else this.sandbox.updateActionProperties({associationDefinitionRole:null})}),(0,s.combineLatest)([i,o,h,p]).pipe((0,c.withLatestFrom)(l,d)).subscribe(([[e,t,i,n],o,r])=>{this.sandbox.setActionPropertyEditorConfig(this.getActionEditorConfig(e,t,i,o,r,n))})}static getInitialProperties(e){return Object.assign({recordDefinitionName:null,associationDefinitionName:null,associationDefinitionRole:null,associatedRecordId:null,viewDefinitionName:null},e)}getActionEditorConfig(e,t,i,n,o,r){return[{name:"recordDefinitionName",component:d.RxDefinitionPickerComponent,options:{label:"Record definition to associate",definitionType:d.RxDefinitionPickerType.StandardDataRecord,required:!0}},...e?[{name:"associationDefinitionName",component:d.SelectFormControlComponent,options:{label:"Association to use",options:t,required:!0}},{name:"associationDefinitionRole",component:d.SelectFormControlComponent,isDisabled:!n,options:{label:"Associated record node side",required:!0,options:i}},{name:"associatedRecordId",component:d.ExpressionFormControlComponent,options:{label:"Associated record ID",dataDictionary$:this.expressionConfigurator.getDataDictionary(),operators:this.expressionConfigurator.getOperators(),isRequired:!0}},{name:"viewDefinitionName",component:d.RxDefinitionPickerComponent,options:{label:"View for selecting or creating associated records",required:!0,definitionType:d.RxDefinitionPickerType.View}},...o?[{name:"useDefaultRoles",component:d.SwitchFormControlComponent,options:{label:"Use default roles"}},...o&&r?[]:[{name:"nodeARole",component:d.ExpressionFormControlComponent,options:{label:"First record role",dataDictionary$:this.expressionConfigurator.getDataDictionary(),operators:this.expressionConfigurator.getOperators()}},{name:"nodeBRole",component:d.ExpressionFormControlComponent,options:{label:"Second record role",dataDictionary$:this.expressionConfigurator.getDataDictionary(),operators:this.expressionConfigurator.getOperators()}}]]:[]]:[]]}}class U{constructor(e,t){this.rxViewActionRegistryService=e,this.rxAssociateViewActionService=t,this.rxViewActionRegistryService.register({name:"rxAssociateAction",label:"Associate records",bundleId:r.RX_APPLICATION.platformBundleId,service:this.rxAssociateViewActionService,designModel:q,parameters:[{name:"recordDefinitionName",label:"Record definition to associate",isRequired:!0,type:o.ViewComponentPropertyType.String},{name:"associationDefinitionName",label:"Association to use",isRequired:!0},{name:"associationDefinitionRole",label:"Associated record node side",isRequired:!0},{name:"associatedRecordId",label:"Associated record ID",enableExpressionEvaluation:!0,isRequired:!0},{name:"viewDefinitionName",label:"View for selecting or creating associated records",isRequired:!0,type:o.ViewComponentPropertyType.String},{name:"useDefaultRoles"},{name:"nodeARole",enableExpressionEvaluation:!0},{name:"nodeBRole",enableExpressionEvaluation:!0}]})}}U.\u0275fac=function(e){return new(e||U)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](N))},U.\u0275mod=n["\u0275\u0275defineNgModule"]({type:U,imports:[G]}),U.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[G]]});class z{constructor(e,t,i,n){this.rxGuidService=e,this.rxOpenViewActionService=t,this.rxStringService=i,this.rxRecordInstanceUtilsService=n}execute(e){return this.rxOpenViewActionService.execute({viewDefinitionName:e.viewDefinitionName,viewParams:null,presentation:{modalSize:o.OpenViewActionModalSize.Large,type:o.OpenViewActionType.DockedRightModal}}).pipe((0,c.tap)(t=>{const i=(0,u.flow)(e=>(0,u.map)(e,e=>this.extractRecordInstance(e)),u.flatten,u.compact,u.uniq)(t);e.associationViewComponent.associate(i)}),(0,c.switchMapTo)(s.EMPTY))}extractRecordInstance(e){let t=[];if((0,u.isFunction)(e.getSelectedRows))t=(0,u.map)(e.getSelectedRows(),this.rxRecordInstanceUtilsService.convertFromDataPageRowToPlainRecordInstance);else if((0,u.isObject)(e)&&this.rxStringService.isNonEmptyString(e[o.RowDataItemIdFieldName]))t.push(this.rxRecordInstanceUtilsService.convertFromDataPageRowToPlainRecordInstance(e));else if((0,u.isArray)(e)&&(0,u.some)(e,u.isObject))t=(0,u.map)(e,this.rxRecordInstanceUtilsService.convertFromDataPageRowToPlainRecordInstance);else if((0,u.isObject)(e)&&(0,u.isObject)(e.fieldInstances)&&e.id)t.push(e);else if((0,u.isObject)(e)&&(0,u.isObject)(e.fieldInstances)&&!e.id){const i=this.rxGuidService.generate();e.id=i,e.fieldInstances[m.RX_RECORD_DEFINITION.coreFieldIds.id].value=i,e.isNewInstance=!0,t.push(e)}return t}}z.\u0275fac=function(e){return new(e||z)(n["\u0275\u0275inject"](a.RxGuidService),n["\u0275\u0275inject"](V),n["\u0275\u0275inject"](a.RxStringService),n["\u0275\u0275inject"](m.RxRecordInstanceUtilsService))},z.\u0275prov=n["\u0275\u0275defineInjectable"]({token:z,factory:z.\u0275fac,providedIn:"root"});class X{constructor(e,t){this.rxViewActionRegistryService=e,this.rxAvcAssociateActionService=t,this.rxViewActionRegistryService.register({name:"rxAvcAssociate",label:"Avc associate",bundleId:r.RX_APPLICATION.platformBundleId,hidden:!0,service:this.rxAvcAssociateActionService,parameters:[{name:"viewDefinitionName"},{name:"associationViewComponent",enableExpressionEvaluation:!0}]})}}X.\u0275fac=function(e){return new(e||X)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](z))},X.\u0275mod=n["\u0275\u0275defineNgModule"]({type:X,imports:[y.CommonModule]}),X.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[y.CommonModule]]});class W{execute(e){return e.actAsCancel?e.viewApi.cancel():s.EMPTY.pipe((0,c.tap)({complete(){e.viewApi.close()}}))}}W.\u0275fac=function(e){return new(e||W)},W.\u0275prov=n["\u0275\u0275defineInjectable"]({token:W,factory:W.\u0275fac,providedIn:"root"});class H{constructor(e,t){this.rxViewActionRegistryService=e,this.rxCloseViewActionService=t,this.rxViewActionRegistryService.register({name:"rxCloseViewAction",label:"Close view",bundleId:r.RX_APPLICATION.platformBundleId,service:this.rxCloseViewActionService,parameters:[{name:"viewApi",enableExpressionEvaluation:!0,defaultValue:"${view.api}"},{name:"actAsCancel",label:"Act as cancel",editor:d.SwitchFormControlComponent,type:o.ViewComponentPropertyType.Boolean,designType:o.ViewComponentPropertyType.Boolean}]})}}H.\u0275fac=function(e){return new(e||H)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](W))},H.\u0275mod=n["\u0275\u0275defineNgModule"]({type:H}),H.\u0275inj=n["\u0275\u0275defineInjector"]({});class Q{constructor(e,t,i,n,o,r,a){this.rxLogService=e,this.rxModalService=t,this.translateService=i,this.rxNotificationService=n,this.rxRecordInstanceService=o,this.rxViewActionUtilsService=r,this.rxStringService=a}execute(e){if((0,u.isEmpty)(e.recordDefinitionName)&&e.records&&(0,u.isFunction)(e.records.getRecordDefinitionName)&&(e.recordDefinitionName=e.records.getRecordDefinitionName()),this.rxStringService.isNonEmptyString(e.recordDefinitionName)){let t=[];e.records&&(t=(0,u.isFunction)(e.records.getSelectedRows)?(0,u.castArray)(e.records.getSelectedRows()):(0,u.castArray)(e.records));const i=this.rxViewActionUtilsService.extractRecordIds(t);if(i.length){const t=1===i.length?"com.bmc.arsys.rx.client.view-actions.delete-record.confirmation-dialog.message":"com.bmc.arsys.rx.client.view-actions.delete-records.confirmation-dialog.message";return(0,s.from)(this.rxModalService.confirm({title:this.translateService.instant("com.bmc.arsys.rx.client.common.warning.label"),modalStyle:b.RX_MODAL.modalStyles.warning,message:this.translateService.instant(t,{count:i.length})})).pipe((0,c.switchMap)(t=>{if(t){const t=i.map(t=>this.rxRecordInstanceService.delete(e.recordDefinitionName,t));return(0,s.forkJoin)(t).pipe((0,c.tap)(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.view-actions.delete-records.records-deleted.message"))}),(0,c.switchMapTo)((0,u.isFunction)(e.records.refresh)?e.records.refresh():s.EMPTY))}return(0,s.throwError)(null)}))}return this.rxLogService.debug("rxDeleteRecordsAction: no records to delete."),s.EMPTY}return(0,s.throwError)(new a.RxError("rxDeleteRecordsAction: Record Definition Name is not defined."))}}Q.\u0275fac=function(e){return new(e||Q)(n["\u0275\u0275inject"](r.RxLogService),n["\u0275\u0275inject"](b.RxModalService),n["\u0275\u0275inject"](x.TranslateService),n["\u0275\u0275inject"](r.RxNotificationService),n["\u0275\u0275inject"](m.RxRecordInstanceService),n["\u0275\u0275inject"](o.RxViewActionUtilsService),n["\u0275\u0275inject"](a.RxStringService))},Q.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Q,factory:Q.\u0275fac,providedIn:"root"});class J{constructor(e,t){this.rxViewActionRegistryService=e,this.rxDeleteRecordsViewActionService=t,this.rxViewActionRegistryService.register({name:"rxDeleteRecordsAction",label:"Delete records",bundleId:r.RX_APPLICATION.platformBundleId,service:this.rxDeleteRecordsViewActionService,parameters:[{name:"records",label:"Records",enableExpressionEvaluation:!0,isRequired:!0,editor:d.ExpressionFormControlComponent,tooltip:new r.Tooltip("Build an expression that evaluates to one of the following:<br>\n            1) Record grid<br>\n            2) A collection of record instances or<br>\n            3) A collection of record instance IDs. <br>For options 2 and 3, select a record definition in the field below.")},{name:"recordDefinitionName",label:"Record definition",type:o.ViewComponentPropertyType.String,editor:d.RxDefinitionPickerComponent,editorOptions:{definitionType:d.RxDefinitionPickerType.StandardDataRecord},defaultValue:null}]})}}J.\u0275fac=function(e){return new(e||J)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](Q))},J.\u0275mod=n["\u0275\u0275defineNgModule"]({type:J}),J.\u0275inj=n["\u0275\u0275defineInjector"]({});class K{constructor(e,t,i,n){this.rxLogService=e,this.rxViewActionUtilsService=t,this.rxAssociationDefinitionService=i,this.rxAssociationInstanceService=n}execute(e){if(!e.associatedRecordId)return(0,s.throwError)(new a.RxError("rxDisassociateAction: Associated Record ID is not defined."));const t=this.rxViewActionUtilsService.extractRecordIds(e.disassociatedRecordIds);return this.rxLogService.debug(`RxDisassociateAction: disassociating ${t.length} record(s)`),t.length?this.rxAssociationDefinitionService.get(e.associationDefinitionName).pipe((0,c.switchMap)(()=>{let i,n=[];return e.associationDefinitionRole===f.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA.value?(i=t,n=[e.associatedRecordId]):e.associationDefinitionRole===f.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.value&&(i=[e.associatedRecordId],n=t),this.rxAssociationInstanceService.disassociateRecords(e.associationDefinitionName,i,n).pipe((0,c.mapTo)(t))})):(0,s.of)([])}}K.\u0275fac=function(e){return new(e||K)(n["\u0275\u0275inject"](r.RxLogService),n["\u0275\u0275inject"](o.RxViewActionUtilsService),n["\u0275\u0275inject"](f.RxAssociationDefinitionService),n["\u0275\u0275inject"](f.RxAssociationInstanceService))},K.\u0275prov=n["\u0275\u0275defineInjectable"]({token:K,factory:K.\u0275fac,providedIn:"root"});class Y extends l.RxViewDesignerActionModel{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.rxRecordDefinitionCacheService=this.injector.get(m.RxRecordDefinitionCacheService),this.rxDefinitionNameService=this.injector.get(r.RxDefinitionNameService),this.rxAssociationDefinitionService=this.injector.get(f.RxAssociationDefinitionService);const i=this.sandbox.actionProperties$.pipe((0,c.pluck)("recordDefinitionName"),(0,c.distinctUntilChanged)()),n=this.sandbox.actionProperties$.pipe((0,c.pluck)("associationDefinitionName"),(0,c.distinctUntilChanged)()),o=i.pipe((0,c.switchMap)(e=>e?this.rxRecordDefinitionCacheService.getRecordAssociationDefinitions(e).pipe((0,c.map)(t=>t[e].map(e=>({id:e.name,name:this.rxDefinitionNameService.getDisplayName(e.name)})))):(0,s.of)([]))),a=n.pipe((0,c.switchMap)(e=>e?this.rxAssociationDefinitionService.get(e):(0,s.of)(null)),(0,c.shareReplay)(1)),l=a.pipe((0,c.map)(e=>!!e&&e.nodeAId===e.nodeBId)),d=a.pipe((0,c.map)(e=>e?[{id:f.RxAssociatedRecordNodeSide.NodeA,name:e.nodeAName||f.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA.defaultName},{id:f.RxAssociatedRecordNodeSide.NodeB,name:e.nodeBName||f.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.defaultName}]:[]));i.pipe((0,c.skip)(1)).subscribe(()=>{this.sandbox.updateActionProperties({associationDefinitionName:null,associationDefinitionRole:null})}),a.pipe((0,c.skip)(1),(0,c.withLatestFrom)(l,i)).subscribe(([e,t,i])=>{if(e&&!t){const t=i===e.nodeAId?f.RxAssociatedRecordNodeSide.NodeA:f.RxAssociatedRecordNodeSide.NodeB;this.sandbox.updateActionProperties({associationDefinitionRole:t})}else this.sandbox.updateActionProperties({associationDefinitionRole:null})}),(0,s.combineLatest)([i,o,d]).pipe((0,c.withLatestFrom)(l)).subscribe(([[e,t,i],n])=>{this.sandbox.setActionPropertyEditorConfig(this.getActionEditorConfig(e,t,i,n))})}static getInitialProperties(e){return Object.assign({recordDefinitionName:null,associationDefinitionName:null,associationDefinitionRole:null,associatedRecordId:null,disassociatedRecordIds:null},e)}getActionEditorConfig(e,t,i,n){return[{name:"recordDefinitionName",component:d.RxDefinitionPickerComponent,options:{label:"Record definition to disassociate",definitionType:d.RxDefinitionPickerType.StandardDataRecord,required:!0}},...e?[{name:"associationDefinitionName",component:d.SelectFormControlComponent,options:{label:"Association to use",options:t,required:!0}},{name:"associationDefinitionRole",component:d.SelectFormControlComponent,isDisabled:!n,options:{label:"Associated record node side",required:!0,options:i}},{name:"associatedRecordId",component:d.ExpressionFormControlComponent,options:{label:"Associated record ID",dataDictionary$:this.expressionConfigurator.getDataDictionary(),operators:this.expressionConfigurator.getOperators(),isRequired:!0}},{name:"disassociatedRecordIds",component:d.ExpressionFormControlComponent,options:{label:"Records to disassociate",dataDictionary$:this.expressionConfigurator.getDataDictionary(),operators:this.expressionConfigurator.getOperators(),isRequired:!0}}]:[]]}}class Z{constructor(e,t){this.rxViewActionRegistryService=e,this.rxDisassociateViewActionService=t,this.rxViewActionRegistryService.register({name:"rxDisassociateAction",label:"Disassociate records",bundleId:r.RX_APPLICATION.platformBundleId,service:this.rxDisassociateViewActionService,designModel:Y,parameters:[{name:"recordDefinitionName",label:"Record definition to disassociate",isRequired:!0,type:o.ViewComponentPropertyType.String},{name:"associationDefinitionName",label:"Association to use",isRequired:!0},{name:"associationDefinitionRole",label:"Associated record node side",isRequired:!0},{name:"associatedRecordId",label:"Associated record ID",enableExpressionEvaluation:!0,isRequired:!0},{name:"disassociatedRecordIds",label:"Records to disassociate",enableExpressionEvaluation:!0,isRequired:!0}]})}}Z.\u0275fac=function(e){return new(e||Z)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](K))},Z.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Z}),Z.\u0275inj=n["\u0275\u0275defineInjector"]({});class ee{constructor(e){this.activeModelRef=e,this.data=this.activeModelRef.getData()}close(){this.activeModelRef.close()}hasActionResultDetails(e){return["warningCount","errorCount","infoCount","successCount"].some(t=>e.summary[t])}}ee.\u0275fac=function(e){return new(e||ee)(n["\u0275\u0275directiveInject"](g.ActiveModalRef))},ee.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ee,selectors:[["rx-edit-records-result-modal"]],decls:18,vars:19,consts:[[1,"modal-body"],[1,"mb-2"],[1,"mr-1","text-success-icon",3,"name"],[1,"mr-1","text-warning-icon",3,"name"],[1,"mr-1","text-danger-icon",3,"name"],["class","mt-2",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"mt-2"],["readonly","","rows","15",1,"resize-none",3,"label","ngModel"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275element"](2,"adapt-icon",2),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",1),n["\u0275\u0275element"](6,"adapt-icon",3),n["\u0275\u0275text"](7),n["\u0275\u0275pipe"](8,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](9,"div"),n["\u0275\u0275element"](10,"adapt-icon",4),n["\u0275\u0275text"](11),n["\u0275\u0275pipe"](12,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](13,D,3,4,"div",5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](14,"div",6),n["\u0275\u0275elementStart"](15,"button",7),n["\u0275\u0275listener"]("click",function(){return t.close()}),n["\u0275\u0275text"](16),n["\u0275\u0275pipe"](17,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("name","check_circle"),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate2"](" ",n["\u0275\u0275pipeBind1"](4,11,"com.bmc.arsys.rx.client.view-actions.edit-records.action-results-dialog.updated-successfully.label"),": ",t.data.summary.successCount," "),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("name","exclamation_circle"),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate2"](" ",n["\u0275\u0275pipeBind1"](8,13,"com.bmc.arsys.rx.client.view-actions.edit-records.action-results-dialog.updated-with-warnings.label"),": ",t.data.summary.warningCount," "),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("name","exclamation_triangle"),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate2"](" ",n["\u0275\u0275pipeBind1"](12,15,"com.bmc.arsys.rx.client.view-actions.edit-records.action-results-dialog.update-failures.label"),": ",t.data.summary.errorCount," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.hasActionResultDetails(t.data)&&t.data.details),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](17,17,"com.bmc.arsys.rx.client.common.close.label")," "))},directives:[g.AdaptIconComponent,y.NgIf,g.AdaptRxTextareaComponent,C.NgControlStatus,C.NgModel],pipes:[x.TranslatePipe],styles:["[_nghost-%COMP%]     .resize-none{resize:none}"]});class te{constructor(e,t,i){this.adaptModalService=e,this.translateService=t,this.rxCommandFactoryService=i,this.resourceType="com.bmc.arsys.rx.application.record.command.UpdateRecordInstancesCommand",this.editRecordsCommand=this.rxCommandFactoryService.forResourceType(this.resourceType)}editRecords(e){return this.editRecordsCommand.execute(e)}showActionResults(e){return this.adaptModalService.open({size:"sm",title:this.translateService.instant("com.bmc.arsys.rx.client.view-actions.edit-records.action-results-dialog.title"),data:e,content:ee}).catch(u.noop)}runAction(e,t){const i=this.prepareRecordData(e,t),n=new FormData;return n.append("commandInstance",JSON.stringify(i.commandInstance)),(0,u.forEach)(i.attachments,e=>{n.append(e.key,e.file)}),Object.keys(i||{}).map(e=>{"commandInstance"!==e&&"attachments"!==e&&n.append(e,JSON.stringify(i[e]))}),this.editRecords(n).pipe((0,c.map)(e=>this.prepareActionResults(e,i)),(0,c.switchMap)(e=>(0,s.from)(Promise.resolve(this.showActionResults(e)))))}cleanUnchangedFields(e){return(0,u.forIn)(e.fieldInstances,(t,i)=>{(0,u.isNull)(t.value)&&delete e.fieldInstances[i]})}prepareFiles(e,t){return(0,u.values)(e).filter(e=>(0,u.has)(e,"file")).map(e=>({key:t?t+"/"+e.id:e.id,file:e.file}))}cleanFiles(e){return Object.keys(e).map((t,i)=>{e[t].hasOwnProperty("file")?delete e[t]:delete e[t].file}),e}prepareAssociationInstancesForSaving(e){return(0,u.transform)(e,(e,t,i)=>{(0,u.forEach)(t,(t,n)=>{(0,u.isEmpty)(t.pending)||e.push({associationDefinitionName:i,recordInstanceIds:(0,u.map)(t.pending,"id"),nodeSide:n,resourceType:m.RX_RECORD_INSTANCE.association.operationResourceTypes.associate})})},[])}prepareRecordData(e,t){const i=(0,u.pick)(t,["resourceType","recordDefinitionName","fieldInstances"]);i.fieldInstances=this.cleanUnchangedFields(i);const n=this.prepareFiles(i.fieldInstances);i.fieldInstances=this.cleanFiles(i.fieldInstances);const o=this.prepareAssociationInstancesForSaving(t.associationInstances),r={shouldOverrideOptimisticLock:!1,commandInstance:{resourceType:"com.bmc.arsys.rx.application.record.command.UpdateRecordInstancesCommand"},recordInstanceIds:e,recordInstance:i,attachments:n};return(0,u.isEmpty)(o)||(r.associationOperations=o.map(e=>Object.assign(Object.assign({},e),{nodeSide:e.nodeSide.split(":")[0]}))),r}prepareActionResults(e,t){const i=t.recordInstanceIds.length,n=this.translateService.instant("com.bmc.arsys.rx.client.view-actions.edit-records.action-results-dialog.details.record-instance-id.label"),o={successCount:0,errorCount:0,warningCount:0,infoCount:0};let a;return(0,u.isEmpty)(e)?a="":(o.errorCount=(0,u.filter)(e,e=>(0,u.some)(e,["messageType",r.RX_ERROR_HANDLING.messageTypes.error])).length,o.warningCount=(0,u.filter)(e,e=>(0,u.some)(e,["messageType",r.RX_ERROR_HANDLING.messageTypes.warning])).length,o.infoCount=(0,u.filter)(e,e=>(0,u.some)(e,["messageType",r.RX_ERROR_HANDLING.messageTypes.info])).length,o.successCount=(0,u.filter)(e,e=>(0,u.some)(e,["messageType",r.RX_ERROR_HANDLING.messageTypes.success])).length,a=(0,u.map)(e,(e,t)=>n+": "+t+"\n"+(0,u.values)(e).map(this.convertMessageToString).join(", ")).join("\n\n")),o.successCount=i-o.errorCount-o.warningCount,{summary:o,details:a}}convertMessageToString(e){return`${e.messageType}: ${(0,u.values)([e.messageText,e.appendedText]).join(" ")}`}}te.\u0275fac=function(e){return new(e||te)(n["\u0275\u0275inject"](g.AdaptModalService),n["\u0275\u0275inject"](x.TranslateService),n["\u0275\u0275inject"](r.RxCommandFactoryService))},te.\u0275prov=n["\u0275\u0275defineInjectable"]({token:te,factory:te.\u0275fac,providedIn:"root"});class ie{constructor(e,t,i,n,o){this.rxGuidService=e,this.rxDefaultRecordEditorInputType=t,this.rxFieldDefinitionService=i,this.translateService=n,this.rxSystemConfigurationService=o}getViewDefinition(e,t){const i=this.rxGuidService.generate(),n=this.rxGuidService.generate(),r=this.rxGuidService.generate(),a=this.rxGuidService.generate(),s=this.rxGuidService.generate(),l=this.getComponentDefinitions(t,r);return{guid:s,layout:JSON.stringify({outlets:[{name:o.RX_VIEW_DEFINITION.defaultOutletName,columns:[{children:[r]}]},{name:"footer",height:60,columns:[{children:[n]}]}]}),outputParams:[{name:"recordInstance",source:"${view.components."+r+".recordInstance}"}],inputParams:[],componentDefinitions:[{resourceType:o.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent,guid:r,type:o.RxViewComponentType.RecordEditor,propertiesByName:{recordInstanceId:"null",mode:p.RecordEditorMode.BulkEdit,recordDefinitionName:e,styles:"p-0 border-0"},componentDefinitions:l,layout:JSON.stringify({outlets:[{name:o.RX_VIEW_DEFINITION.defaultOutletName,columns:[{children:l.map(e=>e.guid)}]}]})},{resourceType:o.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent,guid:n,type:o.RxViewComponentType.ButtonBar,propertiesByName:{alignment:"right",hidden:"0"},layout:JSON.stringify({outlets:[{name:o.RX_VIEW_DEFINITION.defaultOutletName,columns:[{children:[a,i]}]}]}),componentDefinitions:[{resourceType:o.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent,guid:i,type:o.RxViewComponentType.ActionButton,propertiesByName:{label:this.translateService.instant("com.bmc.arsys.rx.client.common.cancel.label"),style:"secondary",size:"default"},componentDefinitions:[{resourceType:o.RX_VIEW_DEFINITION.resourceTypes.viewComponent,guid:this.rxGuidService.generate(),type:o.RxViewComponentType.Action,propertiesByName:{viewApi:"${view.api}",name:"rxCloseViewAction",actAsCancel:"true"}}]},{resourceType:o.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent,guid:a,type:o.RxViewComponentType.ActionButton,propertiesByName:{label:this.translateService.instant("com.bmc.arsys.rx.client.common.save.label"),style:"primary",disabled:"NOT${view.components."+r+".canSave}",size:"default"},componentDefinitions:[{resourceType:o.RX_VIEW_DEFINITION.resourceTypes.viewComponent,guid:this.rxGuidService.generate(),type:o.RxViewComponentType.Action,propertiesByName:{viewApi:"${view.api}",name:"rxCloseViewAction",actAsCancel:"false"}}]}]}]}}getComponentDefinitions(e,t){this.rxSystemConfigurationService.getConfigurationSync("Submitter-Mode")===r.RX_ADMINISTRATION.submitterModes.locked&&(e=e.filter(e=>Number(e.fieldId)!==m.RX_RECORD_DEFINITION.coreFieldIds.createdBy));const i=this.getFieldContainerComponentDefinitions(e,t);return[{resourceType:o.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent,guid:this.rxGuidService.generate(),type:o.RxViewComponentType.Container,propertiesByName:{rowWrap:p.ContainerRowWrap.Sm,columnCount:"1"},componentDefinitions:i,layout:JSON.stringify({outlets:[{name:o.RX_VIEW_DEFINITION.defaultOutletName,columns:[{children:i.map(e=>e.guid)}]}]})}]}getFieldContainerComponentDefinitions(e,t){return e.filter(e=>!this.rxFieldDefinitionService.isSystemField(e.fieldDefinition)).map(e=>{let i,n;const r=Boolean(e.associationDescriptor);r?(i=o.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent,n=o.RxViewComponentType.Association):(i=o.RX_VIEW_DEFINITION.resourceTypes.viewComponent,n=this.rxDefaultRecordEditorInputType.getFieldTypeByFieldDefinition(e.fieldDefinition));const a={resourceType:i,guid:this.rxGuidService.generate(),type:n,propertiesByName:{fieldId:e.fieldDefinition.id,recordDefinition:"${view.components."+t+".recordDefinition}",recordInstance:"${view.components."+t+".recordInstance}",label:e.title,fieldOption:m.RX_RECORD_DEFINITION.fieldOptions.optional}};return r&&(a.componentDefinitions=[],(0,u.assign)(a.propertiesByName,{associatedRecordNodeSide:e.associationDescriptor.nodeSide,editingMode:p.RxAssociationEditingMode.Dropdown,associationDefinitionName:e.associationDescriptor.associationDefinition.name,recordDefinitionName:e.associationDescriptor.recordDefinitionName})),a}).reduce((e,t,i,n)=>(i%2==0&&e.push({resourceType:o.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent,guid:this.rxGuidService.generate(),type:o.RxViewComponentType.Container,propertiesByName:{rowWrap:p.ContainerRowWrap.Sm,columnCount:"2"},componentDefinitions:n.slice(i,i+2),layout:JSON.stringify({outlets:[{name:o.RX_VIEW_DEFINITION.defaultOutletName,columns:[{children:[t.guid],span:"6"},{children:n.length>i+1?[n[i+1].guid]:[],span:"6"}]}]})}),e),[])}}ie.\u0275fac=function(e){return new(e||ie)(n["\u0275\u0275inject"](a.RxGuidService),n["\u0275\u0275inject"](p.RxDefaultRecordEditorInputType),n["\u0275\u0275inject"](m.RxFieldDefinitionService),n["\u0275\u0275inject"](x.TranslateService),n["\u0275\u0275inject"](r.RxSystemConfigurationService))},ie.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ie,factory:ie.\u0275fac,providedIn:"root"});class ne{constructor(e,t,i,n,o,r,a,s){this.rxEditRecordsViewBuilder=e,this.rxEditRecordsDataService=t,this.rxLogService=i,this.rxRecordGridUtilsService=n,this.translateService=o,this.rxDefinitionNameService=r,this.openViewAction=a,this.rxViewActionUtilsService=s}execute(e){let{recordDefinitionName:t}=e;if((0,u.isNil)(e.records))return(0,s.throwError)(new a.RxError("rxEditRecordsAction: no records to edit."));if((0,u.isEmpty)(t)&&(0,u.isFunction)(e.records.getRecordDefinitionName)&&(t=e.records.getRecordDefinitionName()),t){const i=this.rxViewActionUtilsService.extractRecordIds(e.records);if(i.length)return(0,s.from)(this.rxRecordGridUtilsService.getColumnDescriptors(t,e.records)).pipe((0,c.switchMap)(n=>{const o=this.translateService.instant("com.bmc.arsys.rx.client.view-actions.edit-records.view.title",{recordDefinitionName:this.rxDefinitionNameService.getDisplayName(t)}),r=this.translateService.instant("com.bmc.arsys.rx.client.view-actions.edit-records.view.notification");return this.openViewAction.execute({presentation:{modalSize:T.modalSize.Large,title:o,notification:r,type:T.type.DockedRightModal},viewDefinitionName:this.rxEditRecordsViewBuilder.getViewDefinition(t,n),viewParams:null}).pipe((0,c.switchMap)(t=>t&&t.recordInstance?this.rxEditRecordsDataService.runAction(i,t.recordInstance).pipe((0,c.switchMap)(()=>(0,u.isFunction)(e.records.refresh)?e.records.refresh():s.EMPTY)):s.EMPTY))}));this.rxLogService.debug("rxEditRecordsAction: no records to edit.")}else this.rxLogService.error("rxEditRecordsAction: Record Definition Name is not defined.");return s.EMPTY}}ne.\u0275fac=function(e){return new(e||ne)(n["\u0275\u0275inject"](ie),n["\u0275\u0275inject"](te),n["\u0275\u0275inject"](r.RxLogService),n["\u0275\u0275inject"](p.RxRecordGridUtilsService),n["\u0275\u0275inject"](x.TranslateService),n["\u0275\u0275inject"](r.RxDefinitionNameService),n["\u0275\u0275inject"](V),n["\u0275\u0275inject"](o.RxViewActionUtilsService))},ne.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ne,factory:ne.\u0275fac,providedIn:"root"});class oe{constructor(e,t){this.rxViewActionRegistryService=e,this.rxEditRecordsActionService=t,this.rxViewActionRegistryService.register({name:"rxEditRecordsAction",label:"Edit records",bundleId:r.RX_APPLICATION.platformBundleId,service:this.rxEditRecordsActionService,parameters:[{name:"records",label:"Records",isRequired:!0,tooltip:new r.Tooltip("Build an expression that evaluates to one of the following:<br>\n            1) Record Grid;<br>\n            2) A collection of Record Instances, or<br>\n            3) A collection of Record Instance IDs. <br>For options 2 and 3, select a Record Definition in the field below."),enableExpressionEvaluation:!0,editor:d.ExpressionFormControlComponent},{name:"recordDefinitionName",label:"Record definition",type:o.ViewComponentPropertyType.String,editor:d.RxDefinitionPickerComponent,editorOptions:{definitionType:d.RxDefinitionPickerType.StandardDataRecord},defaultValue:null}]})}}oe.\u0275fac=function(e){return new(e||oe)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](ne))},oe.\u0275mod=n["\u0275\u0275defineNgModule"]({type:oe,declarations:[ee],imports:[y.CommonModule,g.AdaptIconModule,x.TranslateModule,C.FormsModule,g.AdaptRxTextareaModule]}),oe.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[y.CommonModule,g.AdaptIconModule,x.TranslateModule,C.FormsModule,g.AdaptRxTextareaModule]]});class re{constructor(e,t,i){this.rxProcessDefinitionService=e,this.rxViewActionRegistryService=t,this.rxViewExpressionValidatorService=i}validate(e,t){return e.processDefinitionName?this.rxProcessDefinitionService.get(e.processDefinitionName).pipe((0,c.switchMap)(i=>(0,s.combineLatest)([this.validateInputParams(e,t,i.inputParams),this.validateInputParamExpressions(e,t,i.inputParams)])),(0,c.map)(u.flatten)):(0,s.of)([])}validateInputParamExpressions(e,t,i){const n=this.rxViewActionRegistryService.get(e.name),o=i.filter(t=>e[`actionProcessInputParams.${t.name}`]).map(i=>this.rxViewExpressionValidatorService.validate(e[`actionProcessInputParams.${i.name}`],t,n.label).pipe((0,c.map)(e=>e.map(e=>Object.assign(Object.assign({},e),{description:`${n.label} action: ${e.description}`})))));return(0,s.combineLatest)(o).pipe((0,c.defaultIfEmpty)([]),(0,c.map)(u.flatten))}validateInputParams(e,t,i){const n=this.rxViewActionRegistryService.get(e.name),o=[];return(0,u.forEach)(i,i=>{const r=`actionProcessInputParams.${i.name}`;"REQUIRED"===i.fieldOption&&(0,u.isEmpty)(e[r])&&o.push({type:"error",description:`${n.label}: ${i.name} cannot be blank.`,propertyName:t})}),(0,s.of)(o)}}re.\u0275fac=function(e){return new(e||re)(n["\u0275\u0275inject"](S.RxProcessDefinitionService),n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](l.RxViewExpressionValidatorService))},re.\u0275prov=n["\u0275\u0275defineInjectable"]({token:re,factory:re.\u0275fac});class ae extends l.RxViewDesignerActionModel{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.rxProcessDefinitionCacheService=this.injector.get(S.RxProcessDefinitionCacheService),this.rxRecordDefinitionCacheService=this.injector.get(m.RxRecordDefinitionCacheService),this.defaultProps={processDefinitionName:null,waitForProcessCompletion:!1};const i=this.sandbox.actionProperties$.pipe((0,c.pluck)("processDefinitionName"),(0,c.distinctUntilChanged)());i.pipe((0,c.skip)(1)).subscribe(e=>{this.sandbox.setActionProperties({processDefinitionName:e,waitForProcessCompletion:!1})}),i.pipe((0,c.switchMap)(e=>e?this.rxProcessDefinitionCacheService.getProcessDefinition(e):(0,s.of)(null))).subscribe(e=>this.sandbox.setActionPropertyEditorConfig(this.getActionEditorConfig(e))),this.sandbox.actionProperties$.pipe((0,c.map)(e=>[e.processDefinitionName,e.waitForProcessCompletion]),(0,c.distinctUntilChanged)(u.isEqual),(0,c.switchMap)(([e,t])=>this.getActionOutputDataDictionary(e,t))).subscribe(e=>this.sandbox.setActionOutputDataDictionary(e))}static getInitialProperties(e){return Object.assign({processDefinitionName:null,waitForProcessCompletion:!1},e)}getActionEditorConfig(e){return[{name:"processDefinitionName",component:d.RxDefinitionPickerComponent,options:{label:"Process to start",definitionType:d.RxDefinitionPickerType.Process,required:!0}},{name:"waitForProcessCompletion",component:d.SwitchFormControlComponent,isDisabled:!e||!e.synchronous,options:{label:"Wait for process completion",tooltip:new r.Tooltip("If a process runs synchronously, it is possible to get output data from the process once the process completes. Enable Wait for completion in order to define an output map for the selected process.")}},...e?(0,u.map)(e.inputParams,e=>({name:`actionProcessInputParams.${e.name}`,component:d.ExpressionFormControlComponent,options:{label:e.name,dataDictionary$:this.expressionConfigurator.getDataDictionary(),operators:this.expressionConfigurator.getOperators(),isRequired:"REQUIRED"===e.fieldOption}})):[]]}getActionOutputDataDictionary(e,t){return t?this.rxProcessDefinitionCacheService.getOutputParams(e).pipe((0,c.switchMap)(e=>(0,s.forkJoin)(e.map(e=>{let t;if(e.fieldTypeName===S.RX_PROCESS_DEFINITION.processVariableTypes.record){const i=e;t=this.rxRecordDefinitionCacheService.getRecordDefinition(i.recordDefinitionName).pipe((0,c.map)(e=>({label:i.name,expression:this.getOutputExpressionForPropertyPath(i.name),children:(0,u.map)(e.fieldDefinitions,e=>({label:e.name,expression:this.getOutputExpressionForPropertyPath(`${i.name}.${e.id}`)}))})))}else t=(0,s.of)({label:e.name,expression:this.getOutputExpressionForPropertyPath(e.name)});return t})))):(0,s.of)([])}}class se{constructor(e,t,i,n,o,r,a){this.rxJsonParserService=e,this.rxLogService=t,this.rxProcessDefinitionCacheService=i,this.rxRecordDefinitionCacheService=n,this.rxProcessInstanceCommandsService=o,this.rxProcessInstanceService=r,this.rxRecordInstanceService=a}execute(e){let t,i;return this.rxProcessInstanceCommandsService.start(e.processDefinitionName,e.actionProcessInputParams).pipe((0,c.switchMap)(i=>{if(e.waitForProcessCompletion){const n=i.headers.get("location");return t=n?(0,u.last)(n.split("/")):null,this.rxProcessDefinitionCacheService.getOutputParams(e.processDefinitionName)}return(0,s.of)(null)}),(0,c.switchMap)(n=>(0,u.isEmpty)(n)?(0,s.of)(null):(i=n.reduce((e,t)=>(e[t.name]=t,e),{}),this.rxProcessInstanceService.get(e.processDefinitionName,`${t}/processOutputVariables`))),(0,c.switchMap)(e=>{const t={};return(0,u.forEach)(e,(e,n)=>{if(i[n].fieldTypeName===S.RX_PROCESS_DEFINITION.processVariableTypes.record){const i=this.rxJsonParserService.tryParseJson(e);i&&i.recordDefinitionName&&i.id?t[n]=this.rxRecordInstanceService.get(i.recordDefinitionName,i.id).pipe((0,c.map)(e=>(0,u.reduce)(e.fieldInstances,(e,t)=>(e[t.id]=t.value,e),{}))):this.rxLogService.warning("rxLaunchProcessAction: unknown format for record instance as output data for process")}else t[n]=(0,s.of)(e)}),(0,s.forkJoin)(t)}))}}se.\u0275fac=function(e){return new(e||se)(n["\u0275\u0275inject"](a.RxJsonParserService),n["\u0275\u0275inject"](r.RxLogService),n["\u0275\u0275inject"](S.RxProcessDefinitionCacheService),n["\u0275\u0275inject"](m.RxRecordDefinitionCacheService),n["\u0275\u0275inject"](S.RxProcessInstanceCommandsService),n["\u0275\u0275inject"](S.RxProcessInstanceService),n["\u0275\u0275inject"](m.RxRecordInstanceService))},se.\u0275prov=n["\u0275\u0275defineInjectable"]({token:se,factory:se.\u0275fac,providedIn:"root"});class le{constructor(e,t,i){this.rxViewActionRegistryService=e,this.rxLaunchProcessViewActionService=t,this.rxLaunchProcessViewActionDesignManagerService=i,this.rxViewActionRegistryService.register({name:"rxLaunchProcessAction",label:"Launch process",bundleId:r.RX_APPLICATION.platformBundleId,service:this.rxLaunchProcessViewActionService,designManager:this.rxLaunchProcessViewActionDesignManagerService,designModel:ae,parameters:[{name:"processDefinitionName",label:"Process to start",type:o.ViewComponentPropertyType.String,isRequired:!0},{name:"waitForProcessCompletion",type:o.ViewComponentPropertyType.Boolean,designType:o.ViewComponentPropertyType.Boolean},{name:"actionProcessInputParams",label:"Input map",enableExpressionEvaluation:!0}]})}}le.\u0275fac=function(e){return new(e||le)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](se),n["\u0275\u0275inject"](re))},le.\u0275mod=n["\u0275\u0275defineNgModule"]({type:le}),le.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[re]});class de{execute(e){return e.url?(window.open(e.url,o.RX_LAUNCH_BEHAVIOR[e.launchBehavior].target),s.EMPTY):(0,s.throwError)(new a.RxError("rxLaunchUrlAction: URL is not specified."))}}de.\u0275fac=function(e){return new(e||de)},de.\u0275prov=n["\u0275\u0275defineInjectable"]({token:de,factory:de.\u0275fac,providedIn:"root"});class ce extends l.RxViewDesignerActionModel{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.sandbox.setActionPropertyEditorConfig(this.getActionEditorConfig())}static getInitialProperties(e){return Object.assign({url:null,launchBehavior:o.RX_LAUNCH_BEHAVIOR.newWindow.value},e)}getActionEditorConfig(){return[{name:"url",component:d.ExpressionFormControlComponent,options:{label:"URL",isRequired:!0,dataDictionary$:this.expressionConfigurator.getDataDictionary(),operators:this.expressionConfigurator.getOperators()}},{name:"launchBehavior",component:d.SelectFormControlComponent,options:{label:"Launch behavior",options:(0,u.map)(o.RX_LAUNCH_BEHAVIOR,e=>({name:e.content,id:e.value})),sortAlphabetically:!1}}]}}class pe{adaptDefinition(e){var t;const i=(0,u.get)(e,"propertiesByName",{});i.launchBehavior=null!==(t=i.launchBehavior)&&void 0!==t?t:o.RX_LAUNCH_BEHAVIOR.newWindow.value}}pe.\u0275fac=function(e){return new(e||pe)},pe.\u0275prov=n["\u0275\u0275defineInjectable"]({token:pe,factory:pe.\u0275fac,providedIn:"root"});class me{constructor(e,t,i,n){this.rxViewActionDefinitionAdapterRegistryService=e,this.rxViewActionRegistryService=t,this.rxLaunchUrlViewActionService=i,this.rxLaunchUrlActionDefinitionAdapterService=n,this.rxViewActionRegistryService.register({name:"rxLaunchUrlAction",label:"Launch URL",bundleId:r.RX_APPLICATION.platformBundleId,service:this.rxLaunchUrlViewActionService,designModel:ce,parameters:[{name:"url",label:"URL",enableExpressionEvaluation:!0,isRequired:!0},{name:"launchBehavior",label:"Launch behavior"}]}),e.registerRuntimeAdapter("rxLaunchUrlAction",this.rxLaunchUrlActionDefinitionAdapterService)}}me.\u0275fac=function(e){return new(e||me)(n["\u0275\u0275inject"](o.RxViewActionDefinitionAdapterRegistryService),n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](de),n["\u0275\u0275inject"](pe))},me.\u0275mod=n["\u0275\u0275defineNgModule"]({type:me}),me.\u0275inj=n["\u0275\u0275defineInjector"]({});class ue{execute(e){return e.component?(0,u.isFunction)(e.component.refresh)?e.component.refresh():(0,s.throwError)(new a.RxError("rxRefreshAction: target component does not support refresh API.")):(0,s.throwError)(new a.RxError("rxRefreshAction: component is not specified."))}}ue.\u0275fac=function(e){return new(e||ue)},ue.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ue,factory:ue.\u0275fac,providedIn:"root"});class fe{constructor(e,t){this.rxViewActionRegistryService=e,this.rxRefreshViewActionService=t,this.rxViewActionRegistryService.register({name:"rxRefreshAction",label:"Refresh",bundleId:r.RX_APPLICATION.platformBundleId,service:this.rxRefreshViewActionService,parameters:[{name:"component",label:"View/Component",enableExpressionEvaluation:!0,isRequired:!0,editor:d.ExpressionFormControlComponent}]})}}fe.\u0275fac=function(e){return new(e||fe)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](ue))},fe.\u0275mod=n["\u0275\u0275defineNgModule"]({type:fe}),fe.\u0275inj=n["\u0275\u0275defineInjector"]({});class he{execute(e){if((0,u.isFunction)(e.targetApi.save)){const t=(0,u.isFunction)(e.viewApi.close)?s.EMPTY.pipe((0,c.tap)({complete(){e.viewApi.close()}})):(0,s.throwError)(new a.RxError("rxSaveAction: target view does not support close API."));return(0,s.concat)(e.targetApi.save(e.closeAfterSave),e.closeAfterSave?t:s.EMPTY)}return(0,s.throwError)(new a.RxError("rxSaveAction: target view/component does not support save API."))}}he.\u0275fac=function(e){return new(e||he)},he.\u0275prov=n["\u0275\u0275defineInjectable"]({token:he,factory:he.\u0275fac,providedIn:"root"});class ge{constructor(e,t){this.rxViewActionRegistryService=e,this.rxSaveViewActionService=t,this.rxViewActionRegistryService.register({name:"rxSaveAction",label:"Save",bundleId:r.RX_APPLICATION.platformBundleId,service:this.rxSaveViewActionService,parameters:[{name:"targetApi",label:"View/Component",editor:d.ExpressionFormControlComponent,isRequired:!0,enableExpressionEvaluation:!0},{name:"closeAfterSave",label:"Close after save",editor:d.SwitchFormControlComponent,type:o.ViewComponentPropertyType.Boolean,designType:o.ViewComponentPropertyType.Boolean},{name:"viewApi",enableExpressionEvaluation:!0,defaultValue:"${view.api}"}]})}}ge.\u0275fac=function(e){return new(e||ge)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](he))},ge.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ge}),ge.\u0275inj=n["\u0275\u0275defineInjector"]({});class ve{execute(e){let t=(0,s.throwError)(new a.RxError("rxSetPropertyAction: component is not specified."));if(e.componentApi&&(0,u.isFunction)(e.componentApi.setProperty)&&e.propertyPath){const i=e.propertyPath.match(/^\$\{view\.components\.[0-9a-z-]+\.(.+)}$/);i&&i[1]&&(t=e.componentApi.setProperty(i[1],e.propertyValue))}return(0,s.isObservable)(t)?t:s.EMPTY}}ve.\u0275fac=function(e){return new(e||ve)},ve.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ve,factory:ve.\u0275fac});class ye extends l.RxViewActionExpressionConfigurator{constructor(e,t,i){super(e,t,i),this.configureForProperty({propertyPath:"propertyPath",dataDictionary$:e.get(l.RxViewDataDictionaryService).settablePropertiesDataDictionary$,operators:this.getOperatorRowsByGroup(r.ExpressionOperatorGroup.MathClient)})}}class xe extends l.RxViewDesignerActionModel{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.expressionConfigurator=new ye(this.injector,this.sandbox.descriptor.name,this.guid),this.sandbox.actionProperties$.pipe((0,c.take)(1)).subscribe(()=>this.sandbox.setActionPropertyEditorConfig(this.getActionEditorConfig())),this.sandbox.actionProperties$.pipe((0,c.pluck)("propertyPath"),(0,c.distinctUntilChanged)()).subscribe(e=>{let t=null;if(e&&e.length){const i=e.match(/\${view\.components\.([0-9a-z-]+)\..+}/);i&&i[1]&&(t=`\${view.components.${i[1]}.api}`)}this.sandbox.updateActionProperties({componentApi:t})})}static getInitialProperties(e){return Object.assign({componentApi:null,propertyPath:null,propertyValue:null},e)}getActionEditorConfig(){return[{name:"propertyPath",component:d.ExpressionFormControlComponent,options:{label:"Property path",dataDictionary$:this.expressionConfigurator.getDataDictionary("propertyPath"),operators:this.expressionConfigurator.getOperators("propertyPath"),isRequired:!0}},{name:"propertyValue",component:d.ExpressionFormControlComponent,options:{label:"Property value",dataDictionary$:this.expressionConfigurator.getDataDictionary("propertyValue"),operators:this.expressionConfigurator.getOperators("propertyValue")}}]}}class be{validate(e,t){return(0,s.of)(e.propertyPath&&!/\${view\.components\.([0-9a-z-]+)\..+}/.test(e.propertyPath)?[{type:"error",description:"Set property action: Property path is invalid.",propertyName:t}]:[])}}be.\u0275fac=function(e){return new(e||be)},be.\u0275prov=n["\u0275\u0275defineInjectable"]({token:be,factory:be.\u0275fac});class Ce{constructor(e,t,i){this.rxViewActionRegistryService=e,this.rxSetPropertyViewActionService=t,this.rxSetPropertyViewActionDesignManagerService=i,this.rxViewActionRegistryService.register({name:"rxSetPropertyAction",label:"Set property",bundleId:r.RX_APPLICATION.platformBundleId,service:this.rxSetPropertyViewActionService,designModel:xe,designManager:i,parameters:[{name:"componentApi",label:"Component API",enableExpressionEvaluation:!0},{name:"propertyPath",label:"Property path",isRequired:!0},{name:"propertyValue",enableExpressionEvaluation:!0}]})}}Ce.\u0275fac=function(e){return new(e||Ce)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](ve),n["\u0275\u0275inject"](be))},Ce.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ce}),Ce.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[ve,be]});class Se{constructor(e,t,i,n,o,r,a){this.rxApplicationLoaderService=e,this.rxBundleCacheService=t,this.rxJsonParserService=i,this.rxProcessDefinitionCacheService=n,this.domSanitizer=o,this.activeModalRef=r,this.rxUtilityModalsService=a,this.isProcessDesignerLoadingInProgress=!0,this.isDefinitionDirty=!1,this.context=r;const s=this.context.getData();localStorage.setItem("ProcessDesignerPaletteElements",s.paletteElements),this.iframeSrc=this.domSanitizer.bypassSecurityTrustResourceUrl(`/com.bmc.arsys.rx.innovationstudio/index.html#/app/bundle/${this.rxBundleCacheService.bundleId}/iprocess/${s.processDefinitionName?s.processDefinitionName:""}`)}onMessage(e){if(e.data){const t=this.rxJsonParserService.tryParseJson(e.data);if(t)switch(t.messageType){case r.RX_DESIGNER.messageTypes.designerLoaded:this.isProcessDesignerLoadingInProgress=!1;break;case r.RX_DESIGNER.messageTypes.afterSave:this.isDefinitionDirty=!1;break;case r.RX_DESIGNER.messageTypes.definitionStatusChanged:this.isDefinitionDirty=t.payload.isDirty;break;case r.RX_DESIGNER.messageTypes.closeDesigner:t.payload.processDefinitionName?this.isDefinitionDirty?this.rxUtilityModalsService.confirmUnsavedChanges().then(e=>{e&&this.closeProcessDesigner(t.payload.processDefinitionName)}):this.closeProcessDesigner(t.payload.processDefinitionName):this.isDefinitionDirty?this.rxUtilityModalsService.confirmUnsavedChanges().then(e=>{e&&this.context.dismiss(g.DismissReasons.CLOSE_BTN)}):this.context.dismiss(g.DismissReasons.CLOSE_BTN)}}}closeProcessDesigner(e){this.rxProcessDefinitionCacheService.clearCache([e]),this.context.close({processDefinitionName:e})}}Se.\u0275fac=function(e){return new(e||Se)(n["\u0275\u0275directiveInject"](r.RxApplicationLoaderService),n["\u0275\u0275directiveInject"](r.RxBundleCacheService),n["\u0275\u0275directiveInject"](a.RxJsonParserService),n["\u0275\u0275directiveInject"](S.RxProcessDefinitionCacheService),n["\u0275\u0275directiveInject"](w.DomSanitizer),n["\u0275\u0275directiveInject"](g.ActiveModalRef),n["\u0275\u0275directiveInject"](b.RxUtilityModalsService))},Se.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Se,selectors:[["rx-process-designer-frame"]],hostBindings:function(e,t){1&e&&n["\u0275\u0275listener"]("message",function(e){return t.onMessage(e)},!1,n["\u0275\u0275resolveWindow"])},decls:2,vars:2,consts:[["id","rx-application-loader-container","class","position-absolute w-100",4,"ngIf"],[1,"h-100",3,"src"],["id","rx-application-loader-container",1,"position-absolute","w-100"],[1,"rx-application-loader"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,R,2,0,"div",0),n["\u0275\u0275element"](1,"iframe",1)),2&e&&(n["\u0275\u0275property"]("ngIf",t.isProcessDesignerLoadingInProgress),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("src",t.iframeSrc,n["\u0275\u0275sanitizeResourceUrl"]))},directives:[y.NgIf],styles:["[_nghost-%COMP%]{height:100vh}"]});class we{constructor(e,t){this.adaptModalService=e,this.rxProcessDefinitionCacheService=t}execute(e){return e.processDefinitionName?this.rxProcessDefinitionCacheService.getProcessDefinition(e.processDefinitionName).pipe((0,c.switchMap)(()=>this.openModal(e))):(0,s.defer)(()=>(0,s.from)(this.openModal(e)))}openModal(e){return this.adaptModalService.open({content:Se,size:o.OpenViewActionModalSize.FullSize,data:e})}}we.\u0275fac=function(e){return new(e||we)(n["\u0275\u0275inject"](g.AdaptModalService),n["\u0275\u0275inject"](S.RxProcessDefinitionCacheService))},we.\u0275prov=n["\u0275\u0275defineInjectable"]({token:we,factory:we.\u0275fac,providedIn:"root"});class De extends d.ValueAccessor{constructor(e,t,i,n,o){super(),this.rxDesignerStencilBuilder=e,this.rxJsonParserService=t,this.rxProcessElementsService=i,this.renderer=n,this.translateService=o,this.selection=[],this.destroyed$=new s.ReplaySubject(1)}ngOnInit(){const e=this.innerValue;this.selectedPaletteElements="*"===e?"*":this.rxJsonParserService.tryParseJson(e,null),this.rxDesignerStencilBuilder.buildElementsTree(this.rxProcessElementsService.getProcessElements(),S.RX_PROCESS_DEFINITION.standardProcessElementGroups).pipe((0,c.take)(1)).subscribe(e=>{(0,u.forEach)(e,e=>{var t;e.expanded=!0,e.allChildElementsSelected=!0,(null===(t=this.selectedPaletteElements)||void 0===t?void 0:t.length)&&((0,u.forEach)(e.children,t=>{"*"===this.selectedPaletteElements||(0,u.some)(this.selectedPaletteElements,e=>(0,u.isEqual)(e,t.value))?this.selection.push(t):e.allChildElementsSelected=!1}),e.allChildElementsSelected&&this.selection.push(e))}),this.processElementsTree=[{label:this.translateService.instant("com.bmc.arsys.rx.client.process-designer.all-elements.label"),expanded:!0,children:e}],this.stencilElements=(0,u.flatten)((0,u.map)(e,"children")),"*"===this.selectedPaletteElements&&(this.selection.push(...this.processElementsTree),this.selectedPaletteElements=(0,u.map)(this.stencilElements,"value")),this.updatePickerFakeInputValue()})}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}onSelectionChange(){this.selectedPaletteElements=this.selection.filter(e=>!e.children).map(e=>e.value),0===this.selectedPaletteElements.length?(this.selectedPaletteElements=null,this.value=null):this.stencilElements.length===this.selectedPaletteElements.length?this.value="*":this.value=JSON.stringify(this.selectedPaletteElements),this.updatePickerFakeInputValue()}updatePickerFakeInputValue(){(0,u.isEmpty)(this.selectedPaletteElements)?this.selectedPaletteElementsByLabel="":this.stencilElements.length===this.selectedPaletteElements.length?this.selectedPaletteElementsByLabel=this.translateService.instant("com.bmc.arsys.rx.client.common.all.label"):1===this.selectedPaletteElements.length?this.selectedPaletteElementsByLabel=this.translateService.instant("com.bmc.arsys.rx.client.process-designer.one-element-selected.label"):this.selectedPaletteElementsByLabel=this.translateService.instant("com.bmc.arsys.rx.client.process-designer.many-elements-selected.label",{count:this.selectedPaletteElements.length})}clearDefinition(e){e.stopPropagation(),this.selection=[],this.selectedPaletteElements=null,this.selectedPaletteElementsByLabel="",this.value=null}setDropdownWidth(){setTimeout(()=>{const e=this.renderer.selectRootElement(this.dropdownButton.nativeElement,!0);this.dropdownWidth=Math.max(e.clientWidth)+2})}}De.\u0275fac=function(e){return new(e||De)(n["\u0275\u0275directiveInject"](r.RxDesignerStencilBuilder),n["\u0275\u0275directiveInject"](a.RxJsonParserService),n["\u0275\u0275directiveInject"](S.RxProcessElementsService),n["\u0275\u0275directiveInject"](n.Renderer2),n["\u0275\u0275directiveInject"](x.TranslateService))},De.\u0275cmp=n["\u0275\u0275defineComponent"]({type:De,selectors:[["rx-process-designer-element-picker"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](I,7),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.dropdownButton=e.first)}},inputs:{options:"options"},features:[n["\u0275\u0275ProvidersFeature"]([{provide:C.NG_VALUE_ACCESSOR,useExisting:De,multi:!0}]),n["\u0275\u0275InheritDefinitionFeature"]],decls:9,vars:8,consts:[[3,"label"],["adaptDropdown","","appendToBody","true","autoClose","outside","placement","bottom-left",1,"dropdown",3,"onOpen"],["adaptDropdownToggle","","rx-id","toggle-button","type","button",1,"btn","btn-secondary","d-flex","text-center","w-100"],["dropdownButton",""],[1,"rx-selected-item","text-left","flex-grow-1"],["rx-id","clear-button","class","d-icon-cross_adapt btn-link",3,"click",4,"ngIf"],["adaptDropdownMenu","",1,"dropdown-menu","px-3"],[3,"value","selectionMode","selection","selectionChange"],["rx-id","clear-button",1,"d-icon-cross_adapt","btn-link",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-rx-control-label",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275listener"]("onOpen",function(){return t.setDropdownWidth()}),n["\u0275\u0275elementStart"](2,"button",2,3),n["\u0275\u0275elementStart"](4,"span",4),n["\u0275\u0275text"](5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](6,F,1,0,"span",5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](7,"div",6),n["\u0275\u0275elementStart"](8,"adapt-tree",7),n["\u0275\u0275listener"]("selectionChange",function(e){return t.selection=e})("selectionChange",function(){return t.onSelectionChange()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("label",t.options.label),n["\u0275\u0275advance"](5),n["\u0275\u0275textInterpolate"](t.selectedPaletteElementsByLabel),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.value),n["\u0275\u0275advance"](1),n["\u0275\u0275styleProp"]("width",t.dropdownWidth,"px"),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("value",t.processElementsTree)("selectionMode","checkbox")("selection",t.selection))},directives:[g.AdaptRxControlLabelComponent,g.AdaptDropdownDirective,g.AdaptDropdownToggleDirective,y.NgIf,g.AdaptDropdownMenuDirective,g.AdaptTreeComponent],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.rx-selected-item[_ngcontent-%COMP%]{min-height:20px}span[rx-id=clear-button][_ngcontent-%COMP%]{cursor:pointer;margin-right:5px}span[rx-id=clear-button][_ngcontent-%COMP%]:not(:hover){color:#313538}.dropdown-menu[_ngcontent-%COMP%]{height:400px}']});class Re{}Re.\u0275fac=function(e){return new(e||Re)},Re.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Re,declarations:[De],imports:[y.CommonModule,C.FormsModule,g.AdaptRxCheckboxModule,g.AdaptDropdownModule,g.AdaptRxLabelModule,g.AdaptTreeModule],exports:[De]}),Re.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[y.CommonModule,C.FormsModule,g.AdaptRxCheckboxModule,g.AdaptDropdownModule.forRoot(),g.AdaptRxLabelModule,g.AdaptTreeModule]]});class Ie extends l.RxViewDesignerActionModel{constructor(e,t){super(e,t),this.sandbox=t,this.translateService=this.injector.get(x.TranslateService),this.sandbox.actionProperties$.pipe((0,c.take)(1)).subscribe(()=>{this.sandbox.setActionPropertyEditorConfig(this.getActionEditorConfig()),this.sandbox.setActionOutputDataDictionary([{label:this.translateService.instant("com.bmc.arsys.rx.client.common.process-definition-name.label"),expression:this.getOutputExpressionForPropertyPath("processDefinitionName")}])})}static getInitialProperties(e){return Object.assign({processDefinitionName:null,paletteElements:null},e)}getActionEditorConfig(){return[{name:"processDefinitionName",component:d.DefinitionPickerOrExpressionFormControlComponent,options:{label:this.translateService.instant("com.bmc.arsys.rx.client.common.process-definition-name.label"),definitionType:d.RxDefinitionPickerType.Process,dataDictionary$:this.expressionConfigurator.getDataDictionary(),operators:this.expressionConfigurator.getOperators()}},{name:"paletteElements",component:De,options:{label:"Available palette elements"}}]}}class Fe{constructor(e){this.rxDefaultExpressionEvaluatorService=e}evaluate(e,t){let i=e;return m.RX_RECORD_DEFINITION.validFullDefinitionName.test(e)||(i=this.rxDefaultExpressionEvaluatorService.evaluate(e,t)),i}parseExpression(e){let t;return m.RX_RECORD_DEFINITION.validFullDefinitionName.test(e)||(t=this.rxDefaultExpressionEvaluatorService.parseExpression(e)),t}}Fe.\u0275fac=function(e){return new(e||Fe)(n["\u0275\u0275inject"](o.RxDefaultExpressionEvaluatorService))},Fe.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Fe,factory:Fe.\u0275fac});class Ee{constructor(e,t,i){this.rxViewActionRegistryService=e,this.rxLaunchProcessDesignerActionService=t,this.rxLaunchProcessDesignerExpressionActionEvaluatorService=i,this.rxViewActionRegistryService.register({name:"rxLaunchProcessDesignerAction",label:"Launch process designer",bundleId:r.RX_APPLICATION.platformBundleId,service:this.rxLaunchProcessDesignerActionService,designModel:Ie,parameters:[{name:"processDefinitionName",label:"Process definition name",type:o.ViewComponentPropertyType.String,enableExpressionEvaluation:!0,evaluatorService:this.rxLaunchProcessDesignerExpressionActionEvaluatorService},{name:"paletteElements",label:"Available palette elements",type:o.ViewComponentPropertyType.String}]})}}Ee.\u0275fac=function(e){return new(e||Ee)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](we),n["\u0275\u0275inject"](Fe))},Ee.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ee,declarations:[Se],imports:[y.CommonModule,S.RxProcessApiModule,d.RxIframeModule]}),Ee.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[Fe],imports:[[y.CommonModule,S.RxProcessApiModule,d.RxIframeModule]]});class Me{execute(){return s.EMPTY}}Me.\u0275fac=function(e){return new(e||Me)},Me.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Me,factory:Me.\u0275fac});class Ae{validate(e,t){return(0,s.of)([{type:"error",description:`Unknown action: ${e.name}`,propertyName:t}])}}Ae.\u0275fac=function(e){return new(e||Ae)},Ae.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Ae,factory:Ae.\u0275fac});class Oe extends l.RxViewDesignerActionModel{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.sandbox.actionProperties$.pipe((0,c.take)(1)).subscribe(e=>{this.sandbox.setActionPropertyEditorConfig(this.getActionEditorConfig(e))})}getActionEditorConfig(e){return(0,u.keys)(e).map(e=>({name:e,component:d.TextFormControlComponent,isDisabled:!0,options:{label:e}}))}}class Pe{constructor(e,t,i){this.rxViewActionRegistryService=e,this.rxUnknownViewActionService=t,this.rxUnknownViewActionDesignManager=i,this.rxViewActionRegistryService.register({name:"rxUnknownViewAction",label:"Unknown",bundleId:r.RX_APPLICATION.platformBundleId,designModel:Oe,designManager:this.rxUnknownViewActionDesignManager,service:this.rxUnknownViewActionService,parameters:[],hidden:!0})}}Pe.\u0275fac=function(e){return new(e||Pe)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](Me),n["\u0275\u0275inject"](Ae))},Pe.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Pe}),Pe.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[Me,Ae]});class Te{}Te.\u0275fac=function(e){return new(e||Te)},Te.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Te,imports:[P,U,X,H,J,Z,oe,le,Ee,me,G,fe,ge,Ce,Pe]}),Te.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[P,U,X,H,J,Z,oe,le,Ee,me,G,fe,ge,Ce,Pe]]});class Ve{constructor(e,t,i){this.viewDesignerFacade=e,this.rxRecordGridDesignUtilsService=t,this.rxRecordGridFilterHelperService=i;const n=this.viewDesignerFacade.getComponentsByType(o.RxViewComponentType.Action).pipe((0,c.map)(e=>e.filter(e=>e.data.name===E)),(0,c.shareReplay)({refCount:!0,bufferSize:1})),r=n.pipe((0,c.map)(e=>e.map(e=>A.extractGuidFromExpression(e.data.targetApi))),(0,c.map)(e=>(0,u.sortBy)((0,u.uniq)((0,u.compact)(e)))),(0,c.filter)(e=>Boolean(e.length)),(0,c.distinctUntilChanged)((e,t)=>(0,u.isEqual)(e,t)),(0,c.shareReplay)({refCount:!0,bufferSize:1})),a=r.pipe((0,c.switchMap)(e=>{const t=e.map(e=>this.getActionsToUpdate(e,n));return(0,s.merge)(...t)})),l=r.pipe((0,c.switchMap)(e=>{const t=e.map(e=>this.getGridDefinitionChanges(e).pipe((0,c.skip)(1),(0,c.map)(()=>e),(0,c.withLatestFrom)(n),(0,c.map)(([e,t])=>t.filter(t=>t.data.targetApi.includes(e)).map(e=>{const t=(0,u.cloneDeep)(e);return t.data.filters=null,{component:t,children:[]}}))));return(0,s.merge)(...t)}));(0,s.merge)(l,a).subscribe(e=>{e.forEach(e=>{this.viewDesignerFacade.updateComponentProperties(e.component.guid,e.component.data),this.viewDesignerFacade.setChildren(e.component.guid,e.children)})})}getActionsToUpdate(e,t){return this.getGridColumnChanges(e).pipe((0,c.skip)(1),(0,c.withLatestFrom)(t),(0,c.switchMap)(([e,t])=>{const i=t.filter(t=>t.data.targetApi.includes(e.guid)).map(e=>this.viewDesignerFacade.getChildComponents(e.guid).pipe((0,c.map)(t=>Object.assign(Object.assign({},(0,u.cloneDeep)(e)),{children:t})),(0,c.take)(1)));return(0,s.forkJoin)(i).pipe((0,c.map)(t=>{const i=e.columns.map(e=>e.fieldId);return t.reduce((e,t)=>{const n=this.getUpdatedFilterComponents((0,u.omit)(t,"children"),t.children,i);return n?e.concat(n):e},[])}))}))}getGridColumnChanges(e){return this.viewDesignerFacade.getComponentPropertyValue(e,"columns").pipe((0,c.filter)(e=>Array.isArray(e)),(0,c.map)(t=>({guid:e,columns:t.map(e=>({fieldId:e.fieldId,namedFilterOptions:e.namedFilterOptions}))})),(0,c.distinctUntilChanged)(u.isEqual))}getGridDefinitionChanges(e){return this.viewDesignerFacade.getComponentPropertyValue(e,"recordDefinitionName").pipe((0,c.distinctUntilChanged)())}getUpdatedFilterComponents(e,t,i){const n=t.filter(e=>i.includes(e.data.fieldId));if(n.length!==t.length){const t=this.rxRecordGridDesignUtilsService.getBasicRecordGridFiltersFromChildData(n),i=this.rxRecordGridFilterHelperService.getRecordGridFilterDataFromPredefinedFilter(e.data.filters,t);return e.data.filters=i?this.rxRecordGridFilterHelperService.denormalizeFilterString(JSON.stringify(i),t):null,{component:e,children:n}}return null}validate(e,t){const i=e.filters||(0,u.includes)([o.ApplyGridFilterMode.Begin,o.ApplyGridFilterMode.End,o.ApplyGridFilterMode.Clear],e.mode)?null:{type:"error",description:"Apply grid filter action: Filter is required",propertyName:t};return(0,s.of)(e.targetApi).pipe((0,c.map)(e=>A.extractGuidFromExpression(e)),(0,c.switchMap)(e=>e?this.viewDesignerFacade.getComponent(e):(0,s.of)(null)),(0,c.take)(1),(0,c.map)(n=>{const o=[];return e.targetApi&&(null==n?void 0:n.type)!==p.RX_RECORD_GRID.type&&o.push({type:"error",description:"Apply grid filter action: Record grid expression must point to a record grid.",propertyName:t}),e.targetApi&&!o.length&&i&&o.push(i),o}))}}Ve.\u0275fac=function(e){return new(e||Ve)(n["\u0275\u0275inject"](l.ViewDesignerFacade),n["\u0275\u0275inject"](p.RxRecordGridDesignUtilsService),n["\u0275\u0275inject"](p.RxRecordGridFilterHelperService))},Ve.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Ve,factory:Ve.\u0275fac});class Ne{constructor(e,t){this.rxViewActionRegistryService=e,this.rxApplyGridFilterViewActionDesignManagerService=t,this.rxViewActionRegistryService.registerDesignManager(E,t)}}Ne.\u0275fac=function(e){return new(e||Ne)(n["\u0275\u0275inject"](o.RxViewActionRegistryService),n["\u0275\u0275inject"](Ve))},Ne.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ne}),Ne.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[Ve]});class ke{}ke.\u0275fac=function(e){return new(e||ke)},ke.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ke,imports:[Te,Ne]}),ke.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Te,Ne]]})},"./node_modules/@helix/platform/fesm2015/helix-platform-view-components.js":(e,t,i)=>{"use strict";i.r(t),i.d(t,{ActionButtonComponent:()=>ws,ActionButtonDesignComponent:()=>bs,ActionButtonDesignModule:()=>Ss,ActionButtonIconAlignment:()=>gs,ActionButtonModule:()=>Ds,ActionButtonSize:()=>hs,ActionButtonStyle:()=>us,AssociationDesignModule:()=>Fl,AssociationManagerFactory:()=>dl,AssociationModule:()=>vl,AssociationRegistrationModule:()=>Ol,AttachmentFieldComponent:()=>_l,AttachmentFieldDesignComponent:()=>Vl,AttachmentFieldDesignModule:()=>Nl,AttachmentFieldModule:()=>$l,AttachmentFieldRegistrationModule:()=>Ll,BaseRecordEditorFieldComponent:()=>kl,BaseRecordEditorFieldDesign:()=>Pl,BooleanFieldComponent:()=>Wl,BooleanFieldDesignComponent:()=>zl,BooleanFieldDesignModule:()=>Xl,BooleanFieldModule:()=>Hl,BooleanFieldRegistrationModule:()=>Ql,ButtonBarComponent:()=>Ms,ButtonBarDesignComponent:()=>Ps,ButtonBarDesignModel:()=>Os,ButtonBarDesignModule:()=>Ts,ButtonBarModule:()=>As,ChatbotUserMappingComponent:()=>su,ChatbotUserMappingRegistrationModule:()=>lu,ColumnSortDirection:()=>jc,ContainerComponent:()=>Vs,ContainerDesignComponent:()=>Gs,ContainerDesignModule:()=>qs,ContainerModule:()=>ks,ContainerRowWrap:()=>_s,DateFieldComponent:()=>ed,DateFieldDesignComponent:()=>Kl,DateFieldDesignModule:()=>Yl,DateFieldModule:()=>td,DateFieldRegistrationModule:()=>id,DateTimeFieldComponent:()=>sd,DateTimeFieldDesignComponent:()=>od,DateTimeFieldDesignModule:()=>rd,DateTimeFieldModule:()=>ld,DateTimeFieldRegistrationModule:()=>dd,DecimalFieldComponent:()=>fd,DecimalFieldDesignComponent:()=>pd,DecimalFieldDesignModule:()=>md,DecimalFieldModule:()=>hd,DecimalFieldRegistrationModule:()=>gd,DeprecatedActionButtonStyle:()=>fs,ExtensionContainerDesignComponent:()=>gc,ExtensionContainerDesignModule:()=>vc,ExtensionContainerRegistrationModule:()=>yc,ExtensionContainerSectionComponent:()=>pc,FieldComponentsModule:()=>Oc,GainsightAdminOptInRegistrationModule:()=>Nu,IframeLoginEventComponent:()=>cu,IframeLoginEventRegistrationModule:()=>pu,ImageComponent:()=>$m,ImageDesignComponent:()=>Nm,ImageDesignModule:()=>km,ImageModule:()=>Lm,IntegerFieldComponent:()=>ud,IntegerFieldDesignComponent:()=>yd,IntegerFieldDesignModule:()=>xd,IntegerFieldModule:()=>bd,IntegerFieldRegistrationModule:()=>Cd,LocalizedCharacterFieldComponent:()=>Rc,LocalizedCharacterFieldRegistrationModule:()=>Ac,PageComponent:()=>Jp,PageComponentDefinitionAdapterService:()=>Tm,PageDesignComponent:()=>Om,PageDesignModule:()=>Pm,PageModule:()=>Vm,RECORD_EDITOR:()=>Us,RX_ASSOCIATION:()=>ml,RX_BASE_FIELD_PROPERTIES:()=>El,RX_RECORD_GRID:()=>Nc,RX_RECORD_GRID_DESIGN:()=>Qc,RecordEditorComponent:()=>sl,RecordEditorDesignComponent:()=>Ys,RecordEditorDesignModule:()=>el,RecordEditorMode:()=>zs,RecordEditorModule:()=>cl,RecordEditorState:()=>Xs,RecordGridColumnAlignment:()=>Tc,RecordGridColumnEditorControlComponent:()=>ep,RecordGridColumnEditorModalComponent:()=>Zc,RecordGridComponent:()=>om,RecordGridDesignComponent:()=>qp,RecordGridDesignDefinitionMode:()=>np,RecordGridDesignModule:()=>Qp,RecordGridFilterMode:()=>ip,RecordGridFilterSelectControlComponent:()=>bp,RecordGridFilterSelectControlModule:()=>Op,RecordGridModule:()=>sm,RichTextComponent:()=>lm,RichTextDesignComponent:()=>fm,RichTextDesignModule:()=>gm,RichTextModule:()=>pm,RichTextareaFieldComponent:()=>Sc,RichTextareaFieldDesignComponent:()=>bc,RichTextareaFieldDesignModule:()=>Cc,RichTextareaFieldModule:()=>wc,RichTextareaFieldRegistrationModule:()=>Dc,RowSelectionMode:()=>op,RxAssociationComponent:()=>hl,RxAssociationDesignComponent:()=>Rl,RxAssociationEditingMode:()=>ul,RxAssociationManagerService:()=>tl,RxDefaultRecordEditorInputType:()=>pl,RxExtensionContainerComponent:()=>dc,RxExtensionContainerModule:()=>fc,RxLocalizedCharacterFieldModule:()=>Ic,RxRecordEditorUtilsService:()=>il,RxRecordGridAdvancedFilterValue:()=>rp,RxRecordGridAdvancedFilteringService:()=>ap,RxRecordGridDesignUtilsService:()=>Lp,RxRecordGridFilterHelperService:()=>sp,RxRecordGridFilterSelectHelperService:()=>Pp,RxRecordGridFilterService:()=>lp,RxRecordGridQueryExpressionEvaluatorService:()=>am,RxRecordGridUtilsService:()=>kc,RxTabContainerComponent:()=>Cm,RxTabPanelComponent:()=>Sm,RxTabPanelModule:()=>Rm,SelectGroupComponent:()=>Td,SelectGroupComponentDefinitionAdapterService:()=>Nd,SelectGroupDesignComponent:()=>$d,SelectGroupDesignModel:()=>Bd,SelectGroupFieldComponent:()=>Vd,SelectGroupModule:()=>kd,SelectGroupRegistrationModule:()=>Gd,SelectionFieldComponent:()=>Ad,SelectionFieldDesignComponent:()=>Id,SelectionFieldDesignModule:()=>Fd,SelectionFieldModule:()=>Od,SelectionFieldRegistrationModule:()=>Pd,ServiceListComponent:()=>xm,ServiceListDesignComponent:()=>vm,ServiceListDesignModule:()=>ym,ServiceListModule:()=>bm,TabPanelDesignModule:()=>Mm,TextFieldComponent:()=>Wd,TextFieldDesignComponent:()=>Ud,TextFieldDesignModule:()=>zd,TextFieldExpressionConfigurator:()=>Xd,TextFieldModule:()=>Hd,TextFieldMultiSelectionType:()=>Md,TextFieldRegistrationModule:()=>Qd,TextareaFieldComponent:()=>Zd,TextareaFieldDesignComponent:()=>Kd,TextareaFieldDesignModule:()=>Yd,TextareaFieldModule:()=>ec,TextareaFieldRegistrationModule:()=>tc,TimeFieldComponent:()=>ac,TimeFieldDesignComponent:()=>nc,TimeFieldDesignModule:()=>oc,TimeFieldModule:()=>sc,TimeFieldRegistrationModule:()=>lc,UploaderFactory:()=>Bl,ViewComponentsModule:()=>ku});var n=i("./node_modules/@angular/core/fesm2015/core.js"),o=i("rxjs"),r=i("./node_modules/rxjs/_esm2015/operators/index.js"),a=i("./node_modules/@helix/platform/fesm2015/helix-platform-record-api.js"),s=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-api.js"),l=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-components.js"),d=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-api.js"),c=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-designer.js"),p=i("./node_modules/@ngx-translate/core/fesm2015/ngx-translate-core.js"),m=i("lodash"),u=i("./node_modules/@bmc-ux/adapt-angular/fesm2015/bmc-ux-adapt-angular.js"),f=i("./node_modules/@angular/common/fesm2015/common.js"),h=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-runtime.js"),g=i("./node_modules/css-element-queries/index.js"),v=i("./node_modules/@helix/platform/fesm2015/helix-platform-utils.js"),y=i("./node_modules/angular-split/fesm2015/angular-split.js"),x=i("./node_modules/@angular/cdk/fesm2015/drag-drop.js"),b=i("./node_modules/@angular/forms/fesm2015/forms.js"),C=i("./node_modules/@helix/platform/fesm2015/helix-platform-association-api.js"),S=i("./node_modules/@helix/platform/fesm2015/helix-platform-ui-kit.js"),w=i("./node_modules/tslib/tslib.es6.js"),D=i("./node_modules/moment-es6/index.js"),R=i("./node_modules/bignumber.js/bignumber.js"),I=i.n(R),F=i("./node_modules/@bmc-ux/obsolete/fesm2015/bmc-ux-adapt-obsolete.js"),E=i("./node_modules/@helix/platform/fesm2015/helix-platform-named-list-api.js"),M=i("./node_modules/ckeditor4-angular/fesm2015/ckeditor4-angular.js"),A=i("./node_modules/@bmc-ux/adapt-table/fesm2015/bmc-ux-adapt-table.js"),O=i("./node_modules/file-saver/dist/FileSaver.min.js"),P=i("./node_modules/@angular/router/fesm2015/router.js"),T=i("./node_modules/@angular/platform-browser/fesm2015/platform-browser.js"),V=i("./node_modules/@angular/common/fesm2015/http.js");const N=function(e,t){return[e,t]};function k(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",1),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().api.click(t)}),n["\u0275\u0275elementStart"](1,"span"),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("btn-type",e.buttonType)("ngClass",n["\u0275\u0275pureFunction2"](5,N,e.state.icon,e.state.cls))("disabled",e.isDisabled)("size",e.state.size),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.state.buttonLabel)}}function j(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",1),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().api.click(t)}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("disabled",e.isDisabled),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.state.label,"\n")}}const _=["dropdownToggle"],B=["buttonItems"],$=function(e){return{"nav-item--hidden":e}};function L(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",4),n["\u0275\u0275element"](1,"rx-runtime-view-canvas-item",5,6),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](2,$,e.showInDropdown)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("layout",e)}}function G(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-button-bar-dropdown-item-component",13),2&e){const e=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275property"]("config",e.config)("runtimeViewModelApi",e.runtimeViewModelApi)("guid",e.guid)}}function q(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,G,1,3,"rx-button-bar-dropdown-item-component",12),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.showInDropdown)}}const U=function(){return["bottom-right","bottom-left","bottom","top-right","top-left","top","auto"]};function z(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",7),n["\u0275\u0275element"](1,"button",8,9),n["\u0275\u0275elementStart"](3,"div",10),n["\u0275\u0275template"](4,q,2,1,"ng-container",11),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("placement",n["\u0275\u0275pureFunction0"](5,U)),n["\u0275\u0275advance"](1),n["\u0275\u0275attribute"]("id","rx-"+e.guid),n["\u0275\u0275advance"](2),n["\u0275\u0275attribute"]("aria-labelledby","rx-"+e.guid),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.childLayouts)("ngForTrackBy",e.trackByFn)}}function X(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",1),n["\u0275\u0275template"](1,L,3,4,"div",2),n["\u0275\u0275template"](2,z,5,6,"div",3),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngClass",e.alignClass),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.childLayouts)("ngForTrackBy",e.trackByFn),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isDropdownVisible)}}function W(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"as-split-area",2),n["\u0275\u0275elementStart"](1,"rx-canvas-item-column",3),n["\u0275\u0275listener"]("dropListDropped",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onDropListDropped(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=t.index,o=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("isReadOnly",o.isReadOnly)("colIndex",i)("column",e)("layout",o.layout)}}function H(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",15),n["\u0275\u0275elementStart"](1,"label"),n["\u0275\u0275elementStart"](2,"input",16),n["\u0275\u0275listener"]("ngModelChange",function(t){const i=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).selectedFieldIdsModel[i.id]=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).updateApplyButtonDisabledStatus()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"span",17),n["\u0275\u0275text"](4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngModel",i.selectedFieldIdsModel[e.id]),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.name)}}function Q(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",11),n["\u0275\u0275elementStart"](1,"div",12),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"adapt-button",13),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"]().select(t.groupLabel)}),n["\u0275\u0275text"](4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](5,H,5,2,"div",14),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",e.groupLabel," "),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",e.selectAllFieldsInGroupButtonLabel," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.fields)("ngForTrackBy",i.trackById)}}function J(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275text"](1,"No Fields Found"),n["\u0275\u0275elementEnd"]())}const K=["openModalButton"];function Y(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span",7),n["\u0275\u0275text"](1,"No fields added."),n["\u0275\u0275elementEnd"]())}function Z(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"span",13),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"]().removeField(t.guid)}),n["\u0275\u0275elementEnd"]()}}function ee(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",8),n["\u0275\u0275elementStart"](1,"div"),n["\u0275\u0275elementStart"](2,"div",9),n["\u0275\u0275text"](3),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"div",10),n["\u0275\u0275elementStart"](5,"small"),n["\u0275\u0275text"](6),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](7,"div",11),n["\u0275\u0275template"](8,Z,1,0,"span",12),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate"](e.label),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate"](e.componentName),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!i.options.isDisabled)}}function te(e,t){1&e&&n["\u0275\u0275element"](0,"adapt-empty-state",2)}function ie(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",3),n["\u0275\u0275element"](1,"div",4),n["\u0275\u0275elementStart"](2,"span"),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate"](n["\u0275\u0275pipeBind1"](4,1,"com.bmc.arsys.rx.client.common.loading-data")))}function ne(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.view-components.record-editor.invalid-record.message"),"\n"))}function oe(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",10),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).switchToEditState()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.common.edit.label")," "))}function re(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",11),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onSaveClick()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("disabled",e.isSaveButtonDisabled()),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.common.save.label")," ")}}function ae(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",12),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onCancelClick()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.common.cancel.label")," "))}function se(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",5),n["\u0275\u0275elementStart"](1,"div",6),n["\u0275\u0275template"](2,oe,3,3,"button",7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](3,"rx-runtime-view-canvas-outlet"),n["\u0275\u0275template"](4,re,3,4,"button",8),n["\u0275\u0275template"](5,ae,3,3,"button",9),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",e.isEditStateAvailable()),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",e.isSaveButtonAvailable()),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isCancelButtonAvailable())}}function le(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span",8),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e.label)}}function de(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span"),n["\u0275\u0275text"](1,": "),n["\u0275\u0275elementEnd"]())}const ce=function(e){return{"font-weight-bold":e}};function pe(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"li",4),n["\u0275\u0275template"](1,le,2,1,"span",5),n["\u0275\u0275template"](2,de,2,0,"span",6),n["\u0275\u0275elementStart"](3,"span",7),n["\u0275\u0275text"](4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](4,ce,!i.isEditableState())),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e.value)}}function me(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",9),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]();return t.config.onDelete(t.config.id)}),n["\u0275\u0275pipe"](1,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&n["\u0275\u0275attribute"]("aria-label",n["\u0275\u0275pipeBind1"](1,1,"com.bmc.arsys.rx.client.common.remove.label"))}function ue(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",2),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("label",e.label)("value",e.getAssociatedValue())}}function fe(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-rx-control-label",9),2&e){const e=n["\u0275\u0275nextContext"](3);n["\u0275\u0275property"]("label",e.label)}}function he(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275element"](1,"rx-runtime-view-canvas-outlet"),n["\u0275\u0275elementEnd"]())}function ge(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",12),n["\u0275\u0275element"](1,"rx-record-preview-card",13),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](5);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("config",e.existingPreviewConfigurations[0]||e.pendingPreviewConfigurations[0])}}function ve(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275template"](1,ge,2,1,"div",11),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](4);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.existingPreviewConfigurations.length||e.pendingPreviewConfigurations.length)}}function ye(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-record-preview-card",13),2&e){const e=t.$implicit;n["\u0275\u0275property"]("config",e)}}function xe(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",16),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](5).loadExistingAssociations()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.common.show-more.label")," "))}function be(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"div",12),n["\u0275\u0275template"](2,ye,1,1,"rx-record-preview-card",14),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](3,xe,3,3,"button",15),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](4);n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",e.existingPreviewConfigurations),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.associationManager.totalExistingCount>e.existingPreviewConfigurations.length+e.associationManager.deleted.length)}}function Ce(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"div",3),n["\u0275\u0275template"](2,ve,2,1,"div",5),n["\u0275\u0275template"](3,be,4,2,"div",10),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](3);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngSwitch",e.associationManager.cardinalityType),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngSwitchCase",e.associationManager.cardinalityTypes.One)}}function Se(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-record-preview-card",13),2&e){const e=t.$implicit;n["\u0275\u0275property"]("config",e)}}function we(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",16),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](5).loadExistingAssociations()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.common.show-more.label")," "))}const De=function(e){return{count:e}};function Re(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",19),n["\u0275\u0275elementStart"](1,"div",20),n["\u0275\u0275elementStart"](2,"span",21),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275pipe"](5,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](6,"button",22),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](4).deleteAllExisting()}),n["\u0275\u0275text"](7),n["\u0275\u0275pipe"](8,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](9,"div",12),n["\u0275\u0275template"](10,Se,1,1,"rx-record-preview-card",14),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](11,we,3,3,"button",15),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](4);n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",e.associationManager.totalExistingCount>1?n["\u0275\u0275pipeBind2"](4,5,"com.bmc.arsys.rx.client.view-components.record-editor.association.total-items.label",n["\u0275\u0275pureFunction1"](12,De,e.associationManager.totalExistingCount)):n["\u0275\u0275pipeBind1"](5,8,"com.bmc.arsys.rx.client.view-components.record-editor.association.single-item.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("hidden",!e.areActionsAvailable||e.isDisabled),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](8,10,"com.bmc.arsys.rx.client.view-components.record-editor.association.button.clear-all.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngForOf",e.existingPreviewConfigurations),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.associationManager.totalExistingCount>e.existingPreviewConfigurations.length+e.associationManager.deleted.length)}}function Ie(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-record-preview-card",13),2&e){const e=t.$implicit;n["\u0275\u0275property"]("config",e)}}function Fe(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",16),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](5).showPendingAssociations()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.common.show-more.label")," "))}function Ee(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",23),n["\u0275\u0275elementStart"](1,"div",24),n["\u0275\u0275elementStart"](2,"div",25),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",26),n["\u0275\u0275elementStart"](6,"span",21),n["\u0275\u0275text"](7),n["\u0275\u0275pipe"](8,"translate"),n["\u0275\u0275pipe"](9,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"button",22),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](4).deleteAllPending()}),n["\u0275\u0275text"](11),n["\u0275\u0275pipe"](12,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](13,"div",12),n["\u0275\u0275template"](14,Ie,1,1,"rx-record-preview-card",14),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](15,Fe,3,3,"button",15),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](4);n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](4,6,"com.bmc.arsys.rx.client.view-components.record-editor.association.pending-associations.label")," : "),n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate1"](" ",e.totalPendingCount>1?n["\u0275\u0275pipeBind2"](8,8,"com.bmc.arsys.rx.client.view-components.record-editor.association.total-items.label",n["\u0275\u0275pureFunction1"](15,De,e.totalPendingCount)):n["\u0275\u0275pipeBind1"](9,11,"com.bmc.arsys.rx.client.view-components.record-editor.association.single-item.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("hidden",!e.areActionsAvailable||e.isDisabled),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](12,13,"com.bmc.arsys.rx.client.view-components.record-editor.association.button.clear-all.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngForOf",e.getPendingPreviewConfigurations()),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.totalPendingCount>e.currentPendingCount)}}function Me(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275template"](1,Re,12,14,"div",17),n["\u0275\u0275template"](2,Ee,16,17,"div",18),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](3);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.existingPreviewConfigurations.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.pendingPreviewConfigurations.length)}}const Ae=function(e){return{"read-state":e}};function Oe(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",6),n["\u0275\u0275template"](1,fe,1,1,"adapt-rx-control-label",7),n["\u0275\u0275template"](2,he,2,0,"div",8),n["\u0275\u0275template"](3,Ce,4,2,"div",8),n["\u0275\u0275template"](4,Me,3,2,"div",8),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](6,Ae,e.isReadModeEnabled())),n["\u0275\u0275attribute"]("aria-label",e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isEditModeEnabled()||e.existingPreviewConfigurations.length>0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.areActionsAvailable),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isReadModeEnabled()),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isEditModeEnabled())}}function Pe(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275element"](1,"rx-select-with-pagination",27),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](3);n["\u0275\u0275attribute"]("aria-label",e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("formControl",e.formControl)("readonly",e.isDisabled)("label",e.label)("modelToViewValueAdapter",e.modelToViewValueAdapterFunc)("optionLoader",e.optionLoaderFunc)("viewToModelValueAdapter",e.viewToModelValueAdapterFunc)}}function Te(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275template"](1,Pe,2,7,"div",8),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isEditModeEnabled())}}function Ve(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",3),n["\u0275\u0275template"](1,Oe,5,8,"div",4),n["\u0275\u0275template"](2,Te,2,1,"div",5),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngSwitch",e.editingMode),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngSwitchCase","views"),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngSwitchCase","dropdown")}}function Ne(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",22),n["\u0275\u0275elementStart"](1,"div",23),n["\u0275\u0275listener"]("dblclick",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"](3).addField(t.data)}),n["\u0275\u0275elementStart"](2,"button",24),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"](3).addField(t.data)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"span",25),n["\u0275\u0275text"](4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275property"]("cdkDragData",e.data),n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate"](e.data.name)}}function ke(e,t){if(1&e&&n["\u0275\u0275template"](0,Ne,5,2,"div",21),2&e){const e=t.$implicit;n["\u0275\u0275property"]("ngIf",e.data)}}const je=function(){return["selected-fields"]};function _e(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",18),n["\u0275\u0275elementStart"](1,"adapt-tree",19),n["\u0275\u0275template"](2,ke,1,1,"ng-template",20),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("cdkDropListConnectedTo",n["\u0275\u0275pureFunction0"](3,je)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("value",e.availableFieldTreeNodes)("wrap",e.treeWrap)}}function Be(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",26),n["\u0275\u0275element"](1,"adapt-empty-state",27),n["\u0275\u0275elementEnd"]())}function $e(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",13),n["\u0275\u0275elementStart"](1,"div",3),n["\u0275\u0275elementStart"](2,"h4",4),n["\u0275\u0275text"](3,"Available fields"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"div",14),n["\u0275\u0275elementStart"](5,"div",15),n["\u0275\u0275template"](6,_e,3,4,"div",16),n["\u0275\u0275template"](7,Be,2,0,"ng-template",null,17,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275reference"](8),t=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](6),n["\u0275\u0275property"]("ngIf",t.availableFieldTreeNodes.length)("ngIfElse",e)}}function Le(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",28),n["\u0275\u0275elementStart"](1,"button",29),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().toggleOpen(!0)}),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",30),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().toggleOpen(!1)}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,2,"com.bmc.arsys.rx.client.common.expand-all.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,4,"com.bmc.arsys.rx.client.common.collapse-all.label")," "))}function Ge(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",39),n["\u0275\u0275elementStart"](1,"div",40),n["\u0275\u0275elementStart"](2,"button",41),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"](),o=i.$implicit,r=i.index,a=n["\u0275\u0275nextContext"]();return t.stopPropagation(),a.onMoveDown(o,r)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",42),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"](),o=i.$implicit,r=i.index,a=n["\u0275\u0275nextContext"]();return t.stopPropagation(),a.onMoveUp(o,r)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",43),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"]().onRemove(t)}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](),t=e.last,i=e.first;n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",t),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",i),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,3,"com.bmc.arsys.rx.client.common.remove.label")," ")}}function qe(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",31),n["\u0275\u0275elementStart"](1,"adapt-accordion-tab",32),n["\u0275\u0275listener"]("open",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!0})("close",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!1}),n["\u0275\u0275elementStart"](2,"div",33),n["\u0275\u0275elementStart"](3,"div",34),n["\u0275\u0275elementStart"](4,"div",35),n["\u0275\u0275elementStart"](5,"div",36),n["\u0275\u0275text"](6),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](7,Ge,7,5,"div",37),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](8,"adapt-rx-textfield",38),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.labelText=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().canSave=!0}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("cdkDragDisabled",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("isOpen",e.isOpen),n["\u0275\u0275advance"](4),n["\u0275\u0275property"]("title",i.fieldLabelsMap[e.data.fieldId]),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",i.fieldLabelsMap[e.data.fieldId]," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!i.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngModel",e.labelText)}}function Ue(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",26),n["\u0275\u0275element"](1,"adapt-empty-state",44),n["\u0275\u0275elementEnd"]())}function ze(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",45),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSave()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("disabled",!e.canSave),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.common.save.label")," ")}}function Xe(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"li",6),n["\u0275\u0275elementStart"](1,"strong",7),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",8),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).editField(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",9),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).removeField(t.guid)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",i.isDisabled),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",i.isDisabled)}}function We(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"ul",4),n["\u0275\u0275template"](1,Xe,5,3,"li",5),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.selectedFields)}}function He(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-canvas-item",1),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("interactive",!1)("layout",e)("isReadOnly",i.isReadOnly)}}function Qe(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span",18),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e.data.label)}}function Je(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span"),n["\u0275\u0275text"](1,": "),n["\u0275\u0275elementEnd"]())}function Ke(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"li",14),n["\u0275\u0275template"](1,Qe,2,1,"span",15),n["\u0275\u0275template"](2,Je,2,0,"span",16),n["\u0275\u0275elementStart"](3,"span",17),n["\u0275\u0275text"](4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.data.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.data.label),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.data.name)}}function Ye(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275elementStart"](2,"label",2),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",3),n["\u0275\u0275element"](6,"rx-canvas-outlet",4),n["\u0275\u0275elementStart"](7,"button",5),n["\u0275\u0275text"](8),n["\u0275\u0275pipe"](9,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](10,"adapt-empty-state",6),n["\u0275\u0275elementStart"](11,"div",7),n["\u0275\u0275elementStart"](12,"div",8),n["\u0275\u0275elementStart"](13,"div",9),n["\u0275\u0275elementStart"](14,"div",10),n["\u0275\u0275element"](15,"button",11),n["\u0275\u0275elementStart"](16,"ul",12),n["\u0275\u0275template"](17,Ke,5,3,"li",13),n["\u0275\u0275pipe"](18,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275attribute"]("aria-label",n["\u0275\u0275pipeBind1"](1,8,e.model.label$)),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate"](n["\u0275\u0275pipeBind1"](4,10,e.model.label$)),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("containerComponent",e.containerComponent),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("hidden",!e.hidePlaceholder),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](9,12,"com.bmc.arsys.rx.client.view-components.record-editor.association.button.clear-all.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("hidden",e.hidePlaceholder),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("hidden",!e.hidePlaceholder),n["\u0275\u0275advance"](6),n["\u0275\u0275property"]("ngForOf",n["\u0275\u0275pipeBind1"](18,14,e.model.displayedFields$))}}function Ze(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"div"),n["\u0275\u0275pipe"](2,"async"),n["\u0275\u0275element"](3,"adapt-rx-select",19),n["\u0275\u0275pipe"](4,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275attribute"]("aria-label",n["\u0275\u0275pipeBind1"](2,3,e.model.label$)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("label",n["\u0275\u0275pipeBind1"](4,5,e.model.label$))("disabled",!0)}}const et=function(){return[]};function tt(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-downloader",6),2&e){const e=n["\u0275\u0275nextContext"](4);n["\u0275\u0275property"]("config",e.readStateConfig)}}function it(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"label",4),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](3,tt,1,1,"adapt-downloader",5),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](3);n["\u0275\u0275attribute"]("aria-label",e.label),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.getDisplayValue())}}function nt(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,it,4,3,"div",3),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2),t=n["\u0275\u0275reference"](4);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.getDisplayValue())("ngIfElse",t)}}function ot(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,nt,2,2,"ng-container",3),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}const rt=function(e){return{"attachment-disabled":e}};function at(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-uploader",7),n["\u0275\u0275listener"]("removedFileFromQueue",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().removeAttachment(t)})("deletedFile",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().removeAttachment(t)})("afterFilesAdded",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().addAttachment(t)})("onBlur",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onBlur()}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](13,rt,e.isDisabled))("reusable",!0)("label",e.label)("readonly",e.isDisabled)("required",e.isRequired)("allowDeletion",!1)("uploadMode",e.mode)("selectionMode",e.selectionMode)("filesCount",e.filesCount)("maxFileSize",e.maxFileSize)("chunkSize",e.chunkSize)("texts",e.texts)("formControl",e.attachmentFormControl)}}function st(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",8),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("label",e.label)("value","-")}}function lt(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span",3),n["\u0275\u0275text"](1,"(required)"),n["\u0275\u0275elementEnd"]())}function dt(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275elementStart"](1,"div"),n["\u0275\u0275elementStart"](2,"strong"),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"async"),n["\u0275\u0275template"](5,lt,2,0,"span",1),n["\u0275\u0275pipe"](6,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](7,"adapt-rx-switch",2),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().booleanValue=t}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](4,4,e.model.label$)," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](6,6,e.model.isRequired$)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngModel",e.booleanValue)("disabled",!0)}}function ct(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275elementStart"](1,"adapt-rx-checkbox",4),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().booleanValue=t}),n["\u0275\u0275pipe"](2,"async"),n["\u0275\u0275pipe"](3,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngModel",e.booleanValue)("label",n["\u0275\u0275pipeBind1"](2,4,e.model.label$))("required",n["\u0275\u0275pipeBind1"](3,6,e.model.isRequired$))("disabled",!0)}}const pt=["booleanComponent"];function mt(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",3),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.label)("value",e.getDisplayValue())}}function ut(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,mt,1,2,"rx-read-only-field",2),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}function ft(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-boolean",4,5),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().booleanValue=t})("rxBlur",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onBlur()}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("hidden",e.isHidden)("label",e.label)("isDisabled",e.isDisabled)("required",e.isRequired)("shouldDisplayAsCheckbox",e.shouldDisplayAsCheckbox)("ngModel",e.booleanValue)}}function ht(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",3),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.label)("value",e.getDisplayValue())}}function gt(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,ht,1,2,"rx-read-only-field",2),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}function vt(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-rx-datetime",4),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("label",e.label)("required",e.isRequired)("formControl",e.formControl)("readonly",e.isDisabled)("disabledStyleForReadonlyState",!0)}}function yt(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",3),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.label)("value",e.getDisplayValue())}}function xt(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,yt,1,2,"rx-read-only-field",2),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}function bt(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-rx-datetime",4),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("label",e.label)("required",e.isRequired)("formControl",e.formControl)("readonly",e.isDisabled)("disabledStyleForReadonlyState",!0)("mode",e.pickerMode)}}const Ct=["counterComponent"];function St(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",3),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.label)("value",e.getDisplayValue())}}function wt(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,St,1,2,"rx-read-only-field",2),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}function Dt(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-counter",4,5),n["\u0275\u0275listener"]("onBlur",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onBlur()})("onFocus",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onFocus()}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("label",e.label)("formControl",e.counterFormControl)("readonly",e.isDisabled)("disabledStyleForReadonlyState",!0)("required",e.isRequired)("min",e.fieldDefinition.minValue)("max",e.fieldDefinition.maxValue)("adaptMin",e.fieldDefinition.minValue)("adaptMax",e.fieldDefinition.maxValue)}}function Rt(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",3),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.label)("value",e.getDisplayValue())}}function It(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,Rt,1,2,"rx-read-only-field",2),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}function Ft(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-counter",4),n["\u0275\u0275listener"]("onBlur",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onBlur()})("onFocus",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onFocus()}),n["\u0275\u0275pipe"](1,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("label",e.label)("formControl",e.counterFormControl)("required",e.isRequired)("min",e.fieldDefinition.minValue)("max",e.fieldDefinition.maxValue)("adaptMin",e.fieldDefinition.minValue)("adaptMax",e.fieldDefinition.maxValue)("readonly",e.isDisabled)("disabledStyleForReadonlyState",!0)("requiredLabel",n["\u0275\u0275pipeBind1"](1,10,"com.bmc.arsys.rx.client.common.required-field.label"))}}function Et(e,t){if(1&e&&(n["\u0275\u0275element"](0,"adapt-rx-select",2),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275pipe"](2,"async")),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("label",n["\u0275\u0275pipeBind1"](1,4,e.model.label$))("options",n["\u0275\u0275pureFunction0"](8,et))("disabled",!0)("required",n["\u0275\u0275pipeBind1"](2,6,e.model.isRequired$))}}function Mt(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span",10),n["\u0275\u0275text"](1,"(required)"),n["\u0275\u0275elementEnd"]())}function At(e,t){1&e&&n["\u0275\u0275element"](0,"adapt-rx-radiobutton",11)}function Ot(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275elementStart"](1,"div",3),n["\u0275\u0275elementStart"](2,"label",4),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"async"),n["\u0275\u0275template"](5,Mt,2,0,"span",5),n["\u0275\u0275pipe"](6,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](7,"adapt-rx-radiobutton-group",6),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().isRadioButtonMode=t}),n["\u0275\u0275template"](8,At,1,0,"adapt-rx-radiobutton",7),n["\u0275\u0275pipe"](9,"async"),n["\u0275\u0275element"](10,"adapt-rx-radiobutton",8),n["\u0275\u0275element"](11,"adapt-rx-radiobutton",9),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](4,5,e.model.label$)," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](6,7,e.model.isRequired$)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngModel",e.isRadioButtonMode)("disabled",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!n["\u0275\u0275pipeBind1"](9,9,e.model.isRequired$))}}function Pt(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",3),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.label)("value",e.getDisplayValue())}}function Tt(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,Pt,1,2,"rx-read-only-field",2),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}function Vt(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-rx-radiobutton",8),2&e){const e=t.$implicit,i=t.last;n["\u0275\u0275classMapInterpolate1"]("mt-0 ",i?"mb-1":"",""),n["\u0275\u0275property"]("value",e.id)("label",e.name)}}function Nt(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"adapt-rx-radiobutton-group",6),n["\u0275\u0275template"](1,Vt,1,5,"adapt-rx-radiobutton",7),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("name",e.guid)("formControl",e.formControl)("readonly",e.isDisabled)("label",e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.selectOptions)}}function kt(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-select",9),n["\u0275\u0275listener"]("onPopupOpenChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onPopupStatusChange(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("options",e.selectOptions)("required",e.isRequired)("label",e.label)("formControl",e.selectFormControl)("readonly",e.isDisabled)("optionFormatter",e.optionFormatter)("enableFilter",!0)("emptyOption",!e.isRequired)}}function jt(e,t){if(1&e&&(n["\u0275\u0275template"](0,Nt,2,5,"adapt-rx-radiobutton-group",4),n["\u0275\u0275template"](1,kt,1,8,"adapt-rx-select",5)),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngIf",e.isRadioButtonMode),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!e.isRadioButtonMode)}}function _t(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",3),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.label)("value",e.getDisplayValue())}}function Bt(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,_t,1,2,"rx-read-only-field",2),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}function $t(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-select-with-pagination",4),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("label",e.label)("formControl",e.formControl)("required",e.isRequired)("readonly",e.isDisabled)("optionLoader",e.optionLoaderFunc)("showDefaultTitle",e.showDefaultTitle)("viewToModelValueAdapter",e.viewToModelValueAdapterFunc)("modelToViewValueAdapter",e.modelToViewValueAdapterFunc)}}const Lt=function(){return{iconName:"question_circle_o",content:"This is the record definition that provides the option values for this named list.",placement:"top",popoverMode:!0}};function Gt(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-rx-textfield",5),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngModel",e.sourceRecordDefinitionDisplayName)("tooltip",n["\u0275\u0275pureFunction0"](2,Lt))}}const qt=function(){return{iconName:"question_circle_o",content:"Select the field in the source record definition that filters the option values for this named list.",placement:"top",popoverMode:!0}};function Ut(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-select",6),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSelectFilterField(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngModel",e.filterField)("options",e.filterFieldIdOptions)("optionFormatter",e.optionFormatter)("disabled",e.fieldformGroup.disabled)("tooltip",n["\u0275\u0275pureFunction0"](5,qt))}}const zt=function(e){return{"form-group d-block":e}};function Xt(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",6),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().index;return n["\u0275\u0275nextContext"]().removeField(t)}),n["\u0275\u0275elementEnd"]()}}function Wt(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",2),n["\u0275\u0275elementStart"](1,"div",3),n["\u0275\u0275template"](2,Xt,1,0,"button",4),n["\u0275\u0275element"](3,"rx-select-group-field",5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=t.index,o=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!o.isDisabled),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("fieldformGroup",e)("index",i)("targetFieldOptions",o.options.targetFieldOptions)}}function Ht(e,t){if(1&e&&(n["\u0275\u0275element"](0,"adapt-rx-textfield",3),n["\u0275\u0275pipe"](1,"async")),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.data.label||"<No Label>")("required",n["\u0275\u0275pipeBind1"](1,3,i.model.isFieldRequired(e)))("disabled",!0)}}function Qt(e,t){if(1&e&&(n["\u0275\u0275template"](0,Ht,2,5,"adapt-rx-textfield",2),n["\u0275\u0275pipe"](1,"async")),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngForOf",n["\u0275\u0275pipeBind1"](1,2,e.model.fieldsDesignData$))("ngForTrackBy",e.trackByFn)}}function Jt(e,t){1&e&&n["\u0275\u0275element"](0,"adapt-empty-state",4)}function Kt(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",4),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.label)("value",e.getDisplayValue())}}function Yt(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,Kt,1,2,"rx-read-only-field",3),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}function Zt(e,t){if(1&e&&(n["\u0275\u0275element"](0,"adapt-rx-textfield",7),n["\u0275\u0275pipe"](1,"translate")),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.label)("isPassword",e.isPasswordField)("formControl",e.formControl)("maxlength",e.maxLength)("required",e.isRequired)("readonly",e.isDisabled)("disabledStyleForReadonlyState",!0)("autocomplete",!e.isPasswordField)("requiredLabel",n["\u0275\u0275pipeBind1"](1,9,"com.bmc.arsys.rx.client.common.required-field.label"))}}function ei(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-select-with-pagination",8),n["\u0275\u0275listener"]("toggleDropdown",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onToggleDropdown(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2),t=n["\u0275\u0275reference"](4);n["\u0275\u0275property"]("showDefaultTitle",e.showDefaultTitle)("label",e.label)("formControl",e.formControl)("readonly",e.isDisabled)("viewToModelValueAdapter",e.viewToModelValueAdapterFunc)("modelToViewValueAdapter",e.modelToViewValueAdapterFunc)("optionLoader",e.optionLoaderFunc)("required",e.isRequired)("isMultiSelectionMode",e.isMultipleSelectionEnabled)("template",t)}}function ti(e,t){if(1&e&&(n["\u0275\u0275template"](0,Zt,2,11,"adapt-rx-textfield",5),n["\u0275\u0275template"](1,ei,1,10,"rx-select-with-pagination",6)),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngIf",!e.isNamedListAttached),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isNamedListAttached)}}function ii(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span",12),n["\u0275\u0275elementStart"](1,"small"),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",e," ")}}function ni(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",10),n["\u0275\u0275template"](1,ii,3,1,"span",11),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275property"]("title",e.title),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.contextualFields)}}function oi(e,t){if(1&e&&(n["\u0275\u0275text"](0),n["\u0275\u0275template"](1,ni,2,2,"div",9)),2&e){const e=t.$implicit;n["\u0275\u0275textInterpolate1"](" ",e.displayValue," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.contextualFields)}}function ri(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",3),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.label)("value",e.getDisplayValue())}}function ai(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,ri,1,2,"rx-read-only-field",2),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}function si(e,t){if(1&e&&(n["\u0275\u0275element"](0,"adapt-rx-textarea",4),n["\u0275\u0275pipe"](1,"translate")),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("formControl",e.formControl)("required",e.isRequired)("maxlength",e.maxLength)("rows",3)("readonly",e.isDisabled)("disabledStyleForReadonlyState",!0)("label",e.label)("requiredLabel",n["\u0275\u0275pipeBind1"](1,8,"com.bmc.arsys.rx.client.common.required-field.label"))}}function li(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",3),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.label)("value",e.getDisplayValue())}}function di(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,li,1,2,"rx-read-only-field",2),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}function ci(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-rx-datetime",4),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("label",e.label)("required",e.isRequired)("formControl",e.formControl)("readonly",e.isDisabled)("disabledStyleForReadonlyState",!0)("mode",e.pickerMode)}}function pi(e,t){1&e&&n["\u0275\u0275element"](0,"rx-runtime-view-canvas-outlet")}function mi(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span",3),n["\u0275\u0275text"](1,"(required)"),n["\u0275\u0275elementEnd"]())}function ui(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",3),n["\u0275\u0275elementStart"](1,"label"),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](3,"ckeditor",4),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("config",e.ckEditorConfig)("type",e.ckEditorType)("readOnly",!0)("ngModel",e.getDisplayValue())}}function fi(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,ui,4,5,"div",2),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}function hi(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275element"](1,"adapt-rx-control-label",5),n["\u0275\u0275elementStart"](2,"ckeditor",6),n["\u0275\u0275listener"]("dataChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().setFieldValue(t)})("blur",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onBlur()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](3,"adapt-rx-feedback",7,8),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275reference"](4),t=n["\u0275\u0275nextContext"]();n["\u0275\u0275classProp"]("has-danger",e.hasUIErrorState),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("label",t.label)("showRequiredLabel",t.isRequired),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("data",t.formControl.value)("config",t.ckEditorConfig)("type",t.ckEditorType)("readOnly",t.isDisabled),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("errors",t.formControl.errors)("controlTouched",t.formControl.touched)}}function gi(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-read-only-field",3),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.label)("value",e.getDisplayValue())}}function vi(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,gi,1,2,"rx-read-only-field",2),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.inReadState)("ngIfElse",t)}}function yi(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"span",4),n["\u0275\u0275element"](1,"adapt-rx-control-label",5),n["\u0275\u0275elementStart"](2,"button",6),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().selectLocalizedValue()}),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](5,"adapt-rx-textfield",7)}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275classProp"]("has-danger",e.formControl.errors&&e.formControl.touched),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("label",e.label)("id",e.guid)("showRequiredLabel",e.isRequired),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",e.isDisabled),n["\u0275\u0275attribute"]("aria-describedby",e.guid),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](4,13,"com.bmc.arsys.rx.client.view-components.localized-character-field.button.localize.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("readonly",!0)("formControl",e.formControl)("disabledStyleForReadonlyState",!0)("required",e.isRequired),n["\u0275\u0275attribute"]("aria-describedby",e.guid)}}function xi(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"label",2),n["\u0275\u0275elementStart"](1,"input",3),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().column.alignment=t}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275classMapInterpolate1"]("btn btn-sm rounded btn-secondary ",e.icon,""),n["\u0275\u0275classProp"]("active",i.column.alignment===e.value)("disabled",i.isReadOnly),n["\u0275\u0275property"]("adaptTooltip",e.name),n["\u0275\u0275attribute"]("rx-id",e.name),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("value",e.value)("ngModel",i.column.alignment)("disabled",i.isReadOnly),n["\u0275\u0275attribute"]("rx-id",e.value)}}function bi(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",13),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().addCellProperties()}),n["\u0275\u0275element"](1,"span",14),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,1,"com.bmc.arsys.rx.client.view-components.cell-display-properties.add-cell-display-property.button.label")," "))}function Ci(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",15),n["\u0275\u0275elementStart"](1,"button",16),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().toggleOpen(!0)}),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",17),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().toggleOpen(!1)}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,2,"com.bmc.arsys.rx.client.common.expand-all.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,4,"com.bmc.arsys.rx.client.common.collapse-all.label")," "))}function Si(e,t){1&e&&n["\u0275\u0275element"](0,"div",46)}function wi(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",47),n["\u0275\u0275elementStart"](1,"div",48),n["\u0275\u0275elementStart"](2,"button",49),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"](2);return t.stopPropagation(),o.moveCellProperties(i,i+1)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",50),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"](2);return t.stopPropagation(),o.moveCellProperties(i,i-1)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",51),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"](2);return t.stopPropagation(),o.removeCellProperties(i)}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](),t=e.last,i=e.first;n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",t),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",i),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,3,"com.bmc.arsys.rx.client.common.remove.label")," ")}}const Di=function(e,t){return{active:e,"disabled not-allowed":t}};function Ri(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",21),n["\u0275\u0275template"](1,Si,1,0,"div",22),n["\u0275\u0275elementStart"](2,"adapt-accordion-tab",23),n["\u0275\u0275listener"]("open",function(){return n["\u0275\u0275restoreView"](e).$implicit.get("isOpen").setValue(!0)})("close",function(){return n["\u0275\u0275restoreView"](e).$implicit.get("isOpen").setValue(!1)}),n["\u0275\u0275elementStart"](3,"div",24),n["\u0275\u0275elementStart"](4,"div",25),n["\u0275\u0275elementStart"](5,"div",26),n["\u0275\u0275elementStart"](6,"div",27),n["\u0275\u0275text"](7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](8,wi,7,5,"div",28),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](9,"div",29),n["\u0275\u0275elementStart"](10,"rx-expression-form-control",30),n["\u0275\u0275listener"]("events",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).openExpressionEditor(t.get("fieldValueCondition"))}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](11,"div",31),n["\u0275\u0275elementStart"](12,"div",32),n["\u0275\u0275element"](13,"adapt-rx-control-label",33),n["\u0275\u0275pipe"](14,"translate"),n["\u0275\u0275elementStart"](15,"adapt-rx-switch",34),n["\u0275\u0275listener"]("ngModelChange",function(){const t=n["\u0275\u0275restoreView"](e).$implicit,i=n["\u0275\u0275nextContext"](2);return i.markAsDirty(),i.resetIconAndTextProps(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](16,"adapt-rx-select",35),n["\u0275\u0275listener"]("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).markAsDirty()}),n["\u0275\u0275pipe"](17,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](18,"rx-icon-picker-form-control",36),n["\u0275\u0275listener"]("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](19,"adapt-rx-select",37),n["\u0275\u0275listener"]("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).markAsDirty()}),n["\u0275\u0275pipe"](20,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](21,"div",29),n["\u0275\u0275elementStart"](22,"adapt-rx-select",38),n["\u0275\u0275listener"]("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).markAsDirty()}),n["\u0275\u0275pipe"](23,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](24,"adapt-rx-select",39),n["\u0275\u0275listener"]("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).markAsDirty()}),n["\u0275\u0275pipe"](25,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](26,"adapt-rx-select",40),n["\u0275\u0275listener"]("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).markAsDirty()}),n["\u0275\u0275pipe"](27,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](28,"div",41),n["\u0275\u0275elementStart"](29,"div",42),n["\u0275\u0275elementStart"](30,"label",43),n["\u0275\u0275elementStart"](31,"input",44),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).toggleProp(t.get("bold"))}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](32,"label",45),n["\u0275\u0275elementStart"](33,"input",44),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).toggleProp(t.get("italic"))}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=t.index,o=n["\u0275\u0275nextContext"](2),r=n["\u0275\u0275reference"](17);n["\u0275\u0275property"]("cdkDragData",e)("cdkDragDisabled",o.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!o.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("formGroup",e)("isOpen",e.get("isOpen").value),n["\u0275\u0275advance"](3),n["\u0275\u0275classProp"]("pl-0",o.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("title","Cell display properties "+(i+1)),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" Cell display properties ",i+1," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!o.config.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("options",o.queryExpressionOptions),n["\u0275\u0275advance"](3),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](14,42,"com.bmc.arsys.rx.client.view-components.cell-display-properties.display-as-badge-field.label")),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",o.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](17,44,"com.bmc.arsys.rx.client.view-components.cell-display-properties.badge-color-field.label")),n["\u0275\u0275property"]("disabled",o.config.isReadOnly)("options",o.badgeColors)("optionFormatter",o.optionFormatter)("optionContentTemplate",r),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",o.config.isReadOnly)("options",o.iconPickerOptions),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](20,46,"com.bmc.arsys.rx.client.view-components.cell-display-properties.icon-position-field.label")),n["\u0275\u0275property"]("disabled",o.config.isReadOnly)("options",o.iconPositions)("optionFormatter",o.optionFormatter),n["\u0275\u0275advance"](3),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](23,48,"com.bmc.arsys.rx.client.view-components.cell-display-properties.text-color-field.label")),n["\u0275\u0275property"]("disabled",o.config.isReadOnly)("options",o.textColors)("optionFormatter",o.optionFormatter)("optionContentTemplate",r),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](25,50,"com.bmc.arsys.rx.client.view-components.cell-display-properties.background-color-field.label")),n["\u0275\u0275property"]("disabled",o.config.isReadOnly)("options",o.backgroundColors)("optionFormatter",o.optionFormatter)("optionContentTemplate",r),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](27,52,"com.bmc.arsys.rx.client.view-components.cell-display-properties.font-size-field.label")),n["\u0275\u0275property"]("disabled",o.config.isReadOnly)("options",o.fontSizes)("optionFormatter",o.optionFormatter),n["\u0275\u0275advance"](4),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction2"](54,Di,e.get("bold").value,e.get("displayAsBadge").value||o.config.isReadOnly)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",e.get("displayAsBadge").value||o.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction2"](57,Di,e.get("italic").value,e.get("displayAsBadge").value||o.config.isReadOnly)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",e.get("displayAsBadge").value||o.config.isReadOnly)}}function Ii(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",18),n["\u0275\u0275listener"]("cdkDropListDropped",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSelectedCellPropertyDrop(t)}),n["\u0275\u0275elementStart"](1,"adapt-accordion",19),n["\u0275\u0275template"](2,Ri,34,60,"div",20),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("multiselect",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.propsFormArray.controls)}}function Fi(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",52),n["\u0275\u0275element"](1,"adapt-empty-state",53),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.view-components.cell-display-properties.empty-state.message")))}function Ei(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",54),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSave()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("disabled",e.propsFormArray.invalid||!e.isDirty()),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.common.save.label")," ")}}function Mi(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",55),n["\u0275\u0275element"](1,"div",56),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngClass",e.value?"color-option-box rounded mr-2 "+i.colorsList[e.value]:""),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function Ai(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span",4),n["\u0275\u0275text"](1,"No cell display properties added."),n["\u0275\u0275elementEnd"]())}function Oi(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span",4),n["\u0275\u0275text"](1,"Cell display properties added."),n["\u0275\u0275elementEnd"]())}function Pi(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",11),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().addNamedFilterOption()}),n["\u0275\u0275element"](1,"span",12),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,1,"com.bmc.arsys.rx.client.view-components.named-filter-options.add-named-filter-option.button.label")," "))}function Ti(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",13),n["\u0275\u0275elementStart"](1,"button",14),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().toggleOpen(!0)}),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",15),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().toggleOpen(!1)}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,2,"com.bmc.arsys.rx.client.common.expand-all.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,4,"com.bmc.arsys.rx.client.common.collapse-all.label")," "))}function Vi(e,t){1&e&&n["\u0275\u0275element"](0,"div",29)}function Ni(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",30),n["\u0275\u0275elementStart"](1,"div",31),n["\u0275\u0275elementStart"](2,"button",32),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"](2);return t.stopPropagation(),o.moveNamedFilterOption(i,i+1)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",33),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"](2);return t.stopPropagation(),o.moveNamedFilterOption(i,i-1)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",34),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"](2);return t.stopPropagation(),o.removeNamedFilterOption(i)}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](),t=e.last,i=e.first;n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",t),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",i),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,3,"com.bmc.arsys.rx.client.common.remove.label")," ")}}function ki(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",19),n["\u0275\u0275template"](1,Vi,1,0,"div",20),n["\u0275\u0275elementStart"](2,"adapt-accordion-tab",21),n["\u0275\u0275elementStart"](3,"div",22),n["\u0275\u0275elementStart"](4,"div",23),n["\u0275\u0275elementStart"](5,"div",24),n["\u0275\u0275elementStart"](6,"div",25),n["\u0275\u0275text"](7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](8,Ni,7,5,"div",26),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](9,"adapt-rx-textfield",27),n["\u0275\u0275listener"]("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).markAsDirty()}),n["\u0275\u0275pipe"](10,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](11,"rx-expression-form-control",28),n["\u0275\u0275listener"]("events",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).openExpressionEditor(t.get("title"),t.get("filterExpression"))})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("cdkDragData",e)("cdkDragDisabled",i.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!i.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("formGroup",e)("isOpen",i.accordionTabs[e.get("guid").value]),n["\u0275\u0275advance"](3),n["\u0275\u0275classProp"]("pl-0",i.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("title",e.get("title").value),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.get("title").value," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!i.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](10,14,"com.bmc.arsys.rx.client.view-components.named-filter-options.name-field.label")),n["\u0275\u0275property"]("required",!0),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("options",i.queryExpressionOptions)("required",!0)}}function ji(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",16),n["\u0275\u0275listener"]("cdkDropListDropped",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSelectedNamedFilterOptionDrop(t)}),n["\u0275\u0275elementStart"](1,"adapt-accordion",17),n["\u0275\u0275template"](2,ki,12,16,"div",18),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("multiselect",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.namedFilterOptionsFormArray.controls)}}function _i(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",35),n["\u0275\u0275element"](1,"adapt-empty-state",36),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.view-components.named-filter-options.empty-state.message")))}function Bi(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",37),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSave()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("disabled",e.namedFilterOptionsFormArray.invalid||!e.isDirty()),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.common.save.label")," ")}}const $i='[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.designer-modal-body[_ngcontent-%COMP%]{height:645px;min-height:calc(100% - 61px)!important}.designer-modal-accordion-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:auto;padding-top:10px}.designer-modal-accordion-content[_ngcontent-%COMP%]{position:relative}.designer-modal-accordion-content.cdk-drag-preview[_ngcontent-%COMP%]{z-index:1200!important}.designer-modal-drag-handle[_ngcontent-%COMP%]{cursor:move;position:absolute;top:0;left:0;height:46px;padding:14px 10px 14px 14px;z-index:1}.designer-modal-card-title-content[_ngcontent-%COMP%]{width:100%;display:flex}.designer-modal-card-title-content[_ngcontent-%COMP%]   .left-header-block[_ngcontent-%COMP%], .designer-modal-card-title-content[_ngcontent-%COMP%]   .right-header-block[_ngcontent-%COMP%]{display:flex;align-items:center}.designer-modal-card-title-content[_ngcontent-%COMP%]   .left-header-block[_ngcontent-%COMP%]{flex-grow:1;min-width:0;font-size:14px;padding-left:22px}.designer-modal-card-sub-title[_ngcontent-%COMP%]{color:#7c7f81;font-weight:normal}.designer-modal-card-title-index-buttons[_ngcontent-%COMP%]{display:flex;font-size:19px}.rx-card[_ngcontent-%COMP%]{overflow:auto}.rx-tree-draggable-node[_ngcontent-%COMP%]{cursor:pointer}.rx-tree-draggable-node.cdk-drag-preview[_ngcontent-%COMP%]{z-index:1200!important}.rx-tree-draggable-node.cdk-drag[_ngcontent-%COMP%]{opacity:1}.rx-tree-node-label[_ngcontent-%COMP%]{word-break:break-all}rx-form-builder[_ngcontent-%COMP%]{max-width:400px}';function Li(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span",6),n["\u0275\u0275element"](1,"span",7),n["\u0275\u0275element"](2,"adapt-icon",8),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("name","question_circle_o")("adaptPopover",e.tooltip)}}function Gi(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",9),n["\u0275\u0275text"](1,"No named filter options added."),n["\u0275\u0275elementEnd"]())}function qi(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",16),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"](2).removeFilterOption(t)}),n["\u0275\u0275elementEnd"]()}}function Ui(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"li",12),n["\u0275\u0275elementStart"](1,"strong",13),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",14),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).index;return n["\u0275\u0275nextContext"](2).editNamedFilterOption(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](4,qi,1,0,"button",15),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.data.title),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!i.isDisabled)}}function zi(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"ul",10),n["\u0275\u0275template"](1,Ui,5,2,"li",11),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.value)}}const Xi=["selectedColumnsDropList"],Wi=["associatedAvailableColumnsDropList"],Hi=["draggableSelectedColumn"],Qi=["draggableAssociatedAvailableColumn"];function Ji(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span",22),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275property"]("title",e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function Ki(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",23,24),n["\u0275\u0275listener"]("cdkDragStarted",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](4).onAssociatedAvailableColumnsDragStarted()}),n["\u0275\u0275elementStart"](2,"div",25),n["\u0275\u0275listener"]("dblclick",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"](3).addColumn(t.data.availableColumn)}),n["\u0275\u0275elementStart"](3,"button",26),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"](3).addColumn(t.data.availableColumn)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"span",27),n["\u0275\u0275text"](5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275property"]("cdkDragData",e.data.availableColumn),n["\u0275\u0275advance"](5),n["\u0275\u0275textInterpolate"](e.label)}}function Yi(e,t){if(1&e&&(n["\u0275\u0275template"](0,Ji,2,2,"span",20),n["\u0275\u0275template"](1,Ki,6,2,"div",21)),2&e){const e=t.$implicit;n["\u0275\u0275property"]("ngIf",!e.data.availableColumn),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.data.availableColumn)}}const Zi=function(){return["selectedColumnsDropList"]};function en(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",16,17),n["\u0275\u0275elementStart"](2,"adapt-tree",18),n["\u0275\u0275listener"]("onNodeExpand",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onNodeExpand(t)}),n["\u0275\u0275template"](3,Yi,2,2,"ng-template",19),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("cdkDropListData",e.filteredColumns)("cdkDropListConnectedTo",n["\u0275\u0275pureFunction0"](4,Zi)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("value",e.availableColumnsTree)("wrap",e.treeWrap)}}function tn(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",28),n["\u0275\u0275element"](1,"adapt-empty-state",29),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.view-components.record-grid-column.available-columns.empty-state.message")))}function nn(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",12),n["\u0275\u0275elementStart"](1,"div",3),n["\u0275\u0275elementStart"](2,"h4",4),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",13),n["\u0275\u0275elementStart"](6,"div",14),n["\u0275\u0275template"](7,en,4,5,"div",15),n["\u0275\u0275template"](8,tn,3,3,"div",8),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](4,3,"com.bmc.arsys.rx.client.view-components.record-grid-column.available-columns.title")," "),n["\u0275\u0275advance"](4),n["\u0275\u0275property"]("ngIf",!e.isTreeEmpty()),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isTreeEmpty())}}function on(e,t){1&e&&n["\u0275\u0275element"](0,"div",44)}function rn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",50),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"](2).index,o=n["\u0275\u0275nextContext"](2);return t.stopPropagation(),o.removeColumn(i)}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.common.remove.label")," "))}function an(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",45),n["\u0275\u0275elementStart"](1,"div",46),n["\u0275\u0275elementStart"](2,"button",47),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"](2);return t.stopPropagation(),o.moveColumn(i,i+1)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",48),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"](2);return t.stopPropagation(),o.moveColumn(i,i-1)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](4,rn,3,3,"button",49),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](),t=e.last,i=e.first,o=e.$implicit,r=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",t),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",i),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!r.isActionsColumn(o.fieldId))}}function sn(e,t){1&e&&n["\u0275\u0275element"](0,"div")}function ln(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,sn,1,0,"div",51),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275reference"](14),i=n["\u0275\u0275reference"](12),o=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",o.isActionsColumn(e.fieldId))("ngIfThen",t)("ngIfElse",i)}}function dn(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span",68),n["\u0275\u0275element"](1,"span",69),n["\u0275\u0275element"](2,"adapt-icon",70),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2).$implicit;n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("name","question_circle_o")("adaptPopover",e.tooltip.content)}}function cn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",64),n["\u0275\u0275elementStart"](1,"label"),n["\u0275\u0275elementStart"](2,"input",65),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"](2).$implicit[i.name]=t})("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().$implicit,o=n["\u0275\u0275nextContext"](2).$implicit;return n["\u0275\u0275nextContext"](2).onColumnCheckboxPropertyChange(t,o,i)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"span",66),n["\u0275\u0275text"](4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](5,dn,3,2,"span",67),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"](2).$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngModel",t[e.name])("disabled",!i.isPropertyEditable(t,e.name)),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.tooltip)}}function pn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-column-editor-alignment",71),n["\u0275\u0275listener"]("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](5).markAsDirty()}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"](2).$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("isReadOnly",i.isReadOnly)("column",t)("columnProperty",e)("ngModel",t.alignment)}}const mn=function(){return["visible","sortable","filterable","searchable","wrapText"]};function un(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,cn,6,4,"div",62),n["\u0275\u0275template"](2,pn,1,4,"rx-column-editor-alignment",63),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pureFunction0"](2,mn).includes(e.name)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf","alignment"===e.name)}}function fn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-select-form-control",72),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).$implicit.typeaheadKeystrokeCount=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](4).markAsDirty()}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2).$implicit,t=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("options",t.typeaheadKeystrokeCountOptions)("ngModel",e.typeaheadKeystrokeCount)("disabled",t.isReadOnly)}}function hn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-expression-form-control",73,74),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).$implicit.additionalQueryCriteria=t})("events",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275reference"](1),i=n["\u0275\u0275nextContext"](2).$implicit;return n["\u0275\u0275nextContext"](2).openAdditionalQueryCriteriaExpressionEditor(i,t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2).$implicit,t=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("options",e.additionalQueryCriteriaExpressionOptions)("ngModel",e.additionalQueryCriteria)("disabled",t.isReadOnly)}}function gn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-textfield",52),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().$implicit.title=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](3).markAsDirty()}),n["\u0275\u0275pipe"](1,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](2,"div",53),n["\u0275\u0275template"](3,un,3,3,"ng-container",54),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"div",55),n["\u0275\u0275elementStart"](5,"rx-stepper-with-units-form-control",56),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().$implicit.width=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](3).markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](6,fn,1,3,"rx-select-form-control",57),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](7,hn,2,3,"rx-expression-form-control",58),n["\u0275\u0275elementStart"](8,"rx-cell-display-properties",59),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().$implicit.cellDisplayProperties=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](3).markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](9,"rx-named-filter-options",60),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().$implicit.namedFilterOptions=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](3).markAsDirty()}),n["\u0275\u0275pipe"](10,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](11,"rx-action-list-control",61),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().$implicit.actions=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](3).markAsDirty()}),n["\u0275\u0275pipe"](12,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"](2);n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](1,20,"com.bmc.arsys.rx.client.view-components.record-grid-column.column-header-field.label")),n["\u0275\u0275property"]("disabled",t.isReadOnly)("ngModel",e.title),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngForOf",t.columnProperties)("ngForTrackBy",t.trackByForColumnProperties),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("options",t.columnWidthPropertyOptions)("ngModel",e.width),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.filterable&&e.fieldDefinition.namedListDefinition),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.filterable&&e.fieldDefinition.namedListDefinition),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("columns",t.columns)("columnName",e.title)("disabled",t.isReadOnly)("ngModel",e.cellDisplayProperties),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("tooltip",n["\u0275\u0275pipeBind1"](10,22,"com.bmc.arsys.rx.client.view-components.record-grid-column.named-filter-options-field.tooltip")),n["\u0275\u0275property"]("column",e)("disabled",t.isReadOnly)("ngModel",e.namedFilterOptions),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("tooltip",n["\u0275\u0275pipeBind1"](12,24,"com.bmc.arsys.rx.client.view-components.record-grid-column.column-actions-field.tooltip")),n["\u0275\u0275property"]("disabled",t.isReadOnly)("ngModel",e.actions)}}function vn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",64),n["\u0275\u0275elementStart"](1,"label"),n["\u0275\u0275elementStart"](2,"input",65),n["\u0275\u0275listener"]("ngModelChange",function(t){const i=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).$implicit[i.name]=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](4).markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"span",66),n["\u0275\u0275text"](4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2).$implicit,o=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngModel",i[e.name])("disabled",!o.isPropertyEditable(i,e.name)),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.label)}}function yn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-textfield",75),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().$implicit.title=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](3).markAsDirty()}),n["\u0275\u0275pipe"](1,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](2,"rx-stepper-with-units-form-control",56),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().$implicit.width=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](3).markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"div",53),n["\u0275\u0275template"](4,vn,5,3,"div",76),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"](2);n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](1,7,"com.bmc.arsys.rx.client.view-components.record-grid-column.column-header-field.label")),n["\u0275\u0275property"]("disabled",t.isReadOnly)("ngModel",e.title),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("options",t.columnWidthPropertyOptions)("ngModel",e.width),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",t.actionsColumnProperties)("ngForTrackBy",t.trackByForColumnProperties)}}function xn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",32,33),n["\u0275\u0275listener"]("cdkDragStarted",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onColumnDragStarted()}),n["\u0275\u0275template"](2,on,1,0,"div",34),n["\u0275\u0275elementStart"](3,"adapt-accordion-tab",35),n["\u0275\u0275listener"]("open",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!0})("close",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!1}),n["\u0275\u0275elementStart"](4,"div",36),n["\u0275\u0275elementStart"](5,"div",37),n["\u0275\u0275elementStart"](6,"div",38),n["\u0275\u0275elementStart"](7,"div",39),n["\u0275\u0275text"](8),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](9,an,5,3,"div",40),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](10,ln,2,3,"ng-container",41),n["\u0275\u0275template"](11,gn,13,26,"ng-template",null,42,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](13,yn,5,9,"ng-template",null,43,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("cdkDragData",e)("cdkDragDisabled",i.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!i.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("isOpen",e.isOpen),n["\u0275\u0275advance"](3),n["\u0275\u0275classProp"]("pl-0",i.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("title",e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.label," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!i.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isOpen)}}function bn(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"adapt-accordion",30),n["\u0275\u0275template"](1,xn,15,10,"div",31),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("multiselect",!1),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.columns)("ngForTrackBy",e.trackByForColumns)}}function Cn(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",28),n["\u0275\u0275element"](1,"adapt-empty-state",77),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.view-components.record-grid-column.selected-columns.empty-state.message")))}function Sn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",78),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().saveChanges()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("disabled",!e.isDirty()),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.common.save.label")," ")}}function wn(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span",6),n["\u0275\u0275text"](1," No grid columns added. "),n["\u0275\u0275elementEnd"]())}function Dn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",13),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"](2).openEditor(t.guid)}),n["\u0275\u0275elementEnd"]()}}function Rn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",14),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"](2).removeColumn(t)}),n["\u0275\u0275elementEnd"]()}}function In(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span"),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"]("\u2013 ",e.associationDescriptor.label,"")}}const Fn=function(e){return{"d-icon-left-arrow_schema":e}};function En(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",7),n["\u0275\u0275elementStart"](1,"div",8),n["\u0275\u0275elementStart"](2,"span",9),n["\u0275\u0275text"](3),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](4,Dn,1,0,"button",10),n["\u0275\u0275template"](5,Rn,1,0,"button",11),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](6,"div",12),n["\u0275\u0275text"](7),n["\u0275\u0275template"](8,In,2,1,"span",2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](7,Fn,e.associationDescriptor))("title",e.title),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.title||e.fallbackTitle," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!i.isDisabled),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!i.isActionsColumn(e.fieldId)&&!i.isDisabled),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",i.getColumnResourceTypeName(e)," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.associationDescriptor)}}function Mn(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"div",3),n["\u0275\u0275template"](2,wn,2,0,"span",4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](3,En,9,9,"div",5),n["\u0275\u0275elementEnd"]()),2&e){const e=t.ngIf,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",0===e.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",i.getSortedColumns(e))("ngForTrackBy",i.trackByForColumns)}}function An(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-checkbox",3),n["\u0275\u0275listener"]("ngModelChange",function(t){const i=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).namedFilterOptionsModel[i.guid]=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onNamedFilterOptionChange()}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("label",e.title)("ngModel",i.namedFilterOptionsModel[e.guid])}}function On(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",1),n["\u0275\u0275template"](1,An,1,2,"adapt-rx-checkbox",2),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.namedFilterOptions)("ngForTrackBy",e.trackByOptionGuid)}}function Pn(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-named-filter-options-list",3),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("namedFilterOptions",e.namedFilterOptions)("filterOption",e.filterOption)("filterValue",e.filterValue)("filterControlsComponent",e.filterControlsComponent)}}function Tn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-select",4),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onValueChange(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("inline",!0)("multiple",!0)("optionFormatter",e.selectOptionFormatter)("options",e.getSelectOptions())("popupMaxHeight",null)("ngModel",e.selectedValues)}}function Vn(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-rx-radiobutton",6),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("value",e.filterControlsComponent.getBooleanTypeBlankValue())("label",e.filterControlsComponent.texts.configsTexts.blankLabel)("testID",e.filterControlsComponent.testID+"_radio_blank")("disabled",e.filterControlsComponent.isInputDisabled(e.filterControlsComponent.getBooleanTypeBlankValue()))}}function Nn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-radiobutton-group",5),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onValueChangeRequired(t)}),n["\u0275\u0275element"](1,"adapt-rx-radiobutton",6),n["\u0275\u0275element"](2,"adapt-rx-radiobutton",6),n["\u0275\u0275template"](3,Vn,1,4,"adapt-rx-radiobutton",7),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngModel",e.filterValue?e.filterValue.filterValue[0]:null),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("value",!1)("label",e.filterControlsComponent.texts.configsTexts.falseLabel)("testID",e.filterControlsComponent.testID+"_radio_false")("disabled",e.filterControlsComponent.isInputDisabled(!1)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("value",!0)("label",e.filterControlsComponent.texts.configsTexts.trueLabel)("testID",e.filterControlsComponent.testID+"_radio_true")("disabled",e.filterControlsComponent.isInputDisabled(!0)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.filterControlsComponent.getBooleanTypeOptionParams().hasBlankValue)}}function kn(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-named-filter-options-list",6),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("namedFilterOptions",e.namedFilterOptions)("filterOption",e.filterOption)("filterValue",e.filterValue)("filterControlsComponent",e.filterControlsComponent)}}function jn(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",7),n["\u0275\u0275element"](1,"div",8),n["\u0275\u0275elementEnd"]())}function _n(e,t){if(1&e&&n["\u0275\u0275text"](0),2&e){const e=t.tag;let i;n["\u0275\u0275textInterpolate1"](" ",null!==(i=e.displayValue)&&void 0!==i?i:e.value,"\n")}}function Bn(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span",12),n["\u0275\u0275elementStart"](1,"small"),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",e," ")}}function $n(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",10),n["\u0275\u0275template"](1,Bn,3,1,"span",11),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().result;n["\u0275\u0275property"]("title",e.title),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.contextualFields)}}function Ln(e,t){if(1&e&&(n["\u0275\u0275text"](0),n["\u0275\u0275template"](1,$n,2,2,"div",9)),2&e){const e=t.result;let i;n["\u0275\u0275textInterpolate1"](" ",null!==(i=e.displayValue)&&void 0!==i?i:e.value," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.contextualFields)}}function Gn(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-named-filter-options-list",3),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("namedFilterOptions",e.namedFilterOptions)("filterOption",e.filterOption)("filterValue",e.filterValue)("filterControlsComponent",e.filterControlsComponent)}}function qn(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-named-filter-options-list",8),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("namedFilterOptions",e.namedFilterOptions)("filterOption",e.filterOption)("filterValue",e.filterValue)("filterControlsComponent",e.filterControlsComponent)}}function Un(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-named-filter-options-list",6),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("namedFilterOptions",e.namedFilterOptions)("filterOption",e.filterOption)("filterValue",e.filterValue)("filterControlsComponent",e.filterControlsComponent)}}function zn(e,t){if(1&e&&n["\u0275\u0275elementContainer"](0,7),2&e){n["\u0275\u0275nextContext"]();const e=n["\u0275\u0275reference"](6);n["\u0275\u0275property"]("ngTemplateOutlet",e)}}function Xn(e,t){if(1&e&&n["\u0275\u0275elementContainer"](0,7),2&e){n["\u0275\u0275nextContext"]();const e=n["\u0275\u0275reference"](8);n["\u0275\u0275property"]("ngTemplateOutlet",e)}}function Wn(e,t){if(1&e&&n["\u0275\u0275elementContainer"](0,7),2&e){n["\u0275\u0275nextContext"]();const e=n["\u0275\u0275reference"](10);n["\u0275\u0275property"]("ngTemplateOutlet",e)}}function Hn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-datetime-range",8),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onTimeTypeFilterOptionModelChange(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngModel",null==e.filterValue?null:e.filterValue.filterValue)("testID",e.filterControlsComponent.testID)("mode",e.mode)("hasSeconds",!0)("inline",!0)("inlineLight",!0)("texts",e.filterControlsComponent.texts.datetimeTexts)("disabled",e.filterControlsComponent.isInputDisabled())}}function Qn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-datetime-range",9),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onDateTypeFilterOptionModelChange(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngModel",null==e.filterValue?null:e.filterValue.filterValue)("testID",e.filterControlsComponent.testID)("mode",e.mode)("inline",!0)("inlineLight",!0)("texts",e.filterControlsComponent.texts.datetimeTexts)("disabled",e.filterControlsComponent.isInputDisabled())}}function Jn(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-datetime-range",8),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onDateTimeTypeFilterOptionModelChange(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngModel",null==e.filterValue?null:e.filterValue.filterValue)("testID",e.filterControlsComponent.testID)("mode",e.mode)("hasSeconds",!0)("inline",!0)("inlineLight",!0)("texts",e.filterControlsComponent.texts.datetimeTexts)("disabled",e.filterControlsComponent.isInputDisabled())}}function Kn(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-named-filter-options-list",2),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("namedFilterOptions",e.namedFilterOptions)("filterOption",e.filterOption)("filterValue",e.filterValue)("filterControlsComponent",e.filterControlsComponent)}}const Yn=["optionalBooleanFilter"],Zn=["requiredBooleanFilter"],eo=["inputsForStringWithTypeAheadTemplate"],to=["inputsForStringTypeTemplate"],io=["inputsForNumberTypeTemplate"],no=["inputsForTimeTypeTemplate"],oo=["inputsForDateTypeTemplate"],ro=["inputsForDatetimeTypeTemplate"],ao=["inputsForSelectionTypeTemplate"];function so(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-boolean-filter",9),2&e){const e=t.filterOption,i=t.value,o=t.filterControlsComponent,r=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("filterControlsComponent",o)("filterOption",e)("filterValue",i)("isRequired",!1)("namedFilterOptions",r.namedFilterOptionsGetter(e))}}function lo(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-boolean-filter",9),2&e){const e=t.filterOption,i=t.value,o=t.filterControlsComponent,r=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("filterControlsComponent",o)("filterOption",e)("filterValue",i)("isRequired",!0)("namedFilterOptions",r.namedFilterOptionsGetter(e))}}function co(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-string-with-type-ahead-filter",10),2&e){const e=t.filterOption,i=t.value,o=t.filterControlsComponent,r=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("filterControlsComponent",o)("filterOption",e)("filterValue",i)("namedFilterOptions",r.namedFilterOptionsGetter(e))}}function po(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-string-filter",10),2&e){const e=t.filterOption,i=t.value,o=t.filterControlsComponent,r=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("filterControlsComponent",o)("filterOption",e)("filterValue",i)("namedFilterOptions",r.namedFilterOptionsGetter(e))}}function mo(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-number-filter",11),2&e){const e=t.filterOption,i=t.value,o=t.filterControlsComponent,r=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("filterOption",e)("filterValue",i)("filterControlsComponent",o)("namedFilterOptions",r.namedFilterOptionsGetter(e))}}function uo(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-date-time-range-filter",12),2&e){const e=t.filterOption,i=t.value,o=t.filterControlsComponent,r=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("filterOption",e)("filterValue",i)("filterControlsComponent",o)("mode",r.rxDatetimePickerMode.Time)("namedFilterOptions",r.namedFilterOptionsGetter(e))}}function fo(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-date-time-range-filter",12),2&e){const e=t.filterOption,i=t.value,o=t.filterControlsComponent,r=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("filterOption",e)("filterValue",i)("filterControlsComponent",o)("mode",r.rxDatetimePickerMode.Date)("namedFilterOptions",r.namedFilterOptionsGetter(e))}}function ho(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-date-time-range-filter",12),2&e){const e=t.filterOption,i=t.value,o=t.filterControlsComponent,r=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("filterOption",e)("filterValue",i)("filterControlsComponent",o)("mode",r.rxDatetimePickerMode.DateTime)("namedFilterOptions",r.namedFilterOptionsGetter(e))}}function go(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-selection-filter",11),2&e){const e=t.filterOption,i=t.value,o=t.filterControlsComponent,r=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("filterOption",e)("filterValue",i)("filterControlsComponent",o)("namedFilterOptions",r.namedFilterOptionsGetter(e))}}function vo(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-tag",2),n["\u0275\u0275listener"]("remove",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"]().onRemoveFilterTag(t)}),n["\u0275\u0275elementStart"](1,"span",3),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();let o;n["\u0275\u0275property"]("removable",!i.isDisabled)("disabled",i.isDisabled),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("title",null!==(o=null==e.data.value?null:e.data.value.title)&&void 0!==o?o:e.text),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e.text)}}function yo(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"adapt-tag",8),n["\u0275\u0275listener"]("remove",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).onRemoveFilterTag(t)}),n["\u0275\u0275elementStart"](2,"span",3),n["\u0275\u0275text"](3),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);let o;n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("removable",!i.isDisabled),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("title",null!==(o=null==e.data.value?null:e.data.value.title)&&void 0!==o?o:e.text),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e.text)}}function xo(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span",4),n["\u0275\u0275elementStart"](1,"button",5),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"div",6),n["\u0275\u0275template"](5,yo,4,3,"div",7),n["\u0275\u0275pipe"](6,"slice"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("appendToBody",!0)("placement",e.restTagsDropdownPlacement),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind2"](3,5,"com.bmc.arsys.rx.client.view-components.record-grid.filters.show-more-filters.label",e.getTranslateParams())," "),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngForOf",n["\u0275\u0275pipeBind2"](6,8,e.tags,-e.getRestTagsCount()))("ngForTrackBy",e.trackByForFilterTags)}}const bo=function(){return["right","bottom","bottom-right","auto"]};function Co(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275elementStart"](1,"adapt-advanced-filter",3,4),n["\u0275\u0275listener"]("selectedFiltersChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onAdvancedFiltersChange(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"rx-filter-tags",5),n["\u0275\u0275listener"]("removeTag",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onRemoveFilterTag(t)}),n["\u0275\u0275pipe"](4,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=n["\u0275\u0275reference"](2),t=n["\u0275\u0275nextContext"](),i=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("hidden",t.isDisabled)("appendDropdownToBody",!0)("enableSavedFilters",!1)("filterOptions",t.advancedFilterData.filterOptions)("selectedFilters",t.advancedFilterData.selectedFilters)("texts",t.advancedFilterData.filterTexts)("applyFiltersByUserAction",!0)("filterOptionsCustomAreaTemplate",i)("selectedFiltersIndicationStyle","mark")("anchorDisabled",t.options.anchorDisabled),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("isDisabled",t.isDisabled)("tags",n["\u0275\u0275pipeBind1"](4,14,t.getTags(e.filtersExpressionsTags)))("tagsLimit",t.options.tagsLimit)("restTagsDropdownPlacement",n["\u0275\u0275pureFunction0"](16,bo))}}function So(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-rx-radiobutton",11),2&e){const e=t.$implicit;n["\u0275\u0275property"]("value",e.value)("label",e.name)}}function wo(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",7),n["\u0275\u0275elementStart"](1,"adapt-accordion"),n["\u0275\u0275elementStart"](2,"adapt-accordion-tab",8),n["\u0275\u0275elementStart"](3,"adapt-rx-radiobutton-group",9),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onGroupFilterValueModelChange(t)}),n["\u0275\u0275template"](4,So,1,2,"adapt-rx-radiobutton",10),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("title","Show filters for: "+e.getGroupFilterName(e.groupFilterValue))("multiline",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngModel",e.groupFilterValue),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.groupFilterItems)}}function Do(e,t){if(1&e&&n["\u0275\u0275template"](0,wo,5,4,"div",6),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngIf",e.groupFilterItems.length>1)}}const Ro=["filterPresetsForm"];function Io(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",14),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().addFilterPreset()}),n["\u0275\u0275element"](1,"span",15),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,1,"com.bmc.arsys.rx.client.view-components.record-grid-filter-preset.add-filter-preset.button.label")," "))}function Fo(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",16),n["\u0275\u0275elementStart"](1,"button",17),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().toggleOpen(!0)}),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",18),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().toggleOpen(!1)}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,2,"com.bmc.arsys.rx.client.common.expand-all.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,4,"com.bmc.arsys.rx.client.common.collapse-all.label")," "))}function Eo(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",29),n["\u0275\u0275elementStart"](1,"button",30),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"]();return t.stopPropagation(),o.removeFilterPreset(i)}),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,1,"com.bmc.arsys.rx.client.common.remove.label")," "))}function Mo(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"rx-record-grid-filter-select-control",31),n["\u0275\u0275listener"]("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).markAsDirty()})("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().$implicit.filterSelect=t}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("name","filterPresetFilterSelect-"+e.guid)("disabled",t.isReadOnly)("options",e.filterSelectOptions)("ngModel",e.filterSelect)}}function Ao(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",19),n["\u0275\u0275elementStart"](1,"adapt-accordion-tab",20,21),n["\u0275\u0275listener"]("open",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!0})("close",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!1}),n["\u0275\u0275elementStart"](3,"div",22),n["\u0275\u0275elementStart"](4,"div",23),n["\u0275\u0275elementStart"](5,"div",24),n["\u0275\u0275elementStart"](6,"div",25),n["\u0275\u0275text"](7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](8,Eo,4,3,"div",26),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](9,"adapt-rx-textfield",27),n["\u0275\u0275listener"]("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().markAsDirty()})("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.title=t}),n["\u0275\u0275pipe"](10,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](11,Mo,2,4,"div",28),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275reference"](2),o=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("isOpen",e.isOpen),n["\u0275\u0275advance"](5),n["\u0275\u0275property"]("title",e.title),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.title," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!o.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](10,11,"com.bmc.arsys.rx.client.view-components.record-grid-filter-preset.name-field.label")),n["\u0275\u0275property"]("name","filterPresetTitle-"+e.guid)("required",!0)("disabled",o.isReadOnly)("rxCustomValidators",o.getCheckPresetTitleDuplicateValidator(e))("ngModel",e.title),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",i.isOpenOrCloseAnimationProcessing)}}function Oo(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",32),n["\u0275\u0275element"](1,"adapt-empty-state",33),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.view-components.record-grid-filter-preset.empty-state.message")))}function Po(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",34),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSaveChangesClick()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](9);n["\u0275\u0275property"]("disabled",t.form.invalid||!e.isDirty()),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.common.save.label")," ")}}function To(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-rx-control-label",4),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("label",e.options.label)("tooltip",null==e.options?null:e.options.tooltip)}}function Vo(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-button",5),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().openEditor()}),n["\u0275\u0275element"](1,"span",6),n["\u0275\u0275text"](2," Edit filter presets\n"),n["\u0275\u0275elementEnd"]()}}function No(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",13),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"]().openEditor(t)}),n["\u0275\u0275elementEnd"]()}}function ko(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",14),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"]().removeFilterPreset(t)}),n["\u0275\u0275elementEnd"]()}}function jo(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",7),n["\u0275\u0275elementStart"](1,"div",8),n["\u0275\u0275elementStart"](2,"span",9),n["\u0275\u0275text"](3),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](4,No,1,0,"button",10),n["\u0275\u0275template"](5,ko,1,0,"button",11),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](6,"div",12),n["\u0275\u0275text"](7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("title",e.title),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.title," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!i.isDisabled),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!i.isDisabled),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"]("Filters: ",e.recordGridFilters.length,"")}}function _o(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span",15),n["\u0275\u0275text"](1," No filter presets added. "),n["\u0275\u0275elementEnd"]())}const Bo=["rowActionsForm"],$o=["selectedRowActionsDropList"],Lo=["draggableSelectedRowAction"];function Go(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",15),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().addRowAction()}),n["\u0275\u0275element"](1,"span",16),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,1,"com.bmc.arsys.rx.client.view-components.record-grid-row-actions.add-row-action.button.label")," "))}function qo(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",17),n["\u0275\u0275elementStart"](1,"button",18),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().toggleOpen(!0)}),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",19),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().toggleOpen(!1)}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,2,"com.bmc.arsys.rx.client.common.expand-all.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,4,"com.bmc.arsys.rx.client.common.collapse-all.label")," "))}function Uo(e,t){1&e&&n["\u0275\u0275element"](0,"div",39)}function zo(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",40),n["\u0275\u0275elementStart"](1,"div",41),n["\u0275\u0275elementStart"](2,"button",42),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"]();return t.stopPropagation(),o.moveRowAction(i,i+1)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",43),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"]();return t.stopPropagation(),o.moveRowAction(i,i-1)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",44),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index;return n["\u0275\u0275nextContext"]().removeRowAction(i,t)}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](),t=e.last,i=e.first;n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",t),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",i),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,3,"com.bmc.arsys.rx.client.common.remove.label")," ")}}function Xo(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",20,21),n["\u0275\u0275template"](2,Uo,1,0,"div",22),n["\u0275\u0275elementStart"](3,"adapt-accordion-tab",23),n["\u0275\u0275listener"]("open",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!0})("close",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!1}),n["\u0275\u0275elementStart"](4,"div",24),n["\u0275\u0275elementStart"](5,"div",25),n["\u0275\u0275elementStart"](6,"div",26),n["\u0275\u0275elementStart"](7,"div",27),n["\u0275\u0275text"](8),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](9,zo,7,5,"div",28),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"div",29),n["\u0275\u0275elementStart"](11,"adapt-rx-textfield",30),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.label=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().markAsDirty()}),n["\u0275\u0275pipe"](12,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](13,"rx-icon-picker-form-control",31),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.icon=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](14,"div",29),n["\u0275\u0275elementStart"](15,"rx-definition-picker",32),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.recordDefinitionName=t})("ngModelChange",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"]().onRecordDefinitionChange(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](16,"rx-select-form-control",33),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.fieldId=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().markAsDirty()}),n["\u0275\u0275pipe"](17,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](18,"rx-expression-form-control",34),n["\u0275\u0275listener"]("events",function(t){const i=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"]().openExpressionEditor(t,i,"recordInstance")}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](19,"div",29),n["\u0275\u0275elementStart"](20,"rx-expression-form-control",35),n["\u0275\u0275listener"]("events",function(t){const i=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"]().openExpressionEditor(t,i,"disabled")}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](21,"rx-expression-form-control",36),n["\u0275\u0275listener"]("events",function(t){const i=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"]().openExpressionEditor(t,i,"hidden")}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](22,"rx-select-form-control",37),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.availableOnDevices=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](23,"div",29),n["\u0275\u0275elementStart"](24,"rx-action-list-control",38),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.actions=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("cdkDragData",e)("cdkDragDisabled",i.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!i.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("isOpen",e.isOpen),n["\u0275\u0275advance"](3),n["\u0275\u0275classProp"]("pl-0",i.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("title",e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.label," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!i.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](12,46,"com.bmc.arsys.rx.client.view-components.record-grid-row-actions.label-field.label")),n["\u0275\u0275property"]("disabled",i.isReadOnly)("required",!0)("name","label_"+e.guid)("ngModel",e.label),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",i.isReadOnly)("options",i.iconPickerOptions)("name","icon_"+e.guid)("ngModel",e.icon),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("isDisabled",i.isReadOnly)("options",i.recordDefinitionPickerOptions)("ngModel",e.recordDefinitionName)("name","recordDefinition_"+e.guid),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("options",n["\u0275\u0275pipeBind1"](17,48,e.securityFieldDefinitions$)||i.selectFormControlOptions)("ngModel",e.fieldId)("name","fieldId_"+e.guid)("disabled",!e.recordDefinitionName||i.isReadOnly)("appendToBody",!0),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",!e.recordDefinitionName||i.isReadOnly)("options",i.getExpressionFormControlOptions("recordInstance"))("ngModel",e.recordInstance)("name","recordInstance_"+e.guid),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",i.isReadOnly)("options",i.getExpressionFormControlOptions("disabled"))("ngModel",e.disabled)("name","disabled_"+e.guid),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",i.isReadOnly)("options",i.getExpressionFormControlOptions("hidden"))("ngModel",e.hidden)("name","hidden_"+e.guid),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("options",i.availableOnDevicesFormControlOptions)("ngModel",e.availableOnDevices)("name","availableOnDevices_"+e.guid)("disabled",i.isReadOnly)("appendToBody",!0),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngModel",e.actions)("name","action_"+e.guid)}}function Wo(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",45),n["\u0275\u0275element"](1,"adapt-empty-state",46),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.view-components.record-grid-row-actions.empty-state.message")))}function Ho(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",47),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().saveActions()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](10);n["\u0275\u0275property"]("disabled",t.invalid||!e.isDirty()),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.common.save.label")," ")}}function Qo(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span",5),n["\u0275\u0275text"](1," No row actions added. "),n["\u0275\u0275elementEnd"]())}function Jo(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",6),n["\u0275\u0275elementStart"](1,"div",7),n["\u0275\u0275elementStart"](2,"span",8),n["\u0275\u0275text"](3),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",9),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).index;return n["\u0275\u0275nextContext"](2).openEditor(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"button",10),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).index,i=n["\u0275\u0275nextContext"]().ngIf;return n["\u0275\u0275nextContext"]().removeRowAction(t,i)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("title",e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function Ko(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275template"](1,Qo,2,0,"span",3),n["\u0275\u0275template"](2,Jo,6,2,"div",4),n["\u0275\u0275elementEnd"]()),2&e){const e=t.ngIf,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",0===e.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e)("ngForTrackBy",i.trackByForRowActions)}}const Yo=["adaptRxSelect"];function Zo(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"label",5),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e.options.label)}}function er(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-select",6,7),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSelectModelChange(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.ngIf,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("options",e)("required",i.options.required)("disabled",i.isDisabled)("ngModel",i.selectedColumnOption)("optionFormatter",i.optionFormatter)("emptyOption",!0)}}function tr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",8),n["\u0275\u0275elementStart"](1,"button",9),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]();return t.setSortDirection(t.ColumnSortDirection.Asc)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](2,"button",10),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]();return t.setSortDirection(t.ColumnSortDirection.Desc)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275classProp"]("active",e.selectedSortDirection===e.ColumnSortDirection.Asc),n["\u0275\u0275advance"](1),n["\u0275\u0275classProp"]("active",e.selectedSortDirection===e.ColumnSortDirection.Desc)}}const ir=function(e){return{"is-required":e}};function nr(e,t){1&e&&n["\u0275\u0275element"](0,"div",25)}function or(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",26),n["\u0275\u0275text"](1," visible "),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275property"]("title",e.title)}}function rr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",27),n["\u0275\u0275elementStart"](1,"div",28),n["\u0275\u0275elementStart"](2,"button",29),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"]();return t.stopPropagation(),o.moveColumn(i,i+1)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",30),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"]();return t.stopPropagation(),o.moveColumn(i,i-1)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](),t=e.last,i=e.first;n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",t),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",i)}}function ar(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",13),n["\u0275\u0275template"](1,nr,1,0,"div",14),n["\u0275\u0275elementStart"](2,"adapt-accordion-tab",15),n["\u0275\u0275listener"]("open",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!0})("close",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!1}),n["\u0275\u0275elementStart"](3,"div",16),n["\u0275\u0275elementStart"](4,"div",17),n["\u0275\u0275elementStart"](5,"div",18),n["\u0275\u0275elementStart"](6,"div",19),n["\u0275\u0275text"](7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](8,or,2,1,"div",20),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](9,rr,4,2,"div",21),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"adapt-rx-textfield",22),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.title=t}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](11,"adapt-rx-checkbox",23),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.data.visible=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](12,"rx-stepper-with-units-form-control",24),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.data.width=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("cdkDragDisabled",i.isReadOnly)("cdkDragData",e),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!i.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("isOpen",e.isOpen),n["\u0275\u0275advance"](3),n["\u0275\u0275classProp"]("pl-0",i.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("title",e.title),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.title||e.fallbackTitle," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.data.visible),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!i.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",!0)("ngModel",e.title),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngModel",e.data.visible)("disabled",i.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("options",i.columnWidthPropertyOptions)("ngModel",e.data.width)}}function sr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",31),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().saveChanges()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("disabled",!e.isDirty()),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.common.save.label")," ")}}function lr(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"adapt-tag",26),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e)}}function dr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",27),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"]().openPresetColumnsModal(t)}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" +",e.tags.restCount," more ")}}function cr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",13),n["\u0275\u0275elementStart"](1,"adapt-accordion-tab",14),n["\u0275\u0275listener"]("open",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!0})("close",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!1}),n["\u0275\u0275elementStart"](2,"div",15),n["\u0275\u0275elementStart"](3,"div",16),n["\u0275\u0275elementStart"](4,"div",17),n["\u0275\u0275elementStart"](5,"div",18),n["\u0275\u0275text"](6),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](7,"adapt-button",19),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"]().openPresetColumnsModal(t)}),n["\u0275\u0275element"](8,"span",20),n["\u0275\u0275text"](9," Edit grid columns "),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"div",21),n["\u0275\u0275template"](11,lr,2,1,"adapt-tag",22),n["\u0275\u0275template"](12,dr,2,1,"button",23),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](13,"rx-record-grid-sort-editor-control",24),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.sortModel=t})("ngModelChange",function(t){const i=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"]().onSortChange(t,i)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](14,"rx-record-grid-filter-select-control",25),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).$implicit.filters=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("isOpen",e.isOpen),n["\u0275\u0275advance"](4),n["\u0275\u0275property"]("title",e.presetName),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.presetName," "),n["\u0275\u0275advance"](5),n["\u0275\u0275property"]("ngForOf",e.tags.items),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.tags.restCount),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("options",e.sortEditorControlOptions)("disabled",i.isReadOnly)("ngModel",e.sortModel),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("options",e.filterSelectControlOptions)("disabled",i.isReadOnly)("ngModel",e.filters)}}function pr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",28),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().saveChanges()}),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("disabled",!e.isDirty()),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,2,"com.bmc.arsys.rx.client.common.save.label")," ")}}function mr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-button",7),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).openEditor()}),n["\u0275\u0275element"](1,"span",8),n["\u0275\u0275text"](2," Edit view presets "),n["\u0275\u0275elementEnd"]()}}function ur(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span",9),n["\u0275\u0275text"](1," No presets added. "),n["\u0275\u0275elementEnd"]())}function fr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",10),n["\u0275\u0275elementStart"](1,"strong",11),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",12),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).openEditor(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("title",e.name),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function hr(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",2),n["\u0275\u0275template"](1,mr,3,0,"adapt-button",3),n["\u0275\u0275template"](2,ur,2,0,"span",4),n["\u0275\u0275elementStart"](3,"div",5),n["\u0275\u0275template"](4,fr,4,2,"div",6),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.ngIf,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("hidden",!i.options.recordDefinition),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",i.currentPresetSelectorGuid&&0===e.length),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",e)("ngForTrackBy",i.trackByGuid)}}const gr=["filterTemplate"],vr=["visibleColumnsMenuTemplate"];function yr(e,t){1&e&&n["\u0275\u0275element"](0,"adapt-empty-state",5)}function xr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-canvas-outlet",6),n["\u0275\u0275listener"]("beforeViewComponentDrop",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onBeforeViewComponentDrop(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](1,"adapt-table",7,8),n["\u0275\u0275listener"]("onSort",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSort(t)}),n["\u0275\u0275pipe"](3,"async"),n["\u0275\u0275pipe"](4,"async"),n["\u0275\u0275pipe"](5,"async"),n["\u0275\u0275pipe"](6,"async"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("dropListOrientation","horizontal")("dropPredicate",e.model.actionButtonDropPredicate),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("columns",n["\u0275\u0275pipeBind1"](3,15,e.adaptTableConfig$).columns)("sortable",!e.isReadOnly)("scrollable",!0)("scrollHeight","80px")("sortMode","single")("toolbarConfig",n["\u0275\u0275pipeBind1"](4,17,e.adaptTableConfig$).toolbarConfig)("filterable",!1)("sortField",n["\u0275\u0275pipeBind1"](5,19,e.adaptTableConfig$).sortMeta.field)("sortOrder",n["\u0275\u0275pipeBind1"](6,21,e.adaptTableConfig$).sortMeta.order)("bordered",!0)("totalRecords",0)("hasEmptyState",!1)("dontEmitLazyLoadOnInputChange",!1)}}function br(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",11),n["\u0275\u0275text"](1," Filter "),n["\u0275\u0275elementEnd"]())}function Cr(e,t){if(1&e&&(n["\u0275\u0275element"](0,"span",9),n["\u0275\u0275template"](1,br,2,0,"div",10),n["\u0275\u0275pipe"](2,"async")),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](2,1,e.model.enableFiltering$))}}function Sr(e,t){}const wr=["cardLayoutSortModalTemplate"];function Dr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",15),n["\u0275\u0275elementStart"](1,"div",16),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"div",17),n["\u0275\u0275elementStart"](4,"div",18),n["\u0275\u0275elementStart"](5,"button",19),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).onSortDescClick(t)}),n["\u0275\u0275element"](6,"span",20),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](7,"button",19),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).onSortAscClick(t)}),n["\u0275\u0275element"](8,"span",21),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.header),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngClass",i.getSortDescBtnClass(e)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngClass",i.getSortAscBtnClass(e))}}function Rr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",5),n["\u0275\u0275elementStart"](1,"div",6),n["\u0275\u0275elementStart"](2,"div",7),n["\u0275\u0275elementStart"](3,"div",8),n["\u0275\u0275text"](4),n["\u0275\u0275pipe"](5,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](6,"div",9),n["\u0275\u0275text"](7),n["\u0275\u0275pipe"](8,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](9,Dr,9,3,"div",10),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"div"),n["\u0275\u0275element"](11,"textarea",11),n["\u0275\u0275pipe"](12,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](13,"div",12),n["\u0275\u0275elementStart"](14,"button",13),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().clearAllSorting()}),n["\u0275\u0275text"](15),n["\u0275\u0275pipe"](16,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](17,"button",14),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).close;return n["\u0275\u0275nextContext"]().applySorting(),t()}),n["\u0275\u0275text"](18),n["\u0275\u0275pipe"](19,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](20,"button",13),n["\u0275\u0275listener"]("click",function(){return(0,n["\u0275\u0275restoreView"](e).close)()}),n["\u0275\u0275text"](21),n["\u0275\u0275pipe"](22,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](5,8,"com.bmc.arsys.rx.client.view-components.record-grid.cards.sort-by.dialog.field.column.title")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](8,10,"com.bmc.arsys.rx.client.view-components.record-grid.cards.sort-by.dialog.order.column.title")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",e.getSortableColumns()),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("value",e.getCurrentSortingSummary())("placeholder",n["\u0275\u0275pipeBind1"](12,12,"com.bmc.arsys.rx.client.view-components.record-grid.cards.sort-by.dialog.field.summary.empty.title")),n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](16,14,"com.bmc.arsys.rx.client.view-components.record-grid.cards.sort-by.dialog.clear-all.button.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](19,16,"com.bmc.arsys.rx.client.common.apply.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](22,18,"com.bmc.arsys.rx.client.common.cancel.label")," ")}}const Ir=["adaptTable"],Fr=["adaptAdvancedFilter"],Er=["cardLayoutRowDetailsTemplate"],Mr=["cellTemplate"],Ar=["leftCustomSectionTemplate"],Or=["rightCustomSectionTemplate"],Pr=["rowActionButtonsTemplate"];function Tr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",20),n["\u0275\u0275listener"]("click",function(e){return e.stopPropagation()}),n["\u0275\u0275elementStart"](1,"adapt-rx-checkbox",21),n["\u0275\u0275listener"]("ngModelChange",function(t){const i=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).onColumnVisibilityChange(t,i)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("label",e.header||e.fallbackTitle)("ngModel",!e.hidden)}}function Vr(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-empty-state",22),n["\u0275\u0275pipe"](1,"translate")),2&e&&n["\u0275\u0275property"]("type","search")("label",n["\u0275\u0275pipeBind1"](1,2,"com.bmc.arsys.rx.client.view-components.record-grid.visible-columns-menu.empty.label"))}function Nr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-rx-search",17),n["\u0275\u0275listener"]("ngModelChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().columnSearchText=t})("ngModelChange",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSearchColumns()}),n["\u0275\u0275pipe"](1,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](2,Tr,2,2,"div",18),n["\u0275\u0275template"](3,Vr,2,4,"adapt-empty-state",19)}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngModel",e.columnSearchText)("placeholder",n["\u0275\u0275pipeBind1"](1,6,"com.bmc.arsys.rx.client.view-components.record-grid.visible-columns-menu.search.placeholder"))("autofocus",!0),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",e.filteredVisibleColumns)("ngForTrackBy",e.trackByColumnField),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!e.filteredVisibleColumns.length)}}function kr(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275text"](1),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.getMultipleRowsSelectedText()," ")}}function jr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275elementStart"](1,"div",25),n["\u0275\u0275text"](2),n["\u0275\u0275elementStart"](3,"button",26),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).loadTotalRowCount()}),n["\u0275\u0275text"](4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275text"](5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",e.getMultipleRowsSelectedTextFirstPart()," "),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",e.getLoadRecordCountLinkText()," "),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.getMultipleRowsSelectedTextSecondPart()," ")}}function _r(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",23),n["\u0275\u0275template"](1,kr,2,1,"ng-container",24),n["\u0275\u0275template"](2,jr,6,3,"ng-container",24),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isTotalRecordCountKnown),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!e.isTotalRecordCountKnown)}}function Br(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-action-button",34),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]().$implicit,o=n["\u0275\u0275nextContext"](3);n["\u0275\u0275property"]("guid",i.guid)("config",o.getActionButtonConfig(e,i.config))("runtimeViewModelApi",i.runtimeViewModelApi)}}function $r(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",32),n["\u0275\u0275template"](1,Br,1,3,"ng-template",null,33,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275reference"](2);n["\u0275\u0275property"]("adaptSubnavItem",e)}}function Lr(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",28),n["\u0275\u0275template"](1,$r,3,1,"div",29),n["\u0275\u0275elementStart"](2,"div",30),n["\u0275\u0275element"](3,"button",31),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.actionButtons)}}function Gr(e,t){if(1&e&&n["\u0275\u0275template"](0,Lr,4,1,"div",27),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngIf",e.shouldDisplayActionButtons)}}const qr=function(e,t){return{"d-inline-block":e,"d-block":t}};function Ur(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-advanced-filter",39,40),n["\u0275\u0275listener"]("selectedFiltersChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onAdvancedFiltersChange(t)})("deleteSavedFilter",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onDeleteSavedFilterPreset(t)})("createNewFilter",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onCreateNewFilterPreset(t)})("updateSavedFilter",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onUpdateSavedFilterPreset(t)})("activeSavedFilterChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onActiveSavedAdvancedFilterChange(t)})("beforeActiveSavedFilterChange",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onBeforeActiveSavedFilterChange(t)})("editSavedFilterClick",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onEditSavedFilterClick(t)})("filterExpressionTagsChanged",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onAdvancedFilterExpressionTagsChanged(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction2"](12,qr,e.hidden,!e.hidden))("appendDropdownToBody",!0)("texts",t.state.advancedFiltering.filterTexts)("showAnchorButtonLabel",!e.collapsed)("filterOptions",t.state.advancedFiltering.filterOptions)("selectedFilters",t.state.advancedFiltering.selectedFilters)("savedFilters",t.state.advancedFiltering.savedFilters)("enableSavedFilters",!!t.guid&&t.state.enableFilterPresets)("activeSavedFilter",t.state.advancedFiltering.activeSavedFilter)("isLoading",t.state.advancedFiltering.isLoading)("selectedFiltersIndicationStyle","mark")("applyFiltersByUserAction",!0)}}function zr(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span",41),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](n["\u0275\u0275pipeBind2"](2,1,"com.bmc.arsys.rx.client.view-components.record-grid.filters.number-of-active-filters.label",n["\u0275\u0275pureFunction1"](4,De,e.state.advancedFiltering.toolbarTags.length)))}}const Xr=function(e){return{"d-block":e}};function Wr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",35),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onRefreshClick()}),n["\u0275\u0275pipe"](1,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](2,Ur,2,15,"adapt-advanced-filter",36),n["\u0275\u0275template"](3,zr,3,6,"span",37),n["\u0275\u0275elementStart"](4,"rx-filter-tags",38),n["\u0275\u0275listener"]("removeTag",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onRemoveFilterTag(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](9,Xr,e.hidden)),n["\u0275\u0275attribute"]("aria-label",n["\u0275\u0275pipeBind1"](1,7,"com.bmc.arsys.rx.client.common.refresh.label")),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",i.state.enableFiltering),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",(e.collapsed||e.hidden)&&i.state.advancedFiltering.toolbarTags.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("hidden",e.collapsed||e.hidden)("tags",i.state.advancedFiltering.toolbarTags)("tagsLimit",i.state.filterTagsLimit)}}function Hr(e,t){}const Qr=function(e){return{"rx-cell-wrap":e}},Jr=function(e,t){return{column:e,dataItem:t}};function Kr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",44,45),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275reference"](1),o=n["\u0275\u0275nextContext"](),r=o.column,a=o.dataItem;return n["\u0275\u0275nextContext"]().onCellClick(t,[r],a,i)})("mouseover",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onCellMouseOver(t)}),n["\u0275\u0275elementStart"](2,"span",46,47),n["\u0275\u0275listener"]("click",function(e){return e.stopPropagation()}),n["\u0275\u0275template"](4,Hr,0,0,"ng-template",48),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275reference"](1),t=n["\u0275\u0275reference"](3),i=n["\u0275\u0275nextContext"](),o=i.column,r=i.dataItem,a=n["\u0275\u0275nextContext"](),s=n["\u0275\u0275reference"](25),l=n["\u0275\u0275reference"](13);n["\u0275\u0275classProp"]("rx-selected-custom-cell",a.isCellSelected(e)),n["\u0275\u0275property"]("rxCellDisplayProps",o.cellDisplayProperties)("rxCellDisplayPropsBadgeElem",t)("rxCellDisplayPropsDataItem",r)("adaptPopover",s)("autoClose",!1)("popoverClass","table-filtering")("triggers","manual")("appendToBody",!0)("placement","top"),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](14,Qr,o.wrapText)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngTemplateOutlet",o.customTemplate||l)("ngTemplateOutletContext",n["\u0275\u0275pureFunction2"](16,Jr,o,r))}}function Yr(e,t){}function Zr(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",49,45),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275reference"](1),o=n["\u0275\u0275nextContext"](),r=o.column,a=o.dataItem;return n["\u0275\u0275nextContext"]().onCellClick(t,[r],a,i)})("mouseover",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).onCellMouseOver(t)}),n["\u0275\u0275elementStart"](2,"span",46),n["\u0275\u0275listener"]("click",function(e){return e.stopPropagation()}),n["\u0275\u0275template"](3,Yr,0,0,"ng-template",48),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275reference"](1),t=n["\u0275\u0275nextContext"](),i=t.column,o=t.dataItem,r=n["\u0275\u0275nextContext"](),a=n["\u0275\u0275reference"](25),s=n["\u0275\u0275reference"](13);n["\u0275\u0275classProp"]("rx-selected-custom-cell",r.isCellSelected(e)),n["\u0275\u0275property"]("adaptPopover",a)("autoClose",!1)("popoverClass","table-filtering")("triggers","manual")("appendToBody",!0)("placement","top"),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](11,Qr,i.wrapText)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngTemplateOutlet",i.customTemplate||s)("ngTemplateOutletContext",n["\u0275\u0275pureFunction2"](13,Jr,i,o))}}function ea(e,t){if(1&e&&(n["\u0275\u0275template"](0,Kr,5,19,"div",42),n["\u0275\u0275template"](1,Zr,4,16,"div",43)),2&e){const e=t.column;n["\u0275\u0275property"]("ngIf",e.cellDisplayProperties),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!e.cellDisplayProperties)}}function ta(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275elementStart"](1,"span",54),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=e.column,i=e.dataItem,o=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](2,Qr,t.wrapText)),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",o.getCellValue(i,t),"")}}function ia(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"a",55),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"](),i=t.dataItem,o=t.column,r=n["\u0275\u0275nextContext"]();return r.downloadAttachment(i,o,r.getCellValue(i,o))})("keydown",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"](),o=i.dataItem,r=i.column,a=n["\u0275\u0275nextContext"]();return a.downloadAttachment(o,r,a.getCellValue(o,r),t)}),n["\u0275\u0275elementStart"](1,"span",54),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](),t=e.column,i=e.dataItem,o=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](2,Qr,t.wrapText)),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",o.getCellValue(i,t)," ")}}function na(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"a",56),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"](),i=t.dataItem,o=t.column;return n["\u0275\u0275nextContext"]().gridEvents.cellClick(i,o.field)})("keydown",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"](),o=i.dataItem,r=i.column;return n["\u0275\u0275nextContext"]().gridEvents.cellKeyDown(t,o,r.field)}),n["\u0275\u0275elementStart"](1,"span",54),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](),t=e.column,i=e.dataItem,o=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](2,Qr,t.wrapText)),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",o.getCellValue(i,t)," ")}}function oa(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"a",57),n["\u0275\u0275elementStart"](1,"span",54),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=e.dataItem,i=e.column,o=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("routerLink","/"+t[i.field+"$ROUTER_LINK$"])("queryParams",t[i.field+"$QUERY_PARAMS$"]),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](4,Qr,i.wrapText)),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",o.getCellValue(t,i)," ")}}function ra(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"a",58),n["\u0275\u0275elementStart"](1,"span",54),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=e.dataItem,i=e.column,o=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("href",t[i.field+"$LAUNCH_URL$"],n["\u0275\u0275sanitizeUrl"])("target",t[i.field+"$TARGET$"]),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](4,Qr,i.wrapText)),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",o.getCellValue(t,i)," ")}}function aa(e,t){if(1&e&&(n["\u0275\u0275template"](0,ta,3,4,"ng-container",24),n["\u0275\u0275template"](1,ia,3,4,"a",50),n["\u0275\u0275template"](2,na,3,4,"a",51),n["\u0275\u0275template"](3,oa,3,6,"a",52),n["\u0275\u0275template"](4,ra,3,6,"a",53)),2&e){const e=t.dataItem,i=t.column;n["\u0275\u0275property"]("ngIf",(!i.clickable||i.clickableWithHref&&!e[i.field+"$ROUTER_LINK$"]&&!e[i.field+"$LAUNCH_URL$"])&&!i.isDownloadableAttachment),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!i.clickable&&i.isDownloadableAttachment),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",i.clickable&&!i.clickableWithHref),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",i.clickableWithHref&&e[i.field+"$ROUTER_LINK$"]),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",i.clickableWithHref&&e[i.field+"$LAUNCH_URL$"])}}function sa(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-card-layout-cell-header",59),n["\u0275\u0275listener"]("sort",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSortCards(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.column,i=n["\u0275\u0275nextContext"](),o=n["\u0275\u0275reference"](1);n["\u0275\u0275property"]("title",e.header||e.fallbackTitle)("columns",i.adaptTableConfig.columns)("adaptTable",o)("openDialog",i.openSortByDialog)}}function la(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-card-layout-cell-header",59),n["\u0275\u0275listener"]("sort",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSortCards(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.column,i=n["\u0275\u0275nextContext"](),o=n["\u0275\u0275reference"](1);n["\u0275\u0275property"]("title",e.header||e.fallbackTitle)("columns",i.adaptTableConfig.columns)("adaptTable",o)("openDialog",i.openSortByDialog)}}function da(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",62),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275attribute"]("data-testid",e.testId+"-name"),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.header||e.fallbackTitle,": ")}}function ca(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",60),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onCellClick(t)}),n["\u0275\u0275template"](1,da,2,2,"div",61),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.visibleColumns)("ngForTrackBy",e.trackByColumnField)}}const pa=function(e){return{dataItem:e}};function ma(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementContainer"](1,48),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2).dataItem;n["\u0275\u0275nextContext"]();const t=n["\u0275\u0275reference"](29);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",n["\u0275\u0275pureFunction1"](2,pa,e))}}function ua(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]().dataItem,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",i.getCellValue(t,e)," ")}}function fa(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"a",55),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit,i=n["\u0275\u0275nextContext"]().dataItem,o=n["\u0275\u0275nextContext"]();return o.downloadAttachment(i,t,o.getCellValue(i,t))})("keydown",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().$implicit,o=n["\u0275\u0275nextContext"]().dataItem,r=n["\u0275\u0275nextContext"]();return r.downloadAttachment(o,i,r.getCellValue(o,i),t)}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]().dataItem,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",i.getCellValue(t,e)," ")}}function ha(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"a",56),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit,i=n["\u0275\u0275nextContext"]().dataItem;return n["\u0275\u0275nextContext"]().gridEvents.cellClick(i,t.field)})("keydown",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().$implicit,o=n["\u0275\u0275nextContext"]().dataItem;return n["\u0275\u0275nextContext"]().gridEvents.cellKeyDown(t,o,i.field)}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]().dataItem,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",i.getCellValue(t,e)," ")}}function ga(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"a",57),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]().dataItem,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("routerLink","/"+t[e.field+"$ROUTER_LINK$"])("queryParams",t[e.field+"$QUERY_PARAMS$"]),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",i.getCellValue(t,e)," ")}}function va(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"a",58),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]().dataItem,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("href",t[e.field+"$LAUNCH_URL$"],n["\u0275\u0275sanitizeUrl"])("target",t[e.field+"$TARGET$"]),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",i.getCellValue(t,e)," ")}}function ya(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",62),n["\u0275\u0275template"](1,ma,2,4,"div",24),n["\u0275\u0275template"](2,ua,2,1,"div",24),n["\u0275\u0275template"](3,fa,2,1,"a",50),n["\u0275\u0275template"](4,ha,2,1,"a",51),n["\u0275\u0275template"](5,ga,2,3,"a",52),n["\u0275\u0275template"](6,va,2,3,"a",53),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]().dataItem;n["\u0275\u0275attribute"]("data-testid",e.testId+"-value"),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isRowActionsColumn),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",(!e.clickable||e.clickableWithHref&&!i[e.field+"$ROUTER_LINK$"]&&!i[e.field+"$LAUNCH_URL$"])&&!e.isDownloadableAttachment&&!e.isRowActionsColumn),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!e.clickable&&e.isDownloadableAttachment),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.clickable&&!e.clickableWithHref),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.clickableWithHref&&i[e.field+"$ROUTER_LINK$"]),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.clickableWithHref&&i[e.field+"$LAUNCH_URL$"])}}function xa(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",66),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().dataItem,o=n["\u0275\u0275nextContext"]();return o.onFilterBySelection(t,o.visibleColumns,i)}),n["\u0275\u0275elementEnd"]()}}function ba(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",63),n["\u0275\u0275template"](1,ya,7,7,"div",61),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](2,xa,1,0,"button",64),n["\u0275\u0275elementStart"](3,"button",65),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).dataItem,i=n["\u0275\u0275nextContext"]();return i.openRowDetails(i.adaptTableConfig.columns,t)}),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.visibleColumns)("ngForTrackBy",e.trackByColumnField),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isFilterBySelectionButtonVisible),n["\u0275\u0275advance"](1),n["\u0275\u0275attribute"]("aria-label",n["\u0275\u0275pipeBind1"](4,4,"com.bmc.arsys.rx.client.view-components.record-grid.cards.record-details.button.label"))}}function Ca(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",75),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]().getData,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",i.getCellValue(t().rowDataItem,e)," ")}}function Sa(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",76),n["\u0275\u0275elementStart"](1,"a",77),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit,i=n["\u0275\u0275nextContext"]().getData,o=n["\u0275\u0275nextContext"]();return o.downloadAttachment(i().rowDataItem,t,o.getCellValue(i().rowDataItem,t))})("keydown",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().$implicit,o=n["\u0275\u0275nextContext"]().getData,r=n["\u0275\u0275nextContext"]();return r.downloadAttachment(o().rowDataItem,i,r.getCellValue(o().rowDataItem,i),t)}),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"]().getData,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",i.getCellValue(t().rowDataItem,e),"")}}function wa(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",76),n["\u0275\u0275elementContainer"](1,48),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2).getData;n["\u0275\u0275nextContext"]();const t=n["\u0275\u0275reference"](29);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",n["\u0275\u0275pureFunction1"](2,pa,e().rowDataItem))}}function Da(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",71),n["\u0275\u0275elementStart"](1,"div",72),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](3,Ca,2,1,"div",73),n["\u0275\u0275template"](4,Sa,3,1,"div",74),n["\u0275\u0275template"](5,wa,2,4,"div",74),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"]("",e.header||e.fallbackTitle,":"),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!e.isDownloadableAttachment&&!e.isRowActionsColumn),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isDownloadableAttachment),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isRowActionsColumn)}}function Ra(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",67),n["\u0275\u0275template"](1,Da,6,4,"div",68),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](2,"div",69),n["\u0275\u0275elementStart"](3,"button",70),n["\u0275\u0275listener"]("click",function(){return(0,n["\u0275\u0275restoreView"](e).close)()}),n["\u0275\u0275text"](4),n["\u0275\u0275pipe"](5,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.getData;n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e().columns),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](5,2,"com.bmc.arsys.rx.client.common.close.label")," ")}}function Ia(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",78),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().applyFilterBySelection()}),n["\u0275\u0275elementEnd"]()}}function Fa(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-action-button",84),2&e){const e=t.$implicit;n["\u0275\u0275property"]("guid",e.guid)("config",e.config)("runtimeViewModelApi",e.runtimeViewModelApi)}}function Ea(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",79),n["\u0275\u0275listener"]("onOpen",function(){const t=n["\u0275\u0275restoreView"](e).dataItem;return n["\u0275\u0275nextContext"]().onRowActionOpen(t)}),n["\u0275\u0275element"](1,"button",80),n["\u0275\u0275elementStart"](2,"div",81),n["\u0275\u0275template"](3,Fa,1,3,"rx-action-button",82),n["\u0275\u0275elementStart"](4,"div",83),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngForOf",e.rowActionButtons),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,2,"com.bmc.arsys.rx.client.view-components.record-grid-row-actions.no-actions-available.label")," ")}}function Ma(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-action-button",89),2&e){const e=t.$implicit;n["\u0275\u0275property"]("guid",e.guid)("config",e.config)("runtimeViewModelApi",e.runtimeViewModelApi)}}function Aa(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",85),n["\u0275\u0275listener"]("click",function(e){return e.stopPropagation()})("onOpen",function(){const t=n["\u0275\u0275restoreView"](e).dataItem;return n["\u0275\u0275nextContext"]().onRowActionOpen(t)}),n["\u0275\u0275elementStart"](1,"button",86),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"div",87),n["\u0275\u0275template"](5,Ma,1,3,"rx-action-button",88),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,2,"com.bmc.arsys.rx.client.view-components.record-grid-row-actions.dropdown.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngForOf",e.rowActionButtons)}}function Oa(e,t){1&e&&n["\u0275\u0275element"](0,"rx-runtime-view-canvas-outlet")}function Pa(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-runtime-view-canvas-item",6),2&e){const e=n["\u0275\u0275nextContext"](2).$implicit;n["\u0275\u0275property"]("layout",e)}}function Ta(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"adapt-tab-panel",5),n["\u0275\u0275template"](1,Pa,1,1,"rx-runtime-view-canvas-item",4),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().$implicit,t=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("adapt-tab-title",e.state.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.canRenderContentForTab(e))}}function Va(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-runtime-view-canvas-item",6),2&e){const e=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275property"]("layout",e)}}function Na(e,t){if(1&e&&(n["\u0275\u0275template"](0,Ta,2,2,"adapt-tab-panel",3),n["\u0275\u0275template"](1,Va,1,1,"rx-runtime-view-canvas-item",4)),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("ngIf",!i.isHiddenTab(e)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",i.isHiddenTab(e)&&i.canRenderContentForTab(e))}}function ka(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-tabset",1),n["\u0275\u0275listener"]("tab-active-changed",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onActiveTabChanged(t.index)}),n["\u0275\u0275template"](1,Na,2,2,"ng-template",2),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("fullHeight",!0)("tab-active",e.getActiveTabIndexForAdaptTabset()),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.childLayouts)("ngForTrackBy",e.trackByForTabs)}}const ja=["adaptTabset"];function _a(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-tab-panel",4),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("adapt-tab-title",e.data.label)("icon-close",!i.isReadOnly&&i.components.length&&i.components.length>1)("id",e.guid)}}function Ba(e,t){if(1&e&&n["\u0275\u0275element"](0,"img",3),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275styleProp"]("max-width",e.state.maxWidth),n["\u0275\u0275property"]("src",e.state.imageUrl,n["\u0275\u0275sanitizeUrl"]),n["\u0275\u0275attribute"]("alt",e.state.altText)}}function $a(e,t){if(1&e&&n["\u0275\u0275element"](0,"span",4),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275attribute"]("aria-label",e.state.altText)}}function La(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275template"](1,Ba,1,4,"img",1),n["\u0275\u0275template"](2,$a,1,1,"span",2),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275classMapInterpolate1"]("d-flex ",e.state.alignmentStyle," image-container"),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.state.imageUrl),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.state.isImageBroken)}}function Ga(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"p",6),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.view-components.view-preset-selector.view-preset-already-exists.error.message")," "))}function qa(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",14),n["\u0275\u0275element"](1,"adapt-icon",15),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",e.strings.maxRecipientsWarning," ")}}function Ua(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"strong"),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](2,"div"),n["\u0275\u0275text"](3),n["\u0275\u0275elementEnd"]()),2&e){const e=t.result;n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e.text),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.data.emailAddress)}}function za(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",14),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](4);n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e.strings.customPresetsTitle)}}function Xa(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-icon",17),2&e){const e=n["\u0275\u0275nextContext"](5);n["\u0275\u0275property"]("adaptTooltip",e.strings.sharedTooltip)}}function Wa(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",15),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](4).selectPreset(t)}),n["\u0275\u0275text"](1),n["\u0275\u0275template"](2,Xa,1,1,"adapt-icon",16),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](4);n["\u0275\u0275classProp"]("active",e.guid===i.state.appliedViewPresetOption.guid),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.label," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.userSharedViewPresetGuid&&i.isSharingFeatureEnabled)}}function Ha(e,t){1&e&&n["\u0275\u0275element"](0,"div",18)}function Qa(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,za,2,1,"div",6),n["\u0275\u0275template"](2,Wa,3,4,"button",12),n["\u0275\u0275template"](3,Ha,1,0,"div",13),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](3);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isSharingFeatureEnabled),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.state.customViewPresetOptions),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!e.isSharingFeatureEnabled)}}function Ja(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",22),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](4).selectPreset(t)}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](4);n["\u0275\u0275classProp"]("active",e.guid===i.state.appliedViewPresetOption.guid),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function Ka(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275elementStart"](1,"div",14),n["\u0275\u0275text"](2),n["\u0275\u0275elementStart"](3,"button",19),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](3).onAddSharedPresetsClick()}),n["\u0275\u0275element"](4,"adapt-icon",20),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](5,Ja,2,3,"button",21),n["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](3);n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",e.strings.sharedPresetsTitle," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("adaptTooltip",e.strings.addSharedViewPresets),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",e.state.sharedViewPresetOptions)}}function Ya(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",14),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](3);n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](e.strings.systemPresetsTitle)}}function Za(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",23),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](3).selectPreset(t)}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](3);n["\u0275\u0275classProp"]("active",e.guid===i.state.appliedViewPresetOption.guid),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function es(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span",24),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](3);n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.strings.editedViewPresetTagLabel," ")}}function ts(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-button",25),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](3).saveViewPreset()}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2).ngIf,t=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("disabled",e.isOperationInProgress),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",t.strings.saveLabel," ")}}function is(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-button",26),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](3).saveAsViewPreset()}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2).ngIf,t=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("disabled",e.isOperationInProgress),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",t.strings.saveAsLabel," ")}}function ns(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-button",35),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](4).discardViewPresetChanges()}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](4);n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.strings.discardChangesButtonLabel," ")}}function os(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-button",36),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](4).saveAsViewPreset()}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](4);n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.strings.saveAsLabel," ")}}function rs(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-button",37),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](4).renameViewPreset()}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](4);n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.strings.renameLabel," ")}}function as(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-button",38),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"](4);return t.deleteViewPreset(t.state.appliedViewPresetOption)}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](4);n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.strings.deleteLabel," ")}}function ss(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"adapt-button",39),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](4).shareViewPreset()}),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](4);n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.strings.shareLabel," ")}}function ls(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",27),n["\u0275\u0275element"](1,"button",28),n["\u0275\u0275elementStart"](2,"div",29),n["\u0275\u0275template"](3,ns,2,1,"adapt-button",30),n["\u0275\u0275template"](4,os,2,1,"adapt-button",31),n["\u0275\u0275template"](5,rs,2,1,"adapt-button",32),n["\u0275\u0275template"](6,as,2,1,"adapt-button",33),n["\u0275\u0275template"](7,ss,2,1,"adapt-button",34),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2).ngIf,t=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",e.isOperationInProgress)("showCaret",!1),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",e.isViewPresetEdited),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.state.appliedViewPresetOption.isSystem&&!t.state.appliedViewPresetOption.isShared&&e.isViewPresetEdited),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.state.appliedViewPresetOption.isSystem&&!t.state.appliedViewPresetOption.isShared),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.state.appliedViewPresetOption.isSystem),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.state.isSharingEnabled&&!t.state.appliedViewPresetOption.isSystem&&!t.state.appliedViewPresetOption.isShared&&!e.isViewPresetEdited)}}function ds(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",2),n["\u0275\u0275elementStart"](1,"div",3),n["\u0275\u0275elementStart"](2,"button",4),n["\u0275\u0275text"](3),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"div",5),n["\u0275\u0275template"](5,Qa,4,3,"ng-container",0),n["\u0275\u0275template"](6,Ka,6,3,"ng-container",0),n["\u0275\u0275template"](7,Ya,2,1,"div",6),n["\u0275\u0275template"](8,Za,2,3,"button",7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](9,es,2,1,"span",8),n["\u0275\u0275template"](10,ts,2,2,"adapt-button",9),n["\u0275\u0275template"](11,is,2,2,"adapt-button",10),n["\u0275\u0275template"](12,ls,8,7,"div",11),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().ngIf,t=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",e.isOperationInProgress),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",t.state.appliedViewPresetOption.label," "),n["\u0275\u0275advance"](1),n["\u0275\u0275classMapInterpolate1"]("dropdown-menu ",t.isSharingFeatureEnabled?"preset-selector":"",""),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.state.customViewPresetOptions.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.state.isSharingEnabled),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.isSharingFeatureEnabled),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",t.state.systemViewPresetOptions),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isViewPresetEdited),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.state.appliedViewPresetOption.isSystem&&!t.state.appliedViewPresetOption.isShared&&e.isViewPresetEdited),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.state.appliedViewPresetOption.isSystem||t.state.appliedViewPresetOption.isShared||!e.isViewPresetEdited),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isViewPresetEdited||!t.state.appliedViewPresetOption.isSystem)}}function cs(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,ds,13,13,"div",1),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.state)}}function ps(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementContainerStart"](0,2),n["\u0275\u0275elementStart"](1,"div",3),n["\u0275\u0275elementStart"](2,"h1"),n["\u0275\u0275elementStart"](3,"span",4),n["\u0275\u0275text"](4),n["\u0275\u0275pipe"](5,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](6,"div"),n["\u0275\u0275elementStart"](7,"adapt-agreement-card",5),n["\u0275\u0275listener"]("stateChange",function(t){return n["\u0275\u0275restoreView"](e).ngIf.adaptAgreementState=t}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](8,"div",6),n["\u0275\u0275elementStart"](9,"adapt-rx-switch",7),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).ngIf.useAdaptRadar=t}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"div",8),n["\u0275\u0275elementStart"](11,"adapt-rx-switch",9),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).ngIf.loadGainsightFromBmcIt=t}),n["\u0275\u0275pipe"](12,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](13,"adapt-rx-select",10),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).ngIf.deploymentTypeOptions=t}),n["\u0275\u0275pipe"](14,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](15,"adapt-rx-select",11),n["\u0275\u0275listener"]("ngModelChange",function(t){return n["\u0275\u0275restoreView"](e).ngIf.environmentTypeOptions=t}),n["\u0275\u0275pipe"](16,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](17,"div",12),n["\u0275\u0275elementStart"](18,"button",13),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().save()}),n["\u0275\u0275text"](19),n["\u0275\u0275pipe"](20,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=t.ngIf,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate"](n["\u0275\u0275pipeBind1"](5,22,"com.bmc.arsys.rx.client.gainsight.gainsight-settings.title")),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("showOrganizationSettings",!0)("showMarketingSection",!1)("multiProductUsage",!1)("showShadow",!1)("state",e.adaptAgreementState),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("hidden",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("isLabelBefore",!0)("size","lg")("ngModel",e.useAdaptRadar),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](12,24,"com.bmc.arsys.rx.client.gainsight.gainsight-settings.load-gainsight-script-from-bmc-it.label")),n["\u0275\u0275property"]("isLabelBefore",!0)("size","lg")("ngModel",e.loadGainsightFromBmcIt),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](14,26,"com.bmc.arsys.rx.client.gainsight.gainsight-settings.deployment-type.label")),n["\u0275\u0275property"]("options",i.deploymentTypeOptions)("optionFormatter",i.optionFormatter)("ngModel",e.deploymentTypeOptions),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](16,28,"com.bmc.arsys.rx.client.gainsight.gainsight-settings.environment-type.label")),n["\u0275\u0275property"]("options",i.environmentTypeOptions)("ngModel",e.environmentTypeOptions),n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](20,30,"com.bmc.arsys.rx.client.common.save.label")," ")}}function ms(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",14),n["\u0275\u0275element"](1,"adapt-empty-state",15),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.gainsight.feature-is-disabled.label")))}var us,fs,hs,gs;!function(e){e.Primary="primary",e.Secondary="secondary",e.Tertiary="tertiary"}(us||(us={})),function(e){e.Link="link",e.Clear="clear"}(fs||(fs={})),function(e){e.Small="small",e.Default="default",e.Large="large"}(hs||(hs={})),function(e){e.Left="left",e.Right="right"}(gs||(gs={}));class vs{getButtonType(e){let t;switch(e){case us.Secondary:t="secondary";break;case us.Tertiary:t="tertiary";break;default:t="primary"}return t}getIconCssClass(e,t=gs.Left){return e?`d-icon-${t}-${e}`:""}}vs.\u0275fac=function(e){return new(e||vs)},vs.\u0275prov=n["\u0275\u0275defineInjectable"]({token:vs,factory:vs.\u0275fac});const ys="actions";class xs extends c.ViewDesignerComponentModel{constructor(){super(...arguments),this.componentProperties$=this.sandbox.componentProperties$,this.rxRecordDefinitionCacheService=this.injector.get(a.RxRecordDefinitionCacheService),this.viewActionValidatorService=this.injector.get(c.RxViewActionValidatorService),this.translateService=this.injector.get(p.TranslateService),this.label$=this.sandbox.getComponentPropertyValue("labelKey").pipe((0,r.switchMap)(e=>e?(0,o.of)(this.translateService.instant(e)):this.sandbox.getComponentPropertyValue("label")),(0,r.takeUntil)(this.sandbox.destroyed$)),this.style$=this.sandbox.getComponentPropertyValue("style"),this.size$=this.sandbox.getComponentPropertyValue("size"),this.icon$=this.sandbox.getComponentPropertyValue("icon"),this.iconAlignment$=this.sandbox.getComponentPropertyValue("iconAlignment"),this.fieldDefinitions$=this.sandbox.getComponentPropertyValue("recordDefinitionName").pipe((0,r.switchMap)(e=>e?this.rxRecordDefinitionCacheService.getRecordDefinition(e).pipe((0,r.map)(e=>e.fieldDefinitions),(0,r.catchError)(()=>(0,o.of)([]))):(0,o.of)([])))}static getInitialProperties(e){return Object.assign(Object.assign(Object.assign({iconAlignment:gs.Left,label:"New button",size:hs.Default,icon:null,style:us.Primary,recordDefinitionName:null,fieldId:null,recordInstance:null},d.RX_DISABLED_PROP_DEFAULT_VALUE),d.RX_STANDARD_PROPS_DEFAULT_VALUES),e)}rxInit(){(0,o.combineLatest)([this.sandbox.componentProperties$,this.fieldDefinitions$]).pipe((0,r.map)(([e,t])=>this.getInspectorConfig(e,t)),(0,r.take)(1),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.updateInspectorConfig(e)});const e=this.sandbox.getChildComponents();(0,o.combineLatest)([e.pipe((0,r.switchMap)(e=>this.viewActionValidatorService.validate(e,ys))),this.sandbox.getComponentPropertyValue("styles").pipe((0,r.map)(c.validateCssClassNames)),this.sandbox.getComponentPropertyValue(d.RX_AVAILABLE_ON_DEVICES_PROP_NAME).pipe((0,r.map)(c.validateAvailableOnDevicesProp))]).pipe((0,r.map)(m.flatten),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.setValidationIssues(e)}),this.fieldDefinitions$.pipe((0,r.withLatestFrom)(this.componentProperties$),(0,r.map)(([e,t])=>this.getInspectorConfig(t,e))).subscribe(e=>this.sandbox.updateInspectorConfig(e)),this.sandbox.getComponentPropertyValue("recordDefinitionName").pipe((0,r.pairwise)()).subscribe(([e,t])=>{e&&e!==t&&this.sandbox.updateComponentProperties({fieldId:null,recordInstance:null})}),this.label$.subscribe(e=>{this.sandbox.setBreadcrumbs(e)}),this.sandbox.getComponentPropertyValue("action").pipe((0,r.switchMap)(e=>e?o.EMPTY:this.label$),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.setSettablePropertiesDataDictionary(e,[{label:"Disabled",expression:this.getExpressionForProperty("disabled")},{label:"Hidden",expression:this.getExpressionForProperty("hidden")}])})}setValidationIssues(e){this.sandbox.setValidationIssues(e)}getInspectorConfig(e,t){const i=[{name:"recordDefinitionName",component:l.RxDefinitionPickerComponent,options:{label:"Record definition name",tooltip:new s.Tooltip("The view component will be hidden if the user has no access to the specified record definition."),definitionType:l.RxDefinitionPickerType.StandardDataRecord}}];return e.recordDefinitionName&&i.push({name:"fieldId",component:l.SelectFormControlComponent,options:{label:"Field name",tooltip:new s.Tooltip("The view component will be hidden if the user has no access to the specified field, or disabled if the user only has View permission for the specified field. <br><br> Record definition name, Field name, and Record instance must all be specified in order to control the disabled/hidden state of the view component using field permissions."),options:t.map(e=>({name:e.name,id:String(e.id)})),emptyOption:!0}},{name:"recordInstance",component:l.ExpressionInspectorControlComponent,options:{label:"Record instance",tooltip:new s.Tooltip("Expression pointing to a record instance that provides the field permission details.")}}),{inspectorSectionConfigs:[{label:"General",controls:[{name:"label",component:l.TextFormControlComponent,options:{label:"Label"}},{name:"style",component:l.SelectFormControlComponent,options:{label:"Style",required:!0,options:(0,m.map)(us,(e,t)=>({id:e,name:t}))}},{name:"size",component:l.SelectFormControlComponent,options:{label:"Size",options:(0,m.map)(hs,(e,t)=>({id:e,name:t})),sortAlphabetically:!1}},{name:"icon",component:l.IconPickerFormControlComponent,options:{label:"Icon"}},{name:"iconAlignment",component:l.SelectFormControlComponent,options:{label:"Icon alignment",options:(0,m.map)(gs,(e,t)=>({id:e,name:t}))}},(0,c.getDisabledFieldInspectorConfig)(),...(0,c.getStandardPropsInspectorConfigs)()]},{label:"Actions",controls:[{widgetName:ys,component:c.ActionListWidgetComponent}]},{label:"Security",controls:i}]}}}class bs{constructor(e){this.rxActionButtonService=e}ngOnInit(){this.iconCssClass$=(0,o.combineLatest)([this.model.icon$,this.model.iconAlignment$]).pipe((0,r.map)(([e,t])=>this.rxActionButtonService.getIconCssClass(e,t))),this.buttonType$=this.model.style$.pipe((0,r.map)(e=>this.rxActionButtonService.getButtonType(e))),this.size$=this.model.size$.pipe((0,r.map)(e=>e||hs.Default))}}bs.\u0275fac=function(e){return new(e||bs)(n["\u0275\u0275directiveInject"](vs))},bs.\u0275cmp=n["\u0275\u0275defineComponent"]({type:bs,selectors:[["rx-action-button-design"]],inputs:{model:"model"},decls:6,vars:12,consts:[["adapt-button","",3,"btn-type","size","ngClass"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"button",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275pipe"](2,"async"),n["\u0275\u0275pipe"](3,"async"),n["\u0275\u0275text"](4),n["\u0275\u0275pipe"](5,"async"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("btn-type",n["\u0275\u0275pipeBind1"](1,4,t.buttonType$))("size",n["\u0275\u0275pipeBind1"](2,6,t.size$))("ngClass",n["\u0275\u0275pipeBind1"](3,8,t.iconCssClass$)),n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](5,10,t.model.label$),"\n"))},directives:[u.AdaptButtonComponent,f.NgClass],pipes:[f.AsyncPipe],encapsulation:2,changeDetection:0});class Cs{constructor(){this.deprecatedButtonStyles=[fs.Link,fs.Clear]}adaptDefinition(e){(0,m.includes)(this.deprecatedButtonStyles,e.propertiesByName.style)&&(e.propertiesByName.style=us.Tertiary),e.propertiesByName.size||(e.propertiesByName.size=hs.Small),e.propertiesByName.icon&&(e.propertiesByName.icon=(0,m.get)(d.RX_LEGACY_ICONS,e.propertiesByName.icon,e.propertiesByName.icon))}}Cs.\u0275fac=function(e){return new(e||Cs)},Cs.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Cs,factory:Cs.\u0275fac});class Ss{constructor(e,t){this.rxDefinitionAdapterRegistryService=e,this.actionButtonAdapterService=t,this.rxDefinitionAdapterRegistryService.registerDesignAdapter(d.RxViewComponentType.ActionButton,this.actionButtonAdapterService)}}Ss.\u0275fac=function(e){return new(e||Ss)(n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService),n["\u0275\u0275inject"](Cs))},Ss.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ss,declarations:[bs],imports:[f.CommonModule,u.AdaptButtonModule,c.ViewDesignerCanvasModule,c.ActionListWidgetModule,l.IconPickerFormControlModule]}),Ss.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[vs,Cs],imports:[[f.CommonModule,u.AdaptButtonModule,c.ViewDesignerCanvasModule,c.ActionListWidgetModule,l.IconPickerFormControlModule]]});class ws extends h.BaseViewComponent{constructor(e,t,i,n){super(),this.rxLogService=e,this.translateService=t,this.rxNotificationService=i,this.rxActionButtonService=n,this.api={click:this.click.bind(this),setProperty:this.setProperty.bind(this)},this.state={},this.isActionInProgress=!1,this.isDisabled=!1,this.buttonType=""}get hostClass(){const e=this.state,t=`${d.RxViewComponentType.ActionButton}_${e.style}`;return e.styles?`${t} ${e.styles}`:t}ngOnInit(){this.notifyPropertyChanged("api",this.api),this.config.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{if(Object.assign(this.state,e),e.labelKey?this.state.buttonLabel=this.translateService.instant(e.labelKey):this.state.buttonLabel=e.label,this.state.icon="",this.state.cls=e.cls||"",e.iconCls||e.icon){const t=e.iconCls||e.icon,i=(e.label||e.labelKey)&&e.iconAlignment||"left";this.state.icon=this.rxActionButtonService.getIconCssClass(t,i)}e.iconCls&&e.icon&&this.rxLogService.warning("iconCls option is specified, icon will be ignored."),e.cls||(this.buttonType=this.rxActionButtonService.getButtonType(this.state.style)),e.cls&&e.style&&this.rxLogService.warning("cls option is specified, style will be ignored."),this.validateRecordDefinitionName(),this.isHidden=this.isHiddenFunc(),this.isDisabled=this.isDisabledFunc()})}click(){if(!this.isDisabled)return this.isActionInProgress=!0,this.isDisabled=!0,this.triggerViewActions().then(e=>{this.isActionInProgress=!1,this.isDisabled=this.isDisabledFunc()}).catch(e=>{this.isActionInProgress=!1,this.isDisabled=this.isDisabledFunc()})}isDisabledFunc(){return Boolean(this.state.disabled)||this.isActionInProgress||this.state.recordInstance&&this.state.fieldId&&this.state.recordInstance.recordDefinitionName===this.state.recordDefinitionName&&(0,m.find)(this.state.recordInstance.fieldInstances,{id:Number(this.state.fieldId)})&&(0,m.find)(this.state.recordInstance.fieldInstances,{id:Number(this.state.fieldId)}).permissionType===a.RX_RECORD_DEFINITION.fieldPermissionTypes.view}isHiddenFunc(){return this.isHidden=Boolean(this.state.hidden)||this.state.recordInstance&&(this.state.recordInstance.recordDefinitionName!==this.state.recordDefinitionName||this.state.fieldId&&!(0,m.find)(this.state.recordInstance.fieldInstances,{id:Number(this.state.fieldId)}))}setProperty(e,t){if(!(0,m.includes)(["hidden","disabled"],e))return(0,o.throwError)(`Action Button: property ${e} is not settable.`);this.state[e]=t,this.notifyPropertyChanged(e,this.state[e])}validateRecordDefinitionName(){if(this.state.recordInstance&&this.state.recordInstance.recordDefinitionName!==this.state.recordDefinitionName){const e=this.translateService.instant("com.bmc.arsys.rx.client.view-components.action-button.component-name.label",{label:this.state.label}),t=this.translateService.instant("com.bmc.arsys.rx.client.view-components.action-button.configuration-error.message",{componentName:e});this.rxNotificationService.addErrorMessage(t)}}}ws.\u0275fac=function(e){return new(e||ws)(n["\u0275\u0275directiveInject"](s.RxLogService),n["\u0275\u0275directiveInject"](p.TranslateService),n["\u0275\u0275directiveInject"](s.RxNotificationService),n["\u0275\u0275directiveInject"](vs))},ws.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ws,selectors:[["rx-action-button"]],hostVars:2,hostBindings:function(e,t){2&e&&n["\u0275\u0275classMap"](t.hostClass)},inputs:{guid:"guid",config:"config",runtimeViewModelApi:"runtimeViewModelApi"},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[["adapt-button","","type","button","class","mw-100 rx-ellipsis",3,"btn-type","ngClass","disabled","size","click",4,"ngIf"],["adapt-button","","type","button",1,"mw-100","rx-ellipsis",3,"btn-type","ngClass","disabled","size","click"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,k,3,8,"button",0),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,u.AdaptButtonComponent,f.NgClass],styles:["[_nghost-%COMP%]{display:block}"]});class Ds{constructor(e,t){this.rxDefinitionAdapterRegistryService=e,this.actionButtonAdapterService=t,this.rxDefinitionAdapterRegistryService.registerRuntimeAdapter(d.RxViewComponentType.ActionButton,this.actionButtonAdapterService)}}var Rs;Ds.\u0275fac=function(e){return new(e||Ds)(n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService),n["\u0275\u0275inject"](Cs))},Ds.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ds,declarations:[ws],imports:[u.AdaptButtonModule,f.CommonModule,p.TranslateModule,u.AdaptIconModule],exports:[ws]}),Ds.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[vs,Cs],imports:[[u.AdaptButtonModule,f.CommonModule,p.TranslateModule,u.AdaptIconModule]]}),function(e){e.Left="left",e.Right="right",e.Center="center"}(Rs||(Rs={}));const Is={alignmentOptions:{left:{id:Rs.Left,name:"Left",cls:"align-left"},center:{id:Rs.Center,name:"Center",cls:"align-center"},right:{id:Rs.Right,name:"Right",cls:"align-right"}}};class Fs{getAlignClass(e){return(0,m.get)(Is.alignmentOptions,[e,"cls"],"")}}Fs.\u0275fac=function(e){return new(e||Fs)},Fs.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Fs,factory:Fs.\u0275fac});class Es extends ws{}Es.\u0275fac=function(){let e;return function(t){return(e||(e=n["\u0275\u0275getInheritedFactory"](Es)))(t||Es)}}(),Es.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Es,selectors:[["rx-button-bar-dropdown-item-component"]],inputs:{guid:"guid",config:"config",runtimeViewModelApi:"runtimeViewModelApi"},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[["type","button","class","dropdown-item",3,"disabled","click",4,"ngIf"],["type","button",1,"dropdown-item",3,"disabled","click"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,j,2,2,"button",0),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf],encapsulation:2});class Ms extends h.BaseViewComponent{constructor(e,t,i,n,r,a){super(),this.elementRef=e,this.runtimeCanvasItemComponent=t,this.changeDetector=i,this.ngZone=n,this.rxButtonBarService=r,this.renderer=a,this.api={setProperty:this.setProperty.bind(this)},this.childLayouts=null,this.isDropdownVisible=!1,this.resize$=new o.Subject,this.onResizeThrottled=(0,m.throttle)(this.onResize.bind(this),100)}ngOnInit(){super.ngOnInit(),this.notifyPropertyChanged("api",this.api),this.config.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.isHidden=Boolean(e.hidden),this.alignClass=this.rxButtonBarService.getAlignClass(e.alignment)}),this.childLayouts=(0,m.get)(this.runtimeCanvasItemComponent.getChildren(d.RX_VIEW_DEFINITION.defaultOutletName),"[0].children")}ngAfterViewInit(){const e=this.renderer.selectRootElement(this.elementRef.nativeElement,!0);if(!(0,m.isEmpty)(this.childLayouts)){const t=this.childLayouts.map(e=>e.config);this.ngZone.runOutsideAngular(()=>{this.resizeSensor=new g.ResizeSensor(e,e=>{this.ngZone.run(()=>this.resize$.next(e))})}),(0,o.merge)(...t,this.resize$).pipe((0,r.map)(t=>t.width||e.offsetWidth),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>this.onResizeThrottled(e))}this.onResize(e.offsetWidth),this.changeDetector.detectChanges()}ngOnDestroy(){super.ngOnDestroy(),this.resizeSensor&&this.resizeSensor.detach()}onResize(e){let t=0;const i=this.dropdownToggleButton?this.renderer.selectRootElement(this.dropdownToggleButton.nativeElement,!0).offsetWidth:0;this.buttonItemsQueryList.forEach((n,o)=>{t+=this.renderer.selectRootElement(n.nativeElement,!0).offsetWidth;const r=Math.floor(e)>=Math.ceil(t)+i;this.childLayouts[o].showInDropdown=!r,!(0,m.isUndefined)(this.childLayouts[o-1])&&this.childLayouts.filter(e=>e.showInDropdown).length<2&&(this.childLayouts[o-1].showInDropdown=!r)}),this.isDropdownVisible=!(0,m.isEmpty)(this.childLayouts)&&(0,m.last)(this.childLayouts).showInDropdown}trackByFn(e,t){return t.guid}setProperty(e,t){if("hidden"!==e)return(0,o.throwError)(`Button Bar: property ${e} is not settable.`);this.isHidden=t,this.notifyPropertyChanged(e,this.isHidden)}}Ms.\u0275fac=function(e){return new(e||Ms)(n["\u0275\u0275directiveInject"](n.ElementRef),n["\u0275\u0275directiveInject"](h.RuntimeViewCanvasItemComponent),n["\u0275\u0275directiveInject"](n.ChangeDetectorRef),n["\u0275\u0275directiveInject"](n.NgZone),n["\u0275\u0275directiveInject"](Fs),n["\u0275\u0275directiveInject"](n.Renderer2))},Ms.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Ms,selectors:[["rx-button-bar"]],viewQuery:function(e,t){if(1&e&&(n["\u0275\u0275viewQuery"](_,5,n.ElementRef),n["\u0275\u0275viewQuery"](B,5,n.ElementRef)),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.dropdownToggleButton=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.buttonItemsQueryList=e)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[["class","button-container",3,"ngClass",4,"ngIf"],[1,"button-container",3,"ngClass"],[3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","dropdown","adaptDropdown","",3,"placement",4,"ngIf"],[3,"ngClass"],[3,"layout"],["buttonItems",""],["adaptDropdown","",1,"dropdown",3,"placement"],["type","button","adaptDropdownToggle","",1,"btn","btn-secondary","rx-toggle"],["dropdownToggle",""],["adaptDropdownMenu","",1,"dropdown-menu"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"config","runtimeViewModelApi","guid",4,"ngIf"],[3,"config","runtimeViewModelApi","guid"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,X,3,4,"div",0),2&e&&n["\u0275\u0275property"]("ngIf",t.childLayouts&&!t.isHidden)},directives:[f.NgIf,f.NgClass,f.NgForOf,h.RuntimeViewCanvasItemComponent,u.AdaptDropdownDirective,u.AdaptDropdownToggleDirective,u.AdaptDropdownMenuDirective,Es],styles:["[_nghost-%COMP%]{display:block}.button-container[_ngcontent-%COMP%]{display:flex}.button-container.align-center[_ngcontent-%COMP%]{justify-content:center}.button-container.align-right[_ngcontent-%COMP%]{justify-content:flex-end}.button-container.align-left[_ngcontent-%COMP%]{justify-content:flex-start}.button-container[_ngcontent-%COMP%]   rx-runtime-view-canvas-item[_ngcontent-%COMP%]{display:inline-block}.button-container[_ngcontent-%COMP%]   rx-runtime-view-canvas-item[_ngcontent-%COMP%]:not(:has( > [hidden]))[_ngcontent-%COMP%]{padding-right:5px}.rx-toggle[_ngcontent-%COMP%]{padding-left:1px;height:100%}"]});class As{}As.\u0275fac=function(e){return new(e||As)},As.\u0275mod=n["\u0275\u0275defineNgModule"]({type:As,declarations:[Ms,Es],imports:[f.CommonModule,h.RuntimeViewCanvasModule,u.AdaptDropdownModule],exports:[Ms]}),As.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[Fs],imports:[[f.CommonModule,h.RuntimeViewCanvasModule,u.AdaptDropdownModule.forRoot()]]});class Os extends c.ViewDesignerComponentModel{constructor(){super(...arguments),this.hasChildren$=this.sandbox.getChildComponentGuids().pipe((0,r.map)(e=>!(0,m.isEmpty)(e))),this.componentProperties$=this.sandbox.componentProperties$}static getInitialProperties(e){return Object.assign(Object.assign({alignment:Rs.Left,name:null},d.RX_STANDARD_PROPS_DEFAULT_VALUES),e)}rxInit(){this.componentProperties$.pipe((0,r.take)(1)).subscribe(()=>{this.sandbox.updateInspectorConfig(this.getInspector())}),this.sandbox.getComponentPropertyValue("name").subscribe(e=>{const t=e?`${this.sandbox.descriptor.name} (${e})`:this.sandbox.descriptor.name;this.sandbox.setSettablePropertiesDataDictionary(t,[{label:"Hidden",expression:this.getExpressionForProperty("hidden")}])}),this.componentProperties$.subscribe(e=>{this.validate(e)})}dropPredicate(e){return e.draggedViewComponentDescriptor.type===d.RxViewComponentType.ActionButton}validate(e){this.sandbox.setValidationIssues((0,c.validateStandardProps)(e))}getInspector(){return{inspectorSectionConfigs:[{label:"General",controls:[{name:"name",component:l.TextFormControlComponent,options:{label:"Name",tooltip:new s.Tooltip("Enter a name to uniquely identify the Button bar.")}},{name:"alignment",component:l.SelectFormControlComponent,options:{label:"Alignment",options:(0,m.values)(Is.alignmentOptions),sortAlphabetically:!1}},...(0,c.getStandardPropsInspectorConfigs)()]}]}}}class Ps{constructor(e){this.rxButtonBarService=e,this.alignment="",this.destroyed$=new o.ReplaySubject(1)}ngOnInit(){this.model.componentProperties$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.alignment=this.rxButtonBarService.getAlignClass(e.alignment)})}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}}Ps.\u0275fac=function(e){return new(e||Ps)(n["\u0275\u0275directiveInject"](Fs))},Ps.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Ps,selectors:[["rx-button-bar-design"]],inputs:{model:"model"},decls:2,vars:6,consts:[["dropListOrientation","horizontal",1,"button-bar-design-container","border",3,"ngClass","dropPredicate"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"rx-canvas-outlet",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275classProp"]("border-transparent",n["\u0275\u0275pipeBind1"](1,4,t.model.hasChildren$)),n["\u0275\u0275property"]("ngClass",t.alignment)("dropPredicate",t.model.dropPredicate))},directives:[c.CanvasOutletComponent,f.NgClass],pipes:[f.AsyncPipe],styles:["[_nghost-%COMP%]  .button-bar-design-container{display:block}[_nghost-%COMP%]  .button-bar-design-container.align-center .cdk-drop-list{justify-content:center}[_nghost-%COMP%]  .button-bar-design-container.align-right .cdk-drop-list{justify-content:flex-end}[_nghost-%COMP%]  .button-bar-design-container.align-left .cdk-drop-list{justify-content:flex-start}[_nghost-%COMP%]  .button-bar-design-container rx-canvas-item-container{min-width:100%}[_nghost-%COMP%]  .button-bar-design-container rx-canvas-item-container .cdk-drop-list{min-height:50px;display:flex;flex-flow:row wrap}.border-transparent[_ngcontent-%COMP%]{border-color:transparent!important}"]});class Ts{}Ts.\u0275fac=function(e){return new(e||Ts)},Ts.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ts,declarations:[Ps],imports:[f.CommonModule,c.ViewDesignerCanvasModule]}),Ts.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[Fs],imports:[[f.CommonModule,c.ViewDesignerCanvasModule]]});class Vs extends h.BaseViewComponent{constructor(e,t){super(),this.elementRef=e,this.renderer=t,this.state={},this.api={setProperty:this.setProperty.bind(this)}}ngOnInit(){super.ngOnInit(),this.notifyPropertyChanged("api",this.api),this.config.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.isHidden=Boolean(e.hidden),this.state=Object.assign({},e)})}setProperty(e,t){if("hidden"!==e){const t=this.renderer.selectRootElement(this.elementRef.nativeElement,!0).tagName.toLowerCase();return(0,o.throwError)(`${t}: property ${e} is not settable.`)}this.state.hidden=t,this.notifyPropertyChanged(e,t)}}Vs.\u0275fac=function(e){return new(e||Vs)(n["\u0275\u0275directiveInject"](n.ElementRef),n["\u0275\u0275directiveInject"](n.Renderer2))},Vs.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Vs,selectors:[["rx-container"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[[3,"hidden"]],template:function(e,t){1&e&&n["\u0275\u0275element"](0,"rx-runtime-view-canvas-outlet",0),2&e&&n["\u0275\u0275property"]("hidden",t.state.hidden)},directives:[h.RuntimeViewCanvasOutletComponent],styles:["[_nghost-%COMP%]{display:block}.rx-auto-fill[_nghost-%COMP%] >rx-runtime-view-canvas-outlet>rx-runtime-view-canvas-item-container{display:flex;flex-direction:column;height:100%}"]});class Ns{constructor(e,t){this.viewDefinitionParserService=e,this.rxJsonParserService=t,this.componentDefinitionType=d.RxViewComponentType.Container}adaptDefinition(e){this.viewDefinitionParserService.getComponents(e).filter(e=>e.componentDefinition.type===this.componentDefinitionType).map(e=>e.componentDefinition).forEach(e=>{if(e.layout){let t=this.rxJsonParserService.tryParseJson(e.layout);if(t&&t.componentDefinitionId){const i=t.columns.map(t=>{const i=e.propertiesByName.rowWrap||"sm",n=t.span||12;return{cssClass:`${"xs"===i?`col-${n}`:`col-${i}-${n}`} ${"xs"!==i?`rx-mb-${i}`:""}`,children:t.children.map(e=>e.componentDefinitionId)}});t={outlets:[{name:"DEFAULT",columns:i}]},e.layout=JSON.stringify(t)}else t&&t.outlets&&(t.outlets.forEach(t=>{t.columns.filter(e=>!e.cssClass).forEach(t=>{const i=e.propertiesByName.rowWrap||"sm",n=t.span||12,o="xs"===i?`col-${n}`:`col-${i}-${n}`,r="xs"!==i?`rx-mb-${i}`:"";t.cssClass=`${o} ${r}`})}),e.layout=JSON.stringify(t))}})}}Ns.\u0275fac=function(e){return new(e||Ns)(n["\u0275\u0275inject"](d.RxViewDefinitionParserService),n["\u0275\u0275inject"](v.RxJsonParserService))},Ns.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Ns,factory:Ns.\u0275fac,providedIn:"root"});class ks{constructor(e,t){this.containerComponentDefinitionAdapterService=e,this.rxDefinitionAdapterRegistryService=t,t.registerRuntimeAdapter(d.RxViewComponentType.Container,this.containerComponentDefinitionAdapterService)}}ks.\u0275fac=function(e){return new(e||ks)(n["\u0275\u0275inject"](Ns),n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService))},ks.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ks,declarations:[Vs],imports:[f.CommonModule,h.RuntimeViewCanvasModule],exports:[Vs]}),ks.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,h.RuntimeViewCanvasModule]]});class js extends c.CanvasItemContainerComponent{constructor(e,t,i,o){super(e,t),this.canvasItemApi=e,this.canvasOutletHelperService=t,this.elementRef=i,this.renderer=o,this.maxNumberOfColumns=12,this.defaultGutterStep=50,this.percentSpanSize=100/this.maxNumberOfColumns,this.gutterStep=this.defaultGutterStep,this.columnResize=new n.EventEmitter}onWindowResize(){this.setGutterStep()}ngAfterViewInit(){const e=this.outlet.columns.map(e=>e.span);this.setSpanSizes(e),this.setGutterStep()}onDragEnd(e){const t=this.getPercentToSpanSizes(e.sizes);this.columnResize.emit(t),this.setSpanSizes(t)}getPercentToSpanSizes(e){return e.map(e=>Math.round(e*this.maxNumberOfColumns/100))}setSpanSizes(e){this.splitComponent.setVisibleAreaSizes(this.getSpanToPercentSizes(e))}getSpanToPercentSizes(e){return e.map(e=>e*this.percentSpanSize)}setGutterStep(){const e=this.renderer.selectRootElement(this.elementRef.nativeElement,!0);this.gutterStep=Math.round(e.clientWidth/this.maxNumberOfColumns)||this.defaultGutterStep}}var _s;js.\u0275fac=function(e){return new(e||js)(n["\u0275\u0275directiveInject"](c.ViewDesignerCanvasItemApiToken),n["\u0275\u0275directiveInject"](c.CanvasOutletHelperService),n["\u0275\u0275directiveInject"](n.ElementRef),n["\u0275\u0275directiveInject"](n.Renderer2))},js.\u0275cmp=n["\u0275\u0275defineComponent"]({type:js,selectors:[["rx-container-canvas-item"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](y.SplitComponent,7),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.splitComponent=e.first)}},hostBindings:function(e,t){1&e&&n["\u0275\u0275listener"]("resize",function(){return t.onWindowResize()},!1,n["\u0275\u0275resolveWindow"])},outputs:{columnResize:"columnResize"},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:9,consts:[["unit","percent","gutterSize","1",3,"gutterStep","dragEnd"],["minSize","8",4,"ngFor","ngForOf","ngForTrackBy"],["minSize","8"],[3,"isReadOnly","colIndex","column","layout","dropListDropped"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"as-split",0),n["\u0275\u0275listener"]("dragEnd",function(e){return t.onDragEnd(e)}),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275template"](2,W,2,4,"as-split-area",1),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275classProp"]("selected",n["\u0275\u0275pipeBind1"](1,7,t.layout.isSelected$))("readonly",t.isReadOnly),n["\u0275\u0275property"]("gutterStep",t.gutterStep),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",t.outlet.columns)("ngForTrackBy",t.trackByColFn))},directives:[y.SplitComponent,f.NgForOf,y.SplitAreaDirective,c.CanvasItemColumnComponent],pipes:[f.AsyncPipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{display:block}as-split[_ngcontent-%COMP%]:not(.readonly).selected    >.as-split-gutter{visibility:visible}as-split[_ngcontent-%COMP%]     as-split-area{height:revert!important;min-height:200px}as-split[_ngcontent-%COMP%]     as-split-area>rx-canvas-item-column{height:100%}as-split[_ngcontent-%COMP%]     as-split-area>rx-canvas-item-column>.cdk-drop-list{height:100%;min-height:auto}as-split[_ngcontent-%COMP%]     .as-split-gutter{visibility:hidden;height:revert!important;position:relative;background-color:#d6d7d8!important}as-split[_ngcontent-%COMP%]     .as-split-gutter .as-split-gutter-icon{border:1px solid #d6d7d8;height:72px!important;width:11px!important;background:white!important;border-radius:2px;position:absolute}as-split[_ngcontent-%COMP%]     .as-split-gutter .as-split-gutter-icon:hover:before, as-split[_ngcontent-%COMP%]     .as-split-gutter .as-split-gutter-icon:hover:after{background-color:#d6d7d8}as-split[_ngcontent-%COMP%]     .as-split-gutter .as-split-gutter-icon:before, as-split[_ngcontent-%COMP%]     .as-split-gutter .as-split-gutter-icon:after{display:inline-block;content:"";position:absolute;top:50%;width:2px;height:64px;background-color:#f0f1f1;border-radius:2px;transform:translateY(-50%);transition:background-color .25s ease}as-split[_ngcontent-%COMP%]     .as-split-gutter .as-split-gutter-icon:before{left:2px}as-split[_ngcontent-%COMP%]     .as-split-gutter .as-split-gutter-icon:after{left:5px}']}),function(e){e.Xs="xs",e.Sm="sm",e.Md="md",e.Lg="lg",e.Xl="xl",e.Xxl="xxl"}(_s||(_s={}));const Bs={type:d.RxViewComponentType.Container,maxColumnSpan:12,rowWrapOptions:{xs:{id:_s.Xs,name:"Extra Small (No wrapping)"},sm:{id:_s.Sm,name:"Small (576 px)"},md:{id:_s.Md,name:"Medium (768 px)"},lg:{id:_s.Lg,name:"Large (992 px)"},xl:{id:_s.Xl,name:"Extra Large (1200 px)"},xxl:{id:_s.Xxl,name:"Extra Extra Large (1600 px)"}}},$s=d.RX_VIEW_DEFINITION.styles.map(e=>({text:e.name,data:{value:e.id}}));class Ls extends c.ViewDesignerComponentModel{constructor(){super(...arguments),this.componentProperties$=this.sandbox.componentProperties$,this.hasChildren$=this.sandbox.getChildComponentGuids().pipe((0,r.map)(e=>!(0,m.isEmpty)(e)))}static getInitialProperties(e){return Object.assign(Object.assign({name:null,rowWrap:_s.Sm,columnCount:"1"},d.RX_STANDARD_PROPS_DEFAULT_VALUES),e)}rxInit(){this.componentProperties$.pipe((0,r.take)(1)).subscribe(()=>{this.sandbox.updateInspectorConfig(this.getInspector())}),this.componentProperties$.subscribe(e=>this.validate(e)),this.sandbox.getComponentPropertyValue("columnCount").pipe((0,r.skip)(1),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.setLayout(this.getDefaultColumnSpans(Number(e)))}),this.sandbox.getComponentPropertyValue("name").subscribe(e=>{const t=e?`${this.sandbox.descriptor.name} (${e})`:this.sandbox.descriptor.name;this.sandbox.setSettablePropertiesDataDictionary(t,[{label:"Hidden",expression:this.getExpressionForProperty("hidden")}])})}validate(e){this.sandbox.setValidationIssues((0,c.validateStandardProps)(e))}getPropertiesByName(e){const t=Object.assign({},e);return t.styles||delete t.styles,t}setContainerLayout(e){this.sandbox.setLayout(e)}getDefaultColumnSpans(e){const t=[],i=Math.floor(Bs.maxColumnSpan/e);return(0,m.times)(e,()=>t.push(i)),t[t.length-1]=Bs.maxColumnSpan%e+i,t}getInspector(){return{inspectorSectionConfigs:[{label:"General",controls:[{name:"name",component:l.TextFormControlComponent,options:{label:"Name",tooltip:new s.Tooltip("Enter a name to uniquely identify the Container.")}},{name:"columnCount",component:l.SelectFormControlComponent,options:{label:"Number of columns",required:!0,tooltip:new s.Tooltip("Resize container columns on the canvas by dragging the dashed column separator line."),options:(0,m.times)(6,e=>({id:(++e).toString(),name:e.toString()}))}},{name:"rowWrap",component:l.SelectFormControlComponent,options:{label:"Row wrap",sortAlphabetically:!1,options:(0,m.values)(Bs.rowWrapOptions),tooltip:new s.Tooltip("The Row wrap property controls the layout of multi-column containers based on\n                    the width of the view. When the width of the view is decreased to a width less\n                    than the selected Row wrap value, each container column after the first one\n                    wraps onto a new line.")}},(0,c.getHiddenFieldInspectorConfig)(),(0,c.getAvailableOnDevicesInspectorConfig)(),(0,c.getStylesFieldInspectorConfig)($s)]}]}}}class Gs{constructor(){this.containerCanvasItemComponent=js,this.destroyed$=new o.ReplaySubject(1)}ngAfterViewInit(){this.canvasOutletComponent.containerComponentInstance.columnResize.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.model.setContainerLayout(e)})}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}}Gs.\u0275fac=function(e){return new(e||Gs)},Gs.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Gs,selectors:[["rx-container-design"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](c.CanvasOutletComponent,7),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.canvasOutletComponent=e.first)}},inputs:{model:"model"},decls:2,vars:5,consts:[[1,"border","d-block",3,"containerComponent"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"rx-canvas-outlet",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275classProp"]("has-children",n["\u0275\u0275pipeBind1"](1,3,t.model.hasChildren$)),n["\u0275\u0275property"]("containerComponent",t.containerCanvasItemComponent))},directives:[c.CanvasOutletComponent],pipes:[f.AsyncPipe],styles:[".has-children[_ngcontent-%COMP%]    >rx-container-canvas-item>as-split>as-split-area{min-height:auto}"]});class qs{}qs.\u0275fac=function(e){return new(e||qs)},qs.\u0275mod=n["\u0275\u0275defineNgModule"]({type:qs,declarations:[Gs,js],imports:[f.CommonModule,c.ViewDesignerCanvasModule,y.AngularSplitModule,x.DragDropModule]}),qs.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[vs],imports:[[f.CommonModule,c.ViewDesignerCanvasModule,y.AngularSplitModule,x.DragDropModule]]});const Us={type:d.RxViewComponentType.RecordEditor,fieldTypes:{[a.RX_RECORD_DEFINITION.resourceTypes.character]:d.RxViewComponentType.Character,[a.RX_RECORD_DEFINITION.resourceTypes.dateTime]:d.RxViewComponentType.DateTime,[a.RX_RECORD_DEFINITION.resourceTypes.selection]:d.RxViewComponentType.Selection,[a.RX_RECORD_DEFINITION.resourceTypes.timeOnly]:d.RxViewComponentType.Time,[a.RX_RECORD_DEFINITION.resourceTypes.dateOnly]:d.RxViewComponentType.Date,[a.RX_RECORD_DEFINITION.resourceTypes.boolean]:d.RxViewComponentType.Boolean,[a.RX_RECORD_DEFINITION.resourceTypes.attachment]:d.RxViewComponentType.Attachment,[a.RX_RECORD_DEFINITION.resourceTypes.integer]:d.RxViewComponentType.Integer,[a.RX_RECORD_DEFINITION.resourceTypes.real]:d.RxViewComponentType.Floating,[a.RX_RECORD_DEFINITION.resourceTypes.decimal]:d.RxViewComponentType.Decimal,[a.RX_RECORD_DEFINITION.resourceTypes.localizedCharacter]:d.RxViewComponentType.LocalizedCharacter}};var zs,Xs,Ws;!function(e){e.Create="CREATE",e.Edit="EDIT",e.BulkEdit="BULK EDIT",e.Temporary="TEMPORARY"}(zs||(zs={})),function(e){e.Read="READ",e.Edit="EDIT"}(Xs||(Xs={}));class Hs{constructor(e,t){this.context=e,this.stringService=t,this.selectedFieldIdsModel={},this.availableFieldGroups=[],this.hideSystemFields=!1,this.isApplyButtonDisabled=!0,this.selectedFieldDefinitionIds=[],this.availableFieldDefinitions=[]}ngOnInit(){const e=this.context.getData();this.availableFieldDefinitions=e.availableFields,this.selectedFieldDefinitionIds=e.selectedFieldIds,this.hideSystemFields=Boolean(e.hideSystemFields),this.availableFieldGroups=this.groupFieldsByFieldOption(this.availableFieldDefinitions),this.selectedFieldIdsModel=this.idsToModel(this.selectedFieldDefinitionIds)}closeModal(){this.context.close(this.modelToIds(this.selectedFieldIdsModel))}search(e){this.availableFieldGroups=this.groupFieldsByFieldOption(this.availableFieldDefinitions).map(t=>Object.assign(Object.assign({},t),{fields:t.fields.filter(t=>this.stringService.caseInsensitiveSearch(t.name,e))})).filter(e=>!(0,m.isEmpty)(e.fields))}select(e){if("all"===e){const e=this.availableFieldDefinitions.filter(e=>e.fieldOption!==a.RecordFieldOption.System||!this.hideSystemFields).map(e=>e.id);this.selectedFieldIdsModel=this.idsToModel(e)}else{const t=this.availableFieldGroups.find(t=>t.groupLabel===e).fields.map(e=>e.id);this.selectedFieldIdsModel=Object.assign(Object.assign({},this.selectedFieldIdsModel),this.idsToModel(t))}this.updateApplyButtonDisabledStatus()}updateApplyButtonDisabledStatus(){this.isApplyButtonDisabled=!(0,m.xor)(this.selectedFieldDefinitionIds,this.modelToIds(this.selectedFieldIdsModel)).length}groupFieldsByFieldOption(e){const t=(0,m.groupBy)(e,"fieldOption"),i=[a.RecordFieldOption.Required,a.RecordFieldOption.Optional];return this.hideSystemFields||i.push(a.RecordFieldOption.System),i.filter(e=>t[e]).map(e=>({groupLabel:`${this.stringService.prettify(e)} fields`,selectAllFieldsInGroupButtonLabel:`Select all ${e.toLowerCase()} fields`,fields:t[e].map(({id:e,name:t})=>({id:e,name:t})).sort((e,t)=>e.name.localeCompare(t.name))}))}trackByLabel(e,t){return t.groupLabel}trackById(e,t){return t.id}idsToModel(e,t=!0){return e.filter(Boolean).reduce((e,i)=>(e[i]=t,e),{})}modelToIds(e){return(0,m.reduce)(e,(e,t,i)=>(t&&e.push(i),e),[])}}Hs.\u0275fac=function(e){return new(e||Hs)(n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](v.RxStringService))},Hs.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Hs,selectors:[["ng-component"]],decls:14,vars:7,consts:[[1,"modal-header","pr-0"],[1,"modal-title","pl-0","mr-auto"],["adapt-button","","type","button","size","small","btn-type","primary","rx-id","apply-button",1,"mr-5",3,"disabled","click"],["adapt-button","","type","button","size","small","btn-type","tertiary","rx-id","x-button",1,"close","my-1",3,"click"],[1,"modal-body"],[1,"body-controls"],["btn-type","tertiary","rx-id","select-all-button",1,"pl-0",3,"click"],[1,"form-group",3,"placeholder","ngModel","ngModelChange"],[1,"rx-record-definition-fields"],["class","rx-record-definition-field-group",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"rx-record-definition-field-group"],[1,"font-weight-bold"],["btn-type","tertiary",1,"py-0","pl-0",3,"click"],["class","checkbox",4,"ngFor","ngForOf","ngForTrackBy"],[1,"checkbox"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"checkbox__item"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"h5",1),n["\u0275\u0275text"](2,"Quick edit fields"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",2),n["\u0275\u0275listener"]("click",function(){return t.closeModal()}),n["\u0275\u0275text"](4," Apply "),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"button",3),n["\u0275\u0275listener"]("click",function(){return t.context.dismiss(0)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](6,"div",4),n["\u0275\u0275elementStart"](7,"div",5),n["\u0275\u0275elementStart"](8,"adapt-button",6),n["\u0275\u0275listener"]("click",function(){return t.select("all")}),n["\u0275\u0275text"](9," Select all "),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"adapt-rx-textfield",7),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.search(e)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](11,"div",8),n["\u0275\u0275template"](12,Q,6,4,"div",9),n["\u0275\u0275template"](13,J,2,0,"div",10),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("disabled",t.isApplyButtonDisabled),n["\u0275\u0275advance"](7),n["\u0275\u0275property"]("placeholder","Search fields")("ngModel",t.searchQuery),n["\u0275\u0275attribute"]("rx-id","search-field"),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",t.availableFieldGroups)("ngForTrackBy",t.trackByLabel),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",0===t.availableFieldGroups.length))},directives:[u.AdaptButtonComponent,u.AdaptRxTextfieldComponent,b.NgControlStatus,b.NgModel,f.NgForOf,f.NgIf,b.CheckboxControlValueAccessor],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.modal-title[_ngcontent-%COMP%]{margin:auto 0}span[rx-id=x-button][_ngcontent-%COMP%]{cursor:pointer;margin:auto 0}span[rx-id=x-button][_ngcontent-%COMP%]:hover{color:#959899}.body-controls[_ngcontent-%COMP%]{display:flex}.body-controls[_ngcontent-%COMP%]   adapt-rx-textfield[_ngcontent-%COMP%]{flex:1}.rx-record-definition-fields[_ngcontent-%COMP%]{padding:10px;border:1px solid #d6d7d8;max-height:300px;overflow:auto}.rx-record-definition-field-group[_ngcontent-%COMP%]{margin-bottom:20px}']});class Qs extends l.InspectorWidgetBase{constructor(e,t,i){super(e),this.adaptModalService=t,this.renderer=i,this.encapsulateClass=!0}focus(){this.renderer.selectRootElement(this.openModalButton.nativeElement,!0).click()}openModal(){(0,o.combineLatest)([this.designerItemModel.childFieldIds$,this.designerItemModel.recordFieldDefinitionItems$,this.designerItemModel.isExtensionView$,this.designerItemModel.associationDefinitionName$]).pipe((0,r.take)(1),(0,r.concatMap)(([e,t,i,n])=>this.adaptModalService.open({content:Hs,data:{selectedFieldIds:e,availableFields:i&&n?t.filter(e=>e.resourceType!==a.RX_RECORD_DEFINITION.resourceTypes.attachment):t,hideSystemFields:this.options.hideSystemFields},size:"sm",hideBackdrop:!1,customClass:"rx-record-editor-field-selector-modal"}))).subscribe(e=>{this.designerItemModel.updateSelectedFieldComponents(e)})}removeField(e){this.designerItemModel.removeComponent([e])}trackByGuid(e,t){return t.guid}}Qs.\u0275fac=function(e){return new(e||Qs)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](u.AdaptModalService),n["\u0275\u0275directiveInject"](n.Renderer2))},Qs.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Qs,selectors:[["rx-fields-inspector-widget"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](K,7,n.ElementRef),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.openModalButton=e.first)}},hostVars:2,hostBindings:function(e,t){2&e&&n["\u0275\u0275classProp"]("rx-record-definition-fields",t.encapsulateClass)},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:10,vars:8,consts:[["btn-type","tertiary","rx-id","open-modal-button",1,"px-0","py-0",3,"hidden","click"],["openModalButton",""],[1,"d-icon-plus_circle"],["rx-id","columns"],["class","text-tertiary",4,"ngIf"],[1,"mt-2"],["class","rx-field-item",4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-tertiary"],[1,"rx-field-item"],[1,"rx-field-name"],[1,"rx-field-type"],[1,"rx-action-button"],["class","d-icon-cross btn-link","rx-id","delete-button",3,"click",4,"ngIf"],["rx-id","delete-button",1,"d-icon-cross","btn-link",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-button",0,1),n["\u0275\u0275listener"]("click",function(){return t.openModal()}),n["\u0275\u0275element"](2,"span",2),n["\u0275\u0275text"](3," Quick edit fields\n"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"div",3),n["\u0275\u0275template"](5,Y,2,0,"span",4),n["\u0275\u0275pipe"](6,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](7,"div",5),n["\u0275\u0275template"](8,ee,9,3,"div",6),n["\u0275\u0275pipe"](9,"async"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("hidden",t.options.isDisabled),n["\u0275\u0275advance"](5),n["\u0275\u0275property"]("ngIf",0===n["\u0275\u0275pipeBind1"](6,4,t.designerItemModel.selectedFieldComponents$).length),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngForOf",n["\u0275\u0275pipeBind1"](9,6,t.designerItemModel.selectedFieldComponents$))("ngForTrackBy",t.trackByGuid))},directives:[u.AdaptButtonComponent,f.NgIf,f.NgForOf],pipes:[f.AsyncPipe],styles:[':root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.rx-record-definition-fields .rx-field-item{margin-bottom:5px;border:1px solid #d6d7d8;border-radius:2px;padding:5px 10px;font-size:12px;display:flex;justify-content:space-between;word-break:break-all}.rx-record-definition-fields .rx-field-name{font-weight:var(--font-weight-bold)}.rx-record-definition-fields .rx-field-type{color:#959899}.rx-record-definition-fields .d-icon-cross{cursor:pointer}.rx-record-definition-fields .d-icon-cross:not(:hover){color:#313538}.rx-record-editor-field-selector-modal .modal{justify-content:flex-end}.rx-record-editor-field-selector-modal .modal-scroll-container{padding:15px;min-height:0}.rx-record-editor-field-selector-modal .modal-dialog{margin:auto 0 0 auto;min-height:0;width:350px}\n'],encapsulation:2,changeDetection:0});class Js{constructor(e,t,i,n,o,r,a,s){this.rxRecordDefinitionCacheService=e,this.rxModalService=t,this.rxFieldDefinitionService=i,this.rxViewDefinitionCacheService=n,this.rxAssociationDefinitionDataPageService=o,this.rxDefinitionNameService=r,this.rxViewComponentRegistryService=a,this.rxViewDefinitionParserService=s}getRecordFieldDefinitionItems(e){return e.fieldDefinitions.map(e=>({id:String(e.id),name:e.name,resourceType:e.resourceType,fieldOption:e.fieldOption,viewComponentType:this.getViewComponentType(e)}))}getViewComponentType(e){let t=Us.fieldTypes[e.resourceType];return e.resourceType===a.RX_RECORD_DEFINITION.resourceTypes.character&&(t=e.namedListDefinition||(0,m.inRange)(e.maxLength,1,255)?d.RxViewComponentType.Character:d.RxViewComponentType.Textarea),e.resourceType===a.RX_RECORD_DEFINITION.resourceTypes.real&&(t=d.RxViewComponentType.Decimal),t}getComponentProperties(e){const t=["recordDefinitionName","mode","allowEdit"];return(0,m.flow)(e=>(0,m.omit)(e,"showReadOnlyState"),e=>(0,m.omitBy)(e,(e,i)=>!t.includes(i)&&((0,m.isNil)(e)||""===e)))(e)}getRecordDefinition(e){return e?this.rxRecordDefinitionCacheService.getRecordDefinition(e).pipe((0,r.catchError)(e=>o.EMPTY)):(0,o.of)(null)}validate(e,t,i,n,o=!1,r=!1){const s=[];if(t.recordDefinitionName||s.push(e.createError("Record definition name cannot be blank.","recordDefinitionName")),o&&t.recordDefinitionName&&!t.associationDefinitionName&&s.push(e.createError("Association to use cannot be blank.","associationDefinitionName")),r||t.mode!==zs.Edit||t.recordInstanceId||s.push(e.createError("Record ID cannot be blank.","recordInstanceId")),i&&t.recordDefinitionName&&t.mode===zs.Create){i.resourceType===a.RX_RECORD_DEFINITION.recordDefinitionTypes.join.recordDefinitionType&&s.push(e.createWarning("You have configured a record editor to create join record instances.\n                        Please ensure that one or more processes or rules have been defined to perform the creation\n                        of the join record instance.",void 0,!0));const o=n.map(e=>i.fieldDefinitions.find(t=>t.id===Number(e))).filter(this.rxFieldDefinitionService.isSystemField).map(e=>e.name);if(o.length&&s.push(e.createError(`System fields (${o.join(", ")}) cannot be present when Record editor is in Create mode.`)),!r||t.associationDefinitionName){const t=i.fieldDefinitions.filter(e=>{const t=e.resourceType===a.RX_RECORD_DEFINITION.resourceTypes.localizedCharacter,i=e.defaultValue||(0,m.isFinite)(e.defaultValue)||t&&!(0,m.isEmpty)(e.defaultValueByLocale);return e.fieldOption===a.RX_RECORD_DEFINITION.fieldOptions.required&&!i}).filter(e=>!n.includes(String(e.id))).map(e=>e.name);t.length&&s.push(e.createError(`Required fields are missing: ${t.join(", ")}.`))}}return s.push(...(0,c.validateStandardProps)(t)),s}getViewDefinition(e){return e?this.rxViewDefinitionCacheService.getViewDefinition(e).pipe((0,r.catchError)(()=>(0,o.of)(null))):(0,o.of)(null)}getInspector(e,t,i,n=[],o=!1,r=[],a=!1,d){const p={inspectorSectionConfigs:[{label:"General",controls:[{name:"name",component:l.TextFormControlComponent,options:{label:"Name",tooltip:new s.Tooltip("Enter a name to uniquely identify the Record editor.")}},{name:"recordDefinitionName",component:l.RxDefinitionPickerComponent,options:{label:"Record definition name",definitionType:l.RxDefinitionPickerType.StandardDataRecord,required:!0,beforeValueChange:(e,t)=>Boolean(e)?this.rxModalService.confirm({title:"Warning",modalStyle:S.RX_MODAL.modalStyles.warning,message:"All view components will be removed from the Record editor. Do you want to continue?"}):Promise.resolve(!0)}},{name:"mode",component:l.GroupButtonFormControlComponent,options:{label:"Mode",tooltip:new s.Tooltip("<b>Record editor modes:</b><br><ul><li>Create mode is for creating new records.</li><li>Edit mode is for updating records.</li><li>Temporary mode is for holding data that does not need to be saved.</li></ul>"),required:!0,items:[{name:"Create",value:zs.Create},{name:"Edit",value:zs.Edit},{name:"Temporary",value:zs.Temporary}],beforeValueChange:d}}]}]},m=p.inspectorSectionConfigs[0].controls;t!==zs.Edit||o||(m.push({name:"recordInstanceId",component:l.ExpressionInspectorControlComponent,options:{label:"Record ID",tooltip:new s.Tooltip("Enter the record ID of the record that the users need to edit."),isRequired:!0}}),m.push({name:"showReadOnlyState",component:l.SwitchFormControlComponent,options:{label:"Enable read state"}}),i&&m.push({name:"defaultState",component:l.GroupButtonFormControlComponent,options:{label:"Default state",items:[{name:"Read",value:Xs.Read},{name:"Edit",value:Xs.Edit}]}}),m.push({name:"allowEdit",component:l.OptionalExpressionInspectorControlComponent,options:{label:"Allow edit"}})),m.push((0,c.getAvailableOnDevicesInspectorConfig)(),(0,c.getStylesFieldInspectorConfig)()),o&&(m.splice(1,0,{name:"label",component:l.TextFormControlComponent,options:{label:"Display label",tooltip:new s.Tooltip("Enter a Display label for the Record editor. When this view is injected into the view to extend,\n              the Display label will be shown above the Record editor's fields. If a Display label is not defined,\n              the name of the source application or library will be shown above the fields.")}}),e&&m.splice(3,0,{name:"associationDefinitionName",component:l.SelectFormControlComponent,options:{label:"Association to use",options:r,emptyOption:!a,required:a}}));const u={label:"Form contents",controls:[{component:Qs,options:{label:"Selected fields",hideSystemFields:t===zs.Create}}]};return e&&p.inspectorSectionConfigs.push(u),p}getAssociationOptions(e,t){return e&&t?this.getAssociations(e,t).pipe((0,r.map)(t=>t.data.filter(t=>t.nodeAId===e).map(e=>({id:e.name,name:this.rxDefinitionNameService.getDisplayName(e.name)})))):(0,o.of)([])}getAssociations(e,t){return this.rxAssociationDefinitionDataPageService.get({params:{propertySelection:["name","scope","nodeAId"],firstRecordDefinitionName:e,secondRecordDefinitionName:t,cardinality:C.RX_ASSOCIATION_DEFINITION.cardinality.oneToOne.value,nodeAModality:C.RX_ASSOCIATION_DEFINITION.modality.required,shouldCascadeDelete:!0},headers:{"default-bundle-scope":""}})}getTargetRecordEditorProperties(e,t){let i;return e&&t&&(i=this.rxViewDefinitionParserService.findParentComponentDefinition(e,{guid:t},e=>e.type===d.RxViewComponentType.RecordEditor)),(0,m.get)(i,"propertiesByName",{})}confirmSystemFieldRemoval(){return(0,o.from)(this.rxModalService.confirm({title:"Warning",modalStyle:S.RX_MODAL.modalStyles.warning,message:"System fields will be removed. Do you want to continue?"}))}getSystemFieldModelGuids(e,t){return(0,m.isEmpty)(e)?[]:e.reduce((e,i)=>{const n=t.fieldDefinitions.find(e=>String(e.id)===i.data.fieldId);return this.rxFieldDefinitionService.isSystemField(n)&&e.push(i.guid),e},[])}isFieldComponent(e){return![d.RxViewComponentType.Action,d.RxViewComponentType.ActionButton,d.RxViewComponentType.Association,d.RxViewComponentType.AssociatedRecordField].includes(e.type)&&Boolean(this.rxViewComponentRegistryService.get(e.type).properties.find(e=>"fieldId"===e.name))}}Js.\u0275fac=function(e){return new(e||Js)(n["\u0275\u0275inject"](a.RxRecordDefinitionCacheService),n["\u0275\u0275inject"](S.RxModalService),n["\u0275\u0275inject"](a.RxFieldDefinitionService),n["\u0275\u0275inject"](d.RxViewDefinitionCacheService),n["\u0275\u0275inject"](C.RxAssociationDefinitionDataPageService),n["\u0275\u0275inject"](s.RxDefinitionNameService),n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](d.RxViewDefinitionParserService))},Js.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Js,factory:Js.\u0275fac});class Ks extends c.ViewDesignerComponentModel{constructor(){super(...arguments),this.rxFieldDefinitionService=this.injector.get(a.RxFieldDefinitionService),this.rxViewComponentRegistryService=this.injector.get(d.RxViewComponentRegistryService),this.rxRecordEditorDesignHelpersService=this.injector.get(Js),this.rxDefinitionNameService=this.injector.get(s.RxDefinitionNameService),this.updateInspector$=new o.Subject,this.recordDefinitionName$=this.sandbox.getComponentPropertyValue("recordDefinitionName"),this.mode$=this.sandbox.getComponentPropertyValue("mode"),this.showReadOnlyState$=this.sandbox.getComponentPropertyValue("showReadOnlyState"),this.targetExtensionContainerGuid$=this.sandbox.getViewPropertyValue("targetExtensionContainerGuid"),this.targetViewDefinitionName$=this.sandbox.getViewPropertyValue("targetViewDefinitionName"),this.recordDefinition$=this.recordDefinitionName$.pipe((0,r.switchMap)(e=>this.rxRecordEditorDesignHelpersService.getRecordDefinition(e)),(0,r.shareReplay)(1)),this.childComponentGuids$=this.sandbox.getChildComponentGuids().pipe((0,r.shareReplay)(1)),this.allChildFieldComponentGuids$=this.sandbox.getChildComponentGuids(e=>this.rxRecordEditorDesignHelpersService.isFieldComponent(e),!0).pipe((0,r.distinctUntilChanged)(m.isEqual),(0,r.shareReplay)(1)),this.isExtensionView$=this.targetViewDefinitionName$.pipe((0,r.map)(Boolean),(0,r.shareReplay)(1)),this.childFieldIds$=this.allChildFieldComponentGuids$.pipe((0,r.switchMap)(e=>e.length?(0,o.combineLatest)(e.map(e=>this.sandbox.getComponentPropertyValue("fieldId",e))).pipe((0,r.map)(m.uniq)):(0,o.of)([])),(0,r.shareReplay)(1)),this.selectedFieldComponents$=this.allChildFieldComponentGuids$.pipe((0,r.switchMap)(e=>e.length?(0,o.combineLatest)(e.map(e=>(0,o.combineLatest)([this.sandbox.getComponent(e).pipe((0,r.take)(1),(0,r.map)(e=>this.rxViewComponentRegistryService.get(e.type).name)),this.sandbox.getComponentPropertyValue("fieldId",e),this.sandbox.getComponentPropertyValue("label",e)]).pipe((0,r.map)(([t,i,n])=>({fieldId:i,label:n||"<No field selected>",componentName:t,guid:e}))))):(0,o.of)([])),(0,r.shareReplay)(1)),this.associationComponentGuids$=this.sandbox.getChildComponentGuids(e=>e.type===d.RxViewComponentType.Association,!0).pipe((0,r.shareReplay)(1),(0,r.takeUntil)(this.sandbox.destroyed$)),this.associationDefinitionName$=this.sandbox.getComponentPropertyValue("associationDefinitionName"),this.hasChildren$=this.childComponentGuids$.pipe((0,r.map)(e=>Boolean(e.length)),(0,r.distinctUntilChanged)(),(0,r.shareReplay)(1)),this.systemFieldComponentGuids$=this.recordDefinition$.pipe((0,r.mergeMap)(e=>e?this.selectedFieldComponents$.pipe((0,r.map)(t=>t.filter(t=>{const i=e.fieldDefinitions.find(e=>String(e.id)===t.fieldId);return this.rxFieldDefinitionService.isSystemField(i)}).map(e=>e.guid)),(0,r.take)(1)):(0,o.of)([]))),this.recordFieldDefinitionItems$=this.recordDefinition$.pipe((0,r.map)(e=>e?this.rxRecordEditorDesignHelpersService.getRecordFieldDefinitionItems(e):[]),(0,r.shareReplay)(1))}static getInitialProperties(e){const t=Object.assign(Object.assign({name:null,label:null,mode:zs.Edit,recordInstanceId:null,recordDefinitionName:null,associationDefinitionName:null,defaultState:e.defaultState||null,allowEdit:"1",styles:null},d.RX_AVAILABLE_ON_DEVICES_DEFAULT_VALUE),e);return Object.assign(Object.assign({},t),{showReadOnlyState:Boolean(t.defaultState),allowEdit:t.mode===zs.Edit?t.allowEdit:null})}rxInit(){const e=(0,o.combineLatest)([this.targetViewDefinitionName$.pipe((0,r.switchMap)(e=>this.rxRecordEditorDesignHelpersService.getViewDefinition(e))),this.targetExtensionContainerGuid$]).pipe((0,r.map)(([e,t])=>this.rxRecordEditorDesignHelpersService.getTargetRecordEditorProperties(e,t)));this.associationOptions$=(0,o.combineLatest)([e,this.recordDefinitionName$]).pipe((0,r.switchMap)(([e,t])=>this.rxRecordEditorDesignHelpersService.getAssociationOptions(e.recordDefinitionName,t))),this.isAssociationRequired$=(0,o.combineLatest)([this.isExtensionView$,this.recordDefinitionName$,e]).pipe((0,r.map)(([e,t,i])=>e&&t!==i.recordDefinitionName)),this.updateInspector$.pipe((0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.updateInspectorConfig(e)}),(0,o.combineLatest)([this.sandbox.componentProperties$,this.isExtensionView$,this.associationOptions$,this.isAssociationRequired$,e]).pipe((0,r.first)(),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([{recordDefinitionName:e,mode:t,showReadOnlyState:i},n,o,r,a])=>{n&&!e&&(e=a.recordDefinitionName,t=a.mode,this.sandbox.updateComponentProperties({mode:t,recordDefinitionName:e})),this.updateInspector$.next(this.rxRecordEditorDesignHelpersService.getInspector(e,t,i,[],n,o,r,this._onBeforeModeChange.bind(this)))}),this.mode$.pipe((0,r.skip)(1),(0,r.withLatestFrom)(this.sandbox.componentProperties$),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([e,t])=>{this.sandbox.updateComponentProperties(e===zs.Create||e===zs.Temporary?Object.assign(Object.assign({},t),{recordInstanceId:null,defaultState:null,allowEdit:null,showReadOnlyState:null}):Object.assign(Object.assign({},t),{defaultState:null,allowEdit:"1",showReadOnlyState:!1}))}),this.showReadOnlyState$.pipe((0,r.skip)(1),(0,r.withLatestFrom)(this.sandbox.componentProperties$),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([e,t])=>{this.sandbox.updateComponentProperties(Object.assign(Object.assign({},t),{defaultState:e?Xs.Read:null}))}),(0,o.combineLatest)([(0,o.combineLatest)([this.sandbox.getComponentPropertyValue("recordDefinitionName"),this.sandbox.getComponentPropertyValue("mode"),this.showReadOnlyState$]).pipe((0,r.skip)(1)),this.recordFieldDefinitionItems$,this.isExtensionView$,this.associationOptions$,this.isAssociationRequired$]).pipe((0,r.map)(([[e,t,i],n,o,r,a])=>this.rxRecordEditorDesignHelpersService.getInspector(e,t,i,n,o,r,a,this._onBeforeModeChange.bind(this))),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(this.updateInspector$),this.recordDefinitionName$.pipe((0,r.pairwise)(),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([e,t])=>{e&&(this.sandbox.setChildren([]),this.sandbox.updateComponentProperties({associationDefinitionName:null}))}),this.associationOptions$.pipe((0,r.skip)(1),(0,r.filter)(e=>1===e.length),(0,r.withLatestFrom)(this.isAssociationRequired$),(0,r.filter)(([,e])=>e),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([[{id:e}]])=>this.sandbox.updateComponentProperties({associationDefinitionName:e})),(0,o.combineLatest)([this.sandbox.componentProperties$,this.recordDefinition$,this.childFieldIds$,this.isAssociationRequired$,this.isExtensionView$]).pipe((0,r.map)(([e,t,i,n,o])=>this.rxRecordEditorDesignHelpersService.validate(this.sandbox,e,t,i,n,o)),(0,r.distinctUntilChanged)(m.isEqual),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.setValidationIssues(e)}),(0,o.combineLatest)([this.sandbox.getComponentPropertyValue("name").pipe((0,r.map)(e=>e||null),(0,r.distinctUntilChanged)()),this.recordDefinition$]).pipe((0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([e,t])=>{this._setSettableProperties(e,t),this._setCommonDataDictionary(e,t)})}removeComponent(e){this.sandbox.removeComponents(e)}updateSelectedFieldComponents(e){this.selectedFieldComponents$.pipe((0,r.take)(1),(0,r.mergeMap)(t=>{const i=e.filter(e=>!t.find(t=>t.fieldId===e)),n=i.length?this.recordFieldDefinitionItems$.pipe((0,r.map)(e=>i.map(t=>{const{viewComponentType:i,name:n}=e.find(e=>e.id===t);return{type:i,propertiesByName:{fieldId:t,label:n}}})),(0,r.take)(1)):(0,o.of)([]),a=new Set(e),s=t.filter(e=>e.fieldId).filter(e=>!a.has(e.fieldId)).map(e=>e.guid);return(0,o.forkJoin)([n,(0,o.of)(s)])}),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([e,t])=>{e.length&&this.sandbox.addComponent(e),t.length&&this.sandbox.removeComponents(t)})}getPropertiesByName(e){return this.rxRecordEditorDesignHelpersService.getComponentProperties(e)}_dropPredicate(e){var t;return null===(t=e.draggedViewComponentDescriptor.options)||void 0===t?void 0:t.canBeEmbeddedInRecordEditor}_onBeforeModeChange(e,t){return e!==zs.Create&&t===zs.Create?this.systemFieldComponentGuids$.pipe((0,r.mergeMap)(e=>e.length?this.rxRecordEditorDesignHelpersService.confirmSystemFieldRemoval().pipe((0,r.tap)(t=>{t&&this.sandbox.removeComponents(e)})):(0,o.of)(!0)),(0,r.take)(1)).toPromise():Promise.resolve(!0)}dropPredicate(e){var t;return null===(t=e.draggedViewComponentDescriptor.options)||void 0===t?void 0:t.canBeEmbeddedInRecordEditor}_setCommonDataDictionary(e,t){const i=this._getComponentName(e,t);this.sandbox.setCommonDataDictionary(this._getCommonProps(i,t))}_setSettableProperties(e,t){const i=this._getComponentName(e,t);this.sandbox.setSettablePropertiesDataDictionary(i,[{label:"Edit state",expression:this.getExpressionForProperty("editState")},{label:"Read state",expression:this.getExpressionForProperty("readState")},...t?[{label:"Record instance",children:t.fieldDefinitions.map(e=>({label:e.name,expression:this.getExpressionForProperty(`recordInstance.fieldInstances.${e.id}.value`)}))}]:[]])}_getCommonProps(e,t){return{label:e,expression:this.getExpressionForProperty("api"),children:[{label:"Can save",expression:this.getExpressionForProperty("canSave")},{label:"In read state",expression:this.getExpressionForProperty("inReadState")},{label:"Is dirty",expression:this.getExpressionForProperty("isDirty")},{label:"Is valid",expression:this.getExpressionForProperty("isValid")},{label:"Record definition name",expression:this.getExpressionForProperty("recordDefinitionName")},{label:"Record instance",expression:this.getExpressionForProperty("recordInstance"),children:t?this._getRecordInstanceChildProps(t):[]},{label:"Record instance ID",expression:this.getExpressionForProperty("recordInstanceId")}]}}_getRecordInstanceChildProps(e){return(0,m.flow)(e=>(0,m.reject)(e,{resourceType:a.RX_RECORD_DEFINITION.resourceTypes.attachment}),e=>(0,m.map)(e,e=>{const t={label:e.name,expression:this.getExpressionForProperty(`recordInstance.fieldInstances.${e.id}.value`)};if(e.resourceType===a.RX_RECORD_DEFINITION.resourceTypes.selection){const i=t.autocompleteOptions=(0,m.map)(e.optionNamesById,(t,i)=>({label:t,expression:this.getExpressionForProperty(`recordDefinition.fieldDefinitionsById[${e.id}].optionsById[${i}].id`)}));t.children=[{label:`${e.name} (Option name)`,expression:this.getExpressionForProperty(`selectionFieldOptionNamesById.${e.id}`)},{label:"Options",children:i}]}return t}))(e.fieldDefinitions)}_getComponentName(e,t){let i=this.sandbox.descriptor.name;const n=t?this.rxDefinitionNameService.getDisplayName(t.name):null;return n&&e?i+=` (${n}: ${e})`:n?i+=` (${n})`:e&&(i+=` (${e})`),i}}class Ys{ngOnInit(){this.dropPredicateFn=this.model._dropPredicate.bind(this.model)}}Ys.\u0275fac=function(e){return new(e||Ys)},Ys.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Ys,selectors:[["rx-record-editor-design"]],inputs:{model:"model"},decls:3,vars:4,consts:[["type","objects","label","Drop fields from the Palette here or select a Record definition and add fields in the Properties panel.",4,"ngIf"],[3,"dropPredicate"],["type","objects","label","Drop fields from the Palette here or select a Record definition and add fields in the Properties panel."]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,te,1,0,"adapt-empty-state",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275element"](2,"rx-canvas-outlet",1)),2&e&&(n["\u0275\u0275property"]("ngIf",!1===n["\u0275\u0275pipeBind1"](1,2,t.model.hasChildren$)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("dropPredicate",t.dropPredicateFn))},directives:[f.NgIf,c.CanvasOutletComponent,u.AdaptEmptyStateComponent],pipes:[f.AsyncPipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{border:1px solid #d6d7d8;display:block;position:relative;padding:1rem;min-height:200px}adapt-empty-state[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}rx-canvas-outlet[_ngcontent-%COMP%]    >rx-canvas-item-container>.row>.col>rx-canvas-item-column>.cdk-drop-list{min-height:calc(200px - 1rem * 2)}']});class Zs{}Zs.\u0275fac=function(e){return new(e||Zs)},Zs.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Zs,declarations:[Hs,Qs],imports:[f.CommonModule,b.FormsModule,u.AdaptButtonModule,u.AdaptRxTextfieldModule],exports:[Qs]}),Zs.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.FormsModule,u.AdaptButtonModule,u.AdaptRxTextfieldModule]]});class el{}el.\u0275fac=function(e){return new(e||el)},el.\u0275mod=n["\u0275\u0275defineNgModule"]({type:el,declarations:[Ys],imports:[f.CommonModule,l.RxDefinitionPickerModule,b.FormsModule,l.FormControlsModule,c.ViewDesignerCanvasModule,Zs,u.AdaptEmptyStateModule]}),el.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[Js],imports:[[f.CommonModule,l.RxDefinitionPickerModule,b.FormsModule,l.FormControlsModule,c.ViewDesignerCanvasModule,Zs,u.AdaptEmptyStateModule]]}),function(e){e.One="ONE",e.Many="MANY"}(Ws||(Ws={}));let tl=class{constructor(e,t,i,n,s,l,d){this.options=e,this.rxAssociationInstanceDataPageService=t,this.rxRecordDefinitionCacheService=i,this.rxRecordInstanceUtilsService=n,this.rxRecordInstanceService=s,this.rxJsonParserService=l,this.rxAssociationDefinitionCacheService=d,this.extensions=[],this.existing=[],this.pending=[],this.deleted=[],this.existingSubject$=new o.BehaviorSubject([]),this.existing$=this.existingSubject$.asObservable(),this.pendingSubject$=new o.BehaviorSubject([]),this.pending$=this.pendingSubject$.asObservable(),this.extensionsSubject$=new o.BehaviorSubject([]),this.extensions$=this.extensionsSubject$.asObservable(),this.cardinalityTypes=Ws,this.totalExistingCount=0,this.associationDefinition=null,this.cardinalityType=null,this.remainingAssociatedRecordCount=0,this.getExistingAssociationInstances$=(0,o.defer)(()=>this.getExistingAssociationInstances()).pipe((0,r.share)()),(0,m.assign)(this.options,{canLoadAssociations:Boolean(this.options.associatedRecordInstanceId),pageSize:10,startIndex:0}),this.extensions=this.options.associationInstances.extensions,this.existing=this.options.associationInstances.existing,this.pending=this.options.associationInstances.pending,this.deleted=this.options.associationInstances.deleted,this.options.fieldIds=this.options.fieldIds||[],this.mergeFieldIds([a.RX_RECORD_DEFINITION.coreFieldIds.id])}initialize(){return this.isDataLoading=!0,this.initialize$||(this.initialize$=(0,o.forkJoin)([this.rxAssociationDefinitionCacheService.getAssociationDefinition(this.options.associationDefinitionName),this.rxRecordDefinitionCacheService.getRecordDefinition(this.options.recordDefinitionName)]).pipe((0,r.tap)(([e,t])=>{this.isDataLoading=!1,this.associationDefinition=e,this.recordDefinition=t,this.cardinalityType=this.getCardinalityType(this.associationDefinition.cardinality,this.options.associatedRecordNodeSide),this.options.allFieldIds&&(this.options.fieldIds=(0,m.map)(this.recordDefinition.fieldDefinitions,"id"),this.mergeFieldIds([a.RX_RECORD_DEFINITION.coreFieldIds.id]))}))),this.initialize$}loadExistingAssociations(){return this.options.canLoadAssociations?this.initialize().pipe((0,r.switchMap)(()=>this.getExistingAssociationInstances$.pipe((0,r.tap)(e=>{(0,m.forEach)(e.data,e=>{this.addToExisting(this.rxRecordInstanceUtilsService.convertFromDataPageRowToPlainRecordInstance(e))}),this.options.startIndex+=e.data.length,this.remainingAssociatedRecordCount=e.totalSize-this.options.startIndex})))):(0,o.of)([])}loadExtensions(){return this.initialize().pipe((0,r.switchMap)(()=>this.getExtensionRecordInstance().pipe((0,r.tap)(e=>{e&&this.addExtension(e)}))))}addToExisting(e){const t=this.isInExisting(e.id);t?this.isDefaultNodeRoleUsed(t)&&!this.isDefaultNodeRoleUsed(this.options.rolesConfig)&&((0,m.remove)(this.existing,t),e.rolesConfig=this.options.rolesConfig,this.existing.push(e),this.existingSubject$.next(this.existing)):(this.options.rolesConfig&&!e.rolesConfig&&(e.rolesConfig=this.options.rolesConfig),this.existing.push(e),this.existingSubject$.next(this.existing))}isDefaultNodeRoleUsed(e){return this.rxJsonParserService.tryParseJson((0,m.get)(e,"rolesConfig.useDefaultRoles",!0))}addToPending(e,t){if(!(0,m.isEmpty)(e)&&this.associationDefinition)if(this.cardinalityType===Ws.Many){const i=(0,m.filter)(e,e=>!this.isInExisting(e.id)&&!this.isInDeleted(e.id)&&!this.isInPending(e.id));t&&(0,m.forEach)(i,e=>{e.rolesConfig=t}),Array.prototype.push.apply(this.pending,i),this.pendingSubject$.next(this.pending);const n=(0,m.remove)(this.deleted,t=>(0,m.find)(e,{id:t.id}));(0,m.forEach)(n,e=>{this.addToExisting(e)})}else if(this.cardinalityType===Ws.One){const t=e[0];switch(!0){case(0,m.isEmpty)(this.existing)&&(0,m.isEmpty)(this.deleted):this.pending.length=0,this.pending.push(t);break;case(0,m.isEmpty)(this.existing):const e=this.deleted[0];this.pending.length=0,e.id===t.id?this.addToExisting(this.deleted.splice(0,1)[0]):this.pending.push(t);break;case(0,m.isEmpty)(this.deleted):const i=this.existing[0];i.id!==t.id&&(this.deleteFromExisting(i.id),this.pending.length=0,this.pending.push(t))}this.pendingSubject$.next(this.pending)}}addExtension(e){this.extensions.push(e),this.extensionsSubject$.next(this.extensions)}restore(){this.extensionsSubject$.next(this.extensions),(0,m.forEach)(this.deleted,e=>{this.addToExisting(e)}),this.deleted.splice(0,this.deleted.length),this.deleteAllPending()}reset(){this.existing.splice(0,this.existing.length),this.pending.splice(0,this.pending.length),this.deleted.splice(0,this.deleted.length),this.totalExistingCount=0,this.options.startIndex=0}delete(e){this.isInExisting(e)?this.deleteFromExisting(e):this.isInPending(e)&&this.deleteFromPending(e)}deleteAllExisting(){const e=(0,m.map)(this.existing,"id");(0,m.forEach)(e,e=>{this.deleteFromExisting(e)})}deleteAllPending(){this.pending.splice(0,this.pending.length),this.pendingSubject$.next(this.pending)}mergeFieldIds(e){e&&(this.options.fieldIds=(0,m.uniq)(this.options.fieldIds.concat(e)))}extendOptions(e){e.fieldIds&&this.mergeFieldIds(e.fieldIds),this.options.allFieldIds=e.allFieldIds}getCardinalityType(e,t){let i;switch(!0){case e===C.RX_ASSOCIATION_DEFINITION.cardinality.oneToOne.value:i=Ws.One;break;case e===C.RX_ASSOCIATION_DEFINITION.cardinality.oneToMany.value:i=t===C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.value?Ws.Many:Ws.One;break;case e===C.RX_ASSOCIATION_DEFINITION.cardinality.manyToMany.value:i=Ws.Many}return i}getExtensionRecordInstance(e=!0){const t=e?a.RX_RECORD_DEFINITION.coreFieldIds.id:this.options.fieldIds.join(",");return this.rxAssociationInstanceDataPageService.post({params:{associationDefinition:this.options.associationDefinitionName,nodeToQuery:this.options.associatedRecordNodeSide,associatedRecordInstanceId:this.options.associatedRecordInstanceId,propertySelection:t}}).pipe((0,r.map)(e=>e.data[0]),(0,r.switchMap)(t=>t&&e?this.rxRecordInstanceService.get(this.options.recordDefinitionName,t[a.RX_RECORD_DEFINITION.coreFieldIds.id]):t&&!e?(0,o.of)(this.rxRecordInstanceService.createInstanceFromDataPageRow(t,this.recordDefinition)):(0,o.of)(null)))}getExistingAssociationInstances(){const e={pageSize:this.options.pageSize,startIndex:this.options.startIndex,associationDefinition:this.options.associationDefinitionName,nodeToQuery:this.options.associatedRecordNodeSide,associatedRecordInstanceId:this.options.associatedRecordInstanceId,propertySelection:this.options.fieldIds.join(","),useDefaultRoleNames:!1,nodeARoleName:"",nodeBRoleName:""};return this.options.rolesConfig.useDefaultRoles?(e.useDefaultRoleNames=this.options.rolesConfig.useDefaultRoles,delete e.nodeARoleName,delete e.nodeBRoleName):(delete e.useDefaultRoleNames,e.nodeARoleName=this.options.rolesConfig.nodeARole||"",e.nodeBRoleName=this.options.rolesConfig.nodeBRole||""),this.rxAssociationInstanceDataPageService.post({params:e})}isInExisting(e){return(0,m.find)(this.existing,{id:e})}isInPending(e){return(0,m.find)(this.pending,{id:e})}getFieldIds(){return(0,m.clone)(this.options.fieldIds)}isInDeleted(e){return(0,m.find)(this.deleted,{id:e})}deleteFromExisting(e){const t=(0,m.remove)(this.existing,{id:e})[0];this.deleted.push(t),this.existingSubject$.next(this.existing)}deleteFromPending(e){(0,m.remove)(this.pending,{id:e}),this.pendingSubject$.next(this.pending)}destroy(){this.existingSubject$.complete(),this.pendingSubject$.complete(),this.extensionsSubject$.complete()}};tl=(0,w.__decorate)([(0,w.__param)(0,(0,n.Optional)()),(0,w.__metadata)("design:paramtypes",[Object,C.RxAssociationInstanceDataPageService,a.RxRecordDefinitionCacheService,a.RxRecordInstanceUtilsService,a.RxRecordInstanceService,v.RxJsonParserService,C.RxAssociationDefinitionCacheService])],tl);class il{getComponentDefinitionsAsFlatList(e){return(0,m.flattenDeep)((0,m.transform)(e,(e,t)=>{t.resourceType!==d.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent?e.push(t):t.propertiesByName.recordDefinitionName||e.push(...this.getComponentDefinitionsAsFlatList(t.componentDefinitions))}))}getSelectionFieldOptionNames(e,t){const i={};return(0,m.filter)(e.fieldDefinitions,{resourceType:a.RX_RECORD_DEFINITION.resourceTypes.selection}).forEach(n=>{const o=(0,m.get)(e.localizableStringsByFieldId,n.id),r=t.fieldInstances[n.id];if(r)if((0,m.isObject)(n.optionNamesById)&&o&&(0,m.isEmpty)(o)){const e=n.optionNamesById[r.value];i[n.id]=o[e]}else i[n.id]=n.optionNamesById[r.value];else i[n.id]=""}),i}}il.\u0275fac=function(e){return new(e||il)},il.\u0275prov=n["\u0275\u0275defineInjectable"]({token:il,factory:il.\u0275fac});class nl extends b.FormControl{constructor(){super(...arguments),this._touchedSubject=new o.BehaviorSubject(this.touched),this.touched$=this._touchedSubject.asObservable().pipe((0,r.distinctUntilChanged)())}markAsTouched(e){super.markAsTouched(e),this._touchedSubject.next(this.touched)}markAsUntouched(e){super.markAsUntouched(e),this._touchedSubject.next(this.touched)}}const ol="%",rl="baseFormGroup";class al extends b.FormGroup{constructor(e,t){super({}),this.rxGuidService=e,this.rxRecordInstanceUtilsService=t}addFieldControl(e,t,i=null,n,o){const r=new nl("",n,o),a=this.controls[rl];return r.setValue(i),a?a.addControl(this.getControlId(e,t),r):this.addControl(rl,new b.FormGroup({[this.getControlId(e,t)]:r})),r}addAssociatedFieldControl(e,t,i,n=null,o,r){const a=i.join(ol),s=this.controls[a],l=new nl(n,o,r);return s?s.addControl(this.getControlId(e,t),l):this.addControl(a,new b.FormGroup({[this.getControlId(e,t)]:l})),l}resetFieldControls(e,t){const i=this.controls[t?t.join(ol):rl];e?i.reset(this.prepareFormGroupState(e,i)):i.reset()}syncFormControlValues(e,t,i,n={}){this.getControlsBoundToRecordField(String(e),i).forEach(e=>{!1!==n.markAsDirty&&e.markAsDirty(),!1!==n.markAsTouched&&e.markAsTouched(),this.rxRecordInstanceUtilsService.isFieldValueEqual(e.value,t)||e.setValue(t)})}getFieldIds(e){const t=this.controls[e?e.join(ol):rl];return t?(0,m.reduce)(t.controls,(e,t,i)=>{const n=this.getFieldId(i);return t instanceof b.FormControl&&!(0,m.includes)(e,n)&&e.push(n),e},[]):[]}clearAndReset(){(0,m.forOwn)(this.controls,(e,t)=>this.removeControl(t)),this.reset()}markInvalidControlsAsTouched(){(0,m.forEach)(this.controls,e=>{(0,m.forEach)(e.controls,e=>{e.invalid&&e.markAsTouched()})})}getFormControl(e,t,i){let n,o;return o=this.controls[i?i.join(ol):rl],o&&(n=o.get(this.getControlId(e,t))),n}getControlsBoundToRecordField(e,t){const i=this.controls[t||rl];return(0,m.reduce)(i.controls,(t,i,n)=>(i instanceof b.FormControl&&this.getFieldId(n)===e&&t.push(i),t),[])}getControlId(e,t){return`${e}:${t||this.rxGuidService.generate()}`}getFieldId(e){return e.split(":")[0]}prepareFormGroupState(e,t){return(0,m.reduce)(t.controls,(t,i,n)=>(t[n]=e[this.getFieldId(n)],t),{})}}al.\u0275fac=function(e){return new(e||al)(n["\u0275\u0275inject"](v.RxGuidService),n["\u0275\u0275inject"](a.RxRecordInstanceUtilsService))},al.\u0275prov=n["\u0275\u0275defineInjectable"]({token:al,factory:al.\u0275fac});class sl extends h.BaseViewComponent{constructor(e,t,i,n,a,s,l,d,c,p,m,u,f){super(),this.rxRecordInstanceService=e,this.rxRecordInstanceUpdateService=t,this.translateService=i,this.rxGlobalEventsService=n,this.rxNotificationService=a,this.rxRecordDefinitionService=s,this.rxRecordEditorUtilsService=l,this.rxRecordInstanceUtilsService=d,this.rxStringService=c,this.rxLogService=p,this.rxUtilityModalsService=m,this.rxAssociationManagerServiceFactory=f,this.api={refresh:this.refresh.bind(this),isDirty:this.isDirty.bind(this),isReady:this.isReady.bind(this),isValid:this.isValid.bind(this),notifyComponentReady:this.notifyComponentReady.bind(this),save:this.save.bind(this),setProperty:this.setProperty.bind(this),setFieldValue:this.setFieldValue.bind(this),getFieldValue:this.getFieldValue.bind(this),getAssociationManager:this.getAssociationManager.bind(this),getFieldControl:this.getFieldControl.bind(this),downloadAttachment:this.downloadAttachment.bind(this),getAttachmentDownloadUrl:this.getAttachmentDownloadUrl.bind(this),getPermissionType:this.getPermissionType.bind(this),getFieldInstanceProp:this.getFieldInstanceProp.bind(this),getRecordEditorMode:this.getRecordEditorMode.bind(this),setFieldInstanceProp:this.setFieldInstanceProp.bind(this),markAsDirty:this.markAsDirty.bind(this)},this.state={recordInstanceId:"",recordDefinitionName:"",recordInstance:null,recordDefinition:null,isDataLoading:!1,isDirty:!1,isSaving:!1,canSave:!1,mode:null,isReadOnlyStateAvailable:!1,defaultState:null,currentState:Xs.Edit,form:null,selectionFieldOptionNamesById:{},allowEdit:null},this.recordInstanceChangedSubject=new o.Subject,this.notReadyComponentIds={},this.associationManagers={},this.associationInstances={},this.recordInstanceChanged$=this.recordInstanceChangedSubject.asObservable(),this.state.form=u,this.state.form.statusChanges.pipe((0,r.distinctUntilChanged)(),(0,r.takeUntil)(this.destroyed$)).subscribe(()=>{this.notifyPropertyChanged("isValid",this.isValid())})}ngOnInit(){super.ngOnInit(),this.notifyPropertyChanged("api",this.api),this.notifyPropertyChanged("isDirty",this.state.isDirty),this.notifyPropertyChanged("canSave",this.state.canSave);const e=this.config.pipe((0,r.distinctUntilChanged)(m.isEqual),(0,r.tap)(e=>Object.assign(this.state,e)));e.pipe((0,r.take)(1)).subscribe(e=>{e.mode===zs.Create?this.notifyPropertyChanged("inReadState",!1):e.mode===zs.Temporary?(this.notifyPropertyChanged("inReadState",!1),this.updateCanSaveProperty()):this.state.defaultState&&(this.state.isReadOnlyStateAvailable=!0)}),(0,o.merge)(e.pipe((0,r.takeWhile)(e=>e.mode===zs.Edit)),e.pipe((0,r.takeWhile)(e=>(0,m.includes)([zs.Create,zs.BulkEdit,zs.Temporary],e.mode)),(0,r.take)(1))).pipe((0,r.map)(e=>e.recordInstanceId||null),(0,r.distinctUntilChanged)(),(0,r.switchMap)(()=>this.initializeRecordInstance().pipe((0,r.catchError)(e=>(this.rxRecordInstanceUtilsService.isNoRecordFoundError(e)&&this.runtimeViewModelApi.cancel(!0).subscribe(),(0,o.throwError)(e))))),(0,r.takeUntil)(this.destroyed$)).subscribe(),e.pipe((0,r.takeWhile)(e=>e.mode===zs.Edit),(0,r.pluck)("allowEdit"),(0,r.distinctUntilChanged)(),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{const t=e?this.state.defaultState||Xs.Edit:Xs.Read;this.setRecordEditorState(t)})}downloadAttachment(e){this.isInEditMode()&&!this.isNewAttachment(e)&&this.rxRecordInstanceService.downloadAttachment(this.state.recordDefinitionName,e,this.state.recordInstanceId,this.state.recordInstance.fieldInstances[e].value)}getAttachmentDownloadUrl(e){let t="";return this.isInEditMode()&&!this.isNewAttachment(e)&&(t=this.rxRecordInstanceService.getAttachmentDownloadUrl(this.state.recordDefinitionName,e,this.state.recordInstanceId)),t}getAssociationManager(e){const t=(0,m.values)(e.rolesConfig).join("_"),i=(0,m.compact)([e.associationDefinitionName,t,e.associatedRecordNodeSide]).join(":");let n=this.associationManagers[i];return n?n.extendOptions(e):(e.associationInstances=this.getAssociationInstances(e.associationDefinitionName,e.associatedRecordNodeSide,t),n=this.rxAssociationManagerServiceFactory(e),(0,o.merge)(n.pending$,n.existing$).pipe((0,r.filter)(()=>0!==n.deleted.length||0!==n.pending.length),(0,r.take)(1)).subscribe(()=>this.markAsDirty()),n.extensions$.pipe((0,r.filter)(e=>!(0,m.isEmpty)(e)),(0,r.takeUntil)(this.destroyed$)).subscribe(()=>{this.syncRecordInstanceWithForm(e.associatedRecordPath),this.notifyPropertyChanged("recordInstance",this.state.recordInstance)}),this.associationManagers[i]=n),n}markAsDirty(){this.state.form.markAsTouched(),this.state.form.markAsDirty(),this.updateIsDirtyProperty(),this.updateCanSaveProperty()}refresh(){return this.isInEditMode()&&this.state.currentState===Xs.Read?this.initializeRecordInstance().pipe((0,r.catchError)(e=>this.handleNoRecordFoundError(e))):o.EMPTY}isDirty(){return!this.isInTemporaryMode()&&this.state.form.dirty}isReady(){return(0,m.isEmpty)(this.notReadyComponentIds)}notifyComponentReady(e,t){t?delete this.notReadyComponentIds[e]:this.notReadyComponentIds[e]=!0}setProperty(e,t){const i=e.match(/^recordInstance\.fieldInstances\.(\d+)\.value$/),n="readState"===e&&!t||"editState"===e&&t;if("readState"===e&&t||"editState"===e&&!t){if(this.state.currentState!==Xs.Read)return this.cancel()}else if(n)this.state.currentState!==Xs.Edit&&this.switchToEditState();else{if(!i)return(0,o.throwError)(`Record editor: property ${e} is not settable.`);{const e=Number(i[1]);this.setFieldValue(e,t)}}}setFieldValue(e,t,i,n={}){this.state.recordInstance&&this.state.recordInstance.getRecordInstance(i)&&this.state.recordInstance.isFieldValueChanged(e,t,i)&&(this.state.recordInstance.setFieldValue(e,t,i),this.state.form.syncFormControlValues(String(e),this.state.recordInstance.getFieldValue(e,i),i&&i.join(ol),n),this.updateSelectionFieldOptionNames(this.state.recordInstance),this.notifyPropertyChanged("recordInstance",this.state.recordInstance),this.updateIsDirtyProperty(),this.updateCanSaveProperty())}getFieldValue(e,t){return this.state.recordInstance&&this.state.recordInstance.getFieldValue(e,t)}save(e=!1){if(this.isInTemporaryMode())return this.rxLogService.debug("Record Editor: skip saving record instance in Temporary mode."),o.EMPTY;if(this.isValid()){if(this.canSave()){let t;return this.state.isSaving=!0,this.updateCanSaveProperty(),this.isInCreateMode()?t=this.rxRecordInstanceService.create(this.state.recordInstance).pipe((0,r.tap)(t=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.common.saved-successfully.message")),this.state.recordInstanceId||((0,m.set)(this.state.recordInstance,`fieldInstances[${a.RX_RECORD_DEFINITION.coreFieldIds.id}].value`,t.id),this.state.recordInstance.id=t.id,this.state.recordInstanceId=t.id),this.notifyPropertyChanged("recordInstance",this.state.recordInstance),this.notifyPropertyChanged("recordInstanceId",this.state.recordInstanceId),e||this.rxGlobalEventsService.viewActionsCompleted$.pipe((0,r.take)(1),(0,r.switchMap)(()=>this.initializeRecordInstance()),(0,r.takeUntil)(this.destroyed$)).subscribe()}),(0,r.switchMapTo)(o.EMPTY)):this.isInEditMode()&&(t=this.rxRecordInstanceUpdateService.execute(this.state.recordInstance).pipe((0,r.tap)(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.common.saved-successfully.message"))}),(0,r.switchMap)(()=>this.initializeRecordInstance().pipe((0,r.catchError)(e=>this.handleNoRecordFoundError(e)),(0,r.tap)({complete:()=>{this.state.isReadOnlyStateAvailable&&this.setRecordEditorState(Xs.Read)}}))))),t.pipe((0,r.tap)({complete:()=>{this.state.form.markAsPristine()}}),(0,r.finalize)(()=>{this.state.isSaving=!1,this.updateCanSaveProperty(),this.updateIsDirtyProperty()}))}return this.rxLogService.debug("Record Editor: cannot save unmodified record instance."),(0,o.throwError)(null)}return this.state.form.markInvalidControlsAsTouched(),this.rxNotificationService.addErrorMessage(this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-editor.validation-error.message")),(0,o.throwError)(null)}getFieldControl(e,t,i=[],n){const a=this.state.form.getFormControl(String(e),t,n);if(a)return a;const s=this.state.recordInstance?this.state.recordInstance.getFieldValue(e,n):null,l=this.getFieldInstanceControlValidator(e,n);let d;return(i=Array.isArray(i)?i:[i]).push(l),d=n?this.state.form.addAssociatedFieldControl(String(e),t,n,s,i):this.state.form.addFieldControl(String(e),t,s,i),d.valueChanges.pipe((0,r.distinctUntilChanged)(this.rxRecordInstanceUtilsService.isFieldValueEqual),(0,r.observeOn)(o.asyncScheduler),(0,r.takeUntil)(this.destroyed$)).subscribe(()=>{this.setFieldValue(e,d.value,n,{markAsDirty:d.dirty,markAsTouched:!1})}),d}getPermissionType(e,t){const i=this.state.recordInstance?this.state.recordInstance.getFieldInstance(e,t):null;return i?(0,m.get)(i,"permissionType")||a.RX_RECORD_DEFINITION.fieldPermissionTypes.change:null}getFieldInstanceProp(e,t,i){return this.state.recordInstance&&this.state.recordInstance.getFieldProp(e,t,i)}getRecordEditorMode(){return this.state.mode}setFieldInstanceProp(e,t,i,n){this.state.recordInstance&&this.state.recordInstance.setFieldProp(e,t,i,n)}isValid(){return this.state.form.valid}switchToEditState(){this.setRecordEditorState(Xs.Edit)}isEditStateAvailable(){return this.state.isReadOnlyStateAvailable&&this.state.currentState===Xs.Read&&Boolean(this.state.recordInstanceId)&&Boolean(this.state.allowEdit)}isSaveButtonAvailable(){return this.state.isReadOnlyStateAvailable&&this.state.currentState===Xs.Edit}isSaveButtonDisabled(){return!this.canSave()}isCancelButtonAvailable(){return this.state.isReadOnlyStateAvailable&&this.state.currentState===Xs.Edit&&this.isInEditMode()}cancel(){if(this.state.isReadOnlyStateAvailable&&this.state.recordInstance){if(this.isDirty())return(0,o.defer)(()=>(0,o.from)(this.rxUtilityModalsService.confirmUnsavedChanges())).pipe((0,r.switchMap)(e=>e?(this.restoreRecordEditor(),this.setRecordEditorState(Xs.Read),o.EMPTY):(0,o.throwError)(null)));this.setRecordEditorState(Xs.Read)}return o.EMPTY}canSave(){return!!this.isInTemporaryMode()||!this.state.isSaving&&(this.isInCreateMode()||this.isDirty())}isConfigValid(){return!this.isInEditMode()||this.rxStringService.isNonEmptyString(this.state.recordInstanceId)}onSaveClick(){this.save().pipe((0,r.take)(1),(0,r.catchError)(e=>null===e?(0,o.of)(e):(0,o.throwError)(e))).subscribe()}onCancelClick(){this.cancel().subscribe()}initializeRecordInstance(){let e=o.EMPTY;return this.isConfigValid()?(this.state.isDataLoading=!0,e=this.getRecordInstance().pipe((0,r.tap)(e=>{this.setRecordInstance(e),this.setRecordDefinition(e.recordDefinition),this.updateSelectionFieldOptionNames(e)}),(0,r.switchMapTo)(o.EMPTY),(0,r.catchError)(e=>(o.asapScheduler.schedule(()=>{this.setRecordInstance(null),this.setRecordDefinition(null)}),(0,o.throwError)(e))),(0,r.finalize)(()=>{this.state.isDataLoading=!1}))):(""===this.state.recordInstanceId||(0,m.isNil)(this.state.recordInstanceId)||this.rxNotificationService.addErrorMessage(this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-editor.invalid-record-instance-id.message")),this.state.recordInstance&&(this.setRecordInstance(null),this.setRecordDefinition(null))),e}handleNoRecordFoundError(e){const t=this.rxRecordInstanceUtilsService.isNoRecordFoundError(e);return t&&(this.rxNotificationService.addWarningMessage(this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-editor.no-access-to-record.message")),this.runtimeViewModelApi.cancel(!0).subscribe()),(0,o.throwError)(t?null:e)}updateIsDirtyProperty(){const e=this.isDirty();this.state.isDirty!==e&&(this.state.isDirty=e,this.notifyPropertyChanged("isDirty",e))}updateCanSaveProperty(){const e=this.canSave();this.state.canSave!==e&&(this.state.canSave=e,this.notifyPropertyChanged("canSave",e))}setRecordInstance(e){(0,m.forEach)(this.associationManagers,e=>e.destroy()),this.associationInstances={},this.associationManagers={},e&&!e.associationInstances&&(e.associationInstances={},this.associationInstances=e.associationInstances),this.state.recordInstance=e,this.state.recordInstanceId=e&&e.id,e?this.syncRecordInstanceWithForm():this.state.form.clearAndReset(),this.notifyPropertyChanged("recordInstance",this.state.recordInstance),this.notifyPropertyChanged("recordInstanceId",this.state.recordInstanceId),this.updateIsDirtyProperty(),this.updateCanSaveProperty(),e&&this.recordInstanceChangedSubject.next()}getFieldInstanceControlValidator(e,t){return i=>this.state.recordInstance&&this.state.recordInstance.validateSingleField(e,i.value,t)}setRecordDefinition(e){e&&(this.isInBulkEditMode()&&(e=this.rxRecordDefinitionService.setFieldDefinitionsToOptional(e)),e.fieldDefinitionsById=this.rxRecordDefinitionService.buildFieldDefinitionsByIdMap(e)),this.state.recordDefinition=e,this.notifyPropertyChanged("recordDefinition",this.state.recordDefinition)}getRecordInstance(){return this.isInCreateMode()||this.isInTemporaryMode()?this.state.recordInstance?(this.state.recordInstance=this.state.recordInstance.getOriginalRecordInstance(),(0,o.of)(this.state.recordInstance)):this.rxRecordInstanceService.getNew(this.state.recordDefinitionName):this.isInBulkEditMode()?this.rxRecordInstanceService.getEmpty(this.state.recordDefinitionName):this.isInEditMode()?this.rxRecordInstanceService.get(this.state.recordDefinitionName,this.state.recordInstanceId):void 0}getAssociationInstances(e,t,i){const n=(0,m.compact)([t,i]).join(":");let o=(0,m.get)(this.associationInstances,[e,n]);return o||(o={existing:[],pending:[],deleted:[],extensions:[]},(0,m.set)(this.associationInstances,[e,n],o)),o}setRecordEditorState(e){this.state.currentState=e,this.notifyPropertyChanged("inReadState",e===Xs.Read)}isInCreateMode(){return this.state.mode===zs.Create}isInBulkEditMode(){return this.state.mode===zs.BulkEdit}isInEditMode(){return this.state.mode===zs.Edit}isInTemporaryMode(){return this.state.mode===zs.Temporary}isNewAttachment(e){return Boolean(this.state.recordInstance.fieldInstances[e].file)}updateSelectionFieldOptionNames(e){if(e&&(0,m.get)(this.state.recordDefinition,"fieldDefinitions")){const t=this.rxRecordEditorUtilsService.getSelectionFieldOptionNames(this.state.recordDefinition,e);(0,m.isEqual)(this.state.selectionFieldOptionNamesById,t)||this.notifyPropertyChanged("selectionFieldOptionNamesById",t)}}syncRecordInstanceWithForm(e){const t=this.state.form.getFieldIds(e);if(!(0,m.isEmpty)(t)){const i=t.reduce((t,i)=>(t[i]=this.state.recordInstance.getFieldValue(Number(i),e),t),{});this.state.form.resetFieldControls(i,e)}}restoreRecordEditor(){this.state.recordInstance.revertFieldInstances(),(0,m.forEach)(this.associationManagers,e=>e.restore()),this.syncRecordInstanceWithForm(),this.notifyPropertyChanged("recordInstance",this.state.recordInstance),this.updateIsDirtyProperty(),this.updateCanSaveProperty()}}sl.\u0275fac=function(e){return new(e||sl)(n["\u0275\u0275directiveInject"](a.RxRecordInstanceService),n["\u0275\u0275directiveInject"](a.RxRecordInstanceUpdateService),n["\u0275\u0275directiveInject"](p.TranslateService),n["\u0275\u0275directiveInject"](s.RxGlobalEventsService),n["\u0275\u0275directiveInject"](s.RxNotificationService),n["\u0275\u0275directiveInject"](a.RxRecordDefinitionService),n["\u0275\u0275directiveInject"](il),n["\u0275\u0275directiveInject"](a.RxRecordInstanceUtilsService),n["\u0275\u0275directiveInject"](v.RxStringService),n["\u0275\u0275directiveInject"](s.RxLogService),n["\u0275\u0275directiveInject"](S.RxUtilityModalsService),n["\u0275\u0275directiveInject"](al),n["\u0275\u0275directiveInject"](tl))},sl.\u0275cmp=n["\u0275\u0275defineComponent"]({type:sl,selectors:[["rx-record-editor"]],inputs:{config:"config",runtimeViewModelApi:"runtimeViewModelApi"},features:[n["\u0275\u0275ProvidersFeature"]([al]),n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:3,consts:[["class","loader-container",4,"ngIf"],[4,"ngIf"],["class","clearfix",4,"ngIf"],[1,"loader-container"],[1,"loader-inline","mr-1"],[1,"clearfix"],[1,"d-flex","justify-content-end"],["class","py-0 mb-1","adapt-button","","size","small","btn-type","tertiary",3,"click",4,"ngIf"],["class","mr-1 mt-3","rx-id","save-button","adapt-button","","btn-type","primary","size","small",3,"disabled","click",4,"ngIf"],["class","mt-3","rx-id","cancel-button","adapt-button","","btn-type","secondary","size","small",3,"click",4,"ngIf"],["adapt-button","","size","small","btn-type","tertiary",1,"py-0","mb-1",3,"click"],["rx-id","save-button","adapt-button","","btn-type","primary","size","small",1,"mr-1","mt-3",3,"disabled","click"],["rx-id","cancel-button","adapt-button","","btn-type","secondary","size","small",1,"mt-3",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,ie,5,3,"div",0),n["\u0275\u0275template"](1,ne,3,3,"div",1),n["\u0275\u0275template"](2,se,6,3,"div",2)),2&e&&(n["\u0275\u0275property"]("ngIf",t.state.isDataLoading&&!t.state.recordInstance),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!(t.state.isDataLoading||t.isConfigValid()&&t.state.recordInstance)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.state.recordInstance&&t.isConfigValid()))},directives:[f.NgIf,h.RuntimeViewCanvasOutletComponent,u.AdaptButtonComponent],pipes:[p.TranslatePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{display:block;border:1px solid #d6d7d8;padding:1rem;position:relative}']});class ll{constructor(e){this.viewDefinitionParserService=e}adaptDefinition(e){const t=(0,m.get)(e,"propertiesByName");t.mode===zs.Edit&&(0,m.isUndefined)(t.allowEdit)&&(t.allowEdit="1"),this.viewDefinitionParserService.getComponents(e).filter(e=>e.componentDefinition.type!==d.RxViewComponentType.ActionButton&&(e.componentDefinition.propertiesByName.hasOwnProperty("fieldId")||e.componentDefinition.type===d.RxViewComponentType.Association)).map(e=>e.componentDefinition).forEach(t=>{Object.assign(t.propertiesByName,{api:`\${view.components.${e.guid}.api}`,inReadState:`\${view.components.${e.guid}.inReadState}`,recordDefinition:`\${view.components.${e.guid}.recordDefinition}`,recordInstance:`\${view.components.${e.guid}.recordInstance}`})})}}function dl(e,t,i,n,o,r){return function(a){return new tl(a,e,t,i,n,o,r)}}ll.\u0275fac=function(e){return new(e||ll)(n["\u0275\u0275inject"](d.RxViewDefinitionParserService))},ll.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ll,factory:ll.\u0275fac});class cl{constructor(e,t){this.rxDefinitionAdapterRegistryService=e,this.recordEditorComponentDefinitionAdapterService=t,e.registerRuntimeAdapter(d.RxViewComponentType.RecordEditor,this.recordEditorComponentDefinitionAdapterService)}}cl.\u0275fac=function(e){return new(e||cl)(n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService),n["\u0275\u0275inject"](ll))},cl.\u0275mod=n["\u0275\u0275defineNgModule"]({type:cl,declarations:[sl],imports:[f.CommonModule,h.RuntimeViewCanvasModule,b.ReactiveFormsModule,u.AdaptButtonModule,S.RxModalModule,p.TranslateModule,u.AdaptAlertModule],exports:[sl]}),cl.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[ll,il,{provide:tl,useFactory:dl,deps:[C.RxAssociationInstanceDataPageService,a.RxRecordDefinitionCacheService,a.RxRecordInstanceUtilsService,a.RxRecordInstanceService,v.RxJsonParserService,C.RxAssociationDefinitionCacheService]}],imports:[[f.CommonModule,h.RuntimeViewCanvasModule,b.ReactiveFormsModule,u.AdaptButtonModule,S.RxModalModule,p.TranslateModule,u.AdaptAlertModule.forRoot()]]});class pl{constructor(){this.resourceTypeFieldTypeMap={},this.initResourceTypeFieldTypeMap()}getFieldTypeByFieldDefinition(e){return(0,m.isFunction)(this.resourceTypeFieldTypeMap[e.resourceType])?this.resourceTypeFieldTypeMap[e.resourceType](e):this.resourceTypeFieldTypeMap[e.resourceType]}initResourceTypeFieldTypeMap(){this.resourceTypeFieldTypeMap=Object.assign(Object.assign({},Us.fieldTypes),{[a.RX_RECORD_DEFINITION.resourceTypes.character]:e=>e.namedListDefinition||(0,m.inRange)(e.maxLength,1,255)?d.RxViewComponentType.Character:d.RxViewComponentType.Textarea})}}pl.\u0275fac=function(e){return new(e||pl)},pl.\u0275prov=n["\u0275\u0275defineInjectable"]({token:pl,factory:pl.\u0275fac,providedIn:"root"});const ml={actions:{associate:"associate",createAndAssociate:"createAndAssociate"},componentTypes:{associationFilter:"rx-association-filter",associatedRecordField:"rx-associated-record-field"}};var ul;!function(e){e.Dropdown="dropdown",e.Views="views"}(ul||(ul={}));class fl{ngOnInit(){this.maxFieldValueLength=this.config.maxFieldValueLength||200}isEditableState(){return this.config.state===Xs.Edit}}fl.\u0275fac=function(e){return new(e||fl)},fl.\u0275cmp=n["\u0275\u0275defineComponent"]({type:fl,selectors:[["rx-record-preview-card"]],inputs:{config:"config"},decls:4,vars:2,consts:[[1,"rx-record-preview-card","d-flex","align-items-start","justify-content-between","w-100"],["tabindex","0",1,"rx-card-fields","d-flex","flex-column","list-unstyled","focusable","mb-0"],["class","d-flex rx-card-field",4,"ngFor","ngForOf"],["class","btn btn-link d-icon-cross p-0","adapt-button","","size","small","btn-type","tertiary",3,"click",4,"ngIf"],[1,"d-flex","rx-card-field"],["class","rx-card-field-label",4,"ngIf"],[4,"ngIf"],[1,"rx-card-field-value","px-1",3,"ngClass"],[1,"rx-card-field-label"],["adapt-button","","size","small","btn-type","tertiary",1,"btn","btn-link","d-icon-cross","p-0",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"ul",1),n["\u0275\u0275template"](2,pe,5,6,"li",2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](3,me,2,3,"button",3),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",t.config.fields),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.isEditableState()))},directives:[f.NgForOf,f.NgIf,f.NgClass,u.AdaptButtonComponent],pipes:[p.TranslatePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{display:flex}.rx-record-preview-card[_ngcontent-%COMP%]{flex:1}.rx-card-field[_ngcontent-%COMP%]{flex:1;line-height:20px}.rx-card-field[_ngcontent-%COMP%]:not(:first-child){color:#959899}.rx-card-fields[_ngcontent-%COMP%]{flex:1;white-space:nowrap;min-width:0}.rx-card-field-label[_ngcontent-%COMP%]{flex-shrink:0;max-width:30%;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.rx-card-field-value[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden}']});class hl extends h.BaseViewComponent{constructor(e,t,i,n,o,r){super(),this.datePipe=e,this.rxAssociationDefinitionService=t,this.rxAssociationInstanceDataPageService=i,this.rxRecordDefinitionInheritanceDataPageService=n,this.rxRecordInstanceDataPageService=o,this.rxRecordInstanceUtilsService=r,this.isDisabled=!1,this.api={associate:e=>{this.associationManager.addToPending(e,this.extractRolesConfig())}},this.modelToViewValueAdapterFunc=this.modelToViewValueAdapter.bind(this),this.optionLoaderFunc=this.getAssociationsOptionPage.bind(this),this.viewToModelValueAdapterFunc=this.viewToModelValueAdapter.bind(this),this.existingPreviewConfigurations=[],this.pendingPreviewConfigurations=[],this.selectedOptions=[],this.pendingPageSize=10,this.currentPendingCount=10,this.totalPendingCount=0,this.associationCandidateRecordInstances=[],this.fieldDefinitions={},this.fieldId=null,this.fields=[],this.inReadState=!1,this.label=null,this.recordDefinition=null,this.recordDefinitionName=null,this.useDefaultRoles=null,this.nodeARole=null,this.nodeBRole=null,this.formControl=new b.FormControl("",null),this.isHidden=!1}ngOnInit(){super.ngOnInit();const e=this.config.pipe((0,r.filter)(e=>Boolean(e.api&&e.recordDefinition)),(0,r.takeUntil)(this.destroyed$));e.pipe((0,r.take)(1)).subscribe(e=>{this.onConfigInitialized(e),this.onConfigUpdated(e)}),e.pipe((0,r.skip)(1)).subscribe(this.onConfigUpdated.bind(this)),this.notifyPropertyChanged("api",this.api),this.previewRolesConfig=this.extractRolesConfig()}ngAfterViewInit(){this.editingMode===ul.Dropdown&&this.formControl.valueChanges.pipe((0,r.distinctUntilChanged)(),(0,r.startWith)(this.formControl.value),(0,r.takeUntil)(this.destroyed$)).subscribe(()=>{this.updateSelectedOptions()})}onConfigInitialized(e){this.associationDefinitionName=e.associationDefinitionName,this.associatedRecordNodeSide=e.associatedRecordNodeSide,this.editingMode=e.editingMode||ul.Views,this.fieldId=e.fieldId,this.fields=e.fields,this.recordDefinition=e.recordDefinition,this.recordDefinitionName=e.recordDefinitionName,this.recordEditorApi=e.api,this.state=e.state,this.useDefaultRoles=e.useDefaultRoles,this.nodeARole=e.nodeARole,this.nodeBRole=e.nodeBRole,this.fieldId&&(this.fieldDefinition=e.recordDefinition.fieldDefinitions.find(e=>e.id===Number(this.fieldId)))}onConfigUpdated(e){var t;const i=Boolean(e.inReadState),n=Boolean(e.disabled)||this.permissionType===a.RX_RECORD_DEFINITION.fieldPermissionTypes.view;let s=!1;this.isHidden=Boolean(e.hidden),this.areActionsAvailable=!i&&this.editingMode===ul.Views,this.isDisabled!==n&&(this.isDisabled=n,s=!0),this.inReadState!==i&&(this.inReadState=i,s=!0),s&&this.existingPreviewConfigurations.length&&this.updatePreviewCardConfigState(),this.label=(0,m.isUndefined)(e.label)?null!==(t=this.fieldDefinition.name)&&void 0!==t?t:"":e.label,this.selectWithPaginationComponent&&this.associationFilter&&(0,m.get)(e,"associationFilter[0]")&&this.associationFilter.recordInstanceId!==e.associationFilter[0].recordInstanceId&&(this.recordEditorApi.isReady()&&this.deleteAllExisting(),this.deleteAllPending(),this.selectWithPaginationComponent.resetLoadedOptions(),this.associationCandidateRecordInstances=[],this.associationFilterNodeSide||this.rxAssociationDefinitionService.get(this.associationFilter.associationDefinitionName).pipe((0,r.switchMap)(e=>{if(e.nodeAId===this.recordDefinitionName)this.associationFilterNodeSide=C.RxAssociatedRecordNodeSide.NodeA;else{if(e.nodeBId!==this.recordDefinitionName)return this.rxRecordDefinitionInheritanceDataPageService.get({params:{recorddefinition:this.recordDefinitionName}}).pipe((0,r.tap)(t=>{const i=t.data;if((0,m.includes)(i,e.nodeAId))this.associationFilterNodeSide=C.RxAssociatedRecordNodeSide.NodeA;else{if(!(0,m.includes)(i,e.nodeBId))throw new Error("No matches for association definition node side within inheritance ancestors.");this.associatedRecordNodeSide=C.RxAssociatedRecordNodeSide.NodeB}}));this.associationFilterNodeSide=C.RxAssociatedRecordNodeSide.NodeB}return o.EMPTY})).subscribe()),this.associationFilter=(0,m.head)(e.associationFilter),e.recordInstance&&this.recordInstance!==e.recordInstance&&(this.recordInstance=e.recordInstance,this.isDisabled=!0,this.notifyPropertyChanged("isDisabled",this.isDisabled),this.recordEditorApi.notifyComponentReady(this.guid,!1),this.associationManager=this.getAssociationManager(),this.associationManager.initialize().pipe((0,r.delay)(0),(0,r.switchMap)(()=>this.associationManager.loadExistingAssociations()),(0,r.tap)(()=>{this.isDisabled=Boolean(e.disabled)||this.permissionType===a.RX_RECORD_DEFINITION.fieldPermissionTypes.view,this.notifyPropertyChanged("isDisabled",this.isDisabled),this.areActionsAvailable=!this.inReadState&&this.editingMode===ul.Views,this.editingMode===ul.Views&&(this.fieldDefinitions=(0,m.transform)(this.fields,(e,t)=>{const i=(0,m.find)(this.associationManager.recordDefinition.fieldDefinitions,{id:Number(t.fieldId)});e[i.id]=i},{})),this.associationManager.existing$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.onAssociationsChanged(e,"existingPreviewConfigurations"),this.updateTotalExistingAssociationsCount()}),this.associationManager.pending$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.onAssociationsChanged(e,"pendingPreviewConfigurations"),this.totalPendingCount=this.pendingPreviewConfigurations.length}),(0,o.combineLatest)([this.associationManager.pending$,this.associationManager.existing$]).pipe((0,r.take)(1)).subscribe(()=>{this.recordEditorApi.notifyComponentReady(this.guid,!0)})})).subscribe())}getAssociationManager(){const e=this.fieldId?[this.fieldId,a.RX_RECORD_DEFINITION.coreFieldIds.id]:(0,m.map)(this.fields,"fieldId");return this.recordEditorApi.getAssociationManager({associationDefinitionName:this.associationDefinitionName,associatedRecordNodeSide:this.associatedRecordNodeSide||C.RX_ASSOCIATION_DEFINITION.roles.second.value,associatedRecordInstanceId:this.recordInstance.id,recordDefinitionName:this.recordDefinitionName,fieldIds:e,rolesConfig:this.extractRolesConfig()})}getAssociationsOptionPage(e,t,i){const n={pageSize:t,startIndex:e,recorddefinition:this.recordDefinitionName,propertySelection:this.associationManager.getFieldIds()};let s;return this.associationFilter?this.associationFilter.recordInstanceId&&(n.associationDefinition=this.associationFilter.associationDefinitionName,n.associatedRecordInstanceId=this.associationFilter.recordInstanceId,n.nodeToQuery=this.associationFilterNodeSide,s=this.rxAssociationInstanceDataPageService):(n.sortBy=this.fieldId,i&&(n.queryExpression=`('${this.fieldId}' LIKE "%${this.rxRecordInstanceUtilsService.escapeTextWildcards(i)}%")`),s=this.rxRecordInstanceDataPageService),s?s.post({params:n}).pipe((0,r.map)(e=>(this.associationCandidateRecordInstances.push(...e.data),{totalSize:e.totalSize,options:e.data.map(e=>({displayValue:e[this.fieldId]||"",value:e[a.RX_RECORD_DEFINITION.coreFieldIds.id]}))}))):(0,o.of)({options:[],totalSize:0})}deleteAllExisting(){this.associationManager.deleteAllExisting()}deleteAllPending(){this.associationManager.deleteAllPending()}loadExistingAssociations(){this.associationManager.loadExistingAssociations().pipe((0,r.takeUntil)(this.destroyed$)).subscribe(()=>this.updateTotalExistingAssociationsCount())}isReadModeEnabled(){return this.inReadState}isEditModeEnabled(){return!this.inReadState}getAssociatedValue(){return(0,m.get)(this,"selectedOptions[0].displayValue")}viewToModelValueAdapter(e){return e.map(e=>e.value).join(";")}modelToViewValueAdapter(e){return e?(0,m.castArray)(this.selectedOptions):[]}resetDropdownSelection(){this.selectedOptions=[]}updatePreviewCardConfigState(){(0,m.forEach)(this.existingPreviewConfigurations,e=>{e.state=this.getStateForPreviewConfiguration()})}updateSelectedOptions(){if(this.formControl.value&&!(0,m.isNil)(this.formControl.value)){const e={id:this.formControl.value,fieldInstances:null},t=(0,m.find)(this.associationCandidateRecordInstances,function(t){return t[a.RX_RECORD_DEFINITION.coreFieldIds.id]===e.id});e.fieldInstances=(0,m.transform)(t,function(e,t,i){e[i]={value:t}},{}),this.associationManager.addToPending([e],null)}else this.deleteAllExisting(),this.deleteAllPending()}buildPreviewConfig(e,t,i){return{id:e.id,state:i,onDelete:e=>{this.associationManager.delete(e)},fields:(0,m.map)(t,t=>{const i=this.fieldDefinitions[t.fieldId],n=e.fieldInstances[t.fieldId];let o;return n&&(o=n.value),i.resourceType===a.RX_RECORD_DEFINITION.dataTypes.selection.resourceType&&(o=i.optionNamesById[o]),(i.resourceType===a.RX_RECORD_DEFINITION.dataTypes.dateTime.resourceType||i.resourceType===a.RX_RECORD_DEFINITION.dataTypes.dateOnly.resourceType&&(0,m.isString)(o))&&(o=this.datePipe.transform(o,"mediumDate")),{label:t.label,value:o||"<unknown>",index:t.index,fieldId:t.fieldId}})}}showPendingAssociations(){this.currentPendingCount+=this.pendingPageSize}getPendingPreviewConfigurations(){return this.pendingPreviewConfigurations.slice(0,this.currentPendingCount)}extractRolesConfig(){return{useDefaultRoles:this.useDefaultRoles,nodeARole:this.nodeARole,nodeBRole:this.nodeBRole}}updateTotalExistingAssociationsCount(){this.associationManager.totalExistingCount=(this.associationManager.remainingAssociatedRecordCount||0)+this.existingPreviewConfigurations.length}getStateForPreviewConfiguration(){return this.areActionsAvailable&&!this.isDisabled?Xs.Edit:Xs.Read}getFirstAssociationRecord(){return this.associationManager.existing[0]||this.associationManager.pending[0]||{}}onAssociationsChanged(e,t){var i;const n=this.getFirstAssociationRecord();if(this.notifyPropertyChanged("firstAssociatedRecord",{id:n.id||""}),this.editingMode===ul.Views){const i=e.filter(e=>(0,m.every)(this.previewRolesConfig,m.isEmpty)||(0,m.isEqual)(this.previewRolesConfig,e.rolesConfig));this[t]=this.rebuildPreviewConfigurations(i)}else this.editingMode===ul.Dropdown&&(n.id?this.selectedOptions=[{displayValue:null===(i=n.fieldInstances[this.fieldId])||void 0===i?void 0:i.value,value:n.id}]:this.resetDropdownSelection(),this.formControl.setValue(n.id))}rebuildPreviewConfigurations(e){const t=this.getStateForPreviewConfiguration();return(0,m.map)(e,e=>this.buildPreviewConfig(e,this.fields,t))}}hl.\u0275fac=function(e){return new(e||hl)(n["\u0275\u0275directiveInject"](f.DatePipe),n["\u0275\u0275directiveInject"](C.RxAssociationDefinitionService),n["\u0275\u0275directiveInject"](C.RxAssociationInstanceDataPageService),n["\u0275\u0275directiveInject"](a.RxRecordDefinitionInheritanceDataPageService),n["\u0275\u0275directiveInject"](a.RxRecordInstanceDataPageService),n["\u0275\u0275directiveInject"](a.RxRecordInstanceUtilsService))},hl.\u0275cmp=n["\u0275\u0275defineComponent"]({type:hl,selectors:[["rx-association"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](l.RxSelectWithPaginationComponent,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.selectWithPaginationComponent=e.first)}},hostVars:2,hostBindings:function(e,t){2&e&&n["\u0275\u0275classProp"]("rx-field-disabled",t.isDisabled)},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:2,vars:2,consts:[[3,"label","value",4,"ngIf"],[3,"ngSwitch",4,"ngIf"],[3,"label","value"],[3,"ngSwitch"],[3,"ngClass",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"ngClass"],[3,"label",4,"ngIf"],[4,"ngIf"],[3,"label"],[4,"ngSwitchDefault"],["class","list-group",4,"ngIf"],[1,"list-group"],[1,"list-group-item",3,"config"],["class","list-group-item",3,"config",4,"ngFor","ngForOf"],["adapt-button","","size","small","btn-type","tertiary","type","button",3,"click",4,"ngIf"],["adapt-button","","size","small","btn-type","tertiary","type","button",3,"click"],["class","form-group",4,"ngIf"],["class","form-group mt-3",4,"ngIf"],[1,"form-group"],[1,"d-flex","justify-content-end","pb-1"],[1,"preview-count"],["adapt-button","","size","small","btn-type","tertiary","type","button",1,"btn","btn-link","py-0",3,"hidden","click"],[1,"form-group","mt-3"],[1,"d-flex","justify-content-between"],[1,"m-0"],[1,"d-flex","pb-1"],[3,"formControl","readonly","label","modelToViewValueAdapter","optionLoader","viewToModelValueAdapter"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,ue,1,2,"rx-read-only-field",0),n["\u0275\u0275template"](1,Ve,3,3,"div",1)),2&e&&(n["\u0275\u0275property"]("ngIf",!t.isHidden&&t.isReadModeEnabled()&&(0===t.existingPreviewConfigurations.length||"dropdown"===t.editingMode)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.isHidden))},directives:[f.NgIf,S.ReadOnlyFieldComponent,f.NgSwitch,f.NgSwitchCase,f.NgClass,u.AdaptRxControlLabelComponent,h.RuntimeViewCanvasOutletComponent,f.NgSwitchDefault,fl,f.NgForOf,u.AdaptButtonComponent,l.RxSelectWithPaginationComponent,b.NgControlStatus,b.FormControlDirective],pipes:[p.TranslatePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{display:block}[_nghost-%COMP%]  rx-runtime-view-canvas-item-container{display:flex}[_nghost-%COMP%]  .rx-runtime-view-canvas-item-margin{margin-bottom:0}[_nghost-%COMP%]  rx-runtime-view-canvas-item+rx-runtime-view-canvas-item{margin-left:5px}[_nghost-%COMP%]  .read-state .form-control-label{font-weight:var(--font-weight-normal)}.rx-group-title[_ngcontent-%COMP%]{font-size:.8125rem;color:#959899;display:flex;align-items:center}.rx-preview-existing-head[_ngcontent-%COMP%]{margin-top:-30px}.rx-preview-count[_ngcontent-%COMP%]{font-size:.8125rem;color:#959899;vertical-align:middle}']});class gl{constructor(e){this.rxViewDefinitionParserService=e}adaptDefinition(e,t){const i=this.getTargetRecordEditorComponentDefinition(t,e),n=e.componentDefinitions.filter(e=>e.type===d.RxViewComponentType.ActionButton),o=(0,m.sortBy)(n,e=>e.propertiesByName.action===ml.actions.associate?0:1);e.propertiesByName.state=i.propertiesByName.mode,e.propertiesByName.useDefaultRoles="true"===e.propertiesByName.useDefaultRoles,e.propertiesByName.fields=(0,m.flow)(e=>(0,m.filter)(e,{type:ml.componentTypes.associatedRecordField}),e=>(0,m.map)(e,e=>({fieldId:e.propertiesByName.fieldId,label:e.propertiesByName.label,index:Number(e.propertiesByName.index)})),e=>(0,m.sortBy)(e,"index"))(e.componentDefinitions),e.layout=JSON.stringify({outlets:[{name:"DEFAULT",columns:[{children:o.map(e=>e.guid)}]}]}),e.componentDefinitions.filter(e=>e.type===d.RxViewComponentType.ActionButton).forEach(t=>{t.propertiesByName.disabled=e.propertiesByName.disabled+" OR ${view.components."+e.guid+".isDisabled}"})}getTargetRecordEditorComponentDefinition(e,t){return this.rxViewDefinitionParserService.findParentComponentDefinition(e,t,e=>e.type===d.RxViewComponentType.RecordEditor)}}gl.\u0275fac=function(e){return new(e||gl)(n["\u0275\u0275inject"](d.RxViewDefinitionParserService))},gl.\u0275prov=n["\u0275\u0275defineInjectable"]({token:gl,factory:gl.\u0275fac});class vl{constructor(e,t){this.rxAssociationDefinitionAdapterService=e,this.rxDefinitionAdapterRegistryService=t,this.rxDefinitionAdapterRegistryService.registerRuntimeAdapter(d.RxViewComponentType.Association,this.rxAssociationDefinitionAdapterService)}}vl.\u0275fac=function(e){return new(e||vl)(n["\u0275\u0275inject"](gl),n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService))},vl.\u0275mod=n["\u0275\u0275defineNgModule"]({type:vl,declarations:[hl,fl],imports:[u.AdaptButtonModule,u.AdaptRxFormControlModule,f.CommonModule,b.FormsModule,S.ReadOnlyFieldModule,b.ReactiveFormsModule,h.RuntimeViewCanvasModule,l.RxSelectWithPaginationModule,p.TranslateModule]}),vl.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[f.DatePipe,gl],imports:[[u.AdaptButtonModule,u.AdaptRxFormControlModule,f.CommonModule,b.FormsModule,S.ReadOnlyFieldModule,b.ReactiveFormsModule,h.RuntimeViewCanvasModule,l.RxSelectWithPaginationModule,p.TranslateModule]]});class yl extends S.RxModalClass{constructor(e,t,i,n){super(i,n),this.rxStringService=e,this.rxGuidService=t,this.activeModalRef=i,this.injector=n,this.availableFieldTreeNodes=[],this.canSave=!1,this.selectedFields=[],this.treeWrap=u.TreeWrap.WrapAll,this.config=this.activeModalRef.getData()}isDirty(){return this.canSave}ngOnInit(){super.ngOnInit(),this.fieldLabelsMap=(0,m.transform)(this.config.fields,(e,t)=>{e[t.id]=t.name},{}),this.availableFieldTreeNodes=this.config.fields.map(e=>({data:e,label:e.name})).sort((e,t)=>e.label.localeCompare(t.label)),this.selectedFields=(0,m.map)(this.config.selectedFields,e=>{const t=this.config.fields.find(t=>t.id===Number(e.data.fieldId));return Object.assign(Object.assign({},e),{labelText:e.data.label,indexOrder:Number(e.data.index),descriptor:t,isOpen:e===this.config.fieldToEdit})}),this.refreshFieldDescriptorsList()}addField(e){this.canSave=!0,this.selectedFields.push({guid:this.rxGuidService.generate(),data:{fieldId:String(e.id),label:e.name,index:String(this.selectedFields.length)},descriptor:e,labelText:e.name,indexOrder:this.selectedFields.length,isOpen:!0}),this.refreshFieldDescriptorsList()}onSelectedFieldsListDrop(e){this.addField(e.item.data)}onSave(){const e=this.selectedFields.map(e=>({guid:e.guid,type:"rx-associated-record-field",data:{fieldId:e.data.fieldId,index:String(e.indexOrder),label:e.labelText}}));this.activeModalRef.close(e)}onRemove(e){this.canSave=!0,(0,m.pull)(this.selectedFields,e),this.refreshFieldDescriptorsList()}onMoveUp(e,t){this.canSave=!0;const i=this.selectedFields[t-1];i&&(i.indexOrder++,e.indexOrder--,this.sortFields())}onMoveDown(e,t){this.canSave=!0;const i=this.selectedFields[t+1];i&&(i.indexOrder--,e.indexOrder++,this.sortFields())}toggleOpen(e){this.selectedFields.forEach(t=>t.isOpen=e)}sortFields(){this.selectedFields=(0,m.sortBy)(this.selectedFields,e=>e.indexOrder)}refreshFieldDescriptorsList(){const e=this.selectedFields.map(e=>String(e.data.fieldId));this.filteredFieldDescriptors=this.config.fields.filter(t=>!(0,m.includes)(e,String(t.id))).sort((e,t)=>e.name.localeCompare(t.name))}cancel(){this.activeModalRef.dismiss(u.DismissReasons.CLOSE_BTN)}}yl.\u0275fac=function(e){return new(e||yl)(n["\u0275\u0275directiveInject"](v.RxStringService),n["\u0275\u0275directiveInject"](v.RxGuidService),n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](n.Injector))},yl.\u0275cmp=n["\u0275\u0275defineComponent"]({type:yl,selectors:[["rx-association-record-field-selector-editor-dialog"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:18,vars:14,consts:[[1,"designer-modal-body","modal-body","d-flex","mh-100"],[1,"row","flex-grow-1","w-100"],["class","col-4 border-right d-flex flex-column mh-100",4,"ngIf"],[1,"d-flex","align-items-start","justify-content-between"],[1,"mt-2"],["class","btn-group",4,"ngIf"],["id","selected-fields","cdkDropList","",1,"designer-modal-accordion-wrapper",3,"cdkDropListDropped"],[3,"multiselect"],["class","designer-modal-accordion-content","cdkDrag","","cdkDragLockAxis","y",3,"cdkDragDisabled",4,"ngFor","ngForOf"],["class","d-flex justify-content-center h-100 align-items-center mt-2",4,"ngIf"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click",4,"ngIf"],["adapt-button","","btn-type","secondary","type","button","rx-id","cancel-button",3,"click"],[1,"col-4","border-right","d-flex","flex-column","mh-100"],[1,"rx-card","card","flex-grow-1","mt-2"],[1,"card-block"],["cdkDropList","","cdkDropListSortingDisabled","",3,"cdkDropListConnectedTo",4,"ngIf","ngIfElse"],["adaptTreeEmptyStateTemplate",""],["cdkDropList","","cdkDropListSortingDisabled","",3,"cdkDropListConnectedTo"],["filter","true",3,"value","wrap"],["adaptTreeNodeTemplate",""],["class","rx-tree-draggable-node","cdkDrag","",3,"cdkDragData",4,"ngIf"],["cdkDrag","",1,"rx-tree-draggable-node",3,"cdkDragData"],[3,"dblclick"],["type","button",1,"rx-button-unstyled","d-icon-plus_circle",3,"click"],[1,"rx-tree-node-label","ml-3"],[1,"d-flex","justify-content-center","h-100","align-items-center","mt-2"],["label","No fields found","type","search",1,"w-100"],[1,"btn-group"],["adapt-button","","btn-type","tertiary","type","button","rx-id","expand-all-button",3,"click"],["adapt-button","","btn-type","tertiary","type","button","rx-id","collapse-all-button",3,"click"],["cdkDrag","","cdkDragLockAxis","y",1,"designer-modal-accordion-content",3,"cdkDragDisabled"],[1,"d-block",3,"isOpen","open","close"],[1,"card-title-text","w-100"],[1,"designer-modal-card-title-content"],[1,"left-header-block","pl-0"],["rx-id","card-title",1,"rx-ellipsis",3,"title"],["class","right-header-block",4,"ngIf"],["label","Label",1,"text-aria-resize",3,"ngModel","ngModelChange"],[1,"right-header-block"],[1,"designer-modal-card-title-index-buttons"],["type","button","rx-id","move-down-button",1,"d-icon-left-triangle_down","rx-button-unstyled",3,"disabled","click"],["type","button","rx-id","move-up-button",1,"d-icon-left-triangle_up","rx-button-unstyled",3,"disabled","click"],["adapt-button","","size","small","type","button","rx-id","remove-button",1,"d-icon-left-cross_adapt","p-1","pr-4","ml-3",3,"click"],["label","No fields selected","type","config",1,"w-100"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275template"](2,$e,9,2,"div",2),n["\u0275\u0275elementStart"](3,"div"),n["\u0275\u0275elementStart"](4,"div",3),n["\u0275\u0275elementStart"](5,"h4",4),n["\u0275\u0275text"](6,"Selected fileds"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](7,Le,7,6,"div",5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](8,"div",6),n["\u0275\u0275listener"]("cdkDropListDropped",function(e){return t.onSelectedFieldsListDrop(e)}),n["\u0275\u0275elementStart"](9,"adapt-accordion",7),n["\u0275\u0275template"](10,qe,9,6,"div",8),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](11,Ue,2,0,"div",9),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](12,"div",10),n["\u0275\u0275template"](13,ze,3,4,"button",11),n["\u0275\u0275elementStart"](14,"button",12),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](15),n["\u0275\u0275pipe"](16,"translate"),n["\u0275\u0275pipe"](17,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275classMapInterpolate1"]("d-flex flex-column mh-100 ",t.config.isReadOnly?"col":"col-8",""),n["\u0275\u0275advance"](4),n["\u0275\u0275property"]("ngIf",t.selectedFields.length),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("multiselect",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",t.selectedFields),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.selectedFields.length),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.config.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",t.config.isReadOnly?n["\u0275\u0275pipeBind1"](16,10,"com.bmc.arsys.rx.client.common.close.label"):n["\u0275\u0275pipeBind1"](17,12,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[f.NgIf,x.CdkDropList,u.AdaptAccordionComponent,f.NgForOf,u.AdaptButtonComponent,u.AdaptTreeComponent,u.AdaptTreeNodeTemplateDirective,x.CdkDrag,u.AdaptEmptyStateComponent,u.AdaptAccordionTabComponent,u.AdaptRxTextfieldComponent,b.NgControlStatus,b.NgModel],pipes:[p.TranslatePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.designer-modal-body[_ngcontent-%COMP%]{height:645px;min-height:calc(100% - 61px)!important}.designer-modal-accordion-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:auto;padding-top:10px}.designer-modal-accordion-content[_ngcontent-%COMP%]{position:relative}.designer-modal-accordion-content.cdk-drag-preview[_ngcontent-%COMP%]{z-index:1200!important}.designer-modal-drag-handle[_ngcontent-%COMP%]{cursor:move;position:absolute;top:0;left:0;height:46px;padding:14px 10px 14px 14px;z-index:1}.designer-modal-card-title-content[_ngcontent-%COMP%]{width:100%;display:flex}.designer-modal-card-title-content[_ngcontent-%COMP%]   .left-header-block[_ngcontent-%COMP%], .designer-modal-card-title-content[_ngcontent-%COMP%]   .right-header-block[_ngcontent-%COMP%]{display:flex;align-items:center}.designer-modal-card-title-content[_ngcontent-%COMP%]   .left-header-block[_ngcontent-%COMP%]{flex-grow:1;min-width:0;font-size:14px;padding-left:22px}.designer-modal-card-sub-title[_ngcontent-%COMP%]{color:#7c7f81;font-weight:normal}.designer-modal-card-title-index-buttons[_ngcontent-%COMP%]{display:flex;font-size:19px}.rx-card[_ngcontent-%COMP%]{overflow:auto}.rx-tree-draggable-node[_ngcontent-%COMP%]{cursor:pointer}.rx-tree-draggable-node.cdk-drag-preview[_ngcontent-%COMP%]{z-index:1200!important}.rx-tree-draggable-node.cdk-drag[_ngcontent-%COMP%]{opacity:1}.rx-tree-node-label[_ngcontent-%COMP%]{word-break:break-all}rx-form-builder[_ngcontent-%COMP%]{max-width:400px}']});class xl extends l.ValueAccessor{constructor(e,t){super(),this.rxModalService=e,this.renderer=t,this.selectedFields=[]}focus(){this.renderer.selectRootElement(this.openModalButton.nativeElement,!0).click()}openFieldSelector(e){this.rxModalService.openModal({title:this.options.label,data:{fields:this.options.fields,selectedFields:this.value,fieldToEdit:e,isReadOnly:this.isDisabled},content:yl}).then(e=>{this.value=e}).catch(m.noop)}onSetValue(){this.updateSortedFieldList()}onWriteValue(e){this.updateSortedFieldList()}removeField(e){this.value=this.value.filter(t=>t.guid!==e)}editField(e){this.openFieldSelector(e)}updateSortedFieldList(){this.selectedFields=(0,m.sortBy)(this.value,e=>Number(e.data.index)).map(e=>Object.assign(Object.assign({},e),{label:this.options.fields.find(t=>t.id===Number(e.data.fieldId)).name}))}}xl.\u0275fac=function(e){return new(e||xl)(n["\u0275\u0275directiveInject"](S.RxModalService),n["\u0275\u0275directiveInject"](n.Renderer2))},xl.\u0275cmp=n["\u0275\u0275defineComponent"]({type:xl,selectors:[["rx-association-record-field-selector-form-control"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](K,7,n.ElementRef),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.openModalButton=e.first)}},inputs:{options:"options"},features:[n["\u0275\u0275ProvidersFeature"]([{provide:b.NG_VALUE_ACCESSOR,useExisting:xl,multi:!0}]),n["\u0275\u0275InheritDefinitionFeature"]],decls:5,vars:3,consts:[["adapt-button","","type","button","btn-type","tertiary",1,"px-0","py-0",3,"disabled","click"],["openModalButton",""],["name","plus_circle",1,"mr-1"],["class","list-unstyled mb-0 mt-2",4,"ngIf"],[1,"list-unstyled","mb-0","mt-2"],["class","border px-2 py-1 mb-1 d-flex align-items-center",4,"ngFor","ngForOf"],[1,"border","px-2","py-1","mb-1","d-flex","align-items-center"],[1,"mr-auto"],["adapt-button","","btn-type","tertiary","size","small","type","button",1,"d-icon-left-pencil","p-1",3,"disabled","click"],["adapt-button","","btn-type","tertiary","size","small","type","button",1,"d-icon-left-cross_adapt","p-1",3,"disabled","click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"button",0,1),n["\u0275\u0275listener"]("click",function(){return t.openFieldSelector()}),n["\u0275\u0275element"](2,"adapt-icon",2),n["\u0275\u0275text"](3),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](4,We,2,1,"ul",3)),2&e&&(n["\u0275\u0275property"]("disabled",t.isDisabled),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",t.options.label,"\n"),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.selectedFields.length>0))},directives:[u.AdaptButtonComponent,u.AdaptIconComponent,f.NgIf,f.NgForOf],encapsulation:2});class bl{}bl.\u0275fac=function(e){return new(e||bl)},bl.\u0275mod=n["\u0275\u0275defineNgModule"]({type:bl,declarations:[yl],imports:[f.CommonModule,u.AdaptRxSearchModule,u.AdaptButtonModule,u.AdaptAccordionModule,b.FormsModule,u.AdaptRxTextfieldModule,x.DragDropModule,u.AdaptTreeModule,u.AdaptEmptyStateModule,p.TranslateModule],exports:[yl]}),bl.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptRxSearchModule,u.AdaptButtonModule,u.AdaptAccordionModule,b.FormsModule,u.AdaptRxTextfieldModule,x.DragDropModule,u.AdaptTreeModule,u.AdaptEmptyStateModule,p.TranslateModule]]});class Cl{}Cl.\u0275fac=function(e){return new(e||Cl)},Cl.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Cl,declarations:[xl],imports:[f.CommonModule,b.FormsModule,u.AdaptButtonModule,u.AdaptIconModule,bl],exports:[xl]}),Cl.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.FormsModule,u.AdaptButtonModule,u.AdaptIconModule,bl]]});class Sl{constructor(e,t,i,n){this.rxRecordDefinitionCacheService=e,this.rxAssociationDefinitionDataPageService=t,this.rxGuidService=i,this.rxDefinitionNameService=n}getDropdownModeInspectorControls(e,t){return[{name:"fieldId",component:l.SelectFormControlComponent,options:{label:"Field to display",options:e?e.filter(e=>[a.RX_RECORD_DEFINITION.resourceTypes.character,a.RX_RECORD_DEFINITION.resourceTypes.localizedCharacter].includes(e.resourceType)).map(e=>({id:String(e.id),name:e.name})):[],emptyOption:!0,required:!0}},{name:"filterByAssociation",component:l.SelectFormControlComponent,options:{label:"Filter by association",options:t?t.map(e=>({id:e.name,name:this.rxDefinitionNameService.getDisplayName(e.name)})):[],emptyOption:!0}}]}getDisplayedFieldsControl(e){return{name:"displayedFields",component:xl,options:{label:"Show/Hide fields",fields:e,required:!0}}}getRecordIdControl(){return{name:"recordId",component:l.ExpressionInspectorControlComponent,options:{label:"Record ID",isRequired:!0}}}getUseDefaultRolesControl(){return{name:"useDefaultRoles",component:l.SwitchFormControlComponent,options:{label:"Use default roles"}}}getNodeABRoleControls(){return[{name:"nodeARole",component:l.ExpressionInspectorControlComponent,options:{label:"First record role"}},{name:"nodeBRole",component:l.ExpressionInspectorControlComponent,options:{label:"Second record role"}}]}getViewModeInspectorControls(){return[{name:"viewDefinitionNameForSelect",component:l.RxDefinitionPickerComponent,options:{label:"View for selecting associated records",definitionType:l.RxDefinitionPickerType.View,required:!0}},{name:"viewDefinitionNameForCreate",component:l.RxDefinitionPickerComponent,options:{label:"View for creating associated records",definitionType:l.RxDefinitionPickerType.View}}]}getInitialInspectorControls(e){return[{name:"label",component:l.TextFormControlComponent,options:{label:"Display label"}},(0,c.getDisabledFieldInspectorConfig)(),...(0,c.getStandardPropsInspectorConfigs)()]}getInitialProperties(){return Object.assign(Object.assign({associatedRecordNodeSide:"",associationDefinitionName:"",displayedFields:[],editingMode:ul.Views,fieldId:null,filterByAssociation:"",label:null,nodeARole:"",nodeBRole:"",recordDefinition:"",recordDefinitionName:"",recordId:"",recordInstance:"",useDefaultRoles:!0,viewDefinitionNameForCreate:"",viewDefinitionNameForSelect:""},d.RX_DISABLED_PROP_DEFAULT_VALUE),d.RX_STANDARD_PROPS_DEFAULT_VALUES)}getActionButtonDefinition(e,t,i){return{type:d.RxViewComponentType.ActionButton,guid:this.rxGuidService.generate(),propertiesByName:{labelKey:t===ml.actions.associate?"com.bmc.arsys.rx.client.view-components.record-editor.association.button.associate.label":"com.bmc.arsys.rx.client.view-components.record-editor.association.button.create-new.label",style:"secondary",action:t},children:[{guid:this.rxGuidService.generate(),type:d.RxViewComponentType.Action,propertiesByName:{name:"rxAvcAssociate",associationViewComponent:`\${view.components.${i}.api}`,viewDefinitionName:t===ml.actions.associate?e.viewDefinitionNameForSelect:e.viewDefinitionNameForCreate}}],insertIndex:t===ml.actions.associate?0:1}}isCardinalityOne(e,t){const i=t.find(t=>t.name===e.associationDefinitionName);return Boolean(i&&(i.cardinality===C.RX_ASSOCIATION_DEFINITION.cardinality.oneToOne.value||i.cardinality===C.RX_ASSOCIATION_DEFINITION.cardinality.oneToMany.value&&e.associatedRecordNodeSide===C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA.value))}getAvailableAssociations(e,t){const i={headers:{"default-bundle-scope":""},params:{firstRecordDefinitionName:e,secondRecordDefinitionName:t,requireDependent:!0}};return this.rxAssociationDefinitionDataPageService.get(i).pipe((0,r.map)(e=>e.data))}getRecordDefinition(e){return this.rxRecordDefinitionCacheService.getRecordDefinition(e)}getFieldsInChildComponentsWithNames(e,t){return e.reduce((e,i)=>{const n=t.find(e=>e.id===Number(i.data.fieldId));return e.push(Object.assign(Object.assign({},i),{data:Object.assign(Object.assign({},i.data),{name:n?n.name:i.data.label})})),e},[])}cleanEditingModeDependentData(e){e.editingMode===ul.Dropdown?(e.viewDefinitionNameForSelect=null,e.viewDefinitionNameForCreate=null,e.displayedFields=[]):(e.filterByAssociation=null,e.recordId=null,e.fieldId=null)}getNodeSideOptions(e){return e.nodeAId===e.nodeBId?[{id:C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA.value,name:e.nodeAName||C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA.defaultName},{id:C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.value,name:e.nodeBName||C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.defaultName}]:[]}resetRolesData(e){e.useDefaultRoles=!1,e.nodeARole=null,e.nodeBRole=null}validate(e,t,i,n){const o=[];return t.recordDefinitionName||o.push(e.createError("Record definition to associate cannot be blank.","recordDefinitionName")),t.recordDefinitionName&&!t.associationDefinitionName&&o.push(e.createError("Association to Use cannot be blank.","associationDefinitionName")),t.associationDefinitionName&&(i.nodeAId!==i.nodeBId||t.associatedRecordNodeSide||o.push(e.createError("Associated Record Node Side cannot be blank.","fieldId"))),t.editingMode!==ul.Views&&t.editingMode?t.editingMode===ul.Dropdown&&(t.filterByAssociation&&!n.recordId&&o.push(e.createError("Record ID cannot be blank.","recordId")),t.fieldId||o.push(e.createError("Field to display cannot be blank.","fieldId"))):(t.recordDefinitionName&&0===n.displayedFields.length&&o.push(e.createError("Preview Fields cannot be empty.","displayedFields")),t.viewDefinitionNameForSelect||o.push(e.createError("View for selecting associated records cannot be blank.","viewDefinitionNameForSelect"))),o.push(...(0,c.validateStandardProps)(t)),o}}Sl.\u0275fac=function(e){return new(e||Sl)(n["\u0275\u0275inject"](a.RxRecordDefinitionCacheService),n["\u0275\u0275inject"](C.RxAssociationDefinitionDataPageService),n["\u0275\u0275inject"](v.RxGuidService),n["\u0275\u0275inject"](s.RxDefinitionNameService))},Sl.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Sl,factory:Sl.\u0275fac});class wl extends c.ViewDesignerComponentModel{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.rxAssociationDefinitionCacheService=this.injector.get(C.RxAssociationDefinitionCacheService),this.rxGuidService=this.injector.get(v.RxGuidService),this.rxDefinitionNameService=this.injector.get(s.RxDefinitionNameService),this.associationDesignHelperService=this.injector.get(Sl),this.updateInspector$=new o.Subject,this.childComponents$=this.sandbox.getChildComponentsTree(),this.associationChildComponentsData$=this.getChildComponentsData(),this.associationDefinitions=[],this.associationDefinitionFilters=[],this.recordDefinitionFields=[],this.associatedRecordNodeSide=[],this.isManyToManyAssociation=!1,this.editingMode$=this.sandbox.getComponentPropertyValue("editingMode"),this.label$=this.sandbox.getComponentPropertyValue("label"),this.updateInspector$.pipe((0,r.distinctUntilChanged)(m.isEqual),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.updateInspectorConfig(e)});const i=t.getComponentPropertyValue("recordDefinitionName").pipe((0,r.switchMap)(e=>e?this.updateRecordDefinitionFields(e):(0,o.of)([])));this.displayedFields$=(0,o.combineLatest)([this.sandbox.getChildComponents(e=>e.type===ml.componentTypes.associatedRecordField),i]).pipe((0,r.map)(([e,t])=>this.associationDesignHelperService.getFieldsInChildComponentsWithNames(e,t))),this.recordEditorGuid$=this.sandbox.getParentComponentGuid(d.RxViewComponentType.RecordEditor).pipe((0,r.take)(1)),this.otherAssociationRecordEditorComponentGuids$=this.recordEditorGuid$.pipe((0,r.map)(e=>this.sandbox.getComponentModel(e)),(0,r.switchMap)(e=>e.associationComponentGuids$.pipe((0,r.map)(e=>e.filter(e=>e!==this.sandbox.guid)))),(0,r.shareReplay)(1),(0,r.takeUntil)(this.sandbox.destroyed$)),this.recordDefinitionNameFromHostRecordEditor$=this.recordEditorGuid$.pipe((0,r.switchMap)(e=>this.sandbox.getComponentPropertyValue("recordDefinitionName",e)),(0,r.shareReplay)(1)),this.recordDefinitionNameFromHostRecordEditor$.pipe((0,r.switchMap)(e=>e?(0,o.combineLatest)([this.sandbox.componentProperties$,this.associationChildComponentsData$]).pipe((0,r.switchMap)(([t,i])=>{const n=e?this.generateInitialUpdateParameters(t):[];return(n.length>0?(0,o.combineLatest)(n):(0,o.of)(null)).pipe((0,r.map)(()=>({componentProperties:Object.assign(Object.assign({},i),t),recordDefinitionRecordEditorName:e})))}),(0,r.take)(1)):(0,o.of)({componentProperties:null,recordDefinitionRecordEditorName:null})),(0,r.withLatestFrom)(this.recordEditorGuid$),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([{componentProperties:e,recordDefinitionRecordEditorName:t},i])=>{const n=this.associationDesignHelperService.getInitialProperties(),o=Object.assign(Object.assign(Object.assign({},n),e),{useDefaultRoles:Boolean("true"===(null==e?void 0:e.useDefaultRoles))});this.recordEditorGuid=i,this.sandbox.updateComponentProperties(o),this.updateInspector$.next(this.getInspectorConfig(o,t,i))});const n=this.childComponents$.pipe((0,r.map)(e=>e.map(e=>e.guid)));this.sandbox.getComponentPropertyValue("recordDefinitionName").pipe((0,r.skip)(1),(0,r.withLatestFrom)(n),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([e,t])=>{this.sandbox.updateComponentProperties({recordDefinitionName:e,label:null,associationDefinitionName:null,associatedRecordNodeSide:null,editingMode:ul.Views,viewDefinitionNameForSelect:null,viewDefinitionNameForCreate:null,fieldId:null,useDefaultRoles:!1,nodeARole:null,nodeBRole:null,displayedFields:[],filterByAssociation:null,recordId:null}),this.sandbox.removeComponents(t)}),this.sandbox.getComponentPropertyValue("recordDefinitionName").pipe((0,r.skip)(1),(0,r.concatMapTo)(this.sandbox.componentProperties$),(0,r.concatMap)(e=>(0,o.combineLatest)([this.updateAssociationDefinitionsOptions(e.recordDefinitionName),this.updateRecordDefinitionFields(e.recordDefinitionName),this.updateAssociationDefinitionsFilterOptions(e.recordDefinitionName),this.updateAssociationNodeSideOptions(e.associationDefinitionName),this.updatePreviousDropdownFieldDefinition(e.recordDefinitionName,e.fieldId)]).pipe((0,r.take)(1),(0,r.mapTo)(e))),(0,r.withLatestFrom)(this.recordDefinitionNameFromHostRecordEditor$,this.recordEditorGuid$),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([e,t,i])=>{this.updateInspector$.next(this.getInspectorConfig(e,t,i))}),this.sandbox.getComponentPropertyValue("editingMode").pipe((0,r.skip)(1),(0,r.withLatestFrom)(n),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([e,t])=>{this.sandbox.updateComponentProperties({editingMode:e,viewDefinitionNameForSelect:null,viewDefinitionNameForCreate:null,fieldId:null,useDefaultRoles:!1,nodeARole:null,nodeBRole:null,displayedFields:[],filterByAssociation:null,recordId:null}),this.sandbox.removeComponents(t)}),this.sandbox.componentProperties$.pipe((0,r.skip)(1),(0,r.pairwise)(),(0,r.withLatestFrom)(this.childComponents$),(0,r.switchMap)(([[e,t],i])=>{const n=Object.assign({},t),a=[];switch(!0){case e.viewDefinitionNameForSelect!==t.viewDefinitionNameForSelect:this.updateChildActionButtonDefinition(t,i,ml.actions.associate);break;case e.viewDefinitionNameForCreate!==t.viewDefinitionNameForCreate:this.updateChildActionButtonDefinition(t,i,ml.actions.createAndAssociate);break;case e.filterByAssociation!==t.filterByAssociation:case e.recordId!==t.recordId:const o=i.find(e=>e.type===ml.componentTypes.associationFilter);this.updateAssociationFilterComponent(t,o);break;case!(0,m.isEqual)(e.displayedFields,t.displayedFields):this.updateComponentRecordFields(t.displayedFields,i);break;case e.associationDefinitionName!==t.associationDefinitionName:n.editingMode=ul.Views,this.associationDesignHelperService.cleanEditingModeDependentData(n),t.associationDefinitionName?a.push(this.rxAssociationDefinitionCacheService.getAssociationDefinition(t.associationDefinitionName).pipe((0,r.map)(e=>{n.associatedRecordNodeSide=e.nodeAId===t.recordDefinitionName?C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA.value:C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.value,this.setIsManyToManyAssociation(e),this.sandbox.updateComponentProperties(n),this.isManyToManyAssociation&&this.associationDesignHelperService.resetRolesData(n)}))):this.isManyToManyAssociation=!1,a.push(this.updateAssociationNodeSideOptions(t.associationDefinitionName));break;case e.associatedRecordNodeSide!==t.associatedRecordNodeSide:n.editingMode=ul.Views,this.associationDesignHelperService.cleanEditingModeDependentData(n);break;case e.useDefaultRoles!==t.useDefaultRoles:!0===t.useDefaultRoles&&(n.nodeARole=null,n.nodeBRole=null);break;case e.nodeARole!==t.nodeARole||e.nodeBRole!==t.nodeBRole:(0,m.isUndefined)(t.useDefaultRoles)?(0,m.defaults)(n,{nodeARole:null,nodeBRole:null,useDefaultRoles:!1}):n.useDefaultRoles=!1}return(a.length>0?(0,o.combineLatest)(a):(0,o.of)(null)).pipe((0,r.map)(e=>({parameters:e,componentProperties:n})),(0,r.withLatestFrom)(this.recordDefinitionNameFromHostRecordEditor$,this.recordEditorGuid$))}),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([{parameters:e,componentProperties:t},i,n])=>{const o=this.associationDesignHelperService.getInitialProperties();this.recordEditorGuid=n,this.updateInspector$.next(this.getInspectorConfig(Object.assign(Object.assign({},o),t),i,n))}),this.sandbox.getComponentPropertyValue("fieldId").pipe((0,r.map)(e=>(0,m.isNil)(e)?null:e),(0,r.distinctUntilChanged)(),(0,r.pairwise)()).pipe((0,r.withLatestFrom)(this.sandbox.componentProperties$),(0,r.filter)(([e,t])=>Boolean(t.editingMode===ul.Dropdown)),(0,r.switchMap)(([[e,t],i])=>this.associationDesignHelperService.getRecordDefinition(i.recordDefinitionName).pipe((0,r.map)(n=>{var o,r;const a=null===(o=n.fieldDefinitions.find(t=>t.id===Number(e)))||void 0===o?void 0:o.name,s=null===(r=n.fieldDefinitions.find(e=>e.id===Number(t)))||void 0===r?void 0:r.name;return i.label&&a!==i.label?i.label:s}))),(0,r.distinctUntilChanged)(),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.updateComponentProperties({label:e})}),(0,o.combineLatest)([this.sandbox.componentProperties$,this.associationChildComponentsData$.pipe((0,r.distinctUntilChanged)(m.isEqual))]).pipe((0,r.switchMap)(([e,t])=>(e.associationDefinitionName?this.rxAssociationDefinitionCacheService.getAssociationDefinition(e.associationDefinitionName):(0,o.of)({})).pipe((0,r.map)(i=>this.associationDesignHelperService.validate(this.sandbox,e,i,t)))),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.setValidationIssues(e)}),(0,o.combineLatest)([this.label$,this.sandbox.getComponentPropertyValue("associationDefinitionName").pipe((0,r.map)(e=>e?this.rxDefinitionNameService.getDisplayName(e):null))]).pipe((0,r.map)(([e,t])=>{let i=this.sandbox.descriptor.name;return t&&e?i+=` (${t}: ${e})`:(t||e)&&(i+=` (${t||e})`),i}),(0,r.distinctUntilChanged)(),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.setSettablePropertiesDataDictionary(e,[{label:"Disabled",expression:this.getExpressionForProperty("disabled")},{label:"Hidden",expression:this.getExpressionForProperty("hidden")}])})}static getInitialProperties(e){return Object.assign(Object.assign({},d.RX_AVAILABLE_ON_DEVICES_DEFAULT_VALUE),e)}getPropertiesByName(e){return(0,m.omit)(Object.assign(Object.assign({},e),{recordInstance:this.recordEditorGuid?`\${view.components.${this.recordEditorGuid}.recordInstance}`:e.recordInstance,recordDefinition:this.recordEditorGuid?`\${view.components.${this.recordEditorGuid}.recordDefinition}`:e.recordDefinition}),["displayedFields","filterByAssociation","recordId","viewDefinitionNameForSelect","viewDefinitionNameForCreate"])}updateAssociationFilterComponent(e,t){if(t&&this.sandbox.removeComponents([t.guid]),e.filterByAssociation){const t={guid:this.rxGuidService.generate(),type:ml.componentTypes.associationFilter,propertiesByName:{associationDefinitionName:e.filterByAssociation,recordInstanceId:e.recordId}};this.sandbox.addComponent([t])}}updateChildActionButtonDefinition(e,t,i){const n=t.find(e=>e.type===d.RxViewComponentType.ActionButton&&e.data.action===i),o=i===ml.actions.createAndAssociate?e.viewDefinitionNameForCreate:e.viewDefinitionNameForSelect;if(n&&this.sandbox.removeComponents([n.guid]),o){const t=this.associationDesignHelperService.getActionButtonDefinition(e,i,this.sandbox.guid);this.sandbox.addComponent([t])}}updateComponentRecordFields(e,t){const i=t.filter(e=>e.type===ml.componentTypes.associatedRecordField).map(e=>e.guid),n=e.map(e=>({type:ml.componentTypes.associatedRecordField,guid:this.rxGuidService.generate(),propertiesByName:{fieldId:e.data.fieldId,label:e.data.label||"",index:e.data.index}}));i.length>0&&this.sandbox.removeComponents(i),this.sandbox.addComponent(n)}getChildComponentsData(){return this.childComponents$.pipe((0,r.map)(e=>{var t,i;const n={},o=e.filter(e=>e.type===ml.componentTypes.associationFilter);n.displayedFields=e.filter(e=>e.type===ml.componentTypes.associatedRecordField),o.length>0&&(n.recordId=null===(t=o[0].data)||void 0===t?void 0:t.recordInstanceId,n.filterByAssociation=null===(i=o[0].data)||void 0===i?void 0:i.associationDefinitionName);const r=this.getViewDefinitionNameForAssociation(e,ml.actions.createAndAssociate);r&&(n.viewDefinitionNameForCreate=r);const a=this.getViewDefinitionNameForAssociation(e,ml.actions.associate);return a&&(n.viewDefinitionNameForSelect=a),n}))}generateInitialUpdateParameters(e){const t=[];return e.recordDefinitionName&&(t.push(this.updateRecordDefinitionFields(e.recordDefinitionName)),e.fieldId&&t.push(this.updatePreviousDropdownFieldDefinition(e.recordDefinitionName,e.fieldId)),t.push(this.updateAssociationDefinitionsOptions(e.recordDefinitionName))),e.associationDefinitionName&&(t.push(this.updateAssociationDefinitionsFilterOptions(e.recordDefinitionName)),t.push(this.rxAssociationDefinitionCacheService.getAssociationDefinition(e.associationDefinitionName).pipe((0,r.map)(e=>this.setIsManyToManyAssociation(e))))),e.associatedRecordNodeSide&&t.push(this.updateAssociationNodeSideOptions(e.associationDefinitionName)),t}updatePreviousDropdownFieldDefinition(e,t){return this.updateRecordDefinitionFields(e).pipe((0,r.map)(e=>this.previousDropdownFieldDefinition=e.find(e=>e.id===Number(t))))}setIsManyToManyAssociation(e){e&&(this.isManyToManyAssociation=e.cardinality===C.RX_ASSOCIATION_DEFINITION.cardinality.manyToMany.value)}getViewDefinitionNameForAssociation(e,t){const i=e.find(e=>{var i;return(null===(i=e.data)||void 0===i?void 0:i.action)===t});return i&&i.children?this.getViewDefinitionNameFromActionButton(i):null}getViewDefinitionNameFromActionButton(e){const t=e.children.find(e=>e.type===d.RxViewComponentType.Action);return(0,m.get)(t,"data.viewDefinitionName",null)}updateRecordDefinitionFields(e){return(e?this.associationDesignHelperService.getRecordDefinition(e).pipe((0,r.map)(e=>e.fieldDefinitions)):(0,o.of)([])).pipe((0,r.tap)(e=>this.recordDefinitionFields=e))}updateAssociationNodeSideOptions(e){return(e?this.rxAssociationDefinitionCacheService.getAssociationDefinition(e).pipe((0,r.map)(e=>this.associationDesignHelperService.getNodeSideOptions(e))):(0,o.of)([])).pipe((0,r.tap)(e=>this.associatedRecordNodeSide=e))}updateAssociationDefinitionsOptions(e){return this.recordDefinitionNameFromHostRecordEditor$.pipe((0,r.switchMap)(t=>e&&t?this.associationDesignHelperService.getAvailableAssociations(e,t):(0,o.of)([])),(0,r.tap)(e=>this.associationDefinitions=e))}updateAssociationDefinitionsFilterOptions(e){return this.otherAssociationRecordEditorComponentGuids$.pipe((0,r.mergeMap)(e=>e.length?(0,o.combineLatest)(e.map(e=>this.sandbox.getComponentPropertyValue("recordDefinitionName",e))).pipe((0,r.take)(1)):(0,o.of)([])),(0,r.switchMap)(t=>t.length&&e?(0,o.merge)(...t.map(t=>this.associationDesignHelperService.getAvailableAssociations(e,t))):(0,o.of)([])),(0,r.map)(e=>this.associationDefinitionFilters=e))}getInspectorConfig(e,t,i){const n={inspectorSectionConfigs:[{label:"General",controls:[]}]};if(t){const t=n.inspectorSectionConfigs[0].controls;t.push({name:"recordDefinitionName",component:l.RxDefinitionPickerComponent,options:{label:"Record definition to associate",definitionType:l.RxDefinitionPickerType.StandardDataRecord,required:!0}}),e.recordDefinitionName&&t.push({name:"associationDefinitionName",component:l.SelectFormControlComponent,options:{label:"Association to use",options:this.associationDefinitions.map(e=>({id:e.name,name:this.rxDefinitionNameService.getDisplayName(e.name)})),emptyOption:!0,required:!0}}),e.recordDefinitionName&&this.associatedRecordNodeSide.length>0&&t.push({name:"associatedRecordNodeSide",component:l.SelectFormControlComponent,options:{label:"Associated record node Side",options:this.associatedRecordNodeSide,required:!0}}),e.recordDefinitionName&&this.associationDesignHelperService.isCardinalityOne(e,this.associationDefinitions)&&t.push({name:"editingMode",component:l.SelectFormControlComponent,options:{label:"Association editing mode",options:(0,m.map)(ul,(e,t)=>({id:e,name:t})),required:!0}}),e.editingMode&&e.editingMode!==ul.Views||(t.push(...this.associationDesignHelperService.getViewModeInspectorControls()),this.isManyToManyAssociation&&e.associationDefinitionName&&(t.push(this.associationDesignHelperService.getUseDefaultRolesControl()),e.useDefaultRoles||t.push(...this.associationDesignHelperService.getNodeABRoleControls())),e.recordDefinitionName&&t.push(this.associationDesignHelperService.getDisplayedFieldsControl(this.recordDefinitionFields))),e.editingMode===ul.Dropdown&&(t.push(...this.associationDesignHelperService.getDropdownModeInspectorControls(this.recordDefinitionFields,this.associationDefinitionFilters)),e.filterByAssociation&&t.push(this.associationDesignHelperService.getRecordIdControl())),t.push(...this.associationDesignHelperService.getInitialInspectorControls(this.expressionConfigurator))}else n.inspectorSectionConfigs[0].controls=[{component:l.ValidationFormControlComponent,options:{text:"You must select a Record definition before editing field component.",componentGuid:i,propertyName:"recordDefinitionName"}}];return n}}class Dl{}Dl.\u0275fac=function(e){return new(e||Dl)},Dl.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Dl,selectors:[["rx-association-design-item-container"]],inputs:{outlet:"outlet",isReadOnly:"isReadOnly",layout:"layout"},decls:1,vars:1,consts:[["class","mr-1",3,"interactive","layout","isReadOnly",4,"ngFor","ngForOf"],[1,"mr-1",3,"interactive","layout","isReadOnly"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,He,1,3,"rx-canvas-item",0),2&e&&n["\u0275\u0275property"]("ngForOf",t.outlet.columns[0].children)},directives:[f.NgForOf,c.CanvasItemComponent],styles:["[_nghost-%COMP%]{display:flex}"]});class Rl{constructor(){this.hidePlaceholder=!1,this.destroyed$=new o.ReplaySubject(1),this.containerComponent=Dl}ngOnInit(){this.model.displayedFields$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.hidePlaceholder=e.length>0})}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}}Rl.\u0275fac=function(e){return new(e||Rl)},Rl.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Rl,selectors:[["rx-association-field-design"]],inputs:{model:"model"},decls:4,vars:5,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"d-block","form-control-label"],[1,"d-flex","flex-wrap"],[1,"flex-grow-1",3,"containerComponent"],["adapt-button","","size","small","btn-type","tertiary","type","button",1,"btn","btn-link","py-0","align-right",3,"hidden"],["type","objects","label","Add fields in the Properties panel.",3,"hidden"],[1,"form-group","mt-2",3,"hidden"],[1,"list-group"],[1,"list-group-item"],[1,"rx-record-preview-card","w-100"],["adapt-button","","size","small","btn-type","tertiary","type","button",1,"btn","btn-link","float-right","d-icon-cross","p-0"],[1,"list-unstyled","mb-0"],["class","rx-record-preview-card__field",4,"ngFor","ngForOf"],[1,"rx-record-preview-card__field"],["class","rx-record-preview-card__label",4,"ngIf"],[4,"ngIf"],[1,"rx-record-preview-card__value"],[1,"rx-record-preview-card__label"],["ngModel","",3,"label","disabled"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275template"](2,Ye,19,16,"div",1),n["\u0275\u0275template"](3,Ze,5,7,"div",1),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("ngSwitch",n["\u0275\u0275pipeBind1"](1,3,t.model.editingMode$)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngSwitchCase","views"),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngSwitchCase","dropdown"))},directives:[f.NgSwitch,f.NgSwitchCase,c.CanvasOutletComponent,u.AdaptButtonComponent,u.AdaptEmptyStateComponent,f.NgForOf,f.NgIf,u.AdaptRxSelectComponent,b.NgControlStatus,b.NgModel],pipes:[f.AsyncPipe,p.TranslatePipe],encapsulation:2});class Il{adaptDefinition(e){var t,i,n,o,r;if(!e.layout){const t=e.componentDefinitions.filter(e=>e.type===d.RxViewComponentType.ActionButton).map(e=>e.guid);e.layout=JSON.stringify({outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName,columns:[{children:t}]}]})}const a={editingMode:null!==(t=e.propertiesByName.editingMode)&&void 0!==t?t:ul.Views,nodeARole:null!==(i=e.propertiesByName.nodeARole)&&void 0!==i?i:null,nodeBRole:null!==(n=e.propertiesByName.nodeBRole)&&void 0!==n?n:null,styles:null!==(o=e.propertiesByName.styles)&&void 0!==o?o:null,useDefaultRoles:null!==(r=e.propertiesByName.useDefaultRoles)&&void 0!==r&&r};Object.assign(e.propertiesByName,a)}}Il.\u0275fac=function(e){return new(e||Il)},Il.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Il,factory:Il.\u0275fac});class Fl{constructor(e,t){t.registerDesignAdapter(d.RxViewComponentType.Association,e)}}Fl.\u0275fac=function(e){return new(e||Fl)(n["\u0275\u0275inject"](Il),n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService))},Fl.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Fl,declarations:[Rl,Dl],imports:[f.CommonModule,u.AdaptButtonModule,p.TranslateModule,Cl,u.AdaptRxSelectModule,b.FormsModule,u.AdaptEmptyStateModule,c.ViewDesignerCanvasModule]}),Fl.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[Sl,Il],imports:[[f.CommonModule,u.AdaptButtonModule,p.TranslateModule,Cl,u.AdaptRxSelectModule,b.FormsModule,u.AdaptEmptyStateModule,c.ViewDesignerCanvasModule]]});const El=["api","disabled","recordDefinition","recordInstance","hidden","inReadState","value"].map(e=>{const t={name:e,enableExpressionEvaluation:!0};return["hidden","disabled"].includes(e)&&(t.type=d.ViewComponentPropertyType.Boolean),t});El.push({name:"label",localizable:!0},{name:"fieldId"},d.RX_AVAILABLE_ON_DEVICES_PROP_DESC);const Ml="Record editor inputs";class Al extends c.RxViewComponentExpressionConfigurator{constructor(e,t,i){super(e,t,i),this.injector=e,this.componentGuid=t,this.componentModel=i,this.rxDefinitionNameService=this.injector.get(s.RxDefinitionNameService),this.configureForProperty({propertyPath:"recordId",dataDictionary$:i.recordEditorGuid$.pipe((0,r.concatMap)(e=>this.getCommonDataDictionary(this.getRecordEditorBranch(e),e)))})}getRecordEditorBranch(e){const t=this.componentModel.otherAssociationRecordEditorComponentGuids$.pipe((0,r.switchMap)(e=>e.length?(0,o.combineLatest)(e.map(e=>this.componentModel.sandbox.getComponentPropertyValue("associationDefinitionName",e).pipe((0,r.map)(t=>({label:this.rxDefinitionNameService.getDisplayName(t),children:[{label:"First associated record",children:[{label:"ID",expression:`\${view.components.${e}.firstAssociatedRecord.id}`}]}]}))))).pipe((0,r.map)(e=>({label:"Associations",children:e}))):(0,o.of)(null)));return this.getComponentCommonDataDictionary(e).pipe((0,r.switchMap)(e=>t.pipe((0,r.map)(t=>t?Object.assign(Object.assign({},e),{children:[t,...e.children]}):e))))}}class Ol{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.Association,isContainerComponent:!0,designComponentModel:wl,bundleId:s.RX_APPLICATION.platformBundleId,designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Rl),expressionConfigurator:Al,componentFactory:this.componentFactoryResolver.resolveComponentFactory(hl),canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),options:{canBeEmbeddedInRecordEditor:!0},name:"Association",group:Ml,icon:"arrow_schema",properties:El.concat({name:"recordInstance",enableExpressionEvaluation:!0}),outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName}]},{type:ml.componentTypes.associationFilter,configPropertyName:"associationFilter",properties:[{name:"associationDefinitionName"},{name:"recordInstanceId",enableExpressionEvaluation:!0}],isDataComponent:!0},{type:ml.componentTypes.associatedRecordField,configPropertyName:"associatedRecordField",isDataComponent:!0,properties:[{name:"label",localizable:!0}]})}}Ol.\u0275fac=function(e){return new(e||Ol)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Ol.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ol,imports:[vl,Fl]}),Ol.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[vl,Fl]]});class Pl extends c.ViewDesignerComponentModel{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.rxRecordDefinitionCacheService=this.injector.get(a.RxRecordDefinitionCacheService),this.rxDefinitionNameService=this.injector.get(s.RxDefinitionNameService),this.rxFieldDefinitionService=this.injector.get(a.RxFieldDefinitionService)}static getInitialProperties(e){return Object.assign(Object.assign(Object.assign({fieldId:null,label:null,value:null},d.RX_DISABLED_PROP_DEFAULT_VALUE),d.RX_STANDARD_PROPS_DEFAULT_VALUES),e)}rxInit(){this.pipeline()}pipeline(){this.parentGuid$=this.sandbox.getParentComponentGuid(d.RxViewComponentType.RecordEditor).pipe((0,r.take)(1)),this.recordEditorMode$=this.parentGuid$.pipe((0,r.switchMap)(e=>this.sandbox.getComponentPropertyValue("mode",e))),this.recordDefinitionName$=this.parentGuid$.pipe((0,r.switchMap)(e=>this.sandbox.getComponentPropertyValue("recordDefinitionName",e)),(0,r.shareReplay)(1)),this.recordDefinition$=this.recordDefinitionName$.pipe((0,r.switchMap)(e=>e?this.rxRecordDefinitionCacheService.getRecordDefinition(e).pipe((0,r.catchError)(e=>o.EMPTY)):(0,o.of)(null)),(0,r.distinctUntilChanged)()),this.selectedFieldDefinition$=this.sandbox.getComponentPropertyValue("fieldId").pipe((0,r.switchMap)(e=>this.recordDefinition$.pipe((0,r.map)(t=>t&&e&&t.fieldDefinitions.find(t=>t.id===Number(e))||null))),(0,r.shareReplay)(1)),this.isRequired$=this.selectedFieldDefinition$.pipe((0,r.map)(e=>e&&e.fieldOption===a.RX_RECORD_DEFINITION.fieldOptions.required)),this.isSystemField$=this.selectedFieldDefinition$.pipe((0,r.startWith)(!1),(0,r.map)(e=>this.rxFieldDefinitionService.isSystemField(e))),this.selectedFieldDefinition$.pipe((0,r.pairwise)(),(0,r.withLatestFrom)(this.sandbox.componentProperties$),(0,r.filter)(([[e,t],i])=>t&&(e&&e.name===i.label||!i.label)),(0,r.map)(([[e,t]])=>t.name)).subscribe(e=>{this.sandbox.updateComponentProperties({label:e})}),this.availableFieldDefinitions$=(0,o.combineLatest)([this.recordDefinition$,this.recordEditorMode$]).pipe((0,r.map)(([e,t])=>e&&e.fieldDefinitions?e.fieldDefinitions.filter(e=>(0,m.includes)(this.fieldResourceTypes,e.resourceType)).filter(e=>{const i=this.rxFieldDefinitionService.isSystemField(e);return!i||i&&t===zs.Edit}):[]),(0,r.shareReplay)(1)),this.label$=this.sandbox.componentProperties$.pipe((0,r.map)(e=>e&&e.fieldId?e.label:"<No field selected>")),this.sandbox.componentProperties$.pipe((0,r.mergeMap)(e=>this.validate(e)),(0,r.distinctUntilChanged)(m.isEqual)).subscribe(e=>{this.sandbox.setValidationIssues(e)}),this.availableFieldDefinitions$.pipe((0,r.switchMap)(()=>this.getInspectorConfig())).subscribe(e=>{this.sandbox.updateInspectorConfig(e)}),this.sandbox.componentProperties$.pipe((0,r.switchMap)(()=>this.getBreadcrumb()),(0,r.distinctUntilChanged)()).subscribe(e=>{this.sandbox.setBreadcrumbs(e)}),(0,o.combineLatest)([this.sandbox.getComponentPropertyValue("label"),this.selectedFieldDefinition$]).pipe((0,r.map)(([e,t])=>e||(t?`[${t.name}]`:`[${this.sandbox.descriptor.name}]`)),(0,r.distinctUntilChanged)()).subscribe(e=>{this.sandbox.setSettablePropertiesDataDictionary(e,this.getSettableProperties())})}getPropertiesByName(e){const t=Object.assign({},e);return t.styles||delete t.styles,t}validate(e){const t=[];return(0,m.isEmpty)(e.fieldId)&&t.push(this.sandbox.createError("Field name cannot be blank.","fieldId")),t.push(...(0,c.validateStandardProps)(e)),(0,o.of)(t)}getBreadcrumb(){return(0,o.of)(null).pipe((0,r.withLatestFrom)(this.sandbox.componentProperties$),(0,r.map)(([e,t])=>t.label))}getInspectorConfig(){return(0,o.of)(null).pipe((0,r.withLatestFrom)(this.availableFieldDefinitions$,this.recordDefinitionName$,this.parentGuid$,this.isSystemField$),(0,r.map)(([e,t,i,n,o])=>this.getBaseInspectorConfig(t,i,n,o)))}getSettableProperties(){return[...(0,m.find)(this.sandbox.descriptor.properties,{name:"disabled"})?[{label:"Disabled",expression:`\${view.components.${this.sandbox.guid}.disabled}`}]:[],...(0,m.find)(this.sandbox.descriptor.properties,{name:"disabled"})?[{label:"Hidden",expression:`\${view.components.${this.sandbox.guid}.hidden}`}]:[]]}getBaseInspectorFields(e,t){return[].concat([{name:"fieldId",component:l.SelectFormControlComponent,options:{label:"Field name",required:!0,options:e.map(e=>({name:e.name,id:String(e.id)}))}},{name:"label",component:l.TextFormControlComponent,options:{label:"Display label"}}],t?[]:[{name:"value",component:l.ExpressionInspectorControlComponent,options:{label:"Value"}},(0,c.getDisabledFieldInspectorConfig)()],(0,c.getStandardPropsInspectorConfigs)())}getBaseInspectorConfig(e,t,i,n){const o=this.rxDefinitionNameService.getDisplayName(t||"");let r;return r=t?e.length?this.getBaseInspectorFields(e,n):[{component:l.ValidationFormControlComponent,options:{text:`${o} does not have fields that can be bound to this field type.`,componentGuid:i,propertyName:"recordDefinitionName"}}]:[{component:l.ValidationFormControlComponent,options:{text:"You must select a Record definition before editing field component.",componentGuid:i,propertyName:"recordDefinitionName"}}],{inspectorSectionConfigs:[{label:"General",controls:r}]}}}class Tl extends Pl{constructor(){super(...arguments),this.fieldResourceTypes=[a.RX_RECORD_DEFINITION.resourceTypes.attachment]}static getInitialProperties(e){const t=Pl.getInitialProperties(e);return delete t.value,t}getInspectorConfig(){return super.getInspectorConfig().pipe((0,r.map)(e=>(e.inspectorSectionConfigs[0].controls=e.inspectorSectionConfigs[0].controls.filter(e=>"value"!==e.name),e)))}}class Vl{}Vl.\u0275fac=function(e){return new(e||Vl)},Vl.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Vl,selectors:[["rx-attachment-field-design"]],inputs:{model:"model"},decls:3,vars:9,consts:[[1,"rx-pointer-events-none",3,"required","ngModel","disabled","label"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-rx-uploader",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275pipe"](2,"async")),2&e&&n["\u0275\u0275property"]("required",n["\u0275\u0275pipeBind1"](1,4,t.model.isRequired$))("ngModel",n["\u0275\u0275pureFunction0"](8,et))("disabled",!0)("label",n["\u0275\u0275pipeBind1"](2,6,t.model.label$))},directives:[u.AdaptRxUploaderComponent,b.RequiredValidator,b.NgControlStatus,b.NgModel],pipes:[f.AsyncPipe],styles:["adapt-rx-uploader[_ngcontent-%COMP%]     .adapt-rx-uploader__restrict{display:none}"]});class Nl{}Nl.\u0275fac=function(e){return new(e||Nl)},Nl.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Nl,declarations:[Vl],imports:[f.CommonModule,b.FormsModule,u.AdaptRxUploaderModule]}),Nl.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.FormsModule,u.AdaptRxUploaderModule]]});class kl extends h.BaseViewComponent{constructor(e){super(),this.injector=e,this.isRequired=!1,this.isDisabled=!1,this.translateService=this.injector.get(p.TranslateService),this.api={setProperty:this.setProperty.bind(this)},this.inReadState=!1,this.isLoading=!0,this.validationErrorMessage=null}ngOnInit(){super.ngOnInit(),this.notifyPropertyChanged("api",this.api),this.configReady$=this.config.pipe((0,r.filter)(e=>Boolean(e.api&&e.recordDefinition)),(0,r.takeUntil)(this.destroyed$)),this.recordInstance$=this.configReady$.pipe((0,r.pluck)("recordInstance"),(0,r.distinctUntilChanged)(),(0,r.skip)(1),(0,r.takeUntil)(this.destroyed$)),this.recordInstance$.subscribe(this.subscribeOnConfigValueChange.bind(this)),this.configReady$.pipe((0,r.take)(1)).subscribe(e=>{this.isLoading=!1,this.onConfigInitialized(e),this.onConfigUpdated(e)}),this.configReady$.pipe((0,r.skip)(1),(0,r.filter)(e=>Boolean(e.recordInstance)),(0,r.takeUntil)(this.destroyed$)).subscribe(this.onConfigUpdated.bind(this))}setFieldValue(e,t={}){(0,m.isEqual)(e,this.formControl.value)||(!1!==t.markAsDirty&&this.formControl.markAsDirty(),!1!==t.markAsTouched&&this.formControl.markAsTouched(),this.formControl.setValue(e))}getFieldValue(){var e;return null===(e=this.formControl)||void 0===e?void 0:e.value}getDisplayValue(){return this.getFieldValue()}onConfigInitialized(e){this.fieldId=Number(e.fieldId),this.fieldDefinition=(0,m.find)(e.recordDefinition.fieldDefinitions,{id:this.fieldId}),this.isRequired=this.fieldDefinition.fieldOption===a.RX_RECORD_DEFINITION.fieldOptions.required,this.recordEditorApi=e.api,this.formControl=this.recordEditorApi.getFieldControl(this.fieldId,this.guid,this.getFieldValidators(),e.associatedRecordPath),this.associatedRecordPath=e.associatedRecordPath,this.permissionType=this.recordEditorApi.getPermissionType(this.fieldId,this.associatedRecordPath),this.subscribeOnConfigValueChange(),this.formControl.valueChanges.pipe((0,r.startWith)(this.formControl.value),(0,r.takeUntil)(this.destroyed$)).subscribe(()=>{this.checkValidation(),this.updateValidationMessage()}),this.isAlwaysDisabled=this.permissionType===a.RX_RECORD_DEFINITION.fieldPermissionTypes.view||this.injector.get(a.RxFieldDefinitionService).isSystemField(this.fieldDefinition),this.isAlwaysHidden=!this.permissionType;const t=e.api.getRecordEditorMode();if(Number(e.fieldId)===a.RX_RECORD_DEFINITION.coreFieldIds.createdBy){const e=this.injector.get(s.RxSystemConfigurationService).getConfigurationSync("Submitter-Mode");this.isAlwaysDisabled=this.isAlwaysDisabled||t===zs.Edit&&e===s.RX_ADMINISTRATION.submitterModes.locked}}onConfigUpdated(e){const t=this.isAlwaysDisabled||Boolean(e.disabled);this.isDisabled!==t&&(this.isDisabled=t,this.isDisabled||this.formControl.updateValueAndValidity(),this.checkValidation()),this.isHidden=this.isAlwaysHidden||Boolean(e.hidden),this.label=(0,m.isUndefined)(e.label)?this.fieldDefinition.name:e.label,this.inReadState=Boolean(e.inReadState)}getFieldValidators(){return[]}getRequiredFieldValidationError(){return this.translateService.instant("com.bmc.arsys.rx.client.view-components.validation.required.message")}getFieldInstanceProp(e,t=this.fieldId,i=this.associatedRecordPath){return this.recordEditorApi.getFieldInstanceProp(t,e,i)}setFieldInstanceProp(e,t,i=this.fieldId,n=this.associatedRecordPath){this.recordEditorApi.setFieldInstanceProp(i,e,t,n)}setProperty(e,t){if(!(0,m.includes)(["hidden","disabled"],e))return(0,o.throwError)(`Field property ${e} is not settable.`);this.notifyPropertyChanged(e,t)}subscribeOnConfigValueChange(){const e=this.configReady$.pipe((0,r.pluck)("value"),(0,r.filter)(e=>!(0,m.isUndefined)(e)),(0,r.distinctUntilChanged)(),(0,r.takeUntil)(this.recordInstance$),(0,r.takeUntil)(this.destroyed$));e.pipe((0,r.take)(1)).subscribe(e=>{(0,m.isNull)(e)||this.setFieldValue(e,{markAsTouched:!1,markAsDirty:!1})}),e.pipe((0,r.skip)(1)).subscribe(e=>this.setFieldValue(e))}checkValidation(){this.isDisabled&&this.formControl.invalid&&(this.formControl.setErrors(null),this.updateValidationMessage())}updateValidationMessage(){this.formControl.errors?(this.formControl.errors.required&&(this.formControl.errors.required=this.getRequiredFieldValidationError()),this.validationErrorMessage=(0,m.values)(this.formControl.errors).join(", ")):this.validationErrorMessage=null}}kl.\u0275fac=function(e){return new(e||kl)(n["\u0275\u0275directiveInject"](n.Injector))},kl.\u0275dir=n["\u0275\u0275defineDirective"]({type:kl,hostVars:4,hostBindings:function(e,t){2&e&&n["\u0275\u0275classProp"]("rx-field-required",t.isRequired)("rx-field-disabled",t.isDisabled)},inputs:{config:"config"},features:[n["\u0275\u0275InheritDefinitionFeature"]]});const jl={defaultOptions:{filesCount:1,mode:u.UploaderMode.Manual,selectionMode:u.UploaderSelectionMode.File,chunkSize:"100KB",maxFileSize:"2GB"}};class _l extends kl{constructor(e){super(e),this.filesCount=jl.defaultOptions.filesCount,this.mode=jl.defaultOptions.mode,this.selectionMode=jl.defaultOptions.selectionMode,this.chunkSize=jl.defaultOptions.chunkSize,this.maxFileSize=jl.defaultOptions.maxFileSize,this.showFiles=[],this.texts={},this.readStateConfig={fileName:null,downloadURL:null}}onConfigInitialized(e){super.onConfigInitialized(e),this.attachmentFormControl=new b.FormControl(this.showFiles),this.maxFileSize=this.fieldDefinition.maxSize?(0,m.toString)(this.fieldDefinition.maxSize):jl.defaultOptions.maxFileSize,this.formControl.valueChanges.pipe((0,r.startWith)(this.formControl.value),(0,r.filter)(e=>!(e instanceof File)),(0,r.distinctUntilChanged)((e,t)=>e===t&&(0,m.has)(this.attachmentFormControl.value,"[0].downloadURL")),(0,r.takeUntil)(this.destroyed$)).subscribe(()=>{this.attachmentFormControl.reset(),this.addAttachedFileToAttachmentList(this.getFieldValue())}),this.formControl.touched$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{e?this.attachmentFormControl.markAsTouched():this.attachmentFormControl.markAsUntouched()})}addAttachedFileToAttachmentList(e){if(e){const t=this.recordEditorApi.getAttachmentDownloadUrl(this.fieldId);let i;i={data:{name:e},isUploading:!0},t&&(i.downloadURL=t),this.showFiles=[i]}else this.showFiles=[];this.attachmentFormControl.setValue(this.showFiles)}onConfigUpdated(e){super.onConfigUpdated(e),this.inReadState&&(this.readStateConfig={fileName:this.getDisplayValue(),downloadURL:this.recordEditorApi.getAttachmentDownloadUrl(this.fieldId)})}removeAttachment(e){e&&(this.attachment=null),this.addAttachedFileToAttachmentList(),this.setFieldValue(this.attachment)}addAttachment(e){const t=(0,m.first)(e);t&&(this.attachment=t.data,this.setFieldValue(this.attachment))}onBlur(){this.formControl.markAsTouched()}}function Bl(){return new a.UploaderService}_l.\u0275fac=function(e){return new(e||_l)(n["\u0275\u0275directiveInject"](n.Injector))},_l.\u0275cmp=n["\u0275\u0275defineComponent"]({type:_l,selectors:[["rx-attachment-field"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:5,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],["emptyReadonlyField",""],[4,"ngIf","ngIfElse"],["aria-hidden","true"],["class","d-block",3,"config",4,"ngIf"],[1,"d-block",3,"config"],[3,"ngClass","reusable","label","readonly","required","allowDeletion","uploadMode","selectionMode","filesCount","maxFileSize","chunkSize","texts","formControl","removedFileFromQueue","deletedFile","afterFilesAdded","onBlur"],[3,"label","value"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,ot,2,2,"ng-container",0),n["\u0275\u0275template"](1,at,1,15,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](3,st,1,2,"ng-template",null,2,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,u.AdaptDownloaderComponent,u.AdaptRxUploaderComponent,f.NgClass,b.RequiredValidator,b.NgControlStatus,b.FormControlDirective,S.ReadOnlyFieldComponent],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}  .d-icon-exclamation_triangle{display:none}  .adapt-rx-uploader__restrict{display:none}  .upload-status{display:none}  .adapt-uploader-item{border-top:0;height:37px!important;border-bottom:0}  .adapt-rx-uploader-file-attach-btn__wrp{max-width:100%}  .adapt-rx-uploader-attach-btn{overflow:hidden;text-overflow:ellipsis;max-width:100%}  .adapt-uploader-file{margin-left:0;padding-bottom:10px;padding-left:0!important;flex:auto;height:100%;border-bottom:1px solid #f0f1f1}  .adapt-uploader-status{margin-right:20px;width:15px;border-bottom:1px solid #f0f1f1}  .attachment-disabled .adapt-uploader-list-files-zone__header{margin:0;display:none}  .attachment-disabled .empty-state{display:none}  .attachment-disabled .empty-state__container{margin:0;padding:0}  .attachment-disabled .empty-state__label{margin-top:0;text-align:left}']});class $l{}$l.\u0275fac=function(e){return new(e||$l)},$l.\u0275mod=n["\u0275\u0275defineNgModule"]({type:$l,declarations:[_l],imports:[u.AdaptRxUploaderModule,f.CommonModule,S.ReadOnlyFieldModule,b.ReactiveFormsModule,p.TranslateModule,u.AdaptDownloadModule]}),$l.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[u.AdaptRxUploaderModule.forRoot({uploader:{provide:"UploaderService",useFactory:Bl,deps:[]}}),f.CommonModule,S.ReadOnlyFieldModule,b.ReactiveFormsModule,p.TranslateModule,u.AdaptDownloadModule]]});class Ll{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.Attachment,componentFactory:this.componentFactoryResolver.resolveComponentFactory(_l),properties:El,name:"Attachment",group:Ml,icon:"paperclip",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Vl),designComponentModel:Tl,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId})}}var Gl,ql;Ll.\u0275fac=function(e){return new(e||Ll)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Ll.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ll,imports:[$l,Nl]}),Ll.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[$l,Nl]]}),function(e){e.Checkbox="checkbox",e.Switch="switch"}(Gl||(Gl={})),function(e){e[e.True=1]="True",e[e.False=0]="False"}(ql||(ql={}));class Ul extends Pl{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.componentProperties$=this.sandbox.componentProperties$,this.fieldResourceTypes=[a.RX_RECORD_DEFINITION.resourceTypes.boolean]}static getInitialProperties(e){return Object.assign(Object.assign(Object.assign({},Pl.getInitialProperties()),{editingMode:Gl.Switch}),e)}getInspectorConfig(){return super.getInspectorConfig().pipe((0,r.map)(e=>this.editInspectorConfig(e)))}editInspectorConfig(e){const t=(0,m.findIndex)(e.inspectorSectionConfigs[0].controls,e=>"value"===e.name),i={name:"editingMode",component:l.SelectFormControlComponent,options:{label:"Editing mode",tooltip:new s.Tooltip("An optional Boolean field will always be displayed as a Switch."),required:!1,options:(0,m.map)(Gl,(e,t)=>({id:e,name:t}))}};return-1!==t&&e.inspectorSectionConfigs[0].controls.splice(t,0,i),e}}class zl{constructor(){this.shouldDisplayAsCheckbox=!1,this.destroyed$=new o.ReplaySubject(1)}ngOnInit(){const e=this.model.componentProperties$.pipe((0,r.map)(e=>e.editingMode||Gl.Switch));(0,o.combineLatest)([e,this.model.isRequired$]).pipe((0,r.takeUntil)(this.destroyed$)).subscribe(([e,t])=>{this.shouldDisplayAsCheckbox=t&&e===Gl.Checkbox})}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}}zl.\u0275fac=function(e){return new(e||zl)},zl.\u0275cmp=n["\u0275\u0275defineComponent"]({type:zl,selectors:[["rx-boolean-field-design"]],inputs:{model:"model"},decls:2,vars:2,consts:[[4,"ngIf"],["class","form-control-required",4,"ngIf"],[3,"ngModel","disabled","ngModelChange"],[1,"form-control-required"],[3,"ngModel","label","required","disabled","ngModelChange"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,dt,8,8,"ng-container",0),n["\u0275\u0275template"](1,ct,4,8,"ng-container",0)),2&e&&(n["\u0275\u0275property"]("ngIf",!t.shouldDisplayAsCheckbox),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.shouldDisplayAsCheckbox))},directives:[f.NgIf,u.AdaptRxSwitchComponent,b.NgControlStatus,b.NgModel,u.AdaptRxCheckboxComponent,b.RequiredValidator],pipes:[f.AsyncPipe],encapsulation:2});class Xl{}Xl.\u0275fac=function(e){return new(e||Xl)},Xl.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Xl,declarations:[zl],imports:[f.CommonModule,b.FormsModule,u.AdaptRxSwitchModule,u.AdaptRxCheckboxModule],exports:[zl]}),Xl.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.FormsModule,u.AdaptRxSwitchModule,u.AdaptRxCheckboxModule]]});class Wl extends kl{constructor(e,t){super(e),this.rxBooleanPipe=t}get booleanValue(){const e=this.getFieldValue();return(0,m.isNull)(e)?null:Boolean(e)}set booleanValue(e){(0,m.isNull)(e)?this.setFieldValue(null):this.setFieldValue(Number(e))}getDisplayValue(){const e=super.getDisplayValue();return(0,m.isNil)(e)?"-":this.rxBooleanPipe.transform(e)}onConfigInitialized(e){super.onConfigInitialized(e),this.editingMode=e.editingMode}onConfigUpdated(e){super.onConfigUpdated(e),this.shouldDisplayAsCheckbox&&null===this.getFieldValue()&&this.setFieldValue(ql.False,{markAsDirty:!1,markAsTouched:!1})}ngAfterViewInit(){this.formControl.touched$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{var t,i;return e?null===(t=this.ngModel)||void 0===t?void 0:t.control.markAsTouched():null===(i=this.ngModel)||void 0===i?void 0:i.control.markAsUntouched()})}get shouldDisplayAsCheckbox(){return this.editingMode===Gl.Checkbox&&this.isRequired}onBlur(){this.formControl.markAsTouched()}}Wl.\u0275fac=function(e){return new(e||Wl)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](s.RxBooleanPipe))},Wl.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Wl,selectors:[["rx-boolean-field"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](pt,5,b.NgModel),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.ngModel=e.first)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],[3,"label","value",4,"ngIf","ngIfElse"],[3,"label","value"],[3,"hidden","label","isDisabled","required","shouldDisplayAsCheckbox","ngModel","ngModelChange","rxBlur"],["booleanComponent",""]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,ut,2,2,"ng-container",0),n["\u0275\u0275template"](1,ft,2,6,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,S.ReadOnlyFieldComponent,l.RxBooleanComponent,b.RequiredValidator,b.NgControlStatus,b.NgModel],encapsulation:2});class Hl{}Hl.\u0275fac=function(e){return new(e||Hl)},Hl.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Hl,declarations:[Wl],imports:[f.CommonModule,u.AdaptRxFormControlModule,S.ReadOnlyFieldModule,u.AdaptButtonModule,u.AdaptRxCheckboxModule,p.TranslateModule,b.ReactiveFormsModule,b.FormsModule,l.RxBooleanModule]}),Hl.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptRxFormControlModule,S.ReadOnlyFieldModule,u.AdaptButtonModule,u.AdaptRxCheckboxModule,p.TranslateModule,b.ReactiveFormsModule,b.FormsModule,l.RxBooleanModule]]});class Ql{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.Boolean,componentFactory:this.componentFactoryResolver.resolveComponentFactory(Wl),properties:El,name:"Boolean",group:Ml,icon:"switcher_check",designComponentModel:Ul,designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(zl),options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId})}}Ql.\u0275fac=function(e){return new(e||Ql)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Ql.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ql,imports:[Hl,Xl]}),Ql.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Hl,Xl]]});class Jl extends Pl{constructor(){super(...arguments),this.fieldResourceTypes=[a.RX_RECORD_DEFINITION.resourceTypes.dateOnly]}}class Kl{}Kl.\u0275fac=function(e){return new(e||Kl)},Kl.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Kl,selectors:[["rx-date-field-design"]],inputs:{model:"model"},decls:3,vars:8,consts:[[1,"rx-pointer-events-none",3,"required","ngModel","disabled","label","ngModelChange"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-rx-datetime",0),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.dateValue=e}),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275pipe"](2,"async"),n["\u0275\u0275elementEnd"]()),2&e&&n["\u0275\u0275property"]("required",n["\u0275\u0275pipeBind1"](1,4,t.model.isRequired$))("ngModel",t.dateValue)("disabled",!0)("label",n["\u0275\u0275pipeBind1"](2,6,t.model.label$))},directives:[u.AdaptRxDatetimeComponent,b.RequiredValidator,b.NgControlStatus,b.NgModel],pipes:[f.AsyncPipe],encapsulation:2});class Yl{}Yl.\u0275fac=function(e){return new(e||Yl)},Yl.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Yl,declarations:[Kl],imports:[u.AdaptRxDatetimeModule,f.CommonModule,b.FormsModule]}),Yl.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[u.AdaptRxDatetimeModule,f.CommonModule,b.FormsModule]]});class Zl extends u.AdaptRxDatetimeAdapter{constructor(){super(...arguments),this.storeDateFormat="YYYY-MM-DD"}fromModel(e){let t=null;const i=(0,D.default)(e);return i&&i.isValid()&&(t={year:i.year(),month:i.month(),date:i.date(),hours:i.hours(),minutes:i.minutes(),seconds:i.seconds()}),t}toModel(e){return e?e.parseError?D.default.invalid().toString():(0,D.default)([e.year||0,e.month||0,e.date||0]).format(this.storeDateFormat):null}}Zl.\u0275fac=function(){let e;return function(t){return(e||(e=n["\u0275\u0275getInheritedFactory"](Zl)))(t||Zl)}}(),Zl.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Zl,factory:Zl.\u0275fac});class ed extends kl{constructor(e,t){super(e),this.datePipe=t}getDisplayValue(){const e=super.getDisplayValue();if(e)return this.datePipe.transform(e,"mediumDate")}getFieldValidators(){return[e=>{const t=e.value?(0,D.default)(e.value):null;return e.value&&t&&!t.isValid()?{rxDatetimeFormat:{mode:u.RxDatetimePickerMode.Date}}:null}]}}ed.\u0275fac=function(e){return new(e||ed)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](f.DatePipe))},ed.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ed,selectors:[["rx-date-field"]],features:[n["\u0275\u0275ProvidersFeature"]([{provide:u.AdaptRxDatetimeAdapter,useClass:Zl}]),n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],[3,"label","value",4,"ngIf","ngIfElse"],[3,"label","value"],[3,"label","required","formControl","readonly","disabledStyleForReadonlyState"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,gt,2,2,"ng-container",0),n["\u0275\u0275template"](1,vt,1,5,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,S.ReadOnlyFieldComponent,u.AdaptRxDatetimeComponent,b.RequiredValidator,b.NgControlStatus,b.FormControlDirective],encapsulation:2});class td{}td.\u0275fac=function(e){return new(e||td)},td.\u0275mod=n["\u0275\u0275defineNgModule"]({type:td,declarations:[ed],imports:[u.AdaptRxDatetimeModule,f.CommonModule,b.FormsModule,b.ReactiveFormsModule,S.ReadOnlyFieldModule,p.TranslateModule]}),td.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[f.DatePipe],imports:[[u.AdaptRxDatetimeModule,f.CommonModule,b.FormsModule,b.ReactiveFormsModule,S.ReadOnlyFieldModule,p.TranslateModule]]});class id{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.Date,componentFactory:this.componentFactoryResolver.resolveComponentFactory(ed),properties:El,name:"Date",group:Ml,icon:"calendar",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Kl),designComponentModel:Jl,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId})}}id.\u0275fac=function(e){return new(e||id)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},id.\u0275mod=n["\u0275\u0275defineNgModule"]({type:id,imports:[td,Yl]}),id.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[td,Yl]]});class nd extends Pl{constructor(){super(...arguments),this.fieldResourceTypes=[a.RX_RECORD_DEFINITION.resourceTypes.dateTime]}}class od{constructor(){this.pickerMode=u.RxDatetimePickerMode.DateTime}}od.\u0275fac=function(e){return new(e||od)},od.\u0275cmp=n["\u0275\u0275defineComponent"]({type:od,selectors:[["rx-date-time-field-design"]],inputs:{model:"model"},decls:3,vars:9,consts:[[1,"rx-pointer-events-none",3,"required","ngModel","disabled","mode","label","ngModelChange"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-rx-datetime",0),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.dateTimeValue=e}),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275pipe"](2,"async"),n["\u0275\u0275elementEnd"]()),2&e&&n["\u0275\u0275property"]("required",n["\u0275\u0275pipeBind1"](1,5,t.model.isRequired$))("ngModel",t.dateTimeValue)("disabled",!0)("mode",t.pickerMode)("label",n["\u0275\u0275pipeBind1"](2,7,t.model.label$))},directives:[u.AdaptRxDatetimeComponent,b.RequiredValidator,b.NgControlStatus,b.NgModel],pipes:[f.AsyncPipe],encapsulation:2});class rd{}rd.\u0275fac=function(e){return new(e||rd)},rd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:rd,declarations:[od],imports:[u.AdaptRxDatetimeModule,f.CommonModule,b.FormsModule]}),rd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[u.AdaptRxDatetimeModule,f.CommonModule,b.FormsModule]]});class ad extends u.AdaptRxDatetimeAdapter{fromModel(e){let t=null;const i=(0,D.default)(e);return i&&i.isValid()&&(t={year:i.year(),month:i.month(),date:i.date(),hours:i.hours(),minutes:i.minutes(),seconds:i.seconds()}),t}toModel(e){return e?e.parseError?D.default.invalid().toString():(0,D.default)([e.year||0,e.month||0,e.date||0,e.hours||0,e.minutes||0,e.seconds||0]).toISOString():null}}ad.\u0275fac=function(){let e;return function(t){return(e||(e=n["\u0275\u0275getInheritedFactory"](ad)))(t||ad)}}(),ad.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ad,factory:ad.\u0275fac});class sd extends kl{constructor(e,t){super(e),this.datePipe=t,this.pickerMode=u.RxDatetimePickerMode.DateTime}getDisplayValue(){const e=super.getDisplayValue();if(e)return this.datePipe.transform(e,"medium")}getFieldValidators(){return[e=>{const t=e.value?(0,D.default)(e.value):null;return e.value&&t&&!t.isValid()?{rxDatetimeFormat:{mode:this.pickerMode,hasSeconds:!0}}:null}]}}sd.\u0275fac=function(e){return new(e||sd)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](f.DatePipe))},sd.\u0275cmp=n["\u0275\u0275defineComponent"]({type:sd,selectors:[["rx-date-time-field"]],features:[n["\u0275\u0275ProvidersFeature"]([{provide:u.AdaptRxDatetimeAdapter,useClass:ad}]),n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],[3,"label","value",4,"ngIf","ngIfElse"],[3,"label","value"],["hasSeconds","true",3,"label","required","formControl","readonly","disabledStyleForReadonlyState","mode"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,xt,2,2,"ng-container",0),n["\u0275\u0275template"](1,bt,1,6,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,S.ReadOnlyFieldComponent,u.AdaptRxDatetimeComponent,b.RequiredValidator,b.NgControlStatus,b.FormControlDirective],encapsulation:2});class ld{}ld.\u0275fac=function(e){return new(e||ld)},ld.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ld,declarations:[sd],imports:[u.AdaptRxDatetimeModule,f.CommonModule,b.FormsModule,b.ReactiveFormsModule,S.ReadOnlyFieldModule,p.TranslateModule]}),ld.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[f.DatePipe],imports:[[u.AdaptRxDatetimeModule,f.CommonModule,b.FormsModule,b.ReactiveFormsModule,S.ReadOnlyFieldModule,p.TranslateModule]]});class dd{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.DateTime,componentFactory:this.componentFactoryResolver.resolveComponentFactory(sd),properties:El,name:"Date/Time",group:Ml,icon:"calendar_clock_o",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(od),designComponentModel:nd,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId})}}dd.\u0275fac=function(e){return new(e||dd)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},dd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:dd,imports:[ld,rd]}),dd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[ld,rd]]});class cd extends Pl{constructor(){super(...arguments),this.fieldResourceTypes=[a.RX_RECORD_DEFINITION.resourceTypes.decimal,a.RX_RECORD_DEFINITION.resourceTypes.real]}}class pd{}pd.\u0275fac=function(e){return new(e||pd)},pd.\u0275cmp=n["\u0275\u0275defineComponent"]({type:pd,selectors:[["rx-decimal-field-design"]],inputs:{model:"model"},decls:3,vars:7,consts:[["ngModel","",1,"rx-pointer-events-none",3,"required","label","disabled"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-rx-textfield",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275pipe"](2,"async")),2&e&&n["\u0275\u0275property"]("required",n["\u0275\u0275pipeBind1"](1,3,t.model.isRequired$))("label",n["\u0275\u0275pipeBind1"](2,5,t.model.label$))("disabled",!0)},directives:[u.AdaptRxTextfieldComponent,b.NgControlStatus,b.NgModel,b.RequiredValidator],pipes:[f.AsyncPipe],encapsulation:2});class md{}md.\u0275fac=function(e){return new(e||md)},md.\u0275mod=n["\u0275\u0275defineNgModule"]({type:md,declarations:[pd],imports:[f.CommonModule,u.AdaptRxTextfieldModule,b.FormsModule]}),md.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptRxTextfieldModule,b.FormsModule]]});class ud extends kl{constructor(e){super(e),this.hasFocus=!1,this.decimalPipe=e.get(f.DecimalPipe)}onConfigInitialized(e){super.onConfigInitialized(e),this.counterFormControl=new b.FormControl(this.formControl.value,this.formControl.validator),this.counterFormControl.valueChanges.pipe((0,r.filter)(e=>!(0,m.isEqual)(this.formControl.value,e)),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.setFieldValue(e)}),this.formControl.valueChanges.pipe((0,r.startWith)(this.formControl.value),(0,r.distinctUntilChanged)(m.isEqual),(0,r.takeUntil)(this.destroyed$)).subscribe(()=>{this.hasFocus||this.counterFormControl.setValue(this.formControl.value)}),this.formControl.touched$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{e?this.counterFormControl.markAsTouched():this.counterFormControl.markAsUntouched()})}onBlur(){this.hasFocus=!1,this.formControl.markAsTouched()}onFocus(){this.hasFocus=!0}getDisplayValue(){const e=this.getFieldValue();return(0,m.isNil)(e)?e:this.decimalPipe.transform(String(e))}setFieldValue(e){if(!(0,m.isNull)(e)&&(0,m.isFinite)(e)){const t=new(I())(e);t.eq(this.formControl.value)||(this.formControl.markAsDirty(),this.formControl.setValue(t))}else super.setFieldValue(e)}}ud.\u0275fac=function(e){return new(e||ud)(n["\u0275\u0275directiveInject"](n.Injector))},ud.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ud,selectors:[["rx-integer-field"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](Ct,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.counterComponent=e.first)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],[3,"label","value",4,"ngIf","ngIfElse"],[3,"label","value"],["adaptIntegerNumber","",1,"mb-0",3,"label","formControl","readonly","disabledStyleForReadonlyState","required","min","max","adaptMin","adaptMax","onBlur","onFocus"],["counterComponent",""]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,wt,2,2,"ng-container",0),n["\u0275\u0275template"](1,Dt,2,9,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,S.ReadOnlyFieldComponent,u.AdaptRxCounterComponent,u.AdaptIntegerNumberValidatorDirective,b.NgControlStatus,b.FormControlDirective,b.RequiredValidator,u.AdaptMinValidatorDirective,u.AdaptMaxValidatorDirective],encapsulation:2});class fd extends ud{getDisplayValue(){const e=this.getFieldValue(),t=this.fieldDefinition.precision,i=-1===t?null:`1.${t}-${t}`;return(0,m.isNil)(e)?e:this.decimalPipe.transform(String(e),i)}}fd.\u0275fac=function(){let e;return function(t){return(e||(e=n["\u0275\u0275getInheritedFactory"](fd)))(t||fd)}}(),fd.\u0275cmp=n["\u0275\u0275defineComponent"]({type:fd,selectors:[["rx-decimal-field"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],[3,"label","value",4,"ngIf","ngIfElse"],[3,"label","value"],[1,"mb-0",3,"label","formControl","required","min","max","adaptMin","adaptMax","readonly","disabledStyleForReadonlyState","requiredLabel","onBlur","onFocus"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,It,2,2,"ng-container",0),n["\u0275\u0275template"](1,Ft,2,12,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,S.ReadOnlyFieldComponent,u.AdaptRxCounterComponent,b.NgControlStatus,b.FormControlDirective,b.RequiredValidator,u.AdaptMinValidatorDirective,u.AdaptMaxValidatorDirective],pipes:[p.TranslatePipe],encapsulation:2});class hd{}hd.\u0275fac=function(e){return new(e||hd)},hd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:hd,declarations:[fd],imports:[F.AdaptTextFieldFormBuilderModule,u.AdaptRxCounterModule,u.AdaptRxValidatorsModule,f.CommonModule,b.ReactiveFormsModule,S.ReadOnlyFieldModule,p.TranslateModule]}),hd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[F.AdaptTextFieldFormBuilderModule,u.AdaptRxCounterModule,u.AdaptRxValidatorsModule,f.CommonModule,b.ReactiveFormsModule,S.ReadOnlyFieldModule,p.TranslateModule]]});class gd{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t;const i=this.componentFactoryResolver.resolveComponentFactory(fd);e.register({type:d.RxViewComponentType.Decimal,aliases:[d.RxViewComponentType.Floating],componentFactory:i,properties:El,name:"Decimal",group:Ml,icon:"field_decimal_number",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(pd),designComponentModel:cd,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId})}}gd.\u0275fac=function(e){return new(e||gd)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},gd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:gd,imports:[hd,md]}),gd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[hd,md]]});class vd extends Pl{constructor(){super(...arguments),this.fieldResourceTypes=[a.RX_RECORD_DEFINITION.resourceTypes.integer]}}class yd{}yd.\u0275fac=function(e){return new(e||yd)},yd.\u0275cmp=n["\u0275\u0275defineComponent"]({type:yd,selectors:[["rx-integer-field-design"]],inputs:{model:"model"},decls:3,vars:7,consts:[["ngModel","",1,"rx-pointer-events-none",3,"required","label","disabled"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-rx-textfield",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275pipe"](2,"async")),2&e&&n["\u0275\u0275property"]("required",n["\u0275\u0275pipeBind1"](1,3,t.model.isRequired$))("label",n["\u0275\u0275pipeBind1"](2,5,t.model.label$))("disabled",!0)},directives:[u.AdaptRxTextfieldComponent,b.NgControlStatus,b.NgModel,b.RequiredValidator],pipes:[f.AsyncPipe],encapsulation:2});class xd{}xd.\u0275fac=function(e){return new(e||xd)},xd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:xd,declarations:[yd],imports:[f.CommonModule,u.AdaptRxTextfieldModule,b.FormsModule]}),xd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptRxTextfieldModule,b.FormsModule]]});class bd{}bd.\u0275fac=function(e){return new(e||bd)},bd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:bd,declarations:[ud],imports:[F.AdaptTextFieldFormBuilderModule,u.AdaptRxCounterModule,u.AdaptRxValidatorsModule,f.CommonModule,S.ReadOnlyFieldModule,b.ReactiveFormsModule,p.TranslateModule]}),bd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[F.AdaptTextFieldFormBuilderModule,u.AdaptRxCounterModule,u.AdaptRxValidatorsModule,f.CommonModule,S.ReadOnlyFieldModule,b.ReactiveFormsModule,p.TranslateModule]]});class Cd{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.Integer,componentFactory:this.componentFactoryResolver.resolveComponentFactory(ud),properties:El,name:"Integer",group:Ml,icon:"field_integer_number",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(yd),designComponentModel:vd,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId})}}Cd.\u0275fac=function(e){return new(e||Cd)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Cd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Cd,imports:[bd,xd]}),Cd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[bd,xd]]});const Sd={id:null,name:"None"},wd={radioButtons:"Radio Buttons",dropdown:"Dropdown"},Dd={radioButtons:"radio-buttons",dropdown:"dropdown"};class Rd extends Pl{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.fieldResourceTypes=[a.RX_RECORD_DEFINITION.resourceTypes.selection],this.editingMode$=this.sandbox.componentProperties$.pipe((0,r.map)(e=>e.editingMode))}static getInitialProperties(e){return Object.assign(Object.assign(Object.assign({},Pl.getInitialProperties()),{editingMode:Dd.dropdown}),e)}getInspectorConfig(){return super.getInspectorConfig().pipe((0,r.map)(e=>this.editInspectorConfig(e)))}editInspectorConfig(e){const t=(0,m.findIndex)(e.inspectorSectionConfigs[0].controls,e=>"value"===e.name),i={name:"editingMode",component:l.SelectFormControlComponent,options:{label:"Editing mode",required:!1,options:[{id:Dd.dropdown,name:wd.dropdown},{id:Dd.radioButtons,name:wd.radioButtons}]}};return-1!==t&&e.inspectorSectionConfigs[0].controls.splice(t,0,i),e}}class Id{ngOnInit(){this.model.editingMode$.subscribe(e=>{this.setMode(e)})}setMode(e){this.isRadioButtonMode=e===Dd.radioButtons}}Id.\u0275fac=function(e){return new(e||Id)},Id.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Id,selectors:[["rx-selection-field-design"]],inputs:{model:"model"},decls:2,vars:2,consts:[["class","rx-pointer-events-none","ngModel","",3,"label","options","disabled","required",4,"ngIf"],[4,"ngIf"],["ngModel","",1,"rx-pointer-events-none",3,"label","options","disabled","required"],[1,"form-group"],[1,"form-control-label"],["class","form-control-required",4,"ngIf"],[3,"ngModel","disabled","ngModelChange"],["value","None","label","None",4,"ngIf"],["label","Option 1"],["label","Option 2"],[1,"form-control-required"],["value","None","label","None"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,Et,3,9,"adapt-rx-select",0),n["\u0275\u0275template"](1,Ot,12,11,"ng-container",1)),2&e&&(n["\u0275\u0275property"]("ngIf",!t.isRadioButtonMode),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.isRadioButtonMode))},directives:[f.NgIf,u.AdaptRxSelectComponent,b.NgControlStatus,b.NgModel,b.RequiredValidator,u.AdaptRxRadiobuttonGroupComponent,u.AdaptRxRadiobuttonComponent],pipes:[f.AsyncPipe],styles:["adapt-select{width:100%}"]});class Fd{}var Ed,Md;Fd.\u0275fac=function(e){return new(e||Fd)},Fd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Fd,declarations:[Id],imports:[f.CommonModule,u.AdaptRxRadiobuttonModule,b.FormsModule,u.AdaptRxSelectModule]}),Fd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptRxRadiobuttonModule,b.FormsModule,u.AdaptRxSelectModule]]}),function(e){e.RadioButton="radio-buttons",e.Dropdown="dropdown"}(Ed||(Ed={}));class Ad extends kl{getSelectValue(){return(0,m.isNil)(this.formControl.value)?[]:(0,m.compact)([this.selectOptions.find(e=>e.id===Number(this.formControl.value))])}onConfigInitialized(e){super.onConfigInitialized(e),this.isRadioButtonMode=e.editingMode===Ed.RadioButton,this.generateControlOptions(this.fieldDefinition),this.selectFormControl=new b.FormControl(this.getSelectValue()),this.selectFormControl.valueChanges.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.setFieldValue((0,m.get)(e,"[0].id",null))}),this.formControl.valueChanges.pipe((0,r.startWith)(this.formControl.value),(0,r.distinctUntilChanged)(),(0,r.takeUntil)(this.destroyed$)).subscribe(()=>{this.selectFormControl.setValue(this.getSelectValue())}),this.formControl.touched$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{e?this.selectFormControl.markAsTouched():this.selectFormControl.markAsUntouched()})}generateControlOptions(e){this.selectOptions=(0,m.map)(e.optionLabelsById,(e,t)=>({name:e,id:Number(t)})),!this.isRequired&&this.isRadioButtonMode&&this.selectOptions.unshift(Sd)}getDisplayValue(){return this.fieldDefinition.optionLabelsById[this.formControl.value]}optionFormatter(e){return e.name}onPopupStatusChange(e){e||this.formControl.markAsTouched()}}Ad.\u0275fac=function(){let e;return function(t){return(e||(e=n["\u0275\u0275getInheritedFactory"](Ad)))(t||Ad)}}(),Ad.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Ad,selectors:[["rx-selection-field"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],[3,"label","value",4,"ngIf","ngIfElse"],[3,"label","value"],[3,"name","formControl","readonly","label",4,"ngIf"],[3,"options","required","label","formControl","readonly","optionFormatter","enableFilter","emptyOption","onPopupOpenChange",4,"ngIf"],[3,"name","formControl","readonly","label"],[3,"value","label","class",4,"ngFor","ngForOf"],[3,"value","label"],[3,"options","required","label","formControl","readonly","optionFormatter","enableFilter","emptyOption","onPopupOpenChange"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,Tt,2,2,"ng-container",0),n["\u0275\u0275template"](1,jt,2,2,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,S.ReadOnlyFieldComponent,u.AdaptRxRadiobuttonGroupComponent,b.NgControlStatus,b.FormControlDirective,f.NgForOf,u.AdaptRxRadiobuttonComponent,u.AdaptRxSelectComponent,b.RequiredValidator],encapsulation:2});class Od{}Od.\u0275fac=function(e){return new(e||Od)},Od.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Od,declarations:[Ad],imports:[u.AdaptRxFormControlModule,u.AdaptRxRadiobuttonModule,f.CommonModule,S.ReadOnlyFieldModule,b.FormsModule,b.ReactiveFormsModule,p.TranslateModule,u.AdaptRxLabelModule,u.AdaptRxSelectModule]}),Od.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[u.AdaptRxFormControlModule,u.AdaptRxRadiobuttonModule,f.CommonModule,S.ReadOnlyFieldModule,b.FormsModule,b.ReactiveFormsModule,p.TranslateModule,u.AdaptRxLabelModule,u.AdaptRxSelectModule]]});class Pd{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.Selection,componentFactory:this.componentFactoryResolver.resolveComponentFactory(Ad),properties:El,name:"Select",group:Ml,icon:"field_dropdown",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Id),designComponentModel:Rd,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId})}}Pd.\u0275fac=function(e){return new(e||Pd)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Pd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Pd,imports:[Od,Fd]}),Pd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Od,Fd]]});class Td extends h.BaseViewComponent{constructor(){super(...arguments),this.fieldComponents=new Map}registerFieldComponent(e,t){this.fieldComponents.set(e,t)}getValueForPreviousField(e){const t=this.fieldComponents.get(e-1);return t?t.getFieldValue():null}resetValueForNextFields(e){const t=e+1,i=this.fieldComponents.get(t);i&&(i.resetFieldValue(),this.resetValueForNextFields(t))}}Td.\u0275fac=function(){let e;return function(t){return(e||(e=n["\u0275\u0275getInheritedFactory"](Td)))(t||Td)}}(),Td.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Td,selectors:[["rx-select-group"]],inputs:{config:"config"},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:0,template:function(e,t){1&e&&n["\u0275\u0275element"](0,"rx-runtime-view-canvas-outlet")},directives:[h.RuntimeViewCanvasOutletComponent],encapsulation:2});class Vd extends kl{constructor(e,t,i,n){super(e),this.selectGroupComponent=t,this.rxNamedListDefinitionService=i,this.rxNamedListService=n,this.optionLoaderFunc=this.getNamedListOptionPage.bind(this),this.viewToModelValueAdapterFunc=this.viewToModelValueAdapter.bind(this),this.modelToViewValueAdapterFunc=this.modelToViewValueAdapter.bind(this),this.selectedOptions=[]}onConfigInitialized(e){super.onConfigInitialized(e),this.fieldIndex=Number(e.index),this.namedListDefinitionName=e.namedListDefinitionName,this.selectGroupComponent.registerFieldComponent(this.fieldIndex,this);const t=this.rxNamedListDefinitionService.get(this.namedListDefinitionName).pipe((0,r.take)(1)),i=this.formControl.valueChanges.pipe((0,r.distinctUntilChanged)(m.isEqual),(0,r.startWith)(this.formControl.value),(0,r.takeUntil)(this.destroyed$));(0,o.combineLatest)([t,i]).subscribe(([t])=>{this.namedListDefinition=t,this.fieldIdToFilterBy=e.optionFilterFieldId||t.valueFieldId,this.updateSelectedOption(),this.formControl.dirty?this.selectGroupComponent.resetValueForNextFields(this.fieldIndex):this.resetLoadedOptions()})}resetFieldValue(){super.setFieldValue(null),this.resetLoadedOptions()}getDisplayValue(){return this.readOnlyValue}getNamedListOptionPage(e,t,i){return this.rxNamedListService.getOptionPage(this.namedListDefinition,i,this.getSelectionQueryCriteria(),e,t)}viewToModelValueAdapter(e){return(0,m.get)(e,"[0].value","")}modelToViewValueAdapter(e){return(0,m.isNil)(e)?[]:this.selectedOptions}updateSelectedOption(){let e;if(this.showDefaultTitle=!1,(0,m.isEmpty)(this.formControl.value))e=(0,o.of)([]);else{const t=(0,m.get)(this.selectWithPaginationComponent,"options",[]),i=(0,m.find)(t,{value:this.formControl.value});e=i?(0,o.of)([i]):this.rxNamedListService.getOptionsForValues(this.namedListDefinition,[this.formControl.value])}e.pipe((0,r.take)(1)).subscribe(e=>{this.showDefaultTitle=!0,this.selectedOptions=e,(0,m.isEmpty)(e)&&this.formControl.value&&(this.selectedOptions=[{displayValue:null,value:this.formControl.value}]),this.formControl.dirty&&this.formControl.markAsTouched(),this.triggerModelToViewValueUpdate(),this.updateReadOnlyValue()})}resetLoadedOptions(){this.selectWithPaginationComponent&&this.selectWithPaginationComponent.resetLoadedOptions()}getSelectionQueryCriteria(){let e=null;if(this.fieldIndex>0){const t=this.selectGroupComponent.getValueForPreviousField(this.fieldIndex);t&&(e=`('${this.fieldIdToFilterBy}' = "${t}")`)}return e}updateReadOnlyValue(){this.readOnlyValue=(0,m.get)(this.selectedOptions,"[0].displayValue",null)}triggerModelToViewValueUpdate(){this.formControl.setValue(this.formControl.value,{emitEvent:!1})}}Vd.\u0275fac=function(e){return new(e||Vd)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](Td),n["\u0275\u0275directiveInject"](E.RxNamedListDefinitionService),n["\u0275\u0275directiveInject"](E.RxNamedListService))},Vd.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Vd,selectors:[["rx-select-group-field"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](l.RxSelectWithPaginationComponent,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.selectWithPaginationComponent=e.first)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],[3,"label","value",4,"ngIf","ngIfElse"],[3,"label","value"],[3,"label","formControl","required","readonly","optionLoader","showDefaultTitle","viewToModelValueAdapter","modelToViewValueAdapter"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,Bt,2,2,"ng-container",0),n["\u0275\u0275template"](1,$t,1,8,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,S.ReadOnlyFieldComponent,l.RxSelectWithPaginationComponent,b.NgControlStatus,b.FormControlDirective,b.RequiredValidator],encapsulation:2});class Nd{adaptDefinition(e){e.componentDefinitions.forEach(t=>{(0,m.assign)(t.propertiesByName,{disabled:e.propertiesByName.disabled,hidden:e.propertiesByName.hidden,index:Number(t.propertiesByName.index)}),delete t.propertiesByName.labelId});const t={outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName,columns:[{children:(0,m.sortBy)(e.componentDefinitions,"propertiesByName.index").map(e=>e.guid)}]}]};e.propertiesByName=(0,m.omit)(e.propertiesByName,["disabled","hidden","recordInstance","recordDefinition"]),e.layout=JSON.stringify(t)}}Nd.\u0275fac=function(e){return new(e||Nd)},Nd.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Nd,factory:Nd.\u0275fac});class kd{constructor(e,t){this.viewComponentDefinitionAdapterRegistryService=e,this.selectGroupComponentDefinitionAdapterService=t,e.registerRuntimeAdapter(d.RxViewComponentType.SelectGroup,this.selectGroupComponentDefinitionAdapterService)}}kd.\u0275fac=function(e){return new(e||kd)(n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService),n["\u0275\u0275inject"](Nd))},kd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:kd,declarations:[Td,Vd],imports:[f.CommonModule,h.RuntimeViewCanvasModule,b.ReactiveFormsModule,l.RxSelectWithPaginationModule,S.ReadOnlyFieldModule]}),kd.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[Nd],imports:[[f.CommonModule,h.RuntimeViewCanvasModule,b.ReactiveFormsModule,l.RxSelectWithPaginationModule,S.ReadOnlyFieldModule]]});class jd{constructor(e,t,i){this.rxDefinitionNameService=e,this.rxNamedListDefinitionCacheService=t,this.rxRecordDefinitionCacheService=i,this.definitionPickerOptions={label:"Named list for options",definitionType:l.RxDefinitionPickerType.NamedList,required:!0},this.filterField=[],this.filterFieldIdOptions=[],this.sourceRecordDefinitionDisplayName="",this.fieldId=[]}ngOnInit(){this.onNamedListDefinitionNameChange(!1)}onNamedListDefinitionNameChange(e=!0){(0,o.of)(this.fieldformGroup.get("namedListDefinitionName").value).pipe((0,r.switchMap)(e=>e?this.rxNamedListDefinitionCacheService.getNamedListDefinition(e).pipe((0,r.map)(e=>e.recordDefinitionName)):(0,o.of)(null)),(0,r.take)(1)).subscribe(t=>{this.fieldformGroup.get("sourceRecordDefinitionName").setValue(t,{emitEvent:e}),this.filterFieldIdOptions=[],this.setFilterId(),this.index>0&&(this.setOptionFilterFieldIdOptions(),this.setSourceRecordDefinitionDisplayName())})}setFilterId(){const e=this.fieldformGroup.get("fieldId").value;this.fieldId=(0,m.isEmpty)(e)?[]:[this.targetFieldOptions.find(t=>t.id===e)]}setSourceRecordDefinitionDisplayName(){const e=this.fieldformGroup.get("sourceRecordDefinitionName").value;this.sourceRecordDefinitionDisplayName=e&&this.rxDefinitionNameService.getDisplayName(e)}setOptionFilterFieldIdOptions(){const e=this.fieldformGroup.get("sourceRecordDefinitionName").value;this.filterField=[],e&&this.rxRecordDefinitionCacheService.getRecordDefinition(e).pipe((0,r.map)(e=>e.fieldDefinitions.map(e=>({name:e.name,id:String(e.id)})))).subscribe(e=>{const t=this.fieldformGroup.get("optionFilterFieldId").value;this.filterFieldIdOptions=e,this.filterField=(0,m.isEmpty)(t)?[]:[this.filterFieldIdOptions.find(e=>e.id===t)]})}optionFormatter(e){return e.name}onSelectFilterField(e){this.fieldformGroup.get("optionFilterFieldId").setValue((0,m.head)(e).id)}onSelectField(e){this.fieldformGroup.get("fieldId").setValue((0,m.head)(e).id)}}jd.\u0275fac=function(e){return new(e||jd)(n["\u0275\u0275directiveInject"](s.RxDefinitionNameService),n["\u0275\u0275directiveInject"](E.RxNamedListDefinitionCacheService),n["\u0275\u0275directiveInject"](a.RxRecordDefinitionCacheService))},jd.\u0275cmp=n["\u0275\u0275defineComponent"]({type:jd,selectors:[["rx-select-group-field"]],inputs:{fieldformGroup:"fieldformGroup",index:"index",targetFieldOptions:"targetFieldOptions"},decls:6,vars:13,consts:[["label","Display label","required","true","rx-id","display-label-field",1,"form-group","d-block",3,"formControl"],["required","true","rx-id","named-list-definition-name-field",1,"form-group","d-block",3,"options","formControl","ngModelChange"],["label","Field for storing selected option value","rx-id","selected-option-value-target-field",3,"ngModel","options","optionFormatter","required","disabled","ngClass","ngModelChange"],["label","Source record definition","class","form-group d-block","disabled","","rx-id","source-record-definition-name-field",3,"ngModel","tooltip",4,"ngIf"],["label","Field for filtering option values","rx-id","option-values-filter-field",3,"ngModel","options","optionFormatter","disabled","tooltip","ngModelChange",4,"ngIf"],["label","Source record definition","disabled","","rx-id","source-record-definition-name-field",1,"form-group","d-block",3,"ngModel","tooltip"],["label","Field for filtering option values","rx-id","option-values-filter-field",3,"ngModel","options","optionFormatter","disabled","tooltip","ngModelChange"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275element"](1,"adapt-rx-textfield",0),n["\u0275\u0275elementStart"](2,"rx-definition-picker",1),n["\u0275\u0275listener"]("ngModelChange",function(){return t.onNamedListDefinitionNameChange()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"adapt-rx-select",2),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.onSelectField(e)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](4,Gt,1,3,"adapt-rx-textfield",3),n["\u0275\u0275template"](5,Ut,1,6,"adapt-rx-select",4),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("formControl",t.fieldformGroup.get("label")),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("options",t.definitionPickerOptions)("formControl",t.fieldformGroup.get("namedListDefinitionName")),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngModel",t.fieldId)("options",t.targetFieldOptions)("optionFormatter",t.optionFormatter)("required",!0)("disabled",t.fieldformGroup.disabled)("ngClass",n["\u0275\u0275pureFunction1"](11,zt,t.index>0)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.index>0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.index>0))},directives:[u.AdaptRxTextfieldComponent,b.RequiredValidator,b.NgControlStatus,b.FormControlDirective,l.RxDefinitionPickerComponent,u.AdaptRxSelectComponent,b.NgModel,f.NgClass,f.NgIf],encapsulation:2});class _d extends l.InspectorWidgetBase{constructor(e,t,i,n){super(n),this.formBuilder=e,this.rxGuidService=t,this.rxModalService=i,this.formArray=this.formBuilder.array([]),this.maxSelectGroupFieldCount=6,this.destroyed$=new o.ReplaySubject(1)}ngOnInit(){this.designerItemModel.fieldProperties$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>this.onWriteValue(e)),this.setDisabledState(this.isDisabled)}onWriteValue(e){var t;null===(t=this.valueChangeSubscription)||void 0===t||t.unsubscribe();const i=e.sort((e,t)=>Number(e.index)-Number(t.index)).map(e=>this.formBuilder.group(Object.assign(Object.assign({},(0,m.omit)(e,"index")),{sourceRecordDefinitionName:{value:null,disabled:!0}})));this.formArray=this.formBuilder.array(i),this.valueChangeSubscription=this.formArray.valueChanges.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(this.onFormValueChange.bind(this))}onFormValueChange(e){const t=e.map((e,t)=>{const i=Object.assign(Object.assign({},(0,m.omit)(e,["sourceRecordDefinitionName","optionFilterFieldId"])),{index:String(t),fieldId:e.namedListDefinitionName?e.fieldId:null});return t>0&&(i.optionFilterFieldId=e.namedListDefinitionName?e.optionFilterFieldId:null),i});this.designerItemModel.onFieldPropertiesChange(t)}addField(){this.formArray.push(this.getFieldFormGroup())}removeField(e){this.rxModalService.confirm({title:"Warning",modalStyle:S.RX_MODAL.modalStyles.warning,message:"Are you sure you want to delete this field?"}).then(t=>{t&&this.formArray.removeAt(e)})}isAddFieldButtonDisabled(){return this.isDisabled||this.formArray.length>=this.maxSelectGroupFieldCount}trackByFn(e,t){return t.get("guid").value}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}getFieldFormGroup(){return this.formBuilder.group({guid:this.rxGuidService.generate(),label:null,namedListDefinitionName:null,fieldId:null,sourceRecordDefinitionName:null,optionFilterFieldId:null})}setDisabledState(e){e?this.formArray.disable():this.formArray.enable()}}_d.\u0275fac=function(e){return new(e||_d)(n["\u0275\u0275directiveInject"](b.FormBuilder),n["\u0275\u0275directiveInject"](v.RxGuidService),n["\u0275\u0275directiveInject"](S.RxModalService),n["\u0275\u0275directiveInject"](n.Injector))},_d.\u0275cmp=n["\u0275\u0275defineComponent"]({type:_d,selectors:[["rx-field-set-form-control"]],inputs:{options:"options",isDisabled:"isDisabled"},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:3,consts:[["btn-type","tertiary","rx-id","add-field-button",1,"d-icon-plus_circle","px-0","py-0",3,"disabled","click"],["class","card mt-2","rx-id","select-group-field-card",4,"ngFor","ngForOf","ngForTrackBy"],["rx-id","select-group-field-card",1,"card","mt-2"],[1,"card-block","p-2"],["class","close position-relative","type","button","aria-label","Remove","rx-id","remove-field-button",3,"click",4,"ngIf"],[3,"fieldformGroup","index","targetFieldOptions"],["type","button","aria-label","Remove","rx-id","remove-field-button",1,"close","position-relative",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-button",0),n["\u0275\u0275listener"]("click",function(){return t.addField()}),n["\u0275\u0275text"](1," Add dependent field\n"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](2,Wt,4,4,"div",1)),2&e&&(n["\u0275\u0275property"]("disabled",t.isAddFieldButtonDisabled()),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",t.formArray.controls)("ngForTrackBy",t.trackByFn))},directives:[u.AdaptButtonComponent,f.NgForOf,f.NgIf,jd],styles:[".close[_ngcontent-%COMP%]{z-index:1}"]});class Bd extends c.ViewDesignerComponentModel{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.rxRecordDefinitionCacheService=this.injector.get(a.RxRecordDefinitionCacheService),this.rxFieldDefinitionService=this.injector.get(a.RxFieldDefinitionService),this.recordEditorGuid$=this.sandbox.getParentComponentGuid(d.RxViewComponentType.RecordEditor).pipe((0,r.take)(1),(0,r.shareReplay)(1)),this.recordEditorMode$=this.recordEditorGuid$.pipe((0,r.switchMap)(e=>this.sandbox.getComponentPropertyValue("mode",e))),this.recordDefinitionName$=this.recordEditorGuid$.pipe((0,r.switchMap)(e=>this.sandbox.getComponentPropertyValue("recordDefinitionName",e)),(0,r.shareReplay)(1)),this.fieldDefinitions$=this.recordDefinitionName$.pipe((0,r.switchMap)(e=>e?this.rxRecordDefinitionCacheService.getRecordDefinition(e).pipe((0,r.catchError)(e=>o.EMPTY)):(0,o.of)(null)),(0,r.distinctUntilChanged)(),(0,r.map)(e=>e&&e.fieldDefinitions?(0,m.filter)(e.fieldDefinitions,{resourceType:a.RX_RECORD_DEFINITION.resourceTypes.character}):[]),(0,r.shareReplay)(1)),this.inspectorTargetFieldOptions$=(0,o.combineLatest)([this.fieldDefinitions$,this.recordEditorMode$]).pipe((0,r.map)(([e,t])=>[(0,m.filter)(e,{resourceType:a.RX_RECORD_DEFINITION.resourceTypes.character}),t]),(0,r.map)(([e,t])=>(0,m.flow)(e=>(0,m.filter)(e,e=>{const i=this.rxFieldDefinitionService.isSystemField(e);return!i||i&&t===zs.Edit}),e=>(0,m.map)(e,e=>({name:e.name,id:String(e.id)})),e=>(0,m.sortBy)(e,"name"))(e)),(0,r.shareReplay)(1)),this.fieldsDesignData$=this.sandbox.getChildComponents(),this.fieldProperties$=this.fieldsDesignData$.pipe((0,r.map)(e=>(0,m.map)(e,e=>Object.assign(Object.assign({},e.data),{guid:e.guid})))),(0,o.combineLatest)([this.recordDefinitionName$,this.inspectorTargetFieldOptions$,this.recordEditorGuid$]).pipe((0,r.take)(1)).subscribe(([e,t,i])=>{this.sandbox.updateInspectorConfig(this.getBaseInspectorConfig(t,e,i))}),this.inspectorTargetFieldOptions$.pipe((0,r.withLatestFrom)(this.recordDefinitionName$,this.recordEditorGuid$)).subscribe(([e,t,i])=>{this.sandbox.updateInspectorConfig(this.getBaseInspectorConfig(e,t,i))}),(0,o.combineLatest)([this.sandbox.componentProperties$,this.fieldProperties$]).pipe((0,r.switchMap)(([e,t])=>this.validate(e,t))).subscribe(e=>{this.sandbox.setValidationIssues(e)})}static getInitialProperties(e){return Object.assign(Object.assign(Object.assign({},d.RX_DISABLED_PROP_DEFAULT_VALUE),d.RX_STANDARD_PROPS_DEFAULT_VALUES),e)}onFieldPropertiesChange(e){const t=this.getFieldComponentPayloads(e);this.sandbox.setChildren(t)}isFieldRequired(e){return this.fieldDefinitions$.pipe((0,r.map)(t=>{const i=e.data.fieldId&&(0,m.find)(t,{id:Number(e.data.fieldId)});return Boolean(i)&&i.fieldOption===a.RX_RECORD_DEFINITION.fieldOptions.required}))}getPropertiesByName(e){return(0,m.pick)(e,["disabled","hidden","styles",d.RX_AVAILABLE_ON_DEVICES_PROP_NAME])}validate(e,t){const i=[];if((0,m.isEmpty)(t))i.push("Field set cannot be empty.");else{const e=(0,m.filter)(t,e=>e.label);e.length!==t.length&&i.push("Display label cannot be blank."),(0,m.uniqBy)(e,"label").length!==e.length&&i.push("Display labels must be unique."),(0,m.reject)(t,e=>e.namedListDefinitionName).length&&i.push("Named list for options cannot be blank."),(0,m.reject)(t,e=>e.fieldId).length&&i.push("Field for storing selected option value cannot be blank.")}const n=i.map(e=>this.sandbox.createError(e)).concat((0,c.validateStandardProps)(e));return(0,o.of)(n)}getFieldComponentPayloads(e){return(0,m.map)(e,e=>({type:d.RxViewComponentType.SelectGroupField,guid:e.guid,data:(0,m.omit)(e,"guid")}))}getBaseInspectorConfig(e,t,i){const n={label:"General",controls:[]};return n.controls=t?[(0,c.getDisabledFieldInspectorConfig)(),...(0,c.getStandardPropsInspectorConfigs)()]:[{component:l.ValidationFormControlComponent,options:{text:"You must select a Record definition before editing field component.",propertyName:"recordDefinitionName",componentGuid:i}}],{inspectorSectionConfigs:t?[n,{label:"Field set",controls:[{component:_d,options:{targetFieldOptions:e}}]}]:[n]}}}class $d{trackByFn(e,t){return t.data.guid}}$d.\u0275fac=function(e){return new(e||$d)},$d.\u0275cmp=n["\u0275\u0275defineComponent"]({type:$d,selectors:[["rx-select-group-design"]],inputs:{model:"model"},decls:4,vars:4,consts:[[3,"ngIf","ngIfElse"],["placeholderTemplate",""],["ngModel","","rx-id","select-group-field","class","form-group d-block",3,"label","required","disabled",4,"ngFor","ngForOf","ngForTrackBy"],["ngModel","","rx-id","select-group-field",1,"form-group","d-block",3,"label","required","disabled"],["type","objects","label","Add dependent fields in the Properties panel."]],template:function(e,t){if(1&e&&(n["\u0275\u0275template"](0,Qt,2,4,"ng-template",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275template"](2,Jt,1,0,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e){const e=n["\u0275\u0275reference"](3);n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](1,2,t.model.fieldsDesignData$).length)("ngIfElse",e)}},directives:[f.NgIf,f.NgForOf,u.AdaptRxTextfieldComponent,b.NgControlStatus,b.NgModel,b.RequiredValidator,u.AdaptEmptyStateComponent],pipes:[f.AsyncPipe],encapsulation:2});class Ld{}Ld.\u0275fac=function(e){return new(e||Ld)},Ld.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ld,declarations:[$d,_d,jd],imports:[b.FormsModule,f.CommonModule,u.AdaptButtonModule,b.ReactiveFormsModule,l.RxDefinitionPickerModule,u.AdaptRxTextfieldModule,u.AdaptRxSelectModule,u.AdaptEmptyStateModule],exports:[$d,_d,jd]}),Ld.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[b.FormsModule,f.CommonModule,u.AdaptButtonModule,b.ReactiveFormsModule,l.RxDefinitionPickerModule,u.AdaptRxTextfieldModule,u.AdaptRxSelectModule,u.AdaptEmptyStateModule]]});class Gd{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.SelectGroup,componentFactory:this.componentFactoryResolver.resolveComponentFactory(Td),properties:[d.RX_AVAILABLE_ON_DEVICES_PROP_DESC],outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName}],name:"Select group",designComponentFactory:t.resolveComponentFactory($d),designComponentModel:Bd,isContainerComponent:!0,group:Ml,icon:"field_dropdowns",options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId},{type:d.RxViewComponentType.SelectGroupField,componentFactory:this.componentFactoryResolver.resolveComponentFactory(Vd),properties:El,isDataComponent:!0})}}Gd.\u0275fac=function(e){return new(e||Gd)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Gd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Gd,imports:[kd,Ld]}),Gd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[kd,Ld]]});class qd extends Pl{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.fieldResourceTypes=[a.RX_RECORD_DEFINITION.resourceTypes.character],this.translateService=this.injector.get(p.TranslateService)}static getInitialProperties(e){return Object.assign(Object.assign(Object.assign({},Pl.getInitialProperties()),{enableMultiSelection:null,additionalQueryCriteria:null}),e)}getInspectorConfig(){return this.selectedFieldDefinition$.pipe((0,r.switchMap)(e=>super.getInspectorConfig().pipe((0,r.map)(t=>(null==e?void 0:e.namedListDefinition)?this.getNamedListInspectorConfig(t,e):t))))}getNamedListInspectorConfig(e,t){const i=new c.NamedListFilterExpressionConfigurator(t,this.injector),n={name:"enableMultiSelection",component:l.SwitchFormControlComponent,options:{label:"Enable multi-selection"}},o=[{name:"namedListDefinitionName",component:l.RxDefinitionPickerComponent,isDisabled:!0,options:{label:this.translateService.instant("com.bmc.arsys.rx.client.definition-type.named-list.label"),definitionType:l.RX_DEFINITION_PICKER.definitionTypes.namedList.type}},{name:"additionalQueryCriteria",component:l.ExpressionFormControlComponent,options:{label:"Additional named list filter",tooltip:new s.Tooltip("Build a filter to apply at runtime in addition to the filter, if any, specified in the named list definition."),dataDictionary$:i.getDataDictionary(),operators:i.getOperators()}}];return e.inspectorSectionConfigs[0].controls.push(n),e.inspectorSectionConfigs[0].controls.push(...o),this.sandbox.updateComponentProperties({namedListDefinitionName:t.namedListDefinition}),e}getPropertiesByName(e){return(0,m.omit)(super.getPropertiesByName(e),"namedListDefinitionName")}}class Ud{}Ud.\u0275fac=function(e){return new(e||Ud)},Ud.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Ud,selectors:[["rx-character-field-design"]],inputs:{model:"model"},decls:3,vars:7,consts:[["ngModel","",1,"rx-pointer-events-none",3,"required","label","disabled"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-rx-textfield",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275pipe"](2,"async")),2&e&&n["\u0275\u0275property"]("required",n["\u0275\u0275pipeBind1"](1,3,t.model.isRequired$))("label",n["\u0275\u0275pipeBind1"](2,5,t.model.label$))("disabled",!0)},directives:[u.AdaptRxTextfieldComponent,b.NgControlStatus,b.NgModel,b.RequiredValidator],pipes:[f.AsyncPipe],encapsulation:2});class zd{}zd.\u0275fac=function(e){return new(e||zd)},zd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:zd,declarations:[Ud],imports:[f.CommonModule,u.AdaptRxTextfieldModule,b.FormsModule]}),zd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptRxTextfieldModule,b.FormsModule]]});class Xd extends c.RxViewComponentExpressionConfigurator{constructor(e,t,i){super(e,t,i),this.injector=e,this.componentGuid=t,this.componentModel=i;const n=this.componentModel.selectedFieldDefinition$.pipe((0,r.filter)(e=>Boolean(e.namedListDefinition)),(0,r.switchMap)(e=>new c.NamedListFilterExpressionConfigurator(e,this.injector).getDataDictionary()));this.configureForProperty({propertyPath:"additionalQueryCriteria",dataDictionary$:n,operators:s.ExpressionOperatorRowsByGroup.get(s.ExpressionOperatorGroup.AllServer)})}}!function(e){e.Enabled="true",e.Disabled="false"}(Md||(Md={}));class Wd extends kl{constructor(e,t,i,n){super(e),this.fieldDefinitionService=t,this.rxNamedListDefinitionService=i,this.rxNamedListService=n,this.optionLoaderFunc=this.getNamedListOptionPage.bind(this),this.viewToModelValueAdapterFunc=this.viewToModelValueAdapter.bind(this),this.modelToViewValueAdapterFunc=this.modelToViewValueAdapter.bind(this),this.selectedOptions=[],this.multiSelectDelimiter=";",this.isDropdownOpen=!1}onConfigInitialized(e){if(super.onConfigInitialized(e),this.isPasswordField=(0,m.includes)(a.RX_RECORD_DEFINITION.passwordFieldIds,this.fieldId)||this.fieldDefinition.shouldPersistHashed,this.namedListDefinitionName=this.fieldDefinition.namedListDefinition,this.isNamedListAttached=Boolean(this.namedListDefinitionName),this.isMultipleSelectionEnabled=e.enableMultiSelection===Md.Enabled,this.fieldDefinition.maxLength&&!this.fieldDefinitionService.isSystemField(this.fieldDefinition)&&(this.maxLength=this.fieldDefinition.maxLength),this.isNamedListAttached){const e=this.rxNamedListDefinitionService.get(this.namedListDefinitionName).pipe((0,r.shareReplay)(1),(0,r.take)(1)),t=this.formControl.valueChanges.pipe((0,r.distinctUntilChanged)(m.isEqual),(0,r.startWith)(this.formControl.value),(0,r.filter)(()=>!this.isDropdownOpen),(0,r.takeUntil)(this.destroyed$));this.config.pipe((0,r.debounceTime)(250),(0,r.pluck)("additionalQueryCriteria"),(0,r.distinctUntilChanged)(),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{(0,m.isNil)(this.additionalQueryCriteria)||(this.selectWithPaginationComponent.resetLoadedOptions(),this.setFieldValue(null)),this.additionalQueryCriteria=e}),(0,o.combineLatest)([e,t]).subscribe(([e])=>{this.namedListDefinition=e,this.updateSelection()})}}getDisplayValue(){let e=super.getDisplayValue();return this.isPasswordField?e="********":this.isNamedListAttached&&(e=this.namedListFormattedValue),e}getNamedListOptionPage(e,t,i){return this.rxNamedListService.getOptionPage(this.namedListDefinition,i,this.additionalQueryCriteria,e,t)}viewToModelValueAdapter(e){return this.selectedOptions=e,this.updateNamedListFormattedValue(),e.map(e=>e.value).join(this.multiSelectDelimiter)}modelToViewValueAdapter(e){return e?this.selectedOptions:[]}onToggleDropdown(e){this.isDropdownOpen=e}getOptionValues(e){return e?(0,m.compact)(e.split(this.multiSelectDelimiter)):[]}updateSelection(){this.showDefaultTitle=!1;const e=this.getOptionValues(this.formControl.value);if(!this.isMultipleSelectionEnabled&&e.length>1)this.selectedOptions=[{displayValue:null,value:this.formControl.value}],this.triggerModelToViewValueUpdate(),this.updateNamedListFormattedValue();else{const t=(0,m.get)(this.selectWithPaginationComponent,"options",[]);(e.every(e=>t.find(t=>t.value===e))?(0,o.of)(t):this.rxNamedListService.getOptionsForValues(this.namedListDefinition,e)).subscribe(t=>{this.showDefaultTitle=!0,!this.isMultipleSelectionEnabled&&e.length>1?this.selectedOptions=[{displayValue:null,value:this.formControl.value}]:this.selectedOptions=e.map(e=>(0,m.find)(t,{value:e})||{displayValue:null,value:e}),this.formControl.dirty&&this.formControl.markAsTouched(),this.triggerModelToViewValueUpdate(),this.updateNamedListFormattedValue()})}}updateNamedListFormattedValue(){if(this.isMultipleSelectionEnabled){const e=50;this.namedListFormattedValue=this.selectedOptions.slice(0,e).map(e=>e.displayValue).filter(Boolean).join(", ")||null,this.selectedOptions.length>=e&&(this.namedListFormattedValue+="...")}else this.namedListFormattedValue=this.selectedOptions.length?(0,m.first)(this.selectedOptions).displayValue:null}triggerModelToViewValueUpdate(){this.formControl.setValue(this.formControl.value,{emitEvent:!1})}}Wd.\u0275fac=function(e){return new(e||Wd)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](a.RxFieldDefinitionService),n["\u0275\u0275directiveInject"](E.RxNamedListDefinitionService),n["\u0275\u0275directiveInject"](E.RxNamedListService))},Wd.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Wd,selectors:[["rx-text-field"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](l.RxSelectWithPaginationComponent,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.selectWithPaginationComponent=e.first)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:5,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],["namedListOptionTemplate",""],[3,"label","value",4,"ngIf","ngIfElse"],[3,"label","value"],[3,"label","isPassword","formControl","maxlength","required","readonly","disabledStyleForReadonlyState","autocomplete","requiredLabel",4,"ngIf"],[3,"showDefaultTitle","label","formControl","readonly","viewToModelValueAdapter","modelToViewValueAdapter","optionLoader","required","isMultiSelectionMode","template","toggleDropdown",4,"ngIf"],[3,"label","isPassword","formControl","maxlength","required","readonly","disabledStyleForReadonlyState","autocomplete","requiredLabel"],[3,"showDefaultTitle","label","formControl","readonly","viewToModelValueAdapter","modelToViewValueAdapter","optionLoader","required","isMultiSelectionMode","template","toggleDropdown"],["class","text-secondary text-truncate",3,"title",4,"ngIf"],[1,"text-secondary","text-truncate",3,"title"],["class","breadcrumb-item active",4,"ngFor","ngForOf"],[1,"breadcrumb-item","active"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,Yt,2,2,"ng-container",0),n["\u0275\u0275template"](1,ti,2,2,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](3,oi,2,2,"ng-template",null,2,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,S.ReadOnlyFieldComponent,u.AdaptRxTextfieldComponent,b.NgControlStatus,b.FormControlDirective,b.MaxLengthValidator,b.RequiredValidator,l.RxSelectWithPaginationComponent,f.NgForOf],pipes:[p.TranslatePipe],encapsulation:2});class Hd{}Hd.\u0275fac=function(e){return new(e||Hd)},Hd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Hd,declarations:[Wd],imports:[f.CommonModule,S.ReadOnlyFieldModule,b.ReactiveFormsModule,p.TranslateModule,l.RxSelectWithPaginationModule,u.AdaptRxTextfieldModule],exports:[Wd]}),Hd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,S.ReadOnlyFieldModule,b.ReactiveFormsModule,p.TranslateModule,l.RxSelectWithPaginationModule,u.AdaptRxTextfieldModule]]});class Qd{constructor(e,t,i){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,this.rxRecordQueryExpressionEvaluatorService=i,e.register({type:d.RxViewComponentType.Character,componentFactory:this.componentFactoryResolver.resolveComponentFactory(Wd),properties:[...El,{name:"enableMultiSelection",designType:d.ViewComponentPropertyType.Boolean},{name:"namedListDefinitionName",designType:d.ViewComponentPropertyType.String},{name:"additionalQueryCriteria",designType:d.ViewComponentPropertyType.String,enableExpressionEvaluation:!0,evaluatorService:this.rxRecordQueryExpressionEvaluatorService}],name:"Text",group:Ml,icon:"field_text",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Ud),designComponentModel:qd,expressionConfigurator:Xd,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId})}}Qd.\u0275fac=function(e){return new(e||Qd)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](d.RxRecordQueryExpressionEvaluatorService))},Qd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Qd,imports:[Hd,zd]}),Qd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Hd,zd]]});class Jd extends Pl{constructor(){super(...arguments),this.fieldResourceTypes=[a.RX_RECORD_DEFINITION.resourceTypes.character]}}class Kd{}Kd.\u0275fac=function(e){return new(e||Kd)},Kd.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Kd,selectors:[["rx-textarea-field-design"]],inputs:{model:"model"},decls:3,vars:7,consts:[["ngModel","","rows","3",1,"rx-pointer-events-none",3,"label","required","disabled"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-rx-textarea",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275pipe"](2,"async")),2&e&&n["\u0275\u0275property"]("label",n["\u0275\u0275pipeBind1"](1,3,t.model.label$))("required",n["\u0275\u0275pipeBind1"](2,5,t.model.isRequired$))("disabled",!0)},directives:[u.AdaptRxTextareaComponent,b.NgControlStatus,b.NgModel,b.RequiredValidator],pipes:[f.AsyncPipe],encapsulation:2});class Yd{}Yd.\u0275fac=function(e){return new(e||Yd)},Yd.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Yd,declarations:[Kd],imports:[f.CommonModule,u.AdaptRxTextareaModule,b.FormsModule]}),Yd.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptRxTextareaModule,b.FormsModule]]});class Zd extends kl{constructor(e,t){super(e),this.rxFieldDefinitionService=t}onConfigInitialized(e){super.onConfigInitialized(e),this.fieldDefinition.maxLength&&!this.rxFieldDefinitionService.isSystemField(this.fieldDefinition)&&(this.maxLength=this.fieldDefinition.maxLength)}}Zd.\u0275fac=function(e){return new(e||Zd)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](a.RxFieldDefinitionService))},Zd.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Zd,selectors:[["rx-textarea-field"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],[3,"label","value",4,"ngIf","ngIfElse"],[3,"label","value"],[3,"formControl","required","maxlength","rows","readonly","disabledStyleForReadonlyState","label","requiredLabel"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,ai,2,2,"ng-container",0),n["\u0275\u0275template"](1,si,2,10,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,S.ReadOnlyFieldComponent,u.AdaptRxTextareaComponent,b.NgControlStatus,b.FormControlDirective,b.RequiredValidator,b.MaxLengthValidator],pipes:[p.TranslatePipe],styles:["[_nghost-%COMP%]     textarea{resize:none}[_nghost-%COMP%]     rx-read-only-field .read-only-content{max-height:6em;overflow-y:auto;word-break:break-all;white-space:pre-wrap}"]});class ec{}ec.\u0275fac=function(e){return new(e||ec)},ec.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ec,declarations:[Zd],imports:[f.CommonModule,b.ReactiveFormsModule,S.ReadOnlyFieldModule,p.TranslateModule,u.AdaptRxTextareaModule]}),ec.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.ReactiveFormsModule,S.ReadOnlyFieldModule,p.TranslateModule,u.AdaptRxTextareaModule]]});class tc{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.Textarea,componentFactory:this.componentFactoryResolver.resolveComponentFactory(Zd),properties:El,name:"Textarea",group:Ml,icon:"area_text",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Kd),designComponentModel:Jd,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId})}}tc.\u0275fac=function(e){return new(e||tc)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},tc.\u0275mod=n["\u0275\u0275defineNgModule"]({type:tc,imports:[ec,Yd]}),tc.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[ec,Yd]]});class ic extends Pl{constructor(){super(...arguments),this.fieldResourceTypes=[a.RX_RECORD_DEFINITION.resourceTypes.timeOnly]}}class nc{constructor(){this.pickerMode=u.RxDatetimePickerMode.Time}}nc.\u0275fac=function(e){return new(e||nc)},nc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:nc,selectors:[["rx-time-field-design"]],inputs:{model:"model"},decls:3,vars:9,consts:[[1,"rx-pointer-events-none",3,"ngModel","required","disabled","mode","label","ngModelChange"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-rx-datetime",0),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.timeValue=e}),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275pipe"](2,"async"),n["\u0275\u0275elementEnd"]()),2&e&&n["\u0275\u0275property"]("ngModel",t.timeValue)("required",n["\u0275\u0275pipeBind1"](1,5,t.model.isRequired$))("disabled",!0)("mode",t.pickerMode)("label",n["\u0275\u0275pipeBind1"](2,7,t.model.label$))},directives:[u.AdaptRxDatetimeComponent,b.NgControlStatus,b.NgModel,b.RequiredValidator],pipes:[f.AsyncPipe],encapsulation:2});class oc{}oc.\u0275fac=function(e){return new(e||oc)},oc.\u0275mod=n["\u0275\u0275defineNgModule"]({type:oc,declarations:[nc],imports:[u.AdaptRxDatetimeModule,f.CommonModule,b.FormsModule]}),oc.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[u.AdaptRxDatetimeModule,f.CommonModule,b.FormsModule]]});class rc extends u.AdaptRxDatetimeAdapter{constructor(){super(...arguments),this.storeTimeFormat="HH:mm:ss"}fromModel(e){let t=null;const i=(0,D.default)(e,"LTS");return i&&i.isValid()&&(t={year:i.year(),month:i.month(),date:i.date(),hours:i.hours(),minutes:i.minutes(),seconds:i.seconds()}),t}toModel(e){return e?e.parseError?D.default.invalid().toString():(0,D.default)({hour:e.hours||0,minute:e.minutes||0,seconds:e.seconds||0}).format(this.storeTimeFormat):null}}rc.\u0275fac=function(){let e;return function(t){return(e||(e=n["\u0275\u0275getInheritedFactory"](rc)))(t||rc)}}(),rc.\u0275prov=n["\u0275\u0275defineInjectable"]({token:rc,factory:rc.\u0275fac});class ac extends kl{constructor(e,t){super(e),this.datePipe=t,this.pickerMode=u.RxDatetimePickerMode.Time}getDisplayValue(){var e;const t=super.getDisplayValue();if(t){const i=(0,D.default)(t,"LTS").toDate();return null!==(e=this.datePipe.transform(i,"mediumTime"))&&void 0!==e?e:"-"}return"-"}getFieldValidators(){return[e=>{const t=e.value?(0,D.default)(e.value,"LTS"):null;return e.value&&t&&!t.isValid()?{rxDatetimeFormat:{mode:this.pickerMode,hasSeconds:!0}}:null}]}}ac.\u0275fac=function(e){return new(e||ac)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](f.DatePipe))},ac.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ac,selectors:[["rx-time-field"]],features:[n["\u0275\u0275ProvidersFeature"]([{provide:u.AdaptRxDatetimeAdapter,useClass:rc}]),n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],[3,"label","value",4,"ngIf","ngIfElse"],[3,"label","value"],["hasSeconds","true",3,"label","required","formControl","readonly","disabledStyleForReadonlyState","mode"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,di,2,2,"ng-container",0),n["\u0275\u0275template"](1,ci,1,6,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,S.ReadOnlyFieldComponent,u.AdaptRxDatetimeComponent,b.RequiredValidator,b.NgControlStatus,b.FormControlDirective],encapsulation:2});class sc{}sc.\u0275fac=function(e){return new(e||sc)},sc.\u0275mod=n["\u0275\u0275defineNgModule"]({type:sc,declarations:[ac],imports:[u.AdaptRxDatetimeModule,f.CommonModule,S.ReadOnlyFieldModule,p.TranslateModule,b.ReactiveFormsModule]}),sc.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[f.DatePipe],imports:[[u.AdaptRxDatetimeModule,f.CommonModule,S.ReadOnlyFieldModule,p.TranslateModule,b.ReactiveFormsModule]]});class lc{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.Time,componentFactory:this.componentFactoryResolver.resolveComponentFactory(ac),properties:El,name:"Time",group:Ml,icon:"clock_o",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(nc),designComponentModel:ic,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId})}}lc.\u0275fac=function(e){return new(e||lc)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},lc.\u0275mod=n["\u0275\u0275defineNgModule"]({type:lc,imports:[sc,oc]}),lc.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[sc,oc]]});class dc extends h.BaseViewComponent{constructor(e,t){super(),this.rxRecordDefinitionCacheService=e,this.rxRecordDefinitionService=t,this.recordDefinitions={}}ngOnInit(){super.ngOnInit(),this.config.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.state=e})}loadRecordDefinition(e){this.rxRecordDefinitionCacheService.getRecordDefinition(e).subscribe(t=>{t.fieldDefinitionsById=this.rxRecordDefinitionService.buildFieldDefinitionsByIdMap(t),this.recordDefinitions[e]=t,this.notifyPropertyChanged("recordDefinitions",this.recordDefinitions)})}}dc.\u0275fac=function(e){return new(e||dc)(n["\u0275\u0275directiveInject"](a.RxRecordDefinitionCacheService),n["\u0275\u0275directiveInject"](a.RxRecordDefinitionService))},dc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:dc,selectors:[["rx-extension-container"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[[3,"hidden"]],template:function(e,t){1&e&&n["\u0275\u0275element"](0,"rx-runtime-view-canvas-outlet",0),2&e&&n["\u0275\u0275property"]("hidden",t.state.hidden)},directives:[h.RuntimeViewCanvasOutletComponent],encapsulation:2});class cc{getSelectionFieldOptionNamesByIdExpression(e){return`${e}:selectionFieldOptionNamesById`}}cc.\u0275fac=function(e){return new(e||cc)},cc.\u0275prov=n["\u0275\u0275defineInjectable"]({token:cc,factory:cc.\u0275fac});class pc extends h.BaseViewComponent{constructor(e,t,i,n,o){super(),this.rxExtensionContainerComponent=e,this.rxRecordInstanceService=t,this.rxRecordEditorUtilsService=i,this.rxExtensionContainerHelperService=n,this.recordEditorComponent=o,this.isInitialized=!1,this.selectionFieldOptionNamesById=null}ngOnInit(){super.ngOnInit(),(0,o.combineLatest)([this.config,this.recordEditorComponent.recordInstanceChanged$.pipe((0,r.startWith)(null))]).pipe((0,r.takeUntil)(this.destroyed$)).subscribe(([e,t])=>{if(e.recordDefinitionName&&this.rxExtensionContainerComponent.loadRecordDefinition(e.recordDefinitionName),!e.associationDefinitionName)return this.isInitialized=!0;if(e.api){let t=null;this.recordEditorComponent.state.mode===zs.Edit&&(t=this.recordEditorComponent.state.recordInstance.id);const i=e.api.getAssociationManager({associationDefinitionName:e.associationDefinitionName,associatedRecordNodeSide:C.RX_ASSOCIATION_DEFINITION.roles.second.value,associatedRecordInstanceId:t,recordDefinitionName:e.recordDefinitionName,allFieldIds:!0,associatedRecordPath:e.associatedRecordPath});let n;this.recordEditorComponent.state.mode===zs.Edit?n=i.loadExtensions().pipe((0,r.switchMap)(e=>(0,m.isEmpty)(i.extensions)?this.addNewRecordInstanceToExtension(i):(0,o.of)(e))):this.recordEditorComponent.state.mode!==zs.Create&&this.recordEditorComponent.state.mode!==zs.Temporary||(n=(0,o.forkJoin)([i.initialize(),this.addNewRecordInstanceToExtension(i)])),n.pipe((0,r.tap)(()=>{this.isInitialized=!0}),(0,r.switchMap)(()=>{const e=i.extensions$.pipe((0,r.map)(e=>e[0]),(0,r.tap)(e=>this.updateSelectionFieldOptionNames(e)),(0,r.shareReplay)(1));return e.pipe((0,r.switchMap)(e=>e.fieldValueChanged$),(0,r.withLatestFrom)(e))}),(0,r.takeUntil)(this.destroyed$)).subscribe(([e,t])=>{this.updateSelectionFieldOptionNames(t)})}})}addNewRecordInstanceToExtension(e){return this.rxRecordInstanceService.getNew(e.options.recordDefinitionName).pipe((0,r.tap)(t=>{t.isNewInstance=!0,e.addExtension(t)}))}updateSelectionFieldOptionNames(e){if((0,m.get)(e,"recordDefinition.fieldDefinitions")){const t=this.rxRecordEditorUtilsService.getSelectionFieldOptionNames(e.recordDefinition,e);if(!(0,m.isEqual)(this.selectionFieldOptionNamesById,t)){const e=this.rxExtensionContainerHelperService.getSelectionFieldOptionNamesByIdExpression(this.guid);this.rxExtensionContainerComponent.notifyPropertyChanged(e,t)}}}}pc.\u0275fac=function(e){return new(e||pc)(n["\u0275\u0275directiveInject"](dc),n["\u0275\u0275directiveInject"](a.RxRecordInstanceService),n["\u0275\u0275directiveInject"](il),n["\u0275\u0275directiveInject"](cc),n["\u0275\u0275directiveInject"](sl))},pc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:pc,selectors:[["rx-extension-container-section"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:4,vars:4,consts:[[4,"ngIf"]],template:function(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"h5"),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](3,pi,1,0,"rx-runtime-view-canvas-outlet",0)),2&e){let e;n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](null==(e=n["\u0275\u0275pipeBind1"](2,2,t.config))?null:e.label),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.isInitialized)}},directives:[f.NgIf,h.RuntimeViewCanvasOutletComponent],pipes:[f.AsyncPipe],encapsulation:2});const mc={type:d.RxViewComponentType.ExtensionContainer,recordDefinitionsReferencingExpression:"recordDefinitions",extensionContainerSectionComponent:"rx-extension-container-section"};class uc{constructor(e,t,i,n,o,r,a,s,l,d){this.rxViewDefinitionParserService=e,this.rxViewDefinitionDataPageService=t,this.rxGlobalCacheService=i,this.rxDefinitionNameService=n,this.rxTreeService=o,this.rxExtensionContainerHelperService=r,this.rxNotificationService=a,this.rxRuntimeViewUtilsService=s,this.rxViewDefinitionLocalizationService=l,this.translateService=d}adaptDefinition(e,t){const i=this.getTargetRecordEditorComponentDefinition(t,e);return e.propertiesByName.mode=i.propertiesByName.mode,this.getExtensionViewDefinitions(e.guid).pipe((0,r.map)(this.getViewDefinitionMap.bind(this)),(0,r.map)(this.filterDuplicatedRecordEditorComponentDefinitions.bind(this)),(0,r.map)(e=>this.filterIncompatibleRecordEditorComponentDefinitions(e,i)),(0,r.switchMap)(this.setRecordEditorLabels.bind(this)),(0,r.map)(this.getExtensionRecordEditorComponentDefinitions.bind(this)),(0,r.switchMap)(n=>{const a=()=>{e.componentDefinitions=[],e.resourceType=d.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent,(0,m.forEach)(n,t=>{this.processRecordEditorComponentDefinition(t,i,e),e.componentDefinitions.push(this.getExtensionContainerSectionViewComponentDefinition(t,i))});const t=e.componentDefinitions.map(e=>e.guid);return e.layout=JSON.stringify({outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName,columns:[{children:t}]}]}),n},s=n.map(e=>(0,o.combineLatest)([...this.rxRuntimeViewUtilsService.runAdaptersForComponents(t,e)]));return(0,o.combineLatest)(s).pipe((0,r.tap)({complete:()=>a()}))}))}getExtensionViewDefinitions(e){return this.rxViewDefinitionDataPageService.get({params:{propertySelection:["name","targetExtensionContainerGuid","targetViewDefinitionName","componentDefinitions","localizableStringsByComponentId","lastUpdateTime"],viewType:d.ViewDefinitionType.Regular,targetExtensionContainerGuid:e,excludeExtensionViews:!1},headers:{"default-bundle-scope":""}}).pipe((0,r.map)(e=>{const t=[];return(0,m.forEach)(e.data,e=>{var i;this.rxViewDefinitionLocalizationService.applyLocalization(e);const n=null===(i=e.componentDefinitions[0])||void 0===i?void 0:i.propertiesByName.associationDefinitionName;(0,m.isString)(n)&&(t.includes(n)?this.rxNotificationService.addWarningMessage(this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-editor.extension-container.duplicate-extensions.warning")):t.push(n))}),e.data}))}getTargetRecordEditorComponentDefinition(e,t){return this.rxViewDefinitionParserService.findParentComponentDefinition(e,t,e=>e.type===d.RxViewComponentType.RecordEditor)}getViewDefinitionMap(e){return(0,m.reduce)(e,(e,t)=>{const i=t.componentDefinitions[0];return i&&e.push({viewDefinition:t,recordEditorComponentDefinition:i}),e},[])}filterDuplicatedRecordEditorComponentDefinitions(e){return(0,m.values)((0,m.reduce)(e,(e,t)=>{if(!t.recordEditorComponentDefinition.propertiesByName.associationDefinitionName)return e[t.recordEditorComponentDefinition.guid]=t,e;const i=[t.recordEditorComponentDefinition.propertiesByName.recordDefinitionName,t.recordEditorComponentDefinition.propertiesByName.associationDefinitionName].join("");return e[i]?(0,D.default)(t.viewDefinition.lastUpdateTime)<(0,D.default)(e[i].viewDefinition.lastUpdateTime)&&(e[i]=t):e[i]=t,e},{}))}filterIncompatibleRecordEditorComponentDefinitions(e,t){return(0,m.filter)(e,e=>{const i=e.recordEditorComponentDefinition.propertiesByName.mode===t.propertiesByName.mode,n=t.propertiesByName.recordDefinitionName===e.recordEditorComponentDefinition.propertiesByName.recordDefinitionName,o=e.recordEditorComponentDefinition.propertiesByName.associationDefinitionName;return n&&!o&&i||o&&i})}setRecordEditorLabels(e){return(0,o.forkJoin)([...e.map(e=>{let t;return t=e.recordEditorComponentDefinition.propertiesByName.label?(0,o.of)(e.recordEditorComponentDefinition.propertiesByName.label):this.rxGlobalCacheService.getBundleFriendlyName(this.rxDefinitionNameService.getBundleId(e.viewDefinition.name)),t.pipe((0,r.map)(t=>(e.recordEditorComponentDefinition.propertiesByName.label=t,e)))})])}getExtensionRecordEditorComponentDefinitions(e){return(0,m.map)(e,"recordEditorComponentDefinition")}processRecordEditorComponentDefinition(e,t,i){return this.rxTreeService.flattenTree(e,"componentDefinitions").forEach(n=>{this.patchFieldComponentExpressions(n,e,t,i)}),e}patchFieldComponentExpressions(e,t,i,n){const o=t.propertiesByName.associationDefinitionName?[i.guid,".","recordInstance.associationInstances['",t.propertiesByName.associationDefinitionName,"'].",C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.value,".extensions[0]"].join(""):[i.guid,".recordInstance"].join(""),r=[o,".recordDefinitionName"].join(""),a=t.propertiesByName.associationDefinitionName?[n.guid,".",mc.recordDefinitionsReferencingExpression,"['",t.propertiesByName.recordDefinitionName,"']"].join(""):[i.guid,".recordDefinition"].join(""),s=[o,".id"].join("");let l;l=t.propertiesByName.associationDefinitionName?[n.guid,".",this.rxExtensionContainerHelperService.getSelectionFieldOptionNamesByIdExpression(t.guid)].join(""):`${i.guid}.selectionFieldOptionNamesById`;const d=[{regExp:new RegExp(t.guid+".recordInstanceId","g"),expression:s},{regExp:new RegExp(t.guid+".recordInstance","g"),expression:o},{regExp:new RegExp(t.guid+".recordDefinitionName","g"),expression:r},{regExp:new RegExp(t.guid+".recordDefinition","g"),expression:a},{regExp:new RegExp(t.guid+".selectionFieldOptionNamesById","g"),expression:l},{regExp:new RegExp(`${t.guid}\\.(\\w+)}`,"g"),expression:`${i.guid}.$1}`}];["disabled","hidden","value","html"].filter(t=>(0,m.isString)(e.propertiesByName[t])).forEach(t=>{(0,m.forEach)(d,i=>{e.propertiesByName[t]=e.propertiesByName[t].replace(i.regExp,i.expression)})}),e.propertiesByName.api=`\${view.components.${i.guid}.api}`,e.propertiesByName.inReadState=`\${view.components.${i.guid}.inReadState}`,t.propertiesByName.associationDefinitionName&&(e.propertiesByName.associatedRecordPath=[t.propertiesByName.associationDefinitionName,C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.value,"extensions",0]),e.propertiesByName.recordInstance&&(e.propertiesByName.recordInstance=["${view.components.",o,"}"].join("")),e.propertiesByName.recordDefinition&&(e.propertiesByName.recordDefinition=["${view.components.",a,"}"].join(""))}getExtensionContainerSectionViewComponentDefinition(e,t){return{guid:e.guid,type:mc.extensionContainerSectionComponent,layout:e.layout,resourceType:d.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent,componentDefinitions:e.componentDefinitions,propertiesByName:{label:e.propertiesByName.label,styles:e.propertiesByName.styles,recordDefinitionName:e.propertiesByName.recordDefinitionName,associationDefinitionName:e.propertiesByName.associationDefinitionName,[d.RX_AVAILABLE_ON_DEVICES_PROP_NAME]:e.propertiesByName[d.RX_AVAILABLE_ON_DEVICES_PROP_NAME],api:`\${view.components.${t.guid}.api}`,associatedRecordPath:[e.propertiesByName.associationDefinitionName,C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.value,"extensions",0]}}}}uc.\u0275fac=function(e){return new(e||uc)(n["\u0275\u0275inject"](d.RxViewDefinitionParserService),n["\u0275\u0275inject"](d.RxViewDefinitionDataPageService),n["\u0275\u0275inject"](s.RxGlobalCacheService),n["\u0275\u0275inject"](s.RxDefinitionNameService),n["\u0275\u0275inject"](v.RxTreeService),n["\u0275\u0275inject"](cc),n["\u0275\u0275inject"](s.RxNotificationService),n["\u0275\u0275inject"](h.RxRuntimeViewUtilsService),n["\u0275\u0275inject"](d.RxViewDefinitionLocalizationService),n["\u0275\u0275inject"](p.TranslateService))},uc.\u0275prov=n["\u0275\u0275defineInjectable"]({token:uc,factory:uc.\u0275fac});class fc{constructor(e,t){this.rxDefinitionAdapterRegistryService=e,this.rxExtensionContainerDefinitionAdapterService=t,e.registerRuntimeAdapter(mc.type,this.rxExtensionContainerDefinitionAdapterService)}}fc.\u0275fac=function(e){return new(e||fc)(n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService),n["\u0275\u0275inject"](uc))},fc.\u0275mod=n["\u0275\u0275defineNgModule"]({type:fc,declarations:[dc,pc],imports:[f.CommonModule,h.RuntimeViewCanvasModule],exports:[dc]}),fc.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[uc,cc],imports:[[f.CommonModule,h.RuntimeViewCanvasModule]]});class hc extends c.ViewDesignerComponentModel{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.componentProperties$=this.sandbox.componentProperties$,this.parentGuid$=this.sandbox.getParentComponentGuid(d.RxViewComponentType.RecordEditor).pipe((0,r.take)(1)),this.initialProperties=Object.assign({name:"",recordDefinition:"",recordInstance:""},d.RX_STANDARD_PROPS_DEFAULT_VALUES),(0,o.combineLatest)([this.parentGuid$,this.componentProperties$]).pipe((0,r.first)()).subscribe(([e,t])=>{const i=Object.assign(Object.assign(Object.assign({},this.initialProperties),t),{recordInstance:`\${view.components.${e}.recordInstance}`,recordDefinition:`\${view.components.${e}.recordDefinition}`});this.sandbox.updateComponentProperties(i),this.sandbox.updateInspectorConfig(this.getInspectorConfig())}),(0,o.combineLatest)([this.sandbox.getComponentPropertyValue("name").pipe((0,r.map)(e=>{if((0,m.isEmpty)(e))return this.sandbox.createError("Name cannot be blank.","name")})),this.sandbox.getComponentPropertyValue("styles").pipe((0,r.map)(c.validateCssClassNames)),this.sandbox.getComponentPropertyValue(d.RX_AVAILABLE_ON_DEVICES_PROP_NAME).pipe((0,r.map)(c.validateAvailableOnDevicesProp))]).pipe((0,r.map)(m.flatten),(0,r.map)(m.compact),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>this.sandbox.setValidationIssues(e))}getInspectorConfig(){return{inspectorSectionConfigs:[{label:"General",controls:[{name:"name",component:l.TextFormControlComponent,options:{label:"Name",required:!0,tooltip:new s.Tooltip("Enter a name to uniquely identify the Extension container")}},...(0,c.getStandardPropsInspectorConfigs)()]}]}}}class gc{}gc.\u0275fac=function(e){return new(e||gc)},gc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:gc,selectors:[["rx-extension-container-design"]],inputs:{model:"model"},decls:1,vars:0,consts:[["type","objects","label","Contains fields from extensions of the record definition."]],template:function(e,t){1&e&&n["\u0275\u0275element"](0,"adapt-empty-state",0)},directives:[u.AdaptEmptyStateComponent],encapsulation:2});class vc{}vc.\u0275fac=function(e){return new(e||vc)},vc.\u0275mod=n["\u0275\u0275defineNgModule"]({type:vc,declarations:[gc],imports:[f.CommonModule,u.AdaptEmptyStateModule]}),vc.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptEmptyStateModule]]});class yc{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,this.rxViewComponentRegistryService.register({type:mc.type,componentFactory:this.componentFactoryResolver.resolveComponentFactory(dc),properties:d.RX_STANDARD_PROPS_DESC,outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName}],name:"Extension container",group:Ml,icon:"widget",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(gc),designComponentModel:hc,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId},{type:mc.extensionContainerSectionComponent,componentFactory:this.componentFactoryResolver.resolveComponentFactory(pc),properties:[{name:"api",enableExpressionEvaluation:!0}],outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName}]})}}yc.\u0275fac=function(e){return new(e||yc)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},yc.\u0275mod=n["\u0275\u0275defineNgModule"]({type:yc,imports:[fc,vc]}),yc.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[fc,vc]]});class xc extends Pl{constructor(){super(...arguments),this.fieldResourceTypes=[a.RX_RECORD_DEFINITION.resourceTypes.character]}getInspectorConfig(){return super.getInspectorConfig().pipe((0,r.withLatestFrom)(this.availableFieldDefinitions$),(0,r.map)(([e,t])=>{const i=t.filter(e=>!e.maxLength).map(e=>({id:String(e.id),name:e.name})),n=(0,m.cloneDeep)(e);return n.inspectorSectionConfigs[0].controls[0].options.options=[...i],n}))}}class bc{constructor(e){this.rxCkEditorConfiguratorService=e,this.ckEditorType="divarea",this.ckEditorConfig=this.rxCkEditorConfiguratorService.getCKEditorConfig()}}bc.\u0275fac=function(e){return new(e||bc)(n["\u0275\u0275directiveInject"](d.RxCkEditorConfiguratorService))},bc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:bc,selectors:[["rx-rich-textarea-field-design"]],inputs:{model:"model"},decls:8,vars:9,consts:[["class","form-control-required",4,"ngIf"],[1,"mt-1"],[3,"type","config","readOnly"],[1,"form-control-required"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"strong"),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"async"),n["\u0275\u0275template"](4,mi,2,0,"span",0),n["\u0275\u0275pipe"](5,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](6,"div",1),n["\u0275\u0275element"](7,"ckeditor",2),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,5,t.model.label$)," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](5,7,t.model.isRequired$)),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("type",t.ckEditorType)("config",t.ckEditorConfig)("readOnly",!0))},directives:[f.NgIf,M.CKEditorComponent],pipes:[f.AsyncPipe],styles:["ckeditor[_ngcontent-%COMP%]     .cke_inner{box-shadow:none}"]});class Cc{}Cc.\u0275fac=function(e){return new(e||Cc)},Cc.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Cc,declarations:[bc],imports:[f.CommonModule,M.CKEditorModule]}),Cc.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,M.CKEditorModule]]});class Sc extends kl{constructor(e,t){super(e),this.rxCkEditorConfiguratorService=t,this.ckEditorType="divarea",this.ckEditorConfig=this.rxCkEditorConfiguratorService.getCKEditorConfig()}setFieldValue(e,t={}){null===this.formControl.value&&""===e||super.setFieldValue(e)}onBlur(){this.formControl.markAsTouched()}}Sc.\u0275fac=function(e){return new(e||Sc)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](d.RxCkEditorConfiguratorService))},Sc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Sc,selectors:[["rx-rich-textarea-field"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],["class","read-only-content-wrapper focusable","tabindex","0",4,"ngIf","ngIfElse"],["tabindex","0",1,"read-only-content-wrapper","focusable"],[3,"config","type","readOnly","ngModel"],[3,"label","showRequiredLabel"],[3,"data","config","type","readOnly","dataChange","blur"],[3,"errors","controlTouched"],["adaptRxFeedbackRef",""]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,fi,2,2,"ng-container",0),n["\u0275\u0275template"](1,hi,5,10,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,M.CKEditorComponent,b.NgControlStatus,b.NgModel,u.AdaptRxControlLabelComponent,u.AdaptRxFeedbackComponent],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}ckeditor[_ngcontent-%COMP%]     .cke_inner{box-shadow:none}.read-only-content-wrapper[_ngcontent-%COMP%]   ckeditor[_ngcontent-%COMP%]     .cke{border:none}.read-only-content-wrapper[_ngcontent-%COMP%]   ckeditor[_ngcontent-%COMP%]     .cke_top{display:none}.read-only-content-wrapper[_ngcontent-%COMP%]   ckeditor[_ngcontent-%COMP%]     .cke_editable{padding:0}.has-danger[_ngcontent-%COMP%]     .cke{border-color:#f83200}']});class wc{}wc.\u0275fac=function(e){return new(e||wc)},wc.\u0275mod=n["\u0275\u0275defineNgModule"]({type:wc,declarations:[Sc],imports:[f.CommonModule,b.FormsModule,u.AdaptRxFormControlModule,p.TranslateModule,b.ReactiveFormsModule,M.CKEditorModule]}),wc.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.FormsModule,u.AdaptRxFormControlModule,p.TranslateModule,b.ReactiveFormsModule,M.CKEditorModule]]});class Dc{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.RichTextarea,properties:El,componentFactory:this.componentFactoryResolver.resolveComponentFactory(Sc),name:"Rich text area",icon:"text_colorpicker_adapt",group:Ml,designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(bc),designComponentModel:xc,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId})}}Dc.\u0275fac=function(e){return new(e||Dc)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Dc.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Dc,imports:[Cc,wc]}),Dc.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Cc,wc]]});class Rc extends kl{constructor(e,t,i){super(e),this.rxModalService=t,this.rxLocalizationService=i}onConfigUpdated(e){super.onConfigUpdated(e);const t=this.getFieldValue();if(this.hideCurrentLocale=this.getFieldInstanceProp("hideCurrentLocale"),e.value===t){const e=this.getFieldInstanceProp("valueByLocale");e[this.rxLocalizationService.currentLocale]=t,this.setFieldInstanceProp("valueByLocale",e)}}shouldShowValidationError(){return this.isRequired&&!this.formControl.value&&(this.formControl.touched||this.formControl.dirty)}selectLocalizedValue(){const e=this.getFieldInstanceProp("valueByLocale");this.rxModalService.openModal({title:this.translateService.instant("com.bmc.arsys.rx.client.view-components.localized-character-field.dialog.title"),data:{fieldDefinition:this.fieldDefinition,valueByLocale:(0,m.cloneDeep)(e),hideCurrentLocale:this.hideCurrentLocale},size:"sm",content:l.LocalizedCharacterFieldValueModalComponent}).then(e=>{e&&this.setLocalizedFieldValue(e.valueByLocale,e.currentLocaleValue)}).catch(m.noop)}setLocalizedFieldValue(e,t){const i=this.rxLocalizationService.currentLocale,n=t||e[i]||e["en-US"],o=this.getFieldInstanceProp("valueByLocale");(0,m.isEqual)(e,o)||(this.setFieldInstanceProp("valueByLocale",e),this.formControl.markAsDirty(),this.recordEditorApi.markAsDirty()),this.setFieldValue(n)}}Rc.\u0275fac=function(e){return new(e||Rc)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](S.RxModalService),n["\u0275\u0275directiveInject"](s.RxLocalizationService))},Rc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Rc,selectors:[["rx-localized-character-field"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:1,consts:[[4,"ngIf"],["editStateElementRef",""],[3,"label","value",4,"ngIf","ngIfElse"],[3,"label","value"],[1,"d-flex","justify-content-between"],[3,"label","id","showRequiredLabel"],["type","button",1,"localize-button","btn","btn-link","focusable","d-icon-left-pencil","p-0",3,"disabled","click"],[1,"mb-0",3,"readonly","formControl","disabledStyleForReadonlyState","required"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,vi,2,2,"ng-container",0),n["\u0275\u0275template"](1,yi,6,15,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,S.ReadOnlyFieldComponent,u.AdaptRxControlLabelComponent,u.AdaptRxTextfieldComponent,b.NgControlStatus,b.FormControlDirective,b.RequiredValidator],pipes:[p.TranslatePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.localize-button[_ngcontent-%COMP%]:hover{text-decoration:underline}[_nghost-%COMP%]     .form-control-feedback{color:#f83200}[_nghost-%COMP%]     .has-danger .form-control{border-color:#f83200!important}']});class Ic{}Ic.\u0275fac=function(e){return new(e||Ic)},Ic.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ic,declarations:[Rc],imports:[f.CommonModule,b.FormsModule,u.AdaptRxFormControlModule,S.ReadOnlyFieldModule,u.AdaptTooltipModule,u.AdaptButtonModule,p.TranslateModule,u.AdaptBusyModule,S.RxBusyIndicatorModule,u.AdaptRxTextfieldModule,b.ReactiveFormsModule]}),Ic.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.FormsModule,u.AdaptRxFormControlModule,S.ReadOnlyFieldModule,u.AdaptTooltipModule,u.AdaptButtonModule,p.TranslateModule,u.AdaptBusyModule.forRoot(),S.RxBusyIndicatorModule,u.AdaptRxTextfieldModule,b.ReactiveFormsModule]]});class Fc extends Pl{constructor(){super(...arguments),this.fieldResourceTypes=[a.RX_RECORD_DEFINITION.resourceTypes.localizedCharacter]}}class Ec{}Ec.\u0275fac=function(e){return new(e||Ec)},Ec.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Ec,selectors:[["rx-localized-character-field-design"]],inputs:{model:"model"},decls:5,vars:7,consts:[["type","button",1,"btn","float-end","p-0","btn-link","d-icon-left-pencil"],["ngModel","",1,"rx-pointer-events-none",3,"label","required","disabled"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"button",0),n["\u0275\u0275text"](1,"Localize"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](2,"adapt-rx-textfield",1),n["\u0275\u0275pipe"](3,"async"),n["\u0275\u0275pipe"](4,"async")),2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("label",n["\u0275\u0275pipeBind1"](3,3,t.model.label$))("required",n["\u0275\u0275pipeBind1"](4,5,t.model.isRequired$))("disabled",!0))},directives:[u.AdaptRxTextfieldComponent,b.NgControlStatus,b.NgModel,b.RequiredValidator],pipes:[f.AsyncPipe],encapsulation:2});class Mc{}Mc.\u0275fac=function(e){return new(e||Mc)},Mc.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Mc,declarations:[Ec],imports:[f.CommonModule,u.AdaptRxTextfieldModule,b.FormsModule]}),Mc.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptRxTextfieldModule,b.FormsModule]]});class Ac{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.LocalizedCharacter,componentFactory:this.componentFactoryResolver.resolveComponentFactory(Rc),properties:El,name:"Localized text",icon:"field_text_mapmarker",group:Ml,designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Ec),designComponentModel:Fc,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),bundleId:s.RX_APPLICATION.platformBundleId})}}Ac.\u0275fac=function(e){return new(e||Ac)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Ac.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ac,imports:[Ic,Mc]}),Ac.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Ic,Mc]]});class Oc{}var Pc,Tc;Oc.\u0275fac=function(e){return new(e||Oc)},Oc.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Oc,imports:[Ol,Ll,Ql,id,dd,gd,Cd,Pd,tc,Gd,Qd,lc,yc,Ac,Dc],exports:[Ol,Ll,Ql,id,dd,gd,Cd,Pd,tc,Gd,Qd,lc,yc,Ac,Dc]}),Oc.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Ol,Ll,Ql,id,dd,gd,Cd,Pd,tc,Gd,Qd,lc,yc,Ac,Dc],Ol,Ll,Ql,id,dd,gd,Cd,Pd,tc,Gd,Qd,lc,yc,Ac,Dc]}),function(e){e.Xsmall="450",e.Small="650",e.Medium="800",e.Large="1024",e.Xlarge="1200",e.Xxlarge="1600"}(Pc||(Pc={})),function(e){e.Default="false",e.Left="Left",e.Right="Right",e.Center="Center"}(Tc||(Tc={}));const Vc=[{name:"visible",defaultValue:!0,label:"Visible"},{name:"sortable",defaultValue:!0,label:"Sortable",tooltip:new s.Tooltip("Sorting will be disabled for character fields longer than 4000 characters.")},{name:"filterable",defaultValue:!0,label:"Filterable"},{name:"searchable",label:"Searchable",defaultValue:!0},{name:"width",label:"",defaultValue:null,options:{label:"Width",defaultUnit:"px",units:[{name:"pixels",id:"px"},{name:"percent",id:"%"}],stepperOptionByUnits:{px:{minValue:1},"%":{minValue:1,maxValue:100}}}},{name:"wrapText",defaultValue:!1,label:"Wrap text"},{name:"alignment",defaultValue:!1,label:"Alignment",selectionValues:[{name:"Align left",value:Tc.Left,icon:"d-icon-align_left_adapt"},{name:"Center",value:Tc.Center,icon:"d-icon-align_center_adapt"},{name:"Align right",value:Tc.Right,icon:"d-icon-align_right_adapt"}]},{name:"typeaheadKeystrokeCount",label:"",defaultValue:1,options:{label:"Typeahead keystroke count",options:[{id:0,name:"0"},{id:1,name:"1"},{id:2,name:"2"},{id:3,name:"3"},{id:4,name:"4"},{id:5,name:"5"}],emptyOption:!1}}],Nc={type:"rx-record-grid",version:"1.0",defaultColumnMinWidth:45,defaultRowHeight:37,components:{filter:"rx-record-grid-filter",column:"rx-record-grid-column",filterPreset:"rx-record-grid-filter-preset",viewPreset:"rx-record-grid-view-preset",columnViewPreset:"rx-record-grid-column-view-preset"},columnAlignment:{left:"Left",right:"Right",center:"Center"},selectionTypes:{multiple:"multiple",single:"single"},userPreferences:{filters:"filters",columns:"columns"},cardLayoutWidthOptions:[{id:Pc.Xsmall,name:"Extra Small (450px)"},{id:Pc.Small,name:"Small (650px)"},{id:Pc.Medium,name:"Medium (800px)"},{id:Pc.Large,name:"Large (1024px)"},{id:Pc.Xlarge,name:"Extra Large (1200px)"},{id:Pc.Xxlarge,name:"Extra Extra Large (1600px)"}],actionsColumnProperties:[{name:"visible",defaultValue:!0,label:"Visible"}],columnProperties:Vc,sharedFilterPresets:{recordDefinitionName:"Record Grid Filter Presets",fields:{recordGridGuid:300000001,name:300000002,filterExpression:300000003,sortOrder:300000004,isDefault:300000005}},defaultFilter:"{}",associatedFieldIdPrefixPattern:d.RX_EXPRESSION_EVALUATOR.associatedFieldIdPrefixPattern,defaultPageSize:50,rowActionsOutletName:"ROW_ACTIONS",actionsColumnFieldDefinition:{name:"Actions",id:"$ACTIONS$"},numberOfFiltersOptions:[{id:0,name:"None"},{id:1,name:"1"},{id:2,name:"2"},{id:3,name:"3"},{id:4,name:"4"},{id:5,name:"5"}],defaultTypeaheadKeystrokeCount:1,externalPresetFilterOptionId:"$EXTERNAL_PRESET$"};class kc{constructor(e,t,i,n,o){this.rxLogService=e,this.rxRecordDefinitionCacheService=t,this.stringService=i,this.rxDefinitionNameService=n,this.rxFieldDefinitionService=o}getColumnDescriptors(e,t){return this.rxRecordDefinitionCacheService.getRecordDefinition(e).toPromise().then(e=>{if((0,m.isFunction)(t.getColumns)){const i=t.getColumns().map((e,t)=>({fieldId:e.field,index:t,title:e.header,fieldDefinition:e.fieldDefinition}));return Promise.all(i.filter(e=>this.isAssociatedRecordFieldId(e.fieldId)).map(t=>this.getAssociationDescriptor(t.fieldId,e).toPromise().then(e=>{t.associationDescriptor=e}))).then((0,m.constant)(i))}return e.fieldDefinitions.map((e,t)=>({fieldId:e.id,index:t,title:e.name,fieldDefinition:e}))})}getAssociationDescriptors(e){return(0,o.forkJoin)([this.rxRecordDefinitionCacheService.getRecordAssociationDefinitions(e),this.rxRecordDefinitionCacheService.getRecordDefinition(e)]).pipe((0,r.map)(([t,i])=>{const n=[];return(0,m.forEach)(t[e],t=>{const o=t.cardinality===C.RX_ASSOCIATION_DEFINITION.cardinality.oneToMany.value;t.cardinality===C.RX_ASSOCIATION_DEFINITION.cardinality.manyToMany.value||(this.isNeedSide(t.nodeBId,e,i)&&n.push({associationDefinition:t,recordDefinitionName:t.nodeAId,nodeSide:C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA.value,label:this.getAssociationLabel(t,C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA)}),this.isNeedSide(t.nodeAId,e,i)&&!o&&n.push({associationDefinition:t,recordDefinitionName:t.nodeBId,nodeSide:C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.value,label:this.getAssociationLabel(t,C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB)}))}),(0,m.sortBy)(n,"label")}))}getFieldDefinition(e,t){const i=this.getFieldLocator(e),n=new o.AsyncSubject;let a;return i.fieldId===Nc.actionsColumnFieldDefinition.id?(0,o.of)(Nc.actionsColumnFieldDefinition):(a=i.associationGuid?this.getAssociationDescriptors(t.name).pipe((0,r.map)(e=>this.findAssociationDescriptor(e,i)),(0,r.filter)(e=>Boolean(e)),(0,r.map)(e=>e.associationDefinition[C.RX_ASSOCIATED_RECORD_NODE_SIDES[e.nodeSide].recordDefinitionNameKey]),(0,r.switchMap)(e=>this.rxRecordDefinitionCacheService.getRecordDefinition(e))).toPromise():Promise.resolve(t),a.then(e=>{let t;e&&(t=(0,m.find)(e.fieldDefinitions,{id:Number(i.fieldId)||i.fieldId})),n.next(t),n.complete()}),n)}isAssociatedRecordFieldId(e){return!(0,m.some)(this.getFieldLocator(e),m.isUndefined)}getFieldIdForGridColumn(e,t){return t?`recordContext._associations.${t.associationDefinition.guid}.${t.nodeSide}[0].${e}`:String(e)}getAssociationDescriptor(e,t){const i=this.getFieldLocator(e);let n=(0,o.of)(null);return i.associationGuid&&(n=this.getAssociationDescriptors(t.name).pipe((0,r.map)(e=>this.findAssociationDescriptor(e,i)))),n}getDisplayFieldDescriptor(e,t,i){const n=this.getFieldLocator(e);return this.isAssociatedRecordFieldId(e)?this.rxRecordDefinitionCacheService.getRecordDefinition(i).pipe((0,r.map)(e=>{const t=n.fieldId===String(a.RX_RECORD_DEFINITION.coreFieldIds.id),i=String(t&&e.displayFieldIdInAssociation||n.fieldId);return(0,m.find)(e.fieldDefinitions,e=>String(e.id)===i)})):(0,o.of)((0,m.find)(t.fieldDefinitions,t=>String(t.id)===e))}getColumnLabel(e,t){return t?`${t.label} > ${e.name}`:e.name}findAssociationDescriptor(e,t){return(0,m.find)(e,e=>e.associationDefinition.guid===t.associationGuid&&e.nodeSide===t.associationNodeSide)}getFieldLocator(e){const t=new RegExp("(?:"+Nc.associatedFieldIdPrefixPattern+")?(.+)").exec(e);return{associationGuid:t[1],associationNodeSide:t[2],fieldId:t[3]}}isNeedSide(e,t,i){return(0,m.includes)([t,(0,m.get)(i,"inheritanceDescriptor.inheritingFrom")],e)}getAssociationLabel(e,t){let i,n=this.rxDefinitionNameService.getDisplayName(e.name);return e.nodeAId===e.nodeBId&&(t===C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA&&(i=e.nodeAName),t===C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB&&(i=e.nodeBName),i=i||t.defaultName,n+=" ("+i+")"),n}isSharedFilterPresetTag(e){return e.data.isSharedFilterPreset}getTestIdForGridColumn(e){if(this.isAssociatedRecordFieldId(e)){const t=this.getFieldLocator(e);return`field-id-${t.associationGuid}-${t.fieldId}`}return`field-id-${e}`}isSearchable(e,t){return(0,m.includes)([a.RX_RECORD_DEFINITION.dataTypes.character.resourceType,a.RX_RECORD_DEFINITION.dataTypes.localizedCharacter.resourceType,a.RX_RECORD_DEFINITION.dataTypes.integer.resourceType,a.RX_RECORD_DEFINITION.dataTypes.decimal.resourceType,a.RX_RECORD_DEFINITION.dataTypes.real.resourceType],e.resourceType)&&!this.rxFieldDefinitionService.isPassword(e)&&!this.rxFieldDefinitionService.isSecured(e)&&!this.rxFieldDefinitionService.isDataProviderIdField(e,t)}}var jc,_c,Bc,$c;kc.\u0275fac=function(e){return new(e||kc)(n["\u0275\u0275inject"](s.RxLogService),n["\u0275\u0275inject"](a.RxRecordDefinitionCacheService),n["\u0275\u0275inject"](v.RxStringService),n["\u0275\u0275inject"](s.RxDefinitionNameService),n["\u0275\u0275inject"](a.RxFieldDefinitionService))},kc.\u0275prov=n["\u0275\u0275defineInjectable"]({token:kc,factory:kc.\u0275fac,providedIn:"root"}),function(e){e.Asc="asc",e.Desc="desc"}(jc||(jc={}));class Lc{constructor(e){this.rxJsonParserService=e}parseConfigString(e){return!!e&&(!!(0,m.includes)(["1","true"],e)||!(0,m.includes)(["0","false"],e)&&((0,m.isString)(e)?this.rxJsonParserService.tryParseJson(e,!1):((0,m.isObject)(e)||!!(0,m.isBoolean)(e))&&e))}getBooleanValue(e){return this.parseConfigString(e)}getColumnSortOrder(e){return e===jc.Asc?A.SortOrder.Asc:A.SortOrder.Desc}getColumnSortDirection(e){return e===A.SortOrder.Asc?jc.Asc:jc.Desc}configDeepClone(e){const t=(0,m.cloneDeep)((0,m.omit)(e,["columns"])),i=this.columnsDeepClone(e.columns);return(0,m.assign)(t,{columns:i})}columnsDeepClone(e){return(0,m.map)(e,this.columnDeepClone)}columnDeepClone(e){const t=(0,m.cloneDeep)((0,m.omit)(e,["cellTemplate"]));return(0,m.assign)(t,{cellTemplate:e.cellTemplate})}}Lc.\u0275fac=function(e){return new(e||Lc)(n["\u0275\u0275inject"](v.RxJsonParserService))},Lc.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Lc,factory:Lc.\u0275fac,providedIn:"root"});class Gc{trackByForAlignmentOptions(e,t){return t||e}}Gc.\u0275fac=function(e){return new(e||Gc)},Gc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Gc,selectors:[["rx-column-editor-alignment"]],inputs:{column:"column",isReadOnly:"isReadOnly",columnProperty:"columnProperty"},decls:2,vars:2,consts:[["data-toggle","buttons",1,"btn-group","py-2","btn-group-toggle"],[3,"class","active","disabled","adaptTooltip",4,"ngFor","ngForOf","ngForTrackBy"],[3,"adaptTooltip"],["size","small","type","radio","name","selectionValue.name",3,"value","ngModel","disabled","ngModelChange"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275template"](1,xi,2,13,"label",1),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",t.columnProperty.selectionValues)("ngForTrackBy",t.trackByForAlignmentOptions))},directives:[f.NgForOf,u.AdaptTooltipDirective,b.RadioControlValueAccessor,b.DefaultValueAccessor,b.NgControlStatus,b.NgModel],styles:[".alignment-field[_ngcontent-%COMP%]{min-width:140px}"]}),function(e){e.Small="small",e.Large="large"}(_c||(_c={})),function(e){e.Primary="primary",e.Secondary="secondary",e.Light="light",e.Active="active",e.Info="info",e.Success="success",e.Warning="warning",e.Danger="danger"}(Bc||(Bc={})),function(e){e.Left="left",e.Right="right",e.ReplaceText="replaceText"}($c||($c={}));const qc={[Bc.Primary]:"text-primary",[Bc.Secondary]:"text-secondary",[Bc.Light]:"text-white",[Bc.Active]:"text-active",[Bc.Info]:"text-info",[Bc.Success]:"text-success",[Bc.Warning]:"text-warning",[Bc.Danger]:"text-danger"},Uc={[Bc.Primary]:"bg-primary",[Bc.Secondary]:"bg-secondary",[Bc.Active]:"bg-active",[Bc.Info]:"bg-info",[Bc.Success]:"bg-success",[Bc.Warning]:"bg-warning",[Bc.Danger]:"bg-danger"},zc={colorsList:[{label:"Default",value:null},{label:"Primary",value:Bc.Primary},{label:"Secondary",value:Bc.Secondary},{label:"Light",value:Bc.Light},{label:"Active",value:Bc.Active},{label:"Information",value:Bc.Info},{label:"Success",value:Bc.Success},{label:"Warning",value:Bc.Warning},{label:"Danger",value:Bc.Danger}],iconPositions:[{label:"Left",value:$c.Left},{label:"Right",value:$c.Right},{label:"Replace text",value:$c.ReplaceText}],fontSizes:[{label:"Default",value:null},{label:"Small",value:_c.Small},{label:"Large",value:_c.Large}]};class Xc extends s.RxExpressionConfigurator{cellDisplayExpressionDataDictionary(e){return e.length?(0,o.of)(e.map(e=>({label:e.label,icon:"d-icon-field_text",expression:`\${view.components.grid.clickableRow.${e.fieldId}}`,resourceType:e.fieldDefinition.resourceType}))):(0,o.of)([])}}class Wc extends S.RxModalClass{constructor(e,t,i,n,r){super(e,r),this.activeModalRef=e,this.rxExpressionEditorService=t,this.formBuilder=i,this.translateService=n,this.injector=r,this.destroyed$=new o.ReplaySubject(1),this.config=this.activeModalRef.getData(),this.propsFormArray=this.formBuilder.array([]),this.iconPositions=zc.iconPositions,this.textColors=zc.colorsList,this.fontSizes=zc.fontSizes,this.colorsList=Uc,this.backgroundColors=zc.colorsList.filter(e=>e.value!==Bc.Light),this.badgeColors=zc.colorsList.filter(e=>![Bc.Light,Bc.Active,null].includes(e.value)),this.iconPickerOptions={label:"Icon",appendToBody:!0,required:!1}}ngOnInit(){super.ngOnInit(),this.expressionConfigurator=new Xc,this.expressionConfigurator.configureForProperty({propertyPath:"cellDisplayProperties",dataDictionary$:this.expressionConfigurator.cellDisplayExpressionDataDictionary(this.config.columns),operators:this.expressionConfigurator.getOperatorRowsByGroup(s.ExpressionOperatorGroup.AllClient)}),this.queryExpressionOptions={label:"Field value condition",dataDictionary$:this.expressionConfigurator.getDataDictionary("cellDisplayProperties"),operators:this.expressionConfigurator.getOperators("cellDisplayProperties"),isRequired:!0},(0,m.forEach)(this.config.cellDisplayProperties,e=>this.propsFormArray.push(this.getFormGroup(e)))}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}addCellProperties(){this.markAsDirty(),this.propsFormArray.push(this.getFormGroup({fieldValueCondition:"",displayAsBadge:!1,badgeColor:null,icon:null,iconPosition:null,textColor:null,backgroundColor:null,fontSize:null,bold:!1,italic:!1,isOpen:!0})),setTimeout(()=>{this.accordionTabEls.last.nativeElement.scrollIntoView({block:"nearest"})})}removeCellProperties(e){this.propsFormArray.removeAt(e),this.markAsDirty()}optionFormatter(e){return e.label}getFormGroup(e){var t;const i=this.formBuilder.group({fieldValueCondition:[e.fieldValueCondition,b.Validators.required],displayAsBadge:[e.displayAsBadge],badgeColor:{value:this.getSelectValue(this.badgeColors,"value",e.badgeColor),disabled:!e.displayAsBadge},icon:{value:e.icon,disabled:e.displayAsBadge},iconPosition:{value:this.getSelectValue(this.iconPositions,"value",e.iconPosition),disabled:!e.icon},textColor:{value:this.getSelectValue(this.textColors,"value",e.textColor),disabled:e.displayAsBadge},backgroundColor:{value:this.getSelectValue(this.backgroundColors,"value",e.backgroundColor),disabled:e.displayAsBadge},fontSize:{value:this.getSelectValue(this.fontSizes,"value",e.fontSize),disabled:e.displayAsBadge},bold:[e.bold],italic:[e.italic],isOpen:[null!==(t=e.isOpen)&&void 0!==t&&t]});return i.controls.displayAsBadge.valueChanges.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{e&&i.controls.badgeColor.disabled&&i.controls.badgeColor.reset({value:[this.badgeColors[0]],disabled:!1}),!e&&i.controls.badgeColor.enabled&&i.controls.badgeColor.reset({value:[],disabled:!0})}),i.controls.icon.valueChanges.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{e&&i.controls.iconPosition.disabled&&i.controls.iconPosition.reset({value:[this.iconPositions[0]],disabled:!1}),!e&&i.controls.iconPosition.enabled&&i.controls.iconPosition.reset({value:[],disabled:!0})}),i}getSelectValue(e,t,i){const n=e.find(e=>e[t]===i);return n?[n]:[]}openExpressionEditor(e){this.rxExpressionEditorService.openEditor({property:{path:"cellDisplayProperties",value:e.value,label:"Cell display properties"},isReadOnly:!1,expressionConfigurator:this.expressionConfigurator,legend:[{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.column.label"),icon:"d-icon-field_text"}]}).subscribe(t=>{e.setValue(t.value),this.markAsDirty()})}moveCellProperties(e,t){(0,x.moveItemInArray)(this.propsFormArray.controls,e,t),this.markAsDirty()}onSelectedCellPropertyDrop(e){(0,x.moveItemInArray)(this.propsFormArray.controls,e.previousIndex,e.currentIndex),this.markAsDirty()}toggleProp(e){e.setValue(!e.value),this.markAsDirty()}toggleOpen(e){this.propsFormArray.controls.forEach(t=>{t.get("isOpen").setValue(e)})}resetIconAndTextProps(e){const t=e.get("displayAsBadge").value;e.get("icon").reset({value:null,disabled:t}),e.get("textColor").reset({value:[this.textColors[0]],disabled:t}),e.get("backgroundColor").reset({value:[this.backgroundColors[0]],disabled:t}),e.get("fontSize").reset({value:[this.fontSizes[0]],disabled:t}),e.get("bold").reset({value:!1,disabled:t}),e.get("italic").reset({value:!1,disabled:t})}onSave(){const e=this.propsFormArray.getRawValue().map(e=>Object.assign(Object.assign({},e),{icon:(0,m.get)(e,"icon",null),badgeColor:(0,m.get)(e,"badgeColor[0].value",null),iconPosition:(0,m.get)(e,"iconPosition[0].value",null),textColor:(0,m.get)(e,"textColor[0].value",null),backgroundColor:(0,m.get)(e,"backgroundColor[0].value",null),fontSize:(0,m.get)(e,"fontSize[0].value",null)})).map(e=>Object.assign({},(0,m.omit)(e,"isOpen")));this.activeModalRef.close(e)}cancel(){this.activeModalRef.dismiss(u.DismissReasons.CLOSE_BTN)}}Wc.\u0275fac=function(e){return new(e||Wc)(n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](l.RxExpressionEditorService),n["\u0275\u0275directiveInject"](b.FormBuilder),n["\u0275\u0275directiveInject"](p.TranslateService),n["\u0275\u0275directiveInject"](n.Injector))},Wc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Wc,selectors:[["rx-cell-display-properties-editor"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](u.AdaptAccordionTabComponent,5,n.ElementRef),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.accordionTabEls=e)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:18,vars:10,consts:[[1,"designer-modal-body","modal-body","d-flex","mh-100"],[1,"row","flex-grow-1","w-100"],[1,"d-flex","flex-column","mh-100","col"],[1,"d-flex","align-items-start","justify-content-between"],["class","pl-0 pr-0","rx-id","add-button","adapt-button","","type","button","btn-type","tertiary",3,"click",4,"ngIf"],["adaptPopover","Cell display properties will be applied based on the first field value condition evaluating to true.","placement","bottom","appendToBody","true",1,"d-icon-right-question_circle_o","ml-1","mt-1"],["class","btn-group",4,"ngIf"],["id","selected-cell-property","class","designer-modal-accordion-wrapper","cdkDropList","",3,"cdkDropListDropped",4,"ngIf"],["class","d-flex justify-content-center h-100 align-items-center mt-2",4,"ngIf"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click",4,"ngIf"],["adapt-button","","btn-type","secondary","type","button","rx-id","cancel-button",3,"click"],["optionTemplate",""],["rx-id","add-button","adapt-button","","type","button","btn-type","tertiary",1,"pl-0","pr-0",3,"click"],[1,"d-icon-left-plus_circle"],[1,"btn-group"],["adapt-button","","btn-type","tertiary","type","button","rx-id","expand-all-button",3,"click"],["adapt-button","","btn-type","tertiary","type","button","rx-id","collapse-all-button",3,"click"],["id","selected-cell-property","cdkDropList","",1,"designer-modal-accordion-wrapper",3,"cdkDropListDropped"],[3,"multiselect"],["class","designer-modal-accordion-content","cdkDrag","","cdkDragLockAxis","y",3,"cdkDragData","cdkDragDisabled",4,"ngFor","ngForOf"],["cdkDrag","","cdkDragLockAxis","y",1,"designer-modal-accordion-content",3,"cdkDragData","cdkDragDisabled"],["class","designer-modal-drag-handle d-icon-left-dots","cdkDragHandle","",4,"ngIf"],[1,"d-block",3,"formGroup","isOpen","open","close"],[1,"card-title-text","w-100"],[1,"designer-modal-card-title-content"],[1,"left-header-block"],["rx-id","card-title",1,"rx-ellipsis",3,"title"],["class","right-header-block",4,"ngIf"],[1,"row"],["formControlName","fieldValueCondition","rx-id","query-expression-field",1,"form-group","d-block","col-12",3,"options","events"],[1,"row","form-group"],[1,"col-3"],[3,"label"],["formControlName","displayAsBadge",3,"disabled","ngModelChange"],["formControlName","badgeColor",1,"d-block","col-3",3,"label","disabled","options","optionFormatter","optionContentTemplate","ngModelChange"],["formControlName","icon",1,"d-block","col-3",3,"disabled","options","ngModelChange"],["formControlName","iconPosition",1,"d-block","col-3",3,"label","disabled","options","optionFormatter","ngModelChange"],["formControlName","textColor",1,"d-block","col-3",3,"label","disabled","options","optionFormatter","optionContentTemplate","ngModelChange"],["formControlName","backgroundColor",1,"d-block","col-3",3,"label","disabled","options","optionFormatter","optionContentTemplate","ngModelChange"],["formControlName","fontSize",1,"d-block","col-3",3,"label","disabled","options","optionFormatter","ngModelChange"],[1,"col-3","pt-4","d-flex","align-item-center"],["data-toggle","buttons",1,"btn-group","btn-group-toggle"],[1,"btn","btn-secondary","d-icon-bold_adapt",3,"ngClass"],["type","checkbox","name","fontStyle",3,"disabled","click"],[1,"btn","btn-secondary","ml-2","d-icon-italic_adapt",3,"ngClass"],["cdkDragHandle","",1,"designer-modal-drag-handle","d-icon-left-dots"],[1,"right-header-block"],[1,"designer-modal-card-title-index-buttons"],["type","button","rx-id","move-down-button",1,"d-icon-left-triangle_down","rx-button-unstyled",3,"disabled","click"],["type","button","rx-id","move-up-button",1,"d-icon-left-triangle_up","rx-button-unstyled",3,"disabled","click"],["adapt-button","","size","small","type","button","rx-id","remove-button",1,"d-icon-left-cross_adapt","p-1","pr-4","ml-3",3,"click"],[1,"d-flex","justify-content-center","h-100","align-items-center","mt-2"],["type","grid",1,"w-100",3,"label"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click"],[1,"d-flex","align-items-center"],[3,"ngClass"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275elementStart"](2,"div",2),n["\u0275\u0275elementStart"](3,"div",3),n["\u0275\u0275elementStart"](4,"div"),n["\u0275\u0275template"](5,bi,4,3,"button",4),n["\u0275\u0275element"](6,"span",5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](7,Ci,7,6,"div",6),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](8,Ii,3,2,"div",7),n["\u0275\u0275template"](9,Fi,3,3,"div",8),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"div",9),n["\u0275\u0275template"](11,Ei,3,4,"button",10),n["\u0275\u0275elementStart"](12,"button",11),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](13),n["\u0275\u0275pipe"](14,"translate"),n["\u0275\u0275pipe"](15,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](16,Mi,3,2,"ng-template",null,12,n["\u0275\u0275templateRefExtractor"])),2&e&&(n["\u0275\u0275advance"](5),n["\u0275\u0275property"]("ngIf",!t.config.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.propsFormArray.controls.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.propsFormArray.controls.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.propsFormArray.controls.length),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.config.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",t.config.isReadOnly?n["\u0275\u0275pipeBind1"](14,6,"com.bmc.arsys.rx.client.common.close.label"):n["\u0275\u0275pipeBind1"](15,8,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[f.NgIf,u.AdaptPopoverDirective,u.AdaptButtonComponent,x.CdkDropList,u.AdaptAccordionComponent,f.NgForOf,x.CdkDrag,u.AdaptAccordionTabComponent,b.NgControlStatusGroup,b.FormGroupDirective,l.ExpressionFormControlComponent,b.NgControlStatus,b.FormControlName,u.AdaptRxControlLabelComponent,u.AdaptRxSwitchComponent,u.AdaptRxSelectComponent,l.IconPickerFormControlComponent,f.NgClass,x.CdkDragHandle,u.AdaptEmptyStateComponent],pipes:[p.TranslatePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.designer-modal-body[_ngcontent-%COMP%]{height:645px;min-height:calc(100% - 61px)!important}.designer-modal-accordion-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:auto;padding-top:10px}.designer-modal-accordion-content[_ngcontent-%COMP%]{position:relative}.designer-modal-accordion-content.cdk-drag-preview[_ngcontent-%COMP%]{z-index:1200!important}.designer-modal-drag-handle[_ngcontent-%COMP%]{cursor:move;position:absolute;top:0;left:0;height:46px;padding:14px 10px 14px 14px;z-index:1}.designer-modal-card-title-content[_ngcontent-%COMP%]{width:100%;display:flex}.designer-modal-card-title-content[_ngcontent-%COMP%]   .left-header-block[_ngcontent-%COMP%], .designer-modal-card-title-content[_ngcontent-%COMP%]   .right-header-block[_ngcontent-%COMP%]{display:flex;align-items:center}.designer-modal-card-title-content[_ngcontent-%COMP%]   .left-header-block[_ngcontent-%COMP%]{flex-grow:1;min-width:0;font-size:14px;padding-left:22px}.designer-modal-card-sub-title[_ngcontent-%COMP%]{color:#7c7f81;font-weight:normal}.designer-modal-card-title-index-buttons[_ngcontent-%COMP%]{display:flex;font-size:19px}.rx-card[_ngcontent-%COMP%]{overflow:auto}.rx-tree-draggable-node[_ngcontent-%COMP%]{cursor:pointer}.rx-tree-draggable-node.cdk-drag-preview[_ngcontent-%COMP%]{z-index:1200!important}.rx-tree-draggable-node.cdk-drag[_ngcontent-%COMP%]{opacity:1}.rx-tree-node-label[_ngcontent-%COMP%]{word-break:break-all}rx-form-builder[_ngcontent-%COMP%]{max-width:400px}.color-option-box[_ngcontent-%COMP%]{display:inline-block;width:20px;height:20px}']});class Hc extends l.ValueAccessor{constructor(e){super(),this.rxModalService=e}openPropertiesEditor(){this.rxModalService.openModal({title:`Edit cell display properties for ${this.columnName}`,data:{cellDisplayProperties:this.value?(0,m.cloneDeep)(this.value):[],isReadOnly:this.isDisabled,columns:this.columns},content:Wc,size:d.OpenViewActionModalSize.Large,testID:"edit-cell-display-properties"}).then(e=>{this.value=e}).catch(m.noop)}}Hc.\u0275fac=function(e){return new(e||Hc)(n["\u0275\u0275directiveInject"](S.RxModalService))},Hc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Hc,selectors:[["rx-cell-display-properties"]],inputs:{columnName:"columnName",columns:"columns"},features:[n["\u0275\u0275ProvidersFeature"]([{provide:b.NG_VALUE_ACCESSOR,useExisting:Hc,multi:!0}]),n["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:2,consts:[["rx-id","open-modal-button","btn-type","tertiary",1,"px-0","py-0",3,"click"],["name","plus_circle",1,"mr-1"],["rx-id","columns"],["class","text-tertiary",4,"ngIf"],[1,"text-tertiary"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-button",0),n["\u0275\u0275listener"]("click",function(){return t.openPropertiesEditor()}),n["\u0275\u0275element"](1,"adapt-icon",1),n["\u0275\u0275text"](2," Edit cell display properties\n"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"div",2),n["\u0275\u0275template"](4,Ai,2,0,"span",3),n["\u0275\u0275template"](5,Oi,2,0,"span",3),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](4),n["\u0275\u0275property"]("ngIf",!(null!=t.value&&t.value.length)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",(null==t.value?null:t.value.length)>0))},directives:[u.AdaptButtonComponent,u.AdaptIconComponent,f.NgIf],encapsulation:2});const Qc={keywords:{label:"Keywords",children:[{label:"Current user",icon:"d-icon-dollar",expression:"$USER$"},{label:"Current date",icon:"d-icon-dollar",expression:"$DATE$"},{label:"Current time",icon:"d-icon-dollar",expression:"$TIME$"},{label:"Current date and time",icon:"d-icon-dollar",expression:"$TIMESTAMP$"},{label:"Current week day",icon:"d-icon-dollar",expression:"$WEEKDAY$"},{label:"Current groups",icon:"d-icon-dollar",expression:"$GROUPS$"},{label:"Current group IDs",icon:"d-icon-dollar",expression:"$GROUPIDS$"},{label:"Current roles",icon:"d-icon-dollar",expression:"$ROLES$"},{label:"Current user locale",icon:"d-icon-dollar",expression:"$LOCALE$"},{label:"Current server URL",icon:"d-icon-dollar",expression:"$SERVERURL$"},{label:"NULL",icon:"d-icon-dollar",expression:"$NULL$",hidden:!0}]}};class Jc extends c.RxViewExpressionConfigurator{constructor(e,t,i,n){super(e),this.injector=e,this.activeModalRef=t,this.rxViewDataDictionaryService=i,this.rxDefaultExpressionEvaluatorService=n,this.commonDataDictionary$=this.rxViewDataDictionaryService.commonDataDictionary$.pipe((0,r.map)(e=>[{expression:`'${this.activeModalRef.getData().column.fieldId}'`,icon:"d-icon-file_o_gear",label:this.activeModalRef.getData().column.title},Qc.keywords,...e.slice(2)]))}getExpressionEvaluator(){return this.rxDefaultExpressionEvaluatorService}}Jc.\u0275fac=function(e){return new(e||Jc)(n["\u0275\u0275inject"](n.Injector),n["\u0275\u0275inject"](u.ActiveModalRef),n["\u0275\u0275inject"](c.RxViewDataDictionaryService),n["\u0275\u0275inject"](d.RxDefaultExpressionEvaluatorService))},Jc.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Jc,factory:Jc.\u0275fac});class Kc extends S.RxModalClass{constructor(e,t,i,n,o,r,a){super(e,a),this.activeModalRef=e,this.rxGuidService=t,this.rxExpressionEditorService=i,this.formBuilder=n,this.translateService=o,this.expressionConfigurator=r,this.config=this.activeModalRef.getData(),this.namedFilterOptionsFormArray=this.formBuilder.array([]),this.accordionTabs={}}ngOnInit(){super.ngOnInit(),this.expressionConfigurator.configureForProperty({propertyPath:"namedFilterOptions",operators:s.ExpressionOperatorRowsByGroup.get(s.ExpressionOperatorGroup.All)}),this.queryExpressionOptions={label:"Filter",dataDictionary$:this.expressionConfigurator.getDataDictionary("namedFilterOptions"),operators:this.expressionConfigurator.getOperators("namedFilterOptions"),isRequired:!0},(0,m.forEach)(this.config.namedFilterOptions,(e,t)=>{this.accordionTabs[e.guid]=t===this.config.activeIndex,this.namedFilterOptionsFormArray.push(this.getFormGroup(e))}),this.config.isReadOnly&&this.namedFilterOptionsFormArray.disable()}ngAfterViewInit(){this.config.activeIndex&&this.accordionTabEls.toArray()[this.config.activeIndex].nativeElement.scrollIntoView({block:"nearest"})}addNamedFilterOption(){this.markAsDirty();const e=this.rxGuidService.generate();this.accordionTabs[e]=!0;let t="New filter option",i=0,n=!1;const o=(0,m.map)(this.namedFilterOptionsFormArray.getRawValue(),"title");do{t=0===i?t:`New filter option ${i}`,i++,n=(0,m.includes)(o,t)}while(n);this.namedFilterOptionsFormArray.push(this.getFormGroup({data:{title:t,filterExpression:"",index:this.namedFilterOptionsFormArray.length},guid:e})),setTimeout(()=>{this.accordionTabEls.last.nativeElement.scrollIntoView({block:"nearest"})})}removeNamedFilterOption(e){this.namedFilterOptionsFormArray.removeAt(e),this.markAsDirty()}openExpressionEditor(e,t){this.rxExpressionEditorService.openEditor({property:{path:"namedFilterOptions",value:t.value,label:e.value},isReadOnly:!1,expressionConfigurator:this.expressionConfigurator,legend:[{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.keyword.label"),icon:"d-icon-dollar"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-component-property.label"),icon:"d-icon-file_o_gear"}]}).subscribe(e=>{t.setValue(e.value),this.markAsDirty()})}moveNamedFilterOption(e,t){(0,x.moveItemInArray)(this.namedFilterOptionsFormArray.controls,e,t),this.markAsDirty()}onSelectedNamedFilterOptionDrop(e){(0,x.moveItemInArray)(this.namedFilterOptionsFormArray.controls,e.previousIndex,e.currentIndex),this.markAsDirty()}onSave(){const e=this.namedFilterOptionsFormArray.getRawValue().map(({guid:e,title:t,filterExpression:i},n)=>({guid:e,data:{title:t,filterExpression:i,index:n}}));this.activeModalRef.close(e)}cancel(){this.activeModalRef.dismiss(u.DismissReasons.CLOSE_BTN)}toggleOpen(e){(0,m.forEach)(this.accordionTabs,(t,i)=>{this.accordionTabs[i]=e})}getCheckTitleDuplicateValidator(e){return t=>{const i=t.value;return i&&this.namedFilterOptionsFormArray.controls.some(t=>t.value.title===i&&t.value.guid!==e.guid)?{duplicateFilterOptionName:{message:"Filter option with this name already exists."}}:null}}getFormGroup(e){return this.formBuilder.group({guid:e.guid,title:[e.data.title,[b.Validators.required,this.getCheckTitleDuplicateValidator(e).bind(this),e=>{var t;return(null===(t=null==e?void 0:e.value)||void 0===t?void 0:t.includes(";"))?{invalidName:{message:"A filter option name cannot contain any of the following characters: ;"}}:null}]],filterExpression:[e.data.filterExpression,b.Validators.required]})}}Kc.\u0275fac=function(e){return new(e||Kc)(n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](v.RxGuidService),n["\u0275\u0275directiveInject"](l.RxExpressionEditorService),n["\u0275\u0275directiveInject"](b.FormBuilder),n["\u0275\u0275directiveInject"](p.TranslateService),n["\u0275\u0275directiveInject"](Jc),n["\u0275\u0275directiveInject"](n.Injector))},Kc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Kc,selectors:[["rx-named-filter-options-editor-modal"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](u.AdaptAccordionTabComponent,5,n.ElementRef),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.accordionTabEls=e)}},features:[n["\u0275\u0275ProvidersFeature"]([Jc]),n["\u0275\u0275InheritDefinitionFeature"]],decls:14,vars:10,consts:[[1,"designer-modal-body","modal-body","d-flex","mh-100"],[1,"row","flex-grow-1","w-100"],[1,"d-flex","flex-column","mh-100","col"],[1,"d-flex","align-items-start","justify-content-between"],["class","mt-2 p-0","rx-id","add-button","adapt-button","","type","button","btn-type","tertiary",3,"click",4,"ngIf"],["class","btn-group",4,"ngIf"],["class","designer-modal-accordion-wrapper","cdkDropList","",3,"cdkDropListDropped",4,"ngIf"],["class","d-flex justify-content-center h-100 align-items-center mt-2",4,"ngIf"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click",4,"ngIf"],["adapt-button","","btn-type","secondary","type","button","rx-id","cancel-button",3,"click"],["rx-id","add-button","adapt-button","","type","button","btn-type","tertiary",1,"mt-2","p-0",3,"click"],[1,"d-icon-left-plus_circle"],[1,"btn-group"],["adapt-button","","btn-type","tertiary","type","button","rx-id","expand-all-button",3,"click"],["adapt-button","","btn-type","tertiary","type","button","rx-id","collapse-all-button",3,"click"],["cdkDropList","",1,"designer-modal-accordion-wrapper",3,"cdkDropListDropped"],[3,"multiselect"],["class","designer-modal-accordion-content","cdkDrag","","cdkDragLockAxis","y",3,"cdkDragData","cdkDragDisabled",4,"ngFor","ngForOf"],["cdkDrag","","cdkDragLockAxis","y",1,"designer-modal-accordion-content",3,"cdkDragData","cdkDragDisabled"],["class","designer-modal-drag-handle d-icon-left-dots","cdkDragHandle","",4,"ngIf"],[1,"d-block",3,"formGroup","isOpen"],[1,"card-title-text","w-100"],[1,"designer-modal-card-title-content"],[1,"left-header-block"],["rx-id","card-title",1,"rx-ellipsis",3,"title"],["class","right-header-block",4,"ngIf"],["rx-id","filter-option-name-field","formControlName","title","rxNoWhitespace","",1,"form-group","d-block",3,"label","required","ngModelChange"],["formControlName","filterExpression","rx-id","query-expression-field",3,"options","required","events","ngModelChange"],["cdkDragHandle","",1,"designer-modal-drag-handle","d-icon-left-dots"],[1,"right-header-block"],[1,"designer-modal-card-title-index-buttons"],["type","button","rx-id","move-down-button",1,"d-icon-left-triangle_down","rx-button-unstyled",3,"disabled","click"],["type","button","rx-id","move-up-button",1,"d-icon-left-triangle_up","rx-button-unstyled",3,"disabled","click"],["adapt-button","","size","small","type","button","rx-id","remove-button",1,"d-icon-left-cross_adapt","p-1","pr-4","ml-3",3,"click"],[1,"d-flex","justify-content-center","h-100","align-items-center","mt-2"],["type","search",1,"w-100",3,"label"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275elementStart"](2,"div",2),n["\u0275\u0275elementStart"](3,"div",3),n["\u0275\u0275template"](4,Pi,4,3,"button",4),n["\u0275\u0275template"](5,Ti,7,6,"div",5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](6,ji,3,2,"div",6),n["\u0275\u0275template"](7,_i,3,3,"div",7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](8,"div",8),n["\u0275\u0275template"](9,Bi,3,4,"button",9),n["\u0275\u0275elementStart"](10,"button",10),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](11),n["\u0275\u0275pipe"](12,"translate"),n["\u0275\u0275pipe"](13,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](4),n["\u0275\u0275property"]("ngIf",!t.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.namedFilterOptionsFormArray.controls.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.namedFilterOptionsFormArray.controls.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.namedFilterOptionsFormArray.controls.length),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.config.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",t.config.isReadOnly?n["\u0275\u0275pipeBind1"](12,6,"com.bmc.arsys.rx.client.common.close.label"):n["\u0275\u0275pipeBind1"](13,8,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[f.NgIf,u.AdaptButtonComponent,x.CdkDropList,u.AdaptAccordionComponent,f.NgForOf,x.CdkDrag,u.AdaptAccordionTabComponent,b.NgControlStatusGroup,b.FormGroupDirective,u.AdaptRxTextfieldComponent,b.NgControlStatus,b.FormControlName,v.RxNoWhitespaceValidator,b.RequiredValidator,l.ExpressionFormControlComponent,x.CdkDragHandle,u.AdaptEmptyStateComponent],pipes:[p.TranslatePipe],styles:[$i]});class Yc extends l.ValueAccessor{constructor(e){super(),this.rxModalService=e}openNamedFilterOptions(e){this.rxModalService.openModal({title:`Edit named filter options for ${this.column.title}`,data:{namedFilterOptions:this.value?(0,m.cloneDeep)(this.value):[],isReadOnly:this.isDisabled,activeIndex:e,column:this.column},content:Kc,size:d.OpenViewActionModalSize.Large,testID:"edit-named-filter-options"}).then(e=>{this.value=e}).catch(m.noop)}editNamedFilterOption(e){this.openNamedFilterOptions(e)}removeFilterOption(e){this.value=(0,m.without)(this.value,e)}}Yc.\u0275fac=function(e){return new(e||Yc)(n["\u0275\u0275directiveInject"](S.RxModalService))},Yc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Yc,selectors:[["rx-named-filter-options"]],inputs:{column:"column",tooltip:"tooltip"},features:[n["\u0275\u0275ProvidersFeature"]([{provide:b.NG_VALUE_ACCESSOR,useExisting:Yc,multi:!0}]),n["\u0275\u0275InheritDefinitionFeature"]],decls:7,vars:3,consts:[["rx-id","open-modal-button","btn-type","tertiary",1,"px-0","py-0","pb-1",3,"click"],["name","plus_circle",1,"mr-1"],["class","align-middle",4,"ngIf"],["rx-id","named-filter-options"],["class","text-tertiary",4,"ngIf"],["class","list-unstyled mb-0",4,"ngIf"],[1,"align-middle"],[1,"letter-space"],["appendToBody","true",3,"name","adaptPopover"],[1,"text-tertiary"],[1,"list-unstyled","mb-0"],["class","border px-2 py-1 mb-1 d-flex align-items-center",4,"ngFor","ngForOf"],[1,"border","px-2","py-1","mb-1","d-flex","align-items-center"],[1,"mr-auto","text-break"],["adapt-button","","btn-type","tertiary","size","small","type","button","rx-id","edit-button",1,"d-icon-left-pencil","p-1",3,"click"],["class","d-icon-left-cross_adapt p-1","adapt-button","","btn-type","tertiary","size","small","type","button","rx-id","remove-button",3,"click",4,"ngIf"],["adapt-button","","btn-type","tertiary","size","small","type","button","rx-id","remove-button",1,"d-icon-left-cross_adapt","p-1",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-button",0),n["\u0275\u0275listener"]("click",function(){return t.openNamedFilterOptions()}),n["\u0275\u0275element"](1,"adapt-icon",1),n["\u0275\u0275text"](2," Edit named filter options\n"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](3,Li,3,2,"span",2),n["\u0275\u0275elementStart"](4,"div",3),n["\u0275\u0275template"](5,Gi,2,0,"div",4),n["\u0275\u0275template"](6,zi,2,1,"ul",5),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngIf",t.tooltip),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!(null!=t.value&&t.value.length)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",(null==t.value?null:t.value.length)>0))},directives:[u.AdaptButtonComponent,u.AdaptIconComponent,f.NgIf,u.AdaptPopoverDirective,f.NgForOf],encapsulation:2});class Zc extends S.RxModalClass{constructor(e,t,i,n,o,r,a,l,d,c,p){super(e,d),this.activeModalRef=e,this.rxModalService=t,this.definitionNameService=i,this.rxRecordGridUtilsService=n,this.rxFieldDefinitionService=o,this.rxRecordDefinitionCacheService=r,this.rxGuidService=a,this.ngZone=l,this.injector=d,this.translateService=c,this.rxExpressionEditorService=p,this.columnProperties=Nc.columnProperties,this.actionsColumnProperties=Nc.actionsColumnProperties,this.filteredColumns=[],this.availableColumnsTree=[],this.startedLoadingAssociationDescriptors=!1,this.treeWrap=u.TreeWrap.WrapAll,this.columnWidthPropertyOptions=this.columnProperties.find(({name:e})=>"width"===e).options,this.typeaheadKeystrokeCountOptions=Object.assign(Object.assign({},this.columnProperties.find(({name:e})=>"typeaheadKeystrokeCount"===e).options),{tooltip:new s.Tooltip(this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid-column.keystroke-count.tooltip"))});const f=this.activeModalRef.getData().columnParams;this.activeColumn=f.activeColumn,this.activeActionIndex=f.activeActionIndex,this.recordDefinition=f.recordDefinition,this.isReadOnly=f.isReadOnly,this.columns=f.columns.map(e=>{const t=e.fieldDefinition.namedListDefinition?this.getAdditionalQueryCriteriaExpressionOptions(e):null;return Object.assign(Object.assign({},e),{isOpen:e===this.activeColumn,label:this.rxRecordGridUtilsService.getColumnLabel(e.fieldDefinition,e.associationDescriptor),clickable:!(0,m.isEmpty)(e.actions),additionalQueryCriteriaExpressionOptions:t})}).sort((e,t)=>e.index-t.index),this.getAvailableColumnsTree()}ngAfterViewInit(){this.updateSelectedColumnsDropList(),this.openActiveAction();const e=(0,m.findIndex)(this.columns,"isOpen");-1!==e&&this.accordionTabEls.toArray()[e].nativeElement.scrollIntoView({block:"nearest"})}isActionsColumn(e){return e===Nc.actionsColumnFieldDefinition.id}updateSelectedColumnsDropList(){this.updateColumnsDropList(this.draggableSelectedColumns,this.selectedColumnsDropList)}updateAssociatedAvailableColumnsDropList(){this.updateColumnsDropList(this.draggableAssociatedAvailableColumns,this.associatedAvailableColumnsDropList)}updateColumnsDropList(e,t){const i=e.toArray(),n=this.columns;i.sort((e,t)=>n.indexOf(e.data)-n.indexOf(t.data)),t._dropListRef.withItems(i.map(e=>{const i=e._dragRef;return i._initialContainer||(i._initialContainer=t._dropListRef),e._dragRef}))}cancel(){this.activeModalRef.dismiss(u.DismissReasons.CLOSE_BTN)}onDropInSelectedColumnsContainer(e){e.previousContainer!==e.container&&this.isColumnEditorAvailableColumn(e.item.data)?this.addColumn(e.item.data,e.currentIndex):e.previousIndex!==e.currentIndex&&this.moveColumn(e.previousIndex,e.currentIndex)}onColumnCheckboxPropertyChange(e,t,i){"filterable"===i.name&&t.fieldDefinition.namedListDefinition&&(e?t.typeaheadKeystrokeCount=Nc.defaultTypeaheadKeystrokeCount:(t.typeaheadKeystrokeCount=null,t.additionalQueryCriteria=null)),this.markAsDirty()}onColumnDragStarted(){this.updateSelectedColumnsDropList()}onAssociatedAvailableColumnsDragStarted(){this.onColumnDragStarted(),this.updateAssociatedAvailableColumnsDropList()}isColumnEditorAvailableColumn(e){return Boolean(e.fieldDefinitionName)}moveColumn(e,t){this.markAsDirty(),(0,x.moveItemInArray)(this.columns,e,t),this.updateColumnIndexes()}removeColumn(e){this.markAsDirty();const t=this.columns[e];this.columns.splice(e,1);const i=t.associationDescriptor?this.getAssociatedAvailableColumnsNode(t.associationDescriptor.label):this.availableColumnsTree[0];i&&i.data.allAvailableColumns&&(i.data.allAvailableColumns.push(this.getColumnMetadata(t.fieldDefinition,t.associationDescriptor)),this.updateAvailableColumnsTree())}getAssociatedAvailableColumnsNode(e){return this.availableColumnsTree.find(t=>t.data.associationDescriptor&&t.data.associationDescriptor.label===e)}getAvailableColumnsTree(){const e={children:null,leaf:!1,expanded:!0,expandedIcon:"d-icon-file_text",collapsedIcon:"d-icon-file_text",label:this.definitionNameService.getDisplayName(this.recordDefinition.name),key:this.definitionNameService.getDisplayName(this.recordDefinition.name),data:{allAvailableColumns:null}};this.startedLoadingAssociationDescriptors||(this.startedLoadingAssociationDescriptors=!0,this.rxRecordGridUtilsService.getAssociationDescriptors(this.recordDefinition.name).subscribe(t=>{(t=t.slice()).sort((e,t)=>e.label.localeCompare(t.label)),this.availableColumnsTree=t.map(e=>({children:null,leaf:!1,expandedIcon:"d-icon-arrow_schema",collapsedIcon:"d-icon-arrow_schema",label:e.label,key:e.associationDefinition.name,data:{associationDescriptor:e,allAvailableColumns:null}})),this.availableColumnsTree.unshift(e),this.availableColumnsTree.forEach(e=>{this.onNodeExpand({node:e})})}))}updateAvailableColumnsTree(){this.availableColumnsTree.forEach(e=>{const t=e.data.allAvailableColumns;if(t){const i=this.sortAvailableColumns(t),n=e.data.associationDescriptor?e.data.associationDescriptor.associationDefinition.name:this.recordDefinition.name;e.children=i.map(e=>({children:null,leaf:!0,label:e.fieldDefinitionName,key:`${n}-${e.fieldDefinition.id}`,data:{availableColumn:e}}))}})}onNodeExpand({node:e}){const t=e.data.associationDescriptor;t&&!e.data.allAvailableColumns?(e.data.allAvailableColumns=[],this.rxRecordDefinitionCacheService.getRecordDefinition(t.recordDefinitionName).subscribe(i=>{e.data.allAvailableColumns=this.getAvailableColumns(i,t),this.updateAvailableColumnsTree()})):t||(e.data.allAvailableColumns=this.getAvailableColumns(this.recordDefinition),this.updateAvailableColumnsTree())}addColumn(e,t){if(this.markAsDirty(),!(0,m.find)(this.columns,t=>t.fieldId===e.fieldId)){const i=e.fieldDefinition.namedListDefinition?this.getAdditionalQueryCriteriaExpressionOptions(e):null,n=Object.assign(Object.assign({},this.getColumnEditorColumnData(e)),{additionalQueryCriteriaExpressionOptions:i});(0,m.isNil)(t)?this.columns.push(n):this.columns.splice(t,0,n),this.updateColumnIndexes(),this.removeFromAvailableColumns(e),setTimeout(()=>{this.accordionTabEls.toArray()[null!=t?t:this.columns.length-1].nativeElement.scrollIntoView()})}}getColumnEditorColumnData(e){const t={guid:this.rxGuidService.generate(),label:e.label,fieldId:e.fieldId,associationDescriptor:e.associationDescriptor,fieldDefinition:e.fieldDefinition,actions:[],title:e.fieldDefinitionName,isOpen:!0};return(0,m.forEach)(Nc.columnProperties,i=>{"sortable"===i.name?t.sortable=e.isSortable:"searchable"===i.name?t.searchable=this.rxRecordGridUtilsService.isSearchable(e.fieldDefinition,this.recordDefinition):t[i.name]=i.defaultValue}),t}removeFromAvailableColumns(e){if(e.associationDescriptor){const t=this.getAssociatedAvailableColumnsNode(e.associationDescriptor.label);(0,m.remove)(t.data.allAvailableColumns,e)}else(0,m.remove)(this.availableColumnsTree[0].data.allAvailableColumns,e);this.updateAvailableColumnsTree()}sortAvailableColumns(e){return this.filteredColumns=e.sort((e,t)=>e.fieldDefinitionName.localeCompare(t.fieldDefinitionName)),this.filteredColumns}getAvailableColumns(e,t){return e.fieldDefinitions.map(e=>this.getColumnMetadata(e,t)).filter(e=>!(0,m.find)(this.columns,t=>t.fieldId===e.fieldId))}getColumnMetadata(e,t){return{fieldDefinitionName:e.name,label:this.rxRecordGridUtilsService.getColumnLabel(e,t),fieldId:this.rxRecordGridUtilsService.getFieldIdForGridColumn(e.id,t),isSortable:this.rxFieldDefinitionService.isSortable(e),associationDescriptor:t,fieldDefinition:e}}saveChanges(){const e={columns:this.columns.map(e=>{const t=e.filterable&&e.fieldDefinition.namedListDefinition;return{actions:e.actions,alignment:e.alignment,fieldId:e.fieldId,filterable:e.filterable,filterType:e.filterType,guid:e.guid,index:e.index,sortable:e.sortable,searchable:e.searchable,title:e.title,visible:e.visible,associationDescriptor:e.associationDescriptor,fieldDefinition:e.fieldDefinition,cellDisplayProperties:e.cellDisplayProperties,namedFilterOptions:e.namedFilterOptions,width:e.width,wrapText:e.wrapText,typeaheadKeystrokeCount:t?e.typeaheadKeystrokeCount:null,additionalQueryCriteria:t?e.additionalQueryCriteria:null}})};this.activeModalRef.close(e)}trackByForColumns(e,t){return t.fieldId}trackByForColumnProperties(e,t){return t.name}isPropertyEditable(e,t){return"searchable"===t?!this.isReadOnly&&this.rxRecordGridUtilsService.isSearchable(e.fieldDefinition,this.recordDefinition):!this.isReadOnly}updateColumnIndexes(){this.columns.forEach((e,t)=>{e.index=t})}openActiveAction(){this.activeColumn&&this.activeActionIndex>=0&&this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{const e=this.actionListControlComponents.find(e=>e.value===this.activeColumn.actions);e&&e.focus({actionIndex:this.activeActionIndex})})})}isTreeEmpty(){return(0,m.every)(this.availableColumnsTree,e=>0===e.data.allAvailableColumns.length)}openAdditionalQueryCriteriaExpressionEditor(e,t){const i=new c.NamedListFilterExpressionConfigurator(e.fieldDefinition,this.injector);this.rxExpressionEditorService.openEditor({property:{path:"additionalQueryCriteria",value:e.additionalQueryCriteria,label:"Additional named list filter"},isReadOnly:this.isReadOnly,expressionConfigurator:i,legend:[{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.function.label"),icon:"d-icon-mathematical_function"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.keyword.label"),icon:"d-icon-dollar"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-component.label"),icon:"d-icon-file_o"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-component-property.label"),icon:"d-icon-file_o_gear"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-input-parameter.label"),icon:"d-icon-arrow_right_square_input"}]}).subscribe(i=>{e.additionalQueryCriteria=i.value,t.value=i.value,t.onWriteValue(i.value),this.markAsDirty()})}getAdditionalQueryCriteriaExpressionOptions(e){const t=new c.NamedListFilterExpressionConfigurator(e.fieldDefinition,this.injector);return{label:"Additional named list filter",tooltip:new s.Tooltip("Build a filter to apply at runtime in addition to the filter, if any, specified in the named list definition."),dataDictionary$:t.getDataDictionary(),operators:t.getOperators()}}}Zc.\u0275fac=function(e){return new(e||Zc)(n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](S.RxModalService),n["\u0275\u0275directiveInject"](s.RxDefinitionNameService),n["\u0275\u0275directiveInject"](kc),n["\u0275\u0275directiveInject"](a.RxFieldDefinitionService),n["\u0275\u0275directiveInject"](a.RxRecordDefinitionCacheService),n["\u0275\u0275directiveInject"](v.RxGuidService),n["\u0275\u0275directiveInject"](n.NgZone),n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](p.TranslateService),n["\u0275\u0275directiveInject"](l.RxExpressionEditorService))},Zc.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Zc,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&(n["\u0275\u0275viewQuery"](Xi,5,x.CdkDropList),n["\u0275\u0275viewQuery"](Wi,5,x.CdkDropList),n["\u0275\u0275viewQuery"](Hi,5,x.CdkDrag),n["\u0275\u0275viewQuery"](Qi,5,x.CdkDrag),n["\u0275\u0275viewQuery"](c.ActionListControlComponent,5),n["\u0275\u0275viewQuery"](u.AdaptAccordionTabComponent,5,n.ElementRef)),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.selectedColumnsDropList=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.associatedAvailableColumnsDropList=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.draggableSelectedColumns=e),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.draggableAssociatedAvailableColumns=e),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.actionListControlComponents=e),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.accordionTabEls=e)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:18,vars:16,consts:[[1,"designer-modal-body","modal-body","d-flex","mh-100"],[1,"row","flex-grow-1","w-100"],["class","col-4 border-right d-flex flex-column mh-100",4,"ngIf"],[1,"d-flex","align-items-start","justify-content-between"],[1,"mt-2"],["id","selectedColumnsDropList","cdkDropList","",1,"designer-modal-accordion-wrapper",3,"cdkDropListData","cdkDropListDropped"],["selectedColumnsDropList","cdkDropList"],[3,"multiselect",4,"ngIf"],["class","d-flex justify-content-center h-100 align-items-center mt-2",4,"ngIf"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click",4,"ngIf"],["adapt-button","","btn-type","secondary","type","button","rx-id","cancel-button",3,"click"],[1,"col-4","border-right","d-flex","flex-column","mh-100"],[1,"rx-card","card","flex-grow-1","mt-2"],[1,"card-block","d-flex","flex-column"],["cdkDropList","","cdkDropListSortingDisabled","",3,"cdkDropListData","cdkDropListConnectedTo",4,"ngIf"],["cdkDropList","","cdkDropListSortingDisabled","",3,"cdkDropListData","cdkDropListConnectedTo"],["associatedAvailableColumnsDropList","cdkDropList"],["filter","true",3,"value","wrap","onNodeExpand"],["adaptTreeNodeTemplate",""],[3,"title",4,"ngIf"],["class","rx-tree-draggable-node","cdkDrag","",3,"cdkDragData","cdkDragStarted",4,"ngIf"],[3,"title"],["cdkDrag","",1,"rx-tree-draggable-node",3,"cdkDragData","cdkDragStarted"],["draggableAssociatedAvailableColumn",""],[3,"dblclick"],["type","button",1,"rx-button-unstyled","d-icon-plus_circle",3,"click"],[1,"rx-tree-node-label","ml-3"],[1,"d-flex","justify-content-center","h-100","align-items-center","mt-2"],["type","search",1,"w-100",3,"label"],[3,"multiselect"],["class","designer-modal-accordion-content","cdkDrag","","cdkDragLockAxis","y",3,"cdkDragData","cdkDragDisabled","cdkDragStarted",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","","cdkDragLockAxis","y",1,"designer-modal-accordion-content",3,"cdkDragData","cdkDragDisabled","cdkDragStarted"],["draggableSelectedColumn",""],["class","designer-modal-drag-handle d-icon-left-dots","cdkDragHandle","",4,"ngIf"],[1,"d-block",3,"isOpen","open","close"],[1,"card-title-text","w-100"],[1,"designer-modal-card-title-content"],[1,"left-header-block"],["rx-id","card-title",1,"rx-ellipsis",3,"title"],["class","right-header-block",4,"ngIf"],[4,"ngIf"],["dataColumnEditorTemplate",""],["actionsColumnEditorTemplate",""],["cdkDragHandle","",1,"designer-modal-drag-handle","d-icon-left-dots"],[1,"right-header-block"],[1,"designer-modal-card-title-index-buttons"],["type","button","rx-id","move-down-button",1,"d-icon-left-triangle_down","rx-button-unstyled",3,"disabled","click"],["type","button","rx-id","move-up-button",1,"d-icon-left-triangle_up","rx-button-unstyled",3,"disabled","click"],["class","d-icon-left-cross_adapt p-1 pr-4 ml-3","adapt-button","","size","small","type","button","rx-id","remove-button",3,"click",4,"ngIf"],["adapt-button","","size","small","type","button","rx-id","remove-button",1,"d-icon-left-cross_adapt","p-1","pr-4","ml-3",3,"click"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"rx-record-grid-column-editor-text-field",3,"label","disabled","ngModel","ngModelChange"],[1,"d-flex","flex-wrap"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","flex-row"],[1,"d-block","col-5","p-0",3,"options","ngModel","ngModelChange"],["class","d-block col-5 p-0 pb-2 pl-5",3,"options","ngModel","disabled","ngModelChange",4,"ngIf"],["rx-id","additional-query-criteria-expression","class","d-block p-0 pb-2",3,"options","ngModel","disabled","ngModelChange","events",4,"ngIf"],[1,"d-block","pb-2",3,"columns","columnName","disabled","ngModel","ngModelChange"],[1,"d-block","pb-2",3,"column","disabled","ngModel","tooltip","ngModelChange"],[1,"d-block",3,"disabled","ngModel","tooltip","ngModelChange"],["class","checkbox rx-record-grid-column-editor__checkbox-field",4,"ngIf"],["class","flex-fill","ngDefaultControl","",3,"isReadOnly","column","columnProperty","ngModel","ngModelChange",4,"ngIf"],[1,"checkbox","rx-record-grid-column-editor__checkbox-field"],["type","checkbox",3,"ngModel","disabled","ngModelChange"],[1,"checkbox__item"],["class","ml-1",4,"ngIf"],[1,"ml-1"],[1,"letter-space"],["appendToBody","true",3,"name","adaptPopover"],["ngDefaultControl","",1,"flex-fill",3,"isReadOnly","column","columnProperty","ngModel","ngModelChange"],[1,"d-block","col-5","p-0","pb-2","pl-5",3,"options","ngModel","disabled","ngModelChange"],["rx-id","additional-query-criteria-expression",1,"d-block","p-0","pb-2",3,"options","ngModel","disabled","ngModelChange","events"],["additionalQueryCriteriaExpression",""],[1,"rx-record-grid-column-editor-text-field","d-block","form-group",3,"label","disabled","ngModel","ngModelChange"],["class","checkbox rx-record-grid-column-editor__checkbox-field",4,"ngFor","ngForOf","ngForTrackBy"],["type","grid",1,"w-100",3,"label"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275template"](2,nn,9,5,"div",2),n["\u0275\u0275elementStart"](3,"div"),n["\u0275\u0275elementStart"](4,"div",3),n["\u0275\u0275elementStart"](5,"h4",4),n["\u0275\u0275text"](6),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](8,"div",5,6),n["\u0275\u0275listener"]("cdkDropListDropped",function(e){return t.onDropInSelectedColumnsContainer(e)}),n["\u0275\u0275template"](10,bn,2,3,"adapt-accordion",7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](11,Cn,3,3,"div",8),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](12,"div",9),n["\u0275\u0275template"](13,Sn,3,4,"button",10),n["\u0275\u0275elementStart"](14,"button",11),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](15),n["\u0275\u0275pipe"](16,"translate"),n["\u0275\u0275pipe"](17,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275classMapInterpolate1"]("d-flex flex-column mh-100 ",t.isReadOnly?"col":"col-8",""),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](7,10,"com.bmc.arsys.rx.client.view-components.record-grid-column.selected-columns.title")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("cdkDropListData",t.columns),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.columns.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.columns.length),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",t.isReadOnly?n["\u0275\u0275pipeBind1"](16,12,"com.bmc.arsys.rx.client.common.close.label"):n["\u0275\u0275pipeBind1"](17,14,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[f.NgIf,x.CdkDropList,u.AdaptButtonComponent,u.AdaptTreeComponent,u.AdaptTreeNodeTemplateDirective,x.CdkDrag,u.AdaptEmptyStateComponent,u.AdaptAccordionComponent,f.NgForOf,u.AdaptAccordionTabComponent,x.CdkDragHandle,u.AdaptRxTextfieldComponent,b.NgControlStatus,b.NgModel,l.StepperWithUnitsFormControlComponent,Hc,Yc,c.ActionListControlComponent,b.CheckboxControlValueAccessor,u.AdaptIconComponent,u.AdaptPopoverDirective,Gc,b.DefaultValueAccessor,l.SelectFormControlComponent,l.ExpressionFormControlComponent],pipes:[p.TranslatePipe],styles:[':root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.designer-modal-body{height:645px;min-height:calc(100% - 61px)!important}.designer-modal-accordion-wrapper{display:flex;flex-direction:column;height:100%;overflow:auto;padding-top:10px}.designer-modal-accordion-content{position:relative}.designer-modal-accordion-content.cdk-drag-preview{z-index:1200!important}.designer-modal-drag-handle{cursor:move;position:absolute;top:0;left:0;height:46px;padding:14px 10px 14px 14px;z-index:1}.designer-modal-card-title-content{width:100%;display:flex}.designer-modal-card-title-content .left-header-block,.designer-modal-card-title-content .right-header-block{display:flex;align-items:center}.designer-modal-card-title-content .left-header-block{flex-grow:1;min-width:0;font-size:14px;padding-left:22px}.designer-modal-card-sub-title{color:#7c7f81;font-weight:normal}.designer-modal-card-title-index-buttons{display:flex;font-size:19px}.rx-card{overflow:auto}.rx-tree-draggable-node{cursor:pointer}.rx-tree-draggable-node.cdk-drag-preview{z-index:1200!important}.rx-tree-draggable-node.cdk-drag{opacity:1}.rx-tree-node-label{word-break:break-all}rx-form-builder{max-width:400px}.rx-record-grid-column-editor__checkbox-field{flex-basis:20%;min-width:140px}.rx-record-grid-column-editor__checkbox-field+.rx-record-grid-column-editor__checkbox-field{margin-top:calc(.5rem + 1px)!important}\n'],encapsulation:2,changeDetection:0});class ep extends l.ValueAccessor{constructor(e,t,i,n){super(),this.rxModalService=e,this.rxFieldDefinitionService=t,this.rxRecordGridConfigUtilsService=i,this.rxRecordGridUtilsService=n,this.updateColumnsSubject=new o.BehaviorSubject([]),this.columns$=this.updateColumnsSubject.pipe((0,r.switchMap)(e=>(0,o.forkJoin)(e.map(e=>(0,o.forkJoin)([this.rxRecordGridUtilsService.getAssociationDescriptor(e.fieldId,this.options.recordDefinition),this.rxRecordGridUtilsService.getFieldDefinition(e.fieldId,this.options.recordDefinition)]).pipe((0,r.map)(([t,i])=>({associationDescriptor:t,fieldDefinition:i,inspectorColumn:e}))))).pipe((0,r.defaultIfEmpty)([]),(0,r.map)(e=>e.map(e=>{var t;return Object.assign(Object.assign({},e.inspectorColumn),{fieldDefinition:e.fieldDefinition,associationDescriptor:e.associationDescriptor,title:null===(t=e.inspectorColumn.title)||void 0===t?void 0:t.trim(),searchable:(0,m.has)(e.inspectorColumn,"searchable")?this.rxRecordGridConfigUtilsService.getBooleanValue(e.inspectorColumn.searchable):e.inspectorColumn.filterable&&this.rxRecordGridUtilsService.isSearchable(e.fieldDefinition,this.options.recordDefinition),fallbackTitle:`[${e.fieldDefinition.name}]`})})),(0,r.shareReplay)(1))))}ngOnChanges(e){var t;(null===(t=e.options)||void 0===t?void 0:t.previousValue)&&e.options.currentValue.recordDefinition.name!==e.options.previousValue.recordDefinition.name&&this.updateColumnsSubject.next(this.value)}onWriteValue(e){this.updateColumnsSubject.next(e)}removeColumn(e){this.updateValue(this.value.filter(t=>t.fieldId!==e.fieldId))}updateValue(e){this.value=e,this.onWriteValue(e)}openEditor(e,t){this.columns$.pipe((0,r.take)(1)).subscribe(i=>{const n={isReadOnly:this.isDisabled,columns:i,activeColumn:i.find(t=>t.guid===e),recordDefinition:this.options.recordDefinition,activeActionIndex:t};this.rxModalService.openModal({title:"Edit grid columns",content:Zc,data:{columnParams:n},size:d.OpenViewActionModalSize.Large,testID:"edit-grid-columns"}).then(e=>{e&&e.columns&&this.updateValue(e.columns)}).catch(m.noop)})}focus(e){this.openEditor(null==e?void 0:e.columnGuid,null==e?void 0:e.actionIndex)}getColumnResourceTypeName(e){const t=a.RX_RECORD_DEFINITION.resourceTypesByFullName[e.fieldDefinition.resourceType];return(0,m.get)(a.RX_RECORD_DEFINITION.dataTypes[t],"displayName","")}getSortedColumns(e){return e.sort((e,t)=>e.index-t.index)}trackByForColumns(e,t){return t.fieldId}isActionsColumn(e){return e===Nc.actionsColumnFieldDefinition.id}ngOnDestroy(){this.updateColumnsSubject.complete()}}var tp,ip,np,op;ep.\u0275fac=function(e){return new(e||ep)(n["\u0275\u0275directiveInject"](S.RxModalService),n["\u0275\u0275directiveInject"](a.RxFieldDefinitionService),n["\u0275\u0275directiveInject"](Lc),n["\u0275\u0275directiveInject"](kc))},ep.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ep,selectors:[["rx-record-grid-column-editor"]],inputs:{options:"options"},features:[n["\u0275\u0275ProvidersFeature"]([{provide:b.NG_VALUE_ACCESSOR,useExisting:ep,multi:!0}]),n["\u0275\u0275InheritDefinitionFeature"],n["\u0275\u0275NgOnChangesFeature"]],decls:5,vars:3,consts:[["btn-type","tertiary","rx-id","open-modal-button",1,"p-0","pb-1",3,"click"],[1,"d-icon-plus_circle"],[4,"ngIf"],["rx-id","columns"],["class","text-tertiary",4,"ngIf"],["class","rx-selected-column",4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-tertiary"],[1,"rx-selected-column"],[1,"rx-selected-column__header-container"],["rx-id","card-title",1,"rx-selected-column__header-title",3,"ngClass","title"],["type","button","class","rx-button-unstyled d-icon-left-pencil btn-link","rx-id","open-editor",3,"click",4,"ngIf"],["type","button","class","rx-button-unstyled d-icon-cross btn-link","rx-id","remove-column",3,"click",4,"ngIf"],["rx-id","column-type",1,"rx-column-type"],["type","button","rx-id","open-editor",1,"rx-button-unstyled","d-icon-left-pencil","btn-link",3,"click"],["type","button","rx-id","remove-column",1,"rx-button-unstyled","d-icon-cross","btn-link",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-button",0),n["\u0275\u0275listener"]("click",function(){return t.openEditor()}),n["\u0275\u0275element"](1,"span",1),n["\u0275\u0275text"](2," Edit grid columns\n"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](3,Mn,4,3,"div",2),n["\u0275\u0275pipe"](4,"async")),2&e&&(n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](4,1,t.columns$)))},directives:[u.AdaptButtonComponent,f.NgIf,f.NgForOf,f.NgClass],pipes:[f.AsyncPipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.rx-selected-column[_ngcontent-%COMP%]{margin-bottom:5px;border:1px solid #d6d7d8;border-radius:2px;padding:5px 10px;word-break:break-all;font-weight:var(--font-weight-bold)}.rx-selected-column__header-container[_ngcontent-%COMP%]{display:flex;margin-bottom:5px}.rx-selected-column__header-title[_ngcontent-%COMP%]{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;font-size:14px}.rx-column-type[_ngcontent-%COMP%]{color:#959899;font-size:10px;overflow:hidden;text-overflow:ellipsis}.d-icon-cross[_ngcontent-%COMP%], .d-icon-left-pencil[_ngcontent-%COMP%]{cursor:pointer}.d-icon-cross[_ngcontent-%COMP%]:not(:hover), .d-icon-left-pencil[_ngcontent-%COMP%]:not(:hover){color:#313538}']}),function(e){e.And="AND",e.Or="OR"}(tp||(tp={}));class rp{constructor(e,t=[]){this.namedOptions=[],this.filterValue=e,Array.isArray(t)&&(this.namedOptions=t)}get length(){return(Array.isArray(this.filterValue)?this.filterValue.length:(0,m.isNil)(this.filterValue)?0:1)+this.namedOptions.length}static isEmpty(e){return e instanceof rp&&!e.length}static isEmptyWithRange(e){return e instanceof rp&&!e.namedOptions.length&&u.AdvancedFilterDataTypesConfigsService.isEmptyOnEmptyValues(e.filterValue)}}class ap{constructor(e,t,i,n,o,r){this.rxRecordDefinitionService=e,this.rxObjectUtilsService=t,this.rxRecordGridUtilsService=i,this.rxNamedListService=n,this.advancedFilterDataTypesConfigsService=o,this.adaptTranslateService=r,this.translation=this.adaptTranslateService.getCurrentLanguage(),this.adaptTexts={fromLabel:this.translation["adapt.advancedFilter.configsTexts.fromLabel"],toLabel:this.translation["adapt.advancedFilter.configsTexts.toLabel"],trueLabel:this.translation["adapt.advancedFilter.configsTexts.trueLabel"],falseLabel:this.translation["adapt.advancedFilter.configsTexts.falseLabel"],blankLabel:this.translation["adapt.advancedFilter.configsTexts.blankLabel"],validationErrors:{invalidRangeName:this.translation["adapt.advancedFilter.validationErrors.invalidRangeName"],invalidRangeText:this.translation["adapt.advancedFilter.validationErrors.invalidRangeText"],numberTypeTexts:{fromValueMustBeNumber:this.translation["adapt.advancedFilter.validationErrors.numberTypeTexts.fromValueMustBeNumber"],toValueMustBeNumber:this.translation["adapt.advancedFilter.validationErrors.numberTypeTexts.toValueMustBeNumber"],invalidBetweenMinAndMax:this.translation["adapt.advancedFilter.validationErrors.numberTypeTexts.invalidBetweenMinAndMax"],invalidMinValue:this.translation["adapt.advancedFilter.validationErrors.numberTypeTexts.invalidMinValue"],invalidMaxValue:this.translation["adapt.advancedFilter.validationErrors.numberTypeTexts.invalidMaxValue"]}}},this.defaultConfig=this.advancedFilterDataTypesConfigsService.getConfigs(this.adaptTexts)}addAssociationFieldsToFieldDefinitionsById(e,t,i){return t.forEach(t=>{i.find(e=>e.name===t.recordDefinitionName).fieldDefinitions.forEach(i=>{const n=this.rxRecordGridUtilsService.getFieldIdForGridColumn(i.id,t);e[n]||this.rxRecordDefinitionService.addFieldDefinitionToMap(i,e,n)})}),e=Object.assign(Object.assign({},e),this.rxObjectUtilsService.expandProperties(e))}getAdvancedFilterOption(e,t,i,n,o,r,s,l,d,c){const p={id:e,label:t,dataType:n.filterOptionDataType,isHidden:o,data:(0,m.isFunction)(n.getDataForAdvancedFilter)?n.getDataForAdvancedFilter(i,e):null};if(l=null!=l?l:[],n.filterOptionDataType===u.AdvancedFilterOptionDataType.boolean&&(p.inputsTemplate=i.fieldOption!==a.RecordFieldOption.Required?r.optionalBooleanFilter:r.requiredBooleanFilter,p.customConfig={getExpressionFieldTips:e=>{const t=e.data,i=(null==t?void 0:t.selectOptions)||[];return this.getNamedFilterOptionTips(l,e,p.customConfig).concat(i.map(t=>u.AdvancedFilterDataTypesConfigsService.createAdvancedFilterTag(new rp([t.id]),e,p.customConfig,!1,(0,u.formatAdvancedFilterTagText)(e,t.name))))},formatValueForTag:(e,t)=>{const i=t.data,n=(null==i?void 0:i.selectOptions)||[],o=e.filterValue.map(e=>n.find(t=>t.id===e).name);return this.buildTagLabel(o,this.getNamedOptionTitles(e,l))},needRemoveTagValue:e=>rp.isEmpty(e),updateFilterValue:(e,t,i)=>this.updateFilterValue(t,e,i.data.isRequired),parseTagFieldExpression:(e,t)=>{const i=u.AdvancedFilterDataTypesConfigsService.getExpressionRawValues(e,t),n=this.getFilterValueFromString(l,i),o=e.data,r=(null==o?void 0:o.selectOptions)||[];return n.filterValue=n.filterValue.map(e=>{var t;e=e.trim().toLowerCase();const i=r.find(t=>t.name.toLowerCase()===e);return null!==(t=null==i?void 0:i.id)&&void 0!==t?t:null}).filter(e=>!(0,m.isNil)(e))||[],n.length?{value:n}:null}}),n.filterOptionDataType===u.AdvancedFilterOptionDataType.string&&(i.namedListDefinition?(p.inputsTemplate=r.inputsForStringWithTypeAheadTemplate,p.data=Object.assign(Object.assign({},p.data),{typeaheadKeystrokeCount:d,additionalQueryCriteria:c})):p.inputsTemplate=r.inputsForStringTypeTemplate,p.customConfig={needRemoveTagValue:e=>rp.isEmpty(e),formatValueForTag:(e,t)=>this.buildTagLabel(e.filterValue,this.getNamedOptionTitles(e,l)),getExpressionFieldTips:(e,t)=>[...this.getNamedFilterOptionTips(l,e,p.customConfig),u.AdvancedFilterDataTypesConfigsService.createAdvancedFilterTag(new rp,e,p.customConfig,!0,(0,u.formatAdvancedFilterTagText)(e,""))],updateFilterValue:(e,t,i)=>this.updateFilterValue(t,e),parseTagFieldExpression:(e,t)=>this.parseStringTagFieldExpression(e,t,l)}),n.filterOptionDataType===u.AdvancedFilterOptionDataType.selection&&(p.inputsTemplate=r.inputsForSelectionTypeTemplate,p.customConfig={needRemoveTagValue:e=>rp.isEmpty(e),formatValueForTag:(e,t)=>{const i=this.defaultConfig[n.filterOptionDataType].formatValueForTag(e.filterValue,t);return this.buildTagLabel(i,this.getNamedOptionTitles(e,l))},getExpressionFieldTips:(e,t)=>{const i=e.data,n=i&&i.selectOptions||[];return this.getNamedFilterOptionTips(l,e,p.customConfig).concat(n.map(t=>u.AdvancedFilterDataTypesConfigsService.createAdvancedFilterTag(new rp([t.id]),e,p.customConfig,!1,(0,u.formatAdvancedFilterTagText)(e,t.name))))},updateFilterValue:(e,t,i)=>this.updateFilterValue(t,e),parseTagFieldExpression:(e,t)=>this.parseStringTagFieldExpression(e,t,l)}),n.filterOptionDataType===u.AdvancedFilterOptionDataType.datetime&&(p.inputsTemplate=r.inputsForDatetimeTypeTemplate,p.customConfig=this.getDatetimeCustomConfig(l,p,u.AdvancedFilterOptionDataType.datetime,"ll LTS")),n.filterOptionDataType===u.AdvancedFilterOptionDataType.date&&(p.inputsTemplate=r.inputsForDateTypeTemplate,p.customConfig=this.getDatetimeCustomConfig(l,p,u.AdvancedFilterOptionDataType.date,"ll")),n.filterOptionDataType===u.AdvancedFilterOptionDataType.time&&(p.inputsTemplate=r.inputsForTimeTypeTemplate,p.customConfig=this.getDatetimeCustomConfig(l,p,u.AdvancedFilterOptionDataType.time,"LTS")),n.filterOptionDataType===u.AdvancedFilterOptionDataType.number&&(p.inputsTemplate=r.inputsForNumberTypeTemplate,p.customConfig={needRemoveTagValue:e=>rp.isEmptyWithRange(e),getExpressionFieldTips:(e,t)=>this.getNamedFilterOptionTips(l,e,p.customConfig,[null,null]).concat(this.defaultConfig[n.filterOptionDataType].getExpressionFieldTips(e,t)),updateFilterValue:(e,t,i)=>(e.filterValue=this.defaultConfig[n.filterOptionDataType].updateFilterValue(e.filterValue,t.filterValue,i),e.namedOptions=(0,m.uniq)(t.namedOptions.concat(e.namedOptions)),e),formatValueForTag:e=>{const t=e.filterValue.filter(e=>null!=e).join(" - ");return this.buildTagLabel(t,this.getNamedOptionTitles(e,l))},parseTagFieldExpression:(e,t)=>{var i,o;const{value:r,label:a}=this.getExpressionRawValues(e,t);if(!r)return null;const s=this.getFilterValueFromString(l,r);return s.filterValue=null!==(o=null===(i=this.defaultConfig[n.filterOptionDataType].parseTagFieldExpression(e,`${a} ${s.filterValue[0]}`))||void 0===i?void 0:i.value)&&void 0!==o?o:[],s.length?{value:s}:null},validateValue:(e,t)=>this.defaultConfig[n.filterOptionDataType].validateValue(e.filterValue,t)}),s){const e={getTagText:(e,t,i)=>`${s}: ${i}`};p.customConfig=Object.assign(Object.assign({},p.customConfig),e)}return p}parseStringTagFieldExpression(e,t,i){const n=u.AdvancedFilterDataTypesConfigsService.getExpressionRawValues(e,t);if(!n)return null;const o=this.getFilterValueFromString(i,n);return o.length?{value:o}:null}updateFilterValue(e,t,i=!1){return i||(t.filterValue=(0,m.uniq)(e.filterValue.concat(t.filterValue))),t.namedOptions=(0,m.uniq)(e.namedOptions.concat(t.namedOptions)),t}buildTagLabel(e,t,i=", ",n="; "){return[(0,m.isString)(e)?e:(0,m.isArray)(e)&&!(0,m.isEmpty)(e)?this.rxNamedListService.isNamedListOption(e[0])?e.map(e=>{var t;return null!==(t=e.displayValue)&&void 0!==t?t:e.value}).join(i):e.join(i):"",...t].filter(Boolean).join(n)}getNamedOptionTitles(e,t){const i=t.map(e=>e.guid);return e.namedOptions.sort((e,t)=>i.indexOf(e)-i.indexOf(t)).map(e=>{var i;return null===(i=t.find(t=>t.guid===e))||void 0===i?void 0:i.title})}getDatetimeCustomConfig(e,t,i,n){return{getExpressionFieldTips:(n,o)=>this.getNamedFilterOptionTips(e,n,t.customConfig).concat(this.defaultConfig[i].getExpressionFieldTips(n,o)),needRemoveTagValue:e=>rp.isEmptyWithRange(e),formatValueForTag:t=>{const i=t.filterValue.filter(e=>e).map(e=>(0,D.default)(e).format(n)).join(" - ");return this.buildTagLabel(i,this.getNamedOptionTitles(t,e))},updateFilterValue:(e,t,n)=>(e.filterValue=this.defaultConfig[i].updateFilterValue(e.filterValue,t.filterValue,n),e.namedOptions=(0,m.uniq)(t.namedOptions.concat(e.namedOptions)),e),parseTagFieldExpression:(t,n)=>{var o,r;const{value:a}=this.getExpressionRawValues(t,n);if(!a)return null;const s=this.getFilterValueFromString(e,a),[l]=n.split("; ");return s.filterValue=null!==(r=null===(o=this.defaultConfig[i].parseTagFieldExpression(t,l))||void 0===o?void 0:o.value)&&void 0!==r?r:[],s.length?{value:s}:null},validateValue:(e,t)=>this.defaultConfig[i].validateValue(e.filterValue,t)}}getExpressionRawValues(e,t){return[`${e.label}:`,`${e.label} ${this.adaptTexts.fromLabel}`,`${e.label} ${this.adaptTexts.toLabel}`].reduce((e,i)=>(t.startsWith(i)&&(e.label=i,e.value=t.replace(i,"").trim()),e),{label:null,value:null})}getFilterValueFromString(e,t){const i=(null!=t?t:"").trim().split(";").filter(e=>!(0,u.isEmptyOrWhitespace)(e)).map(e=>e.trim()),n=new rp([]);return i.forEach(t=>{var i;const o=null===(i=e.find(e=>e.title===t))||void 0===i?void 0:i.guid;o?n.namedOptions.push(o):n.filterValue.push(...t.split(",").map(e=>e.trim()).filter(Boolean))}),n.namedOptions=(0,m.uniq)(n.namedOptions),n}getNamedFilterOptionTips(e,t,i,n=[]){return(null!=e?e:[]).map(e=>u.AdvancedFilterDataTypesConfigsService.createAdvancedFilterTag(new rp(n,[e.guid]),t,i,!1,(0,u.formatAdvancedFilterTagText)(t,e.title)))}}ap.\u0275fac=function(e){return new(e||ap)(n["\u0275\u0275inject"](a.RxRecordDefinitionService),n["\u0275\u0275inject"](v.RxObjectUtilsService),n["\u0275\u0275inject"](kc),n["\u0275\u0275inject"](E.RxNamedListService),n["\u0275\u0275inject"](u.AdvancedFilterDataTypesConfigsService),n["\u0275\u0275inject"](u.AdaptTranslateService))},ap.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ap,factory:ap.\u0275fac});class sp{constructor(e){this.rxJsonParserService=e,this.filtersKeywords=["$NULL$","$TIME$","$DATE$","$TIMESTAMP$","$USER$"]}getRecordGridFilterDataFromPredefinedFilter(e,t){return!(0,m.isEmpty)(t)&&e&&(e=this.normalizeFilterString(e,t)),this.clearFilterData(this.rxJsonParserService.tryParseJson(e))}normalizeFilterString(e,t){return(0,m.forEach)(t,t=>{const i=Object.assign({[t.fieldId]:t.value},t.$DISPLAYVALUE$&&{$DISPLAYVALUE$:t.$DISPLAYVALUE$});e=e.replace(`"${t.guid}"`,JSON.stringify(i))}),e}denormalizeFilterString(e,t){return(0,m.forEach)(t,t=>{const i=Object.assign({[t.fieldId]:t.value},t.$DISPLAYVALUE$&&{$DISPLAYVALUE$:t.$DISPLAYVALUE$});e=i.$DISPLAYVALUE$?JSON.stringify(JSON.parse(e),this.replacer(this.denormalize(t.guid,i))):e.replace(JSON.stringify(i),`"${t.guid}"`)}),e}replacer(e){return(t,i)=>"string"==typeof t&&e[t]?e[t](i):i}denormalize(e,t){return(0,m.reduce)(d.RecordGridFilterOperator,(i,n)=>(i[n]=i=>(0,m.isEqual)(i,t)?e:i,i),{})}clearFilterData(e){const t=(0,m.keys)(e);let i=e;if(!(0,m.isEmpty)(t)){const n=t[0];switch(!0){case(0,m.includes)(["or","and"],n):{const t=e[n].map(this.clearFilterData.bind(this)).filter(e=>Boolean(e));(0,m.isEmpty)(t)?i=null:e[n]=t;break}case(0,m.isString)(e[n]):i=null}}return i}replaceKeywords(e){const t='([^|^"])"('+this.filtersKeywords.join("|").replace(/\$/g,"\\$")+')"(?!")',i='([^|^"])"""('+this.filtersKeywords.join("|").replace(/\$/g,"\\$")+')"""(?!")',n=new RegExp(t,"g"),o=new RegExp(i,"g");return e.replace(n,"$1$2").replace(o,'$1"$2"')}}sp.\u0275fac=function(e){return new(e||sp)(n["\u0275\u0275inject"](v.RxJsonParserService))},sp.\u0275prov=n["\u0275\u0275defineInjectable"]({token:sp,factory:sp.\u0275fac,providedIn:"root"});class lp{constructor(e,t,i,n,o,r,a){this.rxStringService=e,this.rxRecordGridUtilsService=t,this.rxJsonParserService=i,this.rxRecordGridAdvancedFilteringService=n,this.rxRecordDefinitionService=o,this.rxObjectUtilsService=r,this.rxRecordGridFilterHelperService=a,this.filtersKeywords=["$NULL$","$TIME$","$DATE$","$TIMESTAMP$","$USER$"]}clearFilterData(e){const t=(0,m.keys)(e);let i=e;if(!(0,m.isEmpty)(t)){const n=t[0];switch(!0){case(0,m.includes)(["or","and"],n):{const t=e[n].map(this.clearFilterData.bind(this)).filter(e=>Boolean(e));(0,m.isEmpty)(t)?i=null:e[n]=t;break}case(0,m.isString)(e[n]):i=null}}return i}getFilterForAvailableColumns(e,t){const i=(0,m.keys)(e);let n=e;if(!(0,m.isEmpty)(i)){const o=i[0],r=Object.keys(e[o])[0];switch(!0){case(0,m.includes)(["or","and"],o):{const i=e[o].map(e=>this.getFilterForAvailableColumns(e,t)).filter(e=>Boolean(e));(0,m.isEmpty)(i)?n=null:e[o]=i;break}case!(0,m.some)(t,{fieldId:r}):n=null;break;case(0,m.includes)(["eq"],o):{const i=(0,m.find)(t,{fieldId:r}).fieldDefinition;i.resourceType!==a.RX_RECORD_DEFINITION.resourceTypes.selection||(0,m.has)(i.optionNamesById,e[o][r])||(n=null);break}}}return n}replaceKeywords(e){const t='([^|^"])"('+this.filtersKeywords.join("|").replace(/\$/g,"\\$")+')"(?!")',i='([^|^"])"""('+this.filtersKeywords.join("|").replace(/\$/g,"\\$")+')"""(?!")',n=new RegExp(t,"g"),o=new RegExp(i,"g");return e.replace(n,"$1$2").replace(o,'$1"$2"')}generateTextFilterQuery(e,t){let i=null;if(e){const n=t.filter(e=>!e.hidden&&e.searchable).map(t=>{const i=this.getQueryFilterField(t.field);let n="";return t.filterType===a.RX_RECORD_DEFINITION.dataTypes.character.shortName||t.filterType===a.RX_RECORD_DEFINITION.dataTypes.localizedCharacter.shortName?n=`${i} LIKE "%${this.escapeDoubleQuotes(e).replace(/[%_]/g,"\\$&")}%"`:isNaN(e)||(n=`${i} = "${this.escapeDoubleQuotes(e)}"`),n}).filter(Boolean).join(" OR ");i=n?`(${n})`:""}return i}addQueries(...e){return(0,m.filter)(e,Boolean).join(" AND ")}joinQueryFilters(e,t){const i=e.join(t===tp.And?" AND ":" OR ");return i?`(${i})`:""}getAdvancedFilterData(e,t,i,n,a,s){return(0,o.forkJoin)(e&&e.and?e.and.map(e=>{const l=Object.keys(e)[0],d=e[l],c=(0,m.values)(d[0])[0],p=String(Object.keys(c)[0]);let u=t[p];return(u?(0,o.of)(u):this.rxRecordGridUtilsService.getFieldDefinition(p,n)).pipe((0,r.filter)(Boolean),(0,r.map)(e=>{u=e;const o=i[u.resourceType];if(!t[p]){this.rxRecordDefinitionService.addFieldDefinitionToMap(u,t,p),t=n.fieldDefinitionsById=Object.assign(Object.assign({},t),this.rxObjectUtilsService.expandProperties(t));const e=this.rxRecordGridUtilsService.findAssociationDescriptor(s,this.rxRecordGridUtilsService.getFieldLocator(p));a.push(this.rxRecordGridAdvancedFilteringService.getAdvancedFilterOption(p,this.rxRecordGridUtilsService.getColumnLabel(u,e),u,o,!0))}return o.getSelectedAdvancedFilterData(l,d,u,p)}))}):[]).pipe((0,r.defaultIfEmpty)([]),(0,r.map)(e=>e.filter(Boolean)))}getQueryFromRecordGridFilterData(e,t){const i=[d.RecordGridFilterOperator.Eq,d.RecordGridFilterOperator.Like,d.RecordGridFilterOperator.Ne,d.RecordGridFilterOperator.Lt,d.RecordGridFilterOperator.Lte,d.RecordGridFilterOperator.Gt,d.RecordGridFilterOperator.Gte,d.RecordGridFilterOperator.In,"regex"],n=e=>(0,m.reduce)(e,(e,i,n)=>e+(0,m.reduce)(i,(e,i,o)=>{const r=t[o];let s=n,l=i;if(!!r&&(0,m.includes)([a.RX_RECORD_DEFINITION.dataTypes.character.resourceType,a.RX_RECORD_DEFINITION.dataTypes.localizedCharacter.resourceType],r.resourceType)){const{isLikeOperation:e,filterValue:t}=this.getStringDataTypeFilterData(i,r);s=e?d.RecordGridFilterOperator.Like:s,l=t}return"$DISPLAYVALUE$"===o?e:e+this.getQueryExpression(l,o,s)},""),"");let o=e=>(e=>(0,m.intersection)(i.slice(),(0,m.keys)(e)).length>0)(e)?n(e):(0,m.reduce)(e,(e,t,i)=>{const n=(0,m.map)(t,o);switch(i){case d.RecordGridFilterDataLogic.And:return e+`(${n.join(" AND ")})`;case d.RecordGridFilterDataLogic.Or:return e+`(${n.join(" OR ")})`;default:return e+`(${n.join(" AND ")})`}},"");return o=o.bind(this),o(e)}getSelectedFiltersFromPredefinedFilter(e,t,i,n,o,r,a){const s=this.rxRecordGridFilterHelperService.getRecordGridFilterDataFromPredefinedFilter(e,this.deserializeNamedOptions(t));return this.getAdvancedFilterData(s,i,n,o,r,a)}getRecordGridFilterDataFromAdvancedFilter(e,t,i,n){const o=e.map(e=>{let o=null;const r=String(e.filterOptionId),a=t[r];if(a){o=i[a.resourceType].getRecordGridFilterData(e.value,a,r,n&&n[r])}return o});return o.length?{and:o}:{}}getQueryFilterField(e){return this.rxRecordGridUtilsService.isAssociatedRecordFieldId(e)?`\${${e}}`:`'${e}'`}buildQueryFilter(e,t,i){const n=(0,m.isString)(i)&&!this.filtersKeywords.includes(i),o=(0,m.isString)(i)?n?`"${this.escapeDoubleQuotes(i)}"`:i:String(i);return`${this.getQueryFilterField(e)} ${t} ${o}`}filterRows(e,t,i,n){const o=this.getRecordGridFilterDataFromAdvancedFilter(t,i.fieldDefinitionsById,n);return e.filter(e=>e.groupField?(e.items=this.getFilteredItems(e.items,o,i),e.items.length):(0,m.every)(o.and,t=>this.matchRow(e,t,i)))}getFilteredItems(e,t,i){return(0,m.reduce)(e,(e,n)=>{let{items:o=[]}=n;return!n.items&&(0,m.every)(t.and,e=>this.matchRow(n,e,i))?e.push(n):(o=this.getFilteredItems(o,t,i),o.length&&e.push(Object.assign(Object.assign({},n),{items:o}))),e},[])}matchRow(e,t,i){const n=(0,m.findKey)(t);switch(n){case"and":return(0,m.every)(t[n],t=>this.checkCondition(e,t,i));case"or":return(0,m.some)(t[n],t=>this.checkCondition(e,t,i));default:return!1}}checkCondition(e,t,i){const n=(0,m.findKey)(t),o=(0,m.findKey)(t[n]),r=t[n][o],s=e[o];if(i.fieldDefinitionsById[o].resourceType!==a.RX_RECORD_DEFINITION.dataTypes.dateTime.resourceType)return"eq"===n&&this.rxStringService.caseInsensitiveIsEqual(s,r);switch(n){case"eq":return(0,D.default)(s).isSame(r);case"lte":return(0,D.default)(s).isSameOrBefore(r);case"lt":return(0,D.default)(s).isBefore(r);case"gte":return(0,D.default)(s).isSameOrAfter(r);case"gt":return(0,D.default)(s).isAfter(r);default:return!1}}escapeDoubleQuotes(e){return e.replace(/"/g,'""')}getQueryExpression(e,t,i){const n=(0,m.isString)(e)?'"'+e+'"':e;switch(t=this.getQueryFilterField(t),i){case d.RecordGridFilterOperator.Eq:return t+"="+n;case d.RecordGridFilterOperator.Like:return t+" LIKE "+n;case d.RecordGridFilterOperator.Ne:return t+"!="+n;case d.RecordGridFilterOperator.Lt:return t+"<"+n;case d.RecordGridFilterOperator.Lte:return t+"<="+n;case d.RecordGridFilterOperator.Gt:return t+">"+n;case d.RecordGridFilterOperator.Gte:return t+">="+n;case d.RecordGridFilterOperator.In:return t+" IN "+n;default:return t+"="+n}}getStringDataTypeFilterData(e,t){let i=!1;if(!(0,m.get)(t.searchDefinition,"enableFTSSearch"))if((0,m.includes)(e,"%")){const t=e.split(/\\\\/);i=(0,m.some)(t,e=>e.replace(/\\%/g,"").match("%")),i||(e=(0,m.map)(t,e=>e.replace(/\\%/g,"%")).join("\\"))}else e=e.replace("\\\\","\\");return{isLikeOperation:i,filterValue:e}}clearRemovedNamedFilterOptions(e,t){return e.reduce((e,i)=>{var n,o;const r=null!==(o=null===(n=t[i.filterOptionId])||void 0===n?void 0:n.map(e=>e.guid))&&void 0!==o?o:[];return i.value.namedOptions=i.value.namedOptions.filter(e=>r.includes(e)),rp.isEmptyWithRange(i.value)||e.push(i),e},[])}deserializeNamedOptions(e){return e.map(e=>{const t=this.rxJsonParserService.tryParseJson(e.value);return t&&t[d.RecordGridNamedFilterOptionKey]?Object.assign(Object.assign({},e),{value:t}):e})}}lp.\u0275fac=function(e){return new(e||lp)(n["\u0275\u0275inject"](v.RxStringService),n["\u0275\u0275inject"](kc),n["\u0275\u0275inject"](v.RxJsonParserService),n["\u0275\u0275inject"](ap),n["\u0275\u0275inject"](a.RxRecordDefinitionService),n["\u0275\u0275inject"](v.RxObjectUtilsService),n["\u0275\u0275inject"](sp))},lp.\u0275prov=n["\u0275\u0275defineInjectable"]({token:lp,factory:lp.\u0275fac});class dp{constructor(e,t,i,n,o,r,a){this.rxRecordGridFilterService=e,this.rxNumberUtilsService=t,this.rxNamedListService=i,this.translateService=n,this.rxRecordInstanceUtilsService=o,this.rxRecordGridUtilsService=r,this.rxDefinitionNameService=a,this.associatedFieldIdPatternRegExp=new RegExp(`'(${Nc.associatedFieldIdPrefixPattern}\\d+)'`,"g")}getConfigs(){const e={filterOptionDataType:u.AdvancedFilterOptionDataType.string,getQueryFilter:(e,t,i,n)=>{const o=this.getSelectedNamedOptionExpressions(n,e),r=(0,m.chain)(e.value.filterValue).filter(Boolean).map(e=>{const{isLikeOperation:n,filterValue:o}=this.rxRecordGridFilterService.getStringDataTypeFilterData((0,m.get)(e,"value",e),t);return this.rxRecordGridFilterService.buildQueryFilter(i,n?"like":"=",o.trim())}).concat(o).value();return this.rxRecordGridFilterService.joinQueryFilters(r,tp.Or)},getRecordGridFilterData:(e,t,i,n)=>{const o=this.getNamedFilterOptionsOperators(e,i);return{or:e.filterValue.map(e=>{const n=this.getRecordGridFilterOperator(d.RecordGridFilterOperator.Eq,i,(0,m.get)(e,"value",e).trim()),o=(0,m.get)(e,"displayValue");return t.namedListDefinition&&o&&(n.eq.$DISPLAYVALUE$=o),n}).concat(o)}},getSelectedAdvancedFilterData:(e,t,i,n)=>{const o=[],r=[],a=[];e===d.RecordGridFilterDataLogic.Or&&t.forEach(e=>{const t=Object.keys(e)[0],s=e[t][n];if((0,m.isString)(s))if(i.namedListDefinition){const i=e[t].$DISPLAYVALUE$;r.push({displayValue:i,value:s,title:"",contextualFields:[]})}else o.push(s);else s[d.RecordGridNamedFilterOptionKey]&&a.push(s[d.RecordGridNamedFilterOptionKey])});const s=(0,m.isEmpty)(r)?new rp(o,a):new rp(r,a);return{filterOptionId:n,value:s}},getToolbarTagInfo:({primaryRecordDefinition:e,value:t,tag:i,fieldId:n,namedFilterOptions:s})=>{const l=this.rxRecordGridUtilsService.getFieldLocator(n);let d;return this.rxRecordGridUtilsService.getAssociationDescriptor(n,e).pipe((0,r.mergeMap)(t=>(d=t,this.rxRecordGridUtilsService.getDisplayFieldDescriptor(n,e,d&&d.recordDefinitionName))),(0,r.mergeMap)(e=>{let n;if(l.fieldId!==String(e.id)){const i=this.rxNamedListService.getNamesFromTypeAheadOptions(t.filterValue);n=this.rxRecordInstanceUtilsService.getFieldValues(d.recordDefinitionName,i,[String(a.RX_RECORD_DEFINITION.coreFieldIds.id),String(e.id)]).pipe((0,r.map)(i=>{const n=(0,m.compact)([this.rxDefinitionNameService.getDisplayName(d.associationDefinition.name),e.name]).join(" > "),o=t.filterValue.map(t=>{const n=(0,m.find)(i,e=>e[a.RX_RECORD_DEFINITION.coreFieldIds.id]===t);return n?n[e.id]:t});return{displayValues:new rp(o),label:n}}))}else n=(0,o.of)({displayValues:t,label:i.data.filterOption.label});return n.pipe((0,r.map)(({displayValues:e,label:t})=>{const i=e.filterValue.map(e=>{var t,i;const n=(0,m.get)(e,"value",e),o=null!==(t=(0,m.get)(e,"displayValue"))&&void 0!==t?t:(0,m.get)(e,"value",e),r="$USER$"===n?this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.filters.me.label"):o;return{tooltip:(null==e?void 0:e.displayValue)?`${e.displayValue} (${e.value})`:null!==(i=null==e?void 0:e.value)&&void 0!==i?i:e,text:r}}).concat(e.namedOptions.map(e=>{var t;const i=(null===(t=s.find(t=>t.guid===e))||void 0===t?void 0:t.title)||e;return{text:i,tooltip:i}}));return{text:`${t}: ${i.map(e=>e.text).join(", ")}`,tooltip:`${t}: ${i.map(e=>e.tooltip).join(", ")}`}}))}))},getDataForAdvancedFilter:e=>e},t={filterOptionDataType:u.AdvancedFilterOptionDataType.number,getQueryFilter:(e,t,i,n)=>{const o=this.getSelectedNamedOptionExpressions(n,e),[r,a]=e.value.filterValue,s=[];this.rxNumberUtilsService.isFiniteOrNumberString(r)&&s.push(this.rxRecordGridFilterService.buildQueryFilter(i,">=",String(r))),this.rxNumberUtilsService.isFiniteOrNumberString(a)&&s.push(this.rxRecordGridFilterService.buildQueryFilter(i,"<=",String(a)));const l=this.rxRecordGridFilterService.joinQueryFilters(s,tp.And);return this.rxRecordGridFilterService.joinQueryFilters(l?[l,...o]:o,tp.Or)},getRecordGridFilterData:(e,t,i)=>{const[n,o]=e.filterValue,r=[];return this.rxNumberUtilsService.isFiniteOrNumberString(n)&&r.push(this.getRecordGridFilterOperator(d.RecordGridFilterOperator.Gte,i,String(n))),this.rxNumberUtilsService.isFiniteOrNumberString(o)&&r.push(this.getRecordGridFilterOperator(d.RecordGridFilterOperator.Lte,i,String(o))),this.getFilterRangeDataOperator(r,this.getNamedFilterOptionsOperators(e,i))},getDataForAdvancedFilter:e=>({minValue:e.minValue,maxValue:e.maxValue}),getSelectedAdvancedFilterData:(e,t,i,n)=>{let o=[null,null];const r=e=>{const t=(0,m.find)(e,e=>e[d.RecordGridFilterOperator.Gte]);if(t){const e=parseFloat(t[d.RecordGridFilterOperator.Gte][n]);this.rxNumberUtilsService.isFiniteOrNumberString(e)&&(o[0]=e)}const i=(0,m.find)(e,e=>e[d.RecordGridFilterOperator.Lte]);if(i){const e=parseFloat(i[d.RecordGridFilterOperator.Lte][n]);this.rxNumberUtilsService.isFiniteOrNumberString(e)&&(o[1]=e)}};if(e===d.RecordGridFilterDataLogic.And)r(t);else if(e===d.RecordGridFilterDataLogic.Or){const e=(0,m.find)(t,e=>e[d.RecordGridFilterDataLogic.And]);if(e)r(e[d.RecordGridFilterDataLogic.And]);else if(1===t.length){let e=t[0][d.RecordGridFilterOperator.Eq][n];"$NULL$"===e||e[d.RecordGridNamedFilterOptionKey]||(e=parseFloat(e),o=[e,e])}}const a=this.getNamedFilterOptionGuids(t,n);return{filterOptionId:n,value:new rp(o,a)}}};return{[a.RX_RECORD_DEFINITION.resourceTypes.character]:e,[a.RX_RECORD_DEFINITION.resourceTypes.localizedCharacter]:e,[a.RX_RECORD_DEFINITION.resourceTypes.attachment]:e,[a.RX_RECORD_DEFINITION.resourceTypes.integer]:t,[a.RX_RECORD_DEFINITION.resourceTypes.decimal]:t,[a.RX_RECORD_DEFINITION.resourceTypes.real]:t,[a.RX_RECORD_DEFINITION.resourceTypes.selection]:{filterOptionDataType:u.AdvancedFilterOptionDataType.selection,getQueryFilter:(e,t,i,n)=>{const o=this.getSelectedNamedOptionExpressions(n,e);return this.rxRecordGridFilterService.joinQueryFilters(e.value.filterValue.map(e=>this.rxRecordGridFilterService.buildQueryFilter(i,"=",e)).concat(o),tp.Or)},getDataForAdvancedFilter:e=>{const t=(0,m.map)(e.optionLabelsById,(e,t)=>({id:t,name:e}));return e.fieldOption===a.RX_RECORD_DEFINITION.fieldOptions.optional&&t.unshift({id:"$NULL$",name:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.filters.blank.label")}),{selectOptions:t,selectTexts:null}},getRecordGridFilterData:(e,t,i)=>{const n=this.getNamedFilterOptionsOperators(e,i);return{or:e.filterValue.map(e=>this.getRecordGridFilterOperator(d.RecordGridFilterOperator.Eq,i,e)).concat(n)}},getSelectedAdvancedFilterData:(e,t,i,n)=>{const o=[],r=[];return e===d.RecordGridFilterDataLogic.Or&&t.forEach(e=>{const t=Object.keys(e)[0];if(t===d.RecordGridFilterOperator.Eq){const i=e[t][n];(0,m.isString)(i)?o.push(i):i[d.RecordGridNamedFilterOptionKey]&&r.push(i[d.RecordGridNamedFilterOptionKey])}}),{filterOptionId:n,value:new rp(o,r)}}},[a.RX_RECORD_DEFINITION.resourceTypes.timeOnly]:{filterOptionDataType:u.AdvancedFilterOptionDataType.time,getQueryFilter:(e,t,i,n)=>{const o=this.getSelectedNamedOptionExpressions(n,e),[r,a]=e.value.filterValue.map(e=>(0,D.default)(e)),s=[];r&&r.isValid()&&s.push(this.rxRecordGridFilterService.buildQueryFilter(i,">=",r.format("HH:mm:ss"))),a&&a.isValid()&&s.push(this.rxRecordGridFilterService.buildQueryFilter(i,"<=",a.format("HH:mm:ss")));const l=this.rxRecordGridFilterService.joinQueryFilters(s,tp.And);return this.rxRecordGridFilterService.joinQueryFilters(l?[l,...o]:o,tp.Or)},getRecordGridFilterData:(e,t,i)=>{const[n,o]=e.filterValue.map(e=>(0,D.default)(e)),r=[];return n&&r.push(this.getRecordGridFilterOperator(d.RecordGridFilterOperator.Gte,i,n&&n.isValid()?n.format("HH:mm:ss"):"")),o&&r.push(this.getRecordGridFilterOperator(d.RecordGridFilterOperator.Lte,i,o&&o.isValid()?o.format("HH:mm:ss"):"")),this.getFilterRangeDataOperator(r,this.getNamedFilterOptionsOperators(e,i))},getSelectedAdvancedFilterData:(e,t,i,n)=>{let o=[null,null];const r=e=>{const t=(0,m.find)(e,e=>e[d.RecordGridFilterOperator.Gte]);if(t){const e=(0,D.default)(t[d.RecordGridFilterOperator.Gte][n],"LTS");e.isValid()&&(o[0]=e)}const i=(0,m.find)(e,e=>e[d.RecordGridFilterOperator.Lte]);if(i){const e=(0,D.default)(i[d.RecordGridFilterOperator.Lte][n],"LTS");e.isValid()&&(o[1]=e)}};if(e===d.RecordGridFilterDataLogic.And)r(t);else if(e===d.RecordGridFilterDataLogic.Or){const e=(0,m.find)(t,e=>e[d.RecordGridFilterDataLogic.And]);if(e)r(e[d.RecordGridFilterDataLogic.And]);else if(1===t.length){let e=t[0][d.RecordGridFilterOperator.Eq][n];"$NULL$"===e||e[d.RecordGridNamedFilterOptionKey]||(e=(0,D.default)(e,"LTS"),o=[e,e])}}const a=this.getNamedFilterOptionGuids(t,n);return{filterOptionId:n,value:new rp(o,a)}}},[a.RX_RECORD_DEFINITION.resourceTypes.dateOnly]:{filterOptionDataType:u.AdvancedFilterOptionDataType.date,getQueryFilter:(e,t,i,n)=>{const o=this.getSelectedNamedOptionExpressions(n,e),[r,a]=e.value.filterValue.map(e=>(0,D.default)(e)),s=[];r&&r.isValid()&&s.push(this.rxRecordGridFilterService.buildQueryFilter(i,">=",r.format("YYYY-MM-DD"))),a&&a.isValid()&&s.push(this.rxRecordGridFilterService.buildQueryFilter(i,"<=",a.format("YYYY-MM-DD")));const l=this.rxRecordGridFilterService.joinQueryFilters(s,tp.And);return this.rxRecordGridFilterService.joinQueryFilters(l?[l,...o]:o,tp.Or)},getRecordGridFilterData:(e,t,i)=>{const[n,o]=e.filterValue.map(e=>(0,D.default)(e)),r=[];return n&&r.push(this.getRecordGridFilterOperator(d.RecordGridFilterOperator.Gte,i,n&&n.isValid()?n.format("YYYY-MM-DD"):"")),o&&r.push(this.getRecordGridFilterOperator(d.RecordGridFilterOperator.Lte,i,o&&o.isValid()?o.format("YYYY-MM-DD"):"")),this.getFilterRangeDataOperator(r,this.getNamedFilterOptionsOperators(e,i))},getSelectedAdvancedFilterData:(e,t,i,n)=>this.getDateSelectedAdvancedFilterData(n,e,t)},[a.RX_RECORD_DEFINITION.resourceTypes.dateTime]:{filterOptionDataType:u.AdvancedFilterOptionDataType.datetime,getQueryFilter:(e,t,i,n)=>{const o=this.getSelectedNamedOptionExpressions(n,e),[r,a]=e.value.filterValue.map(e=>(0,D.default)(e)),s=[];(null==r?void 0:r.isValid())&&s.push(this.rxRecordGridFilterService.buildQueryFilter(i,">=",r.toISOString())),(null==a?void 0:a.isValid())&&s.push(this.rxRecordGridFilterService.buildQueryFilter(i,"<=",a.toISOString()));const l=this.rxRecordGridFilterService.joinQueryFilters(s,tp.And);return this.rxRecordGridFilterService.joinQueryFilters(l?[l,...o]:o,tp.Or)},getRecordGridFilterData:(e,t,i)=>{const[n,o]=e.filterValue.map(e=>(0,D.default)(e)),r=[];return(null==n?void 0:n.isValid())&&r.push(this.getRecordGridFilterOperator(d.RecordGridFilterOperator.Gte,i,n.toISOString())),(null==o?void 0:o.isValid())&&r.push(this.getRecordGridFilterOperator(d.RecordGridFilterOperator.Lte,i,o.toISOString())),this.getFilterRangeDataOperator(r,this.getNamedFilterOptionsOperators(e,i))},getSelectedAdvancedFilterData:(e,t,i,n)=>this.getDateSelectedAdvancedFilterData(n,e,t)},[a.RX_RECORD_DEFINITION.resourceTypes.boolean]:{filterOptionDataType:u.AdvancedFilterOptionDataType.boolean,getQueryFilter:(e,t,i,n)=>{const o=this.getSelectedNamedOptionExpressions(n,e);return this.rxRecordGridFilterService.joinQueryFilters((0,m.castArray)(e.value.filterValue).map(e=>this.rxRecordGridFilterService.buildQueryFilter(i,"=",this.getBooleanFilterValue(e))).concat(o),tp.Or)},getRecordGridFilterData:(e,t,i)=>({or:(0,m.castArray)(e.filterValue).map(e=>this.getRecordGridFilterOperator(d.RecordGridFilterOperator.Eq,i,this.getBooleanFilterValue(e))).concat(this.getNamedFilterOptionsOperators(e,i))}),getDataForAdvancedFilter:e=>({selectOptions:[{name:this.translateService.instant("com.bmc.arsys.rx.client.common.true"),id:!0},{name:this.translateService.instant("com.bmc.arsys.rx.client.common.false"),id:!1},{name:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.filters.blank.label"),id:"blank"}],isRequired:e.fieldOption===a.RecordFieldOption.Required}),getSelectedAdvancedFilterData:(e,t,i,n)=>{let o;if(i.fieldOption===a.RecordFieldOption.Required)if(1===t.length){const e=(0,m.find)(t,e=>e[d.RecordGridFilterOperator.Eq]);if(e){const t=e[d.RecordGridFilterOperator.Eq][n];o="$NULL$"===t?null:["true"===t]}}else o=null;else o=[],e===d.RecordGridFilterDataLogic.Or&&t.forEach(e=>{const t=Object.keys(e)[0];if(t===d.RecordGridFilterOperator.Eq){const i=e[t][n];if(!i[d.RecordGridNamedFilterOptionKey])switch(i){case"true":o.push(!0);break;case"$NULL$":o.push(u.booleanDataTypeBlankValue);break;default:o.push(!1)}}});const r=this.getNamedFilterOptionGuids(t,n);return o?{filterOptionId:n,value:new rp(o,r)}:null}},[a.RX_RECORD_DEFINITION.resourceTypes.recordInstance]:null,[a.RX_RECORD_DEFINITION.resourceTypes.object]:null,[a.RX_RECORD_DEFINITION.resourceTypes.recordInstanceProcessVariable]:null,[a.RX_RECORD_DEFINITION.resourceTypes.localizedFieldInstance]:null}}getDateSelectedAdvancedFilterData(e,t,i){let n=[null,null];const o=t=>{const i=(0,m.find)(t,e=>e[d.RecordGridFilterOperator.Gte]);if(i){const t=(0,D.default)(i[d.RecordGridFilterOperator.Gte][e]);t.isValid()&&(n[0]=t)}const o=(0,m.find)(t,e=>e[d.RecordGridFilterOperator.Lte]);if(o){const t=(0,D.default)(o[d.RecordGridFilterOperator.Lte][e]);t.isValid()&&(n[1]=t)}};if(t===d.RecordGridFilterDataLogic.And)o(i);else if(t===d.RecordGridFilterDataLogic.Or){const t=(0,m.find)(i,e=>e[d.RecordGridFilterDataLogic.And]);if(t)o(t[d.RecordGridFilterDataLogic.And]);else if(1===i.length){let t=i[0][d.RecordGridFilterOperator.Eq][e];"$NULL$"===t||t[d.RecordGridNamedFilterOptionKey]||(t=(0,D.default)(t),n=[t,t])}}return{filterOptionId:e,value:new rp(n,this.getNamedFilterOptionGuids(i,e))}}getFilterRangeDataOperator(e,t){const i={and:e};return t.length?{or:e.length?t.concat(i):t}:i}getNamedFilterOptionGuids(e,t){return e.filter(e=>e[d.RecordGridFilterOperator.Eq]).map(e=>{const i=e[d.RecordGridFilterOperator.Eq][t];return i?i[d.RecordGridNamedFilterOptionKey]:null}).filter(e=>Boolean(e))}getSelectedNamedOptionExpressions(e,t){return e.filter(e=>t.value.namedOptions.includes(e.guid)).map(e=>e.filterExpression.replace(this.associatedFieldIdPatternRegExp,"${$1}"))}getNamedFilterOptionsOperators(e,t){return e.namedOptions.map(e=>this.getRecordGridFilterOperator(d.RecordGridFilterOperator.Eq,t,{[d.RecordGridNamedFilterOptionKey]:e}))}getRecordGridFilterOperator(e,t,i){return{[e]:{[t]:i}}}getBooleanFilterValue(e){return e?e===u.booleanDataTypeBlankValue?"$NULL$":"true":"false"}}dp.\u0275fac=function(e){return new(e||dp)(n["\u0275\u0275inject"](lp),n["\u0275\u0275inject"](v.RxNumberUtilsService),n["\u0275\u0275inject"](E.RxNamedListService),n["\u0275\u0275inject"](p.TranslateService),n["\u0275\u0275inject"](a.RxRecordInstanceUtilsService),n["\u0275\u0275inject"](kc),n["\u0275\u0275inject"](s.RxDefinitionNameService))},dp.\u0275prov=n["\u0275\u0275defineInjectable"]({token:dp,factory:dp.\u0275fac});class cp{constructor(){this.defaultFilterValue=[],this.namedFilterOptionsChange=new n.EventEmitter,this.namedFilterOptionsModel={}}set filterValue(e){const t=null==e?void 0:e.namedOptions;this._filterValue=e,Object.keys(this.namedFilterOptionsModel).forEach(e=>this.namedFilterOptionsModel[e]=!1),null==t||t.forEach(e=>this.namedFilterOptionsModel[e]=!0)}get filterValue(){return this._filterValue}trackByOptionGuid(e,t){return t.guid}onNamedFilterOptionChange(){var e,t;const i=this.getSelectedNamedOptionsIds();this.namedFilterOptionsChange.emit(i);const n=new rp(null!==(t=null===(e=this.filterValue)||void 0===e?void 0:e.filterValue)&&void 0!==t?t:this.defaultFilterValue,i);this.filterControlsComponent.onFilterOptionModelChange(n)}getSelectedNamedOptionsIds(){return(0,m.reduce)(this.namedFilterOptionsModel,(e,t,i)=>(t&&e.push(i),e),[])}}cp.\u0275fac=function(e){return new(e||cp)},cp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:cp,selectors:[["rx-named-filter-options-list"]],inputs:{namedFilterOptions:"namedFilterOptions",filterOption:"filterOption",filterValue:"filterValue",filterControlsComponent:"filterControlsComponent",defaultFilterValue:"defaultFilterValue"},outputs:{namedFilterOptionsChange:"namedFilterOptionsChange"},decls:1,vars:1,consts:[["class","options-wrapper",4,"ngIf"],[1,"options-wrapper"],["class","dropdown-item p-0 text-break",3,"label","ngModel","ngModelChange",4,"ngFor","ngForOf","ngForTrackBy"],[1,"dropdown-item","p-0","text-break",3,"label","ngModel","ngModelChange"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,On,2,2,"div",0),2&e&&n["\u0275\u0275property"]("ngIf",null==t.namedFilterOptions?null:t.namedFilterOptions.length)},directives:[f.NgIf,f.NgForOf,u.AdaptRxCheckboxComponent,b.NgControlStatus,b.NgModel],styles:[".options-wrapper[_ngcontent-%COMP%]{margin-top:-1.5rem;margin-bottom:-2px}adapt-rx-checkbox[_ngcontent-%COMP%]:not(:last-child){margin-bottom:14px}.dropdown-item[_ngcontent-%COMP%]{white-space:normal}"]});class pp{constructor(){this.namedFilterOptions=[],this.isRequired=!1}set filterValue(e){const t=this.getSelectOptions();this._filterValue=e,this.selectedValues=(null==e?void 0:e.filterValue)?e.filterValue.map(e=>(0,m.find)(t,{id:e})):[]}get filterValue(){return this._filterValue}selectOptionFormatter(e){return e.name}onValueChange(e){var t;const i=e.map(e=>e.id);this.filterControlsComponent.onFilterOptionModelChange(new rp(i,null===(t=this.filterValue)||void 0===t?void 0:t.namedOptions))}getSelectOptions(){var e;return(null===(e=this.filterOption.data)||void 0===e?void 0:e.selectOptions)||[]}onValueChangeRequired(e){var t,i,n;const o=Array.isArray(null===(t=this.filterValue)||void 0===t?void 0:t.filterValue)?this.filterValue.filterValue[0]:null===(i=this.filterValue)||void 0===i?void 0:i.filterValue;this.filterControlsComponent.onFilterOptionModelChange(new rp(e===o?null:[e],null===(n=this.filterValue)||void 0===n?void 0:n.namedOptions))}}pp.\u0275fac=function(e){return new(e||pp)},pp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:pp,selectors:[["rx-boolean-filter"]],inputs:{filterOption:"filterOption",filterValue:"filterValue",filterControlsComponent:"filterControlsComponent",namedFilterOptions:"namedFilterOptions",isRequired:"isRequired"},decls:4,vars:3,consts:[[3,"namedFilterOptions","filterOption","filterValue","filterControlsComponent",4,"ngIf"],["class","advanced-filter__rx-select advanced-filter__rx-select_simple",3,"inline","multiple","optionFormatter","options","popupMaxHeight","ngModel","ngModelChange",4,"ngIf","ngIfElse"],["inputsForBooleanTypeTemplate",""],[3,"namedFilterOptions","filterOption","filterValue","filterControlsComponent"],[1,"advanced-filter__rx-select","advanced-filter__rx-select_simple",3,"inline","multiple","optionFormatter","options","popupMaxHeight","ngModel","ngModelChange"],[1,"advanced-filter__radiobutton-group",3,"ngModel","ngModelChange"],["name","booleanTypeGroup",1,"advanced-filter__radiobutton",3,"value","label","testID","disabled"],["name","booleanTypeGroup","class","advanced-filter__radiobutton",3,"value","label","testID","disabled",4,"ngIf"]],template:function(e,t){if(1&e&&(n["\u0275\u0275template"](0,Pn,1,4,"rx-named-filter-options-list",0),n["\u0275\u0275template"](1,Tn,1,6,"adapt-rx-select",1),n["\u0275\u0275template"](2,Nn,4,10,"ng-template",null,2,n["\u0275\u0275templateRefExtractor"])),2&e){const e=n["\u0275\u0275reference"](3);n["\u0275\u0275property"]("ngIf",null==t.namedFilterOptions?null:t.namedFilterOptions.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.isRequired)("ngIfElse",e)}},directives:[f.NgIf,cp,u.AdaptRxSelectComponent,b.NgControlStatus,b.NgModel,u.AdaptRxRadiobuttonGroupComponent,u.AdaptRxRadiobuttonComponent],encapsulation:2});class mp{constructor(e,t,i){this.rxNamedListService=e,this.rxNamedListDefinitionService=t,this.rxFeatureService=i,this.namedFilterOptions=[],this.selectedValues=[],this.isSearchInProgress=!1,this.search=e=>e.pipe((0,r.debounceTime)(250),(0,r.distinctUntilChanged)(),(0,r.tap)(()=>{this.isSearchInProgress=!0}),(0,r.switchMap)(e=>this.getSelectOptions(e)),(0,r.finalize)(()=>{this.isSearchInProgress=!1}))}set filterValue(e){this._filterValue=e,this.selectedValues=(null==e?void 0:e.filterValue)||[]}get filterValue(){return this._filterValue}ngOnInit(){var e;this.namedListDefinition$=this.rxNamedListDefinitionService.get(this.filterOption.data.namedListDefinition).pipe((0,r.shareReplay)(1)),this.typeaheadKeystrokeCount=null!==(e=this.filterOption.data.typeaheadKeystrokeCount)&&void 0!==e?e:Nc.defaultTypeaheadKeystrokeCount}onValueChange(e){var t;this.filterControlsComponent.onFilterOptionModelChange(new rp(e.map(e=>this.rxNamedListService.isNamedListOption(e)?e:{displayValue:void 0,value:e,title:"",contextualFields:[]}),null===(t=this.filterValue)||void 0===t?void 0:t.namedOptions))}getSelectOptions(e){return e.length>=this.typeaheadKeystrokeCount?this.namedListDefinition$.pipe((0,r.switchMap)(t=>this.rxNamedListService.getOptionPageByLabelOrValue(t,e,this.filterOption.data.additionalQueryCriteria).pipe((0,r.map)(e=>e.options)))):(0,o.of)([])}}mp.\u0275fac=function(e){return new(e||mp)(n["\u0275\u0275directiveInject"](E.RxNamedListService),n["\u0275\u0275directiveInject"](E.RxNamedListDefinitionService),n["\u0275\u0275directiveInject"](s.RxFeatureService))},mp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:mp,selectors:[["rx-string-with-type-ahead-filter"]],inputs:{filterOption:"filterOption",filterControlsComponent:"filterControlsComponent",filterValue:"filterValue",namedFilterOptions:"namedFilterOptions"},decls:9,vars:11,consts:[[3,"namedFilterOptions","filterOption","filterValue","filterControlsComponent",4,"ngIf"],[2,"position","relative"],[3,"search","ngModel","replaceModelOnWrite","selectItemTemplate","tagTemplate","openDropdownOnFocus","placeholder","ngModelChange"],["class","position-absolute text-info inline-loader",4,"ngIf"],["tagTemplate",""],["selectItemTemplate",""],[3,"namedFilterOptions","filterOption","filterValue","filterControlsComponent"],[1,"position-absolute","text-info","inline-loader"],[1,"d-icon-circle_75_o","animated","infinite","spin-360","transition-out","slow"],["class","text-secondary selection-item-contextual-fields text-truncate",3,"title",4,"ngIf"],[1,"text-secondary","selection-item-contextual-fields","text-truncate",3,"title"],["class","breadcrumb-item active",4,"ngFor","ngForOf"],[1,"breadcrumb-item","active"]],template:function(e,t){if(1&e&&(n["\u0275\u0275template"](0,kn,1,4,"rx-named-filter-options-list",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275elementStart"](2,"adapt-tag-field",2),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.onValueChange(e)}),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](4,jn,2,0,"div",3),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](5,_n,1,1,"ng-template",null,4,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](7,Ln,2,2,"ng-template",null,5,n["\u0275\u0275templateRefExtractor"])),2&e){const e=n["\u0275\u0275reference"](6),i=n["\u0275\u0275reference"](8);n["\u0275\u0275property"]("ngIf",null==t.namedFilterOptions?null:t.namedFilterOptions.length),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("search",t.search)("ngModel",t.selectedValues)("replaceModelOnWrite",!0)("selectItemTemplate",i)("tagTemplate",e)("openDropdownOnFocus",0===t.typeaheadKeystrokeCount)("placeholder",n["\u0275\u0275pipeBind1"](3,9,"com.bmc.arsys.rx.client.view-components.record-grid.filters.typeahead.placeholder")),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.isSearchInProgress)}},directives:[f.NgIf,u.AdaptMetatagComponent,b.NgControlStatus,b.NgModel,cp,f.NgForOf],pipes:[p.TranslatePipe],styles:[".inline-loader[_ngcontent-%COMP%]{z-index:10;right:15px;top:8px}.selection-item-contextual-fields[_ngcontent-%COMP%]{max-width:300px}"]});class up{constructor(){this.namedFilterOptions=[]}onStringTypeFilterOptionModelChange(e,t){var i,n;const o=e.filter(e=>!(0,u.isEmptyOrWhitespace)((0,u.getTagText)(e)));o.length<e.length&&(0,m.isEqual)(o,(null===(i=this.filterValue)||void 0===i?void 0:i.filterValue)||[])?t.writeValue(o):this.filterControlsComponent.onFilterOptionModelChange(new rp(o,null===(n=this.filterValue)||void 0===n?void 0:n.namedOptions))}}up.\u0275fac=function(e){return new(e||up)},up.\u0275cmp=n["\u0275\u0275defineComponent"]({type:up,selectors:[["rx-string-filter"]],inputs:{filterOption:"filterOption",filterValue:"filterValue",filterControlsComponent:"filterControlsComponent",namedFilterOptions:"namedFilterOptions"},decls:3,vars:9,consts:[[3,"namedFilterOptions","filterOption","filterValue","filterControlsComponent",4,"ngIf"],["mainCls","advanced-filter__string-tag-field","popupClass","advanced-filter__typeahead-window",3,"ngModel","testID","delimiterSymbol","placeholder","replaceModelOnWrite","disabled","hideLabel","ngModelChange"],["stringDataTypeTagField",""],[3,"namedFilterOptions","filterOption","filterValue","filterControlsComponent"]],template:function(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275template"](0,Gn,1,4,"rx-named-filter-options-list",0),n["\u0275\u0275elementStart"](1,"adapt-tag-field",1,2),n["\u0275\u0275listener"]("ngModelChange",function(i){n["\u0275\u0275restoreView"](e);const o=n["\u0275\u0275reference"](2);return t.onStringTypeFilterOptionModelChange(i,o)}),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275property"]("ngIf",null==t.namedFilterOptions?null:t.namedFilterOptions.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngModel",(null==t.filterValue?null:t.filterValue.filterValue)||n["\u0275\u0275pureFunction0"](8,et))("testID",t.filterControlsComponent.testID)("delimiterSymbol",null)("placeholder",t.filterControlsComponent.texts.stringTypeTagFieldPlaceholder)("replaceModelOnWrite",!0)("disabled",t.filterControlsComponent.isInputDisabled())("hideLabel",!0))},directives:[f.NgIf,u.AdaptMetatagComponent,b.NgControlStatus,b.NgModel,cp],encapsulation:2});class fp{getNumberDataTypeModel(e,t){return e&&e.filterValue?e.filterValue[t]:null}onNumberTypeFilterOptionModelChange(e,t,i){t.onFilterOptionModelChange(new rp(i,null==e?void 0:e.namedOptions))}}fp.\u0275fac=function(e){return new(e||fp)},fp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:fp,selectors:[["rx-number-filter"]],inputs:{filterOption:"filterOption",filterControlsComponent:"filterControlsComponent",filterValue:"filterValue",namedFilterOptions:"namedFilterOptions"},decls:8,vars:15,consts:[[3,"namedFilterOptions","filterOption","filterValue","filterControlsComponent",4,"ngIf"],[1,"d-flex"],[1,"advanced-filter__counter-from-wrap"],[1,"advanced-filter__counter-from",3,"label","ngModel","min","max","disabled","testID","ngModelChange"],["counterFrom",""],[1,"advanced-filter__counter-to-wrap"],[1,"advanced-filter__counter-to",3,"label","ngModel","min","max","disabled","testID","ngModelChange"],["counterTo",""],[3,"namedFilterOptions","filterOption","filterValue","filterControlsComponent"]],template:function(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275template"](0,qn,1,4,"rx-named-filter-options-list",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275elementStart"](2,"div",2),n["\u0275\u0275elementStart"](3,"adapt-rx-counter",3,4),n["\u0275\u0275listener"]("ngModelChange",function(i){n["\u0275\u0275restoreView"](e);const o=n["\u0275\u0275reference"](7);return t.onNumberTypeFilterOptionModelChange(t.filterValue,t.filterControlsComponent,[i,o?t.getNumberDataTypeModel(t.filterValue,1):null])}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",5),n["\u0275\u0275elementStart"](6,"adapt-rx-counter",6,7),n["\u0275\u0275listener"]("ngModelChange",function(i){n["\u0275\u0275restoreView"](e);const o=n["\u0275\u0275reference"](4);return t.onNumberTypeFilterOptionModelChange(t.filterValue,t.filterControlsComponent,[o?t.getNumberDataTypeModel(t.filterValue,0):null,i])}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275property"]("ngIf",null==t.namedFilterOptions?null:t.namedFilterOptions.length),n["\u0275\u0275advance"](1),n["\u0275\u0275classProp"]("has-danger",t.filterControlsComponent.hasValidationErrors),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("label",t.filterControlsComponent.texts.counterFromLabel)("ngModel",t.getNumberDataTypeModel(t.filterValue,0))("min",t.filterControlsComponent.getNumberDataTypeMinAllowedValue())("max",t.filterControlsComponent.getNumberDataTypeMaxAllowedValue())("disabled",t.filterControlsComponent.isInputDisabled())("testID",t.filterControlsComponent.testID+"_from"),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("label",t.filterControlsComponent.texts.counterToLabel)("ngModel",t.getNumberDataTypeModel(t.filterValue,1))("min",t.filterControlsComponent.getNumberDataTypeMinAllowedValue())("max",t.filterControlsComponent.getNumberDataTypeMaxAllowedValue())("disabled",t.filterControlsComponent.isInputDisabled())("testID",t.filterControlsComponent.testID+"_to"))},directives:[f.NgIf,u.AdaptRxCounterComponent,b.NgControlStatus,b.NgModel,cp],encapsulation:2});class hp extends u.AdaptRxDatetimeAdapter{fromModel(e){let t=null;const i=(0,D.default)(e);return i&&i.isValid()&&(t={year:i.year(),month:i.month(),date:i.date(),hours:i.hours(),minutes:i.minutes(),seconds:i.seconds()}),t}toModel(e){var t,i,n,o,r,a;let s=null;if(e){const l=(0,D.default)();s=e.parseError?D.default.invalid({invalidFormat:!0,parsedDateParts:[e.parseError.query],meridiem:e.parseError.use12HoursTime?"12":"24"}):(0,D.default)([null!==(t=e.year)&&void 0!==t?t:l.year(),null!==(i=e.month)&&void 0!==i?i:l.month(),null!==(n=e.date)&&void 0!==n?n:l.date(),null!==(o=e.hours)&&void 0!==o?o:0,null!==(r=e.minutes)&&void 0!==r?r:0,null!==(a=e.seconds)&&void 0!==a?a:0])}return s}}hp.\u0275fac=function(){let e;return function(t){return(e||(e=n["\u0275\u0275getInheritedFactory"](hp)))(t||hp)}}(),hp.\u0275prov=n["\u0275\u0275defineInjectable"]({token:hp,factory:hp.\u0275fac});class gp{constructor(){this.rxDatetimePickerMode=u.RxDatetimePickerMode}onTimeTypeFilterOptionModelChange(e){this.onDateTimeTypeFilterOptionModelChange(e)}onDateTypeFilterOptionModelChange(e){e[0]&&e[0].isValid()&&(e[0]=e[0].startOf("day")),e[1]&&e[1].isValid()&&(e[1]=e[1].startOf("day")),this.onDateTimeTypeFilterOptionModelChange(e)}onDateTimeTypeFilterOptionModelChange(e){var t;this.filterControlsComponent.onFilterOptionModelChange(new rp(e,null===(t=this.filterValue)||void 0===t?void 0:t.namedOptions))}}gp.\u0275fac=function(e){return new(e||gp)},gp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:gp,selectors:[["rx-date-time-range-filter"]],inputs:{filterOption:"filterOption",filterControlsComponent:"filterControlsComponent",filterValue:"filterValue",namedFilterOptions:"namedFilterOptions",mode:"mode"},features:[n["\u0275\u0275ProvidersFeature"]([{provide:u.AdaptRxDatetimeAdapter,useClass:hp}])],decls:11,vars:5,consts:[[3,"namedFilterOptions","filterOption","filterValue","filterControlsComponent",4,"ngIf"],[3,"ngSwitch"],[3,"ngTemplateOutlet",4,"ngSwitchCase"],["inputsForTimeTypeTemplate",""],["inputsForDateTypeTemplate",""],["inputsForDatetimeTypeTemplate",""],[3,"namedFilterOptions","filterOption","filterValue","filterControlsComponent"],[3,"ngTemplateOutlet"],[1,"advanced-filter__datetime",3,"ngModel","testID","mode","hasSeconds","inline","inlineLight","texts","disabled","ngModelChange"],[1,"advanced-filter__datetime",3,"ngModel","testID","mode","inline","inlineLight","texts","disabled","ngModelChange"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,Un,1,4,"rx-named-filter-options-list",0),n["\u0275\u0275elementContainerStart"](1,1),n["\u0275\u0275template"](2,zn,1,1,"ng-container",2),n["\u0275\u0275template"](3,Xn,1,1,"ng-container",2),n["\u0275\u0275template"](4,Wn,1,1,"ng-container",2),n["\u0275\u0275elementContainerEnd"](),n["\u0275\u0275template"](5,Hn,1,8,"ng-template",null,3,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](7,Qn,1,7,"ng-template",null,4,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](9,Jn,1,8,"ng-template",null,5,n["\u0275\u0275templateRefExtractor"])),2&e&&(n["\u0275\u0275property"]("ngIf",null==t.namedFilterOptions?null:t.namedFilterOptions.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngSwitch",t.mode),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngSwitchCase",t.rxDatetimePickerMode.Time),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngSwitchCase",t.rxDatetimePickerMode.Date),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngSwitchCase",t.rxDatetimePickerMode.DateTime))},directives:[f.NgIf,f.NgSwitch,f.NgSwitchCase,cp,f.NgTemplateOutlet,u.AdaptRxDatetimeRangeComponent,b.NgControlStatus,b.NgModel],encapsulation:2});class vp{set filterValue(e){this._filterValue=e;const t=this.getSelectionTypeOptions();this.selectionTypeModel=t.length&&(null==e?void 0:e.filterValue)?e.filterValue.map(e=>t.find(t=>t.id===e)):null}get filterValue(){return this._filterValue}getSelectionTypeOptions(){var e;const t=this.filterOption.data;return null!==(e=null==t?void 0:t.selectOptions)&&void 0!==e?e:[]}onSelectionTypeFilterOptionModelChange(e){var t;this.filterControlsComponent.onFilterOptionModelChange(new rp(e.map(e=>e.id),null===(t=this.filterValue)||void 0===t?void 0:t.namedOptions))}}vp.\u0275fac=function(e){return new(e||vp)},vp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:vp,selectors:[["rx-selection-filter"]],inputs:{filterOption:"filterOption",filterControlsComponent:"filterControlsComponent",filterValue:"filterValue",namedFilterOptions:"namedFilterOptions"},decls:2,vars:14,consts:[[3,"namedFilterOptions","filterOption","filterValue","filterControlsComponent",4,"ngIf"],[1,"advanced-filter__rx-select",3,"inline","multiple","selectAllButton","deselectAllButton","enableFilter","optionFormatter","options","texts","popupMaxHeight","ngModel","disabledOptionResolver","ngModelChange"],[3,"namedFilterOptions","filterOption","filterValue","filterControlsComponent"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,Kn,1,4,"rx-named-filter-options-list",0),n["\u0275\u0275elementStart"](1,"adapt-rx-select",1),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.onSelectionTypeFilterOptionModelChange(e)}),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("ngIf",null==t.namedFilterOptions?null:t.namedFilterOptions.length),n["\u0275\u0275advance"](1),n["\u0275\u0275classProp"]("advanced-filter__rx-select_simple",t.filterControlsComponent.canShowSimpleInlineSelect()),n["\u0275\u0275property"]("inline",!0)("multiple",!0)("selectAllButton",!0)("deselectAllButton",!0)("enableFilter",!t.filterControlsComponent.canShowSimpleInlineSelect())("optionFormatter",t.filterControlsComponent.selectOptionFormatter)("options",t.filterControlsComponent.getSelectionTypeOptions())("texts",t.filterControlsComponent.getSelectionTypeTexts())("popupMaxHeight",null)("ngModel",t.selectionTypeModel)("disabledOptionResolver",t.filterControlsComponent.disabledSelectInputResolverBind))},directives:[f.NgIf,u.AdaptRxSelectComponent,b.NgControlStatus,b.NgModel,cp],encapsulation:2});class yp{constructor(){this.rxDatetimePickerMode=u.RxDatetimePickerMode,this.namedFilterOptionsGetter=e=>[]}}yp.\u0275fac=function(e){return new(e||yp)},yp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:yp,selectors:[["rx-advanced-filtering-fields-provider"]],viewQuery:function(e,t){if(1&e&&(n["\u0275\u0275viewQuery"](Yn,7),n["\u0275\u0275viewQuery"](Zn,7),n["\u0275\u0275viewQuery"](eo,7),n["\u0275\u0275viewQuery"](to,7),n["\u0275\u0275viewQuery"](io,7),n["\u0275\u0275viewQuery"](no,7),n["\u0275\u0275viewQuery"](oo,7),n["\u0275\u0275viewQuery"](ro,7),n["\u0275\u0275viewQuery"](ao,7)),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.optionalBooleanFilter=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.requiredBooleanFilter=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.inputsForStringWithTypeAheadTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.inputsForStringTypeTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.inputsForNumberTypeTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.inputsForTimeTypeTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.inputsForDateTypeTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.inputsForDatetimeTypeTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.inputsForSelectionTypeTemplate=e.first)}},inputs:{namedFilterOptionsGetter:"namedFilterOptionsGetter"},decls:18,vars:0,consts:[["optionalBooleanFilter",""],["requiredBooleanFilter",""],["inputsForStringWithTypeAheadTemplate",""],["inputsForStringTypeTemplate",""],["inputsForNumberTypeTemplate",""],["inputsForTimeTypeTemplate",""],["inputsForDateTypeTemplate",""],["inputsForDatetimeTypeTemplate",""],["inputsForSelectionTypeTemplate",""],[3,"filterControlsComponent","filterOption","filterValue","isRequired","namedFilterOptions"],[3,"filterControlsComponent","filterOption","filterValue","namedFilterOptions"],[3,"filterOption","filterValue","filterControlsComponent","namedFilterOptions"],[3,"filterOption","filterValue","filterControlsComponent","mode","namedFilterOptions"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,so,1,5,"ng-template",null,0,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](2,lo,1,5,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](4,co,1,4,"ng-template",null,2,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](6,po,1,4,"ng-template",null,3,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](8,mo,1,4,"ng-template",null,4,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](10,uo,1,5,"ng-template",null,5,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](12,fo,1,5,"ng-template",null,6,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](14,ho,1,5,"ng-template",null,7,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](16,go,1,4,"ng-template",null,8,n["\u0275\u0275templateRefExtractor"]))},directives:[pp,mp,up,fp,gp,vp],encapsulation:2});class xp{constructor(e){this.rxRecordGridUtilsService=e,this.restTagsDropdownPlacement=["bottom","bottom-right","auto"],this.removeTag=new n.EventEmitter,this.trackByForFilterTags=this.trackByForFilterTags.bind(this)}getTranslateParams(){return{count:this.getRestTagsCount()}}getRestTagsCount(){return this.tagsLimit&&this.tags?this.tags.length-this.tagsLimit:0}onRemoveFilterTag(e){const t=e.data.filterOption,i=(0,m.clone)(this.tags);let n;if((0,m.isNull)(t))n=(0,m.findIndex)(i,e=>this.rxRecordGridUtilsService.isSharedFilterPresetTag(e));else{const t=e.data.filterOption.id;n=(0,m.findIndex)(i,e=>(0,m.get)(e.data.filterOption,"id")===t)}n>-1&&i.splice(n,1),this.removeTag.emit({removedTag:e,newTags:i})}trackByForFilterTags(e,t){return this.rxRecordGridUtilsService.isSharedFilterPresetTag(t)?e:t.data.filterOption.id||e}}xp.\u0275fac=function(e){return new(e||xp)(n["\u0275\u0275directiveInject"](kc))},xp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:xp,selectors:[["rx-filter-tags"]],inputs:{tags:"tags",isDisabled:"isDisabled",tagsLimit:"tagsLimit",restTagsDropdownPlacement:"restTagsDropdownPlacement"},outputs:{removeTag:"removeTag"},decls:4,vars:7,consts:[["class","mr-1","type","active",3,"removable","disabled","remove",4,"ngFor","ngForOf","ngForTrackBy"],["adaptDropdown","",3,"appendToBody","placement",4,"ngIf"],["type","active",1,"mr-1",3,"removable","disabled","remove"],[1,"filter-tags__tag-text",3,"title"],["adaptDropdown","",3,"appendToBody","placement"],["adaptDropdownToggle","","type","button",1,"filter-tags__dropdown-toggle","btn","btn-link","p-0","ml-1"],["adaptDropdownMenu","",1,"dropdown-menu","filter-tags__dropdown-menu","p-2"],[4,"ngFor","ngForOf","ngForTrackBy"],["type","active",3,"removable","remove"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275template"](1,vo,3,4,"adapt-tag",0),n["\u0275\u0275pipe"](2,"slice"),n["\u0275\u0275template"](3,xo,7,11,"span",1),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",n["\u0275\u0275pipeBind3"](2,3,t.tags,0,t.tagsLimit?t.tagsLimit:null==t.tags?null:t.tags.length))("ngForTrackBy",t.trackByForFilterTags),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.getRestTagsCount()>0))},directives:[f.NgForOf,f.NgIf,u.AdaptTagComponent,u.AdaptDropdownDirective,u.AdaptDropdownToggleDirective,u.AdaptDropdownMenuDirective],pipes:[f.SlicePipe,p.TranslatePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.filter-tags__dropdown-toggle[_ngcontent-%COMP%]:after{border:0!important}.filter-tags__tag-text[_ngcontent-%COMP%]{display:table-cell;max-width:190px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.filter-tags__dropdown-menu[_ngcontent-%COMP%]   .filter-tags__tag-text[_ngcontent-%COMP%]{max-width:350px}'],changeDetection:0});class bp extends l.ValueAccessor{constructor(e,t,i,n,r,a,s,l,d,c,p,m){super(),this.injector=e,this.rxModalService=t,this.rxRecordGridUtilsService=i,this.rxRecordGridFilterConfigService=n,this.rxRecordDefinitionCacheService=r,this.rxRecordGridFilterService=a,this.rxRecordGridFilterHelperService=s,this.rxRecordDefinitionService=l,this.rxGuidService=d,this.rxRecordGridAdvancedFilteringService=c,this.rxGlobalCacheService=p,this.rxDefinitionNameService=m,this.advancedFilterData={filterOptions:[],selectedFilters:[],filterTexts:{initialDropdownAnchorLabel:"Filter"},recordGridFilterConfigs:null,fieldDefinitionsById:{},fieldDefinitionsInitialized$:new o.Subject,filterValueInitialized$:new o.Subject,associationDescriptors:[]},this.subscription=new o.Subscription,this.getNamedFilterOptions=this.getNamedFilterOptions.bind(this),this.initEmptyValue(),this.advancedFilterData.recordGridFilterConfigs=this.rxRecordGridFilterConfigService.getConfigs(),this.subscription.add((0,o.combineLatest)([this.advancedFilterData.filterValueInitialized$,this.advancedFilterData.fieldDefinitionsInitialized$]).subscribe(()=>{this.initSelectedAdvancedFilters(this.value)}))}getGroupFilterName(e){var t;return null===(t=this.groupFilterItems.find(t=>t.value===e))||void 0===t?void 0:t.name}onGroupFilterValueModelChange(e){this.groupFilterValue=e}ngOnInit(){this.initFilterOptions()}initEmptyValue(){this.innerValue={basicFilters:null,filtersJson:null}}ngOnChanges(e){var t,i;e.options&&e.options.previousValue&&(null===(t=e.options.currentValue.primaryRecordDefinition)||void 0===t?void 0:t.name)!==(null===(i=e.options.previousValue.primaryRecordDefinition)||void 0===i?void 0:i.name)&&(this.initEmptyValue(),this.advancedFilterData.selectedFilters=[],this.advancedFilterData.filterOptions=[],this.initFilterOptions())}initFilterOptions(){this.groupFilterItems=[],this.options.primaryRecordDefinition&&this.rxRecordGridUtilsService.getAssociationDescriptors(this.options.primaryRecordDefinition.name).pipe((0,r.switchMap)(e=>{this.advancedFilterData.associationDescriptors=e;const t=(0,m.uniq)(e.map(e=>e.recordDefinitionName));return(t.length?(0,o.forkJoin)(t.map(e=>this.rxRecordDefinitionCacheService.getRecordDefinition(e))):(0,o.of)([])).pipe((0,r.map)(t=>({recordDefinitions:t,associationDescriptors:e})))}),(0,r.take)(1)).subscribe(({recordDefinitions:e,associationDescriptors:t})=>{const i=(0,m.cloneDeep)(this.options.primaryRecordDefinition);[i,...e].forEach(e=>{e.fieldDefinitionsById||(e.fieldDefinitionsById=this.rxRecordDefinitionService.buildFieldDefinitionsByIdMap(e))}),this.groupFilterValue=i.name,this.advancedFilterData.fieldDefinitionsById=this.rxRecordGridAdvancedFilteringService.addAssociationFieldsToFieldDefinitionsById(i.fieldDefinitionsById,t,e),t.forEach(t=>{const i=(0,m.find)(e,e=>e.name===t.recordDefinitionName);this.groupFilterItems.push({name:t.label,value:t.label}),this.advancedFilterData.filterOptions.push(...this.getFilterOptions(i,t,t.label))}),this.groupFilterItems=this.groupFilterItems.sort((e,t)=>e.name.localeCompare(t.name));const n=this.rxDefinitionNameService.getDisplayName(i.name);this.advancedFilterData.filterOptions.push(...this.getFilterOptions(i,null,null)),this.groupFilterItems.unshift({name:n,value:i.name}),this.advancedFilterData.fieldDefinitionsInitialized$.next()})}onRemoveFilterTag(e){const t=this.advancedFilterData.selectedFilters.slice(),i=e.removedTag.data.filterOption.id,n=(0,m.findIndex)(t,e=>e.filterOptionId===i);t.splice(n,1),this.onAdvancedFiltersChange(t)}getFilterOptions(e,t,i){return e.fieldDefinitions.map(e=>{const n=this.advancedFilterData.recordGridFilterConfigs[e.resourceType],o=this.rxRecordGridUtilsService.getColumnLabel(e,null),r=this.rxRecordGridUtilsService.getFieldIdForGridColumn(e.id,t),a=this.rxRecordGridAdvancedFilteringService.getAdvancedFilterOption(r,o,e,n,!1,{optionalBooleanFilter:this.fieldsProvider.optionalBooleanFilter,requiredBooleanFilter:this.fieldsProvider.requiredBooleanFilter,inputsForStringWithTypeAheadTemplate:this.fieldsProvider.inputsForStringWithTypeAheadTemplate,inputsForStringTypeTemplate:this.fieldsProvider.inputsForStringTypeTemplate,inputsForNumberTypeTemplate:this.fieldsProvider.inputsForNumberTypeTemplate,inputsForTimeTypeTemplate:this.fieldsProvider.inputsForTimeTypeTemplate,inputsForDateTypeTemplate:this.fieldsProvider.inputsForDateTypeTemplate,inputsForDatetimeTypeTemplate:this.fieldsProvider.inputsForDatetimeTypeTemplate,inputsForSelectionTypeTemplate:this.fieldsProvider.inputsForSelectionTypeTemplate},i?`${i} > ${o}`:null,this.options.namedFilterOptions?this.options.namedFilterOptions[r]:[]),s=t?t.label:this.options.primaryRecordDefinition.name;return a.isHidden=()=>{var e;return this.groupFilterValue!==s||!1===(null===(e=this.options.selectedFieldIds)||void 0===e?void 0:e.includes(r))},a}).sort((e,t)=>e.label.localeCompare(t.label))}ngOnDestroy(){this.subscription.unsubscribe()}onAdvancedFiltersChange(e){this.advancedFilterData.selectedFilters=e;const t=this.value.basicFilters||[],i=(0,m.reduce)(e,(e,i)=>{const n=i.filterOptionId,o=this.advancedFilterData.fieldDefinitionsById[n],r=this.advancedFilterData.recordGridFilterConfigs[o.resourceType].getRecordGridFilterData(i.value,o,n);return(r.or||r.and).forEach(i=>{const o=(0,m.values)(i)[0][n],r=(0,m.values)(i)[0].$DISPLAYVALUE$,a=(0,m.find)(t,t=>t.fieldId===n&&t.value===o&&(0,m.every)(e,e=>e.guid!==t.guid)),s={fieldId:n,value:o,$DISPLAYVALUE$:r,guid:a&&a.guid||this.rxGuidService.generate()};e.push(s)}),e},[]),n=this.rxRecordGridFilterService.getRecordGridFilterDataFromAdvancedFilter(e,this.advancedFilterData.fieldDefinitionsById,this.advancedFilterData.recordGridFilterConfigs);let o=(0,m.isEmpty)(n)?null:JSON.stringify(n);o&&(o=this.rxRecordGridFilterHelperService.denormalizeFilterString(o,i)),this.filtersModel={basicFilters:i,filtersJson:o},this.value={basicFilters:i,filtersJson:o}}onWriteValue(e){(0,m.isEqual)(this.filtersModel,e)||this.advancedFilterData.filterValueInitialized$.next()}initSelectedAdvancedFilters(e){(null==e?void 0:e.filtersJson)&&!(0,m.isEmpty)(e.basicFilters)&&this.rxRecordGridFilterService.getSelectedFiltersFromPredefinedFilter(e.filtersJson,e.basicFilters,this.advancedFilterData.fieldDefinitionsById,this.advancedFilterData.recordGridFilterConfigs,this.options.primaryRecordDefinition,this.advancedFilterData.filterOptions,this.advancedFilterData.associationDescriptors).pipe((0,r.map)(e=>this.options.namedFilterOptions?this.rxRecordGridFilterService.clearRemovedNamedFilterOptions(e,this.options.namedFilterOptions):e)).subscribe(e=>{this.advancedFilterData.selectedFilters=e})}getNamedFilterOptions(e){return this.options.namedFilterOptions?this.options.namedFilterOptions[e.id]:[]}getTags(e){var t;const i=(null!==(t=null==e?void 0:e.filter(e=>(0,m.isEmpty)(e.data.validationErrors)))&&void 0!==t?t:[]).map(e=>{var t,i;if(e.data.filterOption){const n=e.data.filterOption.id,o=e.data.filterOption.data,a=this.advancedFilterData.recordGridFilterConfigs[null==o?void 0:o.resourceType];if((0,m.isFunction)(null==a?void 0:a.getToolbarTagInfo))return a.getToolbarTagInfo({primaryRecordDefinition:this.options.primaryRecordDefinition,fieldDefinition:o,value:e.data.value,tag:e,fieldId:n,namedFilterOptions:null!==(i=null===(t=this.options.namedFilterOptions)||void 0===t?void 0:t[n])&&void 0!==i?i:[]}).pipe((0,r.tap)(t=>e.data.value.title=t.tooltip),(0,r.map)(t=>Object.assign(Object.assign({},e),{text:t.text})))}return(0,o.of)(Object.assign({},e))});return i.length?(0,o.forkJoin)(i):(0,o.of)([])}}bp.\u0275fac=function(e){return new(e||bp)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](S.RxModalService),n["\u0275\u0275directiveInject"](kc),n["\u0275\u0275directiveInject"](dp),n["\u0275\u0275directiveInject"](a.RxRecordDefinitionCacheService),n["\u0275\u0275directiveInject"](lp),n["\u0275\u0275directiveInject"](sp),n["\u0275\u0275directiveInject"](a.RxRecordDefinitionService),n["\u0275\u0275directiveInject"](v.RxGuidService),n["\u0275\u0275directiveInject"](ap),n["\u0275\u0275directiveInject"](s.RxGlobalCacheService),n["\u0275\u0275directiveInject"](s.RxDefinitionNameService))},bp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:bp,selectors:[["rx-record-grid-filter-select-control"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](yp,7),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.fieldsProvider=e.first)}},inputs:{options:"options"},features:[n["\u0275\u0275ProvidersFeature"]([{provide:b.NG_VALUE_ACCESSOR,useExisting:bp,multi:!0}]),n["\u0275\u0275InheritDefinitionFeature"],n["\u0275\u0275NgOnChangesFeature"]],decls:4,vars:2,consts:[[4,"ngIf"],["filterOptionsCustomAreaTemplate",""],[3,"namedFilterOptionsGetter"],[3,"hidden","appendDropdownToBody","enableSavedFilters","filterOptions","selectedFilters","texts","applyFiltersByUserAction","filterOptionsCustomAreaTemplate","selectedFiltersIndicationStyle","anchorDisabled","selectedFiltersChange"],["advancedFilter",""],[3,"isDisabled","tags","tagsLimit","restTagsDropdownPlacement","removeTag"],["class","p-3 pt-4 pb-4",4,"ngIf"],[1,"p-3","pt-4","pb-4"],[3,"title","multiline"],[1,"advanced-filter__radiobutton-group",3,"ngModel","ngModelChange"],["name","booleanTypeGroup","class","advanced-filter__radiobutton",3,"value","label",4,"ngFor","ngForOf"],["name","booleanTypeGroup",1,"advanced-filter__radiobutton",3,"value","label"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,Co,5,17,"ng-container",0),n["\u0275\u0275template"](1,Do,1,1,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275element"](3,"rx-advanced-filtering-fields-provider",2)),2&e&&(n["\u0275\u0275property"]("ngIf",t.advancedFilterData.filterOptions),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("namedFilterOptionsGetter",t.getNamedFilterOptions))},directives:[f.NgIf,yp,u.AdaptAdvancedFilterComponent,xp,u.AdaptAccordionComponent,u.AdaptAccordionTabComponent,u.AdaptRxRadiobuttonGroupComponent,b.NgControlStatus,b.NgModel,f.NgForOf,u.AdaptRxRadiobuttonComponent],pipes:[f.AsyncPipe],styles:["[_nghost-%COMP%]     .filter-tags__tag-text{max-width:185px!important}"]}),function(e){e.Basic="basic",e.Expression="expression"}(ip||(ip={}));class Cp{}Cp.\u0275fac=function(e){return new(e||Cp)},Cp.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Cp,declarations:[xp],imports:[f.CommonModule,u.AdaptTagModule,u.AdaptDropdownModule,p.TranslateModule],exports:[xp]}),Cp.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptTagModule,u.AdaptDropdownModule,p.TranslateModule]]});class Sp{}Sp.\u0275fac=function(e){return new(e||Sp)},Sp.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Sp,declarations:[cp],imports:[f.CommonModule,u.AdaptRxCheckboxModule,b.FormsModule],exports:[cp]}),Sp.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptRxCheckboxModule,b.FormsModule]]});class wp{}wp.\u0275fac=function(e){return new(e||wp)},wp.\u0275mod=n["\u0275\u0275defineNgModule"]({type:wp,imports:[f.CommonModule,u.AdaptRxRadiobuttonModule,u.AdaptRxSelectModule,p.TranslateModule,u.AdaptTagModule,b.FormsModule,u.AdaptDropdownModule,u.AdaptMetatagModule,Sp,Cp],exports:[Cp,Sp]}),wp.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptRxRadiobuttonModule,u.AdaptRxSelectModule,p.TranslateModule,u.AdaptTagModule,b.FormsModule,u.AdaptDropdownModule.forRoot(),u.AdaptMetatagModule,Sp,Cp],Cp,Sp]});class Dp{}Dp.\u0275fac=function(e){return new(e||Dp)},Dp.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Dp,declarations:[up],imports:[f.CommonModule,b.FormsModule,Sp,u.AdaptMetatagModule],exports:[up]}),Dp.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.FormsModule,Sp,u.AdaptMetatagModule]]});class Rp{}Rp.\u0275fac=function(e){return new(e||Rp)},Rp.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Rp,declarations:[fp],imports:[f.CommonModule,b.FormsModule,Sp,u.AdaptRxCounterModule],exports:[fp]}),Rp.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.FormsModule,Sp,u.AdaptRxCounterModule]]});class Ip{}Ip.\u0275fac=function(e){return new(e||Ip)},Ip.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ip,declarations:[gp],imports:[f.CommonModule,b.FormsModule,Sp,u.AdaptRxDatetimeModule],exports:[gp]}),Ip.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.FormsModule,Sp,u.AdaptRxDatetimeModule]]});class Fp{}Fp.\u0275fac=function(e){return new(e||Fp)},Fp.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Fp,declarations:[vp],imports:[f.CommonModule,b.FormsModule,Sp,u.AdaptRxSelectModule],exports:[vp]}),Fp.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.FormsModule,Sp,u.AdaptRxSelectModule]]});class Ep{}Ep.\u0275fac=function(e){return new(e||Ep)},Ep.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ep,declarations:[pp],imports:[f.CommonModule,Sp,u.AdaptRxRadiobuttonModule,u.AdaptRxSelectModule,b.FormsModule],exports:[pp]}),Ep.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,Sp,u.AdaptRxRadiobuttonModule,u.AdaptRxSelectModule,b.FormsModule]]});class Mp{}Mp.\u0275fac=function(e){return new(e||Mp)},Mp.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Mp,declarations:[mp],imports:[f.CommonModule,Sp,u.AdaptMetatagModule,b.FormsModule,p.TranslateModule],exports:[mp]}),Mp.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,Sp,u.AdaptMetatagModule,b.FormsModule,p.TranslateModule]]});class Ap{}Ap.\u0275fac=function(e){return new(e||Ap)},Ap.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ap,declarations:[yp],imports:[f.CommonModule,Dp,Rp,Ip,Fp,Ep,Mp],exports:[yp]}),Ap.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,Dp,Rp,Ip,Fp,Ep,Mp]]});class Op{}Op.\u0275fac=function(e){return new(e||Op)},Op.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Op,declarations:[bp],imports:[f.CommonModule,u.AdaptAdvancedFilteringModule,wp,u.AdaptAccordionModule,u.AdaptRxRadiobuttonModule,b.FormsModule,Ap],exports:[bp]}),Op.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptAdvancedFilteringModule,wp,u.AdaptAccordionModule,u.AdaptRxRadiobuttonModule,b.FormsModule,Ap]]});class Pp{getNamedFilterOptionsFromColumns(e){return e.reduce((e,t)=>{var i;return(null===(i=t.namedFilterOptions)||void 0===i?void 0:i.length)&&(e[t.fieldId]=t.namedFilterOptions.map(e=>Object.assign(Object.assign({guid:e.guid},e.data),{index:(0,m.toNumber)(e.data.index)})).sort((e,t)=>e.index-t.index)),e},{})}}Pp.\u0275fac=function(e){return new(e||Pp)},Pp.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Pp,factory:Pp.\u0275fac,providedIn:"root"});class Tp extends S.RxModalClass{constructor(e,t,i,n){super(e,n),this.activeModalRef=e,this.rxModalService=t,this.rxGuidService=i,this.injector=n,this.filterPresets=[],this.params=this.activeModalRef.getData();const o=this.params.activeFilterPreset;this.recordDefinition=this.params.primaryRecordDefinition,this.selectedFieldIds=this.params.selectedFieldIds,this.isReadOnly=this.params.isReadOnly,this.filterPresets=(0,m.map)(this.params.filterPresets,e=>this.createFilterPresetEditorData(e,e===o))}ngAfterViewInit(){const e=(0,m.findIndex)(this.filterPresets,"isOpen");-1!==e&&this.accordionTabEls.toArray()[e].nativeElement.scrollIntoView({block:"nearest"})}addFilterPreset(){this.markAsDirty(),this.filterPresets.push(this.createFilterPresetEditorData({guid:this.rxGuidService.generate(),title:"New preset"+(0===this.filterPresets.length?"":" "+this.filterPresets.length),filters:"",recordGridFilters:[]},!0)),setTimeout(()=>{this.accordionTabEls.last.nativeElement.scrollIntoView({block:"nearest"})})}removeFilterPreset(e){this.markAsDirty(),this.filterPresets.splice(e,1)}createFilterPresetEditorData(e,t){return Object.assign(Object.assign({},e),{isOpen:t,filterSelectOptions:{primaryRecordDefinition:this.recordDefinition,tagsLimit:2,namedFilterOptions:this.params.namedFilterOptions,selectedFieldIds:this.selectedFieldIds},filterSelect:{basicFilters:e.recordGridFilters,filtersJson:e.filters}})}getCheckPresetTitleDuplicateValidator(e){return t=>{const i=t.value;return i&&this.filterPresets.some(t=>t.title===i&&t.guid!==e.guid)?{duplicatePresetName:{message:"Duplicate Name"}}:null}}trackByForFilterPresets(e,t){return t.guid}toggleOpen(e){this.filterPresets.forEach(t=>t.isOpen=e)}onSaveChangesClick(){const e={filterPresets:this.filterPresets.map(e=>({filters:e.filterSelect.filtersJson,recordGridFilters:e.filterSelect.basicFilters,guid:e.guid,title:e.title}))};(0,m.some)(e.filterPresets,e=>(0,m.isEmpty)(e.recordGridFilters))?this.rxModalService.confirm({title:"Warning",modalStyle:S.RX_MODAL.modalStyles.warning,message:"The filter preset will not filter records because no filters have been specified. Do you want to continue?"}).then(t=>{t&&this.activeModalRef.close(e)}):this.activeModalRef.close(e)}cancel(){this.activeModalRef.dismiss(u.DismissReasons.CLOSE_BTN)}}Tp.\u0275fac=function(e){return new(e||Tp)(n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](S.RxModalService),n["\u0275\u0275directiveInject"](v.RxGuidService),n["\u0275\u0275directiveInject"](n.Injector))},Tp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Tp,selectors:[["rx-record-grid-filter-preset-editor-modal"]],viewQuery:function(e,t){if(1&e&&(n["\u0275\u0275viewQuery"](Ro,7,b.NgForm),n["\u0275\u0275viewQuery"](u.AdaptAccordionTabComponent,5,n.ElementRef)),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.filterPresetsForm=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.accordionTabEls=e)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:18,vars:12,consts:[[1,"designer-modal-body","modal-body","d-flex","mh-100"],[1,"row","flex-grow-1","w-100"],[1,"d-flex","flex-column","mh-100","col"],[1,"d-flex","align-items-start","justify-content-between"],["class","mt-2 p-0","rx-id","add-button","adapt-button","","type","button","btn-type","tertiary",3,"click",4,"ngIf"],["class","btn-group",4,"ngIf"],[1,"designer-modal-accordion-wrapper"],[3,"multiselect"],["filterPresetsForm","ngForm"],["class","designer-modal-accordion-content",4,"ngFor","ngForOf","ngForTrackBy"],["class","d-flex justify-content-center h-100 align-items-center mt-2",4,"ngIf"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click",4,"ngIf"],["adapt-button","","btn-type","secondary","type","button","rx-id","cancel-button",3,"click"],["rx-id","add-button","adapt-button","","type","button","btn-type","tertiary",1,"mt-2","p-0",3,"click"],[1,"d-icon-left-plus_circle"],[1,"btn-group"],["adapt-button","","btn-type","tertiary","type","button","rx-id","expand-all-button",3,"click"],["adapt-button","","btn-type","tertiary","type","button","rx-id","collapse-all-button",3,"click"],[1,"designer-modal-accordion-content"],[1,"d-block",3,"isOpen","open","close"],["accordionTab",""],[1,"card-title-text","w-100"],[1,"designer-modal-card-title-content"],[1,"left-header-block","pl-0"],["rx-id","card-title",1,"rx-ellipsis",3,"title"],["class","right-header-block",4,"ngIf"],["rxNoWhitespace","",3,"label","name","required","disabled","rxCustomValidators","ngModel","ngModelChange"],[4,"ngIf"],[1,"right-header-block"],["adapt-button","","size","small","type","button","rx-id","remove-button",1,"d-icon-left-cross_adapt","p-1","pr-4","ml-3",3,"click"],[3,"name","disabled","options","ngModel","ngModelChange"],[1,"d-flex","justify-content-center","h-100","align-items-center","mt-2"],["type","search",1,"w-100",3,"label"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275elementStart"](2,"div",2),n["\u0275\u0275elementStart"](3,"div",3),n["\u0275\u0275template"](4,Io,4,3,"button",4),n["\u0275\u0275template"](5,Fo,7,6,"div",5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](6,"div",6),n["\u0275\u0275elementStart"](7,"adapt-accordion",7),n["\u0275\u0275elementStart"](8,"form",null,8),n["\u0275\u0275template"](10,Ao,12,13,"div",9),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](11,Oo,3,3,"div",10),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](12,"div",11),n["\u0275\u0275template"](13,Po,3,4,"button",12),n["\u0275\u0275elementStart"](14,"button",13),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](15),n["\u0275\u0275pipe"](16,"translate"),n["\u0275\u0275pipe"](17,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](4),n["\u0275\u0275property"]("ngIf",!t.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.filterPresets.length),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("multiselect",!0),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngForOf",t.filterPresets)("ngForTrackBy",t.trackByForFilterPresets),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.filterPresets.length),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",t.isReadOnly?n["\u0275\u0275pipeBind1"](16,8,"com.bmc.arsys.rx.client.common.close.label"):n["\u0275\u0275pipeBind1"](17,10,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[f.NgIf,u.AdaptAccordionComponent,b["\u0275NgNoValidate"],b.NgControlStatusGroup,b.NgForm,f.NgForOf,u.AdaptButtonComponent,u.AdaptAccordionTabComponent,u.AdaptRxTextfieldComponent,v.RxNoWhitespaceValidator,b.RequiredValidator,S.RxCustomValidatorsDirective,b.NgControlStatus,b.NgModel,bp,u.AdaptEmptyStateComponent],pipes:[p.TranslatePipe],styles:[':root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.designer-modal-body{height:645px;min-height:calc(100% - 61px)!important}.designer-modal-accordion-wrapper{display:flex;flex-direction:column;height:100%;overflow:auto;padding-top:10px}.designer-modal-accordion-content{position:relative}.designer-modal-accordion-content.cdk-drag-preview{z-index:1200!important}.designer-modal-drag-handle{cursor:move;position:absolute;top:0;left:0;height:46px;padding:14px 10px 14px 14px;z-index:1}.designer-modal-card-title-content{width:100%;display:flex}.designer-modal-card-title-content .left-header-block,.designer-modal-card-title-content .right-header-block{display:flex;align-items:center}.designer-modal-card-title-content .left-header-block{flex-grow:1;min-width:0;font-size:14px;padding-left:22px}.designer-modal-card-sub-title{color:#7c7f81;font-weight:normal}.designer-modal-card-title-index-buttons{display:flex;font-size:19px}.rx-card{overflow:auto}.rx-tree-draggable-node{cursor:pointer}.rx-tree-draggable-node.cdk-drag-preview{z-index:1200!important}.rx-tree-draggable-node.cdk-drag{opacity:1}.rx-tree-node-label{word-break:break-all}rx-form-builder{max-width:400px}\n'],encapsulation:2});class Vp extends l.ValueAccessor{constructor(e,t){super(),this.rxModalService=e,this.rxRecordGridFilterSelectHelperService=t,this.filterPresets=[]}onWriteValue(e){this.filterPresets=e.slice(),this.filterPresets.sort((e,t)=>e.title.localeCompare(t.title))}removeFilterPreset(e){this.updateValue(this.filterPresets.filter(t=>t.guid!==e.guid))}updateValue(e){this.value=e,this.onWriteValue(e)}openEditor(e){const t=this.options.columns.map(e=>e.fieldId),i=this.options.primaryRecordDefinition.fieldDefinitions.filter(e=>t.includes(e.id.toString())),n=this.rxRecordGridFilterSelectHelperService.getNamedFilterOptionsFromColumns(this.options.columns),o={filterPresets:this.filterPresets,activeFilterPreset:e,isReadOnly:this.isDisabled,namedFilterOptions:n,primaryRecordDefinition:(0,m.cloneDeep)(Object.assign(Object.assign({},this.options.primaryRecordDefinition),{fieldDefinitions:i})),selectedFieldIds:t};this.rxModalService.openModal({title:"Edit filter presets",content:Tp,size:d.OpenViewActionModalSize.Large,testID:"edit-filter-presets",data:o}).then(e=>{e&&e.filterPresets&&this.updateValue(e.filterPresets)}).catch(m.noop)}trackByForFilterPresets(e,t){return t.guid}}Vp.\u0275fac=function(e){return new(e||Vp)(n["\u0275\u0275directiveInject"](S.RxModalService),n["\u0275\u0275directiveInject"](Pp))},Vp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Vp,selectors:[["rx-record-grid-filter-preset-editor"]],inputs:{options:"options"},features:[n["\u0275\u0275ProvidersFeature"]([{provide:b.NG_VALUE_ACCESSOR,useExisting:Vp,multi:!0}]),n["\u0275\u0275InheritDefinitionFeature"]],decls:5,vars:5,consts:[[3,"label","tooltip",4,"ngIf"],["btn-type","tertiary","rx-id","open-modal-button","class","p-0 pb-1",3,"click",4,"ngIf"],["class","rx-selected-filter-preset",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-tertiary",4,"ngIf"],[3,"label","tooltip"],["btn-type","tertiary","rx-id","open-modal-button",1,"p-0","pb-1",3,"click"],[1,"d-icon-plus_circle"],[1,"rx-selected-filter-preset"],[1,"rx-selected-filter-preset__header-container"],["rx-id","card-title",1,"rx-selected-filter-preset__header-title",3,"title"],["type","button","class","rx-button-unstyled d-icon-left-pencil btn-link","rx-id","open-editor",3,"click",4,"ngIf"],["type","button","class","rx-button-unstyled d-icon-cross btn-link","rx-id","remove-filter-preset",3,"click",4,"ngIf"],["rx-id","filter-count",1,"rx-filter-count"],["type","button","rx-id","open-editor",1,"rx-button-unstyled","d-icon-left-pencil","btn-link",3,"click"],["type","button","rx-id","remove-filter-preset",1,"rx-button-unstyled","d-icon-cross","btn-link",3,"click"],[1,"text-tertiary"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,To,1,2,"adapt-rx-control-label",0),n["\u0275\u0275template"](1,Vo,3,0,"adapt-button",1),n["\u0275\u0275elementStart"](2,"div"),n["\u0275\u0275template"](3,jo,8,5,"div",2),n["\u0275\u0275template"](4,_o,2,0,"span",3),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("ngIf",t.options.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.isDisabled),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",t.filterPresets)("ngForTrackBy",t.trackByForFilterPresets),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",0===t.filterPresets.length))},directives:[f.NgIf,f.NgForOf,u.AdaptRxControlLabelComponent,u.AdaptButtonComponent],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.rx-selected-filter-preset[_ngcontent-%COMP%]{margin-bottom:5px;border:1px solid #d6d7d8;border-radius:2px;padding:5px 10px;word-break:break-all;font-weight:var(--font-weight-bold)}.rx-selected-filter-preset__header-container[_ngcontent-%COMP%]{display:flex;margin-bottom:5px}.rx-selected-filter-preset__header-title[_ngcontent-%COMP%]{flex:1 1 auto;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:.875rem}.rx-filter-count[_ngcontent-%COMP%]{font-size:.625rem;color:#959899}.d-icon-cross[_ngcontent-%COMP%], .d-icon-left-pencil[_ngcontent-%COMP%]{cursor:pointer}.d-icon-cross[_ngcontent-%COMP%]:not(:hover), .d-icon-left-pencil[_ngcontent-%COMP%]:not(:hover){color:#313538}']});class Np extends S.RxModalClass{constructor(e,t,i,n,o,r,a,d){super(e,d),this.context=e,this.adaptModalService=t,this.rxExpressionEditorService=i,this.translateService=n,this.rxRecordDefinitionCacheService=o,this.ngZone=r,this.rxGuidService=a,this.injector=d,this.rowActions=[],this.selectFormControlOptions={label:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid-row-actions.field-name.label"),tooltip:new s.Tooltip(this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid-row-actions.field-name.tooltip")),options:[],emptyOption:!0},this.availableOnDevicesFormControlOptions=(0,c.getAvailableOnDevicesInspectorConfig)().options,this.recordDefinitionPickerOptions={label:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid-row-actions.security-definition-name.label"),tooltip:new s.Tooltip(this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid-row-actions.security-definition-name.tooltip")),definitionType:l.RxDefinitionPickerType.StandardDataRecord,required:!1},this.iconPickerOptions={label:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid-row-actions.icon.label"),appendToBody:!0,required:!1}}ngOnInit(){super.ngOnInit();const e=this.context.getData();this.expressionConfigurator=e.expressionConfigurator,this.rowActionIndex=e.rowActionIndex,this.activeActionIndex=e.activeActionIndex,this.isReadOnly=e.isReadOnly,this.rowActions=(0,m.cloneDeep)(e.rowActions).map((e,t)=>(this.setSecurityFieldDefinitions(e),Object.assign(Object.assign({},e),{isOpen:t===this.rowActionIndex})))}ngAfterViewInit(){this.openActiveAction(),this.rowActionIndex&&this.accordionTabEls.toArray()[this.rowActionIndex].nativeElement.scrollIntoView({block:"nearest"})}cancel(){this.context.dismiss(u.DismissReasons.CLOSE_BTN)}trackByGuid(e,t){return t.guid}addRowAction(){this.markAsDirty(),this.rowActions.push(Object.assign({guid:this.rxGuidService.generate(),label:"New row action"+(0===this.rowActions.length?"":" "+this.rowActions.length),icon:"",recordDefinitionName:null,fieldId:null,recordInstance:null,disabled:null,hidden:null,actions:[],isOpen:!0,securityFieldDefinitions$:(0,o.of)(this.getSelectFormControlOptions())},d.RX_AVAILABLE_ON_DEVICES_DEFAULT_VALUE)),setTimeout(()=>{this.accordionTabEls.last.nativeElement.scrollIntoView({block:"nearest"})})}removeRowAction(e,t){t.stopPropagation(),this.markAsDirty(),this.rowActions.splice(e,1)}openExpressionEditor(e,t,i){this.rxExpressionEditorService.openEditor({property:{path:i,value:t[i],label:this.getRowActionLabel(i)},isReadOnly:!1,expressionConfigurator:this.expressionConfigurator,legend:[{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.function.label"),icon:"d-icon-mathematical_function"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.keyword.label"),icon:"d-icon-dollar"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-component.label"),icon:"d-icon-file_o"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-component-property.label"),icon:"d-icon-file_o_gear"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-input-parameter.label"),icon:"d-icon-arrow_right_square_input"}]}).subscribe(e=>{this.markAsDirty(),t[i]=e.value})}getExpressionFormControlOptions(e){return{label:this.getRowActionLabel(e),tooltip:"recordInstance"===e?new s.Tooltip(this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid-row-actions.recordInstance.tooltip")):null,dataDictionary$:this.context.getData().expressionConfigurator.getDataDictionary(e),operators:this.context.getData().expressionConfigurator.getOperators(e)}}saveActions(){const e=this.rowActions.map(e=>Object.assign(Object.assign({},(0,m.omit)(e,["isOpen","securityFieldDefinitions$"])),{action:"rowAction"}));this.context.close(e)}moveRowAction(e,t){(0,x.moveItemInArray)(this.rowActions,e,t),this.markAsDirty()}onDropInSelectedRowActionsContainer(e){(0,x.moveItemInArray)(this.rowActions,e.previousIndex,e.currentIndex),this.markAsDirty()}onRecordDefinitionChange(e){this.markAsDirty(),e.fieldId=null,this.setSecurityFieldDefinitions(e)}setSecurityFieldDefinitions(e){e.securityFieldDefinitions$=e.recordDefinitionName?this.rxRecordDefinitionCacheService.getRecordDefinition(e.recordDefinitionName).pipe((0,r.map)(e=>this.getSelectFormControlOptions(e))):(0,o.of)(this.getSelectFormControlOptions())}getRowActionLabel(e){let t;switch(e){case"disabled":t="com.bmc.arsys.rx.client.view-components.record-grid-row-actions.disabled.label";break;case"hidden":t="com.bmc.arsys.rx.client.view-components.record-grid-row-actions.hidden.label";break;case"recordInstance":t="com.bmc.arsys.rx.client.view-components.record-grid-row-actions.recordInstance.label"}return this.translateService.instant(t)}getSelectFormControlOptions(e=null){return Object.assign(Object.assign({},this.selectFormControlOptions),{options:e?e.fieldDefinitions.map(e=>({name:e.name,id:String(e.id)})):[]})}openActiveAction(){this.activeActionIndex>=0&&this.rowActionIndex>=0&&this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{const e=this.actionListControlComponents.find(e=>{var t;return(0,m.isEqual)(e.value,null===(t=this.rowActions[this.rowActionIndex])||void 0===t?void 0:t.actions)});e&&e.focus({actionIndex:this.activeActionIndex})})})}toggleOpen(e){this.rowActions.forEach(t=>t.isOpen=e)}}Np.\u0275fac=function(e){return new(e||Np)(n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](u.AdaptModalService),n["\u0275\u0275directiveInject"](l.RxExpressionEditorService),n["\u0275\u0275directiveInject"](p.TranslateService),n["\u0275\u0275directiveInject"](a.RxRecordDefinitionCacheService),n["\u0275\u0275directiveInject"](n.NgZone),n["\u0275\u0275directiveInject"](v.RxGuidService),n["\u0275\u0275directiveInject"](n.Injector))},Np.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Np,selectors:[["rx-record-grid-row-action-editor-modal"]],viewQuery:function(e,t){if(1&e&&(n["\u0275\u0275viewQuery"](Bo,7,b.NgForm),n["\u0275\u0275viewQuery"]($o,5,x.CdkDropList),n["\u0275\u0275viewQuery"](u.AdaptAccordionTabComponent,5,n.ElementRef),n["\u0275\u0275viewQuery"](Lo,5,x.CdkDrag),n["\u0275\u0275viewQuery"](c.ActionListControlComponent,5)),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.rowActionsForm=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.selectedRowActionsDropList=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.accordionTabEls=e),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.draggableSelectedRowAction=e),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.actionListControlComponents=e)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:19,vars:13,consts:[[1,"designer-modal-body","modal-body","d-flex","mh-100"],[1,"row","flex-grow-1","w-100"],[1,"d-flex","flex-column","mh-100","col"],[1,"d-flex","align-items-start","justify-content-between"],["class","mt-2 p-0","rx-id","add-button","adapt-button","","type","button","btn-type","tertiary",3,"click",4,"ngIf"],["class","btn-group",4,"ngIf"],["id","selectedRowActionsDropList","cdkDropList","",1,"designer-modal-accordion-wrapper",3,"cdkDropListData","cdkDropListDropped"],["selectedRowActionsDropList","cdkDropList"],[3,"multiselect"],["rowActionsForm","ngForm"],["class","designer-modal-accordion-content","cdkDrag","","cdkDragLockAxis","y",3,"cdkDragData","cdkDragDisabled",4,"ngFor","ngForOf","ngForTrackBy"],["class","d-flex justify-content-center h-100 align-items-center mt-2",4,"ngIf"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click",4,"ngIf"],["adapt-button","","btn-type","secondary","type","button","rx-id","cancel-button",3,"click"],["rx-id","add-button","adapt-button","","type","button","btn-type","tertiary",1,"mt-2","p-0",3,"click"],[1,"d-icon-left-plus_circle"],[1,"btn-group"],["adapt-button","","btn-type","tertiary","type","button","rx-id","expand-all-button",3,"click"],["adapt-button","","btn-type","tertiary","type","button","rx-id","collapse-all-button",3,"click"],["cdkDrag","","cdkDragLockAxis","y",1,"designer-modal-accordion-content",3,"cdkDragData","cdkDragDisabled"],["draggableSelectedRowAction",""],["class","designer-modal-drag-handle d-icon-left-dots","cdkDragHandle","",4,"ngIf"],[1,"d-block",3,"isOpen","open","close"],[1,"card-title-text","w-100"],[1,"designer-modal-card-title-content"],[1,"left-header-block"],["rx-id","card-title",1,"rx-ellipsis",3,"title"],["class","right-header-block",4,"ngIf"],[1,"d-flex","row"],["rx-id","label","rxNoWhitespace","",1,"form-group","d-block","col-4",3,"label","disabled","required","name","ngModel","ngModelChange"],["rx-id","icon",1,"form-group","d-block","col-4","px-2",3,"disabled","options","name","ngModel","ngModelChange"],["rx-id","recordDefinition",1,"form-group","d-block","col-4",3,"isDisabled","options","ngModel","name","ngModelChange"],["rx-id","fieldId",1,"col-4","px-2",3,"options","ngModel","name","disabled","appendToBody","ngModelChange"],["propertyPath","recordInstance","rx-id","recordInstance",1,"col-4",3,"disabled","options","ngModel","name","events"],["propertyPath","disabled","rx-id","disabled",1,"col-4",3,"disabled","options","ngModel","name","events"],["propertyPath","hidden","rx-id","hidden",1,"col-4",3,"disabled","options","ngModel","name","events"],["rx-id","availableOnDevices","required","",1,"col-4","px-2",3,"options","ngModel","name","disabled","appendToBody","ngModelChange"],[1,"d-inline-block","col-4","mt-2",3,"ngModel","name","ngModelChange"],["cdkDragHandle","",1,"designer-modal-drag-handle","d-icon-left-dots"],[1,"right-header-block"],[1,"designer-modal-card-title-index-buttons"],["type","button","rx-id","move-down-button",1,"d-icon-left-triangle_down","rx-button-unstyled",3,"disabled","click"],["type","button","rx-id","move-up-button",1,"d-icon-left-triangle_up","rx-button-unstyled",3,"disabled","click"],["adapt-button","","size","small","type","button","rx-id","remove-button",1,"d-icon-left-cross_adapt","p-1","pr-4","ml-3",3,"click"],[1,"d-flex","justify-content-center","h-100","align-items-center","mt-2"],["type","config",1,"w-100",3,"label"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275elementStart"](2,"div",2),n["\u0275\u0275elementStart"](3,"div",3),n["\u0275\u0275template"](4,Go,4,3,"button",4),n["\u0275\u0275template"](5,qo,7,6,"div",5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](6,"div",6,7),n["\u0275\u0275listener"]("cdkDropListDropped",function(e){return t.onDropInSelectedRowActionsContainer(e)}),n["\u0275\u0275elementStart"](8,"adapt-accordion",8),n["\u0275\u0275elementStart"](9,"form",null,9),n["\u0275\u0275template"](11,Xo,25,50,"div",10),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](12,Wo,3,3,"div",11),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](13,"div",12),n["\u0275\u0275template"](14,Ho,3,4,"button",13),n["\u0275\u0275elementStart"](15,"button",14),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](16),n["\u0275\u0275pipe"](17,"translate"),n["\u0275\u0275pipe"](18,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](4),n["\u0275\u0275property"]("ngIf",!t.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.rowActions.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("cdkDropListData",t.rowActions),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("multiselect",!0),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngForOf",t.rowActions)("ngForTrackBy",t.trackByGuid),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.rowActions.length),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",t.isReadOnly?n["\u0275\u0275pipeBind1"](17,9,"com.bmc.arsys.rx.client.common.close.label"):n["\u0275\u0275pipeBind1"](18,11,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[f.NgIf,x.CdkDropList,u.AdaptAccordionComponent,b["\u0275NgNoValidate"],b.NgControlStatusGroup,b.NgForm,f.NgForOf,u.AdaptButtonComponent,x.CdkDrag,u.AdaptAccordionTabComponent,u.AdaptRxTextfieldComponent,v.RxNoWhitespaceValidator,b.RequiredValidator,b.NgControlStatus,b.NgModel,l.IconPickerFormControlComponent,l.RxDefinitionPickerComponent,l.SelectFormControlComponent,l.ExpressionFormControlComponent,c.ActionListControlComponent,x.CdkDragHandle,u.AdaptEmptyStateComponent],pipes:[p.TranslatePipe,f.AsyncPipe],styles:[$i]});class kp extends l.InspectorWidgetBase{constructor(e,t,i){super(e),this.injector=e,this.rxModalService=t,this.translateService=i,this.rowActions$=this.designerItemModel.rowActionButtonComponents$.pipe((0,r.map)(e=>e.map(e=>{const t=e.children.map(e=>(0,m.omit)(e,"type","children"));return Object.assign(Object.assign({},(0,m.pick)(e.data,["recordDefinitionName","recordInstance","fieldId","icon","disabled","hidden","label",d.RX_AVAILABLE_ON_DEVICES_PROP_NAME])),{guid:e.guid,actions:t})})),(0,r.shareReplay)(1))}openEditor(e,t){this.rowActions$.pipe((0,r.take)(1),(0,r.switchMap)(i=>(0,o.from)(this.rxModalService.openModal({content:Np,title:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid-row-actions.modal.title"),size:d.OpenViewActionModalSize.Large,testID:"edit-row-actions",data:{expressionConfigurator:this.designerItemModel.expressionConfigurator,isReadOnly:this.isDisabled,rowActionIndex:e,rowActions:i,activeActionIndex:t}})))).subscribe({next:e=>this.designerItemModel.setRowActions(e),error:m.noop})}trackByForRowActions(e,t){return t.label}removeRowAction(e,t){this.rxModalService.confirm({title:this.translateService.instant("com.bmc.arsys.rx.client.common.warning.label"),modalStyle:S.RX_MODAL.modalStyles.warning,message:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid-row-actions.row-action-delete.warning",{name:t[e].label})}).then(i=>{i&&(t.splice(e,1),this.designerItemModel.setRowActions(t))})}focus(e){this.openEditor(e.rowActionIndex,e.actionIndex)}}kp.\u0275fac=function(e){return new(e||kp)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](S.RxModalService),n["\u0275\u0275directiveInject"](p.TranslateService))},kp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:kp,selectors:[["rx-record-grid-row-action-editor-widget"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:5,vars:3,consts:[["btn-type","tertiary","rx-id","open-row-action-editor-modal-button",1,"p-0","pb-1",3,"click"],[1,"d-icon-plus_circle"],[4,"ngIf"],["rx-id","no-row-actions","class","text-tertiary",4,"ngIf"],["rx-id","row-actions-list","class","rx-selected-row-action",4,"ngFor","ngForOf","ngForTrackBy"],["rx-id","no-row-actions",1,"text-tertiary"],["rx-id","row-actions-list",1,"rx-selected-row-action"],[1,"rx-selected-row-action__header-container"],["rx-id","row-action",1,"rx-selected-row-action__header-title",3,"title"],["type","button","rx-id","edit-button",1,"rx-button-unstyled","d-icon-left-pencil","btn-link",3,"click"],["type","button","rx-id","remove-button",1,"rx-button-unstyled","d-icon-cross","btn-link",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-button",0),n["\u0275\u0275listener"]("click",function(){return t.openEditor()}),n["\u0275\u0275element"](1,"span",1),n["\u0275\u0275text"](2," Edit row actions\n"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](3,Ko,3,3,"div",2),n["\u0275\u0275pipe"](4,"async")),2&e&&(n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](4,1,t.rowActions$)))},directives:[u.AdaptButtonComponent,f.NgIf,f.NgForOf],pipes:[f.AsyncPipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.rx-selected-row-action[_ngcontent-%COMP%]{margin-bottom:5px;border:1px solid #d6d7d8;border-radius:2px;padding:5px 10px;word-break:break-all;font-weight:var(--font-weight-bold)}.rx-selected-row-action__header-container[_ngcontent-%COMP%]{display:flex}.rx-selected-row-action__header-title[_ngcontent-%COMP%]{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;font-size:14px}.d-icon-cross[_ngcontent-%COMP%], .d-icon-left-pencil[_ngcontent-%COMP%]{cursor:pointer}.d-icon-cross[_ngcontent-%COMP%]:not(:hover), .d-icon-left-pencil[_ngcontent-%COMP%]:not(:hover){color:#313538}']});class jp extends l.ValueAccessor{constructor(e,t,i){super(),this.renderer=e,this.rxRecordGridUtilsService=t,this.rxStringService=i,this.ColumnSortDirection=jc,this.updateOptionsSubject=new o.BehaviorSubject(null),this.columnOptions$=this.updateOptionsSubject.pipe((0,r.switchMap)(()=>this.options.gridColumns&&this.options.recordDefinition?(0,o.forkJoin)(this.options.gridColumns.filter(e=>e.sortable).map(e=>this.rxStringService.isEmptySafe(e.title)?this.rxRecordGridUtilsService.getFieldDefinition(e.fieldId,this.options.recordDefinition).pipe((0,r.map)(t=>({id:e.fieldId,name:`[${t.name}]`}))):(0,o.of)({id:e.fieldId,name:e.title}))).pipe((0,r.defaultIfEmpty)([])):(0,o.of)([]))),this.selectedColumnOption=[]}get selectedSortDirection(){return this.value?this.value.direction:null}ngOnChanges(e){var t,i,n;!(null===(t=e.options)||void 0===t?void 0:t.previousValue)||(0,m.isEqual)(e.options.currentValue.gridColumns,e.options.previousValue.gridColumns)&&(null===(i=e.options.currentValue.recordDefinition)||void 0===i?void 0:i.name)===(null===(n=e.options.previousValue.recordDefinition)||void 0===n?void 0:n.name)||this.updateOptionsSubject.next()}onWriteValue(e){this.columnOptions$.pipe((0,r.take)(1)).subscribe(t=>{this.selectedColumnOption=e?[t.find(t=>t.id===e.fieldId)]:[]})}focus(){this.renderer.selectRootElement(this.adaptRxSelect.selectButtonRef.nativeElement,!0).focus()}onSelectModelChange(e){this.selectedColumnOption=e,this.value=(0,m.isEmpty)(e)?null:{fieldId:(0,m.head)(e).id,direction:jc.Asc}}setSortDirection(e){this.value=Object.assign(Object.assign({},this.value),{direction:e})}optionFormatter(e){return e.name}ngOnDestroy(){this.updateOptionsSubject.complete()}}jp.\u0275fac=function(e){return new(e||jp)(n["\u0275\u0275directiveInject"](n.Renderer2),n["\u0275\u0275directiveInject"](kc),n["\u0275\u0275directiveInject"](v.RxStringService))},jp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:jp,selectors:[["rx-record-grid-sort-editor-control"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](Yo,7),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.adaptRxSelect=e.first)}},inputs:{options:"options"},features:[n["\u0275\u0275ProvidersFeature"]([{provide:b.NG_VALUE_ACCESSOR,useExisting:jp,multi:!0}]),n["\u0275\u0275InheritDefinitionFeature"],n["\u0275\u0275NgOnChangesFeature"]],decls:6,vars:8,consts:[[1,"form-group",3,"ngClass"],["class","form-control-label",4,"ngIf"],[1,"d-flex"],["class","pr-1 w-100",3,"options","required","disabled","ngModel","optionFormatter","emptyOption","ngModelChange",4,"ngIf"],["class","btn-group","data-toggle","buttons",4,"ngIf"],[1,"form-control-label"],[1,"pr-1","w-100",3,"options","required","disabled","ngModel","optionFormatter","emptyOption","ngModelChange"],["adaptRxSelect",""],["data-toggle","buttons",1,"btn-group"],["adapt-button","","btn-type","secondary","type","button",1,"pl-2","pr-2","d-icon-arrow_up",3,"click"],["adapt-button","","btn-type","secondary","type","button",1,"pl-2","pr-2","d-icon-arrow_down",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275template"](1,Zo,2,1,"label",1),n["\u0275\u0275elementStart"](2,"div",2),n["\u0275\u0275template"](3,er,2,6,"adapt-rx-select",3),n["\u0275\u0275pipe"](4,"async"),n["\u0275\u0275template"](5,tr,3,4,"div",4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](6,ir,t.options.required)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.options.label),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](4,4,t.columnOptions$)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.selectedColumnOption.length))},directives:[f.NgClass,f.NgIf,u.AdaptRxSelectComponent,b.RequiredValidator,b.NgControlStatus,b.NgModel,u.AdaptButtonComponent],pipes:[f.AsyncPipe],encapsulation:2}),function(e){e.Record="record",e.Association="association"}(np||(np={}));class _p extends S.RxModalClass{constructor(e,t){super(e,t),this.activeModalRef=e,this.injector=t,this.params=this.activeModalRef.getData(),this.presetColumns=this.params.presetColumns.map((e,t)=>{const i=this.params.gridColumns.find(t=>t.fieldId===e.data.fieldId);return Object.assign(Object.assign({},(0,m.cloneDeep)(e)),{isOpen:0===t,title:i.title,fallbackTitle:i.fallbackTitle})}),this.isReadOnly=this.params.isReadOnly,this.columnWidthPropertyOptions=Nc.columnProperties.find(({name:e})=>"width"===e).options,this.presetColumns.sort((e,t)=>e.data.index-t.data.index)}expandAllColumns(e){e.stopPropagation(),this.presetColumns.forEach(e=>e.isOpen=!0)}collapseAllColumns(e){e.stopPropagation(),this.presetColumns.forEach(e=>e.isOpen=!1)}saveChanges(){this.activeModalRef.close({presetColumns:this.presetColumns.map(e=>(0,m.omit)(e,["isOpen","title"]))})}cancel(){this.activeModalRef.dismiss(u.DismissReasons.CLOSE_BTN)}moveColumn(e,t){this.markAsDirty(),(0,x.moveItemInArray)(this.presetColumns,e,t),this.updateColumnIndexes()}onDropInSelectedColumnsContainer(e){this.moveColumn(e.previousIndex,e.currentIndex)}trackByGuid(e,t){return t.guid}updateColumnIndexes(){this.presetColumns.forEach((e,t)=>{e.data.index=t})}}_p.\u0275fac=function(e){return new(e||_p)(n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](n.Injector))},_p.\u0275cmp=n["\u0275\u0275defineComponent"]({type:_p,selectors:[["rx-record-grid-view-preset-columns-modal"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:20,vars:16,consts:[[1,"designer-modal-body","modal-body","d-flex","mh-100"],[1,"row","flex-grow-1","w-100"],[1,"d-flex","flex-column","mh-100","col"],[1,"d-flex","justify-content-end"],[1,"btn-group"],["adapt-button","","btn-type","tertiary","type","button","rx-id","expand-all-button",3,"click"],["adapt-button","","btn-type","tertiary","type","button","rx-id","collapse-all-button",3,"click"],["cdkDropList","",1,"designer-modal-accordion-wrapper",3,"cdkDropListData","cdkDropListDropped"],[3,"multiselect"],["class","designer-modal-accordion-content","cdkDrag","","cdkDragLockAxis","y",3,"cdkDragDisabled","cdkDragData",4,"ngFor","ngForOf","ngForTrackBy"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click",4,"ngIf"],["adapt-button","","btn-type","secondary","type","button","rx-id","cancel-button",3,"click"],["cdkDrag","","cdkDragLockAxis","y",1,"designer-modal-accordion-content",3,"cdkDragDisabled","cdkDragData"],["class","designer-modal-drag-handle d-icon-left-dots","cdkDragHandle","",4,"ngIf"],[1,"d-block",3,"isOpen","open","close"],[1,"card-title-text","w-100"],[1,"designer-modal-card-title-content"],[1,"left-header-block"],[1,"rx-ellipsis",3,"title"],["class","designer-modal-card-sub-title ml-2",3,"title",4,"ngIf"],["class","right-header-block",4,"ngIf"],["label","Column header",3,"disabled","ngModel","ngModelChange"],["label","Visible",3,"ngModel","disabled","ngModelChange"],[1,"d-block","col-5","p-0",3,"options","ngModel","ngModelChange"],["cdkDragHandle","",1,"designer-modal-drag-handle","d-icon-left-dots"],[1,"designer-modal-card-sub-title","ml-2",3,"title"],[1,"right-header-block"],[1,"designer-modal-card-title-index-buttons"],["type","button","rx-id","move-down-button",1,"d-icon-left-triangle_down","rx-button-unstyled",3,"disabled","click"],["type","button","rx-id","move-up-button",1,"d-icon-left-triangle_up","rx-button-unstyled",3,"disabled","click"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275elementStart"](2,"div",2),n["\u0275\u0275elementStart"](3,"div",3),n["\u0275\u0275elementStart"](4,"div",4),n["\u0275\u0275elementStart"](5,"button",5),n["\u0275\u0275listener"]("click",function(e){return t.expandAllColumns(e)}),n["\u0275\u0275text"](6),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](8,"button",6),n["\u0275\u0275listener"]("click",function(e){return t.collapseAllColumns(e)}),n["\u0275\u0275text"](9),n["\u0275\u0275pipe"](10,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](11,"div",7),n["\u0275\u0275listener"]("cdkDropListDropped",function(e){return t.onDropInSelectedColumnsContainer(e)}),n["\u0275\u0275elementStart"](12,"adapt-accordion",8),n["\u0275\u0275template"](13,ar,13,16,"div",9),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](14,"div",10),n["\u0275\u0275template"](15,sr,3,4,"button",11),n["\u0275\u0275elementStart"](16,"button",12),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](17),n["\u0275\u0275pipe"](18,"translate"),n["\u0275\u0275pipe"](19,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](6),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](7,8,"com.bmc.arsys.rx.client.common.expand-all.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](10,10,"com.bmc.arsys.rx.client.common.collapse-all.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("cdkDropListData",t.presetColumns),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("multiselect",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",t.presetColumns)("ngForTrackBy",t.trackByGuid),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",t.isReadOnly?n["\u0275\u0275pipeBind1"](18,12,"com.bmc.arsys.rx.client.common.close.label"):n["\u0275\u0275pipeBind1"](19,14,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[u.AdaptButtonComponent,x.CdkDropList,u.AdaptAccordionComponent,f.NgForOf,f.NgIf,x.CdkDrag,u.AdaptAccordionTabComponent,u.AdaptRxTextfieldComponent,b.NgControlStatus,b.NgModel,u.AdaptRxCheckboxComponent,l.StepperWithUnitsFormControlComponent,x.CdkDragHandle],pipes:[p.TranslatePipe],styles:[$i]});class Bp extends S.RxModalClass{constructor(e,t,i,n,a,s,l){super(e,t),this.activeModalRef=e,this.injector=t,this.rxModalService=i,this.rxRecordGridDesignUtilsService=n,this.rxRecordGridFilterSelectHelperService=a,this.rxRecordGridUtilsService=s,this.rxStringService=l,this.params=this.activeModalRef.getData(),this.presets=[],this.isReadOnly=this.params.isReadOnly,this.gridColumns$=this.params.gridColumns&&this.params.recordDefinition?(0,o.forkJoin)(this.params.gridColumns.map(e=>this.rxStringService.isEmptySafe(e.title)?this.rxRecordGridUtilsService.getFieldDefinition(e.fieldId,this.params.recordDefinition).pipe((0,r.map)(t=>Object.assign(Object.assign({},e),{fallbackTitle:`[${t.name}]`}))):(0,o.of)(Object.assign(Object.assign({},e),{fallbackTitle:`[${e.title}]`})))).pipe((0,r.defaultIfEmpty)([])):(0,o.of)([])}ngOnInit(){super.ngOnInit(),this.gridColumns$.pipe((0,r.take)(1)).subscribe(e=>{this.namedFilterOptions=this.rxRecordGridFilterSelectHelperService.getNamedFilterOptionsFromColumns(e),this.presets=this.params.presetsList.map(({guid:t,name:i},n)=>{const o=this.params.viewPresets.find(({data:e})=>e.viewPresetGuid===t),r=e.filter(e=>e.filterable).map(e=>e.fieldId),a=o.data.viewPresetGuid,s=(0,m.cloneDeep)(o.children.filter(e=>e.type===Nc.components.columnViewPreset)),l=s.find(e=>(0,m.isObject)(e.data.sortable)),d=l?{fieldId:l.data.fieldId,direction:l.data.sortable.direction}:null;return{presetName:i,gridColumns:e,presetColumns:s,guid:a,tags:this.getTags(s,e),isOpen:this.params.activePreset?this.params.activePreset===a:0===n,sortModel:d,filters:{basicFilters:this.rxRecordGridDesignUtilsService.getBasicRecordGridFiltersFromChildData(o.children),filtersJson:o.data.filters},filterSelectControlOptions:{primaryRecordDefinition:Object.assign(Object.assign({},this.params.recordDefinition),{fieldDefinitions:this.params.recordDefinition.fieldDefinitions.filter(e=>r.includes(String(e.id)))}),selectedFieldIds:e.map(e=>e.fieldId),namedFilterOptions:this.namedFilterOptions},sortEditorControlOptions:{label:"Initial column sort",gridColumns:(0,m.sortBy)(e,"title"),recordDefinition:this.params.recordDefinition}}})})}saveChanges(){this.activeModalRef.close({presets:this.presets})}cancel(){this.activeModalRef.dismiss(u.DismissReasons.CLOSE_BTN)}expandAll(e){e.stopPropagation(),this.presets.forEach(e=>e.isOpen=!0)}collapseAll(e){e.stopPropagation(),this.presets.forEach(e=>e.isOpen=!1)}openPresetColumnsModal(e){this.rxModalService.openModal({title:`Edit grid columns for ${e.presetName}`,content:_p,size:d.OpenViewActionModalSize.Large,data:{gridColumns:e.gridColumns,presetColumns:e.presetColumns,isReadOnly:this.isReadOnly},testID:"edit-grid-columns-for-view-preset"}).then(t=>{(null==t?void 0:t.presetColumns)&&(e.presetColumns=t.presetColumns,e.tags=this.getTags(e.presetColumns,e.gridColumns),this.markAsDirty())}).catch(m.noop)}trackByPreset(e,t){return t.guid}getTags(e,t){const i=e.filter(e=>e.data.visible).map(e=>{const i=t.find(t=>t.fieldId===e.data.fieldId);return i.title||i.fallbackTitle}),n=i.slice(0,5);return{items:n,restCount:i.length-n.length}}onSortChange(e,t){t.presetColumns.forEach(t=>{t.data.sortable=t.data.fieldId===(null==e?void 0:e.fieldId)?(0,m.pick)(e,"direction"):null}),this.markAsDirty()}}Bp.\u0275fac=function(e){return new(e||Bp)(n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](S.RxModalService),n["\u0275\u0275directiveInject"](Lp),n["\u0275\u0275directiveInject"](Pp),n["\u0275\u0275directiveInject"](kc),n["\u0275\u0275directiveInject"](v.RxStringService))},Bp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Bp,selectors:[["rx-record-grid-edit-view-presets-modal"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:20,vars:15,consts:[[1,"designer-modal-body","modal-body","d-flex","mh-100"],[1,"row","flex-grow-1","w-100"],[1,"d-flex","flex-column","mh-100","col"],[1,"d-flex","justify-content-end"],[1,"btn-group"],["adapt-button","","btn-type","tertiary","type","button","rx-id","expand-all-button",3,"click"],["adapt-button","","btn-type","tertiary","type","button","rx-id","collapse-all-button",3,"click"],[1,"designer-modal-accordion-wrapper"],[3,"multiselect"],["class","designer-modal-accordion-content",4,"ngFor","ngForOf","ngForTrackBy"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click",4,"ngIf"],["adapt-button","","btn-type","secondary","type","button","rx-id","cancel-button",3,"click"],[1,"designer-modal-accordion-content"],[1,"d-block",3,"isOpen","open","close"],[1,"card-title-text","w-100"],[1,"designer-modal-card-title-content"],[1,"left-header-block","pl-0"],["rx-id","card-title",1,"rx-ellipsis",3,"title"],["btn-type","tertiary","rx-id","open-grid-preset-columns-modal-button",1,"p-0","pb-1",3,"click"],[1,"d-icon-plus_circle"],[1,"mb-3"],["type","active",4,"ngFor","ngForOf"],["class","btn-link rx-button-unstyled ml-1","type","button",3,"click",4,"ngIf"],[1,"d-block","w-50",3,"options","disabled","ngModel","ngModelChange"],[3,"options","disabled","ngModel","ngModelChange"],["type","active"],["type","button",1,"btn-link","rx-button-unstyled","ml-1",3,"click"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275elementStart"](2,"div",2),n["\u0275\u0275elementStart"](3,"div",3),n["\u0275\u0275elementStart"](4,"div",4),n["\u0275\u0275elementStart"](5,"button",5),n["\u0275\u0275listener"]("click",function(e){return t.expandAll(e)}),n["\u0275\u0275text"](6),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](8,"button",6),n["\u0275\u0275listener"]("click",function(e){return t.collapseAll(e)}),n["\u0275\u0275text"](9),n["\u0275\u0275pipe"](10,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](11,"div",7),n["\u0275\u0275elementStart"](12,"adapt-accordion",8),n["\u0275\u0275template"](13,cr,15,11,"div",9),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](14,"div",10),n["\u0275\u0275template"](15,pr,3,4,"button",11),n["\u0275\u0275elementStart"](16,"button",12),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](17),n["\u0275\u0275pipe"](18,"translate"),n["\u0275\u0275pipe"](19,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](6),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](7,7,"com.bmc.arsys.rx.client.common.expand-all.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](10,9,"com.bmc.arsys.rx.client.common.collapse-all.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("multiselect",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",t.presets)("ngForTrackBy",t.trackByPreset),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",t.isReadOnly?n["\u0275\u0275pipeBind1"](18,11,"com.bmc.arsys.rx.client.common.close.label"):n["\u0275\u0275pipeBind1"](19,13,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[u.AdaptButtonComponent,u.AdaptAccordionComponent,f.NgForOf,f.NgIf,u.AdaptAccordionTabComponent,jp,b.NgControlStatus,b.NgModel,bp,u.AdaptTagComponent],pipes:[p.TranslatePipe],styles:[$i]});class $p extends l.InspectorWidgetBase{constructor(e,t,i,n,a,s,l){super(e),this.injector=e,this.rxModalService=t,this.viewDesignerFacade=i,this.rxGuidService=n,this.rxRecordGridDesignUtilsService=a,this.rxRecordGridFilterHelperService=s,this.rxJsonParserService=l,this.currentPresetSelectorGuid$=new o.ReplaySubject(1),this.presetSelectors$=this.viewDesignerFacade.getComponentsByType(d.RxViewComponentType.ViewPresetSelector),this.presetSelectorOptions$=this.presetSelectors$.pipe((0,r.map)(e=>e.map(({guid:e,data:t})=>({id:e,name:t.name})))),this.destroyed$=new o.ReplaySubject(1),this.selectedPresetsList$=this.currentPresetSelectorGuid$.pipe((0,r.tap)(e=>this.updateViewPresetSelectorProp(e)),(0,r.switchMap)(e=>this.rxRecordGridDesignUtilsService.getPresetsList(e)),(0,r.shareReplay)({refCount:!0,bufferSize:1}),(0,r.takeUntil)(this.destroyed$)),this.viewPresetSelectorProp$=this.designerItemModel.sandbox.getComponentPropertyValue("viewPresetSelector"),this.gridColumnGuids$=this.designerItemModel.sandbox.getChildComponentGuids(e=>e.type===Nc.components.column),this.selectOptions={options:[],emptyOption:!0,label:"View preset selector",beforeValueChange:(e,t)=>e&&e!==t?this.rxModalService.confirm({title:"Warning",modalStyle:S.RX_MODAL.modalStyles.warning,message:"All record grid view presets will be cleared. Do you want to continue?"}):Promise.resolve(!0)}}ngOnChanges(e){var t,i;(null===(t=e.options.currentValue.recordDefinition)||void 0===t?void 0:t.name)!==(null===(i=e.options.previousValue.recordDefinition)||void 0===i?void 0:i.name)&&(this.currentPresetSelectorGuid=null,this.currentPresetSelectorGuid$.next(null))}ngOnInit(){this.presetSelectorOptions$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.selectOptions.options=e}),this.viewPresetSelectorProp$.pipe((0,r.first)(),(0,r.map)(e=>this.designerItemModel.extractViewPresetSelectorGuid(e)),(0,r.withLatestFrom)(this.presetSelectorOptions$),(0,r.takeUntil)(this.destroyed$)).subscribe(([e,t])=>{var i;const n=null===(i=t.find(t=>t.id===e))||void 0===i?void 0:i.id;n&&(this.currentPresetSelectorGuid=n,this.currentPresetSelectorGuid$.next(this.currentPresetSelectorGuid))}),this.gridColumnGuids$.pipe((0,r.filter)(()=>!!this.currentPresetSelectorGuid),(0,r.switchMap)(e=>(0,o.combineLatest)(e.map(e=>(0,o.combineLatest)([this.designerItemModel.sandbox.getComponentPropertyValue("sortable",e),this.designerItemModel.sandbox.getComponentPropertyValue("filterable",e),this.viewDesignerFacade.getChildComponents(e,e=>e.type===Nc.components.filterPreset)])))),(0,r.distinctUntilChanged)(m.isEqual),(0,r.debounceTime)(100),(0,r.switchMap)(()=>this.designerItemModel.columns$.pipe((0,r.first)())),(0,r.withLatestFrom)(this.designerItemModel.childComponentsTree$.pipe((0,r.map)(e=>(0,m.cloneDeep)(e)))),(0,r.skip)(1),(0,r.takeUntil)(this.destroyed$)).subscribe(([e,t])=>{this.updateColumnPresets(t,e)})}updateColumnPresets(e,t){const i=e.filter(e=>e.type===Nc.components.viewPreset).map(e=>{const i=e.children.filter(e=>e.type===Nc.components.columnViewPreset),n=this.getPresetFilterComponentsForColumns(e,t),o=t.map(e=>{const t=i.find(t=>t.data.fieldId===e.fieldId);if(t)return e.sortable||(t.data.sortable=null),t;{const t=this.rxRecordGridDesignUtilsService.getColumnPresetPayload(e);return t.data.visible=!1,t.data.index=null,t.data.width=null,t}}).map((e,t,i)=>(null===e.data.index&&(e.data.index=Math.max(...i.map(e=>e.data.index))+1),e));return e.children=[...o,...n],e});this.designerItemModel.sandbox.setChildrenByType(i,[Nc.components.viewPreset])}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}getPresetFilterComponentsForColumns(e,t){const i=t.filter(e=>e.filterable).map(e=>e.fieldId),n=e.children.filter(e=>e.type!==Nc.components.columnViewPreset),o=n.reduce((e,n)=>{var o,r,a;if(i.includes(n.data.fieldId)){const i=(null!==(r=null===(o=t.find(e=>e.fieldId===n.data.fieldId))||void 0===o?void 0:o.namedFilterOptions)&&void 0!==r?r:[]).map(e=>e.guid);let s=this.rxRecordGridDesignUtilsService.getBasicRecordGridFiltersFromChildData([n]);s=this.deserializeNamedOptions(s);const l=null===(a=s[0].value)||void 0===a?void 0:a[d.RecordGridNamedFilterOptionKey];l?i.includes(l)&&e.push(n):e.push(n)}return e},[]);if(n.length){if(o.length<n.length){const t=this.rxRecordGridDesignUtilsService.getBasicRecordGridFiltersFromChildData(o),i=this.rxRecordGridFilterHelperService.getRecordGridFilterDataFromPredefinedFilter(e.data.filters,t);e.data.filters=i?this.rxRecordGridFilterHelperService.denormalizeFilterString(JSON.stringify(i),t):null}return o}return n}deserializeNamedOptions(e){return e.map(e=>{const t=this.rxJsonParserService.tryParseJson(e.value);return t&&t[d.RecordGridNamedFilterOptionKey]?Object.assign(Object.assign({},e),{value:t}):e})}openEditor(e){(0,o.combineLatest)([this.designerItemModel.gridViewPresets$,this.selectedPresetsList$,this.designerItemModel.columns$,this.designerItemModel.recordDefinition$]).pipe((0,r.first)(),(0,r.takeUntil)(this.destroyed$)).subscribe(([t,i,n,o])=>{this.rxModalService.openModal({title:"Edit view presets",content:Bp,size:d.OpenViewActionModalSize.Large,data:{viewPresets:t,presetsList:i,gridColumns:n,recordDefinition:o,activePreset:null==e?void 0:e.guid,isReadOnly:this.isDisabled}}).then(e=>{this.onPresetModalClose(e)}).catch(m.noop)})}trackByGuid(e,t){return t.name}onPresetModalClose(e){e&&e.presets&&this.designerItemModel.childComponentsTree$.pipe((0,r.first)(),(0,r.map)(e=>(0,m.cloneDeep)(e)),(0,r.takeUntil)(this.destroyed$)).subscribe(t=>{e.presets.forEach(e=>{const i=t.find(t=>t.type===Nc.components.viewPreset&&t.data.viewPresetGuid===e.guid);if(i){const t=e.presetColumns.map(e=>this.rxRecordGridDesignUtilsService.getColumnPresetPayload(e.data)),n=this.rxRecordGridDesignUtilsService.getGridFilterComponentPayloads(e.filters.basicFilters);i.data={viewPresetGuid:e.guid,filters:e.filters.filtersJson},i.children=[...t,...n]}}),this.designerItemModel.sandbox.setChildren(t)})}updateViewPresetSelectorProp(e){this.designerItemModel.sandbox.updateComponentProperties({viewPresetSelector:e?`\${view.components.${e}.api}`:null})}}$p.\u0275fac=function(e){return new(e||$p)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](S.RxModalService),n["\u0275\u0275directiveInject"](c.ViewDesignerFacade),n["\u0275\u0275directiveInject"](v.RxGuidService),n["\u0275\u0275directiveInject"](Lp),n["\u0275\u0275directiveInject"](sp),n["\u0275\u0275directiveInject"](v.RxJsonParserService))},$p.\u0275cmp=n["\u0275\u0275defineComponent"]({type:$p,selectors:[["rx-record-grid-view-presets-widget"]],inputs:{options:"options"},features:[n["\u0275\u0275InheritDefinitionFeature"],n["\u0275\u0275NgOnChangesFeature"]],decls:3,vars:6,consts:[["rx-id","preset-selector",1,"d-block","mb-3",3,"options","ngModel","disabled","ngModelChange"],[3,"hidden",4,"ngIf"],[3,"hidden"],["btn-type","tertiary","rx-id","edit-view-presets-button","class","p-0 pb-1",3,"click",4,"ngIf"],["rx-id","no-presets","class","text-tertiary",4,"ngIf"],["rx-id","presets-list"],["class","border mb-1 pr-2 d-flex justify-content-between text-break",4,"ngFor","ngForOf","ngForTrackBy"],["btn-type","tertiary","rx-id","edit-view-presets-button",1,"p-0","pb-1",3,"click"],[1,"d-icon-left-plus_circle"],["rx-id","no-presets",1,"text-tertiary"],[1,"border","mb-1","pr-2","d-flex","justify-content-between","text-break"],["rx-id","preset-name",1,"preset-name",3,"title"],["type","button","rx-id","edit-button",1,"rx-button-unstyled","d-icon-pencil","btn-link",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"rx-select-form-control",0),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.currentPresetSelectorGuid=e})("ngModelChange",function(e){return t.currentPresetSelectorGuid$.next(e)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](1,hr,5,5,"div",1),n["\u0275\u0275pipe"](2,"async")),2&e&&(n["\u0275\u0275property"]("options",t.selectOptions)("ngModel",t.currentPresetSelectorGuid)("disabled",t.isDisabled),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](2,4,t.selectedPresetsList$)))},directives:[l.SelectFormControlComponent,b.NgControlStatus,b.NgModel,f.NgIf,f.NgForOf,u.AdaptButtonComponent],pipes:[f.AsyncPipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.preset-name[_ngcontent-%COMP%]{padding:5px 10px;font-size:14px}.d-icon-pencil[_ngcontent-%COMP%]{cursor:pointer}.d-icon-pencil[_ngcontent-%COMP%]:not(:hover){color:#313538}']});class Lp{constructor(e,t,i,n,o,r,a,s,l,d){this.rxGuidService=e,this.rxRecordGridConfigUtilsService=t,this.rxDefinitionNameService=i,this.rxFeatureService=n,this.rxModalService=o,this.rxRecordGridUtilsService=r,this.rxRecordGridFilterHelperService=a,this.translateService=s,this.viewDesignerFacade=l,this.rxJsonParserService=d}getColumnActionComponentPayloads(e){return(0,m.map)(e,e=>Object.assign(Object.assign({},e),{type:d.RxViewComponentType.Action}))}getNamedFilterOptionPayloads(e){return(0,m.map)(e,e=>Object.assign(Object.assign({},e),{type:Nc.components.filterPreset}))}getGridFilterComponentPayloads(e){return(0,m.map)(e,e=>({guid:e.guid,type:Nc.components.filter,data:Object.assign({fieldId:e.fieldId,value:e.value},e.$DISPLAYVALUE$&&{$DISPLAYVALUE$:e.$DISPLAYVALUE$})}))}getColumnComponentPayloads(e,t){return(0,m.map)(e,(e,i)=>{let n="false";(null==t?void 0:t.fieldId)===e.fieldId&&!1!==e.sortable?n=JSON.stringify({direction:t.direction}):((0,m.isObject)(e.sortable)||!0===e.sortable)&&(n="true");const o={alignment:e.alignment,fieldId:e.fieldId,filterable:e.filterable,filterType:e.filterType,index:String(e.index),sortable:n,title:e.title,searchable:e.searchable,visible:e.visible,cellDisplayProperties:e.cellDisplayProperties,width:e.width,wrapText:e.wrapText,typeaheadKeystrokeCount:e.typeaheadKeystrokeCount,additionalQueryCriteria:e.additionalQueryCriteria};return{type:Nc.components.column,guid:e.guid,insertIndex:i,outletName:d.RX_VIEW_DEFINITION.defaultOutletName,data:o,children:[...this.getColumnActionComponentPayloads(e.actions),...this.getNamedFilterOptionPayloads(e.namedFilterOptions)]}})}getGridFilterPresetComponentPayloads(e,t){const i=t.reduce((e,t)=>e.concat(...t.namedFilterOptions.map(e=>e.guid)),[]),n=t.map(e=>e.fieldId);return(0,m.map)(e,e=>{const t=e.recordGridFilters.filter(e=>n.includes(e.fieldId)).filter(e=>{const t=(0,m.isObject)(e.value)?e.value:this.rxJsonParserService.tryParseJson(e.value);return!(null==t?void 0:t[d.RecordGridNamedFilterOptionKey])||i.includes(t[d.RecordGridNamedFilterOptionKey])}),o=this.rxRecordGridFilterHelperService.getRecordGridFilterDataFromPredefinedFilter(e.filters,t);return{guid:e.guid,type:Nc.components.filterPreset,data:{title:e.title,filters:o?this.rxRecordGridFilterHelperService.denormalizeFilterString(JSON.stringify(o),t):null},children:(0,m.map)(t,e=>({guid:e.guid,type:Nc.components.filter,data:Object.assign({fieldId:e.fieldId,value:e.value},e.$DISPLAYVALUE$&&{$DISPLAYVALUE$:e.$DISPLAYVALUE$})}))}})}getFilterPresetDescriptorsFromChildData(e){return(0,m.map)(e.filter(e=>e.type===Nc.components.filterPreset),e=>({filters:e.data.filters,recordGridFilters:(0,m.map)((0,m.filter)(e.children,e=>e.type===Nc.components.filter),e=>({fieldId:e.data.fieldId,value:e.data.value,guid:e.guid,$DISPLAYVALUE$:e.data.$DISPLAYVALUE$})),title:e.data.title,guid:e.guid})).filter(e=>{var t;return(null===(t=e.recordGridFilters)||void 0===t?void 0:t.length)>0})}getActionsFromComponent(e){return(0,m.map)((0,m.filter)(e.children,e=>e.type===d.RxViewComponentType.Action),e=>Object.assign(Object.assign({},e),{data:Object.assign({},e.data)}))}getNamedFilterOptionsFromComponent(e){return e.children.filter(e=>e.type===Nc.components.filterPreset).map(e=>Object.assign(Object.assign({},e),{data:Object.assign({},e.data)}))}getDefaultColumns(e){let t=[];if(e){const i=e.fieldDefinitions,n=a.RX_RECORD_DEFINITION.coreFieldIds;t=[{title:(0,m.find)(i,e=>e.id===n.displayId).name,fieldId:String(n.displayId),searchable:!0}],e.resourceType===a.RX_RECORD_DEFINITION.recordDefinitionTypes.regular.recordDefinitionType&&(t.push({title:(0,m.find)(i,e=>e.id===n.modifiedDate).name,fieldId:String(n.modifiedDate),searchable:!1}),t.push({title:(0,m.find)(i,e=>e.id===n.description).name,fieldId:String(n.description),searchable:!0}));const o=(0,m.reduce)(Nc.columnProperties,(e,t)=>(e[t.name]=t.defaultValue,e),{});(0,m.forEach)(t,(e,t)=>(0,m.defaults)(e,o,{index:t,guid:this.rxGuidService.generate()}))}return t}getInitialSortColumnModel(e){const t=(0,m.find)(e,e=>(0,m.isObject)(e.sortable));return t?{direction:t.sortable.direction,fieldId:t.fieldId}:null}getInspectorColumnsFromDesignData(e){return e.map(e=>{const t=e.data;return Object.assign(Object.assign({},(0,m.pick)(t,["alignment","fieldId","filterType","searchable","title","cellDisplayProperties","width","typeaheadKeystrokeCount","additionalQueryCriteria"])),{actions:this.getActionsFromComponent(e),namedFilterOptions:this.getNamedFilterOptionsFromComponent(e),guid:e.guid,filterable:this.rxRecordGridConfigUtilsService.getBooleanValue(t.filterable)||(0,m.isUndefined)(t.filterable),sortable:this.rxRecordGridConfigUtilsService.parseConfigString(t.sortable)||(0,m.isUndefined)(t.sortable),visible:this.rxRecordGridConfigUtilsService.getBooleanValue(t.visible)||(0,m.isUndefined)(t.visible),wrapText:this.rxRecordGridConfigUtilsService.getBooleanValue(t.wrapText),index:Number(t.index)})})}getComponentProperties(e){var t,i,n;return{bordered:null===(t=e.bordered)||void 0===t||t,expandable:e.expandable,name:e.name,recordDefinitionName:e.recordDefinitionName,showDataForAllLocales:e.showDataForAllLocales,associationDefinitionName:e.associationDefinitionName,associatedRecordNodeSide:e.associatedRecordNodeSide,associatedRecordId:e.associatedRecordId,associatedRoleName:e.associatedRoleName,filterExpression:e.filterExpression,filters:(0,m.isObject)(e.filters)?e.filters.filtersJson:e.filters,defaultFilterPreset:this.getDefaultFilterPreset(e),cardLayoutWidth:e.cardLayoutWidth,enableFiltering:e.enableFiltering,requiredFilters:null!==(i=e.requiredFilters)&&void 0!==i?i:0,getDataForHiddenColumns:null===(n=e.getDataForHiddenColumns)||void 0===n||n,enableFilterPresets:e.enableFilterPresets,enableRowSelection:e.enableRowSelection,styles:e.styles,striped:!!e.striped,viewPresetSelector:e.viewPresetSelector,[d.RX_AVAILABLE_ON_DEVICES_PROP_NAME]:e[d.RX_AVAILABLE_ON_DEVICES_PROP_NAME]}}getDefaultFilterPreset(e){return e.defaultFilterPreset&&e.filterPresets?e.filterPresets.some(t=>t.guid===e.defaultFilterPreset)?e.defaultFilterPreset:null:e.defaultFilterPreset&&!e.filterPresets?e.defaultFilterPreset:null}getComponentDesignProperties(e,t,i,n,o){const r=this.getInspectorColumnsFromDesignData(i);return e=Object.assign(Object.assign({},t),e),Object.assign(Object.assign({},e),{mode:e.associationDefinitionName?np.Association:np.Record,filters:{basicFilters:n,filtersJson:e.filters},filterMode:e.filterExpression?ip.Expression:ip.Basic,filterPresets:o,initialSortColumn:this.getInitialSortColumnModel(r),columns:r})}getActionButtonDescriptorsFromChildData(e){return e.filter(e=>e.type===d.RxViewComponentType.ActionButton)}getGridViewPresetsFromChildData(e){return e.filter(e=>e.type===Nc.components.viewPreset)}getBasicRecordGridFiltersFromChildData(e){return(0,m.map)(e.filter(e=>e.type===Nc.components.filter),e=>({fieldId:e.data.fieldId,value:e.data.value,guid:e.guid,$DISPLAYVALUE$:e.data.$DISPLAYVALUE$}))}getRowActionButtonPayloads(e){return e.map(e=>({type:d.RxViewComponentType.ActionButton,guid:e.guid,data:(0,m.omit)(e,"actions","guid"),outletName:Nc.rowActionsOutletName,children:this.getColumnActionComponentPayloads(e.actions)}))}getInspector(e,t,i){const n=Boolean(e.recordDefinitionName&&t),o=[{name:"name",component:l.TextFormControlComponent,options:{label:"Name",tooltip:new s.Tooltip("Enter a name to uniquely identify the Record grid.")}},{name:"mode",component:l.GroupButtonFormControlComponent,options:{required:!1,label:"Mode",items:[{value:np.Record,name:"Record"},{value:np.Association,name:"Association"}]}},{name:"recordDefinitionName",component:l.RxDefinitionPickerComponent,options:{label:e.mode===np.Association?"Record definition to show":"Record definition name",definitionType:e.mode===np.Association?l.RxDefinitionPickerType.RegularDataRecord:l.RxDefinitionPickerType.Record,required:!0,beforeValueChange:(t,i)=>!(0,m.isEmpty)(e.columns)&&Boolean(t)?this.rxModalService.confirm({title:"Warning",modalStyle:S.RX_MODAL.modalStyles.warning,message:"Initial column sort, initial filters, and added grid columns will be cleared. Do you want to continue?"}):Promise.resolve(!0)}}],r=[{name:"cardLayoutWidth",component:l.SelectFormControlComponent,options:{label:"Card layout width",sortAlphabetically:!1,options:Nc.cardLayoutWidthOptions,emptyOption:!0,tooltip:new s.Tooltip("The width of the Record grid view component at which it will switch to card layout.")}},{name:"initialSortColumn",component:jp,options:{label:"Initial column sort",gridColumns:(0,m.sortBy)(e.columns,"title"),recordDefinition:t}},{name:"enableRowSelection",component:l.OptionalSelectFormControlComponent,options:{label:"Enable row selection",options:[{id:Nc.selectionTypes.multiple,name:"Multiple rows"},{id:Nc.selectionTypes.single,name:"Single row"}]}},{name:"expandable",component:l.SwitchFormControlComponent,hidden:!this.rxFeatureService.isFeatureEnabled("DRD21-44922"),options:{label:"Enable grid width expansion",tooltip:new s.Tooltip("If enabled, the grid will expand in width to accommodate wider columns. If one or more columns extend beyond the right border of the grid, a horizontal scroll bar will appear.<br>Column width will be converted to pixels if grid width expansion mode is enabled.")}},{name:"bordered",component:l.SwitchFormControlComponent,options:{label:"Show border lines"}},{name:"striped",component:l.SwitchFormControlComponent,options:{label:"Show striped rows"}},{name:"showDataForAllLocales",component:l.SwitchFormControlComponent,options:{label:"Show data for all locales",tooltip:new s.Tooltip("If enabled, data for all locales will be displayed in the grid at runtime. If disabled, only data for current locale will be displayed.")}},(0,c.getAvailableOnDevicesInspectorConfig)(),(0,c.getStylesFieldInspectorConfig)()];if(e.mode===np.Association){n&&o.push({name:"associationDefinitionName",component:l.SelectFormControlComponent,options:{required:!0,label:"Association to use",options:(0,m.map)(i,e=>({id:e.name,name:this.rxDefinitionNameService.getDisplayName(e.name)})),emptyOption:!0}});const t=(0,m.find)(i,t=>t.name===e.associationDefinitionName);t&&t.nodeAId===t.nodeBId&&o.push({name:"associatedRecordNodeSide",component:l.SelectFormControlComponent,options:{required:!0,label:"Associated record node side",options:[{id:C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA.value,name:t.nodeAName||C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA.defaultName},{id:C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.value,name:t.nodeBName||C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.defaultName}],emptyOption:!0}}),o.push({name:"associatedRecordId",component:l.ExpressionInspectorControlComponent,options:{label:"Associated record ID",isRequired:!0}}),t&&t.cardinality===C.RX_ASSOCIATION_DEFINITION.cardinality.manyToMany.value&&o.push({name:"associatedRoleName",component:l.ExpressionInspectorControlComponent,options:{label:"Associated role name"}})}n&&(o.push({name:"columns",component:ep,options:{recordDefinition:t}}),o.push({name:"getDataForHiddenColumns",component:l.SwitchFormControlComponent,options:{label:"Get data for hidden columns",tooltip:new s.Tooltip(this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.get-data-for-hidden-columns.tooltip"))}}),o.push({widgetName:"rowActions",component:kp}));const a=[{name:"enableFiltering",component:l.SwitchFormControlComponent,options:{label:"Enable filtering"}},{name:"requiredFilters",component:l.SelectFormControlComponent,isDisabled:!e.enableFiltering,options:{label:"Required number of filters",sortAlphabetically:!1,options:Nc.numberOfFiltersOptions,emptyOption:!1,tooltip:new s.Tooltip("Data will be displayed in the grid only if a) the number of applied filters is greater than or equal to the required number of filters, or b) a search is performed.")}}];n&&(a.push({name:"filterMode",component:l.GroupButtonFormControlComponent,options:{label:"Initial filters",items:[{name:"Basic",value:ip.Basic},{name:"Expression",value:ip.Expression}],tooltip:new s.Tooltip("Select the records that should be displayed on the deployed application UI. Application users can add filters in the deployed application."),beforeValueChange:(t,i)=>i===ip.Expression&&e.filters.filtersJson||i===ip.Basic&&e.filterExpression?this.rxModalService.confirm({title:"Change filter type",modalStyle:S.RX_MODAL.modalStyles.warning,message:"Current filter will be cleared. Do you want to continue?"}):Promise.resolve(!0)}}),e.filterMode===ip.Basic?a.push({name:"filters",component:bp,options:{primaryRecordDefinition:t}}):a.push({name:"filterExpression",component:l.ExpressionInspectorControlComponent,options:{label:"Initial filters",isLabelHidden:!0}}),a.push({name:"enableFilterPresets",component:l.SwitchFormControlComponent,isDisabled:!e.enableFiltering,options:{label:"Enable filter presets"}}),a.push({name:"filterPresets",component:Vp,options:{label:"Filter presets",tooltip:new s.Tooltip("Predefine sets of record grid filters users can apply."),primaryRecordDefinition:t,columns:e.columns.filter(e=>e.filterable)}})),(0,m.isEmpty)(e.filterPresets)||a.push({name:"defaultFilterPreset",component:l.SelectFormControlComponent,options:{label:"Default filter preset",tooltip:new s.Tooltip("Select a filter preset to be applied when a user opens this view for the first time."),options:(0,m.map)(e.filterPresets,e=>({id:e.guid,name:e.title})),emptyOption:!0}});return{inspectorSectionConfigs:[{label:"General",controls:o},{label:"Filters",controls:a},{label:"Presentation",controls:r},{label:"View presets",controls:[{component:$p,options:{recordDefinition:t}}]}]}}getColumnDataDictionaryBranch(e,t,i,n,a,s){const l=(0,o.combineLatest)([n,a]).pipe((0,r.switchMap)(([t,i])=>i?this.getColumnsDataDictionaryBuilder(e,t,i).pipe((0,r.map)(t=>({label:this.rxDefinitionNameService.getDisplayName(i.name),expression:`\${view.components.${e}.api}`,children:[{label:"First selected row",expression:`\${view.components.${e}.firstSelectedRow}`,children:t("firstSelectedRow")},{label:"Is user allowed to delete records",expression:`\${view.components.${e}.isUserAllowedToDeleteRecords}`},{label:"Last action row",expression:`\${view.components.${e}.clickableRow}`,children:t("clickableRow")},{label:"Selected rows",expression:`\${view.components.${e}.selectedRows}`,children:t("fieldValuesByFieldId")},{label:"Selected row count",expression:`\${view.components.${e}.selectedRowCount}`},{label:"Total row count",expression:`\${view.components.${e}.totalRowCount}`},{label:"Query expression",expression:`\${view.components.${e}.queryExpression}`},{label:"Last refresh time",expression:`\${view.components.${e}.lastRefreshTime}`}]})),(0,r.take)(1)):(0,o.of)(null)));return(0,o.combineLatest)([i,l,s]).pipe((0,r.map)(([e,i,n])=>i?Object.assign(Object.assign({},i),{label:this.getComponentName(t,i.label,n,e)}):null))}getColumnsDataDictionaryBuilder(e,t,i){return(t.length?(0,o.forkJoin)(t.map(t=>this.rxRecordGridUtilsService.getFieldDefinition(t.data.fieldId,i).pipe((0,r.filter)(e=>!!e),(0,r.map)(i=>this.getColumnDataDictionaryBranchBuilder(e,t,i))))):(0,o.of)([])).pipe((0,r.map)(e=>t=>e.map(e=>e.call(this,t))))}getColumnDataDictionaryBranchBuilder(e,t,i){const n=i.resourceType===a.RX_RECORD_DEFINITION.resourceTypes.selection?(0,m.map)(i.optionNamesById,(i,n)=>({label:i,expression:`\${view.components.${e}.recordDefinition.fieldDefinitionsById[${t.data.fieldId}].optionsById[${n}].id}`})):void 0;return o=>{var r;return{label:(null===(r=t.data.title)||void 0===r?void 0:r.trim())||`[${i.name}]`,expression:`\${view.components.${e}.${o}.${t.data.fieldId}}`,autocompleteOptions:n,children:i.resourceType===a.RX_RECORD_DEFINITION.resourceTypes.selection?[{label:`${t.data.title} (Option name)`,expression:`\${view.components.${e}.${o}.selectionFieldOptionNamesById.${t.data.fieldId}}`},{label:"Options",children:n}]:null}}}getComponentName(e,t,i,n){const o=[t,i,n].filter(Boolean);return o.length?`${e} (${o.join(": ")})`:e}getGridViewPresetPayload(e,t){return{type:Nc.components.viewPreset,guid:this.rxGuidService.generate(),data:{viewPresetGuid:e,filters:null},children:t.map(e=>this.getColumnPresetPayload(e))}}getColumnPresetPayload(e){return{type:Nc.components.columnViewPreset,data:{fieldId:e.fieldId,index:e.index,visible:e.visible,sortable:(0,m.isObject)(e.sortable)?e.sortable:null,width:e.width}}}getPresetsList(e){return e?this.viewDesignerFacade.getChildComponents(e).pipe((0,r.map)(e=>e.sort((e,t)=>e.data.index-t.data.index)),(0,r.map)(e=>e.map(e=>({guid:e.guid,name:e.data.label}))),(0,r.debounceTime)(50)):(0,o.of)([])}}Lp.\u0275fac=function(e){return new(e||Lp)(n["\u0275\u0275inject"](v.RxGuidService),n["\u0275\u0275inject"](Lc),n["\u0275\u0275inject"](s.RxDefinitionNameService),n["\u0275\u0275inject"](s.RxFeatureService),n["\u0275\u0275inject"](S.RxModalService),n["\u0275\u0275inject"](kc),n["\u0275\u0275inject"](sp),n["\u0275\u0275inject"](p.TranslateService),n["\u0275\u0275inject"](c.ViewDesignerFacade),n["\u0275\u0275inject"](v.RxJsonParserService))},Lp.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Lp,factory:Lp.\u0275fac,providedIn:"root"});class Gp extends c.ViewDesignerComponentModel{constructor(){super(...arguments),this.rxRecordDefinitionCacheService=this.injector.get(a.RxRecordDefinitionCacheService),this.rxViewActionValidatorService=this.injector.get(c.RxViewActionValidatorService),this.rxRecordGridDesignUtilsService=this.injector.get(Lp),this.rxGuidService=this.injector.get(v.RxGuidService),this.rxDefinitionNameService=this.injector.get(s.RxDefinitionNameService),this.preservedRecordDefinition=null,this.preservedRecordAssociationDefinitions=[],this.currentGridDesignProperties=null,this.componentPropertiesChangeFromCanvas$=new o.Subject,this.columns$=this.sandbox.getComponentPropertyValue("columns"),this.enableFiltering$=this.sandbox.getComponentPropertyValue("enableFiltering"),this.recordDefinitionName$=this.sandbox.getComponentPropertyValue("recordDefinitionName"),this.associationDefinitionName$=this.sandbox.getComponentPropertyValue("associationDefinitionName"),this.associatedRecordNodeSide$=this.sandbox.getComponentPropertyValue("associatedRecordNodeSide"),this.childComponentsTree$=this.sandbox.getChildComponentsTree(),this.viewPresetSelectors$=this.sandbox.getComponentsByType(d.RxViewComponentType.ViewPresetSelector),this.gridViewPresets$=this.childComponentsTree$.pipe((0,r.map)(e=>this.rxRecordGridDesignUtilsService.getGridViewPresetsFromChildData(e))),this.viewPresetSelectorGuid$=this.sandbox.getComponentPropertyValue("viewPresetSelector").pipe((0,r.map)(e=>this.extractViewPresetSelectorGuid(e)),(0,r.shareReplay)({refCount:!0,bufferSize:1})),this.selectedPresetsList$=this.viewPresetSelectorGuid$.pipe((0,r.switchMap)(e=>this.rxRecordGridDesignUtilsService.getPresetsList(e)),(0,r.distinctUntilChanged)(m.isEqual),(0,r.takeUntil)(this.sandbox.destroyed$)),this.rowActionButtonGuids$=this.sandbox.getLayout(this.sandbox.guid).pipe((0,r.filter)(Boolean),(0,r.map)(e=>{const t=(0,m.find)(e.outlets,{name:Nc.rowActionsOutletName});return(0,m.head)(t.columns).children}),(0,r.shareReplay)(1))}static getInitialProperties(e){return Object.assign(Object.assign({},d.RX_AVAILABLE_ON_DEVICES_DEFAULT_VALUE),e)}rxInit(){const e=Object.assign({bordered:!0,expandable:!1,name:null,mode:np.Record,recordDefinitionName:null,showDataForAllLocales:!1,associationDefinitionName:null,associatedRecordId:null,associatedRoleName:null,enableRowSelection:Nc.selectionTypes.multiple,styles:null,cardLayoutWidth:null,enableFiltering:!0,getDataForHiddenColumns:!0,requiredFilters:0,enableFilterPresets:!0,defaultFilterPreset:null,initialSortColumn:null,columns:[],filterMode:ip.Basic,filters:{basicFilters:[],filtersJson:null},filterExpression:null,filterPresets:[],striped:!1},d.RX_AVAILABLE_ON_DEVICES_DEFAULT_VALUE);this.recordDefinition$=this.recordDefinitionName$.pipe((0,r.switchMap)(e=>this.getRecordDefinition(e)),(0,r.shareReplay)(1)),this.recordAssociationDefinitions$=this.recordDefinitionName$.pipe((0,r.mergeMap)(e=>this.getRecordAssociationDefinitions(e)),(0,r.shareReplay)(1));const t=this.childComponentsTree$.pipe((0,r.map)(e=>e.filter(e=>e.type===Nc.components.column)),(0,r.distinctUntilChanged)(m.isEqual)),i=this.childComponentsTree$.pipe((0,r.map)(e=>this.rxRecordGridDesignUtilsService.getBasicRecordGridFiltersFromChildData(e)),(0,r.distinctUntilChanged)(m.isEqual)),n=this.childComponentsTree$.pipe((0,r.map)(e=>this.rxRecordGridDesignUtilsService.getFilterPresetDescriptorsFromChildData(e)),(0,r.distinctUntilChanged)(m.isEqual));this.actionButtonComponents$=this.childComponentsTree$.pipe((0,r.withLatestFrom)(this.rowActionButtonGuids$),(0,r.map)(([e,t])=>this.rxRecordGridDesignUtilsService.getActionButtonDescriptorsFromChildData(e).filter(e=>!(0,m.includes)(t,e.guid)))),this.rowActionButtonComponents$=this.childComponentsTree$.pipe((0,r.withLatestFrom)(this.rowActionButtonGuids$),(0,r.map)(([e,t])=>this.rxRecordGridDesignUtilsService.getActionButtonDescriptorsFromChildData(e).filter(e=>(0,m.includes)(t,e.guid)))),this.viewPresetSelectors$.pipe((0,r.map)(e=>e.map(e=>e.guid).sort()),(0,r.distinctUntilChanged)(m.isEqual),(0,r.withLatestFrom)(this.viewPresetSelectorGuid$),(0,r.filter)(([e,t])=>t&&!e.includes(t)),(0,r.switchMap)(()=>this.childComponentsTree$.pipe((0,r.take)(1))),(0,r.map)(e=>e.filter(e=>e.type!==Nc.components.viewPreset)),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.setChildren(e),this.sandbox.updateComponentProperties({viewPresetSelector:null})}),this.sandbox.viewModelsInitialized$.pipe((0,r.withLatestFrom)(this.rowActionButtonComponents$),(0,r.map)(([e,t])=>t),(0,r.filter)(e=>!!e.length)).subscribe(e=>{e.forEach(e=>{this.sandbox.getComponentModel(e.guid).setValidationIssues([])})}),(0,o.merge)(this.sandbox.componentProperties$.pipe((0,r.skip)(1)),this.componentPropertiesChangeFromCanvas$).pipe((0,r.distinctUntilChanged)((e,t)=>(0,m.isEqual)(this.currentGridDesignProperties,t)),(0,r.mergeMap)(e=>{const t=this.currentGridDesignProperties;return t.recordDefinitionName!==e.recordDefinitionName?(0,o.zip)(this.getRecordDefinition(e.recordDefinitionName),this.getRecordAssociationDefinitions(e.recordDefinitionName)).pipe((0,r.map)(()=>[t,e])):(0,o.of)([t,e])}),(0,r.withLatestFrom)(this.actionButtonComponents$,this.rowActionButtonComponents$,this.gridViewPresets$),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([[e,t],i,n,o])=>{const r=this.preservedRecordDefinition,a=this.preservedRecordAssociationDefinitions;let s;if(t.enableFiltering?!e.enableFiltering&&t.enableFiltering&&(s={enableFilterPresets:!0}):s={enableFilterPresets:!1},e.recordDefinitionName!==t.recordDefinitionName)if(s={filterPresets:[],filters:{basicFilters:[],filtersJson:null},initialSortColumn:null,associationDefinitionName:null,filterExpression:null},r){const e=this.rxRecordGridDesignUtilsService.getDefaultColumns(r),t=this.rxRecordGridDesignUtilsService.getColumnComponentPayloads(e,null);t.push(...i),this.sandbox.setChildren(t),s.columns=e}else this.sandbox.setChildren(i),s.columns=[];else{const r=(0,m.pick)(t,"columns","initialSortColumn","filters","filterPresets"),a=(0,m.pick)(e,"columns","initialSortColumn","filters","filterPresets");if(!(0,m.isEqual)(a,r)){const e=this.rxRecordGridDesignUtilsService.getColumnComponentPayloads(r.columns,r.initialSortColumn),t=this.rxRecordGridDesignUtilsService.getInspectorColumnsFromDesignData(e);e.push(...this.rxRecordGridDesignUtilsService.getGridFilterComponentPayloads(r.filters.basicFilters||[]));const a=this.rxRecordGridDesignUtilsService.getGridFilterPresetComponentPayloads(r.filterPresets,t.filter(e=>e.filterable));e.push(...a),r.filterPresets=this.rxRecordGridDesignUtilsService.getFilterPresetDescriptorsFromChildData(a),e.push(...i,...n,...o),this.sandbox.setChildren(e),s={columns:t,initialSortColumn:this.rxRecordGridDesignUtilsService.getInitialSortColumnModel(t),filterPresets:r.filterPresets}}}e.filterMode!==t.filterMode&&(s=t.filterMode===ip.Basic?{filterExpression:null}:{filters:{basicFilters:[],filtersJson:null}}),e.associationDefinitionName!==t.associationDefinitionName&&(s=Object.assign(Object.assign({},s||{}),{associatedRecordNodeSide:this.getAssociatedRecordNodeSide(t,a)})),e.mode!==t.mode&&(s={associationDefinitionName:null,associatedRecordId:null,associatedRoleName:null,associatedRecordNodeSide:null}),t=Object.assign(Object.assign({},t),s),e.enableFiltering&&!t.enableFiltering&&(s=Object.assign(Object.assign({},s),{requiredFilters:0})),this.updateComponentPropertiesAndConfig(t,s,r,a)}),(0,o.combineLatest)([this.recordDefinitionName$.pipe((0,r.map)(e=>e?null:this.sandbox.createError("Record definition name cannot be blank.","recordDefinitionName"))),t.pipe((0,r.switchMap)(e=>this.validateColumns(e))),this.sandbox.getComponentPropertyValue("styles").pipe((0,r.map)(c.validateCssClassNames)),this.sandbox.getComponentPropertyValue("mode").pipe((0,r.switchMap)(e=>e===np.Association?this.validateAssociationModeProps():this.actionButtonComponents$.pipe((0,r.switchMap)(e=>this.validateActionButtons(e))))),this.rowActionButtonComponents$.pipe((0,r.switchMap)(e=>this.validateRowActions(e))),this.sandbox.getComponentPropertyValue(d.RX_AVAILABLE_ON_DEVICES_PROP_NAME).pipe((0,r.map)(c.validateAvailableOnDevicesProp))]).pipe((0,r.map)(m.compact),(0,r.map)(m.flatten),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.setValidationIssues(e)}),(0,o.combineLatest)([this.sandbox.componentProperties$,this.recordDefinition$,this.recordAssociationDefinitions$,t,i,n]).pipe((0,r.take)(1),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([t,i,n,o,r,a])=>{const s=this.rxRecordGridDesignUtilsService.getComponentDesignProperties(t,e,o,r,a);this.updateComponentPropertiesAndConfig(s,s,i,n)});const a=this.sandbox.getComponentPropertyValue("name").pipe((0,r.shareReplay)(1),(0,r.takeUntil)(this.sandbox.destroyed$)),s=this.associationDefinitionName$.pipe((0,r.map)(e=>this.rxDefinitionNameService.getDisplayName(e)),(0,r.shareReplay)(1),(0,r.takeUntil)(this.sandbox.destroyed$));this.rxRecordGridDesignUtilsService.getColumnDataDictionaryBranch(this.sandbox.guid,this.sandbox.descriptor.name,a,t,this.recordDefinition$,s).pipe((0,r.skipWhile)(m.isEmpty),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.setCommonDataDictionary(e)}),(0,o.combineLatest)([this.recordDefinitionName$.pipe((0,r.map)(e=>this.rxDefinitionNameService.getDisplayName(e))),s,a]).pipe((0,r.map)(e=>this.rxRecordGridDesignUtilsService.getComponentName(this.sandbox.descriptor.name,...e)),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.setSettablePropertiesDataDictionary(e,[])}),this.selectedPresetsList$.pipe((0,r.skip)(1),(0,r.withLatestFrom)(this.childComponentsTree$,this.columns$),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([e,t,i])=>{this.updatePresetViewComponents(t,e,i)})}updatePresetViewComponents(e,t,i){const n=e.filter(e=>e.type===Nc.components.viewPreset),o=t.map(({guid:e})=>{const t=n.find(t=>t.data.viewPresetGuid===e);return null!=t?t:this.rxRecordGridDesignUtilsService.getGridViewPresetPayload(e,i)});this.sandbox.setChildrenByType(o,[Nc.components.viewPreset])}getAssociatedRecordNodeSide(e,t){const i=e.associationDefinitionName?t.find(({name:t})=>t===e.associationDefinitionName):null;return i?i.nodeAId===e.recordDefinitionName?C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeA.value:C.RX_ASSOCIATED_RECORD_NODE_SIDES.nodeB.value:null}actionButtonDropPredicate(e){return e.draggedViewComponentDescriptor.type===d.RxViewComponentType.ActionButton}getPropertiesByName(e){return this.rxRecordGridDesignUtilsService.getComponentProperties(e)}setRowActions(e){this.rowActionButtonGuids$.pipe((0,r.take)(1),(0,r.withLatestFrom)(this.childComponentsTree$)).subscribe(([t,i])=>{const n=i.filter(e=>!(0,m.includes)(t,e.guid));n.push(...this.rxRecordGridDesignUtilsService.getRowActionButtonPayloads(e)),this.sandbox.setChildren(n),this.toggleActionsColumn(e.length>0)})}extractViewPresetSelectorGuid(e){var t;const i=null==e?void 0:e.match(/^\${view\.components\.([0-9a-z-]+)\.api}$/);return null!==(t=i&&i[1])&&void 0!==t?t:null}toggleActionsColumn(e){this.sandbox.componentProperties$.pipe((0,r.take)(1)).subscribe(t=>{const i=(0,m.cloneDeep)(t.columns),n=(0,m.find)(i,{fieldId:Nc.actionsColumnFieldDefinition.id});e&&!n?i.push({fieldId:Nc.actionsColumnFieldDefinition.id,guid:this.rxGuidService.generate(),title:Nc.actionsColumnFieldDefinition.name,visible:!0,index:i.length,filterable:!1,sortable:!1,searchable:!1}):e||((0,m.pull)(i,n),i.forEach((e,t)=>{e.index=t})),this.updateComponentPropertiesAndConfig(t,{columns:i},this.preservedRecordDefinition,this.preservedRecordAssociationDefinitions)})}updateComponentPropertiesAndConfig(e,t,i,n){this.currentGridDesignProperties=e,t&&this.sandbox.updateComponentProperties(t),this.sandbox.updateInspectorConfig(this.rxRecordGridDesignUtilsService.getInspector(e,i,n))}getRecordDefinition(e){return e?this.rxRecordDefinitionCacheService.getRecordDefinition(e).pipe((0,r.catchError)(e=>(0,o.of)(null)),(0,r.tap)(e=>this.preservedRecordDefinition=e)):(this.preservedRecordDefinition=null,(0,o.of)(null))}getRecordAssociationDefinitions(e){return e?this.rxRecordDefinitionCacheService.getRecordAssociationDefinitions(e).pipe((0,r.map)(t=>t[e]||[]),(0,r.catchError)(e=>(0,o.of)([])),(0,r.tap)(e=>this.preservedRecordAssociationDefinitions=e)):(this.preservedRecordAssociationDefinitions=[],(0,o.of)([]))}validateColumns(e){return e.length?this.validateColumnActions(e):(0,o.of)([this.sandbox.createError("Record grid must have at least one column.","columns")])}validateColumnActions(e){return(0,o.combineLatest)(e.map(e=>{const t=(0,m.filter)(e.children,{type:d.RxViewComponentType.Action});return this.rxViewActionValidatorService.validate(t,"columns").pipe((0,r.map)(t=>t.map(t=>Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{columnGuid:e.guid})}))))})).pipe((0,r.map)(m.flatten))}validateRowActions(e){return e.length?(0,o.combineLatest)(e.map((e,t)=>this.rxViewActionValidatorService.validate(e.children,"rowActions").pipe((0,r.map)(e=>e.map(e=>Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{rowActionIndex:t})})))))).pipe((0,r.map)(m.flatten)):(0,o.of)([])}validateAssociationModeProps(){return(0,o.combineLatest)([(0,o.combineLatest)([this.associationDefinitionName$,this.associatedRecordNodeSide$]).pipe((0,r.map)(([e,t])=>e?t?null:this.sandbox.createError("Associated record node side cannot be blank.","associatedRecordNodeSide"):this.sandbox.createError("Association definition name cannot be blank.","associationDefinitionName"))),this.sandbox.getComponentPropertyValue("associatedRecordId").pipe((0,r.map)(e=>e?null:this.sandbox.createError("Associated record ID cannot be blank.","associatedRecordId")))]).pipe((0,r.map)(m.compact))}validateActionButtons(e){const t=(0,m.flatten)(e.map(e=>e.children)).filter(({data:e})=>"rxDeleteRecordsAction"===e.name&&e.recordDefinitionName);return t.length?(0,o.combineLatest)(t.map(({data:e})=>this.rxRecordDefinitionCacheService.getRecordDefinition(e.recordDefinitionName).pipe((0,r.map)(({resourceType:e})=>e===a.RX_RECORD_DEFINITION.recordDefinitionTypes.join.recordDefinitionType?this.sandbox.createWarning("You have configured a Record grid action to delete Join records. Please ensure that one or more processes or rules have been defined to perform the deletion of the selected Join record instances."):null)))).pipe((0,r.map)(m.compact)):(0,o.of)([])}}class qp{constructor(e,t){this.rxRecordGridConfigUtilsService=e,this.rxRecordGridUtilsService=t}ngOnInit(){this.adaptTableConfig$=this.model.columns$.pipe((0,r.map)(e=>{const t=(0,m.sortBy)(e,e=>e.index),i=t.find(e=>(0,m.isObject)(e.sortable));let n={field:null,order:null};if(i){const e=i.sortable;n={field:String(i.fieldId),order:this.rxRecordGridConfigUtilsService.getColumnSortOrder(e.direction)}}return{columns:t.map(e=>({field:e.fieldId,header:e.title,sortable:Boolean(e.sortable),hidden:!e.visible,testId:this.rxRecordGridUtilsService.getTestIdForGridColumn(e.fieldId)})),sortMeta:n,toolbarConfig:{counter:!1,quickFilter:!0,filter:!0,filterTemplate:this.filterTemplate,filterResults:!1,visibleColumnsMenu:!0,visibleColumnsMenuTemplate:this.visibleColumnsMenuTemplate,quickFilterTriggerable:!0}}}),(0,r.shareReplay)(1)),this.hasRecordDefinitionName$=this.model.recordDefinition$.pipe((0,r.map)(Boolean),(0,r.shareReplay)(1))}onSort(e){this.adaptTableConfig$.pipe((0,r.take)(1)).subscribe(t=>{if(!(0,m.isEqual)(e,t.sortMeta)){let t;const i=this.model.currentGridDesignProperties.columns.find(t=>t.fieldId===e.field);t=(0,m.isObject)(i.sortable)?i.sortable.direction===jc.Desc?null:{fieldId:i.fieldId,direction:jc.Desc}:{fieldId:i.fieldId,direction:jc.Asc},this.model.componentPropertiesChangeFromCanvas$.next(Object.assign(Object.assign({},this.model.currentGridDesignProperties),{initialSortColumn:t}))}})}onBeforeViewComponentDrop(e){e.draggedViewComponentDescriptor.type!==d.RxViewComponentType.ActionButton||e.draggedViewComponentGuid||(e.initialPropertiesByName=Object.assign(Object.assign({},e.initialPropertiesByName),{style:us.Tertiary}))}}qp.\u0275fac=function(e){return new(e||qp)(n["\u0275\u0275directiveInject"](Lc),n["\u0275\u0275directiveInject"](kc))},qp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:qp,selectors:[["rx-record-grid-design"]],viewQuery:function(e,t){if(1&e&&(n["\u0275\u0275viewQuery"](gr,7),n["\u0275\u0275viewQuery"](vr,7)),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.filterTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.visibleColumnsMenuTemplate=e.first)}},inputs:{model:"model",isReadOnly:"isReadOnly"},decls:10,vars:8,consts:[[1,"rx-record-grid-design"],["type","objects","label","Select a record definition and edit grid columns in the Properties panel.",4,"ngIf","ngIfElse"],["gridTemplate",""],["filterTemplate",""],["visibleColumnsMenuTemplate",""],["type","objects","label","Select a record definition and edit grid columns in the Properties panel."],[1,"rx-record-grid-design__action-buttons-canvas",3,"dropListOrientation","dropPredicate","beforeViewComponentDrop"],[1,"rx-record-grid-design__table",3,"columns","sortable","scrollable","scrollHeight","rowExpandMode","sortMode","toolbarConfig","filterable","sortField","sortOrder","bordered","totalRecords","hasEmptyState","dontEmitLazyLoadOnInputChange","onSort"],["adaptTable",""],[1,"rx-record-grid-design__toolbar-item","btn-link","d-icon-refresh","grid-toolbar-icon","mx-2","p-1"],["class","btn-link px-0 d-icon-left-filter d-icon-right-triangle_down",4,"ngIf"],[1,"btn-link","px-0","d-icon-left-filter","d-icon-right-triangle_down"]],template:function(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275template"](2,yr,1,0,"adapt-empty-state",1),n["\u0275\u0275pipe"](3,"async"),n["\u0275\u0275template"](4,xr,7,23,"ng-template",null,2,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](6,Cr,3,3,"ng-template",null,3,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](8,Sr,0,0,"ng-template",null,4,n["\u0275\u0275templateRefExtractor"])),2&e){const e=n["\u0275\u0275reference"](5);n["\u0275\u0275classProp"]("border",!n["\u0275\u0275pipeBind1"](1,4,t.hasRecordDefinitionName$)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!n["\u0275\u0275pipeBind1"](3,6,t.hasRecordDefinitionName$))("ngIfElse",e)}},directives:[f.NgIf,u.AdaptEmptyStateComponent,c.CanvasOutletComponent,A.AdaptTableComponent],pipes:[f.AsyncPipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.rx-record-grid-design__action-buttons-canvas[_ngcontent-%COMP%]     rx-canvas-item-container{min-width:100%}.rx-record-grid-design__action-buttons-canvas[_ngcontent-%COMP%]     .cdk-drop-list{background-color:#f0f1f1;border:1px solid #d6d7d8;border-bottom:0;min-height:48px;display:flex;flex-flow:row wrap}.rx-record-grid-design__action-buttons-canvas[_ngcontent-%COMP%]     .cdk-drop-list:empty:after{content:"Drop Action buttons here";display:block;text-align:center;width:100%;line-height:48px;color:#959899;font-size:.875rem}.rx-record-grid-design__toolbar-item[_ngcontent-%COMP%]{font-size:.9375rem}.rx-record-grid-design__table[_ngcontent-%COMP%]     .adapt-table-toolbar{pointer-events:none}'],changeDetection:0});class Up{constructor(e,t){this.rxJsonParserService=e,this.rxViewDefinitionParserService=t}adaptDefinition(e){var t,i,n,o,r;const a=this.rxJsonParserService.tryParseJson(e.layout),s=(0,m.find)(a.outlets,{name:Nc.rowActionsOutletName});e.propertiesByName.enableFilterPresets=null!==(t=e.propertiesByName.enableFilterPresets)&&void 0!==t?t:"true",s?(0,m.forEach)(null===(i=s.columns[0])||void 0===i?void 0:i.children,t=>{const i=(0,m.find)(e.componentDefinitions,{guid:t});(0,m.pull)(e.componentDefinitions,i).push(i)}):a.outlets.push(d.RxViewLayout.getOutlet(Nc.rowActionsOutletName)),e.layout=JSON.stringify(a),Object.assign(e.propertiesByName,{expandable:null!==(n=e.propertiesByName.expandable)&&void 0!==n&&n,showDataForAllLocales:null!==(o=e.propertiesByName.showDataForAllLocales)&&void 0!==o&&o,requiredFilters:null!==(r=e.propertiesByName.requiredFilters)&&void 0!==r?r:"true"===e.propertiesByName.requireFiltering?1:0}),delete e.propertiesByName.requireFiltering,this.rxViewDefinitionParserService.getComponents(e).map(e=>e.componentDefinition).forEach(e=>{var t,i;e.type===Nc.components.column&&Object.assign(e.propertiesByName,{wrapText:null!==(t=e.propertiesByName.wrapText)&&void 0!==t&&t,typeaheadKeystrokeCount:Number(null!==(i=e.propertiesByName.typeaheadKeystrokeCount)&&void 0!==i?i:Nc.defaultTypeaheadKeystrokeCount)})})}}Up.\u0275fac=function(e){return new(e||Up)(n["\u0275\u0275inject"](v.RxJsonParserService),n["\u0275\u0275inject"](d.RxViewDefinitionParserService))},Up.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Up,factory:Up.\u0275fac,providedIn:"root"});class zp{}zp.\u0275fac=function(e){return new(e||zp)},zp.\u0275mod=n["\u0275\u0275defineNgModule"]({type:zp,declarations:[jp],imports:[f.CommonModule,b.FormsModule,u.AdaptButtonModule,u.AdaptRxSelectModule],exports:[jp]}),zp.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.FormsModule,u.AdaptButtonModule,u.AdaptRxSelectModule]]});class Xp{}Xp.\u0275fac=function(e){return new(e||Xp)},Xp.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Xp,declarations:[_p],imports:[u.AdaptAccordionModule,u.AdaptButtonModule,u.AdaptRxCheckboxModule,u.AdaptRxTextfieldModule,f.CommonModule,x.DragDropModule,b.FormsModule,l.StepperWithUnitsFormControlModule,p.TranslateModule],exports:[_p]}),Xp.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[u.AdaptAccordionModule,u.AdaptButtonModule,u.AdaptRxCheckboxModule,u.AdaptRxTextfieldModule,f.CommonModule,x.DragDropModule,b.FormsModule,l.StepperWithUnitsFormControlModule,p.TranslateModule]]});class Wp{}Wp.\u0275fac=function(e){return new(e||Wp)},Wp.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Wp,declarations:[Bp],imports:[u.AdaptAccordionModule,u.AdaptButtonModule,u.AdaptTagModule,f.CommonModule,b.FormsModule,Op,zp,Xp,p.TranslateModule],exports:[Bp]}),Wp.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[u.AdaptAccordionModule,u.AdaptButtonModule,u.AdaptTagModule,f.CommonModule,b.FormsModule,Op,zp,Xp,p.TranslateModule]]});class Hp{}Hp.\u0275fac=function(e){return new(e||Hp)},Hp.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Hp,declarations:[$p],imports:[f.CommonModule,u.AdaptButtonModule,b.FormsModule,Wp,l.SelectFormControlModule],exports:[$p]}),Hp.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptButtonModule,b.FormsModule,Wp,l.SelectFormControlModule]]});class Qp{constructor(e,t){this.rxDefinitionAdapterRegistryService=e,this.rxRecordGridDesignAdapterService=t,this.rxDefinitionAdapterRegistryService.registerDesignAdapter(Nc.type,this.rxRecordGridDesignAdapterService)}}Qp.\u0275fac=function(e){return new(e||Qp)(n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService),n["\u0275\u0275inject"](Up))},Qp.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Qp,declarations:[qp,ep,Zc,Gc,Vp,Tp,kp,Np,Hc,Wc,Yc,Kc],imports:[f.CommonModule,b.FormsModule,b.ReactiveFormsModule,zp,u.AdaptButtonModule,u.AdaptTooltipModule,u.AdaptAccordionModule,F.AdaptTextFieldModule,u.AdaptRxSearchModule,u.AdaptTreeModule,u.AdaptRxCheckboxModule,u.AdaptRxRadiobuttonModule,c.ActionListControlModule,l.GroupButtonFormControlModule,x.DragDropModule,l.ExpressionEditorModule,u.AdaptAdvancedFilteringModule,u.AdaptRxTextfieldModule,S.RxDirectivesModule,u.AdaptRxLabelModule,wp,c.ViewDesignerCanvasModule,A.AdaptTableModule,u.AdaptEmptyStateModule,s.RxDefinitionModule,u.AdaptRxSelectModule,l.RxDefinitionPickerModule,l.ExpressionFormControlModule,u.AdaptIconModule,p.TranslateModule,l.SelectFormControlModule,v.RxUniqueValidatorModule,u.AdaptRxSwitchModule,l.IconPickerFormControlModule,u.AdaptPopoverModule,Ap,Hp,Op,l.StepperWithUnitsFormControlModule,v.RxNoWhitespaceValidatorModule]}),Qp.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,b.FormsModule,b.ReactiveFormsModule,zp,u.AdaptButtonModule,u.AdaptTooltipModule,u.AdaptAccordionModule,F.AdaptTextFieldModule,u.AdaptRxSearchModule,u.AdaptTreeModule,u.AdaptRxCheckboxModule,u.AdaptRxRadiobuttonModule,c.ActionListControlModule,l.GroupButtonFormControlModule,x.DragDropModule,l.ExpressionEditorModule,u.AdaptAdvancedFilteringModule,u.AdaptRxTextfieldModule,S.RxDirectivesModule,u.AdaptRxLabelModule,wp,c.ViewDesignerCanvasModule,A.AdaptTableModule,u.AdaptEmptyStateModule,s.RxDefinitionModule,u.AdaptRxSelectModule,l.RxDefinitionPickerModule,l.ExpressionFormControlModule,u.AdaptIconModule,p.TranslateModule,l.SelectFormControlModule,v.RxUniqueValidatorModule,u.AdaptRxSwitchModule,l.IconPickerFormControlModule,u.AdaptPopoverModule,Ap,Hp,Op,l.StepperWithUnitsFormControlModule,v.RxNoWhitespaceValidatorModule]]});class Jp extends h.BaseViewComponent{constructor(){super()}}Jp.\u0275fac=function(e){return new(e||Jp)},Jp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Jp,selectors:[["rx-page"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:0,template:function(e,t){1&e&&n["\u0275\u0275element"](0,"rx-runtime-view-canvas-outlet")},directives:[h.RuntimeViewCanvasOutletComponent],encapsulation:2});class Kp{constructor(e,t){this.context=e,this.translateService=t,this.alertConfig={content:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.cards.filter-by-selection.dialog.info.message"),type:"section",dismissible:!1,variant:"info",icon:!0},this.options=this.context.getData().filterableFields}optionFormatter(e){return e.name}apply(){this.context.close(this.field[0].id)}}Kp.\u0275fac=function(e){return new(e||Kp)(n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](p.TranslateService))},Kp.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Kp,selectors:[["rx-filter-by-card-selection"]],decls:11,vars:16,consts:[[3,"config"],[1,"modal-body","pt-0"],[3,"label","options","ngModel","required","optionFormatter","popupClass","ngModelChange"],[1,"modal-footer"],["adapt-button","","type","button","btn-type","primary","rx-id","apply-button",3,"disabled","click"],["adapt-button","","type","button","btn-type","secondary","rx-id","cancel-button",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-alert",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275elementStart"](2,"adapt-rx-select",2),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.field=e}),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"div",3),n["\u0275\u0275elementStart"](5,"button",4),n["\u0275\u0275listener"]("click",function(){return t.apply()}),n["\u0275\u0275text"](6),n["\u0275\u0275pipe"](7,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](8,"button",5),n["\u0275\u0275listener"]("click",function(){return t.context.dismiss()}),n["\u0275\u0275text"](9),n["\u0275\u0275pipe"](10,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("config",t.alertConfig),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("label",n["\u0275\u0275pipeBind1"](3,10,"com.bmc.arsys.rx.client.view-components.record-grid.cards.filter-by-selection.dialog.field.label"))("options",t.options)("ngModel",t.field)("required",!0)("optionFormatter",t.optionFormatter)("popupClass","rx-filter-by-card-selection-field-dropdown"),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("disabled",!t.field),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](7,12,"com.bmc.arsys.rx.client.common.apply.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](10,14,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[u.AdaptAlertComponent,u.AdaptRxSelectComponent,b.NgControlStatus,b.NgModel,b.RequiredValidator,u.AdaptButtonComponent],pipes:[p.TranslatePipe],encapsulation:2});class Yp{constructor(e,t,i,n,o){this.rxGuidService=e,this.rxFieldDefinitionService=t,this.rxRecordGridConfigUtilsService=i,this.rxRecordGridUtilsService=n,this.translateService=o}getGridConfig(e){const t=(0,m.defaults)(this.rxRecordGridConfigUtilsService.configDeepClone(e),{associatedRecordId:null,associatedRoleName:null,enableColumnSelection:!0,enableFiltering:!0,expandable:!1,useExternalFiltering:!0,enableRowSelection:Nc.selectionTypes.multiple,filterExpression:null,filters:Nc.defaultFilter,filterTagsLimit:3,recordIdField:a.RX_RECORD_DEFINITION.coreFieldIds.id.toString(),emptyStateLabelText:this.translateService.instant("com.bmc.arsys.rx.client.empty-state.no-items-to-display.label"),emptyStateWithFilterLabelText:this.translateService.instant("com.bmc.arsys.rx.client.empty-state.no-items-to-display.label"),searchFieldPlaceholderText:this.translateService.instant("com.bmc.arsys.rx.client.common.search.label"),styles:""});return t.recordDefinitionName||(e.getRecordDefinition||(0,o.throwError)(new v.RxError("getRecordDefinition function must be defined if recordDefinitionName is not set.")),e.getData||(0,o.throwError)(new v.RxError("getData function must be defined if recordDefinitionName is not set."))),t.enableFiltering=Boolean(t.enableFiltering),t.cardLayoutWidth=parseFloat(t.cardLayoutWidth)||null,t}getColumnsWithMetadata(e,t,i){const n=this.rxRecordGridConfigUtilsService.columnsDeepClone(t);this.allowedOpenViewActionExpressionsForHrefRegex=new RegExp(`^\\$\\{view\\.components\\.${e}\\.(clickableRow|recordDefinition)\\.|^\\$\\{view\\.inputParams\\.`);const s=n.map(e=>this.rxRecordGridUtilsService.getFieldDefinition(e.fieldId,i).pipe((0,r.map)(t=>{var n;let o=t.resourceType?this.getFieldDefinitionResourceTypeShortName(t.resourceType):null;o===a.RX_RECORD_DEFINITION.dataTypes.attachment.shortName&&(o=a.RX_RECORD_DEFINITION.dataTypes.character.shortName);const r=this.rxRecordGridConfigUtilsService.getBooleanValue(e.filterable)||(0,m.isUndefined)(e.filterable),s=(0,m.has)(e,"searchable")?this.rxRecordGridConfigUtilsService.getBooleanValue(e.searchable):r&&this.rxRecordGridUtilsService.isSearchable(t,i);return Object.assign(Object.assign({},e),{clickable:this.rxRecordGridConfigUtilsService.getBooleanValue(e.clickable),filterable:r,sortable:this.rxRecordGridConfigUtilsService.parseConfigString(e.sortable)||(0,m.isUndefined)(e.sortable),visible:this.rxRecordGridConfigUtilsService.getBooleanValue(e.visible)||(0,m.isUndefined)(e.visible),searchable:s,fieldDefinition:t,filterType:o,clickableWithHref:this.isColumnClickableWithHref(e),title:null===(n=e.title)||void 0===n?void 0:n.trim(),fallbackTitle:`[${t.name}]`})})));return(0,o.forkJoin)(s)}getSelectionFieldOptionLabelsByFieldId(e,t){return(0,m.reduce)(e,(e,i)=>{const n=t.fieldDefinitionsById[i.fieldId];return n.resourceType===a.RX_RECORD_DEFINITION.dataTypes.selection.resourceType&&(e[i.fieldId]=n.optionLabelsById),e},{})}getFieldDefinitionResourceTypeShortName(e){return e.split(".").pop().replace(/fieldDefinition/i,"")}isColumnClickableWithHref(e){let t=!1;return this.rxRecordGridConfigUtilsService.getBooleanValue(e.clickable)&&(t=e.actions.every(e=>(e.name===d.RX_VIEW_ACTION.viewActionNames.launchUrl||e.name===d.RX_VIEW_ACTION.viewActionNames.openView&&e.presentation.launchBehavior===d.OpenViewActionLaunchBehavior.SameWindow&&e.presentation.type===d.OpenViewActionType.FullWidth&&this.canViewParamsBeEvaluatedForHref(e.viewParams))&&this.canExpressionBeEvaluatedForHref(e.$condition$))),t}canViewParamsBeEvaluatedForHref(e){return(0,m.every)(e,e=>this.canExpressionBeEvaluatedForHref(e))}canExpressionBeEvaluatedForHref(e){return(0,m.every)(null==e?void 0:e.match(/\$\{[^{]*\}/g),e=>this.allowedOpenViewActionExpressionsForHrefRegex.test(e))}}Yp.\u0275fac=function(e){return new(e||Yp)(n["\u0275\u0275inject"](v.RxGuidService),n["\u0275\u0275inject"](a.RxFieldDefinitionService),n["\u0275\u0275inject"](Lc),n["\u0275\u0275inject"](kc),n["\u0275\u0275inject"](p.TranslateService))},Yp.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Yp,factory:Yp.\u0275fac,providedIn:"root"});class Zp{constructor(e){this.rxRecordInstanceDataPageService=e,this.cache={}}getSharedFilterPresets(e){if(!this.cache[e]){const t=this.getQueryParams(e);return this.rxRecordInstanceDataPageService.post({params:t}).pipe((0,r.map)(t=>this.cache[e]=(0,m.map)(t.data,e=>({id:e[a.RX_RECORD_DEFINITION.coreFieldIds.id],name:e[Nc.sharedFilterPresets.fields.name],filters:[{filterOptionId:Nc.externalPresetFilterOptionId,value:e[a.RX_RECORD_DEFINITION.coreFieldIds.id]}],isCreatedByOtherUsers:!0,filterExpression:e[Nc.sharedFilterPresets.fields.filterExpression],isDefault:e[Nc.sharedFilterPresets.fields.isDefault]}))))}return(0,o.of)(this.cache[e])}getQueryParams(e){const t=`('${Nc.sharedFilterPresets.fields.recordGridGuid}'="${e}")`,i=[a.RX_RECORD_DEFINITION.coreFieldIds.id,Nc.sharedFilterPresets.fields.name,Nc.sharedFilterPresets.fields.filterExpression,Nc.sharedFilterPresets.fields.isDefault].join(","),n=[Nc.sharedFilterPresets.fields.sortOrder,Nc.sharedFilterPresets.fields.name].join(",");return{pageSize:-1,startIndex:0,queryExpression:t,propertySelection:i,shouldIncludeTotalSize:!1,recorddefinition:Nc.sharedFilterPresets.recordDefinitionName,sortBy:n}}}Zp.\u0275fac=function(e){return new(e||Zp)(n["\u0275\u0275inject"](a.RxRecordInstanceDataPageService))},Zp.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Zp,factory:Zp.\u0275fac});class em{constructor(e,t,i,n,o){this.recordGridConfigUtilsService=e,this.rxUserPreferencesService=t,this.rxRecordGridFilterService=i,this.rxRecordGridFilterHelperService=n,this.rxObjectUtilsService=o,this.initialPreferences={columns:[],filterPresets:[],filters:null,visibleCardFieldIds:[],appliedExternalFilterPresetGuid:null,viewPresets:{}},this.preferences=Object.assign({},this.initialPreferences)}saveUserPreferences(e,t,i){t.cardLayoutColumns?this.preferences.visibleCardFieldIds=this.getVisibleCardFieldIds(t):this.preferences.columns=this.getColumnsPreferences(t),this.preferences.filterPresets=i.advancedFiltering.savedFilters.filter(e=>!e.isCreatedByOtherUsers).map(e=>this.getPreferencesFilterPresets(e,i.recordDefinition.fieldDefinitionsById,i.advancedFiltering.recordGridFilterConfigs));const n=this.rxRecordGridFilterService.getRecordGridFilterDataFromAdvancedFilter(i.advancedFiltering.selectedFilters,i.recordDefinition.fieldDefinitionsById,i.advancedFiltering.recordGridFilterConfigs);this.preferences.filters=n;const o=i.advancedFiltering.appliedSharedFilterPreset;if(this.preferences.appliedExternalFilterPresetGuid=o&&o.id,this.selectedViewPresetGuid){const e=this.preferences.viewPresets[this.selectedViewPresetGuid],i={viewPresetGuid:this.selectedViewPresetGuid,columns:this.getColumnsPreferences(t),filters:(0,m.isEmpty)(n)?null:n};(0,m.isEqual)(e.initial,i)?this.discardViewPresetChanges(this.selectedViewPresetGuid):e.edited=i}this.save(e,this.preferences)}get(e){return this.preferences=Object.assign({},this.initialPreferences),this.rxUserPreferencesService.getUiComponentPreferences(e).pipe((0,r.map)(e=>(0,m.assign)(this.preferences,e)))}getAppliedSharedFilterPresetGuid(){return this.preferences.appliedExternalFilterPresetGuid}applyUserPreferencesForColumns(e,t,i){this.reviseColumnPreferences(this.preferences.columns,e)&&this.save(i,this.preferences);let n=this.getColumnSortMeta(this.preferences.columns);this.sortColumnsConfigs(e.columns),this.setColumnsWidths(e.columns,this.preferences.columns,e.columnResizeMode),n=(0,m.filter)(n,t=>(0,m.some)(e.columns,e=>e.field===t.field)),this.preferences.columns.length&&(e.multiSortMeta=n),e.cardLayoutColumns?this.setCardFieldsVisibility(e.columns):this.setColumnsVisibility(e.columns,t)}reviseColumnPreferences(e,{columns:t}){let i=!1;if(e.length){const n=(0,m.map)(t,"field"),o=(0,m.remove)(e,({fieldId:e})=>!n.includes(e));let r=o.some(({sort:e})=>Boolean(e));const a=e.length,s=[];if(t.forEach((t,i)=>{var n;const o=(0,m.find)(e,{fieldId:t.field});o?(null!==(n=o.width)&&void 0!==n||(o.width=t.width),t.sortable?s.push(o):o.sort&&(r=!0)):e.splice(i,0,{fieldId:t.field,index:i,visible:!t.hidden,width:t.width})}),r){const t=this.getColumnSortMeta(s);this.updateColumnSortPreferences(e,t)}i=!(0,m.isEmpty)(o)||a<e.length||r}return i}applyUserPreferences(e,t,i,n){var a,s,l,d;let c;if(i.viewPresetSelector||this.applyUserPreferencesForColumns(e,t,i.guid),null==i?void 0:i.enableFiltering){let o=!1;this.preferences.filterPresets.forEach(e=>{var i,n,r,a;const s=null===(n=null===(i=e.filterData)||void 0===i?void 0:i.and)||void 0===n?void 0:n.length;e.filterData=this.rxRecordGridFilterService.getFilterForAvailableColumns(e.filterData,t.filter(e=>e.filterable)),s!==(null===(a=null===(r=e.filterData)||void 0===r?void 0:r.and)||void 0===a?void 0:a.length)&&(o=!0)}),this.preferences.filterPresets=this.preferences.filterPresets.filter(e=>!(0,m.isEmpty)(e.filterData));const p=(0,m.cloneDeep)(null===(a=this.preferences.filters)||void 0===a?void 0:a.and);this.preferences.filters=this.rxRecordGridFilterService.getFilterForAvailableColumns(this.preferences.filters,t.filter(e=>e.filterable)),!o&&(null===(l=null===(s=this.preferences.filters)||void 0===s?void 0:s.and)||void 0===l?void 0:l.length)===(null==p?void 0:p.length)&&(0,m.isEqual)(p,null===(d=this.preferences.filters)||void 0===d?void 0:d.and)||this.save(i.guid,this.preferences),i.advancedFiltering.savedFilters=this.getAdvancedFilterPresets(this.preferences.filterPresets,!1),i.predefinedFilterPresets=i.predefinedFilterPresets.filter(e=>!(0,m.isNull)(e.filters));const u=i.predefinedFilterPresets.map(e=>{var t;return{title:e.title,guid:e.guid,filterData:this.rxRecordGridFilterHelperService.getRecordGridFilterDataFromPredefinedFilter(e.filters,this.rxRecordGridFilterService.deserializeNamedOptions(null!==(t=e.recordGridFilters)&&void 0!==t?t:[]))}}).filter(e=>e.filterData),f=this.getAdvancedFilterPresets(u,!0);if(i.advancedFiltering.savedFilters.push(...f),n){if(this.getAppliedSharedFilterPresetGuid()){const e=(0,m.find)(n,{id:this.getAppliedSharedFilterPresetGuid()});i.advancedFiltering.appliedSharedFilterPreset=e,i.advancedFiltering.activeSavedFilter=e}i.advancedFiltering.savedFilters.push(...n)}const h=(0,m.isString)(i.defaultFilterPreset)?(0,m.find)(f,e=>e.id===i.defaultFilterPreset):i.defaultFilterPreset,g=(0,m.find)(n,e=>e.isDefault);if((0,m.isEmpty)(this.preferences.filters)){if(this.rxObjectUtilsService.isEmptyObject(this.preferences.filters)&&!i.advancedFiltering.appliedSharedFilterPreset)g&&!h&&(i.advancedFiltering.appliedSharedFilterPreset=g,i.advancedFiltering.activeSavedFilter=g);else if((0,m.isNull)(this.preferences.filters)&&!i.advancedFiltering.appliedSharedFilterPreset)if(h){const t=(0,m.isString)(i.defaultFilterPreset)?h.filterData:h;c=this.rxRecordGridFilterService.getAdvancedFilterData(t,i.recordDefinition.fieldDefinitionsById,i.advancedFiltering.recordGridFilterConfigs,i.recordDefinition,i.advancedFiltering.filterOptions,i.associationDescriptors).pipe((0,r.tap)(t=>{i.advancedFiltering.selectedFilters=this.getFiltersForSelectedColumns(t,e.columns),(0,m.isString)(i.defaultFilterPreset)&&(h.filters=i.advancedFiltering.selectedFilters,i.advancedFiltering.activeSavedFilter=h)}))}else g&&(i.advancedFiltering.appliedSharedFilterPreset=g,i.advancedFiltering.activeSavedFilter=g)}else c=this.rxRecordGridFilterService.getAdvancedFilterData(this.preferences.filters,i.recordDefinition.fieldDefinitionsById,i.advancedFiltering.recordGridFilterConfigs,i.recordDefinition,i.advancedFiltering.filterOptions,i.associationDescriptors).pipe((0,r.tap)(t=>{const n=this.getFilterForAvailableNamedFilterOptions(t,i.namedFilterOptions);i.advancedFiltering.selectedFilters=this.getFiltersForSelectedColumns(n,e.columns.filter(e=>e.filterable)),this.preferences.filters=this.rxRecordGridFilterService.getRecordGridFilterDataFromAdvancedFilter(i.advancedFiltering.selectedFilters,i.recordDefinition.fieldDefinitionsById,i.advancedFiltering.recordGridFilterConfigs),i.advancedFiltering.appliedSharedFilterPreset&&this.addExternalPresetToSelectedFilters(i)}));i.advancedFiltering.appliedSharedFilterPreset&&this.addExternalPresetToSelectedFilters(i)}return c||(0,o.of)(null)}applySharedViewPreset(e,t,i,n){return this.preferences.viewPresets[i]?this.preferences.viewPresets[i].initial=Object.assign(Object.assign({},n),{viewPresetGuid:i}):this.preferences.viewPresets[i]={initial:Object.assign(Object.assign({},n),{viewPresetGuid:i})},this.applyViewPresetInner(i,t,e)}applyViewPreset(e,t,i){const n=e.viewPresets.find(e=>e.viewPresetGuid===i);if(n&&!(0,m.has)(this.preferences.viewPresets,[i,"edited"])){const t=this.createSystemViewPresetPreferences(n,e.columnsWithMetadata);this.preferences.viewPresets[i]={initial:t}}else if(!this.preferences.viewPresets[i]&&this.selectedViewPresetGuid){const e=this.preferences.viewPresets[this.selectedViewPresetGuid];this.preferences.viewPresets[i]={initial:Object.assign(Object.assign({},(0,m.cloneDeep)(e.edited||e.initial)),{viewPresetGuid:i})}}return this.applyViewPresetInner(i,t,e)}applyViewPresetInner(e,t,i){const n=this.preferences.viewPresets[e],a=(null==n?void 0:n.edited)||(null==n?void 0:n.initial);let s=(0,o.of)(null);return a&&(this.selectedViewPresetGuid=a.viewPresetGuid,this.updateColumnsOrder(t.columns,a.columns),this.updateColumnsVisibility(t.columns,a.columns),this.setColumnsWidths(t.columns,a.columns,t.columnResizeMode),this.updateGridSorting(a,t),s=this.rxRecordGridFilterService.getAdvancedFilterData(a.filters,i.recordDefinition.fieldDefinitionsById,i.advancedFiltering.recordGridFilterConfigs,i.recordDefinition,i.advancedFiltering.filterOptions,i.associationDescriptors).pipe((0,r.tap)(e=>{const n=this.getFilterForAvailableNamedFilterOptions(e,i.namedFilterOptions);i.advancedFiltering.selectedFilters=this.getFiltersForSelectedColumns(n,t.columns.filter(e=>e.filterable))}))),s}isCurrentViewPresetEdited(){var e;return Boolean(null===(e=this.preferences.viewPresets[this.selectedViewPresetGuid])||void 0===e?void 0:e.edited)}addExternalPresetToSelectedFilters(e){const t=(0,m.cloneDeep)(e.advancedFiltering.selectedFilters);t.push({filterOptionId:Nc.externalPresetFilterOptionId,value:e.advancedFiltering.appliedSharedFilterPreset.id}),e.advancedFiltering.selectedFilters=t}createSystemViewPresetPreferences(e,t){const i=this.rxRecordGridFilterHelperService.getRecordGridFilterDataFromPredefinedFilter(e.filters,e.recordGridFilters?this.rxRecordGridFilterService.deserializeNamedOptions(e.recordGridFilters):[]),n=e.columnViewPresets.sort((e,t)=>e.index-t.index).map((e,i)=>{var n,o;const r=(0,m.has)(e,"width")?e.width:null!==(o=null===(n=(0,m.find)(t,{fieldId:e.fieldId}))||void 0===n?void 0:n.width)&&void 0!==o?o:null,a=Object.assign(Object.assign({},(0,m.omit)(e,"sortable")),{index:i,width:r});return e.sortable&&(a.sort={priority:0,direction:e.sortable.direction}),a});return(0,m.cloneDeep)({columns:n,filters:i,viewPresetGuid:e.viewPresetGuid})}deleteViewPreset(e){delete this.preferences.viewPresets[e]}isExistingViewPreset(e){return(0,m.has)(this.preferences.viewPresets,e)}discardViewPresetChanges(e){var t;null===(t=this.preferences.viewPresets[e])||void 0===t||delete t.edited}updateGridSorting(e,t){let i=this.getColumnSortMeta(e.columns);i=(0,m.filter)(i,e=>(0,m.some)(t.columns,t=>t.sortable&&t.field===e.field)),t.multiSortMeta=i}getAdvancedFilterPresets(e,t){return e.map(e=>{const i={id:e.guid,name:e.title,filters:null,filterData:e.filterData,isCreatedByOtherUsers:t};return e.appliedSharedFilterPresetGuid&&(i.appliedSharedFilterPresetGuid=e.appliedSharedFilterPresetGuid,i.filters=[{filterOptionId:Nc.externalPresetFilterOptionId,value:e.appliedSharedFilterPresetGuid}]),i}).sort((e,t)=>e.name.localeCompare(t.name))}getColumnsPreferences({columns:e,multiSortMeta:t}){const i=e.map(({field:e,hidden:t,width:i},n)=>({fieldId:e,index:n,visible:!t,width:i}));return this.updateColumnSortPreferences(i,t),i}getPreferencesFilterPresets(e,t,i){const n={guid:e.id,title:e.name,filterData:e.filters?this.rxRecordGridFilterService.getRecordGridFilterDataFromAdvancedFilter(e.filters,t,i):e.filterData};return e.appliedSharedFilterPresetGuid&&(n.appliedSharedFilterPresetGuid=e.appliedSharedFilterPresetGuid),n}getVisibleCardFieldIds({columns:e,multiSortMeta:t}){return this.updateColumnSortPreferences(this.preferences.columns,t),e.filter(e=>!e.hidden).map(e=>parseInt(e.field,10)||e.field)}updateColumnSortPreferences(e,t){t&&(e.forEach(e=>{delete e.sort}),t.forEach(({field:t,order:i},n)=>{const o=e.find(e=>e.fieldId===t);o&&(o.sort={priority:n,direction:this.recordGridConfigUtilsService.getColumnSortDirection(i)})}))}save(e,t){if(e){const i={preferences:JSON.stringify(t),componentTypeName:Nc.type,version:Nc.version,componentId:e};this.rxUserPreferencesService.setUiComponentPreferences(i,e).subscribe()}}sortColumnsConfigs(e){this.updateColumnsOrder(e,this.preferences.columns)}updateColumnsOrder(e,t){const i=(0,m.reduce)(e,(e,i,n)=>{const o=(0,m.find)(t,e=>e.fieldId===i.field);return e[i.field]=o?o.index:n,e},{});e.sort((e,t)=>i[e.field]-i[t.field])}setColumnsVisibility(e,t){const i=this.preferences.columns;(0,m.isEmpty)(i)?e.forEach(e=>{const i=(0,m.find)(t,t=>t.fieldId===e.field);e.hidden=!!i&&!i.visible}):this.updateColumnsVisibility(e,i)}updateColumnsVisibility(e,t){e.forEach(e=>{const i=(0,m.find)(t,t=>t.fieldId===e.field);i&&(e.hidden=!i.visible)})}setColumnsWidths(e,t,i){t.length&&e.forEach(e=>{const n=(0,m.find)(t,{fieldId:e.field});if(n){const t=(0,m.endsWith)(n.width,"px");i!==A.ResizeMode.Expand||t?(e.width=/[0-9]+$/.test(n.width)?`${n.width}%`:n.width,t&&parseInt(e.width)<45&&(e.minWidth=e.width)):(e.width=null,e.minWidth=null)}})}setCardFieldsVisibility(e){const t=this.preferences.visibleCardFieldIds;if((0,m.isEmpty)(t)){const t=5;let i=0;e.forEach(e=>{i>=t?e.hidden=!0:e.hidden||i++})}else e.forEach(e=>e.hidden=!(0,m.some)(t,t=>String(t)===e.field))}getColumnSortMeta(e){return(0,m.flow)(e=>(0,m.filter)(e,"sort"),e=>(0,m.sortBy)(e,"sort.priority"),e=>(0,m.map)(e,e=>({field:e.fieldId,order:this.recordGridConfigUtilsService.getColumnSortOrder(e.sort.direction)})))(e)}getFiltersForSelectedColumns(e,t){return e.filter(e=>(0,m.some)(t,{field:e.filterOptionId}))}getFilterForAvailableNamedFilterOptions(e,t){return e.map(e=>(e.value.namedOptions=(0,m.isEmpty)(t)?[]:e.value.namedOptions.filter(i=>(0,m.some)(t[Number(e.filterOptionId)],{guid:i})),e)).filter(e=>!rp.isEmptyWithRange(e.value))}saveViewPreset(e){const t=this.preferences.viewPresets[e];(null==t?void 0:t.edited)&&(t.initial=(0,m.cloneDeep)(t.edited),delete t.edited)}getSharedViewPresetData(){const e=this.preferences.viewPresets[this.selectedViewPresetGuid],t=e.edited||e.initial;return{columns:t.columns,filters:t.filters}}}em.\u0275fac=function(e){return new(e||em)(n["\u0275\u0275inject"](Lc),n["\u0275\u0275inject"](s.RxUserPreferencesService),n["\u0275\u0275inject"](lp),n["\u0275\u0275inject"](sp),n["\u0275\u0275inject"](v.RxObjectUtilsService))},em.\u0275prov=n["\u0275\u0275defineInjectable"]({token:em,factory:em.\u0275fac}),function(e){e.Multiple="multiple",e.Single="single"}(op||(op={}));class tm{constructor(e,t){this.modalService=e,this.translateService=t,this.sort=new n.EventEmitter}onSortMenuItemClick(){this.multiSortMeta=this.adaptTable.multiSortMeta||[],this.openDialog({title:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.cards.sort-by.dialog.title"),content:this.cardLayoutSortModalTemplate}).catch(()=>{})}getSortableColumns(){return this.columns.filter(e=>this.adaptTable.isSortableColumn(e)).sort((e,t)=>e.header.localeCompare(t.header))}onSortAscClick(e){this.changeSort(e,A.SortOrder.Asc)}onSortDescClick(e){this.changeSort(e,A.SortOrder.Desc)}changeSort(e,t){const i=this.getColumnSortIndex(e),n=this.multiSortMeta[i];n?n.order===t?this.multiSortMeta.splice(i,1):n.order=t:this.multiSortMeta.push({field:e.field,order:t})}getColumnSort(e){return this.multiSortMeta[this.getColumnSortIndex(e)]}getColumnSortIndex(e){return this.multiSortMeta.findIndex(t=>t.field===e.field)}hasColumnSortOrder(e,t){const i=this.getColumnSort(e);return!!i&&i.order===t}getSortAscBtnClass(e){return this.getSortBtnClass(e,A.SortOrder.Asc)}getSortDescBtnClass(e){return this.getSortBtnClass(e,A.SortOrder.Desc)}getSortBtnClass(e,t){const i=this.hasColumnSortOrder(e,t);return{"btn-success":i,"btn-secondary":!i}}clearAllSorting(){this.multiSortMeta=[]}applySorting(){this.sort.emit(this.multiSortMeta)}getCurrentSortingSummary(){const e={[A.SortOrder.Asc]:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.cards.sort-by.sort.ascending"),[A.SortOrder.Desc]:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.cards.sort-by.sort.descending")};return this.multiSortMeta.map((t,i)=>`${i+1}. ${this.columns.find(e=>e.field===t.field).header} (${e[t.order]})`).join("\n")}}tm.\u0275fac=function(e){return new(e||tm)(n["\u0275\u0275directiveInject"](u.AdaptModalService),n["\u0275\u0275directiveInject"](p.TranslateService))},tm.\u0275cmp=n["\u0275\u0275defineComponent"]({type:tm,selectors:[["rx-card-layout-cell-header"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](wr,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.cardLayoutSortModalTemplate=e.first)}},inputs:{title:"title",columns:"columns",adaptTable:"adaptTable",openDialog:"openDialog"},outputs:{sort:"sort"},decls:9,vars:7,consts:[["adaptDropdown","",1,"dropdown","header-cell-menu-btn",3,"appendToBody","restoreFocusAfterClose"],["id","card-column-menu-dropdown-toggle","type","button","adaptDropdownToggle","",1,"d-icon-ellipsis","adapt-table-sort-menu__kebab","py-2","btn","btn-link",3,"showCaret"],["aria-labelledby","card-column-menu-dropdown-toggle","adaptDropdownMenu","","tabindex","0",1,"dropdown-menu"],["type","button",1,"dropdown-item",3,"click"],["cardLayoutSortModalTemplate",""],[1,"modal-body","rx-record-grid-sort-by-dialog"],[1,"rx-card-fields"],[1,"rx-card-fields__headers"],[1,"rx-card-fields__headers-field"],[1,"rx-card-fields__headers-order"],["class","rx-card-field",4,"ngFor","ngForOf"],["rows","4","disabled","","title","summary",1,"form-control","rx-sort-summary",3,"value","placeholder"],[1,"modal-footer"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"rx-card-field"],[1,"rx-card-field__name"],[1,"rx-card-field__order"],[1,"btn-group"],[1,"btn","btn-xs",3,"ngClass","click"],[1,"d-icon-arrow_down"],[1,"d-icon-arrow_up"]],template:function(e,t){1&e&&(n["\u0275\u0275text"](0),n["\u0275\u0275elementStart"](1,"div",0),n["\u0275\u0275element"](2,"button",1),n["\u0275\u0275elementStart"](3,"div",2),n["\u0275\u0275elementStart"](4,"button",3),n["\u0275\u0275listener"]("click",function(){return t.onSortMenuItemClick()}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](7,Rr,23,20,"ng-template",null,4,n["\u0275\u0275templateRefExtractor"])),2&e&&(n["\u0275\u0275textInterpolate1"]("",t.title," "),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("appendToBody",!0)("restoreFocusAfterClose",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("showCaret",!1),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,5,"com.bmc.arsys.rx.client.view-components.record-grid.card-column-menu.items.sort-by.label")," "))},directives:[u.AdaptDropdownDirective,u.AdaptDropdownToggleDirective,u.AdaptDropdownMenuDirective,f.NgForOf,f.NgClass],pipes:[p.TranslatePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.header-cell-menu-btn[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.rx-record-grid-sort-by-dialog[_ngcontent-%COMP%]   .rx-card-fields[_ngcontent-%COMP%]{border:1px solid #d6d7d8;display:flex;flex-direction:column;height:370px;overflow-y:auto}.rx-record-grid-sort-by-dialog[_ngcontent-%COMP%]   .rx-card-fields__headers[_ngcontent-%COMP%]{font-weight:var(--font-weight-bold);display:flex;height:35px;align-items:center;border-bottom:1px solid #d6d7d8;color:#666;flex-shrink:0}.rx-record-grid-sort-by-dialog[_ngcontent-%COMP%]   .rx-card-field[_ngcontent-%COMP%]{display:flex;border-bottom:1px solid #d6d7d8;align-items:center;height:35px;flex-shrink:0}.rx-record-grid-sort-by-dialog[_ngcontent-%COMP%]   .rx-card-field[_ngcontent-%COMP%]:last-child{border-bottom:none}.rx-record-grid-sort-by-dialog[_ngcontent-%COMP%]   .rx-card-field__name[_ngcontent-%COMP%]{flex:3;padding-left:10px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.rx-record-grid-sort-by-dialog[_ngcontent-%COMP%]   .rx-card-field__order[_ngcontent-%COMP%]{flex:1;padding-left:5px}.rx-record-grid-sort-by-dialog[_ngcontent-%COMP%]   .rx-card-fields__headers-field[_ngcontent-%COMP%]{flex:3;padding-left:10px}.rx-record-grid-sort-by-dialog[_ngcontent-%COMP%]   .rx-card-fields__headers-order[_ngcontent-%COMP%]{flex:1;padding-left:5px}.rx-record-grid-sort-by-dialog[_ngcontent-%COMP%]   .rx-sort-summary[_ngcontent-%COMP%]{margin-top:15px;resize:none}']});class im{constructor(e,t,i){this.adaptTable=e,this.ngZone=t,this.renderer=i,this.changedCardLayout=new n.EventEmitter,this.hasCardLayout=!1,this._hasViewInitialized=!1}set cardLayoutWidth(e){if(this._cardLayoutWidth=e,this._hasViewInitialized){const{offsetWidth:e}=this.renderer.selectRootElement(this.adaptTable.el.nativeElement,!0);this.changeTableCardLayout(e)}}get cardLayoutWidth(){return this._cardLayoutWidth}ngAfterViewInit(){setTimeout(()=>{const e=this.renderer.selectRootElement(this.recordGridElementRef.nativeElement,!0);this.changeTableCardLayout(e.offsetWidth)}),this.ngZone.runOutsideAngular(()=>{this.resizeSensor=new g.ResizeSensor(this.recordGridElementRef.nativeElement,e=>{this.ngZone.run(()=>{this.changeTableCardLayout(e.width)})})}),this._hasViewInitialized=!0}changeTableCardLayout(e){const t=e<=this.cardLayoutWidth;if(this.hasCardLayout===t||!e)return;this.hasCardLayout=t;const i=this.adaptTable;this.scrollToFirstVisibleRow(),t?this.renderer.addClass(i.el.nativeElement,"rx-table-card-layout"):this.renderer.removeClass(i.el.nativeElement,"rx-table-card-layout"),i.tableService.onValueChange(i.value),this.changedCardLayout.emit({cardLayoutColumns:t?this.getCardLayoutColumns():null})}getCardLayoutColumns(){return[{field:"fields",header:"Fields",filterable:!1,sortable:!1,headerTitleTemplate:this.cardLayoutFieldsHeaderTemplate,width:"35%",dataCellClass:this.getDataCellClass.bind(this),cellTemplate:this.cardLayoutFieldsDataCellTemplate,testId:"fields-column"},{field:"fields",header:"Values",filterable:!1,sortable:!1,headerTitleTemplate:this.cardLayoutValuesHeaderTemplate,width:"65%",dataCellClass:this.getDataCellClass.bind(this),cellTemplate:this.cardLayoutValuesDataCellTemplate,testId:"values-column"}]}getDataCellClass(){return`${this.recordGridGetDataCellClass()} rx-card-layout-data-cell`}scrollToFirstVisibleRow(){const e=this.adaptTable;if(e.scrollable){const t=this.renderer.selectRootElement(e.el.nativeElement,!0).querySelector(".ui-table-scrollable-body"),i=t&&t.scrollTop;if(i){const n=e.dataRows.find(e=>{const t=e.element.nativeElement;return t.offsetTop+t.offsetHeight>=i});if(n){let e=n.element.nativeElement;const o=(i-e.offsetTop)/e.offsetHeight;this.ngZone.onStable.pipe((0,r.take)(1)).subscribe(()=>{e=n.element.nativeElement,t.scrollTop=e.offsetTop+e.offsetHeight*o})}}}}ngOnDestroy(){this.resizeSensor.detach()}}im.\u0275fac=function(e){return new(e||im)(n["\u0275\u0275directiveInject"](A.AdaptTableComponent,1),n["\u0275\u0275directiveInject"](n.NgZone),n["\u0275\u0275directiveInject"](n.Renderer2))},im.\u0275dir=n["\u0275\u0275defineDirective"]({type:im,selectors:[["","rxCardLayout",""]],inputs:{cardLayoutFieldsHeaderTemplate:"cardLayoutFieldsHeaderTemplate",cardLayoutValuesHeaderTemplate:"cardLayoutValuesHeaderTemplate",cardLayoutFieldsDataCellTemplate:"cardLayoutFieldsDataCellTemplate",cardLayoutValuesDataCellTemplate:"cardLayoutValuesDataCellTemplate",recordGridGetDataCellClass:["cardLayoutGetDataCellClass","recordGridGetDataCellClass"],recordGridElementRef:["cardLayoutRecordGridElementRef","recordGridElementRef"],cardLayoutWidth:"cardLayoutWidth"},outputs:{changedCardLayout:"changedCardLayout"}});class nm{constructor(e,t){this.rxExpressionEvaluatorService=e,this.rxObjectUtilsService=t,this.evaluationData={}}ngOnInit(){this.updateCellClasses()}ngOnChanges(e){e.rxCellDisplayPropsDataItem.firstChange||e.rxCellDisplayPropsDataItem.currentValue===e.rxCellDisplayPropsDataItem.previousValue||this.updateCellClasses()}getActiveProps(e){return e.find(e=>this.rxExpressionEvaluatorService.tryEvaluate(e.fieldValueCondition,this.evaluationData))||null}getCellCssClasses(e){const t=[];return e.displayAsBadge||(e.bold&&t.push("font-weight-bold"),e.italic&&t.push("font-italic"),e.fontSize===_c.Small?t.push("small"):e.fontSize===_c.Large&&t.push("large"),e.textColor&&t.push(qc[e.textColor]),e.backgroundColor&&t.push(Uc[e.backgroundColor]),e.icon&&(e.iconPosition===$c.ReplaceText?t.push(`d-icon-${e.icon}`):t.push(`d-icon-${e.iconPosition}-${e.icon}`))),t}getSpanCssClasses(e){return e.displayAsBadge?["badge",`badge-${e.badgeColor}`]:e.iconPosition===$c.ReplaceText?["hidden"]:[]}updateCellClasses(){var e;if(null===(e=this.rxCellDisplayProps)||void 0===e?void 0:e.length){let e="";const t=Object.assign(Object.assign({},this.rxCellDisplayPropsDataItem),this.rxObjectUtilsService.expandProperties(this.rxCellDisplayPropsDataItem));(0,m.set)(this.evaluationData,"view.components.grid.clickableRow",t);const i=this.getActiveProps(this.rxCellDisplayProps);if(i){e=this.getCellCssClasses(i).join(" ")}if(this.rxCellDisplayPropsBadgeElem){const e=i?this.getSpanCssClasses(i):[];this.rxCellDisplayPropsBadgeElem.classList.value="",this.rxCellDisplayPropsBadgeElem.classList.add(...e)}this.cssClasses=e}}}nm.\u0275fac=function(e){return new(e||nm)(n["\u0275\u0275directiveInject"](d.RxExpressionEvaluatorService),n["\u0275\u0275directiveInject"](v.RxObjectUtilsService))},nm.\u0275dir=n["\u0275\u0275defineDirective"]({type:nm,selectors:[["","rxCellDisplayProps",""]],hostVars:2,hostBindings:function(e,t){2&e&&n["\u0275\u0275classMap"](t.cssClasses)},inputs:{rxCellDisplayProps:"rxCellDisplayProps",rxCellDisplayPropsBadgeElem:"rxCellDisplayPropsBadgeElem",rxCellDisplayPropsDataItem:"rxCellDisplayPropsDataItem"},features:[n["\u0275\u0275NgOnChangesFeature"]]});class om extends h.BaseViewComponent{constructor(e,t,i,r,a,s,l,d,c,p,u,f,h,g,v,y,x,b,C,S,w,D,R,I,F,E,M,O,P,T,V,N,k,j,_,B){super(),this.adaptDeviceDetectionService=e,this.adaptModalService=t,this.changeDetector=i,this.datePipe=r,this.decimalPipe=a,this.ngZone=s,this.rxAssociationInstanceDataPageService=l,this.rxBooleanPipe=d,this.rxCurrentUserService=c,this.rxExpressionEvaluatorService=p,this.rxFieldDefinitionService=u,this.rxGridConfiguratorService=f,this.rxGuidService=h,this.rxLogService=g,this.rxNotificationService=v,this.rxObjectUtilsService=y,this.rxRecordDefinitionCacheService=x,this.rxRecordDefinitionService=b,this.rxRecordGridAdvancedFilteringService=C,this.rxRecordGridConfigUtilsService=S,this.rxRecordGridFilterConfigService=w,this.rxRecordGridFilterService=D,this.rxRecordGridFilterHelperService=R,this.rxRecordGridSharedFilterPresetsCacheService=I,this.rxRecordGridUserPreferencesService=F,this.rxRecordGridUtilsService=E,this.rxRecordInstanceDataPageService=M,this.rxRecordInstanceService=O,this.rxViewActionService=P,this.rxViewActionUtilsService=T,this.translateService=V,this.elementRef=N,this.rxStringService=k,this.rxGlobalEventsService=j,this.pageComponent=_,this.runtimeViewCanvasItemComponent=B,this.dataLoaded=new n.EventEmitter,this.isExportInProgress=!1,this.lastPropertySelection=[],this.adaptTableConfig={data:[],columns:[],columnResizeMode:A.ResizeMode.Fit,cardLayoutColumns:null,bordered:!0,scrollable:!0,striped:!1,toolbarConfig:{counter:!1,quickFilter:!0,leftCustomSection:!0,leftCustomSectionTemplate:null,filter:!0,filterTemplate:null,filterResults:!1,filterResultsTemplate:null,rightCustomSection:!1,rightCustomSectionTemplate:null,visibleColumnsMenu:!0,visibleColumnsMenuTemplate:null,quickFilterTriggerable:!0,export:{exportTypes:[{type:A.ExportType.CSV}],showExportForSelected:!0}},filterable:!1,selectedItems:[],filters:{},rows:50,first:0,multiSortMeta:null,rowSelectionMode:null,isLoadingData:!1,totalRecords:null,primaryKey:null,isLoadingMoreData:!1,texts:null,expandedGroupsKeys:{},virtualScroll:!0,virtualRowHeight:Nc.defaultRowHeight},this.actionButtons=null,this.adaptTableHeaderSelectionMode=A.AdaptTableHeaderSelectionMode.Chunk,this.api={applyViewPreset:this.applyViewPreset.bind(this),shareViewPreset:this.shareViewPreset.bind(this),refresh:this.refresh.bind(this),setFilter:this.setFilter.bind(this),deleteViewPreset:this.deleteViewPreset.bind(this),discardViewPresetChanges:this.discardViewPresetChanges.bind(this),getColumns:this.getColumns.bind(this),getRecordDefinitionName:this.getRecordDefinitionName.bind(this),getSelectedRows:this.getSelectedRows.bind(this),getFirstSelectedRow:this.getFirstSelectedRow.bind(this),getSelectedRowCount:this.getSelectedRowCount.bind(this),setSelectedRows:this.onRowsSelectionChange.bind(this),getVisibleRows:this.getVisibleRows.bind(this),saveViewPreset:this.saveViewPreset.bind(this),applyFilters:this.applyFilters.bind(this)},this.filteredVisibleColumns=[],this.getDataCellClassBind=this.getDataCellClass.bind(this),this.gridEvents={cellClick:(e,t)=>{const i=this.state.columnsWithMetadata.find(e=>e.fieldId===t);this.addSelectionFieldOptionNames(e),e=this.expandRowProperties(e),this.state.lastActionRow=e,this.notifyPropertyChanged("clickableRow",e,null),this.executeViewActions(i.guid,(0,m.get)(i,"actions"),e).catch(m.noop)},cellKeyDown:(e,t,i)=>{(0,m.includes)(["Space","Enter"],e.code)&&(this.gridEvents.cellClick(t,i),e.preventDefault())}},this.isFilterBySelectionButtonVisible=!1,this.isUserAllowedToDeleteRecords=!1,this.openSortByDialog=this.openSortByDialogFn.bind(this),this.rowActionButtons=null,this.rowSelectionChanged=new o.BehaviorSubject([]),this.selectedFilteredRowsCount=0,this.shouldDisplayActionButtons=!1,this.showCellTooltip=!1,this.sortedColumnsByTitle=[],this.state={actionButtons:[],rowActionButtons:[],lastActionRow:null,associatedRecordId:null,associatedRoleName:null,associatedRecordNodeSide:null,associationDefinitionName:null,bordered:!0,cardLayoutWidth:null,columns:[],columnsWithMetadata:[],defaultFilterPreset:null,enableFiltering:!1,requiredFilters:0,getDataForHiddenColumns:!0,enableFilterPresets:!0,enableRowSelection:op.Multiple,expandable:!1,filterExpression:null,filters:null,filterTagsLimit:null,getData:null,recordDefinition:null,associationDescriptors:[],recordDefinitionName:null,recordGridFilters:[],recordIdField:null,showDataForAllLocales:null,striped:!1,styles:null,initialFilters:null,expandGroups:!1,advancedFiltering:{activeSavedFilter:null,savedFilters:[],filterOptions:[],selectedFilters:[],recordGridFilterConfigs:null,filterTexts:null,hasLoadedSharedFilterPresets:!1,isLoading:!1,appliedSharedFilterPreset:null,toolbarTags:[],pendingSelectedFilters:[],selectedCardValues:{}},emptyStateLabelText:this.translateService.instant("com.bmc.arsys.rx.client.empty-state.no-items-to-display.label"),emptyStateWithFilterLabelText:this.translateService.instant("com.bmc.arsys.rx.client.empty-state.no-items-to-display.label"),searchFieldPlaceholderText:this.translateService.instant("com.bmc.arsys.rx.client.common.search.label"),enableColumnSelection:!0,namedFilterOptions:null,predefinedFilterPresets:[],viewPresetSelector:null,virtualScroll:!0},this.visibleColumns=[],this.cellValueFormatters={},this.clickableWithHrefColumnActions={},this.dataLoadContextSubject=new o.Subject,this.popovers=[],this.userPreferencesChanged$=new o.Subject,this.exportSelectedRowText=this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.export-selected-row.label"),this.exportSelectedRowsText=this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.export-selected-rows.label"),this.pendingFiltersToApply=null,this.getNamedFilterOptions=this.getNamedFilterOptions.bind(this),this.rxRecordDefinitionCacheService.registerConsumer(this.destroyed$)}onClickOutside(e){!(e.target.closest(".ui-table-tbody")||e.target.closest(".popover.table-filtering")||e.target.closest(".rx-filter-by-card-selection-dialog")||e.target.closest(".rx-filter-by-card-selection-field-dropdown"))&&this.clearSelectedCells()}get isTotalRecordCountKnown(){return!(0,m.isNull)(this.adaptTableConfig.totalRecords)}ngOnInit(){super.ngOnInit(),this.isProgrammaticUse=Boolean(this.pageComponent)||!this.runtimeViewCanvasItemComponent,this.isProgrammaticUse&&(this.adaptTableConfig.toolbarConfig.export=null),this.notifyPropertyChanged("api",this.api),this.initializationCompleted$=this.config.pipe((0,r.take)(1),(0,r.map)(e=>this.rxGridConfiguratorService.getGridConfig(e)),(0,r.tap)(e=>{Object.assign(this.state,e)}),(0,r.switchMap)(()=>{this.state.guid&&(this.guid=this.state.guid);const e=[this.initRecordDefinitions()];return this.guid&&(this.userPreferencesChanged$.pipe((0,r.debounceTime)(1e3),(0,r.takeUntil)(this.destroyed$)).subscribe(()=>{this.rxRecordGridUserPreferencesService.saveUserPreferences(this.guid,this.adaptTableConfig,this.state),this.checkIfViewPresetEdited()}),e.push(this.rxRecordGridUserPreferencesService.get(this.guid))),(0,o.forkJoin)(e)}),(0,r.switchMap)(()=>this.initGrid()),(0,r.shareReplay)(1)),this.initializationCompleted$.subscribe();const e=(0,o.combineLatest)([this.initializationCompleted$,this.dataLoaded,this.config.pipe((0,r.skip)(1),(0,r.debounceTime)(250),(0,r.map)(e=>this.rxGridConfiguratorService.getGridConfig(e)),(0,r.takeUntil)(this.destroyed$))]).pipe((0,r.map)(([e,t,i])=>i));e.pipe((0,r.map)(e=>(0,m.differenceBy)(e.columns,this.state.columns,"additionalQueryCriteria")),(0,r.filter)(e=>e.length>0),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{e.forEach(e=>{this.state.advancedFiltering.filterOptions.find(t=>t.id===e.fieldId).data.additionalQueryCriteria=e.additionalQueryCriteria;const t=this.state.columns.findIndex(t=>t.fieldId===e.fieldId);this.state.columns[t].additionalQueryCriteria=e.additionalQueryCriteria})});const t=new Map;e.pipe((0,r.debounceTime)(10),(0,r.map)(e=>this.getNamedFilterOptionsState(e.columns)),(0,r.withLatestFrom)(this.dataLoadContextSubject),(0,r.filter)(([e,t])=>!(0,m.isEqual)(e,t.namedFilterOptions)),(0,r.tap)(([e])=>{this.state.namedFilterOptions=e}),(0,r.map)(([e])=>Object.values(e).reduce((e,t)=>e.concat(t),[])),(0,r.map)(e=>{const i=this.state.advancedFiltering.selectedFilters.reduce((e,t)=>e.concat(t.value.namedOptions),[]);return e.some(e=>{const n=Boolean(t.get(e.guid));n||t.set(e.guid,e);const o=e.filterExpression!==t.get(e.guid).filterExpression,r=i.includes(e.guid)&&(o||!n);return o&&t.set(e.guid,e),r})}),(0,r.filter)(e=>e),(0,r.takeUntil)(this.destroyed$)).subscribe(()=>{this.loadRowData()}),e.pipe((0,r.debounceTime)(10),(0,r.withLatestFrom)(this.dataLoadContextSubject),(0,r.filter)(([e,t])=>e.associatedRecordId!==t.associatedRecordId||e.associatedRoleName!==t.associatedRoleName||e.filterExpression!==t.filterExpression),(0,r.tap)(([e])=>{Object.assign(this.state,e)})).subscribe(()=>{this.loadRowData()}),this.config.pipe((0,r.map)(e=>e.viewPresetSelector),(0,r.distinctUntilChanged)(),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.state.viewPresetSelector=e}),this.isProgrammaticUse&&(e.pipe((0,r.map)(e=>({actionButtons:e.actionButtons,rowActionButtons:e.rowActionButtons})),(0,r.distinctUntilChanged)(m.isEqual)).subscribe(({actionButtons:e,rowActionButtons:t})=>{this.state.actionButtons=e,this.actionButtons=this.getProgrammaticActionButtons(this.state.actionButtons),this.state.rowActionButtons=t,this.rowActionButtons=this.getProgrammaticActionButtons(this.state.rowActionButtons)}),e.pipe((0,r.distinctUntilChanged)(m.isEqual),(0,r.map)(e=>this.rxGridConfiguratorService.getGridConfig(e)),(0,r.tap)(e=>{Object.assign(this.state,e),this.state.advancedFiltering.selectedFilters=[],this.adaptTableConfig.multiSortMeta=[]}),(0,r.switchMap)(()=>{this.state.guid&&(this.guid=this.state.guid);const e=[this.initRecordDefinitions()];return this.guid&&e.push(this.rxRecordGridUserPreferencesService.get(this.guid)),(0,o.forkJoin)(e)}),(0,r.switchMap)(()=>this.initGrid())).subscribe()),this.adaptTableConfig.virtualScroll=this.state.virtualScroll;const i=this.adaptTableConfig.toolbarConfig;i.visibleColumnsMenu=this.state.enableColumnSelection,i.visibleColumnsMenuTemplate=this.visibleColumnsMenuTemplate,i.rightCustomSectionTemplate=this.rightCustomSectionTemplate,i.leftCustomSectionTemplate=this.leftCustomSectionTemplate,i.filterTemplate=this.filterTemplate,this.notifyPropertyChanged("totalRowCount",0),this.notifyPropertyChanged("selectedRows",[]),this.notifyPropertyChanged("selectedRowCount",0),this.notifyPropertyChanged("fieldValuesByFieldId",{}),this.notifyPropertyChanged("firstSelectedRow",null),this.notifyPropertyChanged("queryExpression",""),this.notifyPropertyChanged("lastRefreshTime",""),this.initAdvancedFilterTexts(),this.initCustomTexts(),this.rxGlobalEventsService.viewActionsCompleted$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(()=>{(0,m.isEmpty)(this.pendingFiltersToApply)||this.onAdvancedFiltersChange(this.pendingFiltersToApply),this.pendingFiltersToApply=null})}ngAfterViewInit(){this.actionButtonComponents.changes.pipe((0,r.switchMap)(e=>(0,o.merge)(...e.map(e=>(0,o.of)({guid:e.guid,propertyName:"api",newValue:e.api,oldValue:null})),...e.map(e=>e.propertyChanged.asObservable())))).subscribe(e=>this.propertyChanged.emit(e))}ngOnDestroy(){super.ngOnDestroy(),this.dataLoadContextSubject.complete(),this.userPreferencesChanged$.complete()}applyFilterBySelection(){(0,m.isEmpty)(this.state.advancedFiltering.selectedCardValues)?this.applyPendingSelectedFilters():(this.cardLayoutOpenedModal=this.adaptModalService.open({title:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.filter-by-selection.title"),content:Kp,data:{filterableFields:this.visibleColumns.filter(e=>{if(e.filterable){const t=this.state.recordDefinition.fieldDefinitionsById[e.field];return!(t.resourceType===a.RX_RECORD_DEFINITION.dataTypes.boolean.resourceType&&this.rxFieldDefinitionService.isRequiredField(t))}return!1}).map(e=>({id:e.field,name:e.header||e.fallbackTitle}))},customClass:"rx-filter-by-card-selection-dialog"}),this.cardLayoutOpenedModal.then(e=>{this.state.advancedFiltering.pendingSelectedFilters=[{filterOptionId:e,value:this.state.advancedFiltering.selectedCardValues[e]}],this.applyPendingSelectedFilters()}).catch(m.noop))}buildQueryByAdvancedFilters(e){const t=e.map(e=>{var t;let i=null;const n=e.filterOptionId,o=this.state.recordDefinition.fieldDefinitionsById[n];if(o){i=this.state.advancedFiltering.recordGridFilterConfigs[o.resourceType].getQueryFilter(e,o,n,null!==(t=this.state.namedFilterOptions[n])&&void 0!==t?t:[])}return i});return this.rxRecordGridFilterService.addQueries(...t)}downloadAttachment(e,t,i,n){if(!n||(0,m.includes)(["Space","Enter"],n.code))if(this.rxRecordGridUtilsService.isAssociatedRecordFieldId(t.field)){const n=this.rxRecordGridUtilsService.getFieldLocator(t.field),o=(0,m.find)(this.state.associationDescriptors,{associationDefinition:{guid:n.associationGuid}});this.rxAssociationInstanceDataPageService.post({params:{pageSize:1,startIndex:0,associationDefinition:o.associationDefinition.name,nodeToQuery:n.associationNodeSide,associatedRecordInstanceId:e[a.RX_RECORD_DEFINITION.coreFieldIds.id],propertySelection:a.RX_RECORD_DEFINITION.coreFieldIds.id}}).pipe((0,r.take)(1)).subscribe(e=>{const t=e.data[0][a.RX_RECORD_DEFINITION.coreFieldIds.id];this.rxRecordInstanceService.downloadAttachment(o.recordDefinitionName,Number(n.fieldId),t,i)})}else this.rxRecordInstanceService.downloadAttachment(this.state.recordDefinitionName,Number(t.field),e[a.RX_RECORD_DEFINITION.coreFieldIds.id],i)}executeViewActions(e,t,i){if(this.isProgrammaticUse){return(0,m.sortBy)(t,"index").reduce((e,t)=>(0,m.isFunction)(t.name)?e.then(e=>t.name(e,i)):(0,m.isString)(t.name)?e.then(e=>(()=>{this.rxViewActionService.execute(t.name.toString(),t.params).subscribe()})()):e,Promise.resolve())}return this.runtimeViewModelApi.triggerViewActions(e,h.VIEW_COMPONENT_DEFAULT_EVENT_NAME)}getActionButtonConfig(e,t){return e?t.pipe((0,r.map)(e=>Object.assign(Object.assign({},e),{cls:"dropdown-item"}))):t}getCellValue(e,t){return(0,this.cellValueFormatters[t.field])(e[t.field])}getDataCellClass(){return this.popovers.length?"rx-cell-selection-mode":""}getLoadRecordCountLinkText(){return`${this.adaptTableConfig.data.length}+`}getMultipleRowsSelectedText(){return this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.multiple-rows-selected.label",{count:this.adaptTableConfig.selectedItems.length,total:this.isTotalRecordCountKnown?this.adaptTableConfig.totalRecords:this.getLoadRecordCountLinkText()})}getMultipleRowsSelectedTextFirstPart(){const e=this.getMultipleRowsSelectedText();return e.substring(0,e.indexOf(this.getLoadRecordCountLinkText()))}getMultipleRowsSelectedTextSecondPart(){const e=this.getMultipleRowsSelectedText(),t=this.getLoadRecordCountLinkText();return e.substring(e.indexOf(t)+t.length)}getNamedFilterOptions(e){return this.state.namedFilterOptions[e.id]}getSharedFilterPresets(){this.state.advancedFiltering.isLoading=!0;const e=()=>{this.state.advancedFiltering.isLoading=!1,this.state.advancedFiltering.hasLoadedSharedFilterPresets=!0};return this.rxRecordGridSharedFilterPresetsCacheService.getSharedFilterPresets(this.guid).pipe((0,r.catchError)(t=>(e(),(0,o.throwError)(t))),(0,r.tap)(()=>{e()}))}getSortedColumnsByTitle(){return this.adaptTableConfig.columns.slice().sort((e,t)=>e.header.localeCompare(t.header))}getToolbarTags(e){const t=(e||[]).map(e=>{if(e.data.filterOption&&e.data.filterOption.id!==Nc.externalPresetFilterOptionId){const t=e.data.filterOption.id,i=this.state.recordDefinition.fieldDefinitionsById[t],n=this.state.advancedFiltering.recordGridFilterConfigs[i.resourceType];if((0,m.isFunction)(n.getToolbarTagInfo))return n.getToolbarTagInfo({primaryRecordDefinition:this.state.recordDefinition,fieldDefinition:i,value:e.data.value,tag:e,fieldId:t,namedFilterOptions:this.state.namedFilterOptions[t]}).pipe((0,r.tap)(t=>e.data.value.title=t.tooltip),(0,r.map)(t=>Object.assign(Object.assign({},e),{text:t.text})))}return(0,o.of)(Object.assign({},e))});return t.length?(0,o.forkJoin)(t):(0,o.of)([])}getVisibleColumns(){return this.adaptTable.getVisibleColumns(this.adaptTableConfig.columns)}getVisibleRows(){return this.adaptTableConfig.data}handleHeaderCheckboxToggle(e){this.setSelectedFilteredRowsCount()}isCellSelected(e){return(0,m.some)(this.popovers,t=>t===e)}loadSavedFilterPresetFilters(e){return this.state.advancedFiltering.isLoading=!0,this.rxRecordGridFilterService.getAdvancedFilterData(e.filterData,this.state.recordDefinition.fieldDefinitionsById,this.state.advancedFiltering.recordGridFilterConfigs,this.state.recordDefinition,this.state.advancedFiltering.filterOptions,this.state.associationDescriptors).pipe((0,r.tap)(t=>{e.filters=(e.filters||[]).concat(t),this.state.advancedFiltering.isLoading=!1}))}loadTotalRowCount(){this.getTotalRowCount().subscribe(e=>{this.adaptTableConfig.totalRecords=e.totalSize})}onActiveSavedAdvancedFilterChange(e){this.state.advancedFiltering.activeSavedFilter=e}onAdvancedFilterExpressionTagsChanged(e){if(e.filterExpressionTags.every(e=>(0,m.isEmpty)(e.data.validationErrors))){const t=this.state.advancedFiltering.toolbarTags;this.updateToolbarTags(e.filterExpressionTags),t!==this.state.advancedFiltering.toolbarTags&&this.changeDetector.detectChanges()}}onAdvancedFiltersChange(e){this.state.advancedFiltering.appliedSharedFilterPreset=null;const t=this.getAppliedExternalPresetFilter(e);if(t){const e=this.state.advancedFiltering.savedFilters.find(e=>e.id===t.value);if(this.isSharedFilterPreset(e))this.state.advancedFiltering.appliedSharedFilterPreset=e;else if(e.appliedSharedFilterPresetGuid){const t=(0,m.find)(this.state.advancedFiltering.savedFilters,{id:e.appliedSharedFilterPresetGuid});this.state.advancedFiltering.appliedSharedFilterPreset=t}}this.adaptTableConfig.first=0,this.state.advancedFiltering.selectedFilters=e,this.adaptTableConfig.isLoadingMoreData=!1,this.updateAdaptTableFilters(),this.userPreferencesChanged$.next(),this.updateToolbarTags(this.state.advancedFiltering.toolbarTags),this.state.useExternalFiltering?this.loadRowData(!1):this.adaptTableConfig.data=this.filterRows(this.adaptTableConfig.originalRows)}onBeforeActiveSavedFilterChange(e){const t=e.savedFilterToSelect;t&&(t.filters&&this.areNonExternalPresetFiltersApplied(t.filters)||this.loadSavedFilterPresetFilters(t).subscribe())}onCellClick(e,t,i,n,o){!!e.target.closest("a")?this.clearSelectedCells():(this.popovers.length&&(e.metaKey||e.ctrlKey||this.clearSelectedCells()),t&&this.toggleCellSelection(t.filter(e=>!e.isRowActionsColumn),i,n,o))}onFilterBySelection(e,t,i){this.onCellClick(e,t,i,null,!0),this.applyFilterBySelection()}onCellMouseOver(e){const t=e.currentTarget;this.showCellTooltip=t.offsetWidth<t.scrollWidth}onChangedCardLayout(e){this.adaptTableConfig.cardLayoutColumns=e.cardLayoutColumns,this.clearSelectedCells(),this.cardLayoutOpenedModal&&(this.cardLayoutOpenedModal.reject(),this.cardLayoutOpenedModal=null),this.guid&&this.rxRecordGridUserPreferencesService.applyUserPreferencesForColumns(this.adaptTableConfig,this.state.columnsWithMetadata,this.guid),this.visibleColumns=this.getVisibleColumns(),this.adaptTableConfig.virtualRowHeight=this.getVirtualRowHeight()}onColReorder(e){this.visibleColumns=this.getVisibleColumns(),this.userPreferencesChanged$.next()}onColumnResize(){const e=this.adaptTable.el.nativeElement.getBoundingClientRect(),t=null==e?void 0:e.width,i=this.adaptTable.dataHeaderCells.reduce((e,t)=>e+t.element.nativeElement.offsetWidth,0),n=100*i/(t*this.getVisibleColumns().length)+"%",o=(0,m.reduce)(this.adaptTable.dataHeaderCells.toArray(),(e,t)=>{const n=t.data.renderingColumn.columnsConfigs[0];let o=null;return i&&(o=(0,m.endsWith)(n.width,"px")||this.state.expandable?`${t.element.nativeElement.offsetWidth}px`:`${(0,m.round)(t.element.nativeElement.offsetWidth/i*100,2)}%`),e[n.field]=o,e},{});this.adaptTableConfig.columns.forEach(e=>{var t;e.hidden||(e.width=null!==(t=o[e.field])&&void 0!==t?t:n)}),this.userPreferencesChanged$.next()}onColumnVisibilityChange(e,t){t.hidden===e&&(t.hidden=!e,this.userPreferencesChanged$.next(),this.visibleColumns=this.getVisibleColumns(),this.adaptTableConfig.virtualRowHeight=this.getVirtualRowHeight(),e?this.lastPropertySelection.includes(t.field)||this.loadRowData():this.avoidSystemColumnExpansion())}onCreateNewFilterPreset(e){const t={filters:e.filters,name:e.name,id:this.rxGuidService.generate()},i=this.getAppliedExternalPresetFilter(e.filters);i&&(t.appliedSharedFilterPresetGuid=i.value),this.state.advancedFiltering.savedFilters.push(t),this.state.advancedFiltering.activeSavedFilter=t,this.userPreferencesChanged$.next()}onDeleteSavedFilterPreset(e){(0,m.remove)(this.state.advancedFiltering.savedFilters,t=>t.id===e.id),this.userPreferencesChanged$.next()}onEditSavedFilterClick(e){let t=null;e.savedFilter.appliedSharedFilterPresetGuid&&(t=e=>e),e.savedFilter.filters&&this.areNonExternalPresetFiltersApplied(e.savedFilter.filters)?e.savedFilter.appliedSharedFilterPresetGuid&&(e.preventDefault(),e.initSavedFilterEditing(t.bind(this))):(e.preventDefault(),this.loadSavedFilterPresetFilters(e.savedFilter).subscribe(()=>{e.initSavedFilterEditing(t&&t.bind(this))}))}onExport(e){if(this.isExportInProgress)return void this.rxNotificationService.addInfoMessage(this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.export-in-progress.message"));const t=this.getVisibleColumns().filter(e=>!e.isRowActionsColumn);if(!t.length)return void this.rxNotificationService.addWarningMessage(this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.no-data-to-export.message"));const i=t.map(e=>e.header||e.fallbackTitle);let n;if(e.selectionOnly)n=(0,o.of)((0,m.intersectionBy)(this.adaptTableConfig.data,this.getSelectedRows(),d.RowDataItemIdFieldName));else{const e=this.getHeaders(),i=this.prepareQueryParamsAndQueryArgs(!1);i.pageSize=-1,i.propertySelection=t.map(e=>e.field),delete i.cursor,this.isExportInProgress=!0,n=this.getDataPageService().post({params:i,headers:e}).pipe((0,r.map)(e=>e.data),(0,r.finalize)(()=>{this.isExportInProgress=!1}))}n.subscribe(e=>{const n=this.getCellValues(e,t);this.exportDataToCsv(n,i)})}onLazyLoad(e){this.state.useExternalFiltering?(e.loadMore||e.eventSource!==A.AdaptTableEventSource.LoadMore)&&(this.adaptTableConfig.multiSortMeta=e.multiSortMeta,this.adaptTableConfig.filters=e.filters,this.adaptTableConfig.isLoadingMoreData=e.loadMore,this.loadRowData(e.loadMore)):e.eventSource===A.AdaptTableEventSource.FilterChange&&(this.adaptTableConfig.filters=e.filters,this.adaptTableConfig.data=this.filterRows(this.adaptTableConfig.originalRows))}onRefreshClick(){this.state.useExternalFiltering||this.loadRowData(!1);const e=this.adaptTable.toolbarComponent.getQuickFilterInputValue();this.adaptTable.setQuickFilter(e)}onRemoveFilterTag(e){this.state.advancedFiltering.activeSavedFilter=null;const t=this.state.advancedFiltering.selectedFilters.slice(),i=e.removedTag.data.filterOption.id,n=(0,m.findIndex)(t,e=>e.filterOptionId===i);t.splice(n,1),this.onAdvancedFiltersChange(t),this.setToolbarTags(e.newTags)}onRowsSelectionChange(e){const t=e?(0,m.castArray)(e):[],i=this.adaptTableConfig.selectedItems;this.shouldDisplayActionButtons=!(0,m.isEmpty)(t)&&!(0,m.isEmpty)(this.actionButtons),this.expandSelectedRowsProperties(t),this.adaptTableConfig.selectedItems=t,this.adaptTableConfig.toolbarConfig=Object.assign(Object.assign(Object.assign({},this.adaptTableConfig.toolbarConfig),{quickFilter:!this.shouldDisplayActionButtons,leftCustomSectionFixed:this.shouldDisplayActionButtons,rightCustomSectionFixed:this.shouldDisplayActionButtons,leftCustomSection:this.shouldDisplayActionButtons,filter:!this.shouldDisplayActionButtons}),this.state.toolbarConfig),this.adaptTableConfig.texts=Object.assign(Object.assign({},this.adaptTableConfig.texts),{exportSelected:this.getExportSelectedText(t)}),this.addSelectionFieldOptionNames(t[0]),this.notifyPropertyChanged("selectedRows",t,i),this.notifyPropertyChanged("selectedRowCount",t.length,i.length),this.notifyPropertyChanged("firstSelectedRow",t[0],i[0]),this.notifyPropertyChanged("fieldValuesByFieldId",this.prepareFieldsValueByFieldIdData(t),{}),this.rowSelectionChanged.next(t)}onSearchColumns(){this.filteredVisibleColumns=this.sortedColumnsByTitle.filter(e=>this.rxStringService.caseInsensitiveSearch(e.header,this.columnSearchText))}onSort(e){this.applySorting(e.multisortmeta)}onSortCards(e){this.applySorting(e),this.loadRowData()}onRowActionOpen(e){var t;null===(t=(0,m.last)(this.popovers))||void 0===t||t.close(),this.addSelectionFieldOptionNames(e);const i=this.expandRowProperties(e);this.state.lastActionRow=i,this.notifyPropertyChanged("clickableRow",i,null)}onUpdateSavedFilterPreset(e){const t=(0,m.find)(this.state.advancedFiltering.savedFilters,t=>t.id===e.oldSavedFilter.id);t&&(t.appliedSharedFilterPresetGuid&&!(0,m.find)(e.newSavedFilter.filters,e=>e.filterOptionId===Nc.externalPresetFilterOptionId)&&delete t.appliedSharedFilterPresetGuid,Object.assign(t,e.newSavedFilter),this.userPreferencesChanged$.next())}openRowDetails(e,t){var i;null===(i=(0,m.last)(this.popovers))||void 0===i||i.close(),this.cardLayoutOpenedModal=this.adaptModalService.open({title:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.cards.record-details.dialog.title"),content:this.cardLayoutRowDetailsTemplate,data:{columns:e,rowDataItem:t}}),this.cardLayoutOpenedModal.catch(m.noop)}setToolbarTags(e){this.state.advancedFiltering.toolbarTags=e,this.updateToolbarItems()}trackByColumnField(e,t){return t.field}updateToolbarTags(e){this.getToolbarTags(e).subscribe(e=>{this.setToolbarTags(e)})}addAssociationFieldsToRecordDefinition(e){const t=this.state.recordDefinition.fieldDefinitionsById;e.forEach(e=>{t[e.fieldId]||this.rxRecordDefinitionService.addFieldDefinitionToMap(e.fieldDefinition,t,e.fieldId)}),this.state.recordDefinition.fieldDefinitionsById=Object.assign(Object.assign({},t),this.rxObjectUtilsService.expandProperties(t)),this.notifyPropertyChanged("recordDefinition",this.state.recordDefinition)}areNonExternalPresetFiltersApplied(e){return e.some(e=>e.filterOptionId!==Nc.externalPresetFilterOptionId)}getAppliedExternalPresetFilter(e){return e.find(e=>e.filterOptionId===Nc.externalPresetFilterOptionId)}prepareFieldsValueByFieldIdData(e){const t=(0,m.map)(this.adaptTableConfig.columns,"field");return(0,m.reduce)(e,(e,i,n)=>(t.forEach(function(t){e[t]=e[t]||[],e[t][n]=i[t]}),e),{})}addSelectionFieldOptionNames(e){e&&(e.selectionFieldOptionNamesById=(0,m.transform)(this.selectionFieldOptionLabelsByFieldId,(t,i,n)=>{t[n]=i[e[n]]},{}))}applyFilters(e,t){this.initializationCompleted$.pipe((0,r.switchMap)(()=>this.rxRecordGridFilterService.getAdvancedFilterData(e,this.state.recordDefinition.fieldDefinitionsById,this.state.advancedFiltering.recordGridFilterConfigs,this.state.recordDefinition,this.state.advancedFiltering.filterOptions,this.state.associationDescriptors)),(0,r.take)(1),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{let i,n=(0,m.isEmpty)(this.pendingFiltersToApply)?(0,m.cloneDeep)(this.state.advancedFiltering.selectedFilters):this.pendingFiltersToApply;switch(t){case d.ApplyGridFilterMode.Begin:this.pendingFiltersToApply?i=this.pendingFiltersToApply:this.pendingFiltersToApply=[];break;case d.ApplyGridFilterMode.Append:i=[...n.filter(t=>!e.find(e=>e.filterOptionId===t.filterOptionId)),...e];break;case d.ApplyGridFilterMode.Remove:i=n.reduce((t,i)=>{const n=e.find(e=>e.filterOptionId===i.filterOptionId);return n?(this.isRangeFilter(i.filterOptionId)?(0,m.isEqual)(i.value.filterValue,n.value.filterValue)&&(i.value.filterValue=[null,null]):i.value.filterValue=i.value.filterValue.filter(e=>!n.value.filterValue.includes(e)),i.value.namedOptions=i.value.namedOptions.filter(e=>!n.value.namedOptions.includes(e)),rp.isEmptyWithRange(i.value)||t.push(i)):t.push(i),t},[]);break;case d.ApplyGridFilterMode.Merge:i=[...n,...e].reduce((e,t)=>{const i=e.find(e=>e.filterOptionId===t.filterOptionId);return i?(this.isRangeFilter(t.filterOptionId)?i.value.filterValue=[...t.value.filterValue]:i.value.filterValue=(0,m.uniq)(i.value.filterValue.concat(t.value.filterValue)),i.value.namedOptions=(0,m.uniq)(i.value.namedOptions.concat(t.value.namedOptions))):e.push(t),e},[]);break;case d.ApplyGridFilterMode.Overwrite:this.state.advancedFiltering.appliedSharedFilterPreset=null,this.state.advancedFiltering.activeSavedFilter=null,i=e;break;case d.ApplyGridFilterMode.Clear:this.state.advancedFiltering.appliedSharedFilterPreset=null,this.state.advancedFiltering.activeSavedFilter=null,i=[],this.pendingFiltersToApply&&(this.state.advancedFiltering.selectedFilters=[]);break;case d.ApplyGridFilterMode.End:this.pendingFiltersToApply&&(i=this.pendingFiltersToApply,this.pendingFiltersToApply=null)}this.pendingFiltersToApply?this.pendingFiltersToApply=i||[]:i&&this.onAdvancedFiltersChange(i)})}applyPendingSelectedFilters(){const e=(0,m.cloneDeep)(this.state.advancedFiltering.selectedFilters);(0,m.forEach)(this.state.advancedFiltering.pendingSelectedFilters,t=>{const i=(0,m.find)(e,{filterOptionId:t.filterOptionId});let n=[];switch(this.state.recordDefinition.fieldDefinitionsById[t.filterOptionId].resourceType){case a.RX_RECORD_DEFINITION.dataTypes.dateOnly.resourceType:case a.RX_RECORD_DEFINITION.dataTypes.dateTime.resourceType:n=t.value.map(e=>(0,D.default)(e)),n=[D.default.min(n),D.default.max(n)];break;case a.RX_RECORD_DEFINITION.dataTypes.timeOnly.resourceType:n=t.value.map(e=>(0,D.default)(e,"LTS")),n=[D.default.min(n),D.default.max(n)];break;case a.RX_RECORD_DEFINITION.dataTypes.integer.resourceType:case a.RX_RECORD_DEFINITION.dataTypes.decimal.resourceType:case a.RX_RECORD_DEFINITION.dataTypes.real.resourceType:n=[(0,m.min)(t.value),(0,m.max)(t.value)];break;case a.RX_RECORD_DEFINITION.dataTypes.boolean.resourceType:n=t.value.map(e=>"$NULL$"===e?"blank":1===e);break;default:n=(0,m.uniq)(t.value.map(e=>String(e)))}i?i.value.filterValue=n:(t.value=new rp(n),e.push(t))}),this.onAdvancedFiltersChange(e),this.clearSelectedCells()}applySorting(e){this.adaptTableConfig.multiSortMeta=e,this.userPreferencesChanged$.next(),this.state.useExternalFiltering||(this.adaptTableConfig.data=this.filterRows(this.adaptTableConfig.data))}applyViewPreset(e,t,i){var n;return e===(null===(n=this.state.viewPresetSelector)||void 0===n?void 0:n.getGuid())?this.applyViewPresetInner(t,i):o.EMPTY}shareViewPreset(e){var t;return e===(null===(t=this.state.viewPresetSelector)||void 0===t?void 0:t.getGuid())?(0,o.of)(this.rxRecordGridUserPreferencesService.getSharedViewPresetData()):(0,o.of)(null)}applyViewPresetInner(e,t){return this.initializationCompleted$.pipe((0,r.switchMap)(()=>{const i=t&&t[this.guid];return i?this.rxRecordGridUserPreferencesService.applySharedViewPreset(this.state,this.adaptTableConfig,e,i):this.rxRecordGridUserPreferencesService.applyViewPreset(this.state,this.adaptTableConfig,e)}),(0,r.take)(1),(0,r.tap)(()=>{this.loadRowData(),this.userPreferencesChanged$.next(),this.checkIfViewPresetEdited()}))}areUserFiltersApplied(){return this.isSearchApplied()||Boolean(this.state.advancedFiltering.appliedSharedFilterPreset)||!(0,m.isEmpty)(this.state.advancedFiltering.selectedFilters)}isSearchApplied(){const e=(0,m.get)(this.adaptTableConfig.filters,"global.value","").toString().trim();return Boolean(e)}checkIfViewPresetEdited(){this.state.viewPresetSelector&&this.rxRecordGridUserPreferencesService.isCurrentViewPresetEdited()&&this.state.viewPresetSelector.markAppliedViewPresetAsEdited()}clearSelectedCells(){var e;null===(e=(0,m.last)(this.popovers))||void 0===e||e.close(),this.popovers=[],this.state.advancedFiltering.pendingSelectedFilters=[],this.state.advancedFiltering.selectedCardValues={}}compareRows(e,t){const i=this.adaptTableConfig.multiSortMeta;return(0,m.reduce)(i,(i,n)=>{let o,r;if(e.groupField&&t.groupField?(o=e.groupField===n.field?e.groupValue:null,r=t.groupField===n.field?t.groupValue:null):(o=e[n.field],r=t[n.field]),isNaN(o)||isNaN(r))i=i||n.order*(0,m.toString)(o).localeCompare((0,m.toString)(r));else{const e=Number(o),t=Number(r);i=i||n.order*(e<t?-1:e>t?1:0)}return i},0)}createCsvExportFile(e){const t=new Blob([`\ufeff${e}`],{type:"text/csv;charset=utf-8"});this.ngZone.runOutsideAngular(()=>{(0,O.saveAs)(t,`${this.getExportFileName()}.csv`)})}deleteViewPreset(e){return this.rxRecordGridUserPreferencesService.deleteViewPreset(e),this.userPreferencesChanged$.next(),o.EMPTY}discardViewPresetChanges(e,t){return this.rxRecordGridUserPreferencesService.isExistingViewPreset(e)?(this.rxRecordGridUserPreferencesService.discardViewPresetChanges(e),this.applyViewPresetInner(e,t)):o.EMPTY}enrichRowEntity(e){let t={};if(!(0,m.isEmpty)(this.clickableWithHrefColumnActions)){this.addSelectionFieldOptionNames(e);const i=this.expandRowProperties(e);(0,m.set)(this.clickableWithHrefActionExpressionEvaluationData,`view.components.${this.guid}.clickableRow`,i),t=(0,m.reduce)(this.clickableWithHrefColumnActions,(e,t,i)=>{const n=this.findEnabledGridAction(t);return(null==n?void 0:n.name)===d.RX_VIEW_ACTION.viewActionNames.openView?(e[`${i}$ROUTER_LINK$`]=this.rxViewActionUtilsService.generateViewUrl(n.viewDefinitionName),e[`${i}$QUERY_PARAMS$`]=this.evaluateViewInputParameters(n.viewParams)):(null==n?void 0:n.name)===d.RX_VIEW_ACTION.viewActionNames.launchUrl?(e[`${i}$LAUNCH_URL$`]=this.rxExpressionEvaluatorService.tryEvaluate(n.url,this.clickableWithHrefActionExpressionEvaluationData),e[`${i}$TARGET$`]=d.RX_LAUNCH_BEHAVIOR[n.launchBehavior].target):(e[`${i}$LAUNCH_URL$`]=null,e[`${i}$ROUTER_LINK$`]=null),e},{})}return Object.assign({},e,{[d.RowDataItemIdFieldName]:e[this.adaptTableConfig.primaryKey]},t)}expandRowProperties(e){return Object.assign(Object.assign({},e),this.rxObjectUtilsService.expandProperties(e))}expandSelectedRowsProperties(e){(0,m.forEach)(e,(t,i)=>{e[i]=this.expandRowProperties(t)})}exportDataToCsv(e,t){const i=`${`"${t.join('","')}"\n`}${e.map(e=>`"${e.join('","')}"\n`).join("")}`;this.createCsvExportFile(i)}evaluateViewInputParameters(e){const t={};return(0,m.forEach)(e,(e,i)=>{const n=this.rxExpressionEvaluatorService.tryEvaluate(e,this.clickableWithHrefActionExpressionEvaluationData);t[i]=n||""}),t}filterRows(e){const t=(0,m.get)(this.adaptTableConfig.filters,"global.value","").toString().trim();let i=(0,m.cloneDeep)(e);if(t){const e=this.getVisibleColumns();i=i.filter(i=>(0,m.some)(e,n=>i.groupField?!!this.rxStringService.caseInsensitiveSearch(i.groupValue,t)||(i.items=this.getFilteredItems(i.items,e,t),i.items.length):this.rxStringService.caseInsensitiveSearch(this.getCellValue(i,n),t)))}if((0,m.isEmpty)(this.state.advancedFiltering.selectedFilters)||(i=this.rxRecordGridFilterService.filterRows(i,this.state.advancedFiltering.selectedFilters,this.state.recordDefinition,this.state.advancedFiltering.recordGridFilterConfigs)),this.adaptTableConfig.multiSortMeta&&(this.state.expandGroups?this.sortRows(i):i.sort((e,t)=>this.compareRows(e,t))),this.state.expandGroups){const e=t=>{const i=t.filter(e=>e.items);let n=t.length-i.length;return null==i||i.forEach(t=>n+=e(t.items)),n};this.adaptTableConfig.totalRecords=e(i)}else this.adaptTableConfig.totalRecords=i.length;return i}findEnabledGridAction(e){return e.find(e=>{const t=e.$condition$;return!1!==this.rxExpressionEvaluatorService.tryEvaluate(t,this.clickableWithHrefActionExpressionEvaluationData)})}getAdvancedFilterOptions(){return(0,m.reduce)(this.state.recordDefinition.fieldDefinitionsById,(e,t,i)=>{var n;if(!(0,m.isUndefined)(t.id)){const o=this.adaptTableConfig.columns.find(e=>e.field===i),r=!o||!o.filterable,a=this.state.advancedFiltering.recordGridFilterConfigs[t.resourceType],s=null==o?void 0:o.additionalQueryCriteria;a&&e.push(this.rxRecordGridAdvancedFilteringService.getAdvancedFilterOption(i,o?o.header||o.fallbackTitle:t.name,t,a,r,{optionalBooleanFilter:this.fieldsProvider.optionalBooleanFilter,requiredBooleanFilter:this.fieldsProvider.requiredBooleanFilter,inputsForStringWithTypeAheadTemplate:this.fieldsProvider.inputsForStringWithTypeAheadTemplate,inputsForStringTypeTemplate:this.fieldsProvider.inputsForStringTypeTemplate,inputsForNumberTypeTemplate:this.fieldsProvider.inputsForNumberTypeTemplate,inputsForTimeTypeTemplate:this.fieldsProvider.inputsForTimeTypeTemplate,inputsForDateTypeTemplate:this.fieldsProvider.inputsForDateTypeTemplate,inputsForDatetimeTypeTemplate:this.fieldsProvider.inputsForDatetimeTypeTemplate,inputsForSelectionTypeTemplate:this.fieldsProvider.inputsForSelectionTypeTemplate},null,this.state.namedFilterOptions[i],null!==(n=null==o?void 0:o.typeaheadKeystrokeCount)&&void 0!==n?n:null,(null==o?void 0:o.filterable)?s:null))}return e},[]).sort((e,t)=>e.label.localeCompare(t.label))}getAssociationDescriptors(){const e=this.getRecordDefinitionName();return e?this.rxRecordGridUtilsService.getAssociationDescriptors(e):(0,o.of)([])}getBaseDataPageParams(){const e=this.state,t={recorddefinition:e.recordDefinitionName};return Boolean(e.associationDefinitionName)&&Object.assign(t,{associatedRecordInstanceId:e.associatedRecordId,associationDefinition:e.associationDefinitionName,nodeToQuery:e.associatedRecordNodeSide,recordDefinitionToQuery:e.recordDefinitionName}),e.associatedRoleName&&(t.roleName=e.associatedRoleName),t}getCellValueFormatter(e){const t=e.fieldDefinition;let i=e=>e;switch(t.resourceType){case a.RX_RECORD_DEFINITION.dataTypes.boolean.resourceType:i=e=>this.rxBooleanPipe.transform(e);break;case a.RX_RECORD_DEFINITION.dataTypes.selection.resourceType:i=t=>this.selectionFieldOptionLabelsByFieldId[e.fieldId][t];break;case a.RX_RECORD_DEFINITION.dataTypes.dateTime.resourceType:i=e=>this.datePipe.transform(e,"medium");break;case a.RX_RECORD_DEFINITION.dataTypes.dateOnly.resourceType:i=e=>this.datePipe.transform(e);break;case a.RX_RECORD_DEFINITION.dataTypes.timeOnly.resourceType:i=e=>e?this.datePipe.transform(new Date(`2000-01-01T${e}`),"mediumTime"):e;break;case a.RX_RECORD_DEFINITION.dataTypes.attachment.resourceType:i=e=>{const t=(0,m.get)(e,"name");return(0,m.isString)(t)?t:e};break;case a.RX_RECORD_DEFINITION.dataTypes.decimal.resourceType:case a.RX_RECORD_DEFINITION.dataTypes.real.resourceType:{const e=t.precision,n=(0,m.isNil)(e)||-1===e?null:`1.${e}-${e}`;i=e=>this.decimalPipe.transform(e,n);break}case a.RX_RECORD_DEFINITION.dataTypes.integer.resourceType:i=e=>this.decimalPipe.transform(e)}return i}getCellValues(e,t){return e.map(e=>t.map(t=>this.getCellValue(e,t)))}getColumns(){return this.adaptTableConfig.columns.map(e=>{const t=(0,m.find)(this.state.columnsWithMetadata,{fieldId:e.field});return{field:e.field,header:e.header,hidden:(0,u.getValueOrFunc)(e.hidden),fieldDefinition:t.fieldDefinition}})}getData(e){return this.getDataBase(e,!1).pipe((0,r.tap)(e=>{this.cursor=e.cursor||void 0}))}getDataBase(e,t){var i,n;let o;const r=this.prepareQueryParamsAndQueryArgs(t);if(null===(i=r.queryExpression)||void 0===i?void 0:i.includes(d.RX_EXPRESSION_EVALUATOR.operands.undefined))return this.rxLogService.debug(`Query expression contains undefined operands: ${r.queryExpression}`),this.rxRecordInstanceDataPageService.getEmptyDataPage();if(this.state.enableFiltering&&!this.isSearchApplied()&&this.state.requiredFilters>this.state.advancedFiltering.selectedFilters.length)return this.rxNotificationService.addWarningMessage(this.getFiltersRequiredMessage(this.state.requiredFilters),this.translateService.instant("com.bmc.arsys.rx.client.common.alert.label")),this.rxRecordInstanceDataPageService.getEmptyDataPage();if((0,m.isNumber)(e)&&(r.startIndex=e),0===e&&delete r.cursor,this.lastQueryExpression=null!==(n=r.queryExpression)&&void 0!==n?n:"",t||(this.lastPropertySelection=r.propertySelection),this.state.getData)o=this.state.getData(Object.assign(Object.assign({},r),{searchText:(0,m.get)(this.adaptTableConfig.filters,"global.value","").toString().trim()}));else if(this.hasAssociationAndEmptyRecordId())o=this.rxAssociationInstanceDataPageService.getEmptyDataPage();else{o=this.getDataPageService().post({params:r,headers:this.getHeaders()})}return o}getDataCellStyle(e){let t="";switch(e.alignment){case Nc.columnAlignment.left:t="left";break;case Nc.columnAlignment.right:t="right";break;case Nc.columnAlignment.center:t="center";break;default:const i=[a.RX_RECORD_DEFINITION.dataTypes.integer.resourceType,a.RX_RECORD_DEFINITION.dataTypes.decimal.resourceType,a.RX_RECORD_DEFINITION.dataTypes.real.resourceType];-1!==e.fieldDefinition.resourceType.search(i.join("|"))&&(t="right")}return{"text-align":t}}getDataPageService(){return Boolean(this.state.associationDefinitionName)?this.rxAssociationInstanceDataPageService:this.rxRecordInstanceDataPageService}getExportFileName(){return`${this.datePipe.transform(new Date,"yyyy-MM-dd")} Grid Data`}getFilteredItems(e,t,i){return e.filter(e=>{let n;return e.groupField?this.rxStringService.caseInsensitiveSearch(e.groupValue,i)?n=!0:(e.items=this.getFilteredItems(e.items,t,i),n=e.items.length):n=(0,m.some)(t,t=>this.rxStringService.caseInsensitiveSearch(this.getCellValue(e,t),i)),n})}getFirstSelectedRow(){return(0,m.get)(this.adaptTableConfig.selectedItems,"0",null)}getGridColumnDefinitions(e){const t=[];return e.slice().sort((e,t)=>e.index-t.index).map(e=>{let i;const n=this.rxRecordGridConfigUtilsService.parseConfigString(e.sortable),o=this.rxRecordGridUtilsService.getTestIdForGridColumn(e.fieldId);(0,m.isObject)(n)?(i=!0,this.adaptTableConfig.multiSortMeta?this.adaptTableConfig.multiSortMeta.splice(n.priority,0,{field:e.fieldId,order:this.rxRecordGridConfigUtilsService.getColumnSortOrder(n.direction)}):this.adaptTableConfig.multiSortMeta=[{field:e.fieldId,order:this.rxRecordGridConfigUtilsService.getColumnSortOrder(n.direction)}]):i=n;const r=(0,m.endsWith)(e.width,"px"),a=this.adaptTableConfig.columnResizeMode!==A.ResizeMode.Expand||r?e.width:null,s=r&&parseInt(a)<Nc.defaultColumnMinWidth?a:null;e.fieldId===Nc.actionsColumnFieldDefinition.id?t.push({field:e.fieldId,header:e.title,fallbackTitle:e.fallbackTitle,width:a,minWidth:s,hidden:!e.visible,cellTemplate:this.rowActionButtonsTemplate,editTemplate:null,filterTemplate:null,headerTitleTemplate:null,cellTooltip:null,headerTooltip:null,headerClass:null,filterable:e.filterable,searchable:e.searchable,sortable:i,editable:!1,customTemplate:this.rowActionButtonsTemplate,clickable:!1,dataCellClass:"rx-row-action-cell",isRowActionsColumn:!0,testId:o}):(t.push({field:e.fieldId,header:e.title,fallbackTitle:e.fallbackTitle,width:a,minWidth:s,hidden:!e.visible,cellTemplate:this.cellTemplate,editTemplate:null,filterTemplate:null,headerTitleTemplate:null,cellTooltip:e=>this.showCellTooltip&&this.getCellValue(e.dataItem,e.column)||null,headerTooltip:e.headerTooltip,dataCellClass:this.getDataCellClass.bind(this),dataCellStyle:this.getDataCellStyle(e),headerClass:null,sortable:i,editable:null,filterable:e.filterable,searchable:e.searchable,filterName:null,filterParams:null,clickable:e.clickable,filterType:e.filterType,isDownloadableAttachment:this.isDownloadableAttachmentColumn(e),clickableWithHref:e.clickableWithHref,customTemplate:e.cellTemplate,wrapText:e.wrapText,referenced:e.referenced,cellDisplayProperties:e.cellDisplayProperties,typeaheadKeystrokeCount:e.typeaheadKeystrokeCount,additionalQueryCriteria:e.additionalQueryCriteria,testId:o}),this.cellValueFormatters[e.fieldId]=this.getCellValueFormatter(e))}),t}getGridData(e){const t=()=>{this.adaptTableConfig.isLoadingData=!1,this.adaptTableConfig.isLoadingMoreData=!1};return this.adaptTableConfig.isLoadingData=!0,this.getData(e?this.adaptTableConfig.data.length:0).pipe((0,r.tap)(i=>{t();const n=i.data.map(this.enrichRowEntity.bind(this));if(this.state.useExternalFiltering?e?(this.adaptTableConfig.data=this.adaptTableConfig.data.concat(n),(0===n.length||n.length<this.adaptTableConfig.rows)&&(this.adaptTableConfig.totalRecords=this.adaptTableConfig.data.length)):(this.adaptTableConfig.data=n,n.length<this.adaptTableConfig.rows?this.adaptTableConfig.totalRecords=n.length:this.adaptTableConfig.totalRecords=null):(this.adaptTableConfig.originalRows=n,this.adaptTableConfig.data=this.filterRows(this.adaptTableConfig.originalRows)),this.state.expandGroups){this.adaptTableConfig.expandedGroupsKeys={};const e=t=>{t.forEach(t=>{if(t.items){const i=this.adaptTableConfig.expandedGroupsKeys[t.groupField];i?i[t.groupValue]=!0:this.adaptTableConfig.expandedGroupsKeys[t.groupField]={[t.groupValue]:!0},e(t.items)}})};e(this.adaptTableConfig.data)}this.adaptTableConfig.toolbarConfig.rightCustomSection=Boolean(this.state.enableRowSelection&&this.adaptTableConfig.data.length),this.notifyPropertyChanged("totalRowCount",this.adaptTableConfig.data.length),this.notifyPropertyChanged("queryExpression",this.lastQueryExpression),this.notifyPropertyChanged("lastRefreshTime",(new Date).toISOString()),e||(this.onRowsSelectionChange([]),this.scrollToTop()),this.setSelectedFilteredRowsCount(),this.dataLoaded.emit(),this.dataLoadContextSubject.next({associatedRecordId:this.state.associatedRecordId,associatedRoleName:this.state.associatedRoleName,filterExpression:this.state.filterExpression,namedFilterOptions:this.state.namedFilterOptions}),this.changeDetector.markForCheck()}),(0,r.catchError)(e=>(t(),(0,o.throwError)(e))))}getHeaders(){return{"Should-Query-All-Locales":this.state.showDataForAllLocales?"true":[]}}getNamedFilterOptionsState(e){return e.reduce((e,t)=>(t.predefinedFilterPresets&&(e[t.fieldId]=t.predefinedFilterPresets.sort((e,t)=>e.index-t.index)),e),{})}getProgrammaticActionButtons(e){return e.map(e=>{let t;return t=(0,m.isFunction)(e.disabled)||(0,m.isFunction)(e.hidden)?this.rowSelectionChanged.pipe((0,r.map)(t=>Object.assign(Object.assign({},e),{disabled:(0,m.isFunction)(e.disabled)?e.disabled(t):e.disabled,hidden:(0,m.isFunction)(e.hidden)?e.hidden(t):e.hidden}))):(0,o.of)(e),{guid:e.guid,config:t,runtimeViewModelApi:{triggerViewActions:(t,i)=>this.executeViewActions(e.guid,(0,m.get)(e,"actions"),this.state.lastActionRow)},factory:null,outlets:null}})}getRecordDefinition(){return this.state.getRecordDefinition?this.state.getRecordDefinition().pipe((0,r.tap)(e=>this.rxRecordDefinitionService.applyLocalization(e))):this.rxRecordDefinitionCacheService.getRecordDefinition(this.state.recordDefinitionName)}getRecordDefinitionName(){return this.state.recordDefinitionName}getSelectedRowCount(){return this.adaptTableConfig.selectedItems.length}getSelectedRows(e=!1){return e?(0,m.intersectionBy)(this.adaptTableConfig.data,this.adaptTableConfig.selectedItems,d.RowDataItemIdFieldName):this.adaptTableConfig.selectedItems}getTotalRowCount(){return this.getDataBase(null,!0)}getVirtualRowHeight(){var e;if(!(null===(e=this.adaptTableConfig.cardLayoutColumns)||void 0===e?void 0:e.length))return Nc.defaultRowHeight;return 32*this.visibleColumns.length+6}hasAssociationAndEmptyRecordId(){return Boolean(this.state.associationDefinitionName)&&!this.state.associatedRecordId}initActionButtons(){this.isProgrammaticUse?this.actionButtons=this.getProgrammaticActionButtons(this.state.actionButtons):this.actionButtons=(0,m.get)(this.runtimeViewCanvasItemComponent.getChildren(d.RX_VIEW_DEFINITION.defaultOutletName),"[0].children")}initAdvancedFilterTexts(){this.state.advancedFiltering.filterTexts={initialDropdownAnchorLabel:this.translateService.instant("com.bmc.arsys.rx.client.common.filter-data.label")}}initCustomTexts(){this.adaptTableConfig.texts={searchPlaceholder:this.state.searchFieldPlaceholderText,emptyStateLabelText:this.state.emptyStateLabelText,emptyStateWithFilterLabelText:this.state.emptyStateWithFilterLabelText,exportEntireDocument:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.export-all-rows.label"),exportSelected:this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.export-selected-rows.label")}}initGrid(){return this.state.guid=this.guid,(0,o.forkJoin)([this.rxGridConfiguratorService.getColumnsWithMetadata(this.guid,this.state.columns,this.state.recordDefinition),this.guid&&this.state.enableFiltering?this.getSharedFilterPresets():(0,o.of)(null)]).pipe((0,r.switchMap)(([e,t])=>(this.state.columnsWithMetadata=e,this.state.namedFilterOptions=this.getNamedFilterOptionsState(e),this.isUserAllowedToDeleteRecords=!!this.state.recordDefinition&&(!1!==this.state.recordDefinition.allowNonAdminToDeleteRecordInstances||this.rxCurrentUserService.isAdministrator()),this.notifyPropertyChanged("isUserAllowedToDeleteRecords",this.isUserAllowedToDeleteRecords),this.addAssociationFieldsToRecordDefinition(e),this.selectionFieldOptionLabelsByFieldId=this.rxGridConfiguratorService.getSelectionFieldOptionLabelsByFieldId(this.state.columns,this.state.recordDefinition),this.adaptTableConfig.columnResizeMode=this.state.expandable?A.ResizeMode.Expand:A.ResizeMode.Fit,this.adaptTableConfig.columns=this.getGridColumnDefinitions(e),this.state.advancedFiltering.recordGridFilterConfigs=this.rxRecordGridFilterConfigService.getConfigs(),this.state.advancedFiltering.filterOptions=this.getAdvancedFilterOptions(),this.state.advancedFiltering.filterOptions.push({id:Nc.externalPresetFilterOptionId,label:Nc.externalPresetFilterOptionId,dataType:u.AdvancedFilterOptionDataType.custom,isHidden:!0,customConfig:{getTagText:e=>{var t;return null===(t=this.state.advancedFiltering.savedFilters.find(t=>t.id===e))||void 0===t?void 0:t.name}}}),this.adaptTableConfig.rowSelectionMode=this.state.enableRowSelection,this.adaptTableConfig.primaryKey=this.state.recordIdField,this.adaptTableConfig.bordered=this.state.bordered,this.adaptTableConfig.striped=this.state.striped,this.adaptTableConfig.toolbarConfig.rightCustomSection=Boolean(this.state.enableRowSelection&&this.adaptTableConfig.data.length),this.state.initialFilters=this.rxRecordGridFilterHelperService.getRecordGridFilterDataFromPredefinedFilter(this.state.filters,this.state.recordGridFilters),this.clickableWithHrefColumnActions=(0,m.reduce)(e,(e,t)=>(t.clickableWithHref&&(e[t.fieldId]=t.actions),e),{}),(0,m.isEmpty)(this.clickableWithHrefColumnActions)||(this.clickableWithHrefActionExpressionEvaluationData={view:{components:{[this.guid]:{recordDefinition:this.state.recordDefinition}},inputParams:this.runtimeViewModelApi.getViewInputParameters()}}),this.guid?this.rxRecordGridUserPreferencesService.applyUserPreferences(this.adaptTableConfig,this.state.columnsWithMetadata,this.state,t):(0,o.of)(null))),(0,r.tap)(()=>{this.sortedColumnsByTitle=this.getSortedColumnsByTitle(),this.filteredVisibleColumns=this.sortedColumnsByTitle,this.visibleColumns=this.getVisibleColumns(),this.isFilterBySelectionButtonVisible=this.state.enableFiltering&&(0,m.some)(this.visibleColumns,"filterable"),this.initActionButtons(),this.initRowActionButtons(),this.state.viewPresetSelector||(this.avoidSystemColumnExpansion(),this.loadRowData()),this.updateToolbarTags(this.state.advancedFiltering.toolbarTags),this.updateAdaptTableFilters()}))}avoidSystemColumnExpansion(){if(this.adaptTableConfig.cardLayoutColumns)return void this.avoidSystemCardColumnExpansion();const e=[],t=[],i=(0,m.find)(this.adaptTableConfig.columns,{field:Nc.actionsColumnFieldDefinition.id,hidden:!1});let n=0,o=0,r=0;if(this.adaptTableConfig.columns.every(a=>{if(!a.hidden){if((0,m.isNil)(a.width))return!1;const s=parseFloat(a.width);a.width.endsWith("px")?(e.push(a),a!==i&&(n=Math.max(n,s))):(t.push(a),r+=s,a!==i&&(o=Math.max(o,s)))}return!0})&&r<100){const a=Boolean(t.length),s=Boolean(e.length);a&&!s&&t.forEach(e=>{e.width=`${(parseFloat(e.width)/r*100).toFixed(4)}%`}),!a&&s&&(1===e.length&&i?(i.width=null,i.minWidth=null):(0,m.findLast)(e,e=>parseInt(e.width)===n&&e!==i&&(e.width=null,e.minWidth=null,!0))),a&&s&&(1===t.length&&i?(i.width=null,i.minWidth=null):(0,m.findLast)(t,e=>parseFloat(e.width)===o&&e!==i&&(e.width=null,!0)))}}avoidSystemCardColumnExpansion(){if(!this.adaptDeviceDetectionService.iosPlatform())return;const e=this.adaptTable.dataHeaderCells.reduce((e,t)=>e+t.element.nativeElement.offsetWidth,0)-33;this.adaptTableConfig.cardLayoutColumns.forEach(t=>{t.width=`${(parseFloat(t.width)*e/100).toFixed(4)}px`})}initRecordDefinitions(){this.setRecordDefinition(null),this.state.associationDescriptors=[];const e=(0,m.some)(this.state.columns,e=>this.rxRecordGridUtilsService.isAssociatedRecordFieldId(e.fieldId));return(0,o.forkJoin)([this.getRecordDefinition(),e?this.getAssociationDescriptors():(0,o.of)([])]).pipe((0,r.tap)(([e,t])=>{this.setRecordDefinition(e),this.state.associationDescriptors=t}),(0,r.map)(([e])=>e))}initRowActionButtons(){this.isProgrammaticUse?this.rowActionButtons=this.getProgrammaticActionButtons(this.state.rowActionButtons):this.rowActionButtons=(0,m.get)(this.runtimeViewCanvasItemComponent.getChildren(Nc.rowActionsOutletName),"[0].children")}isDownloadableAttachmentColumn(e){const t=(0,m.get)(this.state.recordDefinition,"resourceType"),i=(0,m.get)(e,"fieldDefinition.resourceType");return!this.isProgrammaticUse&&(t===a.RX_RECORD_DEFINITION.recordDefinitionTypes.regular.recordDefinitionType||t===a.RX_RECORD_DEFINITION.recordDefinitionTypes.join.recordDefinitionType)&&i===a.RX_RECORD_DEFINITION.dataTypes.attachment.resourceType}isRangeFilter(e){const t=[a.RX_RECORD_DEFINITION.dataTypes.dateOnly.resourceType,a.RX_RECORD_DEFINITION.dataTypes.dateTime.resourceType,a.RX_RECORD_DEFINITION.dataTypes.timeOnly.resourceType,a.RX_RECORD_DEFINITION.dataTypes.integer.resourceType,a.RX_RECORD_DEFINITION.dataTypes.decimal.resourceType,a.RX_RECORD_DEFINITION.dataTypes.real.resourceType],i=this.state.recordDefinition.fieldDefinitionsById[e];return(0,m.includes)(t,i.resourceType)}isSharedFilterPreset(e){return Boolean(e.filterExpression)}loadRowData(e){this.getGridData(e).subscribe()}openSortByDialogFn(e){return this.cardLayoutOpenedModal=this.adaptModalService.open(e),this.cardLayoutOpenedModal}prepareQueryParamsAndQueryArgs(e){const t=this.adaptTableConfig.primaryKey,i=Object.assign(Object.assign({},this.getBaseDataPageParams()),{shouldIncludeTotalSize:e,pageSize:e?0:this.adaptTableConfig.rows,startIndex:e?0:this.adaptTableConfig.first});this.cursor&&!e&&(i.cursor=this.cursor),e||(i.propertySelection=(0,m.chain)(this.adaptTableConfig.columns.filter(e=>!e.isRowActionsColumn&&(this.state.getDataForHiddenColumns||!e.hidden||e.referenced)).map(e=>e.field)).union([t]).value());const n=this.adaptTableConfig.multiSortMeta;!e&&n&&n.length&&(i.sortBy=n.map(e=>e.order===A.SortOrder.Asc?`${e.field}`:`-${e.field}`));const o=(0,m.get)(this.adaptTableConfig.filters,"global.value","").toString().trim(),r=this.rxRecordGridFilterService.generateTextFilterQuery(o,this.adaptTableConfig.columns),a=this.state.advancedFiltering.appliedSharedFilterPreset,s=a&&a.filterExpression?`(${a.filterExpression})`:null,l=this.rxRecordGridFilterService.addQueries(this.rxRecordGridFilterService.getQueryFromRecordGridFilterData(this.state.initialFilters,this.state.recordDefinition.fieldDefinitionsById),this.buildQueryByAdvancedFilters(this.state.advancedFiltering.selectedFilters),r,this.state.filterExpression,s);return l&&(i.queryExpression=l),i}refresh(){return this.initializationCompleted$.pipe((0,r.switchMap)(()=>this.getGridData()),(0,r.switchMapTo)(o.EMPTY))}saveViewPreset(e){return this.rxRecordGridUserPreferencesService.saveViewPreset(e),this.userPreferencesChanged$.next(),o.EMPTY}scrollToTop(){if(this.adaptTable){const e=this.adaptTable.getScrollableBodyElement();e&&(e.scrollTop=0)}}setFilter(e){this.state.advancedFiltering.selectedFilters=e}setRecordDefinition(e){this.state.recordDefinition=(0,m.cloneDeep)(e),e&&(this.state.recordDefinition.fieldDefinitionsById=this.rxRecordDefinitionService.buildFieldDefinitionsByIdMap(this.state.recordDefinition)),this.notifyPropertyChanged("recordDefinition",this.state.recordDefinition)}setSelectedFilteredRowsCount(){this.selectedFilteredRowsCount=this.adaptTable.hasFilter()?this.getSelectedRows().length:0}sortRows(e){e.sort((e,t)=>this.compareRows(e,t)),(0,m.forEach)(e,e=>{var t;(null===(t=e.items)||void 0===t?void 0:t.length)&&this.sortRows(e.items)})}toggleCellSelection(e,t,i,n){if(this.state.enableFiltering)if(n){const n=e.filter(e=>{const t=this.state.recordDefinition.fieldDefinitionsById[e.field],i=t.resourceType===a.RX_RECORD_DEFINITION.dataTypes.boolean.resourceType&&this.rxFieldDefinitionService.isRequiredField(t);return e.filterable&&!i}),o=this.isCellSelected(i);(0,m.forEach)(n,e=>{if(e.filterable){const i=t[e.field]||0===t[e.field]?t[e.field]:"$NULL$";this.state.advancedFiltering.selectedCardValues[e.field]?o?(0,m.remove)(this.state.advancedFiltering.selectedCardValues[e.field],i):this.state.advancedFiltering.selectedCardValues[e.field].push(i):this.state.advancedFiltering.selectedCardValues[e.field]=[i]}})}else{const n=e[0];if(n.filterable){const e=(0,m.find)(this.state.advancedFiltering.pendingSelectedFilters,{filterOptionId:n.field}),o=t[n.field]||0===t[n.field]?t[n.field]:"$NULL$",r=this.state.recordDefinition.fieldDefinitionsById[n.field],s=this.isRangeFilter(n.field),l=r.resourceType===a.RX_RECORD_DEFINITION.dataTypes.boolean.resourceType&&this.rxFieldDefinitionService.isRequiredField(r),d=!(s&&e&&2===e.value.length||l&&e||"$NULL$"===o&&(s||l));if(e)if(this.isCellSelected(i)){const t=(0,m.findIndex)(e.value,o);e.value.splice(t,1),this.trackPopoverAnchor(i),e.value.length||(0,m.remove)(this.state.advancedFiltering.pendingSelectedFilters,e)}else d&&(e.value.push(o),this.trackPopoverAnchor(i));else if(d){const e={filterOptionId:n.field,value:[o]};this.state.advancedFiltering.pendingSelectedFilters.push(e),this.trackPopoverAnchor(i)}}}}trackPopoverAnchor(e){var t,i;if(this.isCellSelected(e)){const i=e===(0,m.last)(this.popovers);(0,m.remove)(this.popovers,e),i&&(e.close(),null===(t=(0,m.last)(this.popovers))||void 0===t||t.open())}else null===(i=(0,m.last)(this.popovers))||void 0===i||i.close(),this.popovers.push(e),e.open()}updateAdaptTableFilters(){const e=this.adaptTable.filters.global;this.adaptTable.filters=this.areUserFiltersApplied()?{dummyFilter:{}}:{},e&&(this.adaptTable.filters.global=e)}updateToolbarItems(){if(this.adaptTable){const e=this.adaptTable.toolbarComponent,t=e.toolbarContentItems.find(e=>e.adaptToolbarItem===A.ToolbarItemsByPriority.FILTER);setTimeout(()=>{t&&!t.itemContext.hidden&&e.updateToolbarItems()})}}getExportSelectedText(e){return e.length>1?this.exportSelectedRowsText:this.exportSelectedRowText}getFiltersRequiredMessage(e){return e>1?this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.require-filtering.missing-filters-warning.message",{requiredFiltersCount:e}):this.translateService.instant("com.bmc.arsys.rx.client.view-components.record-grid.require-filtering.missing-filter-warning.message")}}om.\u0275fac=function(e){return new(e||om)(n["\u0275\u0275directiveInject"](u.AdaptDeviceDetectionService),n["\u0275\u0275directiveInject"](u.AdaptModalService),n["\u0275\u0275directiveInject"](n.ChangeDetectorRef),n["\u0275\u0275directiveInject"](f.DatePipe),n["\u0275\u0275directiveInject"](f.DecimalPipe),n["\u0275\u0275directiveInject"](n.NgZone),n["\u0275\u0275directiveInject"](C.RxAssociationInstanceDataPageService),n["\u0275\u0275directiveInject"](s.RxBooleanPipe),n["\u0275\u0275directiveInject"](s.RxCurrentUserService),n["\u0275\u0275directiveInject"](d.RxExpressionEvaluatorService),n["\u0275\u0275directiveInject"](a.RxFieldDefinitionService),n["\u0275\u0275directiveInject"](Yp),n["\u0275\u0275directiveInject"](v.RxGuidService),n["\u0275\u0275directiveInject"](s.RxLogService),n["\u0275\u0275directiveInject"](s.RxNotificationService),n["\u0275\u0275directiveInject"](v.RxObjectUtilsService),n["\u0275\u0275directiveInject"](a.RxRecordDefinitionCacheService),n["\u0275\u0275directiveInject"](a.RxRecordDefinitionService),n["\u0275\u0275directiveInject"](ap),n["\u0275\u0275directiveInject"](Lc),n["\u0275\u0275directiveInject"](dp),n["\u0275\u0275directiveInject"](lp),n["\u0275\u0275directiveInject"](sp),n["\u0275\u0275directiveInject"](Zp),n["\u0275\u0275directiveInject"](em),n["\u0275\u0275directiveInject"](kc),n["\u0275\u0275directiveInject"](a.RxRecordInstanceDataPageService),n["\u0275\u0275directiveInject"](a.RxRecordInstanceService),n["\u0275\u0275directiveInject"](d.RxViewActionService),n["\u0275\u0275directiveInject"](d.RxViewActionUtilsService),n["\u0275\u0275directiveInject"](p.TranslateService),n["\u0275\u0275directiveInject"](n.ElementRef),n["\u0275\u0275directiveInject"](v.RxStringService),n["\u0275\u0275directiveInject"](s.RxGlobalEventsService),n["\u0275\u0275directiveInject"](Jp,8),n["\u0275\u0275directiveInject"](h.RuntimeViewCanvasItemComponent,8))},om.\u0275cmp=n["\u0275\u0275defineComponent"]({type:om,selectors:[["rx-record-grid"]],viewQuery:function(e,t){if(1&e&&(n["\u0275\u0275viewQuery"](Ir,7),n["\u0275\u0275viewQuery"](Fr,5),n["\u0275\u0275viewQuery"](Er,7),n["\u0275\u0275viewQuery"](Mr,7),n["\u0275\u0275viewQuery"](gr,7),n["\u0275\u0275viewQuery"](Ar,7),n["\u0275\u0275viewQuery"](Or,7),n["\u0275\u0275viewQuery"](Pr,7),n["\u0275\u0275viewQuery"](vr,7),n["\u0275\u0275viewQuery"](yp,7),n["\u0275\u0275viewQuery"](ws,5)),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.adaptTable=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.adaptAdvancedFilter=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.cardLayoutRowDetailsTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.cellTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.filterTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.leftCustomSectionTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.rightCustomSectionTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.rowActionButtonsTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.visibleColumnsMenuTemplate=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.fieldsProvider=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.actionButtonComponents=e)}},hostBindings:function(e,t){1&e&&n["\u0275\u0275listener"]("click",function(e){return t.onClickOutside(e)},!1,n["\u0275\u0275resolveDocument"])},inputs:{config:"config"},outputs:{dataLoaded:"dataLoaded"},features:[n["\u0275\u0275ProvidersFeature"]([em]),n["\u0275\u0275InheritDefinitionFeature"]],decls:31,vars:40,consts:[["rxCardLayout","","scrollHeight","flex",3,"cardLayoutWidth","cardLayoutFieldsHeaderTemplate","cardLayoutFieldsDataCellTemplate","cardLayoutValuesDataCellTemplate","cardLayoutValuesHeaderTemplate","cardLayoutRecordGridElementRef","cardLayoutGetDataCellClass","value","columns","rows","first","scrollable","sortable","rowExpandMode","sortMode","resizableColumns","columnResizeMode","selectionMode","selection","toolbarConfig","filterable","filters","multiSortMeta","dataKey","bordered","totalRecords","totalRecordsInGroup","lazy","lazyLoadOnInit","loading","enableInfiniteScrolling","expandedGroupsKeys","loadingMore","suppressTooltip","virtualScroll","virtualRowHeight","striped","texts","selectedFilteredRowsCount","headerSelectionMode","changedCardLayout","selectionChange","onSort","onLazyLoad","onColReorder","onColResize","export","onHeaderCheckboxToggle"],["adaptTable",""],["visibleColumnsMenuTemplate",""],["rightCustomSectionTemplate",""],["leftCustomSectionTemplate",""],["filterTemplate",""],["cellTemplate",""],["defaultCellTemplate",""],["cardLayoutFieldsHeaderTemplate",""],["cardLayoutValuesHeaderTemplate",""],["cardLayoutFieldsDataCellTemplate",""],["cardLayoutValuesDataCellTemplate",""],["cardLayoutRowDetailsTemplate",""],["filterButton",""],["rowActionButtonsTemplate",""],["cardLayoutRowActionButtonsTemplate",""],[3,"namedFilterOptionsGetter"],[3,"ngModel","placeholder","autofocus","ngModelChange"],["class","dropdown-item visible-columns-item px-3",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[3,"type","label",4,"ngIf"],[1,"dropdown-item","visible-columns-item","px-3",3,"click"],[1,"m-0","adapt-table-toolbar__column-visibility-control",3,"label","ngModel","ngModelChange"],[3,"type","label"],["rx-id","selected-row-count",1,"px-2"],[4,"ngIf"],[1,"d-flex","align-items-center"],["type","button",1,"btn","btn-link","p-0","mx-1",3,"click"],["class","pl-1 w-100 align-items-center",3,"adaptSubnav",4,"ngIf"],[1,"pl-1","w-100","align-items-center",3,"adaptSubnav"],[3,"adaptSubnavItem",4,"ngFor","ngForOf"],[3,"adaptSubnavDropdown"],["type","button",1,"btn","btn-secondary","btn-xs","d-icon-triangle_down","ml-1"],[3,"adaptSubnavItem"],["actionButtonTemplate",""],[1,"m-1",3,"guid","config","runtimeViewModelApi"],["type","button","rx-id","refresh-button",1,"btn","btn-link","d-icon-refresh","grid-toolbar-icon","ml-2","p-1",3,"ngClass","click"],["class","ml-2",3,"ngClass","appendDropdownToBody","texts","showAnchorButtonLabel","filterOptions","selectedFilters","savedFilters","enableSavedFilters","activeSavedFilter","isLoading","selectedFiltersIndicationStyle","applyFiltersByUserAction","selectedFiltersChange","deleteSavedFilter","createNewFilter","updateSavedFilter","activeSavedFilterChange","beforeActiveSavedFilterChange","editSavedFilterClick","filterExpressionTagsChanged",4,"ngIf"],["class","btn-link ml-1",4,"ngIf"],[1,"ml-2",3,"hidden","tags","tagsLimit","removeTag"],[1,"ml-2",3,"ngClass","appendDropdownToBody","texts","showAnchorButtonLabel","filterOptions","selectedFilters","savedFilters","enableSavedFilters","activeSavedFilter","isLoading","selectedFiltersIndicationStyle","applyFiltersByUserAction","selectedFiltersChange","deleteSavedFilter","createNewFilter","updateSavedFilter","activeSavedFilterChange","beforeActiveSavedFilterChange","editSavedFilterClick","filterExpressionTagsChanged"],["adaptAdvancedFilter",""],[1,"btn-link","ml-1"],["class","rx-custom-cell rx-ellipsis",3,"rxCellDisplayProps","rxCellDisplayPropsBadgeElem","rxCellDisplayPropsDataItem","adaptPopover","autoClose","popoverClass","triggers","appendToBody","placement","rx-selected-custom-cell","click","mouseover",4,"ngIf"],["class","rx-custom-cell rx-ellipsis",3,"adaptPopover","autoClose","popoverClass","triggers","appendToBody","placement","rx-selected-custom-cell","click","mouseover",4,"ngIf"],[1,"rx-custom-cell","rx-ellipsis",3,"rxCellDisplayProps","rxCellDisplayPropsBadgeElem","rxCellDisplayPropsDataItem","adaptPopover","autoClose","popoverClass","triggers","appendToBody","placement","click","mouseover"],["popoverAnchor","adaptPopover"],[3,"ngClass","click"],["badgeElem",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"rx-custom-cell","rx-ellipsis",3,"adaptPopover","autoClose","popoverClass","triggers","appendToBody","placement","click","mouseover"],["tabindex","0","class","attachment-link",3,"click","keydown",4,"ngIf"],["tabindex","0","class","no-href-link",3,"click","keydown",4,"ngIf"],[3,"routerLink","queryParams",4,"ngIf"],[3,"href","target",4,"ngIf"],[3,"ngClass"],["tabindex","0",1,"attachment-link",3,"click","keydown"],["tabindex","0",1,"no-href-link",3,"click","keydown"],[3,"routerLink","queryParams"],[3,"href","target"],[3,"title","columns","adaptTable","openDialog","sort"],[1,"rx-card-layout-cell",3,"click"],["class","rx-card-layout-cell-item",4,"ngFor","ngForOf","ngForTrackBy"],[1,"rx-card-layout-cell-item"],[1,"rx-card-layout-cell-values","rx-card-layout-cell"],["adapt-button","","rx-id","filter-by-selection-button","class","btn btn-link d-icon-filter_adapt filter-by-selection-icon",3,"click",4,"ngIf"],["rx-id","show-record-details-button",1,"btn","btn-link","d-icon-pop_up","record-details-icon",3,"click"],["adapt-button","","rx-id","filter-by-selection-button",1,"btn","btn-link","d-icon-filter_adapt","filter-by-selection-icon",3,"click"],[1,"modal-body","rx-record-details"],["class","row mb-3",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"row","mb-3"],[1,"col-sm-4","font-weight-bold","rx-text-break"],["class","col-sm-8 rx-text-break",4,"ngIf"],["class","col-sm-8",4,"ngIf"],[1,"col-sm-8","rx-text-break"],[1,"col-sm-8"],["tabindex","0",1,"row-details-attachment-link",3,"click","keydown"],["adapt-button","","btn-type","tertiary","size","small",1,"d-icon-filter_adapt","p-0",3,"click"],["adaptDropdown","","appendToBody","true",1,"dropdown","dropdown-kabob",3,"onOpen"],["id","row-actions-dropdown-button","adaptDropdownToggle","",1,"dropdown-kabob-btn"],["aria-labelledby","row-actions-dropdown-button","adaptDropdownMenu","",1,"dropdown-menu"],["class","action-button-list",3,"guid","config","runtimeViewModelApi",4,"ngFor","ngForOf"],[1,"empty-list-label","pl-3"],[1,"action-button-list",3,"guid","config","runtimeViewModelApi"],["adaptDropdown","","appendToBody","true",1,"dropdown","mb-1",3,"click","onOpen"],["id","card-layout-dropdown-button","size","xtra-small","adaptDropdownToggle","",1,"btn","btn-secondary","btn-xs"],["aria-labelledby","card-layout-dropdown-button","adaptDropdownMenu","",1,"dropdown-menu"],["class","row-actions-dropdown-item",3,"guid","config","runtimeViewModelApi",4,"ngFor","ngForOf"],[1,"row-actions-dropdown-item",3,"guid","config","runtimeViewModelApi"]],template:function(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"adapt-table",0,1),n["\u0275\u0275listener"]("changedCardLayout",function(e){return t.onChangedCardLayout(e)})("selectionChange",function(e){return t.onRowsSelectionChange(e)})("onSort",function(e){return t.onSort(e)})("onLazyLoad",function(e){return t.onLazyLoad(e)})("onColReorder",function(e){return t.onColReorder(e)})("onColResize",function(){return t.onColumnResize()})("export",function(e){return t.onExport(e)})("onHeaderCheckboxToggle",function(e){return t.handleHeaderCheckboxToggle(e)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](2,Nr,4,8,"ng-template",null,2,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](4,_r,3,2,"ng-template",null,3,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](6,Gr,1,1,"ng-template",null,4,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](8,Wr,5,11,"ng-template",null,5,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](10,ea,2,2,"ng-template",null,6,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](12,aa,5,5,"ng-template",null,7,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](14,sa,1,4,"ng-template",null,8,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](16,la,1,4,"ng-template",null,9,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](18,ca,2,2,"ng-template",null,10,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](20,ba,5,6,"ng-template",null,11,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](22,Ra,6,4,"ng-template",null,12,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](24,Ia,1,0,"ng-template",null,13,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](26,Ea,7,4,"ng-template",null,14,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](28,Aa,6,4,"ng-template",null,15,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275element"](30,"rx-advanced-filtering-fields-provider",16)),2&e){const e=n["\u0275\u0275reference"](15),i=n["\u0275\u0275reference"](17),o=n["\u0275\u0275reference"](19),r=n["\u0275\u0275reference"](21);n["\u0275\u0275property"]("cardLayoutWidth",t.state.cardLayoutWidth)("cardLayoutFieldsHeaderTemplate",e)("cardLayoutFieldsDataCellTemplate",o)("cardLayoutValuesDataCellTemplate",r)("cardLayoutValuesHeaderTemplate",i)("cardLayoutRecordGridElementRef",t.elementRef)("cardLayoutGetDataCellClass",t.getDataCellClassBind)("value",t.adaptTableConfig.data)("columns",t.adaptTableConfig.cardLayoutColumns||t.adaptTableConfig.columns)("rows",t.adaptTableConfig.rows)("first",t.adaptTableConfig.first)("scrollable",t.adaptTableConfig.scrollable)("sortable",!0)("sortMode","multiple")("resizableColumns",!0)("columnResizeMode",t.adaptTableConfig.columnResizeMode)("selectionMode",t.adaptTableConfig.rowSelectionMode)("selection",t.adaptTableConfig.selectedItems)("toolbarConfig",t.adaptTableConfig.toolbarConfig)("filterable",t.adaptTableConfig.filterable)("filters",t.adaptTableConfig.filters)("multiSortMeta",t.adaptTableConfig.multiSortMeta)("dataKey",t.adaptTableConfig.primaryKey)("bordered",t.adaptTableConfig.bordered)("totalRecords",t.adaptTableConfig.totalRecords)("totalRecordsInGroup",t.state.expandGroups?t.adaptTableConfig.totalRecords:0)("lazy",!0)("lazyLoadOnInit",!1)("loading",t.adaptTableConfig.isLoadingData)("enableInfiniteScrolling",!0)("expandedGroupsKeys",t.adaptTableConfig.expandedGroupsKeys)("loadingMore",t.adaptTableConfig.isLoadingMoreData)("suppressTooltip",!1)("virtualScroll",t.adaptTableConfig.virtualScroll)("virtualRowHeight",t.adaptTableConfig.virtualRowHeight)("striped",t.adaptTableConfig.striped)("texts",t.adaptTableConfig.texts)("selectedFilteredRowsCount",t.selectedFilteredRowsCount)("headerSelectionMode",t.adaptTableHeaderSelectionMode),n["\u0275\u0275advance"](30),n["\u0275\u0275property"]("namedFilterOptionsGetter",t.getNamedFilterOptions)}},directives:[A.AdaptTableComponent,im,yp,u.AdaptRxSearchComponent,b.NgControlStatus,b.NgModel,f.NgForOf,f.NgIf,u.AdaptRxCheckboxComponent,u.AdaptEmptyStateComponent,u.AdaptSubnavComponent,u.AdaptSubnavDropdownComponent,u.AdaptSubnavItemComponent,ws,f.NgClass,xp,u.AdaptAdvancedFilterComponent,nm,u.AdaptPopoverDirective,f.NgTemplateOutlet,P.RouterLinkWithHref,tm,u.AdaptButtonComponent,u.AdaptDropdownDirective,u.AdaptDropdownToggleDirective,u.AdaptDropdownMenuDirective],pipes:[p.TranslatePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{display:block;height:420px}[_nghost-%COMP%]     .rx-table-card-layout .adapt-selection-cell{vertical-align:middle!important}[_nghost-%COMP%]     .rx-table-card-layout .c-header-name{width:100%}[_nghost-%COMP%]     .rx-card-layout-data-cell{position:relative}[_nghost-%COMP%]     .rx-card-layout-cell-item{padding:0;line-height:32px;min-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}[_nghost-%COMP%]     .rx-card-layout-cell-values>div:first-child .rx-card-layout-cell-item{padding-right:20px}[_nghost-%COMP%]     .rx-card-layout-cell-icon, [_nghost-%COMP%]     .filter-by-selection-icon, [_nghost-%COMP%]     .record-details-icon{top:2px;padding:2px;position:absolute}[_nghost-%COMP%]     .record-details-icon{right:7px}[_nghost-%COMP%]     .filter-by-selection-icon{right:25px}[_nghost-%COMP%]     adapt-table td.at-data-cell{padding:0;-moz-user-select:text}[_nghost-%COMP%]     adapt-table td.rx-cell-selection-mode:focus{outline:none!important}[_nghost-%COMP%]     adapt-table adapt-table-toolbar rx-action-button{margin:5px}[_nghost-%COMP%]     adapt-table adapt-table-toolbar rx-action-button .btn-link{padding-right:0;padding-left:0}[_nghost-%COMP%]     adapt-table .at-wrap-cell-text .at-data-cell{word-break:break-word}[_nghost-%COMP%]     .rx-row-action-cell .dropdown{margin-top:3px}.rx-custom-cell[_ngcontent-%COMP%]{min-height:36px;padding:.5rem 13px}.rx-custom-cell[_ngcontent-%COMP%]   .rx-cell-wrap[_ngcontent-%COMP%]{white-space:normal;text-overflow:clip;word-break:break-word}.rx-selected-custom-cell[_ngcontent-%COMP%]{outline:1px solid #00a79d!important;border-color:transparent!important;outline-offset:-1px}.rx-card-layout-cell[_ngcontent-%COMP%]{padding:3px 10px}[_nghost-%COMP%]     .dropdown-menu rx-action-button button.btn{width:100%;text-align:left;background:none;border:0;font-size:.8125rem}[_nghost-%COMP%]     .dropdown-menu rx-action-button button.btn:before{width:18px}[_nghost-%COMP%]     .dropdown-menu rx-action-button button.btn>span{margin-left:18px}[_nghost-%COMP%]     .dropdown-menu rx-action-button button.btn[class^=d-icon-left]>span{margin-left:0!important}.grid-toolbar-icon[_ngcontent-%COMP%]{font-size:16px}.no-href-link[_ngcontent-%COMP%]{cursor:pointer;text-decoration:none}.attachment-link[_ngcontent-%COMP%], .row-details-attachment-link[_ngcontent-%COMP%]{cursor:pointer}  .table-filtering.popover.popover-mobile{height:auto;display:block;top:auto!important;bottom:0;width:100vw}  .table-filtering.popover.popover-mobile .a-popover-wrap{margin:0}  .table-filtering.popover.popover-mobile .close{display:none}  .visible-columns-dropdown{padding-top:0;width:14rem}.action-button-list[_ngcontent-%COMP%]:not(:empty) ~ .empty-list-label[_ngcontent-%COMP%]{display:none}.empty-list-label[_ngcontent-%COMP%]{color:#959899}.visible-columns-item[_ngcontent-%COMP%]{white-space:normal;word-break:break-word}']});class rm{constructor(e,t,i){this.viewDefinitionParserService=e,this.rxJsonParserService=t,this.rxRecordGridConfigUtilsService=i}adaptDefinition(e,t){const i=e.componentDefinitions.filter(({type:e})=>e===Nc.components.column).map(({propertiesByName:e})=>e.cellDisplayProperties).filter(Boolean);this.viewDefinitionParserService.getComponents(e).map(e=>e.componentDefinition).forEach(n=>{var o,r,a,s;switch(n.type){case Nc.type:{n.propertiesByName.enableFilterPresets=null!==(o=n.propertiesByName.enableFilterPresets)&&void 0!==o?o:"true",n.propertiesByName.requiredFilters=null!==(r=n.propertiesByName.requiredFilters)&&void 0!==r?r:"true"===n.propertiesByName.requireFiltering?1:0;const e=this.rxJsonParserService.tryParseJson(n.layout),t=(0,m.filter)(n.componentDefinitions,{type:d.RxViewComponentType.ActionButton}),i=this.getActionButtonsForOutlet(e,Nc.rowActionsOutletName,t);i.forEach(e=>{e.propertiesByName=Object.assign(Object.assign({},e.propertiesByName),{cls:"dropdown-item",styles:"p-0"})}),(0,m.without)(t,...i).forEach(e=>{[us.Primary,us.Secondary].includes(e.propertiesByName.style)&&(e.propertiesByName.size=hs.Small)});break}case Nc.components.column:{let o=null;if(!this.rxRecordGridConfigUtilsService.getBooleanValue(e.propertiesByName.getDataForHiddenColumns)){const r=e.guid,a=n.propertiesByName.fieldId,s=t.viewComponentExpressions.some(e=>e.includes(`\${view.components.${r}.firstSelectedRow.${a}`)||e.includes(`\${view.components.${r}.clickableRow.${a}`)),l=i.some(e=>e.includes(`\${view.components.grid.clickableRow.${a}`));o=s||l}const r={actions:[],clickable:!1,guid:n.guid,wrapText:null!==(a=n.propertiesByName.wrapText)&&void 0!==a&&a,referenced:o,typeaheadKeystrokeCount:null!==(s=n.propertiesByName.typeaheadKeystrokeCount)&&void 0!==s?s:Nc.defaultTypeaheadKeystrokeCount},l=(0,m.filter)(n.componentDefinitions,{type:"rx-action"}).map(e=>e.propertiesByName);l.length&&(r.clickable=!0,r.actions=l),Object.assign(n.propertiesByName,r);break}case Nc.components.filterPreset:case Nc.components.filter:Object.assign(n.propertiesByName,{guid:n.guid})}})}getActionButtonsForOutlet(e,t,i){const n=(0,m.chain)(e.outlets).filter({name:t}).head().get("columns[0].children",[]).value();return(0,m.filter)(i,e=>n.includes(e.guid))}}rm.\u0275fac=function(e){return new(e||rm)(n["\u0275\u0275inject"](d.RxViewDefinitionParserService),n["\u0275\u0275inject"](v.RxJsonParserService),n["\u0275\u0275inject"](Lc))},rm.\u0275prov=n["\u0275\u0275defineInjectable"]({token:rm,factory:rm.\u0275fac});class am extends d.RxRecordQueryExpressionEvaluatorService{}am.\u0275fac=function(){let e;return function(t){return(e||(e=n["\u0275\u0275getInheritedFactory"](am)))(t||am)}}(),am.\u0275prov=n["\u0275\u0275defineInjectable"]({token:am,factory:am.\u0275fac});class sm{constructor(e,t){this.rxRecordGridDefinitionAdapterService=e,this.rxDefinitionAdapterRegistryService=t,t.registerRuntimeAdapter(Nc.type,this.rxRecordGridDefinitionAdapterService)}}sm.\u0275fac=function(e){return new(e||sm)(n["\u0275\u0275inject"](rm),n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService))},sm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:sm,declarations:[om,im,tm,Kp,nm],imports:[s.RxDefinitionModule,f.CommonModule,h.RuntimeViewCanvasModule,A.AdaptTableModule,F.AdaptSelectModule,b.FormsModule,u.AdaptRxCheckboxModule,u.AdaptRxSelectModule,u.AdaptAlertModule,u.AdaptPopoverModule,u.AdaptAccordionModule,u.AdaptButtonModule,u.AdaptDropdownModule,p.TranslateModule,Ds,u.AdaptSubnavModule,u.AdaptAdvancedFilteringModule,wp,P.RouterModule,Ap,u.AdaptRxSearchModule,u.AdaptEmptyStateModule],exports:[om]}),sm.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[f.DatePipe,f.DecimalPipe,s.RxBooleanPipe,Yp,Lc,rm,lp,kc,dp,am,Zp,ap],imports:[[s.RxDefinitionModule,f.CommonModule,h.RuntimeViewCanvasModule,A.AdaptTableModule.forRoot(),F.AdaptSelectModule,b.FormsModule,u.AdaptRxCheckboxModule,u.AdaptRxSelectModule,u.AdaptAlertModule.forRoot(),u.AdaptPopoverModule.forRoot(),u.AdaptAccordionModule,u.AdaptButtonModule,u.AdaptDropdownModule,p.TranslateModule,Ds,u.AdaptSubnavModule,u.AdaptAdvancedFilteringModule,wp,P.RouterModule,Ap,u.AdaptRxSearchModule,u.AdaptEmptyStateModule]]});class lm extends h.BaseViewComponent{constructor(e,t){super(),this.sanitizer=e,this.rxCkEditorConfiguratorService=t,this.filter=new CKEDITOR.filter(""),this.api={setProperty:this.setProperty.bind(this)},this.filter.allow(this.rxCkEditorConfiguratorService.getContentRules())}ngOnInit(){super.ngOnInit(),this.notifyPropertyChanged("api",this.api),this.config.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.isHidden=Boolean(e.hidden),this.html=this.updateHtml(e.html)})}updateHtml(e){if(e){e=e.replace(/\n/g,"<br>");const t=CKEDITOR.htmlParser.fragment.fromHtml(e),i=new CKEDITOR.htmlParser.basicWriter;this.filter.applyTo(t),t.writeHtml(i),e=i.getHtml(!0)}else e="";return this.sanitizer.bypassSecurityTrustHtml(e)}setProperty(e,t){if("hidden"!==e)return(0,o.throwError)(`Rich text: property ${e} is not settable.`);this.isHidden=t,this.notifyPropertyChanged(e,this.isHidden)}}lm.\u0275fac=function(e){return new(e||lm)(n["\u0275\u0275directiveInject"](T.DomSanitizer),n["\u0275\u0275directiveInject"](d.RxCkEditorConfiguratorService))},lm.\u0275cmp=n["\u0275\u0275defineComponent"]({type:lm,selectors:[["rx-rich-text"]],inputs:{config:"config"},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:3,consts:[["tabindex","0",1,"text-container","focusable",3,"hidden","innerHTML"]],template:function(e,t){1&e&&n["\u0275\u0275element"](0,"div",0),2&e&&(n["\u0275\u0275property"]("hidden",t.isHidden)("innerHTML",t.html,n["\u0275\u0275sanitizeHtml"]),n["\u0275\u0275attribute"]("aria-hidden",t.isHidden))},styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.text-container[_ngcontent-%COMP%]{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}']});class dm{constructor(e){this.rxDefaultExpressionEvaluatorService=e}evaluate(e,t){const i=document.createElement("div");return i.innerHTML=e,i.querySelectorAll(`span[${d.RX_RICH_TEXT.expressionAttributeName}]`).forEach(e=>{const i=this.rxDefaultExpressionEvaluatorService.evaluate(e.getAttribute(d.RX_RICH_TEXT.expressionAttributeName),t),n=document.createTextNode((0,m.isNil)(i)?"":i);e.parentElement.replaceChild(n,e)}),i.innerHTML}}dm.\u0275fac=function(e){return new(e||dm)(n["\u0275\u0275inject"](d.RxDefaultExpressionEvaluatorService))},dm.\u0275prov=n["\u0275\u0275defineInjectable"]({token:dm,factory:dm.\u0275fac});class cm{constructor(e){this.rxCkEditorConfiguratorService=e,this.filter=new CKEDITOR.filter(""),this.filter.allow(this.rxCkEditorConfiguratorService.getContentRules())}adaptDefinition(e){if(e.propertiesByName.html){const t=CKEDITOR.dtd.$removeEmpty.span;CKEDITOR.dtd.$removeEmpty.span=0;const i=CKEDITOR.htmlParser.fragment.fromHtml(e.propertiesByName.html),n=new CKEDITOR.htmlParser.basicWriter;this.filter.applyTo(i),i.writeHtml(n),e.propertiesByName.html=n.getHtml(!0),CKEDITOR.dtd.$removeEmpty.span=t}}}cm.\u0275fac=function(e){return new(e||cm)(n["\u0275\u0275inject"](d.RxCkEditorConfiguratorService))},cm.\u0275prov=n["\u0275\u0275defineInjectable"]({token:cm,factory:cm.\u0275fac});class pm{constructor(e,t){this.rxDefinitionAdapterRegistryService=e,this.richTextDefinitionAdapterService=t,e.registerRuntimeAdapter(d.RxViewComponentType.RichText,this.richTextDefinitionAdapterService)}}pm.\u0275fac=function(e){return new(e||pm)(n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService),n["\u0275\u0275inject"](cm))},pm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:pm,declarations:[lm],imports:[f.CommonModule,M.CKEditorModule],exports:[lm]}),pm.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[dm],imports:[[f.CommonModule,M.CKEditorModule]]});const mm={title:!1,skin:"rich-text,skins/rich-text/",toolbar:[["Bold","Italic","Strike","Underline","-","Link","Unlink","-","NumberedList","BulletedList","Outdent","Indent","-","JustifyLeft","JustifyCenter","JustifyRight","-","ExpressionEditor"],"/",["Format","Styles","Font","FontSize","TextColor"]],stylesSet:[{name:"Italic Title",element:"h2",attributes:{class:"italic-title"}},{name:"Subtitle",element:"h3",attributes:{class:"subtitle"}},{name:"Special Container",element:"div",attributes:{class:"special-containers"}},{name:"Marker",element:"span",attributes:{class:"marker"}},{name:"Small",element:"small"},{name:"Computer Code",element:"code"},{name:"Keyboard Phrase",element:"kbd"},{name:"Sample Text",element:"samp"},{name:"Variable",element:"var"},{name:"Deleted Text",element:"del"},{name:"Inserted Text",element:"ins"},{name:"Cited Work",element:"cite"},{name:"Inline Quotation",element:"q"},{name:"Compact Table",element:"table",attributes:{cellpadding:"5",cellspacing:"0",class:"compact-table"}},{name:"Borderless Table",element:"table",attributes:{class:"borderless-table"}},{name:"Square Bulleted List",element:"ul",attributes:{class:"square-bulleted-list"}}],format_tags:"p;h1;h2;h3;pre",extraPlugins:"expression-editor, colordialog",extraAllowedContent:"span [rx-expression, contenteditable, title] (rx-expression)"};class um extends c.ViewDesignerComponentModel{constructor(){super(...arguments),this.html$=this.sandbox.getComponentPropertyValue("html")}static getInitialProperties(e){return Object.assign(Object.assign({name:null,html:null},d.RX_STANDARD_PROPS_DEFAULT_VALUES),e)}rxInit(){this.sandbox.componentProperties$.pipe((0,r.take)(1)).subscribe(()=>{this.sandbox.updateInspectorConfig(this.getInspector())}),this.sandbox.componentProperties$.subscribe(e=>{const t=e.html?[]:[this.sandbox.createError("Rich text value cannot be blank.")];t.push(...(0,c.validateStandardProps)(e)),this.sandbox.setValidationIssues(t)}),this.sandbox.getComponentPropertyValue("name").subscribe(e=>{const t=e?`${this.sandbox.descriptor.name} (${e})`:this.sandbox.descriptor.name;this.sandbox.setSettablePropertiesDataDictionary(t,[{label:"Hidden",expression:this.getExpressionForProperty("hidden")}])})}getInspector(){return{inspectorSectionConfigs:[{label:"General",controls:[{name:"name",component:l.TextFormControlComponent,options:{label:"Name",tooltip:new s.Tooltip("Enter a name to uniquely identify the Rich text component")}},...(0,c.getStandardPropsInspectorConfigs)()]}]}}updateComponentProperties(e){this.sandbox.updateComponentProperties(e)}}class fm{constructor(e,t,i,n,r,a){this.rxExpressionEditorService=e,this.rxTreeService=t,this.rxExpressionParserService=i,this.renderer2=n,this.document=r,this.ngZone=a,this.type="inline",this.ckConfig=mm,this.formControl=new b.FormControl(null),this.destroyed$=new o.ReplaySubject(1),this.removeExpressionLabels=this.setExpressionLabelHtml.bind(this,null),this.addExpressionLabels=this.setExpressionLabelHtml.bind(this,this.getExpressionWithLabels.bind(this))}ngOnInit(){this.model.expressionConfigurator.getDataDictionary().pipe((0,r.withLatestFrom)(this.model.html$),(0,r.takeUntil)(this.destroyed$)).subscribe(([e,t])=>{this.flatDataDictionary=this.rxTreeService.flatten({children:e}),this.formControl.setValue(this.addExpressionLabels(t))}),this.formControl.valueChanges.pipe((0,r.map)(e=>this.removeExpressionLabels(e)),(0,r.distinctUntilChanged)(),(0,r.skip)(1),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.model.updateComponentProperties({html:e})}),this.model.html$.pipe((0,r.take)(1),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.formControl.setValue(this.addExpressionLabels(e))})}onEditorReady(e){this.isReadOnly&&(this.ckConfig.toolbar=[],this.document.getElementById(`${e.editor.id}_top`).style.display="none"),this.ckEditor.instance.on("openExpressionEditor",e=>{const t=e.data&&e.data.getAttribute(d.RX_RICH_TEXT.expressionAttributeName);this.ngZone.runTask(()=>this.rxExpressionEditorService.openEditor({property:{path:"html",value:t,label:"Rich Text"},expressionConfigurator:this.model.expressionConfigurator}).pipe((0,r.takeUntil)(this.destroyed$)).subscribe({next:({path:i,value:n})=>{if(n){const i=this.getExpressionWithLabels(n);t?(e.data.setAttribute(d.RX_RICH_TEXT.expressionAttributeName,n),e.data.setHtml(i),this.ckEditor.instance.fire("saveSnapshot")):this.ckEditor.instance.insertHtml(`<span contenteditable="false" ${d.RX_RICH_TEXT.expressionAttributeName}="${(0,m.escape)(n)}">${i}</span>`)}else e.data.remove(),this.ckEditor.instance.fire("saveSnapshot");this.moveCursorToEnd()},error:()=>{this.moveCursorToEnd()}}))})}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}getExpressionWithLabels(e){return this.rxExpressionParserService.parse(e,(e,t)=>{if(e!==s.ExpressionParserToken.RxStringExpression){const e=this.flatDataDictionary.find(e=>e.expression===t),i=e&&e.label?(0,m.escape)(e.label):t;return`<span title="${i}">${i}</span>`}return t})}moveCursorToEnd(){const e=this.ckEditor.instance.createRange();e.moveToElementEditEnd(e.root),this.ckEditor.instance.getSelection().selectRanges([e])}setExpressionLabelHtml(e,t){const i=this.renderer2.createElement("div");return i.innerHTML=t,i.querySelectorAll(`span[${d.RX_RICH_TEXT.expressionAttributeName}]`).forEach(t=>t.innerHTML=e?e(t.getAttribute(d.RX_RICH_TEXT.expressionAttributeName)):null),i.innerHTML.replace(/<br>/g,"<br />")}}fm.\u0275fac=function(e){return new(e||fm)(n["\u0275\u0275directiveInject"](l.RxExpressionEditorService),n["\u0275\u0275directiveInject"](v.RxTreeService),n["\u0275\u0275directiveInject"](s.RxExpressionParserService),n["\u0275\u0275directiveInject"](n.Renderer2),n["\u0275\u0275directiveInject"](f.DOCUMENT),n["\u0275\u0275directiveInject"](n.NgZone))},fm.\u0275cmp=n["\u0275\u0275defineComponent"]({type:fm,selectors:[["rx-rich-text-design"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](M.CKEditorComponent,7),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.ckEditor=e.first)}},inputs:{model:"model",isReadOnly:"isReadOnly"},decls:1,vars:6,consts:[[1,"border",3,"formControl","config","type","readOnly","ready"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"ckeditor",0),n["\u0275\u0275listener"]("ready",function(e){return t.onEditorReady(e)}),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275classProp"]("border-transparent",t.formControl.value),n["\u0275\u0275property"]("formControl",t.formControl)("config",t.ckConfig)("type",t.type)("readOnly",t.isReadOnly))},directives:[M.CKEditorComponent,b.NgControlStatus,b.FormControlDirective],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{display:block}ckeditor[_ngcontent-%COMP%]{min-height:42px;display:block;border:1px solid #d6d7d8}ckeditor.border-transparent[_ngcontent-%COMP%]{border-color:transparent!important}ckeditor[_ngcontent-%COMP%]     [rx-expression]{padding:2px 5px;display:inline-block;color:#7c7f81;background-color:#f0f1f1;border-radius:2px;-webkit-user-select:all;user-select:all}ckeditor[_ngcontent-%COMP%]     [rx-expression] span{padding:2px 5px;background-color:#d6d7d8;border-radius:2px}ckeditor[_ngcontent-%COMP%]     .cke_editable{padding:5px;outline:none}']});class hm{constructor(){const e=this;CKEDITOR.plugins.add("expression-editor",{init(t){t.addCommand("insertExpression",{exec:()=>(t.fire("openExpressionEditor",null),!0)}),t.on("doubleclick",i=>{const n=e.getSelectedExpressionElement(i.data.element);n&&t.fire("openExpressionEditor",n)},null,null,0),t.ui.addButton("ExpressionEditor",{label:"Insert Expression",command:"insertExpression",toolbar:"",icon:CKEDITOR.plugins.getPath("expression-editor")+"toolbar.png"})}})}getSelectedExpressionElement(e){if(e.is("span")&&e.hasAttribute("rx-expression"))return e;{const t=e.getParent();if(t.is("span")&&t.hasAttribute("rx-expression"))return t}}clearSelection(e){const t=e.getSelection();t&&t.removeAllRanges()}}hm.\u0275fac=function(e){return new(e||hm)},hm.\u0275prov=n["\u0275\u0275defineInjectable"]({token:hm,factory:hm.\u0275fac,providedIn:"root"});class gm{constructor(e,t,i){this.rxExpressionEditorPluginService=e,this.rxDefinitionAdapterRegistryService=t,this.richTextDefinitionAdapterService=i,t.registerDesignAdapter(d.RxViewComponentType.RichText,this.richTextDefinitionAdapterService)}}gm.\u0275fac=function(e){return new(e||gm)(n["\u0275\u0275inject"](hm),n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService),n["\u0275\u0275inject"](cm))},gm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:gm,declarations:[fm],imports:[f.CommonModule,M.CKEditorModule,b.ReactiveFormsModule]}),gm.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,M.CKEditorModule,b.ReactiveFormsModule]]});class vm{}vm.\u0275fac=function(e){return new(e||vm)},vm.\u0275cmp=n["\u0275\u0275defineComponent"]({type:vm,selectors:[["rx-service-list-design"]],decls:3,vars:0,consts:[[1,"row"],[1,"col-md-12"],["label","Service list","required","true","disabled","true","ngModel",""]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275element"](2,"adapt-rx-select",2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]())},directives:[u.AdaptRxSelectComponent,b.RequiredValidator,b.NgControlStatus,b.NgModel],encapsulation:2});class ym{}ym.\u0275fac=function(e){return new(e||ym)},ym.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ym,declarations:[vm],imports:[f.CommonModule,l.RxDefinitionPickerModule,l.FormControlsModule,u.AdaptRxSelectModule,b.FormsModule]}),ym.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,l.RxDefinitionPickerModule,l.FormControlsModule,u.AdaptRxSelectModule,b.FormsModule]]});class xm extends h.BaseViewComponent{constructor(e){super(),this.httpClient=e,this.isDisabled=!0,this.serviceListOptions=[],this.service={id:null,name:null,guid:null}}ngOnInit(){super.ngOnInit();const e=this.config.pipe((0,r.pluck)("serviceRequestId"),(0,r.distinctUntilChanged)(),(0,r.takeUntil)(this.destroyed$));this.httpClient.get("/api/com.bmc.dsm.chatbot/rx/application/chatbot/services").pipe((0,r.withLatestFrom)(e),(0,r.finalize)(()=>{this.isDisabled=!1}),(0,r.takeUntil)(this.destroyed$)).subscribe(([e,t])=>{this.serviceListOptions=(0,m.flow)(e=>(0,m.groupBy)(e,"groupName"),e=>(0,m.map)(e,(e,t)=>({name:t,children:(0,m.map)(e,e=>({id:e.id,name:e.name,guid:e.guid}))})))((null==e?void 0:e.catalogDetailsList)||[]),this.selectServiceRequest(t)}),e.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.selectServiceRequest(e)})}selectServiceRequest(e){let t;(0,m.forEach)(this.serviceListOptions,i=>{if(t)return!1;t=(0,m.find)(i.children,{id:e})}),this.service=t?[{id:t.id,name:t.name,guid:t.guid}]:[]}onSelectionChange(e){const t=e.options[0];this.notifyPropertyChanged("serviceRequestId",t.id),this.notifyPropertyChanged("serviceRequestName",t.name),this.notifyPropertyChanged("serviceRequestGuid",t.guid)}optionFormatter(e){return e.name}}xm.\u0275fac=function(e){return new(e||xm)(n["\u0275\u0275directiveInject"](V.HttpClient))},xm.\u0275cmp=n["\u0275\u0275defineComponent"]({type:xm,selectors:[["rx-service-list"]],inputs:{config:"config"},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:4,consts:[["label","Service name","required","true","enableFilter","true",3,"options","disabled","ngModel","optionFormatter","onSelectionChange"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-rx-select",0),n["\u0275\u0275listener"]("onSelectionChange",function(e){return t.onSelectionChange(e)}),n["\u0275\u0275elementEnd"]()),2&e&&n["\u0275\u0275property"]("options",t.serviceListOptions)("disabled",t.isDisabled)("ngModel",t.service)("optionFormatter",t.optionFormatter)},directives:[u.AdaptRxSelectComponent,b.RequiredValidator,b.NgControlStatus,b.NgModel],encapsulation:2});class bm{}bm.\u0275fac=function(e){return new(e||bm)},bm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:bm,declarations:[xm],imports:[f.CommonModule,u.AdaptRxSelectModule,b.FormsModule],exports:[xm]}),bm.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptRxSelectModule,b.FormsModule]]});class Cm extends Vs{constructor(){super(...arguments),this.state={enableLazyLoading:!1,label:""}}}Cm.\u0275fac=function(){let e;return function(t){return(e||(e=n["\u0275\u0275getInheritedFactory"](Cm)))(t||Cm)}}(),Cm.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Cm,selectors:[["rx-tab-container"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,Oa,1,0,"rx-runtime-view-canvas-outlet",0),2&e&&n["\u0275\u0275property"]("ngIf",!t.state.hidden)},directives:[f.NgIf,h.RuntimeViewCanvasOutletComponent],styles:["[_nghost-%COMP%]{display:block}"]});class Sm extends h.BaseViewComponent{constructor(e){super(),this.runtimeCanvasItemComponent=e,this.childLayouts=[],this.state={activeTabIndex:null},this.api={setProperty:this.setProperty.bind(this)}}ngOnInit(){super.ngOnInit(),this.notifyPropertyChanged("api",this.api),this.config.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.state=Object.assign(Object.assign({},this.state),e),this.isHidden=Boolean(this.state.hidden)}),this.childLayouts=(0,m.get)(this.runtimeCanvasItemComponent.getChildren(d.RX_VIEW_DEFINITION.defaultOutletName),"[0].children"),this.childLayouts.forEach(e=>{e.state={enableLazyLoading:!1,label:"",isRendered:!1,hidden:0},e.config.pipe((0,r.tap)(t=>{e.state=Object.assign(Object.assign({},e.state),t)}),(0,r.pluck)("hidden"),(0,r.distinctUntilChanged)(),(0,r.skip)(1),(0,r.takeUntil)(this.destroyed$)).subscribe(()=>{this.ensureActiveTabIsSet()})}),this.trySetFirstVisibleTab()}setProperty(e,t){if("hidden"===e)this.state.hidden=t,this.notifyPropertyChanged(e,t);else{if("activeTabIndex"!==e)return(0,o.throwError)(`Tab panel: property ${e} is not settable.`);this.setActiveTabIndex(parseInt(t,10))}}trackByForTabs(e,t){return t.guid}canRenderContentForTab(e){return!e.state.enableLazyLoading||e.state.isRendered}getAllTabsData(){let e=0;return this.childLayouts.map(t=>({adaptTabsetIndex:this.isHiddenTab(t)?null:e++,tab:t}))}isHiddenTab(e){return Boolean(e.state.hidden)}getActiveTabIndexForAdaptTabset(){return(0,m.isNull)(this.state.activeTabIndex)?0:this.getAllTabsData()[this.state.activeTabIndex].adaptTabsetIndex}onActiveTabChanged(e){const t=(0,m.findIndex)(this.getAllTabsData(),t=>t.adaptTabsetIndex===e);this.activateTab(t)}setActiveTabIndex(e){const t=this.childLayouts[e];t&&!this.isHiddenTab(t)&&this.activateTab(e)}activateTab(e){this.state.activeTabIndex=e,(0,m.isNil)(e)||(this.childLayouts[e].state.isRendered=!0),this.notifyPropertyChanged("activeTabIndex",e)}ensureActiveTabIsSet(){const e=this.childLayouts;(0,m.every)(e,e=>this.isHiddenTab(e))?this.activateTab(null):(!(0,m.isNull)(this.state.activeTabIndex)&&this.isHiddenTab(e[this.state.activeTabIndex])||(0,m.isNull)(this.state.activeTabIndex))&&this.trySetFirstVisibleTab()}trySetFirstVisibleTab(){const e=(0,m.findIndex)(this.childLayouts,e=>!this.isHiddenTab(e));-1!==e&&this.activateTab(e)}}Sm.\u0275fac=function(e){return new(e||Sm)(n["\u0275\u0275directiveInject"](h.RuntimeViewCanvasItemComponent))},Sm.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Sm,selectors:[["rx-tab-panel"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[[3,"fullHeight","tab-active","tab-active-changed",4,"ngIf"],[3,"fullHeight","tab-active","tab-active-changed"],["ngFor","",3,"ngForOf","ngForTrackBy"],[3,"adapt-tab-title",4,"ngIf"],[3,"layout",4,"ngIf"],[3,"adapt-tab-title"],[3,"layout"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,ka,2,4,"adapt-tabset",0),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf,u.AdaptTabsComponent,f.NgForOf,u.AdaptTabsPanelComponent,h.RuntimeViewCanvasItemComponent],encapsulation:2});class wm{constructor(e,t){this.viewDefinitionParserService=e,this.rxJsonParserService=t}adaptDefinition(e){this.viewDefinitionParserService.getComponents(e).filter(e=>e.componentDefinition.type===d.RxViewComponentType.TabPanel).map(e=>e.componentDefinition).forEach(e=>{if(e.layout){let t=this.rxJsonParserService.tryParseJson(e.layout);if(t&&t.componentDefinitionId){const i=t.columns.map(e=>({children:e.children.map(e=>e.columns[0].children[0].componentDefinitionId)}));t={outlets:[{name:"DEFAULT",columns:i}]},e.layout=JSON.stringify(t)}}})}}wm.\u0275fac=function(e){return new(e||wm)(n["\u0275\u0275inject"](d.RxViewDefinitionParserService),n["\u0275\u0275inject"](v.RxJsonParserService))},wm.\u0275prov=n["\u0275\u0275defineInjectable"]({token:wm,factory:wm.\u0275fac});class Dm extends Ns{constructor(e,t){super(e,t),this.componentDefinitionType=d.RxViewComponentType.TabContainer}}Dm.\u0275fac=function(e){return new(e||Dm)(n["\u0275\u0275inject"](d.RxViewDefinitionParserService),n["\u0275\u0275inject"](v.RxJsonParserService))},Dm.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Dm,factory:Dm.\u0275fac});class Rm{constructor(e,t,i){this.rxTabPanelComponentDefinitionAdapterService=e,this.rxTabContainerComponentDefinitionAdapterService=t,this.rxDefinitionAdapterRegistryService=i,i.registerRuntimeAdapter(d.RxViewComponentType.TabPanel,e),i.registerRuntimeAdapter(d.RxViewComponentType.TabContainer,t)}}Rm.\u0275fac=function(e){return new(e||Rm)(n["\u0275\u0275inject"](wm),n["\u0275\u0275inject"](Dm),n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService))},Rm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Rm,declarations:[Sm,Cm],imports:[f.CommonModule,h.RuntimeViewCanvasModule,u.AdaptTabsModule],exports:[Sm,Cm]}),Rm.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[wm,Dm],imports:[[f.CommonModule,h.RuntimeViewCanvasModule,u.AdaptTabsModule.forRoot()]]});class Im extends c.ViewDesignerComponentModel{constructor(){super(...arguments),this.tabContainerGuids$=this.sandbox.getChildComponentGuids().pipe((0,r.shareReplay)(1)),this.tabContainerComponents$=this.sandbox.getChildComponents(e=>e.type===d.RxViewComponentType.TabContainer).pipe((0,r.shareReplay)(1),(0,r.takeUntil)(this.sandbox.destroyed$)),this.selectedTabGuid$=new o.ReplaySubject(null)}static getInitialProperties(e){return Object.assign(Object.assign({name:null},d.RX_STANDARD_PROPS_DEFAULT_VALUES),e)}rxInit(){this.sandbox.componentProperties$.pipe((0,r.take)(1)).subscribe(()=>{this.sandbox.updateInspectorConfig(this.getInspector())}),this.sandbox.componentProperties$.subscribe(e=>this.validate(e)),this.tabContainerGuids$.pipe((0,r.map)(e=>!(0,m.isEmpty)(e)),(0,r.take)(1)).subscribe(e=>{e||this.sandbox.setChildren([{type:d.RxViewComponentType.TabContainer,data:{label:"Tab 1"}},{type:d.RxViewComponentType.TabContainer,data:{label:"Tab 2"}}])}),this.sandbox.getComponentPropertyValue("name").subscribe(e=>{const t=e?`${this.sandbox.descriptor.name} (${e})`:this.sandbox.descriptor.name;this.sandbox.setSettablePropertiesDataDictionary(t,[{label:"Hidden",expression:this.getExpressionForProperty("hidden")},{label:"Active Tab Index",expression:this.getExpressionForProperty("activeTabIndex")}])})}addTab(){this.sandbox.addComponent({type:d.RxViewComponentType.TabContainer,propertiesByName:{label:"New tab"}})}removeTab(e){this.sandbox.removeComponents([e]),(0,o.combineLatest)([this.selectedTabGuid$,this.tabContainerGuids$]).pipe((0,r.take)(1),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([t,i])=>{e===t&&this.selectTab(i[0])})}selectTab(e,t=!1){this.selectedTabGuid$.next(e),t||setTimeout(()=>{this.sandbox.selectComponent(e)})}dropPredicate(){return!1}moveComponent(e,t){this.sandbox.moveComponent(e,t,this.sandbox.guid)}validate(e){this.sandbox.setValidationIssues((0,c.validateStandardProps)(e))}getInspector(){return{inspectorSectionConfigs:[{label:"General",controls:[{name:"name",component:l.TextFormControlComponent,options:{label:"Name",tooltip:new s.Tooltip("Enter a name to uniquely identify the Tab panel")}},...(0,c.getStandardPropsInspectorConfigs)()]}]}}}class Fm{constructor(e){this.rxUtilityModalsService=e,this.components=[],this.destroyed$=new o.ReplaySubject(1)}ngOnInit(){this.model.tabContainerComponents$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.components=e,this.adaptTabset.checkActiveIndex()}),this.model.tabContainerComponents$.pipe((0,r.take)(1)).subscribe(e=>{this.model.selectTab((0,m.first)(e).guid,!0)})}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}trackByForTabs(e,t){return t.guid}onTabClicked(e){this.activeTabChanged(e)}onTabAdded(e){e.stopPropagation(),this.model.addTab(),setTimeout(()=>{this.adaptTabset.setActiveTab(this.components.length-1,!0,new MouseEvent("click"))})}activeTabChanged({index:e,event:t}){t.stopPropagation(),this.model.tabContainerGuids$.pipe((0,r.take)(1)).subscribe(t=>{this.model.selectTab(t[e])})}onTabDropped(e){for(let t=0;t<this.components.length;t++)if(this.components[t].guid!==e[t].id){if(this.components[t].guid===e[t+1].id){this.model.moveComponent(e[t].id,t);break}this.model.moveComponent(this.components[t].guid,(0,m.findIndex)(e,{id:this.components[t].guid}));break}}removeTab({index:e}){this.rxUtilityModalsService.confirm("Are you sure you want to delete this view component?").then(t=>{t&&this.model.tabContainerGuids$.pipe((0,r.take)(1)).subscribe(t=>{this.model.removeTab(t[e])})})}}Fm.\u0275fac=function(e){return new(e||Fm)(n["\u0275\u0275directiveInject"](S.RxUtilityModalsService))},Fm.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Fm,selectors:[["rx-tab-panel-design"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](ja,7),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.adaptTabset=e.first)}},inputs:{model:"model",isReadOnly:"isReadOnly"},decls:4,vars:5,consts:[[3,"allow-tabs-adding","enableDnD","tab-index-closed","tab-active-changed","tabClicked","tabDropped","add-tab-clicked"],["adaptTabset",""],[3,"adapt-tab-title","icon-close","id",4,"ngFor","ngForOf","ngForTrackBy"],[3,"dropPredicate"],[3,"adapt-tab-title","icon-close","id"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-tabset",0,1),n["\u0275\u0275listener"]("tab-index-closed",function(e){return t.removeTab(e)})("tab-active-changed",function(e){return t.activeTabChanged(e)})("tabClicked",function(e){return t.onTabClicked(e)})("tabDropped",function(e){return t.onTabDropped(e)})("add-tab-clicked",function(e){return t.onTabAdded(e)}),n["\u0275\u0275template"](2,_a,1,3,"adapt-tab-panel",2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](3,"rx-canvas-outlet",3)),2&e&&(n["\u0275\u0275property"]("allow-tabs-adding",!t.isReadOnly)("enableDnD",!0),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",t.components)("ngForTrackBy",t.trackByForTabs),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("dropPredicate",t.model.dropPredicate))},directives:[u.AdaptTabsComponent,f.NgForOf,c.CanvasOutletComponent,u.AdaptTabsPanelComponent],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{display:block;border:1px solid #d6d7d8}[_nghost-%COMP%]  .adapt-tabset>.tab-container>.tab-content{display:none}[_nghost-%COMP%] >rx-canvas-outlet>rx-canvas-item-container>div>div>rx-canvas-item-column>.cdk-drop-list>.cdk-drag>.canvas-item{border-width:0;padding:0}[_nghost-%COMP%] >rx-canvas-outlet>rx-canvas-item-container>div>div>rx-canvas-item-column>.cdk-drop-list>.cdk-drag>.canvas-item>.canvas-item-header{display:none}']});class Em extends Gs{constructor(e){super(),this.tabPanelDesignComponent=e}ngOnInit(){this.tabPanelDesignComponent.model.selectedTabGuid$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(this.model.selectedTabGuid$)}}Em.\u0275fac=function(e){return new(e||Em)(n["\u0275\u0275directiveInject"](Fm))},Em.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Em,selectors:[["rx-tab-container-design"]],inputs:{model:"model"},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:2,consts:[[3,"skipParentPredicate","containerComponent"]],template:function(e,t){1&e&&n["\u0275\u0275element"](0,"rx-canvas-outlet",0),2&e&&n["\u0275\u0275property"]("skipParentPredicate",!0)("containerComponent",t.containerCanvasItemComponent)},directives:[c.CanvasOutletComponent],encapsulation:2});class Mm{}Mm.\u0275fac=function(e){return new(e||Mm)},Mm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Mm,declarations:[Fm,Em],imports:[f.CommonModule,u.AdaptButtonModule,u.AdaptTabsModule,c.ViewDesignerCanvasModule]}),Mm.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptButtonModule,u.AdaptTabsModule,c.ViewDesignerCanvasModule]]});class Am extends c.ViewDesignerComponentModel{constructor(){super(...arguments),this.rxViewComponentRegistryService=this.injector.get(d.RxViewComponentRegistryService),this.componentName$=this.sandbox.getChildComponents().pipe((0,r.filter)(e=>e.length>0),(0,r.map)(e=>{const t=e[0].type,i=this.rxViewComponentRegistryService.get(t);return(null==i?void 0:i.name)||d.RX_VIEW_DEFINITION.unknownPageComponent.name}))}}class Om{}Om.\u0275fac=function(e){return new(e||Om)},Om.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Om,selectors:[["rx-page-design"]],inputs:{model:"model"},decls:2,vars:3,consts:[["type","objects",3,"label"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"adapt-empty-state",0),n["\u0275\u0275pipe"](1,"async")),2&e&&n["\u0275\u0275property"]("label",n["\u0275\u0275pipeBind1"](1,1,t.model.componentName$))},directives:[u.AdaptEmptyStateComponent],pipes:[f.AsyncPipe],encapsulation:2,changeDetection:0});class Pm{}Pm.\u0275fac=function(e){return new(e||Pm)},Pm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Pm,declarations:[Om],imports:[f.CommonModule,u.AdaptEmptyStateModule]}),Pm.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptEmptyStateModule]]});class Tm{adaptDefinition(e){e.layout=JSON.stringify({outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName,columns:[{children:e.componentDefinitions[0].guid}]}]})}}Tm.\u0275fac=function(e){return new(e||Tm)},Tm.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Tm,factory:Tm.\u0275fac});class Vm{constructor(e,t){this.rxDefinitionAdapterRegistryService=e,this.pageComponentDefinitionAdapterService=t,this.rxDefinitionAdapterRegistryService.registerRuntimeAdapter(d.RxViewComponentType.Page,this.pageComponentDefinitionAdapterService)}}Vm.\u0275fac=function(e){return new(e||Vm)(n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService),n["\u0275\u0275inject"](Tm))},Vm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Vm,declarations:[Jp],imports:[f.CommonModule,h.RuntimeViewCanvasModule],exports:[Jp]}),Vm.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[Tm],imports:[[f.CommonModule,h.RuntimeViewCanvasModule]]});class Nm{}Nm.\u0275fac=function(e){return new(e||Nm)},Nm.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Nm,selectors:[["rx-image-design"]],decls:2,vars:0,consts:[[1,"placeholder","d-flex","justify-content-center","align-items-center"],[1,"component-icon","d-icon-attachment_image_adapt"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275element"](1,"span",1),n["\u0275\u0275elementEnd"]())},styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{display:block;border:1px solid #d6d7d8}.placeholder[_ngcontent-%COMP%]{height:132px;color:#959899}.component-icon[_ngcontent-%COMP%]{height:100px;width:100px;font-size:100px;position:relative}.component-icon[_ngcontent-%COMP%]:before{position:absolute;top:0;bottom:0;right:0;left:0}']});class km{}var jm;km.\u0275fac=function(e){return new(e||km)},km.\u0275mod=n["\u0275\u0275defineNgModule"]({type:km,declarations:[Nm],imports:[f.CommonModule,l.RxDefinitionPickerModule,l.FormControlsModule]}),km.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,l.RxDefinitionPickerModule,l.FormControlsModule]]}),function(e){e.Left="left",e.Center="center",e.Right="right"}(jm||(jm={}));const _m=[{id:jm.Left,name:"Left"},{id:jm.Center,name:"Center"},{id:jm.Right,name:"Right"}],Bm={[jm.Left]:"justify-content-start",[jm.Center]:"justify-content-center",[jm.Right]:"justify-content-end"};class $m extends h.BaseViewComponent{constructor(e,t,i,n,o,r){super(),this.rxRecordInstanceService=e,this.rxLogService=t,this.httpClient=i,this.domSanitizer=n,this.translateService=o,this.rxRecordInstanceUtilsService=r,this.state={recordDefinitionName:"",recordInstanceId:"",fieldId:"",maxWidth:"",imageUrl:null,isImageBroken:!1,alignmentStyle:"",altText:""},this.api={setProperty:this.setProperty.bind(this)},this.fileName=""}ngOnInit(){super.ngOnInit(),this.notifyPropertyChanged("api",this.api);this.config.pipe((0,r.distinctUntilChanged)(m.isEqual),(0,r.tap)(e=>{const t=Object.assign({},e);this.isHidden=t.hidden,!this.state.alignmentStyle&&t.alignment&&(t.alignmentStyle=this.getAlignmentStyle(t.alignment)),delete t.alignment,this.state=Object.assign(Object.assign({},this.state),t)}),(0,r.shareReplay)(1)).pipe((0,r.map)(()=>this.state.recordInstanceId?this.state.recordInstanceId:null),(0,r.filter)(e=>Boolean(e)),(0,r.distinctUntilChanged)(),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{const t=this.rxRecordInstanceService.getAttachmentDownloadUrl(this.state.recordDefinitionName,Number(this.state.fieldId),e);this.httpClient.get(t,{responseType:"blob",observe:"response"}).subscribe({next:e=>{const t=e.body;if(this.fileName=this.rxRecordInstanceUtilsService.tryParseContentDisposition(e.headers.get("content-disposition")),t&&"image"===t.type.split("/")[0]){const e=new FileReader;e.onloadend=()=>{this.state.imageUrl=this.domSanitizer.bypassSecurityTrustResourceUrl(e.result),this.state.isImageBroken=!1,this.state.altText=this.fileName},e.onerror=this.onImageLoadFailed.bind(this),e.readAsDataURL(t)}else this.rxLogService.warning("rx-image: attachment is not a valid image."),this.onImageLoadFailed()},error:e=>{this.state.imageUrl=null,this.state.isImageBroken=!1,this.state.altText=""}})})}onImageLoadFailed(){this.state.imageUrl=null,this.state.isImageBroken=!0,this.state.altText=this.translateService.instant("com.bmc.arsys.rx.client.view-components.image.invalid-image.label",{imageName:this.fileName})}getAlignmentStyle(e){return Bm[e]}setProperty(e,t){if("hidden"!==e)return(0,o.throwError)(`Image: property ${e} is not settable.`);this.isHidden=t,this.notifyPropertyChanged(e,this.isHidden)}}$m.\u0275fac=function(e){return new(e||$m)(n["\u0275\u0275directiveInject"](a.RxRecordInstanceService),n["\u0275\u0275directiveInject"](s.RxLogService),n["\u0275\u0275directiveInject"](V.HttpClient),n["\u0275\u0275directiveInject"](T.DomSanitizer),n["\u0275\u0275directiveInject"](p.TranslateService),n["\u0275\u0275directiveInject"](a.RxRecordInstanceUtilsService))},$m.\u0275cmp=n["\u0275\u0275defineComponent"]({type:$m,selectors:[["rx-image"]],inputs:{config:"config"},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[[3,"class",4,"ngIf"],["class","image",3,"src","max-width",4,"ngIf"],["role","img","class","broken-image d-icon-broken_image",4,"ngIf"],[1,"image",3,"src"],["role","img",1,"broken-image","d-icon-broken_image"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,La,3,5,"div",0),2&e&&n["\u0275\u0275property"]("ngIf",!t.isHidden)},directives:[f.NgIf],styles:[".broken-image[_ngcontent-%COMP%]{font-size:64px}.image[_ngcontent-%COMP%]{align-self:flex-start}.image-container[_ngcontent-%COMP%]{width:100%;overflow:hidden}"]});class Lm{}Lm.\u0275fac=function(e){return new(e||Lm)},Lm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Lm,declarations:[$m],imports:[f.CommonModule],exports:[$m]}),Lm.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule]]});class Gm{constructor(e,t){this.componentFactoryResolver=e,this.rxViewComponentRegistryService=t,t.register({type:d.RxViewComponentType.ActionButton,componentFactory:this.componentFactoryResolver.resolveComponentFactory(ws),properties:[{name:"recordDefinitionName"},{name:"fieldId"},{name:"recordInstance",enableExpressionEvaluation:!0},{name:"label",localizable:!0},d.RX_DISABLED_PROP_DESC,...d.RX_STANDARD_PROPS_DESC],name:"Action button",isContainerComponent:!0,options:{canBeEmbeddedInRecordEditor:!0},group:c.RX_VIEW_DESIGNER.stencilGroups.basicComponents.label,icon:"action_button_cursor",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(bs),designComponentModel:xs,bundleId:s.RX_APPLICATION.platformBundleId})}}Gm.\u0275fac=function(e){return new(e||Gm)(n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](d.RxViewComponentRegistryService))},Gm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Gm,imports:[Ss,Ds]}),Gm.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Ss,Ds]]});class qm{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.ButtonBar,componentFactory:this.componentFactoryResolver.resolveComponentFactory(Ms),outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName}],properties:d.RX_STANDARD_PROPS_DESC,name:"Button bar",group:c.RX_VIEW_DESIGNER.stencilGroups.basicComponents.label,icon:"button_panel_o",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Ps),designComponentModel:Os,options:{canBeEmbeddedInRecordEditor:!0},bundleId:s.RX_APPLICATION.platformBundleId})}}qm.\u0275fac=function(e){return new(e||qm)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},qm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:qm,imports:[As,Ts]}),qm.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[As,Ts]]});class Um{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.Container,componentFactory:this.componentFactoryResolver.resolveComponentFactory(Vs),properties:d.RX_STANDARD_PROPS_DESC,outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName}],name:"Container",group:c.RX_VIEW_DESIGNER.stencilGroups.basicComponents.label,icon:"layout",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Gs),designComponentModel:Ls,options:{canBeEmbeddedInRecordEditor:!0},bundleId:s.RX_APPLICATION.platformBundleId})}}Um.\u0275fac=function(e){return new(e||Um)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Um.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Um,imports:[ks,qs]}),Um.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[ks,qs]]});class zm extends c.ViewDesignerComponentModel{constructor(){super(...arguments),this.recordDefinitionName$=this.sandbox.getComponentPropertyValue("recordDefinitionName"),this.attachmentFields$=this.recordDefinitionName$.pipe((0,r.switchMap)(e=>e?this.getAttachmentFieldsFromRecordDefinition(e):(0,o.of)([]))),this.rxModalService=this.injector.get(S.RxModalService),this.rxRecordDefinitionCacheService=this.injector.get(a.RxRecordDefinitionCacheService),this.maxWidthUnits=[{name:"pixels",id:"px"},{name:"%",id:"%"}]}static getInitialProperties(e){return Object.assign(Object.assign({name:null,recordDefinitionName:null,recordInstanceId:null,fieldId:null,maxWidth:null,alignment:jm.Left},d.RX_STANDARD_PROPS_DEFAULT_VALUES),e)}rxInit(){this.sandbox.componentProperties$.pipe((0,r.take)(1)).subscribe(e=>{this.sandbox.updateInspectorConfig(this.getInspector(e))}),this.recordDefinitionName$.pipe((0,r.skip)(1),(0,r.withLatestFrom)(this.sandbox.componentProperties$),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([e,t])=>{const i=Object.assign(Object.assign({},t),{recordInstanceId:null,fieldId:null});this.sandbox.updateComponentProperties(i),this.sandbox.updateInspectorConfig(this.getInspector(i))}),this.attachmentFields$.pipe((0,r.withLatestFrom)(this.sandbox.componentProperties$),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(([e,t])=>{this.sandbox.updateInspectorConfig(this.getInspector(t,e))}),(0,o.combineLatest)([this.validateEmptyProp("recordDefinitionName","Record definition name cannot be blank."),this.validateEmptyProp("recordInstanceId","Record instance ID cannot be blank."),this.validateEmptyProp("fieldId","Field ID cannot be blank."),this.sandbox.getComponentPropertyValue("maxWidth").pipe((0,r.map)(e=>this.validateMaxWidth(e))),this.sandbox.getComponentPropertyValue("styles").pipe((0,r.map)(c.validateCssClassNames)),this.sandbox.getComponentPropertyValue(d.RX_AVAILABLE_ON_DEVICES_PROP_NAME).pipe((0,r.map)(c.validateAvailableOnDevicesProp))]).pipe((0,r.map)(m.flatten),(0,r.map)(m.compact),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>this.sandbox.setValidationIssues(e)),this.sandbox.getComponentPropertyValue("name").subscribe(e=>{const t=e?`${this.sandbox.descriptor.name} (${e})`:this.sandbox.descriptor.name;this.sandbox.setSettablePropertiesDataDictionary(t,[{label:"Hidden",expression:this.getExpressionForProperty("hidden")}])})}getAttachmentFieldsFromRecordDefinition(e){return this.rxRecordDefinitionCacheService.getRecordDefinition(e).pipe((0,r.map)(e=>e.fieldDefinitions.filter(e=>e.resourceType===a.RX_RECORD_DEFINITION.dataTypes.attachment.resourceType).map(({id:e,name:t})=>({id:e.toString(),name:t}))))}getInspector(e,t=[]){return{inspectorSectionConfigs:[{label:"General",controls:[{name:"name",component:l.TextFormControlComponent,options:{label:"Name",tooltip:new s.Tooltip("Enter a name to uniquely identify the Image view component.")}},{name:"recordDefinitionName",component:l.RxDefinitionPickerComponent,options:{label:"Record definition name",definitionType:l.RxDefinitionPickerType.RegularRecord,beforeValueChange:(t,i)=>Boolean(t)&&e.recordInstanceId&&e.fieldId?this.rxModalService.confirm({title:"Warning",modalStyle:S.RX_MODAL.modalStyles.warning,message:"Record Instance ID and Field ID will be cleared. Do you want to continue?"}):Promise.resolve(!0),required:!0}},{name:"fieldId",component:l.SelectFormControlComponent,options:{label:"Field name",options:t,required:!0}},{name:"recordInstanceId",component:l.ExpressionInspectorControlComponent,options:{label:"Record ID",isRequired:!0}},{name:"alignment",component:l.SelectFormControlComponent,options:{label:"Horizontal alignment",options:_m}},{name:"maxWidth",component:l.StepperWithUnitsFormControlComponent,options:{label:"Maximum width",defaultUnit:"px",units:this.maxWidthUnits,stepperOptionByUnits:{px:{minValue:0},"%":{minValue:0,maxValue:100,defaultValue:100}}}},...(0,c.getStandardPropsInspectorConfigs)()]}]}}validateEmptyProp(e,t){return this.sandbox.getComponentPropertyValue(e).pipe((0,r.map)(i=>i?null:this.sandbox.createError(t,e)))}validateMaxWidth(e){if(e){const t=e.match(/^([+-]?\d+(?:\.\d+)?)(.*)/);if(t){const e=Number(t[1]);if("%"===t[2]&&e>100)return this.sandbox.createError("Maximum width cannot be greater than 100%.");if(e<0)return this.sandbox.createError("Maximum width should be a positive number.")}}}}class Xm{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,this.rxViewComponentRegistryService.register({type:d.RxViewComponentType.Image,componentFactory:this.componentFactoryResolver.resolveComponentFactory($m),name:"Image",group:c.RX_VIEW_DESIGNER.stencilGroups.basicComponents.label,options:{canBeEmbeddedInRecordEditor:!0},properties:[{name:"recordInstanceId",enableExpressionEvaluation:!0},...d.RX_STANDARD_PROPS_DESC],designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Nm),designComponentModel:zm,icon:"attachment_image_adapt",bundleId:s.RX_APPLICATION.platformBundleId})}}Xm.\u0275fac=function(e){return new(e||Xm)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Xm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Xm,imports:[Lm,km]}),Xm.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Lm,km]]});class Wm{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,this.rxViewComponentRegistryService.register({type:d.RxViewComponentType.Page,componentFactory:this.componentFactoryResolver.resolveComponentFactory(Jp),outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName}],name:"Page",group:c.RX_VIEW_DESIGNER.stencilGroups.basicComponents.label,designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Om),designComponentModel:Am,hidden:!0,bundleId:s.RX_APPLICATION.platformBundleId})}}Wm.\u0275fac=function(e){return new(e||Wm)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Wm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Wm,imports:[Vm,Pm]}),Wm.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Vm,Pm]]});class Hm{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.RecordEditor,componentFactory:this.componentFactoryResolver.resolveComponentFactory(sl),properties:[{name:"recordInstanceId",enableExpressionEvaluation:!0},{name:"allowEdit",enableExpressionEvaluation:!0},{name:"label",localizable:!0},d.RX_AVAILABLE_ON_DEVICES_PROP_DESC],outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName}],name:"Record editor",group:c.RX_VIEW_DESIGNER.stencilGroups.basicComponents.label,icon:"file_text",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Ys),designComponentModel:Ks,bundleId:s.RX_APPLICATION.platformBundleId})}}Hm.\u0275fac=function(e){return new(e||Hm)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Hm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Hm,imports:[cl,el]}),Hm.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[cl,el]]});class Qm extends c.RxViewComponentExpressionConfigurator{constructor(e,t,i){super(e,t,i),this.componentGuid=t,this.componentModel=i,this.rxDefinitionNameService=this.injector.get(s.RxDefinitionNameService),this.rxRecordGridUtilsService=this.injector.get(kc),this.rxRecordDefinitionCacheService=this.injector.get(a.RxRecordDefinitionCacheService);const n=this.getComponentCommonDataDictionary().pipe((0,r.switchMap)(e=>e?i.recordDefinition$.pipe((0,r.concatMap)(e=>this.rxRecordGridUtilsService.getAssociationDescriptors(e.name).pipe((0,r.concatMap)(e=>e.length?(0,o.forkJoin)(e.map(e=>this.rxRecordDefinitionCacheService.getRecordDefinition(e.recordDefinitionName).pipe((0,r.map)(t=>Object.assign(Object.assign({},e),{recordDefinition:t}))))):(0,o.of)([])),(0,r.map)(i=>e?{label:"Filter by",children:[{label:this.rxDefinitionNameService.getDisplayName(e.name),icon:"d-icon-file_o_gear",children:e.fieldDefinitions.map(e=>{const i=e.resourceType===a.RX_RECORD_DEFINITION.resourceTypes.selection?(0,m.map)(e.optionNamesById,(i,n)=>({label:i,expression:`\${view.components.${t}.recordDefinition.fieldDefinitionsById[${e.id}].optionsById[${n}].id}`})):void 0;return{label:e.name,icon:"d-icon-file_o_gear",expression:`'${e.id}'`,children:e.resourceType===a.RX_RECORD_DEFINITION.resourceTypes.selection?[{label:"Options",children:i}]:null,autocompleteOptions:i}})},...i?i.map(e=>({label:this.rxDefinitionNameService.getDisplayName(e.associationDefinition.name),icon:"d-icon-file_o_gear",children:e.recordDefinition.fieldDefinitions.map(t=>({label:t.name,icon:"d-icon-file_o_gear",expression:`'\${recordContext._associations.${e.associationDefinition.guid}.${e.nodeSide}[0].${t.id}}'`}))})):[]]}:[]))),(0,r.map)(t=>Object.assign(Object.assign({},e),{children:[t,...e.children]}))):(0,o.of)(null)));this.configureForProperty({propertyPath:"filterExpression",operators:this.getOperatorRowsByGroup(s.ExpressionOperatorGroup.AllServer),dataDictionary$:this.getCommonDataDictionary(n).pipe((0,r.map)(e=>[Qc.keywords,...e.filter(e=>"General"!==e.label&&"Functions"!==e.label)||[]]))})}}class Jm{constructor(e,t,i,n){this.componentFactoryResolver=e,this.rxViewComponentRegistryService=t,this.rxRecordGridQueryExpressionEvaluatorService=i,this.rxRecordQueryExpressionEvaluatorService=n,t.register({type:Nc.type,componentFactory:this.componentFactoryResolver.resolveComponentFactory(om),properties:[{name:"recordDefinitionName",type:d.ViewComponentPropertyType.String},{name:"enableRowSelection",type:d.ViewComponentPropertyType.String},{name:"enableFiltering",type:d.ViewComponentPropertyType.Boolean,designType:d.ViewComponentPropertyType.Boolean,enableExpressionEvaluation:!0},{name:"getDataForHiddenColumns",type:d.ViewComponentPropertyType.Boolean,designType:d.ViewComponentPropertyType.Boolean,enableExpressionEvaluation:!0},{name:"requiredFilters",type:d.ViewComponentPropertyType.Number,designType:d.ViewComponentPropertyType.Number,enableExpressionEvaluation:!0},{name:"showDataForAllLocales",type:d.ViewComponentPropertyType.Boolean,designType:d.ViewComponentPropertyType.Boolean,enableExpressionEvaluation:!0},{name:"expandable",type:d.ViewComponentPropertyType.Boolean,designType:d.ViewComponentPropertyType.Boolean},{name:"bordered",type:d.ViewComponentPropertyType.Boolean,designType:d.ViewComponentPropertyType.Boolean,enableExpressionEvaluation:!0},{name:"striped",type:d.ViewComponentPropertyType.Boolean,designType:d.ViewComponentPropertyType.Boolean,enableExpressionEvaluation:!0},{name:"defaultFilterPreset",type:d.ViewComponentPropertyType.String},{name:"filters",type:d.ViewComponentPropertyType.String},{name:"filterExpression",type:d.ViewComponentPropertyType.String,enableExpressionEvaluation:!0,evaluatorService:this.rxRecordGridQueryExpressionEvaluatorService},{name:"selectedRows",type:d.ViewComponentPropertyType.String},{name:"firstSelectedRow",type:d.ViewComponentPropertyType.String},{name:"clickableRow",type:d.ViewComponentPropertyType.String},{name:"selectedRowCount",type:d.ViewComponentPropertyType.Number},{name:"totalRowCount",type:d.ViewComponentPropertyType.Number},{name:"isUserAllowedToDeleteRecords",type:d.ViewComponentPropertyType.Boolean},{name:"associationDefinitionName",type:d.ViewComponentPropertyType.String},{name:"associatedRecordNodeSide",type:d.ViewComponentPropertyType.String},{name:"associatedRecordId",type:d.ViewComponentPropertyType.String,enableExpressionEvaluation:!0},{name:"associatedRoleName",type:d.ViewComponentPropertyType.String,enableExpressionEvaluation:!0},{name:"enableFilterPresets",type:d.ViewComponentPropertyType.Boolean,designType:d.ViewComponentPropertyType.Boolean,enableExpressionEvaluation:!0},{name:"queryExpression",type:d.ViewComponentPropertyType.String},{name:"lastRefreshTime",type:d.ViewComponentPropertyType.String},{name:"viewPresetSelector",enableExpressionEvaluation:!0},d.RX_AVAILABLE_ON_DEVICES_PROP_DESC],outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName},{name:Nc.rowActionsOutletName}],name:"Record grid",group:c.RX_VIEW_DESIGNER.stencilGroups.basicComponents.label,icon:"table",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(qp),designComponentModel:Gp,expressionConfigurator:Qm,bundleId:s.RX_APPLICATION.platformBundleId},{type:Nc.components.column,configPropertyName:"columns",properties:[{name:"title",type:d.ViewComponentPropertyType.String,localizable:!0},{name:"fieldId",type:d.ViewComponentPropertyType.String},{name:"visible",type:d.ViewComponentPropertyType.String,enableExpressionEvaluation:!0},{name:"sortable",type:d.ViewComponentPropertyType.String},{name:"filterable",type:d.ViewComponentPropertyType.String,designType:d.ViewComponentPropertyType.Boolean,enableExpressionEvaluation:!0},{name:"clickable",type:d.ViewComponentPropertyType.String,enableExpressionEvaluation:!0},{name:"index",type:d.ViewComponentPropertyType.Number},{name:"alignment",type:d.ViewComponentPropertyType.String},{name:"cellDisplayProperties",designType:d.ViewComponentPropertyType.Array,type:d.ViewComponentPropertyType.Array},{name:"wrapText",type:d.ViewComponentPropertyType.Boolean},{name:"typeaheadKeystrokeCount",type:d.ViewComponentPropertyType.Number},{name:"additionalQueryCriteria",type:d.ViewComponentPropertyType.String,enableExpressionEvaluation:!0,evaluatorService:this.rxRecordQueryExpressionEvaluatorService}],isDataComponent:!0,isContainerComponent:!0},{type:Nc.components.filter,configPropertyName:"recordGridFilters",properties:[{name:"value",type:d.ViewComponentPropertyType.String},{name:"fieldId",type:d.ViewComponentPropertyType.String},{name:"$DISPLAYVALUE$",type:d.ViewComponentPropertyType.String},{name:"label",localizable:!0}],isDataComponent:!0},{type:Nc.components.filterPreset,configPropertyName:"predefinedFilterPresets",properties:[{name:"title",type:d.ViewComponentPropertyType.String,localizable:!0},{name:"filters",type:d.ViewComponentPropertyType.String},{name:"filterExpression",enableExpressionEvaluation:!0,evaluatorService:this.rxRecordGridQueryExpressionEvaluatorService}],isDataComponent:!0,isContainerComponent:!0},{type:Nc.components.viewPreset,configPropertyName:"viewPresets",properties:[{name:"viewPresetGuid",type:d.ViewComponentPropertyType.String},{name:"filters",type:d.ViewComponentPropertyType.String}],isDataComponent:!0,isContainerComponent:!0},{type:Nc.components.columnViewPreset,configPropertyName:"columnViewPresets",properties:[{name:"fieldId",type:d.ViewComponentPropertyType.String},{name:"index",designType:d.ViewComponentPropertyType.Number,type:d.ViewComponentPropertyType.Number},{name:"visible",designType:d.ViewComponentPropertyType.Boolean,type:d.ViewComponentPropertyType.Boolean},{name:"sortable",designType:d.ViewComponentPropertyType.Object,type:d.ViewComponentPropertyType.Object}],isDataComponent:!0,isContainerComponent:!0})}}Jm.\u0275fac=function(e){return new(e||Jm)(n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](am),n["\u0275\u0275inject"](d.RxRecordQueryExpressionEvaluatorService))},Jm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Jm,imports:[sm,Qp]}),Jm.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[sm,Qp]]});class Km{constructor(e,t,i){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,this.rxRichTextExpressionEvaluatorService=i,e.register({type:d.RxViewComponentType.RichText,componentFactory:this.componentFactoryResolver.resolveComponentFactory(lm),properties:[{name:"html",enableExpressionEvaluation:!0,evaluatorService:this.rxRichTextExpressionEvaluatorService,localizable:!0},...d.RX_STANDARD_PROPS_DESC],name:"Rich text",isContainerComponent:!0,options:{canBeEmbeddedInRecordEditor:!0},group:c.RX_VIEW_DESIGNER.stencilGroups.basicComponents.label,icon:"text",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(fm),designComponentModel:um,bundleId:s.RX_APPLICATION.platformBundleId})}}Km.\u0275fac=function(e){return new(e||Km)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](dm))},Km.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Km,imports:[pm,gm]}),Km.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[cm],imports:[[pm,gm]]});class Ym extends c.ViewDesignerComponentModel{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.componentProperties$=this.sandbox.componentProperties$,this.hiddenOnCanvas$=new o.BehaviorSubject(!1),this.selectedTabGuid$=new o.Subject,this.componentProperties$.pipe((0,r.take)(1)).subscribe(()=>{this.sandbox.updateInspectorConfig(this.getInspector())}),(0,o.combineLatest)([this.sandbox.getComponentPropertyValue("label").pipe((0,r.map)(e=>e?null:this.sandbox.createError("Label cannot be blank.","label"))),this.sandbox.getComponentPropertyValue("styles").pipe((0,r.map)(c.validateCssClassNames)),this.sandbox.getComponentPropertyValue(d.RX_AVAILABLE_ON_DEVICES_PROP_NAME).pipe((0,r.map)(c.validateAvailableOnDevicesProp))]).pipe((0,r.map)(m.flatten),(0,r.map)(m.compact)).subscribe(e=>this.sandbox.setValidationIssues(e)),this.selectedTabGuid$.pipe((0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.hiddenOnCanvas$.next(this.sandbox.guid!==e)}),this.sandbox.getComponentPropertyValue("columnCount").pipe((0,r.skip)(1)).subscribe(e=>{this.sandbox.setLayout(this.getDefaultColumnSpans(Number(e)))}),this.sandbox.getComponentPropertyValue("label").subscribe(e=>{const t=e?`${this.sandbox.descriptor.name} (${e})`:this.sandbox.descriptor.name;this.sandbox.setSettablePropertiesDataDictionary(t,[{label:"Hidden",expression:this.getExpressionForProperty("hidden")}]),this.sandbox.setBreadcrumbs(e)})}static getInitialProperties(e){return Object.assign(Object.assign({columnCount:"1",enableLazyLoading:!1,label:"",rowWrap:_s.Sm},d.RX_STANDARD_PROPS_DEFAULT_VALUES),e)}setContainerLayout(e){this.sandbox.setLayout(e)}getDefaultColumnSpans(e){const t=[],i=Math.floor(Bs.maxColumnSpan/e);return(0,m.times)(e,()=>t.push(i)),t[t.length-1]=Bs.maxColumnSpan%e+i,t}getInspector(){return{inspectorSectionConfigs:[{label:"General",controls:[{name:"label",component:l.TextFormControlComponent,options:{label:"Label",required:!0}},{name:"enableLazyLoading",component:l.SwitchFormControlComponent,options:{label:"Enable lazy loading"}},{name:"columnCount",component:l.SelectFormControlComponent,options:{label:"Number of columns",required:!0,tooltip:new s.Tooltip("Resize container columns on the canvas by dragging the dashed column separator line."),options:(0,m.times)(6,e=>({id:(++e).toString(),name:e.toString()}))}},{name:"rowWrap",component:l.SelectFormControlComponent,options:{label:"Row wrap",sortAlphabetically:!1,options:(0,m.values)(Bs.rowWrapOptions),tooltip:new s.Tooltip("The Row wrap property controls the layout of multi-column containers based on\n                    the width of the view. When the width of the view is decreased to a width less\n                    than the selected Row wrap value, each container column after the first one\n                    wraps onto a new line.")}},...(0,c.getStandardPropsInspectorConfigs)()]}]}}}class Zm{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.TabPanel,componentFactory:t.resolveComponentFactory(Sm),properties:d.RX_STANDARD_PROPS_DESC,outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName}],options:{canBeEmbeddedInRecordEditor:!0},name:"Tab panel",group:c.RX_VIEW_DESIGNER.stencilGroups.basicComponents.label,icon:"app_tab",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Fm),designComponentModel:Im,bundleId:s.RX_APPLICATION.platformBundleId},{type:d.RxViewComponentType.TabContainer,componentFactory:t.resolveComponentFactory(Cm),properties:[...d.RX_STANDARD_PROPS_DESC,{name:"label",type:d.ViewComponentPropertyType.String,localizable:!0},{name:"enableLazyLoading",type:d.ViewComponentPropertyType.Boolean,designType:d.ViewComponentPropertyType.Boolean,enableExpressionEvaluation:!0}],outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName}],name:"Tab",group:c.RX_VIEW_DESIGNER.stencilGroups.basicComponents.label,hidden:!0,icon:"app_tab",designComponentFactory:t.resolveComponentFactory(Em),designComponentModel:Ym,bundleId:s.RX_APPLICATION.platformBundleId})}}Zm.\u0275fac=function(e){return new(e||Zm)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Zm.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Zm,imports:[Rm,Mm]}),Zm.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Rm,Mm]]});class eu extends c.ViewDesignerComponentModel{static getInitialProperties(e){return Object.assign({serviceRequestId:null,serviceRequestName:null,serviceRequestGuid:null},e)}rxInit(){this.sandbox.getComponentPropertyValue("serviceRequestId").pipe((0,r.map)(e=>e?[]:[this.sandbox.createError("Selected service request ID cannot be blank.","serviceRequestId")]),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>this.sandbox.setValidationIssues(e)),this.sandbox.componentProperties$.pipe((0,r.take)(1)).subscribe(()=>{this.sandbox.updateInspectorConfig(this.getInspector()),this.sandbox.setCommonDataDictionary(this.getCommonProps())})}getCommonProps(){return{label:this.sandbox.descriptor.name,expression:this.getExpressionForProperty("api"),children:[{label:"Service request ID",expression:this.getExpressionForProperty("serviceRequestId")},{label:"Service request name",expression:this.getExpressionForProperty("serviceRequestName")},{label:"Service request GUID",expression:this.getExpressionForProperty("serviceRequestGuid")}]}}getInspector(){return{inspectorSectionConfigs:[{label:"General",controls:[{name:"serviceRequestId",component:l.ExpressionInspectorControlComponent,options:{label:"Service request ID",isRequired:!0}},{name:"serviceRequestName",component:l.ExpressionInspectorControlComponent,options:{label:"Service request name"}},{name:"serviceRequestGuid",component:l.ExpressionInspectorControlComponent,options:{label:"Service request GUID"}}]}]}}}class tu{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,this.rxViewComponentRegistryService.register({type:d.RxViewComponentType.ServiceList,componentFactory:this.componentFactoryResolver.resolveComponentFactory(xm),name:"Service list",group:c.RX_VIEW_DESIGNER.stencilGroups.chatbotComponents.label,options:{canBeEmbeddedInRecordEditor:!0},canBeInsertedInto:e=>e.includes(d.RxViewComponentType.RecordEditor),properties:[{name:"serviceRequestId",enableExpressionEvaluation:!0,type:d.ViewComponentPropertyType.String},{name:"serviceRequestName",enableExpressionEvaluation:!0,type:d.ViewComponentPropertyType.String},{name:"serviceRequestGuid",enableExpressionEvaluation:!0,type:d.ViewComponentPropertyType.String}],designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(vm),designComponentModel:eu,icon:"field_dropdown",bundleId:s.RX_APPLICATION.chatbotBundleId,availableInBundles:[s.RX_APPLICATION.chatbotBundleId]})}}tu.\u0275fac=function(e){return new(e||tu)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},tu.\u0275mod=n["\u0275\u0275defineNgModule"]({type:tu,imports:[bm,ym]}),tu.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[bm,ym]]});class iu extends c.ViewDesignerComponentModel{constructor(){super(...arguments),this.label=`Unknown component: ${this.sandbox.componentType}`}rxInit(){this.sandbox.componentProperties$.pipe((0,r.take)(1)).subscribe(e=>{this.sandbox.updateInspectorConfig(this.getInspector(e)),this.sandbox.setValidationIssues([this.sandbox.createError(this.label)])})}getInspector(e){return{inspectorSectionConfigs:[{label:"General",controls:(0,m.keys)(e).map(e=>({name:e,component:l.TextFormControlComponent,options:{label:e},isDisabled:!0}))}]}}}class nu{}nu.\u0275fac=function(e){return new(e||nu)},nu.\u0275cmp=n["\u0275\u0275defineComponent"]({type:nu,selectors:[["rx-unknown"]],inputs:{model:"model"},decls:1,vars:1,consts:[["type","objects",3,"label"]],template:function(e,t){1&e&&n["\u0275\u0275element"](0,"adapt-empty-state",0),2&e&&n["\u0275\u0275property"]("label",t.model.label)},directives:[u.AdaptEmptyStateComponent],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{border:1px solid #d6d7d8;display:block;position:relative;padding:1rem;height:200px}'],changeDetection:0});class ou{}ou.\u0275fac=function(e){return new(e||ou)},ou.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ou,declarations:[nu],imports:[f.CommonModule,u.AdaptEmptyStateModule]}),ou.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptEmptyStateModule]]});class ru{constructor(e,t){this.componentFactoryResolver=e,this.rxViewComponentRegistryService=t,t.register({type:d.RxViewComponentType.Unknown,outlets:[{name:d.RX_VIEW_DEFINITION.defaultOutletName}],name:"Unknown",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(nu),designComponentModel:iu,hidden:!0,bundleId:s.RX_APPLICATION.platformBundleId})}}ru.\u0275fac=function(e){return new(e||ru)(n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](d.RxViewComponentRegistryService))},ru.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ru,imports:[ou]}),ru.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[ou]]});const au={commands:{createUserMapping:"com.bmc.arsys.rx.application.chat.command.CreateChatUserMappingCommand"},mappingStatus:{check:"check",failed:"failed",inProgress:"inProgress",missingParameters:"missingParameters",pending:"pending",success:"success"},messages:{check:"com.bmc.arsys.rx.settings.check",failed:"com.bmc.arsys.rx.settings.failed",inProgress:"com.bmc.arsys.rx.settings.inProgress",missingParameters:"com.bmc.arsys.rx.settings.missingParameters",pending:"com.bmc.arsys.rx.settings.pending",success:"com.bmc.arsys.rx.settings.success"}};class su extends h.BaseViewComponent{constructor(e,t,i){super(),this.translateService=e,this.rxCommandFactoryService=t,this.rxNotificationService=i,this.encryptedChatUserAndChatId=null,this.chatbotProvider=null,this.isMappingInProgress=!1,this.message="",this.mappingStatus=""}ngOnInit(){this.isMappingInProgress=!1,this.config.pipe((0,r.take)(1)).subscribe(e=>{this.encryptedChatUserAndChatId=e.encryptedChatUserAndChatId,this.chatbotProvider=e.chatbotProvider,this.encryptedChatUserAndChatId?this.mappingStatus=au.mappingStatus.pending:(this.mappingStatus=au.mappingStatus.missingParameters,this.rxNotificationService.addErrorMessage(this.translateService.instant(au.messages.missingParameters))),this.updateMessage()})}isMappingButtonVisible(){return this.mappingStatus===au.mappingStatus.pending}mapUser(){this.isMappingInProgress=!0,this.mappingStatus=au.mappingStatus.inProgress,this.updateMessage();const e={encryptedChatUserAndChatId:this.encryptedChatUserAndChatId,chatbotProvider:this.chatbotProvider};this.rxCommandFactoryService.forResourceType(au.commands.createUserMapping).execute(e).pipe((0,r.catchError)(e=>(this.mappingStatus=au.mappingStatus.failed,this.updateMessage(),this.isMappingInProgress=!1,(0,o.throwError)(e)))).subscribe(()=>{this.mappingStatus=au.mappingStatus.success,this.updateMessage(),this.isMappingInProgress=!1})}updateMessage(){this.message=this.translateService.instant(au.messages[this.mappingStatus])}}su.\u0275fac=function(e){return new(e||su)(n["\u0275\u0275directiveInject"](p.TranslateService),n["\u0275\u0275directiveInject"](s.RxCommandFactoryService),n["\u0275\u0275directiveInject"](s.RxNotificationService))},su.\u0275cmp=n["\u0275\u0275defineComponent"]({type:su,selectors:[["com-bmc-arsys-rx-user-mapping"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:11,vars:9,consts:[[1,"text-center","mt-1","container"],[1,"text-logo"],[1,"mt-4"],["rx-id","verify-bmc-cloud-account","adapt-button","","btn-type","primary","size","large","type","button",1,"mt-4",3,"disabled","hidden","click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div"),n["\u0275\u0275elementStart"](2,"span",1),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",2),n["\u0275\u0275text"](6),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](7,"div"),n["\u0275\u0275elementStart"](8,"button",3),n["\u0275\u0275listener"]("click",function(){return t.mapUser()}),n["\u0275\u0275text"](9),n["\u0275\u0275pipe"](10,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate"](n["\u0275\u0275pipeBind1"](4,5,"com.bmc.arsys.rx.settings.title")),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate"](t.message),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",t.isMappingInProgress)("hidden",!t.isMappingButtonVisible()),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](10,7,"com.bmc.arsys.rx.settings.verify-cloud-account")," "))},directives:[u.AdaptButtonComponent],pipes:[p.TranslatePipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.container[_ngcontent-%COMP%]{width:400px;margin:auto}.text-logo[_ngcontent-%COMP%]{font-size:var(--h1-font-size)}']});class lu{constructor(e,t){this.componentFactoryResolver=e,this.rxViewComponentRegistryService=t,t.register({type:"com-bmc-arsys-rx-user-mapping",componentFactory:this.componentFactoryResolver.resolveComponentFactory(su),name:"Chatbot User Mapping",availableInBundles:[s.RX_APPLICATION.settingsBundleId],hidden:!0,properties:[{name:"encryptedChatUserAndChatId",enableExpressionEvaluation:!0},{name:"chatbotProvider",enableExpressionEvaluation:!0}]})}}lu.\u0275fac=function(e){return new(e||lu)(n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](d.RxViewComponentRegistryService))},lu.\u0275mod=n["\u0275\u0275defineNgModule"]({type:lu,declarations:[su],imports:[u.AdaptButtonModule,f.CommonModule,b.FormsModule,p.TranslateModule]}),lu.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[u.AdaptButtonModule,f.CommonModule,b.FormsModule,p.TranslateModule]]});const du="LOGIN_SUCCESSFUL";class cu extends h.BaseViewComponent{ngOnInit(){var e;null===(e=window.opener)||void 0===e||e.postMessage(du,"*")}}cu.\u0275fac=function(){let e;return function(t){return(e||(e=n["\u0275\u0275getInheritedFactory"](cu)))(t||cu)}}(),cu.\u0275cmp=n["\u0275\u0275defineComponent"]({type:cu,selectors:[["com-bmc-arsys-rx-settings-iframe-login-event"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:0,consts:[["src","/com.bmc.arsys.rx.settings/resources/images/login-successful.gif","alt","Login successful",1,"login-verification"]],template:function(e,t){1&e&&n["\u0275\u0275element"](0,"img",0)},styles:[".login-verification[_ngcontent-%COMP%]{top:50%;left:50%;position:fixed;transform:translate(-50%,-50%);width:670px}"]});class pu{constructor(e,t){this.componentFactoryResolver=e,this.rxViewComponentRegistryService=t,t.register({type:"com-bmc-arsys-rx-settings-iframe-login-event",componentFactory:this.componentFactoryResolver.resolveComponentFactory(cu),name:"IFrame Login Event",availableInBundles:[s.RX_APPLICATION.settingsBundleId],hidden:!0})}}pu.\u0275fac=function(e){return new(e||pu)(n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](d.RxViewComponentRegistryService))},pu.\u0275mod=n["\u0275\u0275defineNgModule"]({type:pu,declarations:[cu],imports:[f.CommonModule]}),pu.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule]]});class mu{constructor(e){this.rxSmartReportingService=e}ngOnInit(){this.rxSmartReportingService.openSmartReporting("_self",{query:this.runtimeViewModelApi.getViewInputParameters().param}).subscribe()}}mu.\u0275fac=function(e){return new(e||mu)(n["\u0275\u0275directiveInject"](s.RxSmartReportingService))},mu.\u0275cmp=n["\u0275\u0275defineComponent"]({type:mu,selectors:[["rx-smart-reporting-redirector"]],inputs:{runtimeViewModelApi:"runtimeViewModelApi"},decls:3,vars:3,consts:[[1,"p-3"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate"](n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.smart-reporting-redirector.message")))},pipes:[p.TranslatePipe],encapsulation:2});class uu{constructor(e,t){this.componentFactoryResolver=e,this.rxViewComponentRegistryService=t,t.register({type:"rx-smart-reporting-redirector",componentFactory:this.componentFactoryResolver.resolveComponentFactory(mu),name:"Smart reporting redirector",isPageComponent:!0,hidden:!0,availableInBundles:[s.RX_APPLICATION.settingsBundleId]})}}uu.\u0275fac=function(e){return new(e||uu)(n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](d.RxViewComponentRegistryService))},uu.\u0275mod=n["\u0275\u0275defineNgModule"]({type:uu,declarations:[mu],imports:[p.TranslateModule]}),uu.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[p.TranslateModule]]});const fu="23503_SHARABLE_VIEW_PRESET",hu={user:{recordDefinitionName:"CTM:People",fields:{fullName:1000000017,lastName:1000000018,firstName:1000000019,loginId:a.RX_RECORD_DEFINITION.coreFieldIds.assignee,recordId:a.RX_RECORD_DEFINITION.coreFieldIds.id,email:1000000048}},sharedViewPreset:{recordDefinitionName:"com.bmc.arsys.rx.settings:SharedViewPreset",fields:{viewPresetName:58200,viewName:58201,viewPresetInfo:58202,viewPresetSelectorGuid:58203,sharedUsers:58204,id:a.RX_RECORD_DEFINITION.coreFieldIds.id,ownerFullName:58205}}};class gu{constructor(e,t,i,n){this.rxRecordInstanceDataPageService=e,this.rxRecordInstanceService=t,this.httpClient=i,this.rxJsonParserService=n}searchUsers(e){return this.rxRecordInstanceDataPageService.post({params:{recorddefinition:hu.user.recordDefinitionName,propertySelection:[hu.user.fields.fullName,hu.user.fields.email,hu.user.fields.loginId],pageSize:s.RX_DATA_PAGE.defaultPageSize,queryExpression:[hu.user.fields.fullName,hu.user.fields.email,hu.user.fields.loginId].map(t=>`('${t}' LIKE "%${e}%")`).join(" OR ")}}).pipe((0,r.map)(e=>e.data))}getSharedViewPresets(e,t){return this.rxRecordInstanceDataPageService.post({params:{recorddefinition:hu.sharedViewPreset.recordDefinitionName,queryExpression:[`'${hu.sharedViewPreset.fields.viewPresetSelectorGuid}' = "${e}"`].join(" AND "),propertySelection:[hu.sharedViewPreset.fields.viewPresetName,hu.sharedViewPreset.fields.id,hu.sharedViewPreset.fields.ownerFullName,hu.sharedViewPreset.fields.sharedUsers]}}).pipe((0,r.map)(e=>e.data.filter(e=>this.rxJsonParserService.tryParseJson(e[hu.sharedViewPreset.fields.sharedUsers],[]).find(e=>e.loginId===t))))}getSharedViewPreset(e){return this.rxRecordInstanceService.get(hu.sharedViewPreset.recordDefinitionName,e)}createSharedViewPreset(e){return this.httpClient.post(this.getUrl(),e,{responseType:"text"})}updateSharedViewPreset(e,t){return this.httpClient.put(this.getUrl(e),t)}deleteSharedViewPreset(e){return this.rxRecordInstanceService.delete(hu.sharedViewPreset.recordDefinitionName,e)}getUrl(e){return e?`/api/rx/application/configuration/viewpreset/${e}`:"/api/rx/application/configuration/viewpreset"}}gu.\u0275fac=function(e){return new(e||gu)(n["\u0275\u0275inject"](a.RxRecordInstanceDataPageService),n["\u0275\u0275inject"](a.RxRecordInstanceService),n["\u0275\u0275inject"](V.HttpClient),n["\u0275\u0275inject"](v.RxJsonParserService))},gu.\u0275prov=n["\u0275\u0275defineInjectable"]({token:gu,factory:gu.\u0275fac,providedIn:"root"});class vu{constructor(e,t,i,n){this.rxShareViewPresetDataService=e,this.rxStringService=t,this.rxJsonParserService=i,this.rxCurrentUserService=n}getAutocompleteSearch(e){return e.pipe((0,r.debounceTime)(250),(0,r.distinctUntilChanged)(),(0,r.switchMap)(e=>{const t=e.trim();return t.length>0?this.rxShareViewPresetDataService.searchUsers(t):(0,o.of)([])}),(0,r.map)(e=>e.map(e=>({text:e[hu.user.fields.fullName],data:{loginId:e[hu.user.fields.loginId],fullName:e[hu.user.fields.fullName],emailAddress:e[hu.user.fields.email]}}))))}getSharedViewPresetUsers(e){return this.rxShareViewPresetDataService.getSharedViewPreset(e).pipe((0,r.map)(e=>this.rxJsonParserService.tryParseJson(null==e?void 0:e.fieldInstances[hu.sharedViewPreset.fields.sharedUsers].value,[])))}getSharedViewPresetData(e){return this.rxShareViewPresetDataService.getSharedViewPreset(e).pipe((0,r.map)(e=>({viewPresetName:null==e?void 0:e.fieldInstances[hu.sharedViewPreset.fields.viewPresetName].value,sharedViewPresets:this.rxJsonParserService.tryParseJson(null==e?void 0:e.fieldInstances[hu.sharedViewPreset.fields.viewPresetInfo].value,null)})))}createUpdateSharedViewPreset(e,t){return t?this.rxShareViewPresetDataService.updateSharedViewPreset(t,e).pipe((0,r.map)(()=>t)):this.rxShareViewPresetDataService.createSharedViewPreset(e)}saveSharedViewPreset(e,t){const i=e.sharedUsers?(0,o.of)(e.sharedUsers):this.getSharedViewPresetUsers(t);return(0,o.combineLatest)([e.runtimeViewModelApi.shareViewPreset(e.presetSelectorGuid),i]).pipe((0,r.map)(([t,i])=>({viewPresetName:e.currentViewPreset.label,viewName:"",viewPresetGuid:e.presetSelectorGuid,submitter:this.rxCurrentUserService.get().fullName,sharedUsers:i,presetInformation:JSON.stringify(t)})),(0,r.switchMap)(e=>this.createUpdateSharedViewPreset(e,t)))}deleteSharedViewPreset(e){return this.rxShareViewPresetDataService.deleteSharedViewPreset(e)}getSharedViewPresetsForCurrentUser(e){return this.rxShareViewPresetDataService.getSharedViewPresets(e,this.rxCurrentUserService.getName()).pipe((0,r.map)(e=>e.map(e=>({label:e[hu.sharedViewPreset.fields.viewPresetName],guid:e[hu.sharedViewPreset.fields.id],ownerFullName:e[hu.sharedViewPreset.fields.ownerFullName]}))))}}vu.\u0275fac=function(e){return new(e||vu)(n["\u0275\u0275inject"](gu),n["\u0275\u0275inject"](v.RxStringService),n["\u0275\u0275inject"](v.RxJsonParserService),n["\u0275\u0275inject"](s.RxCurrentUserService))},vu.\u0275prov=n["\u0275\u0275defineInjectable"]({token:vu,factory:vu.\u0275fac,providedIn:"root"});class yu{constructor(e,t){this.rxUserPreferencesService=e,this.rxShareViewPresetService=t}save(e){const t=e.customViewPresetOptions.map(e=>(0,m.pick)(e,["guid","label","userSharedViewPresetGuid"])),i=e.sharedViewPresetOptions.map(e=>(0,m.pick)(e,["guid","label"])),n={preferences:JSON.stringify({customViewPresets:t,sharedViewPresets:i,viewPresetGuid:e.appliedViewPresetOption.guid}),componentTypeName:d.RxViewComponentType.ViewPresetSelector,version:"1.0",componentId:this.viewPresetSelectorGuid};return this.rxUserPreferencesService.setUiComponentPreferences(n,this.viewPresetSelectorGuid)}applyUserPreferences(e,t){return this.viewPresetSelectorGuid=e,this.get(e).pipe((0,r.map)(e=>(t.customViewPresetOptions=e.customViewPresets,e.sharedViewPresets&&(t.sharedViewPresetOptions=e.sharedViewPresets.map(e=>Object.assign(Object.assign({},e),{isShared:!0}))),t.appliedViewPresetOption=(0,m.find)(t.customViewPresetOptions,{guid:e.viewPresetGuid})||(0,m.find)(t.systemViewPresetOptions,{guid:e.viewPresetGuid})||(0,m.find)(t.sharedViewPresetOptions,{guid:e.viewPresetGuid})||t.systemViewPresetOptions[0],t)),(0,r.switchMap)(e=>this.checkSharedViewPresets(e)))}get(e){return this.rxUserPreferencesService.getUiComponentPreferences(e).pipe((0,r.map)(e=>null!=e?e:{customViewPresets:[],sharedViewPresets:[],viewPresetGuid:null}))}checkSharedViewPresets(e){return e.sharedViewPresetOptions.length?this.rxShareViewPresetService.getSharedViewPresetsForCurrentUser(this.viewPresetSelectorGuid).pipe((0,r.map)(t=>{let i=!1,n=null;if(e.sharedViewPresetOptions=e.sharedViewPresetOptions.reduce((e,n)=>{const o=t.find(e=>e.guid===n.guid);return o?(n.label!==o.label&&(n.label=o.label,i=!0),e.push(n)):i=!0,e},[]),e.appliedViewPresetOption.isShared){const t=e.sharedViewPresetOptions.find(t=>t.guid===e.appliedViewPresetOption.guid);t&&e.isSharingEnabled||(t||(n=e.appliedViewPresetOption.guid),e.appliedViewPresetOption=e.systemViewPresetOptions[0])}return{state:e,shouldUpdatePreferences:i,removedPresetGuid:n}})):(0,o.of)({state:e,shouldUpdatePreferences:!1,removedPresetGuid:null})}}yu.\u0275fac=function(e){return new(e||yu)(n["\u0275\u0275inject"](s.RxUserPreferencesService),n["\u0275\u0275inject"](vu))},yu.\u0275prov=n["\u0275\u0275defineInjectable"]({token:yu,factory:yu.\u0275fac});class xu extends S.RxModalClass{constructor(e,t){super(e,t),this.activeModalRef=e,this.injector=t,this.viewPresetNameFormControl=new b.FormControl(""),this.destroyed$=new o.ReplaySubject(1),this.modalData=this.activeModalRef.getData(),this.viewPresetNameFormControl.setValue(this.modalData.viewPresetName),this.viewPresetNameFormControl.valueChanges.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.viewPresetNameFormControl.dirty&&e===this.modalData.viewPresetName&&this.viewPresetNameFormControl.reset(this.modalData.viewPresetName)})}ngOnInit(){super.ngOnInit()}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}save(){this.activeModalRef.close(this.generateUniqueViewPresetName(this.viewPresetNameFormControl.value))}cancel(){this.activeModalRef.dismiss(u.DismissReasons.CLOSE_BTN)}isViewPresetNameUnique(e){const t=e.trim();return!this.modalData.existingViewPresetNames.some(e=>e===t)}generateUniqueViewPresetName(e){const t=e.trim();let i=t,n=1;for(;!this.isViewPresetNameUnique(i);)i=`${t}-${n++}`;return i}}xu.\u0275fac=function(e){return new(e||xu)(n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](n.Injector))},xu.\u0275cmp=n["\u0275\u0275defineComponent"]({type:xu,selectors:[["rx-rename-view-preset"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:10,vars:12,consts:[[1,"modal-body"],["name","viewPresetName","rx-id","view-preset-name-field","required","true","rxNoWhitespace","",3,"formControl","label","maxlength","autofocus"],["class","text-info m-0 pt-1",4,"ngIf"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click"],["adapt-button","","btn-type","secondary","type","button","rx-id","cancel-button",3,"click"],[1,"text-info","m-0","pt-1"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275element"](1,"adapt-rx-textfield",1),n["\u0275\u0275template"](2,Ga,3,3,"p",2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"div",3),n["\u0275\u0275elementStart"](4,"button",4),n["\u0275\u0275listener"]("click",function(){return t.save()}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](7,"button",5),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](8),n["\u0275\u0275pipe"](9,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("formControl",t.viewPresetNameFormControl)("label",t.modalData.fieldLabel)("maxlength",254)("autofocus",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.isViewPresetNameUnique(t.viewPresetNameFormControl.value)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",t.viewPresetNameFormControl.invalid||t.viewPresetNameFormControl.pristine),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,8,"com.bmc.arsys.rx.client.common.save.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](9,10,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[u.AdaptRxTextfieldComponent,b.RequiredValidator,v.RxNoWhitespaceValidator,b.NgControlStatus,b.FormControlDirective,b.MaxLengthValidator,f.NgIf,u.AdaptButtonComponent],pipes:[p.TranslatePipe],encapsulation:2});class bu{constructor(e){this.translateService=e,this.users=[],this.remove=new n.EventEmitter,this.recordGridConfig$=this.getRecordGridConfig()}ngOnChanges(e){e.users.currentValue&&!e.users.firstChange&&this.recordGrid.api.refresh().subscribe()}getRecordGridConfig(){const e=[{fieldId:"fullName",title:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share-view-preset.grid.column.name.title")},{fieldId:"emailAddress",title:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share-view-preset.grid.column.email.title")}],t={fieldDefinitions:[{id:"fullName",resourceType:a.RX_RECORD_DEFINITION.resourceTypes.character},{id:"emailAddress",resourceType:a.RX_RECORD_DEFINITION.resourceTypes.character}]};return(0,o.of)({columns:e,enableFiltering:!1,enableRowSelection:op.Multiple,recordIdField:"loginId",styles:"flex-fill",toolbarConfig:{filter:!1,visibleColumnsMenu:!1},useExternalFiltering:!1,actionButtons:[{label:this.translateService.instant("com.bmc.arsys.rx.client.common.remove.label"),style:"tertiary",iconCls:"minus_circle_o",disabled:()=>0===this.recordGrid.api.getSelectedRows().length,actions:[{name:()=>{const e=this.recordGrid.api.getSelectedRows().map(e=>e.loginId);this.remove.emit(e)}}]}],getRecordDefinition:()=>(0,o.of)(t),getData:()=>(0,o.of)({data:this.users,totalSize:this.users.length})})}}bu.\u0275fac=function(e){return new(e||bu)(n["\u0275\u0275directiveInject"](p.TranslateService))},bu.\u0275cmp=n["\u0275\u0275defineComponent"]({type:bu,selectors:[["rx-share-view-preset-users-grid"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](om,7),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.recordGrid=e.first)}},inputs:{users:"users"},outputs:{remove:"remove"},features:[n["\u0275\u0275NgOnChangesFeature"]],decls:1,vars:1,consts:[[3,"config"]],template:function(e,t){1&e&&n["\u0275\u0275element"](0,"rx-record-grid",0),2&e&&n["\u0275\u0275property"]("config",t.recordGridConfig$)},directives:[om],encapsulation:2,changeDetection:0});class Cu extends S.RxModalClass{constructor(e,t,i,n,a,s,l){super(e,t),this.activeModalRef=e,this.injector=t,this.formBuilder=i,this.translateService=n,this.rxShareViewPresetService=a,this.rxCurrentUserService=s,this.rxNotificationService=l,this.maxRecipients=100,this.strings={users:{label:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share-view-preset.users-control.label"),placeholder:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share-view-preset.users-control.placeholder")},addButton:this.translateService.instant("com.bmc.arsys.rx.client.common.add.label"),notifyRecipients:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share-view-preset.notify-recipients.label"),recipients:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share-view-preset.recipients.label"),savedNotification:{title:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share-view-preset.saved-notification.title"),message:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share-view-preset.saved-notification.message")},removedNotification:{title:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share-view-preset.removed-notification.title"),message:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share-view-preset.removed-notification.message")},maxRecipientsWarning:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share-view-preset.max-users-warning.message",{maxUserCount:this.maxRecipients})},this.form=this.formBuilder.group({users:this.formBuilder.control([]),notifyRecipients:this.formBuilder.control(!1)}),this.modalData=this.activeModalRef.getData(),this.runtimeViewModelApi=this.modalData.runtimeViewModelApi,this.selectedUsers=[],this.destroyed$=new o.ReplaySubject(1),this.currentUserLoginName=this.rxCurrentUserService.getName(),this.isSelectedUsersChanged=!1,this.search=e=>this.rxShareViewPresetService.getAutocompleteSearch(e).pipe((0,r.map)(e=>{const t=this.selectedUsers.map(e=>e.loginId),i=this.form.get("users").value.map(({data:e})=>e.loginId);return e.filter(e=>e.data.loginId!==this.currentUserLoginName&&!t.includes(e.data.loginId)&&!i.includes(e.data.loginId))}))}get isRecipientsLimitReached(){return this.form.get("users").value.length+this.selectedUsers.length>this.maxRecipients}ngOnInit(){super.ngOnInit(),this.loadExistingSharedViewPresetUsers()}loadExistingSharedViewPresetUsers(){this.modalData.currentViewPreset.userSharedViewPresetGuid&&(this.sharedViewPresetInstanceGuid=this.modalData.currentViewPreset.userSharedViewPresetGuid,this.rxShareViewPresetService.getSharedViewPresetUsers(this.sharedViewPresetInstanceGuid).subscribe(e=>{this.selectedUsers=e}))}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}save(){this.selectedUsers.length?this.saveViewPreset():this.removeViewPreset()}removeViewPreset(){this.rxShareViewPresetService.deleteSharedViewPreset(this.sharedViewPresetInstanceGuid).subscribe(()=>{this.rxNotificationService.addSuccessMessage(this.strings.removedNotification.message,this.strings.removedNotification.title),this.activeModalRef.close(null)})}saveViewPreset(){this.rxShareViewPresetService.saveSharedViewPreset({runtimeViewModelApi:this.runtimeViewModelApi,currentViewPreset:this.modalData.currentViewPreset,presetSelectorGuid:this.modalData.presetSelectorGuid,sharedUsers:this.selectedUsers},this.sharedViewPresetInstanceGuid).subscribe(e=>{this.rxNotificationService.addSuccessMessage(this.strings.savedNotification.message,this.strings.savedNotification.title),this.activeModalRef.close(e)})}cancel(){this.activeModalRef.dismiss(u.DismissReasons.CLOSE_BTN)}onAdd(){const e=this.form.get("users").value.map(e=>Object.assign({},e.data));this.selectedUsers=this.selectedUsers.concat(e),this.form.get("users").setValue([]),this.isSelectedUsersChanged=!0}removeSelectedUsers(e){this.selectedUsers=this.selectedUsers.filter(t=>!e.includes(t.loginId)),this.isSelectedUsersChanged=!0,this.markAsDirty()}isSaveButtonDisabled(){return!(this.sharedViewPresetInstanceGuid&&this.isSelectedUsersChanged||!this.sharedViewPresetInstanceGuid&&this.selectedUsers.length>0)}}Cu.\u0275fac=function(e){return new(e||Cu)(n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](b.FormBuilder),n["\u0275\u0275directiveInject"](p.TranslateService),n["\u0275\u0275directiveInject"](vu),n["\u0275\u0275directiveInject"](s.RxCurrentUserService),n["\u0275\u0275directiveInject"](s.RxNotificationService))},Cu.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Cu,selectors:[["rx-share-view-preset"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:21,vars:19,consts:[[1,"modal-body"],[3,"formGroup"],[1,"row","row-no-gutters"],[1,"col"],["formControlName","users","rx-id","users-input",3,"label","placeholder","replaceModelOnWrite","suppressManual","search","selectItemTemplate","ngModelChange"],["class","warning mb-3",4,"ngIf"],[1,"col-auto","pl-0"],["adapt-button","","type","button","btn-type","secondary","rx-id","add-button",1,"add-button",3,"disabled","click"],[3,"label"],[3,"users","remove"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click"],["adapt-button","","btn-type","secondary","type","button","rx-id","cancel-button",3,"click"],["selectItemTemplate",""],[1,"warning","mb-3"],["name","exclamation_triangle",1,"text-warning"]],template:function(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"form",1),n["\u0275\u0275elementStart"](2,"div",2),n["\u0275\u0275elementStart"](3,"div",3),n["\u0275\u0275elementStart"](4,"adapt-tag-field",4),n["\u0275\u0275listener"]("ngModelChange",function(){return t.markAsDirty()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](5,qa,3,1,"div",5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](6,"div",6),n["\u0275\u0275elementStart"](7,"button",7),n["\u0275\u0275listener"]("click",function(){return t.onAdd()}),n["\u0275\u0275elementStart"](8,"span"),n["\u0275\u0275text"](9),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](10,"adapt-rx-control-label",8),n["\u0275\u0275elementStart"](11,"rx-share-view-preset-users-grid",9),n["\u0275\u0275listener"]("remove",function(e){return t.removeSelectedUsers(e)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](12,"div",10),n["\u0275\u0275elementStart"](13,"button",11),n["\u0275\u0275listener"]("click",function(){return t.save()}),n["\u0275\u0275text"](14),n["\u0275\u0275pipe"](15,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](16,"button",12),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](17),n["\u0275\u0275pipe"](18,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](19,Ua,4,2,"ng-template",null,13,n["\u0275\u0275templateRefExtractor"])),2&e){const e=n["\u0275\u0275reference"](20);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("formGroup",t.form),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("label",t.strings.users.label)("placeholder",t.strings.users.placeholder)("replaceModelOnWrite",!0)("suppressManual",!0)("search",t.search)("selectItemTemplate",e),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.isRecipientsLimitReached),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",!t.form.get("users").value.length||t.isRecipientsLimitReached),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](t.strings.addButton),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("label",t.strings.recipients),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("users",t.selectedUsers),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",t.isSaveButtonDisabled()),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](15,15,"com.bmc.arsys.rx.client.common.save.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](18,17,"com.bmc.arsys.rx.client.common.cancel.label")," ")}},directives:[b["\u0275NgNoValidate"],b.NgControlStatusGroup,b.FormGroupDirective,u.AdaptMetatagComponent,b.NgControlStatus,b.FormControlName,f.NgIf,u.AdaptButtonComponent,u.AdaptRxControlLabelComponent,bu,u.AdaptIconComponent],pipes:[p.TranslatePipe],styles:[".add-button[_ngcontent-%COMP%]{margin-top:23px}.warning[_ngcontent-%COMP%]{margin-top:-10px}[_nghost-%COMP%]  adapt-tag-field .adapt-mt-wrapper{min-height:80px;padding-right:5px}[_nghost-%COMP%]  adapt-tag-field .adapt-mt-wrapper .adapt-mt{max-height:72px!important}"]});class Su extends S.RxModalClass{constructor(e,t,i){super(e,t),this.activeModalRef=e,this.injector=t,this.translateService=i,this.recordGridConfig$=(0,o.of)({columns:[{fieldId:"label",title:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.add-shared-view-preset.grid.column.preset-name.title")},{fieldId:"ownerFullName",title:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.add-shared-view-preset.grid.column.shared-by.title")}],enableFiltering:!1,enableRowSelection:op.Multiple,recordIdField:"guid",styles:"flex-fill",toolbarConfig:{filter:!1,visibleColumnsMenu:!1},useExternalFiltering:!1,getRecordDefinition:()=>(0,o.of)({fieldDefinitions:[{id:"label",resourceType:a.RX_RECORD_DEFINITION.resourceTypes.character},{id:"ownerFullName",resourceType:a.RX_RECORD_DEFINITION.resourceTypes.character}]}),getData:()=>(0,o.of)({data:this.presets,totalSize:this.presets.length})}),this.modalData=this.activeModalRef.getData(),this.presets=this.modalData.newPresets}ngOnInit(){super.ngOnInit(),this.isAddButtonDisabled$=this.recordGrid.rowSelectionChanged.pipe((0,r.map)(m.isEmpty))}add(){const e=this.recordGrid.api.getSelectedRows().map(({label:e,guid:t})=>({label:e,guid:t}));this.activeModalRef.close(e)}cancel(){this.activeModalRef.dismiss(u.DismissReasons.CLOSE_BTN)}}Su.\u0275fac=function(e){return new(e||Su)(n["\u0275\u0275directiveInject"](u.ActiveModalRef),n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](p.TranslateService))},Su.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Su,selectors:[["rx-add-shared-view-presets"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](om,7),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.recordGrid=e.first)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:13,vars:13,consts:[[1,"modal-body"],[1,"mb-4",2,"white-space","pre-line"],[3,"config"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","add-button",3,"disabled","click"],["adapt-button","","btn-type","secondary","type","button","rx-id","cancel-button",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](4,"rx-record-grid",2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",3),n["\u0275\u0275elementStart"](6,"button",4),n["\u0275\u0275listener"]("click",function(){return t.add()}),n["\u0275\u0275pipe"](7,"async"),n["\u0275\u0275text"](8),n["\u0275\u0275pipe"](9,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"button",5),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](11),n["\u0275\u0275pipe"](12,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,5,"com.bmc.arsys.rx.client.view-components.view-preset-selector.add-shared-view-preset.description.label")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("config",t.recordGridConfig$),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",n["\u0275\u0275pipeBind1"](7,7,t.isAddButtonDisabled$)),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](9,9,"com.bmc.arsys.rx.client.common.add.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](12,11,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[om,u.AdaptButtonComponent],pipes:[p.TranslatePipe,f.AsyncPipe],encapsulation:2,changeDetection:0});class wu extends h.BaseViewComponent{constructor(e,t,i,n,a,s,l,d,c){super(),this.changeDetectorRef=e,this.rxGuidService=t,this.rxModalService=i,this.rxUtilityModalsService=n,this.rxViewPresetSelectorUserPreferencesService=a,this.translateService=s,this.rxFeatureService=l,this.rxNotificationService=d,this.rxShareViewPresetService=c,this.api={getGuid:()=>this.guid,markAppliedViewPresetAsEdited:this.markAppliedViewPresetAsEdited.bind(this)},this.isOperationInProgressSubject=new o.BehaviorSubject(!1),this.isViewPresetEditedSubject=new o.BehaviorSubject(!1),this.viewPresetSelectorModel$=(0,o.combineLatest)([this.isOperationInProgressSubject,this.isViewPresetEditedSubject]).pipe((0,r.map)(([e,t])=>({isOperationInProgress:e,isViewPresetEdited:t}))),this.strings={deleteLabel:this.translateService.instant("com.bmc.arsys.rx.client.common.delete.label"),discardChangesButtonLabel:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.discard-changes.button.label"),editedViewPresetTagLabel:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.edited-view-preset-tag.label"),renameLabel:this.translateService.instant("com.bmc.arsys.rx.client.common.rename.label"),saveLabel:this.translateService.instant("com.bmc.arsys.rx.client.common.save.label"),saveAsLabel:this.translateService.instant("com.bmc.arsys.rx.client.common.save-as.label"),shareLabel:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share.button.label"),systemPresetsTitle:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.preset-type.system.label"),sharedPresetsTitle:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.preset-type.shared-with-me.label"),customPresetsTitle:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.preset-type.created-by-me.label"),sharedTooltip:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.shared-preset.tooltip"),addSharedViewPresets:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.add-shared-view-preset.title")},this.userPreferencesChangedSubject=new o.Subject,this.isSharingFeatureEnabled=this.rxFeatureService.isFeatureEnabled(fu),this.userPreferencesChangedSubject.pipe((0,r.switchMap)(()=>this.rxViewPresetSelectorUserPreferencesService.save(this.state)),(0,r.takeUntil)(this.destroyed$)).subscribe()}ngOnInit(){super.ngOnInit(),this.notifyPropertyChanged("api",this.api),this.config.pipe((0,r.take)(1),(0,r.map)(e=>({systemViewPresetOptions:e.viewPresets,customViewPresetOptions:[],sharedViewPresetOptions:[],appliedViewPresetOption:null,isSharingEnabled:e.enableSharing&&this.isSharingFeatureEnabled})),(0,r.switchMap)(e=>this.rxViewPresetSelectorUserPreferencesService.applyUserPreferences(this.guid,e)),(0,r.tap)(({state:e,shouldUpdatePreferences:t,removedPresetGuid:i})=>{this.state=e,this.changeDetectorRef.detectChanges(),this.isOperationInProgressSubject.next(!0),i&&this.runtimeViewModelApi.deleteViewPreset(i).subscribe(),t&&this.userPreferencesChangedSubject.next()}),(0,r.switchMap)(()=>this.applyViewPreset(this.state.appliedViewPresetOption)),(0,r.finalize)(()=>this.isOperationInProgressSubject.next(!1))).subscribe()}ngOnDestroy(){super.ngOnDestroy(),this.isOperationInProgressSubject.complete(),this.isViewPresetEditedSubject.complete(),this.userPreferencesChangedSubject.complete()}deleteViewPreset(e){this.rxUtilityModalsService.confirm(this.translateService.instant(e.userSharedViewPresetGuid?"com.bmc.arsys.rx.client.view-components.view-preset-selector.delete-shared-view-preset-confirmation.message":"com.bmc.arsys.rx.client.view-components.view-preset-selector.delete-view-preset-confirmation.message")).then(t=>{if(t){const t=this.state.appliedViewPresetOption.guid;this.state.appliedViewPresetOption=this.state.systemViewPresetOptions[0],this.isViewPresetEditedSubject.next(!1),this.state.customViewPresetOptions=(0,m.reject)(this.state.customViewPresetOptions,{guid:t}),this.state.sharedViewPresetOptions=(0,m.reject)(this.state.sharedViewPresetOptions,{guid:t}),this.userPreferencesChangedSubject.next(),this.isOperationInProgressSubject.next(!0),this.runtimeViewModelApi.applyViewPreset(this.guid,this.state.appliedViewPresetOption.guid).pipe((0,r.finalize)(()=>{(e.userSharedViewPresetGuid?this.rxShareViewPresetService.deleteSharedViewPreset(e.userSharedViewPresetGuid):(0,o.of)(null)).pipe((0,r.switchMap)(()=>this.runtimeViewModelApi.deleteViewPreset(t)),(0,r.finalize)(()=>this.isOperationInProgressSubject.next(!1))).subscribe()})).subscribe()}}).catch(m.noop)}discardViewPresetChanges(){this.rxUtilityModalsService.confirm(this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.discard-changes-confirmation.message")).then(e=>{if(e){this.isViewPresetEditedSubject.next(!1),this.isOperationInProgressSubject.next(!0);const e=this.state.appliedViewPresetOption;(0,o.iif)(()=>e.isShared,this.getSharedViewPresetData(e).pipe((0,r.switchMap)(t=>this.runtimeViewModelApi.discardViewPresetChanges(e.guid,t))),this.runtimeViewModelApi.discardViewPresetChanges(e.guid)).pipe((0,r.finalize)(()=>this.isOperationInProgressSubject.next(!1))).subscribe()}}).catch(m.noop)}renameViewPreset(){this.openRenamingModal(this.strings.renameLabel,!0).then(e=>{this.state.appliedViewPresetOption.label=e,this.state.customViewPresetOptions=(0,m.sortBy)(this.state.customViewPresetOptions,"label"),this.userPreferencesChangedSubject.next(),this.changeDetectorRef.detectChanges(),this.state.appliedViewPresetOption.userSharedViewPresetGuid&&this.saveSharedViewPreset().subscribe()}).catch(m.noop)}selectPreset(e){this.state.appliedViewPresetOption=e,this.isViewPresetEditedSubject.next(!1),this.userPreferencesChangedSubject.next(),this.isOperationInProgressSubject.next(!0),this.applyViewPreset(e).pipe((0,r.finalize)(()=>this.isOperationInProgressSubject.next(!1))).subscribe()}saveAsViewPreset(){this.openRenamingModal(this.strings.saveAsLabel).then(e=>{const t={guid:this.rxGuidService.generate(),label:e};this.state.customViewPresetOptions.push(t),this.state.customViewPresetOptions=(0,m.sortBy)(this.state.customViewPresetOptions,"label"),this.state.appliedViewPresetOption=t,this.isViewPresetEditedSubject.next(!1),this.userPreferencesChangedSubject.next(),this.isOperationInProgressSubject.next(!0),this.runtimeViewModelApi.applyViewPreset(this.guid,this.state.appliedViewPresetOption.guid).pipe((0,r.finalize)(()=>this.isOperationInProgressSubject.next(!1))).subscribe()}).catch(m.noop)}saveViewPreset(){this.isViewPresetEditedSubject.next(!1),this.isOperationInProgressSubject.next(!0);(this.state.appliedViewPresetOption.userSharedViewPresetGuid?this.saveSharedViewPreset():(0,o.of)(null)).pipe((0,r.switchMap)(()=>this.runtimeViewModelApi.saveViewPreset(this.state.appliedViewPresetOption.guid)),(0,r.finalize)(()=>this.isOperationInProgressSubject.next(!1))).subscribe()}shareViewPreset(){this.rxModalService.openModal({content:Cu,title:this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.share-view-preset.title"),data:{runtimeViewModelApi:this.runtimeViewModelApi,currentViewPreset:this.state.appliedViewPresetOption,presetSelectorGuid:this.guid},size:"sm"}).then(e=>{this.state.appliedViewPresetOption.userSharedViewPresetGuid=e,this.userPreferencesChangedSubject.next()}).catch(m.noop)}onAddSharedPresetsClick(){this.rxShareViewPresetService.getSharedViewPresetsForCurrentUser(this.guid).subscribe(e=>{const t=this.state.sharedViewPresetOptions.map(e=>e.guid),i=e.filter(e=>!t.includes(e.guid));i.length?this.openAddSharedPresetsModal(i):this.rxNotificationService.addInfoMessage(this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.add-shared-view-preset.notification.no-new-presets.message"),this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.add-shared-view-preset.notification.no-new-presets.title"))})}openAddSharedPresetsModal(e){this.rxModalService.openModal({content:Su,title:this.strings.addSharedViewPresets,data:{presetSelectorGuid:this.guid,newPresets:e},size:"sm"}).then(e=>{this.state.sharedViewPresetOptions=this.state.sharedViewPresetOptions.concat(e.map(e=>Object.assign(Object.assign({},e),{isShared:!0}))),this.userPreferencesChangedSubject.next(),e.length&&this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.add-shared-view-preset.notification.presets-added.message"),this.translateService.instant("com.bmc.arsys.rx.client.view-components.view-preset-selector.add-shared-view-preset.notification.presets-added.title"))}).catch(m.noop)}markAppliedViewPresetAsEdited(){this.isViewPresetEditedSubject.next(!0)}openRenamingModal(e,t){let i=[...this.state.customViewPresetOptions,...this.state.systemViewPresetOptions];return t&&(i=i.filter(e=>e.guid!==this.state.appliedViewPresetOption.guid)),this.rxModalService.openModal({content:xu,data:{fieldLabel:e,existingViewPresetNames:i.map(({label:e})=>e),viewPresetName:this.state.appliedViewPresetOption.label},size:"sm"})}applyViewPreset(e){return e.isShared?this.getSharedViewPresetData(e).pipe((0,r.switchMap)(t=>this.runtimeViewModelApi.applyViewPreset(this.guid,e.guid,t)),(0,r.catchError)(t=>this.handleSharedViewPresetLoadError(t,e))):this.runtimeViewModelApi.applyViewPreset(this.guid,e.guid)}saveSharedViewPreset(){return this.rxShareViewPresetService.saveSharedViewPreset({runtimeViewModelApi:this.runtimeViewModelApi,currentViewPreset:this.state.appliedViewPresetOption,presetSelectorGuid:this.guid},this.state.appliedViewPresetOption.userSharedViewPresetGuid)}getSharedViewPresetData(e){return this.rxShareViewPresetService.getSharedViewPresetData(e.guid).pipe((0,r.map)(({viewPresetName:t,sharedViewPresets:i})=>(e.label=t,i)))}handleSharedViewPresetLoadError(e,t){return 404===e.status?(this.state.sharedViewPresetOptions=this.state.sharedViewPresetOptions.filter(e=>e.guid!==t.guid),this.runtimeViewModelApi.deleteViewPreset(t.guid).subscribe(),this.selectPreset(this.state.systemViewPresetOptions[0]),o.EMPTY):(0,o.throwError)(e)}}wu.\u0275fac=function(e){return new(e||wu)(n["\u0275\u0275directiveInject"](n.ChangeDetectorRef),n["\u0275\u0275directiveInject"](v.RxGuidService),n["\u0275\u0275directiveInject"](S.RxModalService),n["\u0275\u0275directiveInject"](S.RxUtilityModalsService),n["\u0275\u0275directiveInject"](yu),n["\u0275\u0275directiveInject"](p.TranslateService),n["\u0275\u0275directiveInject"](s.RxFeatureService),n["\u0275\u0275directiveInject"](s.RxNotificationService),n["\u0275\u0275directiveInject"](vu))},wu.\u0275cmp=n["\u0275\u0275defineComponent"]({type:wu,selectors:[["rx-view-preset-selector"]],inputs:{config:"config",runtimeViewModelApi:"runtimeViewModelApi"},features:[n["\u0275\u0275ProvidersFeature"]([yu]),n["\u0275\u0275InheritDefinitionFeature"]],decls:2,vars:3,consts:[[4,"ngIf"],["class","btn-group align-items-center",4,"ngIf"],[1,"btn-group","align-items-center"],["adaptDropdown",""],["adapt-button","","adaptDropdownToggle","","type","button","btn-type","tertiary","rx-id","toggle-button",1,"text-default","font-weight-bold","text-left",3,"disabled"],["adaptDropdownMenu","","tabindex","0"],["class","dropdown-heading",4,"ngIf"],["class","dropdown-item","type","button","rx-id","system-view-preset",3,"active","click",4,"ngFor","ngForOf"],["class","badge badge-secondary extra-small mx-2",4,"ngIf"],["btn-type","tertiary","class","d-icon-left-floppy p-2","rx-id","save-button",3,"disabled","click",4,"ngIf"],["btn-type","tertiary","class","d-icon-left-save_all_o","rx-id","save-as-button",3,"disabled","click",4,"ngIf"],["class","dropdown header-cell-menu-btn","adaptDropdown","",4,"ngIf"],["class","dropdown-item","type","button","rx-id","custom-view-preset",3,"active","click",4,"ngFor","ngForOf"],["class","dropdown-divider",4,"ngIf"],[1,"dropdown-heading"],["type","button","rx-id","custom-view-preset",1,"dropdown-item",3,"click"],["name","users","class","btn-link float-end ml-2",3,"adaptTooltip",4,"ngIf"],["name","users",1,"btn-link","float-end","ml-2",3,"adaptTooltip"],[1,"dropdown-divider"],["type","button","rx-id","add-preset-button",1,"btn","btn-link","float-end","p-0","pl-1","btn-add-shared",3,"adaptTooltip","click"],["name","plus"],["class","dropdown-item","type","button","rx-id","shared-view-preset",3,"active","click",4,"ngFor","ngForOf"],["type","button","rx-id","shared-view-preset",1,"dropdown-item",3,"click"],["type","button","rx-id","system-view-preset",1,"dropdown-item",3,"click"],[1,"badge","badge-secondary","extra-small","mx-2"],["btn-type","tertiary","rx-id","save-button",1,"d-icon-left-floppy","p-2",3,"disabled","click"],["btn-type","tertiary","rx-id","save-as-button",1,"d-icon-left-save_all_o",3,"disabled","click"],["adaptDropdown","",1,"dropdown","header-cell-menu-btn"],["rx-id","more-actions-toggle-button","type","button","adaptDropdownToggle","",1,"d-icon-ellipsis","btn","btn-link","px-0",3,"disabled","showCaret"],["adaptDropdownMenu","","tabindex","0",1,"dropdown-menu"],["btn-type","tertiary","class","d-icon-left-undo_adapt dropdown-item","rx-id","discard-changes-button",3,"click",4,"ngIf"],["btn-type","tertiary","class","d-icon-left-save_all_o dropdown-item","rx-id","save-as-button",3,"click",4,"ngIf"],["btn-type","tertiary","class","d-icon-left-field_text dropdown-item","rx-id","rename-selected-view-preset-button",3,"click",4,"ngIf"],["btn-type","tertiary","class","d-icon-left-trash_adapt dropdown-item","rx-id","remove-selected-view-preset-button",3,"click",4,"ngIf"],["btn-type","tertiary","class","d-icon-left-share dropdown-item","rx-id","share-view-preset-button",3,"click",4,"ngIf"],["btn-type","tertiary","rx-id","discard-changes-button",1,"d-icon-left-undo_adapt","dropdown-item",3,"click"],["btn-type","tertiary","rx-id","save-as-button",1,"d-icon-left-save_all_o","dropdown-item",3,"click"],["btn-type","tertiary","rx-id","rename-selected-view-preset-button",1,"d-icon-left-field_text","dropdown-item",3,"click"],["btn-type","tertiary","rx-id","remove-selected-view-preset-button",1,"d-icon-left-trash_adapt","dropdown-item",3,"click"],["btn-type","tertiary","rx-id","share-view-preset-button",1,"d-icon-left-share","dropdown-item",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,cs,2,1,"ng-container",0),n["\u0275\u0275pipe"](1,"async")),2&e&&n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](1,1,t.viewPresetSelectorModel$))},directives:[f.NgIf,u.AdaptDropdownDirective,u.AdaptButtonComponent,u.AdaptDropdownToggleDirective,u.AdaptDropdownMenuDirective,f.NgForOf,u.AdaptIconComponent,u.AdaptTooltipDirective],pipes:[f.AsyncPipe],styles:["button[rx-id=toggle-button][_ngcontent-%COMP%], button[rx-id=shared-view-preset][_ngcontent-%COMP%]{white-space:normal;word-break:break-word}.preset-selector[_ngcontent-%COMP%]   .dropdown-heading[_ngcontent-%COMP%]{padding:.375rem .875rem;font-weight:bold}.preset-selector[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{padding-left:1.75rem}.btn-add-shared[_ngcontent-%COMP%]{margin-top:-1px}"],changeDetection:0});class Du{adaptDefinition(e){e.componentDefinitions.sort((e,t)=>e.propertiesByName.index-t.propertiesByName.index).forEach(e=>{Object.assign(e.propertiesByName,{guid:e.guid,isSystem:!0})})}}Du.\u0275fac=function(e){return new(e||Du)},Du.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Du,factory:Du.\u0275fac});class Ru{}Ru.\u0275fac=function(e){return new(e||Ru)},Ru.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ru,declarations:[Cu,bu],imports:[u.AdaptMetatagModule,u.AdaptButtonModule,b.ReactiveFormsModule,p.TranslateModule,sm,f.CommonModule,u.AdaptIconModule,u.AdaptRxLabelModule]}),Ru.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[u.AdaptMetatagModule,u.AdaptButtonModule,b.ReactiveFormsModule,p.TranslateModule,sm,f.CommonModule,u.AdaptIconModule,u.AdaptRxLabelModule]]});class Iu{}Iu.\u0275fac=function(e){return new(e||Iu)},Iu.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Iu,declarations:[Su],imports:[f.CommonModule,p.TranslateModule,u.AdaptButtonModule,sm]}),Iu.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,p.TranslateModule,u.AdaptButtonModule,sm]]});class Fu{constructor(e,t){this.rxDefinitionAdapterRegistryService=e,this.viewPresetSelectorAdapterService=t,e.registerRuntimeAdapter(d.RxViewComponentType.ViewPresetSelector,this.viewPresetSelectorAdapterService)}}Fu.\u0275fac=function(e){return new(e||Fu)(n["\u0275\u0275inject"](s.RxDefinitionAdapterRegistryService),n["\u0275\u0275inject"](Du))},Fu.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Fu,declarations:[xu,wu],imports:[u.AdaptButtonModule,u.AdaptDropdownModule,u.AdaptRxTextfieldModule,u.AdaptTooltipModule,f.CommonModule,b.ReactiveFormsModule,v.RxUniqueValidatorModule,p.TranslateModule,v.RxNoWhitespaceValidatorModule,Ru,Iu,u.AdaptIconModule],exports:[wu]}),Fu.\u0275inj=n["\u0275\u0275defineInjector"]({providers:[Du],imports:[[u.AdaptButtonModule,u.AdaptDropdownModule,u.AdaptRxTextfieldModule,u.AdaptTooltipModule,f.CommonModule,b.ReactiveFormsModule,v.RxUniqueValidatorModule,p.TranslateModule,v.RxNoWhitespaceValidatorModule,Ru,Iu,u.AdaptIconModule]]});class Eu extends l.InspectorWidgetBase{constructor(e,t){super(e),this.injector=e,this.translateService=t,this.editedPreset=null,this.presets=[],this.strings={cannotBeBlank:this.translateService.instant("com.bmc.arsys.rx.client.designer.validation.cannot-be-blank.message",{propertyName:"View preset name"}),duplicateValue:this.translateService.instant("com.bmc.arsys.rx.client.designer.validation.duplicate-value.message")},this.itemValidationFn=this.itemValidation.bind(this)}ngOnInit(){this.designerItemModel.sandbox.getChildComponents().pipe((0,r.first)(),(0,r.takeUntil)(this.designerItemModel.sandbox.destroyed$)).subscribe(e=>{e.sort((e,t)=>e.data.index-t.data.index),this.presets=e.map(e=>({name:e.data.label,id:e.guid}))})}onPresetsListChange(e){e.forEach(e=>{e.name=(0,m.trim)(e.name)}),this.presets=(0,m.cloneDeep)(e);const t=e.map(({name:e,id:t},i)=>({type:d.RxViewComponentType.ViewPreset,guid:String(t),data:{label:e,index:i}}));this.designerItemModel.sandbox.setChildren(t)}onListItemAdd(){this.presets.push(this.presets.shift())}onListItemEdit(e){this.editedPreset=e}onListItemUpdate(){this.editedPreset=null}focus(){this.adaptRxListBuilderComponent.inputEl.nativeElement.focus()}itemValidation(e,t,i){let n=null;const o=(0,m.chain)(t).reject(e=>i&&e.id===this.editedPreset.id).map("name").value(),r=(0,m.trim)(e);return 0===r.length?n=this.strings.cannotBeBlank:o.includes(r)&&(n=this.strings.duplicateValue),n}}Eu.\u0275fac=function(e){return new(e||Eu)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](p.TranslateService))},Eu.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Eu,selectors:[["rx-presets-list-widget"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](u.AdaptRxListBuilderComponent,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.adaptRxListBuilderComponent=e.first)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:6,consts:[[3,"label","ngModel","hideListAreaLabel","texts","readonly","itemValidation","ngModelChange","listItemAdd","listItemEdit","listItemUpdate"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-rx-list-builder",0),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.presets=e})("ngModelChange",function(e){return t.onPresetsListChange(e)})("listItemAdd",function(){return t.onListItemAdd()})("listItemEdit",function(e){return t.onListItemEdit(e)})("listItemUpdate",function(){return t.onListItemUpdate()}),n["\u0275\u0275elementEnd"]()),2&e&&n["\u0275\u0275property"]("label","View preset names")("ngModel",t.presets)("hideListAreaLabel",!0)("texts",t.options.texts)("readonly",t.isDisabled)("itemValidation",t.itemValidationFn)},directives:[u.AdaptRxListBuilderComponent,b.NgControlStatus,b.NgModel],styles:[""]});class Mu extends c.ViewDesignerComponentModel{constructor(){super(...arguments),this.presetComponentGuids$=this.sandbox.getChildComponentGuids(),this.otherPresetSelectorsNames$=this.sandbox.getComponentsByType(d.RxViewComponentType.ViewPresetSelector).pipe((0,r.map)(e=>e.filter(e=>e.guid!==this.sandbox.guid).map(e=>e.data.name.trim()))),this.label$=this.sandbox.getChildComponents().pipe((0,r.map)(e=>e.sort((e,t)=>e.data.index-t.data.index)),(0,r.map)(e=>e[0]?e[0].data.label:"No view presets added"),(0,r.takeUntil)(this.sandbox.destroyed$)),this.rxFeatureService=this.injector.get(s.RxFeatureService)}static getInitialProperties(e){return Object.assign(Object.assign({name:"View preset selector",styles:null,enableSharing:!1},d.RX_AVAILABLE_ON_DEVICES_DEFAULT_VALUE),e)}rxInit(){this.sandbox.updateInspectorConfig(this.setInspectorConfig()),(0,o.combineLatest)([this.sandbox.componentProperties$,this.presetComponentGuids$]).pipe((0,r.withLatestFrom)(this.otherPresetSelectorsNames$),(0,r.map)(([[e,t],i])=>this.validate(e,t,i)),(0,r.takeUntil)(this.sandbox.destroyed$)).subscribe(e=>{this.sandbox.setValidationIssues(e)})}setInspectorConfig(){return{inspectorSectionConfigs:[{label:"General",controls:[{name:"name",component:l.TextFormControlComponent,options:{label:"Name",required:!0}},{component:Eu,widgetName:"presetsList"},this.rxFeatureService.isFeatureEnabled(fu)?{name:"enableSharing",component:l.SwitchFormControlComponent,options:{label:"Enable sharing"}}:null,(0,c.getAvailableOnDevicesInspectorConfig)(),(0,c.getStylesFieldInspectorConfig)()].filter(Boolean)}]}}validate(e,t,i){let n=[];const o=e.name.trim();return o?i.includes(o)&&n.push(this.sandbox.createError("Name must be unique.","name")):n.push(this.sandbox.createError("Name cannot be blank.","name")),t.length||n.push(this.sandbox.createError("At least one view preset must be added.","presetsList")),n=n.concat((0,c.validateStandardProps)(e)),n}}class Au{}Au.\u0275fac=function(e){return new(e||Au)},Au.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Au,selectors:[["rx-view-preset-selector-design"]],inputs:{model:"model"},decls:3,vars:3,consts:[["adapt-button","","btn-type","tertiary","type","button","readonly","",1,"dropdown-toggle","text-default","font-weight-bold","text-left"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"button",0),n["\u0275\u0275text"](1),n["\u0275\u0275pipe"](2,"async"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](2,1,t.model.label$),"\n"))},directives:[u.AdaptButtonComponent],pipes:[f.AsyncPipe],styles:["button[_ngcontent-%COMP%]{white-space:normal;word-break:break-word}"]});class Ou{}Ou.\u0275fac=function(e){return new(e||Ou)},Ou.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ou,declarations:[Eu],imports:[f.CommonModule,u.AdaptRxListBuilderModule,b.FormsModule],exports:[Eu]}),Ou.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,u.AdaptRxListBuilderModule,b.FormsModule]]});class Pu{}Pu.\u0275fac=function(e){return new(e||Pu)},Pu.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Pu,declarations:[Au],imports:[f.CommonModule,Ou,u.AdaptButtonModule]}),Pu.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[f.CommonModule,Ou,u.AdaptButtonModule]]});class Tu{constructor(e,t){this.rxViewComponentRegistryService=e,this.componentFactoryResolver=t,e.register({type:d.RxViewComponentType.ViewPresetSelector,componentFactory:this.componentFactoryResolver.resolveComponentFactory(wu),properties:[{name:"styles"},{name:"enableSharing",type:d.ViewComponentPropertyType.Boolean,designType:d.ViewComponentPropertyType.Boolean},d.RX_AVAILABLE_ON_DEVICES_PROP_DESC],isContainerComponent:!0,name:"View preset selector",group:c.RX_VIEW_DESIGNER.stencilGroups.basicComponents.label,icon:"screens_triangle_down_circle",designComponentFactory:this.componentFactoryResolver.resolveComponentFactory(Au),designComponentModel:Mu,bundleId:s.RX_APPLICATION.platformBundleId},{type:d.RxViewComponentType.ViewPreset,configPropertyName:"viewPresets",isDataComponent:!0,properties:[{name:"label",localizable:!0},{name:"index",designType:d.ViewComponentPropertyType.Number,type:d.ViewComponentPropertyType.Number}]})}}Tu.\u0275fac=function(e){return new(e||Tu)(n["\u0275\u0275inject"](d.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver))},Tu.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Tu,imports:[Pu,Fu]}),Tu.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Pu,Fu]]});class Vu extends h.BaseViewComponent{constructor(e,t,i){super(),this.translateService=e,this.rxNotificationService=t,this.rxGainsightConfiguratorService=i,this.deploymentTypeOptions=l.RX_GAINSIGHT.deploymentTypes,this.environmentTypeOptions=l.RX_GAINSIGHT.environmentTypes,this.vm$=this.rxGainsightConfiguratorService.getGainsightConfiguration(s.RX_APPLICATION.innovationStudioBundleId).pipe((0,r.take)(1),(0,r.filter)(e=>Boolean(e)),(0,r.map)(e=>e.settings),(0,r.map)(e=>({deploymentTypeOptions:this.deploymentTypeOptions.filter(t=>t.name===e.deploymentType),environmentTypeOptions:[e.environmentType],useAdaptRadar:e.useAdaptRadar,loadGainsightFromBmcIt:e.loadGainsightFromBmcIt,adaptAgreementState:{organizationPerformance:e.enableGainsight,accountMarketing:!1,accountPerformance:!1,organizationMarketing:!1}})),(0,r.shareReplay)(1))}optionFormatter(e){return e.name}save(){this.vm$.pipe((0,r.take)(1),(0,r.map)(e=>Object.assign(Object.assign({},e),{deploymentType:e.deploymentTypeOptions[0].id,environmentType:e.environmentTypeOptions[0],enableGainsight:e.adaptAgreementState.organizationPerformance})),(0,r.switchMap)(e=>this.rxGainsightConfiguratorService.saveGainsightConfiguration(e))).subscribe(()=>{this.rxNotificationService.addSuccessMessage(this.translateService.instant("com.bmc.arsys.rx.client.gainsight.gainsight-settings-saved.success.message"))})}}Vu.\u0275fac=function(e){return new(e||Vu)(n["\u0275\u0275directiveInject"](p.TranslateService),n["\u0275\u0275directiveInject"](s.RxNotificationService),n["\u0275\u0275directiveInject"](l.RxGainsightConfiguratorService))},Vu.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Vu,selectors:[["rx-gainsight-admin-opt-in"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:4,vars:4,consts:[["class","p-0",4,"ngIf","ngIfElse"],["emptyStateTemplate",""],[1,"p-0"],[1,"mt-1","container"],[1,"text-logo"],["rx-id","enable-gainsight",3,"showOrganizationSettings","showMarketingSection","multiProductUsage","showShadow","state","stateChange"],[1,"pt-4","pl-0","col-md-4",3,"hidden"],["label","Use ADAPT Radar","name","useAdaptRadar","rx-id","use-adapt-radar",3,"isLabelBefore","size","ngModel","ngModelChange"],[1,"pt-4","pl-0","col-md-4"],["name","loadGainsightFromBmcIt","rx-id","load-gainsight-from-bmc",3,"isLabelBefore","size","label","ngModel","ngModelChange"],["name","deploymentType","rx-id","deployment-type",1,"col-md-3","pt-4","pl-0",3,"label","options","optionFormatter","ngModel","ngModelChange"],["name","environmentType","rx-id","environment-type",1,"col-md-3","pt-4","pl-0",3,"label","options","ngModel","ngModelChange"],[1,"modal-footer","mt-4"],["rx-id","save-button","adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"click"],[1,"d-flex","align-items-center","justify-content-center","h-100"],["type","config",1,"w-100",3,"label"]],template:function(e,t){if(1&e&&(n["\u0275\u0275template"](0,ps,21,32,"ng-container",0),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275template"](2,ms,3,3,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e){const e=n["\u0275\u0275reference"](3);n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](1,2,t.vm$))("ngIfElse",e)}},directives:[f.NgIf,u.AdaptAgreementCardComponent,u.AdaptRxSwitchComponent,b.NgControlStatus,b.NgModel,u.AdaptRxSelectComponent,u.AdaptButtonComponent,u.AdaptEmptyStateComponent],pipes:[f.AsyncPipe,p.TranslatePipe],styles:["[_nghost-%COMP%]     adapt-agreement-card adapt-agreement-admin-content div:nth-of-type(2)>adapt-rx-switch, [_nghost-%COMP%]     adapt-agreement-card adapt-agreement-admin-content hr:nth-of-type(2)~div, [_nghost-%COMP%]     adapt-agreement-card adapt-agreement-admin-content h4, [_nghost-%COMP%]     adapt-agreement-card adapt-agreement-admin-content hr:nth-of-type(3){display:none}"],changeDetection:0});class Nu{constructor(e,t){this.componentFactoryResolver=e,this.rxViewComponentRegistryService=t,t.register({type:"rx-gainsight-admin-opt-in",componentFactory:this.componentFactoryResolver.resolveComponentFactory(Vu),name:"Gainsight Admin Opt In",hidden:!0,availableInBundles:[s.RX_APPLICATION.settingsBundleId]})}}Nu.\u0275fac=function(e){return new(e||Nu)(n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](d.RxViewComponentRegistryService))},Nu.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Nu,declarations:[Vu],imports:[p.TranslateModule,u.AdaptAgreementModule,u.AdaptRxSelectModule,b.FormsModule,u.AdaptRxSwitchModule,f.CommonModule,u.AdaptButtonModule,u.AdaptEmptyStateModule]}),Nu.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[p.TranslateModule,u.AdaptAgreementModule,u.AdaptRxSelectModule,b.FormsModule,u.AdaptRxSwitchModule,f.CommonModule,u.AdaptButtonModule,u.AdaptEmptyStateModule]]});class ku{}ku.\u0275fac=function(e){return new(e||ku)},ku.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ku,imports:[Gm,qm,lu,Um,Hm,Oc,pu,Jm,Km,Zm,Wm,Xm,tu,uu,ru,Tu,Nu]}),ku.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[Gm,qm,lu,Um,Hm,Oc,pu,Jm,Km,Zm,Wm,Xm,tu,uu,ru,Tu,Nu]]})},"./node_modules/@helix/platform/fesm2015/helix-platform-view-designer.js":(e,t,i)=>{"use strict";i.r(t),i.d(t,{ActionListControlComponent:()=>vi,ActionListControlModule:()=>yi,ActionListEditorDialogComponent:()=>hi,ActionListEditorDialogModule:()=>gi,ActionListWidgetComponent:()=>Si,ActionListWidgetModule:()=>wi,CanvasItemApi:()=>qt,CanvasItemColumnComponent:()=>Qt,CanvasItemComponent:()=>Xt,CanvasItemContainerComponent:()=>Jt,CanvasOutletComponent:()=>Kt,CanvasOutletHelperService:()=>Ht,DesignerComponent:()=>Yt,DesignerModule:()=>ri,DropComponentData:()=>Ut,NamedListFilterExpressionConfigurator:()=>ci,RX_AVAILABLE_ON_DEVICES_OPTIONS:()=>Ri,RX_VIEW_DESIGNER:()=>ei,RX_VIEW_MODEL:()=>ii,RuntimeViewParamsModalComponent:()=>si,RuntimeViewParamsModalModule:()=>li,RxComponentPermissionEditorWidgetComponent:()=>xi,RxComponentPermissionEditorWidgetModule:()=>bi,RxViewActionExpressionConfigurator:()=>di,RxViewActionValidatorService:()=>Oi,RxViewComponentExpressionConfigurator:()=>jt,RxViewCustomizationOptionsComponent:()=>_t,RxViewCustomizationOptionsModule:()=>Ci,RxViewDataDictionaryService:()=>Nt,RxViewDesignerActionModel:()=>mi,RxViewDesignerComponent:()=>ni,RxViewDesignerDefaultActionModel:()=>ui,RxViewDesignerHelperService:()=>Zt,RxViewDesignerPaletteModule:()=>ai,RxViewExpressionConfigurator:()=>kt,RxViewExpressionValidatorService:()=>Vt,RxViewModel:()=>Lt,RxViewRevertCustomizationComponent:()=>Bt,RxViewRevertCustomizationModule:()=>$t,ViewDesignerCanvasComponent:()=>Wt,ViewDesignerCanvasItemApiToken:()=>Gt,ViewDesignerCanvasModule:()=>oi,ViewDesignerComponentModel:()=>Di,ViewDesignerFacade:()=>Ft,ViewDesignerModule:()=>Yi,ViewDesignerPaletteComponent:()=>ti,getAvailableOnDevicesInspectorConfig:()=>Ii,getDisabledFieldInspectorConfig:()=>Ei,getHiddenFieldInspectorConfig:()=>Fi,getStandardPropsInspectorConfigs:()=>Ai,getStylesFieldInspectorConfig:()=>Mi,validateAvailableOnDevicesProp:()=>Pt,validateCssClassName:()=>At,validateCssClassNames:()=>Ot,validateStandardProps:()=>Tt});var n=i("./node_modules/@angular/core/fesm2015/core.js"),o=i("./node_modules/@helix/platform/fesm2015/helix-platform-association-api.js"),r=i("./node_modules/@helix/platform/fesm2015/helix-platform-named-list-api.js"),a=i("./node_modules/@helix/platform/fesm2015/helix-platform-process-api.js"),s=i("./node_modules/@helix/platform/fesm2015/helix-platform-record-api.js"),l=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-api.js"),d=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-components.js"),c=i("./node_modules/@helix/platform/fesm2015/helix-platform-ui-kit.js"),p=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-api.js"),m=i("./node_modules/@ngx-translate/core/fesm2015/ngx-translate-core.js"),u=i("lodash"),f=i("rxjs"),h=i("./node_modules/rxjs/_esm2015/operators/index.js"),g=i("./node_modules/@helix/platform/fesm2015/helix-platform-utils.js"),v=i("./node_modules/@ngrx/effects/fesm2015/ngrx-effects.js"),y=i("./node_modules/@ngrx/store/fesm2015/ngrx-store.js"),x=i("./node_modules/@angular/forms/fesm2015/forms.js"),b=i("./node_modules/@angular/common/fesm2015/common.js"),C=i("./node_modules/@angular/cdk/fesm2015/drag-drop.js"),S=i("./node_modules/@bmc-ux/adapt-angular/fesm2015/bmc-ux-adapt-angular.js"),w=i("./node_modules/@bmc-ux/obsolete/fesm2015/bmc-ux-adapt-obsolete.js"),D=i("./node_modules/tslib/tslib.es6.js");const R=["container"];function I(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-canvas-item",1),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("layout",e.layout)("isReadOnly",e.isReadOnly)}}function F(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",9),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"]().remove(t,i)}),n["\u0275\u0275elementEnd"]()}}function E(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",2),n["\u0275\u0275listener"]("cdkDragEntered",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onDragEntered(t)})("cdkDragStarted",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onDragStarted(t)}),n["\u0275\u0275elementStart"](1,"div",3),n["\u0275\u0275listener"]("click",function(t){const i=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"]().onSelectComponent(t,i)}),n["\u0275\u0275pipe"](2,"async"),n["\u0275\u0275elementStart"](3,"div",4),n["\u0275\u0275pipe"](4,"async"),n["\u0275\u0275element"](5,"span",5),n["\u0275\u0275elementStart"](6,"span",6),n["\u0275\u0275text"](7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](8,F,1,0,"button",7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](9,"rx-canvas-item",8),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275classMapInterpolate1"]("canvas-item-wrapper mw-100 canvas-",e.descriptor.type,""),n["\u0275\u0275property"]("cdkDragData",i.getViewComponentDragData(e))("cdkDragDisabled",i.isReadOnly||(null==e.descriptor.options?null:e.descriptor.options.static)),n["\u0275\u0275advance"](1),n["\u0275\u0275classProp"]("active",n["\u0275\u0275pipeBind1"](2,12,e.isSelected$)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("hidden",!n["\u0275\u0275pipeBind1"](4,14,e.isSelected$)),n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate"](e.label),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!(i.isReadOnly||null!=e.descriptor.options&&e.descriptor.options.static)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("layout",e)("isReadOnly",i.isReadOnly)}}const M=function(e){return{columnIndex:e}},A=function(e){return{"col-border":e}},O=function(e){return{"mb-3":e}};function P(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",2),n["\u0275\u0275elementStart"](1,"rx-canvas-item-column",3),n["\u0275\u0275listener"]("dropListDropped",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onDropListDropped(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=t.index,o=t.last,r=n["\u0275\u0275nextContext"]();n["\u0275\u0275classMap"](e.span?"col-"+e.span:"col"),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](9,A,!o)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction1"](11,O,!o))("isReadOnly",r.isReadOnly)("colIndex",i)("column",e)("layout",r.layout)}}function T(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-canvas-outlet",1),n["\u0275\u0275listener"]("beforeViewComponentDrop",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().viewDesignerCanvasComponent.beforeComponentDropInRoot.emit(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275classProp"]("border",i.canvasItemComponent.layout.outlets.length>1)("default-outlet",e.name===i.defaultOutletName),n["\u0275\u0275property"]("name",e.name)}}function V(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",7),n["\u0275\u0275elementStart"](1,"div",8),n["\u0275\u0275element"](2,"span"),n["\u0275\u0275elementStart"](3,"span",9),n["\u0275\u0275text"](4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("cdkDragData",i.getViewComponentDragData(e)),n["\u0275\u0275attribute"]("rx-id",e.type),n["\u0275\u0275advance"](2),n["\u0275\u0275classMapInterpolate1"]("item-image d-icon-",e.icon||"wall",""),n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("title",e.name),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function N(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"adapt-accordion-tab",4),n["\u0275\u0275elementStart"](1,"div",5),n["\u0275\u0275template"](2,V,5,7,"div",6),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("title",e.name)("isOpen",!0),n["\u0275\u0275attribute"]("rx-id",i.stringService.toRxId(e.name)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("cdkDropListConnectedTo",i.allowedDropListIds),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.components)("ngForTrackBy",i.trackByNameFn)}}const k=function(){return[]},j=function(e){return{multiselect:!0,tabs:e}},_=["viewPropertyInspector"],B=["viewComponentPropertyInspector"];function $(e,t){if(1&e&&(n["\u0275\u0275element"](0,"rx-view-designer-palette",19),n["\u0275\u0275pipe"](1,"async")),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("components",n["\u0275\u0275pipeBind1"](1,2,e.paletteComponents$))("allowedDropListIds",e.canvasDndListIds)}}const L=function(){return{content:"There are no view components to display. View with a Page view component cannot contain any other view components.",variant:"info",type:"inline"}};function G(e,t){1&e&&n["\u0275\u0275element"](0,"adapt-alert",20),2&e&&n["\u0275\u0275property"]("config",n["\u0275\u0275pureFunction0"](1,L))}const q=function(){return{content:"This view is not editable. There are no view components to display.",variant:"info",type:"inline"}};function U(e,t){1&e&&n["\u0275\u0275element"](0,"adapt-alert",20),2&e&&n["\u0275\u0275property"]("config",n["\u0275\u0275pureFunction0"](1,q))}function z(e,t){if(1&e&&(n["\u0275\u0275element"](0,"adapt-code-viewer",21),n["\u0275\u0275pipe"](1,"json"),n["\u0275\u0275pipe"](2,"async")),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("code",n["\u0275\u0275pipeBind1"](1,4,n["\u0275\u0275pipeBind1"](2,6,e.viewDesignerFacade.viewDefinition$)))("lang","javascript")("hasToolbar",!1)("theme","light")}}const X=function(e){return{content:e,variant:"info",type:"inline"}};function W(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"adapt-rx-textfield",5),n["\u0275\u0275listener"]("ngModelChange",function(t){const i=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"]().inputParams[i]=t}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=t.first,o=t.index,r=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("label",e)("autofocus",i)("ngModel",r.inputParams[e]),n["\u0275\u0275attribute"]("rx-id","input-param-"+(o+1))}}function H(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",25),n["\u0275\u0275elementStart"](1,"div",26),n["\u0275\u0275listener"]("dblclick",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"](4).addAction(t.data)}),n["\u0275\u0275elementStart"](2,"button",27),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"](4).addAction(t.data)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"span",28),n["\u0275\u0275text"](4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275property"]("cdkDragData",e.data),n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate"](e.data.label)}}function Q(e,t){if(1&e&&n["\u0275\u0275template"](0,H,5,2,"div",24),2&e){const e=t.$implicit;n["\u0275\u0275property"]("ngIf",e.data)}}function J(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",21),n["\u0275\u0275elementStart"](1,"adapt-tree",22),n["\u0275\u0275template"](2,Q,1,1,"ng-template",23),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]().ngIf,t=n["\u0275\u0275nextContext"](2);n["\u0275\u0275property"]("cdkDropListConnectedTo","selected-action-list"),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("value",e)("wrap",t.treeWrap)}}function K(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",29),n["\u0275\u0275element"](1,"adapt-empty-state",30),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.view-components.action-list.available-actions.empty-state.message")))}function Y(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",18),n["\u0275\u0275template"](1,J,3,3,"div",19),n["\u0275\u0275template"](2,K,3,3,"ng-template",null,20,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275elementEnd"]()),2&e){const e=t.ngIf,i=n["\u0275\u0275reference"](3);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.length)("ngIfElse",i)}}function Z(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",15),n["\u0275\u0275elementStart"](1,"div",3),n["\u0275\u0275elementStart"](2,"h4",5),n["\u0275\u0275text"](3),n["\u0275\u0275pipe"](4,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",16),n["\u0275\u0275template"](6,Y,4,2,"div",17),n["\u0275\u0275pipe"](7,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](4,2,"com.bmc.arsys.rx.client.view-components.action-list.available-actions.title")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](7,4,e.availableActionTreeNodes$))}}function ee(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",31),n["\u0275\u0275elementStart"](1,"button",32),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().toggleOpen(!0)}),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",33),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().toggleOpen(!1)}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,2,"com.bmc.arsys.rx.client.common.expand-all.label")," "),n["\u0275\u0275advance"](3),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,4,"com.bmc.arsys.rx.client.common.collapse-all.label")," "))}function te(e,t){1&e&&n["\u0275\u0275element"](0,"div",44)}function ie(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",45),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=t.ngIf,i=n["\u0275\u0275nextContext"]().$implicit;n["\u0275\u0275property"]("title",e[i.name]),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e[i.name]," ")}}function ne(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",46),n["\u0275\u0275elementStart"](1,"div",47),n["\u0275\u0275elementStart"](2,"button",48),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"]();return t.stopPropagation(),o.moveAction(i,i+1)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",49),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index,o=n["\u0275\u0275nextContext"]();return t.stopPropagation(),o.moveAction(i,i-1)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](4,"button",50),n["\u0275\u0275listener"]("click",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().$implicit,o=n["\u0275\u0275nextContext"]();return t.stopPropagation(),o.removeAction(i)}),n["\u0275\u0275text"](5),n["\u0275\u0275pipe"](6,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](),t=e.last,i=e.first;n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("disabled",t),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("disabled",i),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](6,3,"com.bmc.arsys.rx.client.common.remove.label")," ")}}function oe(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",34,35),n["\u0275\u0275template"](2,te,1,0,"div",36),n["\u0275\u0275elementStart"](3,"adapt-accordion-tab",37),n["\u0275\u0275listener"]("open",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!0})("close",function(){return n["\u0275\u0275restoreView"](e).$implicit.isOpen=!1}),n["\u0275\u0275elementStart"](4,"div",38),n["\u0275\u0275elementStart"](5,"div",39),n["\u0275\u0275elementStart"](6,"div",40),n["\u0275\u0275template"](7,ie,2,2,"div",41),n["\u0275\u0275pipe"](8,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](9,ne,7,5,"div",42),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](10,"rx-form-builder",43),n["\u0275\u0275listener"]("modelChange",function(t){const i=n["\u0275\u0275restoreView"](e).$implicit,o=n["\u0275\u0275nextContext"]();return i.model.sandbox.updateActionProperties(t),o.markEditorAsDirty()})("editorEvent",function(t){const i=n["\u0275\u0275restoreView"](e).$implicit,o=n["\u0275\u0275reference"](1);return n["\u0275\u0275nextContext"]().onEvent(t,i.model,o)}),n["\u0275\u0275pipe"](11,"async"),n["\u0275\u0275pipe"](12,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("cdkDragData",e)("cdkDragDisabled",i.config.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!i.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("isOpen",e.isOpen),n["\u0275\u0275advance"](3),n["\u0275\u0275classProp"]("pl-0",i.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](8,11,i.actionLabelsMap$)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!i.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("config",n["\u0275\u0275pipeBind1"](11,13,e.config$))("model",n["\u0275\u0275pipeBind1"](12,15,e.model.sandbox.actionProperties$))("isReadOnly",i.config.isReadOnly)}}function re(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",29),n["\u0275\u0275element"](1,"adapt-empty-state",51),n["\u0275\u0275pipe"](2,"translate"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275propertyInterpolate"]("label",n["\u0275\u0275pipeBind1"](2,1,"com.bmc.arsys.rx.client.view-components.action-list.selected-actions.empty-state.message")))}function ae(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",52),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().onSave()}),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275text"](2),n["\u0275\u0275pipe"](3,"translate"),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("disabled",n["\u0275\u0275pipeBind1"](1,2,e.isSaveButtonDisabled$)),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](3,4,"com.bmc.arsys.rx.client.common.save.label")," ")}}function se(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span",6),n["\u0275\u0275element"](1,"span",7),n["\u0275\u0275element"](2,"adapt-icon",8),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("name","question_circle_o")("adaptPopover",e.tooltip)}}function le(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"span",9),n["\u0275\u0275text"](1,"No actions added."),n["\u0275\u0275elementEnd"]())}function de(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",16),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);const t=n["\u0275\u0275nextContext"]().$implicit;return n["\u0275\u0275nextContext"](2).removeAction(t)}),n["\u0275\u0275elementEnd"]()}}function ce(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"li",12),n["\u0275\u0275elementStart"](1,"strong",13),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](3,"button",14),n["\u0275\u0275listener"]("click",function(){const t=n["\u0275\u0275restoreView"](e).$implicit;return n["\u0275\u0275nextContext"](2).editAction(t)}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](4,de,1,0,"button",15),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](i.actionLabelsMap[e.data.name]),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!i.isDisabled)}}function pe(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"ul",10),n["\u0275\u0275template"](1,ce,5,2,"li",11),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.selectedActions)}}function me(e,t){const i=t[e];return t[null==i?void 0:i.parentGuid]}function ue(e,t){const i=[e];let n=me(e,t),o=n?n.guid:null;for(;o;)i.unshift(o),n=me(o,t),o=n?n.guid:null;return i}function fe(e,t){if(t.layout){if(p.RxViewLayout.hasChild(t.layout,e))return!0}return!!t.childDataComponentGuids&&(0,u.includes)(t.childDataComponentGuids,e)}function he(e,t,i,n,o=0,r=0){const a=Object.assign({},e);return a.layout={outlets:e.layout.outlets.map(e=>{if(e.name===i){const i=[...e.columns];return n=isFinite(n)?n:i[o].children.length,i[o]||(i[o]={children:[]},r&&(i[o].span=r)),i[o]={children:[...i[o].children.slice(0,n),t,...i[o].children.slice(n)],span:i[o].span},Object.assign(Object.assign({},e),{columns:i})}return e})},a}function ge(e,t){const i=Object.assign({},t);return(0,u.some)(i.childDataComponentGuids,t=>e===t)&&(i.childDataComponentGuids=i.childDataComponentGuids.filter(t=>t!==e)),t.layout&&p.RxViewLayout.hasChild(t.layout,e)&&(i.layout=p.RxViewLayout.removeChildFromLayout(t.layout,e)),i}function ve(e){const t=[];return e.childDataComponentGuids&&t.push(...e.childDataComponentGuids),e.layout&&t.push(...p.RxViewLayout.getViewLayoutChildGuids(e.layout)),(0,u.uniq)(t)}function ye(e,t){const i=ve(e);return i.reduce((e,i)=>(e.push(...ye(t[i],t)),e),i)}class xe{constructor(){this.componentIcon="d-icon-file_o",this.componentPropertyIcon="d-icon-file_o_gear",this.settablePropertiesIcon="d-icon-arrow_right_square_input",this.actionOutputIcon="d-icon-arrow_chart"}getActionOutputDataDictionaryBranch(e,t){return{label:e,icon:"d-icon-arrow_chart",children:(0,u.map)(t,e=>this.buildDataDictionaryBranch(e,this.actionOutputIcon))}}getComponentCommonDataDictionaryBranch(e){return Object.assign(Object.assign({},e),{icon:this.componentIcon,children:(0,u.flow)(e=>(0,u.map)(e,e=>this.buildDataDictionaryBranch(e,this.componentPropertyIcon)),u.compact)(e.children)})}getSettablePropertiesDataDictionary(e){return(0,u.map)(e,e=>this.buildDataDictionaryBranch(e,this.settablePropertiesIcon))}buildDataDictionaryBranch(e,t){const i=Object.assign({},e);return e.expression&&(i.icon=t),e.children&&(i.children=(0,u.flow)(e=>(0,u.map)(e,e=>this.buildDataDictionaryBranch(e,t)),u.compact)(e.children)),i}}xe.\u0275fac=function(e){return new(e||xe)},xe.\u0275prov=n["\u0275\u0275defineInjectable"]({token:xe,factory:xe.\u0275fac,providedIn:"root"});class be{constructor(){this.componentsCommon=null,this.componentsCommonSubject=new f.ReplaySubject(1),this.componentsCommon$=this.componentsCommonSubject.asObservable(),this.viewCommon=null,this.viewCommonSubject=new f.ReplaySubject(1),this.viewCommon$=this.viewCommonSubject.asObservable(),this.actionsOutput=[],this.actionsOutputSubject=new f.ReplaySubject(1),this.actionsOutput$=this.actionsOutputSubject.asObservable(),this.settableProperties=null,this.settablePropertiesSubject=new f.ReplaySubject(1),this.settableProperties$=this.settablePropertiesSubject.asObservable()}setCommonDataDictionaryBranch(e,t){this.setComponentCommon((0,u.isEmpty)(t)?(0,u.omit)(this.componentsCommon,[e]):Object.assign(Object.assign({},this.componentsCommon),{[e]:t}))}setViewCommonDataDictionaryBranch(e){this.setViewCommon(e)}setSettablePropertiesDataDictionary(e){this.setSettableProperties(Object.assign(Object.assign({},this.settableProperties),e.reduce((e,{guid:t,componentName:i,dataDictionary:n})=>(e[t]={componentName:i,dataDictionary:n},e),{})))}removeDataDictionaryForComponents(e){e.some(e=>(0,u.has)(this.componentsCommon,e))&&this.setComponentCommon((0,u.omit)(this.componentsCommon,e)),e.some(e=>(0,u.has)(this.settableProperties,e))&&this.setSettableProperties((0,u.omit)(this.settableProperties,e))}setActionOutputDataDictionaryBranch(e,t,i){this.setActionsOutput((0,u.flow)(n=>[...(0,u.reject)(n,{guid:e}),{guid:e,index:t,dataDictionaryBranch:i}],e=>(0,u.sortBy)(e,"index"))(this.actionsOutput))}updateActionOutputDataDictionaryBranchOrder(e){this.setActionsOutput((0,u.flow)(t=>(0,u.map)(t,t=>Object.assign(Object.assign({},t),{index:e[t.guid]})),e=>(0,u.sortBy)(e,"index"))(this.actionsOutput))}removeActionOutputDataDictionaryBranch(e){this.setActionsOutput((0,u.reject)(this.actionsOutput,{guid:e}))}removeAllActionOutputDataDictionaryBranches(){this.setActionsOutput(null)}clear(){this.setComponentCommon(null),this.setViewCommon(null),this.setSettableProperties(null),this.setActionsOutput([])}setComponentCommon(e){this.componentsCommon=e,this.componentsCommonSubject.next(this.componentsCommon)}setViewCommon(e){this.viewCommon=e,this.viewCommonSubject.next(this.viewCommon)}setActionsOutput(e){this.actionsOutput=e,this.actionsOutputSubject.next(this.actionsOutput)}setSettableProperties(e){this.settableProperties=e,this.settablePropertiesSubject.next(this.settableProperties)}}be.\u0275fac=function(e){return new(e||be)},be.\u0275prov=n["\u0275\u0275defineInjectable"]({token:be,factory:be.\u0275fac,providedIn:"root"});class Ce{constructor(){this.onChangeSubject=new f.Subject,this.configs=new Map,this.onChange$=this.onChangeSubject.asObservable()}clear(){this.configs.clear()}set(e,t){this.configs.set(e,t),this.onChangeSubject.next({guid:e,config:t})}get(e){return this.configs.get(e)}delete(e){this.onChangeSubject.next({guid:e,config:null}),this.configs.delete(e)}}Ce.\u0275fac=function(e){return new(e||Ce)},Ce.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Ce,factory:Ce.\u0275fac,providedIn:"root"});const Se=(0,y.createAction)("[View Component] Components Removed",(0,y.props)()),we=(0,y.createAction)("[View Component] Initialize Component Models",(0,y.props)()),De=(0,y.createAction)("[View Component] Initialize Data Component Models",(0,y.props)()),Re=(0,y.createAction)("[View Component] Set Validation Issues",(0,y.props)()),Ie=(0,y.createAction)("[View Component] Set Expression Validation Issues",(0,y.props)()),Fe=(0,y.createAction)("[View Component] Set Component Properties",(0,y.props)()),Ee=(0,y.createAction)("[View Component] Set Child Components",(0,y.props)()),Me=(0,y.createAction)("[View Component] Set Breadcrumbs",(0,y.props)()),Ae=(0,y.createAction)("[View Component] Select Component",(0,y.props)()),Oe=(0,y.createAction)("[View Component] Set Component Layout",(0,y.props)()),Pe=(0,y.createAction)("[View Component] Move Component",(0,y.props)()),Te=(0,y.createAction)("[View Component] Insert Component",(0,y.props)()),Ve=(0,y.createAction)("[View Component] Add New Components",(0,y.props)()),Ne=(0,y.createAction)("[View Component] Update Component Model",(0,y.props)()),ke=(0,y.createAction)("[View Component] Remove Components",(0,y.props)());class je{constructor(e){this.store$=e}dispatch(e){this.store$.dispatch(e)}}je.\u0275fac=function(e){return new(e||je)(n["\u0275\u0275inject"](y.Store))},je.\u0275prov=n["\u0275\u0275defineInjectable"]({token:je,factory:je.\u0275fac,providedIn:"root"});const _e=(0,y.createAction)("[View Designer] View Definition Save Success",(0,y.props)()),Be=(0,y.createAction)("[View Designer] View Definition Save Error"),$e=(0,y.createAction)("[View Designer] View Definition Load Success",(0,y.props)()),Le=(0,y.createAction)("[View Designer] View Definition Load Error"),Ge=(0,y.createAction)("[View Designer] Set Generated View Definition",(0,y.props)()),qe=(0,y.createAction)("[View Designer] Load View Definition",(0,y.props)()),Ue=(0,y.createAction)("[View Designer] Bundle Friendly Name Load Success",(0,y.props)()),ze=(0,y.createAction)("[View Designer] Bundle Friendly Name Load Error",(0,y.props)()),Xe=(0,y.createAction)("[View Designer] View Models Initialized"),We=(0,y.createAction)("[View Designer] View Models Updated After Save"),He=(0,y.createAction)("[View Designer] Update View Model",(0,y.props)()),Qe=(0,y.createAction)("[View Designer] Set View Model",(0,y.props)()),Je=(0,y.createAction)("[View Designer] Select Inspector Tab",(0,y.props)()),Ke=(0,y.createAction)("[View Designer] Save View Definition",(0,y.props)()),Ye=(0,y.createAction)("[View Designer] Run Preview"),Ze=(0,y.createAction)("[View Designer] Load Bundle Friendly Name"),et=(0,y.createAction)("[View Designer] Generate View Definition",(0,y.props)()),tt=(0,y.createAction)("[View Designer] Clear Canvas"),it=(0,y.createAction)("[View Designer] Init",(0,y.props)()),nt=(0,y.createAction)("[View Designer] Destroy"),ot=(0,y.createFeatureSelector)("viewDesigner"),rt=(0,y.createSelector)(ot,e=>e.model),at=(0,y.createSelector)(rt,e=>e.viewDesignModel),st=(0,y.createSelector)(at,(e,{propertyName:t})=>(0,u.get)(e,t)),lt=(0,y.createSelector)(rt,e=>e.viewComponentDesignModels),dt=(0,y.createSelector)(rt,e=>{var t;return null===(t=Object.values(e.viewComponentDesignModels)[0])||void 0===t?void 0:t.type}),ct=(0,y.createSelector)(lt,(e,{guid:t})=>e[t]),pt=(0,y.createSelector)(ct,e=>null==e?void 0:e.parentGuid),mt=(0,y.createSelector)(lt,(e,{guid:t,propertyName:i})=>e[t]?i?(0,u.get)(e[t].propertiesByName,i):e[t].propertiesByName:null),ut=(0,y.createSelector)(lt,(e,{guid:t})=>e[t]?e[t].type:null),ft=(0,y.createSelector)(ct,e=>null==e?void 0:e.layout),ht=(0,y.createSelector)(ct,e=>null==e?void 0:e.permissions),gt=(0,y.createSelector)(ct,e=>null==e?void 0:e.childDataComponentGuids),vt=(0,y.createSelector)(ot,e=>e.ui),yt=(0,y.createSelector)(vt,e=>e.isViewDefinitionLoading),xt=(0,y.createSelector)(vt,e=>e.friendlyBundleName),bt=(0,y.createSelector)(vt,e=>e.currentBundleId),Ct=(0,y.createSelector)(ot,e=>e.viewDefinition),St=(0,y.createSelector)(ot,e=>e.validation),wt=(0,y.createSelector)(ot,e=>e.breadcrumbs),Dt=(0,y.createSelector)(vt,e=>e.selectedInspectorTabId),Rt=(0,y.createSelector)(vt,e=>e.selectedComponentGuid),It=(0,y.createSelector)(vt,e=>e.areViewModelsReady);(0,y.createSelector)(Rt,lt,(e,t)=>{if(t&&e){const i=t[e];return i?i.propertiesByName:null}return null});class Ft{constructor(e,t,i,n,o,r,a,s){this.dispatcher=e,this.store$=t,this.actions$=i,this.rxViewDesignerInspectorService=n,this.rxGuidService=o,this.rxViewDataDictionaryBuilderService=r,this.rxViewDataDictionaryService=a,this.rxOverlayService=s,this.viewDefinition$=this.store$.select(Ct),this.validationIssues$=this.store$.select(St),this.breadcrumbs$=this.store$.select(wt),this.viewDesignerModelState$=this.store$.select(rt),this.viewModel$=this.store$.select(at).pipe((0,h.filter)(Boolean)),this.viewModelGuid$=this.getViewPropertyValue("guid"),this.viewComponentModels$=this.store$.select(lt),this.firstViewComponentModelType$=this.store$.select(dt),this.isExtensionView$=this.getViewPropertyValue("targetViewDefinitionName").pipe((0,h.map)(Boolean),(0,h.shareReplay)(1)),this.isExtensionContainerSet$=this.getViewPropertyValue("targetExtensionContainerGuid").pipe((0,h.map)(Boolean),(0,h.shareReplay)(1)),this.allComponentGuids$=this.viewComponentModels$.pipe((0,h.map)(e=>new Set(Object.keys(e))),(0,h.shareReplay)({refCount:!0,bufferSize:1})),this.selectedComponentGuid$=this.store$.select(Rt).pipe((0,h.switchMap)(e=>this.viewModelGuid$.pipe((0,h.map)(t=>e===t?null:e),(0,h.take)(1)))),this.selectedComponentProperties$=this.selectedComponentGuid$.pipe((0,h.switchMap)(e=>e?this.getComponentProperties(e):(0,f.of)(null))),this.isViewDefinitionLoading$=this.store$.select(yt),this.selectedInspectorTabId$=this.store$.select(Dt),this.bundleFriendlyName$=this.store$.select(xt),this.currentBundleId$=this.store$.select(bt),this.viewInspectorLayout$=(0,f.merge)(this.viewModelGuid$,this.rxViewDesignerInspectorService.onChange$.pipe((0,h.withLatestFrom)(this.viewModelGuid$),(0,h.filter)(([e,t])=>e.guid===t),(0,h.map)(([e,t])=>t))).pipe((0,h.map)(e=>{const t=this.rxViewDesignerInspectorService.get(e);return t?t.inspectorSectionConfigs:null})),this.selectedComponentInspectorLayout$=(0,f.merge)(this.selectedComponentGuid$.pipe((0,h.distinctUntilChanged)()),this.rxViewDesignerInspectorService.onChange$.pipe((0,h.withLatestFrom)(this.selectedComponentGuid$),(0,h.filter)(([e,t])=>e.guid===t),(0,h.map)(([e,t])=>t))).pipe((0,h.map)(e=>{const t=this.rxViewDesignerInspectorService.get(e);return t?t.inspectorSectionConfigs:null})),this.isViewReadOnly$=(0,f.combineLatest)([this.viewModel$,this.currentBundleId$.pipe((0,h.switchMap)(e=>this.rxOverlayService.areNewDefinitionsAllowed(e)))]).pipe((0,h.map)(([e,t])=>!t||!this.rxOverlayService.isCustomizationEnabled("allowOverlay",e)),(0,h.distinctUntilChanged)(),(0,h.shareReplay)(1)),this.viewDefinitionLoadError$=this.actions$.pipe((0,v.ofType)(Le)),this.viewDefinitionSaveSuccess$=this.actions$.pipe((0,v.ofType)(_e)),this.initViewDesigner$=this.actions$.pipe((0,v.ofType)(it)),this.destroyViewDesignerSubject=new f.Subject,this.destroyViewDesigner$=this.destroyViewDesignerSubject.asObservable(),this.viewModelsInitialized$=this.actions$.pipe((0,v.ofType)(Xe)),this.areViewModelsReady$=this.store$.select(It),this.viewCommonDataDictionaryState$=this.rxViewDataDictionaryService.viewCommon$,this.componentsCommonDataDictionaryState$=this.rxViewDataDictionaryService.componentsCommon$,this.actionsDataDictionaryState$=this.rxViewDataDictionaryService.actionsOutput$,this.settablePropertiesDataDictionaryState$=this.rxViewDataDictionaryService.settableProperties$,this.settablePropertiesDataDictionarySubject=new f.Subject,(0,f.merge)(this.settablePropertiesDataDictionarySubject.pipe((0,h.bufferToggle)(this.initViewDesigner$,e=>this.viewModelsInitialized$)),this.viewModelsInitialized$.pipe((0,h.switchMap)(()=>this.settablePropertiesDataDictionarySubject.pipe((0,h.map)(e=>[e]),(0,h.takeUntil)(this.initViewDesigner$))))).subscribe(e=>{this.rxViewDataDictionaryService.setSettablePropertiesDataDictionary(e)})}getComponentModel(e){return this.store$.select(ct,{guid:e})}initViewDesigner(e){this.dispatcher.dispatch(it({payload:e}))}destroyViewDesigner(){this.destroyViewDesignerSubject.next(),this.dispatcher.dispatch(nt())}selectComponent(e){this.dispatcher.dispatch(Ae({guid:e}))}insertComponent(e){this.dispatcher.dispatch(Te(Object.assign(Object.assign({columnIndex:(0,u.isFinite)(e.data&&e.data.columnIndex)?e.data.columnIndex:0},e),{data:{guid:e.data.draggedViewComponentGuid,type:e.data.draggedViewComponentDescriptor.type,initialPropertiesByName:e.data.initialPropertiesByName}})))}selectInspectorTab(e){this.dispatcher.dispatch(Je(e))}generateViewDefinition(e){this.dispatcher.dispatch(et({payload:e}))}updateComponentProperties(e,t){this.dispatcher.dispatch(Ne({payload:[{guid:e,partialModel:{propertiesByName:t}}]}))}updateComponentModel(e,t){this.dispatcher.dispatch(Ne({payload:[{guid:e,partialModel:t}]}))}getComponentProperties(e){return this.store$.select(mt,{guid:e})}getComponentPropertyValue(e,t){return this.store$.select(mt,{guid:e,propertyName:t}).pipe((0,h.withLatestFrom)(this.getComponentModel(e)),(0,h.switchMap)(([e,t])=>t?(0,f.of)(e):f.EMPTY))}getComponentType(e){return this.store$.select(ut,{guid:e})}getComponentPermissions(e){return this.store$.select(ht,{guid:e})}getComponentLayout(e){return this.store$.select(ft,{guid:e})}updateSelectedComponentProperties(e){this.selectedComponentGuid$.pipe((0,h.take)(1)).subscribe(t=>{this.updateComponentProperties(t,e)})}saveViewDefinition(e){this.dispatcher.dispatch(Ke({payload:e}))}updateViewProperties(e){this.dispatcher.dispatch(He({payload:e}))}setViewProperties(e){this.dispatcher.dispatch(Qe({payload:e}))}getViewPropertyValue(e){return this.store$.select(st,{propertyName:e}).pipe((0,h.switchMapTo)(this.viewModel$.pipe((0,h.map)(t=>t[e]),(0,h.take)(1))),(0,h.distinctUntilChanged)())}runPreview(){this.dispatcher.dispatch(Ye())}clearCanvas(){this.dispatcher.dispatch(tt())}setComponentInspector(e,t){this.rxViewDesignerInspectorService.set(e,t)}setValidationIssues(e,t){this.dispatcher.dispatch(Re({guid:e,issues:t}))}setExpressionValidationIssues(e){this.dispatcher.dispatch(Ie({issues:e}))}setViewInspectorConfig(e){this.viewModelGuid$.pipe((0,h.take)(1)).subscribe(t=>{this.setComponentInspector(t,e)})}removeViewComponents(e,t){e.length&&this.dispatcher.dispatch(ke({guids:e,selectParent:t}))}setComponentSettablePropertiesDataDictionary(e,t,i){this.settablePropertiesDataDictionarySubject.next({guid:e,componentName:t,dataDictionary:this.rxViewDataDictionaryBuilderService.getSettablePropertiesDataDictionary(i)})}setComponentCommonDataDictionaryBranch(e,t){this.rxViewDataDictionaryService.setCommonDataDictionaryBranch(e,t?this.rxViewDataDictionaryBuilderService.getComponentCommonDataDictionaryBranch(t):null)}setViewCommonDataDictionaryBranch(e){this.rxViewDataDictionaryService.setViewCommonDataDictionaryBranch(e)}removeAllActionDataDictionaryBranches(){this.rxViewDataDictionaryService.removeAllActionOutputDataDictionaryBranches()}removeActionDataDictionaryBranch(e){this.rxViewDataDictionaryService.removeActionOutputDataDictionaryBranch(e)}setActionDataDictionaryBranch(e,t,i,n=null){this.rxViewDataDictionaryService.setActionOutputDataDictionaryBranch(e,t,this.rxViewDataDictionaryBuilderService.getActionOutputDataDictionaryBranch(i,n))}updateActionDataDictionaryBranchOrder(e){this.rxViewDataDictionaryService.updateActionOutputDataDictionaryBranchOrder(e)}getChildComponentGuids(e,t=!1,i){return(0,f.combineLatest)([this.store$.select(ft,{guid:e}),this.store$.select(gt,{guid:e})]).pipe((0,h.switchMap)(()=>this.getComponentModel(e).pipe((0,h.take)(1))),(0,h.switchMap)(e=>e?(0,f.of)((0,u.compact)([...e.layout?p.RxViewLayout.getViewLayoutChildGuids(e.layout):[],...e.childDataComponentGuids||[]])):f.EMPTY),(0,h.switchMap)(e=>e.length&&t?(0,f.combineLatest)(e.map(e=>this.getChildComponentGuids(e,!0))).pipe((0,h.map)(u.flatten),(0,h.map)(t=>[...t,...e])):(0,f.of)(e)),(0,h.switchMap)(e=>e.length?this.viewComponentModels$.pipe((0,h.map)(t=>{let n=e.filter(e=>t[e]);return i&&(n=n.filter(e=>i({type:t[e].type,guid:t[e].guid,data:t[e].propertiesByName}))),n}),(0,h.take)(1)):(0,f.of)(e)))}getChildComponents(e,t){return this.getChildComponentGuids(e,!1,t).pipe((0,h.switchMap)(e=>e.length?(0,f.combineLatest)(e.map(e=>this.getComponentProperties(e).pipe((0,h.withLatestFrom)(this.getComponentModel(e)),(0,h.switchMap)(([t,i])=>i?(0,f.of)({type:i.type,data:t,guid:e}):f.EMPTY)))):(0,f.of)([])))}getComponent(e){return this.getComponentModel(e).pipe((0,h.map)(e=>e?{data:e.propertiesByName,guid:e.guid,type:e.type}:null))}getComponentsByType(e){return this.viewComponentModels$.pipe((0,h.map)(t=>(0,u.filter)(t,{type:e}).map(e=>({guid:e.guid,data:e.propertiesByName,type:e.type}))))}getChildComponentTree(e){return this.viewComponentModels$.pipe((0,h.map)(t=>{const i=e=>ve(e).reduce((e,n)=>(t[n]&&e.push({guid:n,data:t[n].propertiesByName,type:t[n].type,children:i(t[n])}),e),[]);return t[e]?i(t[e]):[]}))}getParentComponentGuid(e,t){return this.store$.select(pt,{guid:e}).pipe((0,h.switchMap)(e=>e&&t?this.store$.select(ut,{guid:e}).pipe((0,h.switchMap)(i=>i===t?(0,f.of)(e):this.getParentComponentGuid(e,t))):(0,f.of)(e||null)))}setChildren(e,t){this.dispatcher.dispatch(Ee({payload:{guid:e,data:t}}))}}Ft.\u0275fac=function(e){return new(e||Ft)(n["\u0275\u0275inject"](je),n["\u0275\u0275inject"](y.Store),n["\u0275\u0275inject"](v.Actions),n["\u0275\u0275inject"](Ce),n["\u0275\u0275inject"](g.RxGuidService),n["\u0275\u0275inject"](xe),n["\u0275\u0275inject"](be),n["\u0275\u0275inject"](l.RxOverlayService))},Ft.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Ft,factory:Ft.\u0275fac,providedIn:"root"});class Et{constructor(){this.models=new Map}clear(){this.models.clear()}set(e,t){this.models.set(e,t)}get(e){return this.models.get(e)}delete(e){this.models.delete(e)}}Et.\u0275fac=function(e){return new(e||Et)},Et.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Et,factory:Et.\u0275fac,providedIn:"root"});class Mt{constructor(e,t,i,n){this.rxDefinitionNameService=e,this.rxBundleCacheService=t,this.viewDesignerModels=i,this.rxViewDefinitionLocalizationService=n}generate(e,t,i=!1){const n=e,o=(0,u.omit)(n,"displayName","layout","layoutName","pageComponent","isAngularJsView");return o.name=o.name||this.rxDefinitionNameService.getDefinitionName(this.rxBundleCacheService.bundleId,n.displayName),o.componentDefinitions=this.generateComponentDefinitions(n,t),i&&(o.localizableStringsByComponentId=this.rxViewDefinitionLocalizationService.extractLocalizableStrings(o)),delete o.localizablePropertyToStringGuidMap,o.layout=JSON.stringify(n.layout),o}generateComponentDefinitions(e,t){return ve(e).map(e=>{const i=Object.assign({},t[e]),n=this.viewDesignerModels.get(e),o=(0,u.isFunction)(null==n?void 0:n.getPropertiesByName)?n.getPropertiesByName(i.propertiesByName):i.propertiesByName;return i.propertiesByName=this.serializeComponentDefinitionProperties(o),delete i.parentGuid,i.type!==p.RxViewComponentType.Action&&(0,u.has)(i.propertiesByName,"name")&&(i.propertiesByName.name&&(i.name=i.propertiesByName.name),delete i.propertiesByName.name),(i.layout||i.childDataComponentGuids)&&(i.componentDefinitions=this.generateComponentDefinitions(i,t),delete i.childDataComponentGuids),i.layout&&(i.layout=JSON.stringify(i.layout)),i})}serializeComponentDefinitionProperties(e){return(0,u.transform)(e,(e,t,i)=>{switch(!0){case(0,u.isArray)(t):case(0,u.isNumber)(t):case(0,u.isBoolean)(t):case(0,u.isPlainObject)(t):e[i]=JSON.stringify(t);break;case(0,u.isObject)(t):const n=Object.create(null);t.forEach((e,t)=>n[t]=e),e[i]=JSON.stringify(n);break;case(0,u.isFunction)(t):case(0,u.isUndefined)(t):e[i]=null;break;default:e[i]=t}},{})}}function At(e){return!/^[a-z][-\w]+$/gi.test((0,u.isObject)(e)?e.data.value:e)}function Ot(e){const t=[];if(e){e.split(" ").some(At)&&t.push({type:"error",propertyName:"styles",description:"CSS class name is invalid."})}return t}function Pt(e){const t=[];return(null==e?void 0:e.length)||t.push({type:"error",propertyName:p.RX_AVAILABLE_ON_DEVICES_PROP_NAME,description:"At least one device must be selected."}),t}function Tt(e){return[...Ot(e[p.RX_STYLES_PROP_NAME]),...Pt(e[p.RX_AVAILABLE_ON_DEVICES_PROP_NAME])]}Mt.\u0275fac=function(e){return new(e||Mt)(n["\u0275\u0275inject"](l.RxDefinitionNameService),n["\u0275\u0275inject"](l.RxBundleCacheService),n["\u0275\u0275inject"](Et),n["\u0275\u0275inject"](p.RxViewDefinitionLocalizationService))},Mt.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Mt,factory:Mt.\u0275fac,providedIn:"root"});class Vt{constructor(e,t,i,n,o){this.rxDefaultExpressionValidatorService=e,this.rxDefaultExpressionEvaluatorService=t,this.rxStringService=i,this.rxExpressionParserService=n,this.viewDesignerFacade=o}validate(e,t,i=this.rxStringService.prettify(t),n=this.rxDefaultExpressionEvaluatorService){let o=(0,f.of)([]);if(this.rxDefaultExpressionValidatorService.isValid(e,n)){if(this.rxStringService.isNonEmptyString(e)){const i=new Set;if(this.rxExpressionParserService.parse(e,(e,t)=>{if(e===l.ExpressionParserToken.RxExpression||e===l.ExpressionParserToken.SingleQuoteRxExpression){const e=/\${view\.components\.([0-9a-z-]+)\..+}/.exec(t);e&&e[1]&&i.add(e[1])}return t}),i.size){const e=Array.from(i);o=this.viewDesignerFacade.allComponentGuids$.pipe((0,h.map)(t=>e.filter(e=>!t.has(e))),(0,h.distinctUntilChanged)(u.isEqual),(0,h.map)(e=>e.map(()=>({type:"error",description:"Expression references a non-existent view component.",propertyName:t}))))}}}else o=(0,f.of)([{type:"error",description:`${i} must be a valid expression.`,propertyName:t}]);return o}}Vt.\u0275fac=function(e){return new(e||Vt)(n["\u0275\u0275inject"](p.RxDefaultExpressionValidatorService),n["\u0275\u0275inject"](p.RxDefaultExpressionEvaluatorService),n["\u0275\u0275inject"](g.RxStringService),n["\u0275\u0275inject"](l.RxExpressionParserService),n["\u0275\u0275inject"](Ft))},Vt.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Vt,factory:Vt.\u0275fac,providedIn:"root"});class Nt{constructor(e,t,i,n,o){this.viewDesignerFacade=e,this.rxViewDataDictionaryBuilderService=t,this.rxViewComponentRegistryService=i,this.rxObjectUtilsService=n,this.rxDataDictionaryUtils=o,this.componentsCommonDataDictionaryStateClone$=this.viewDesignerFacade.componentsCommonDataDictionaryState$.pipe((0,h.map)(e=>e?this.rxObjectUtilsService.cloneDeep(e):{}),(0,h.shareReplay)(1)),this.viewCommonDataDictionaryStateClone$=this.viewDesignerFacade.viewCommonDataDictionaryState$.pipe((0,h.filter)(Boolean),(0,h.map)(e=>this.rxObjectUtilsService.cloneDeep(e)),(0,h.shareReplay)(1)),this.commonDataDictionary$=this.getCommonDataDictionary(),this.settablePropertiesDataDictionary$=this.viewDesignerFacade.settablePropertiesDataDictionaryState$.pipe((0,h.withLatestFrom)(this.viewDesignerFacade.viewDesignerModelState$),(0,h.map)(([e,t])=>this.rxObjectUtilsService.cloneDeep(this.getSettablePropsDataDictionary(e,t))))}getActionDataDictionary(e){return(0,f.combineLatest)([this.viewDesignerFacade.actionsDataDictionaryState$,this.getCommonDataDictionary()]).pipe((0,h.map)(([t,i])=>{const n=(0,u.find)(t,{guid:e});return[{label:"Actions",children:n?(0,u.flow)(e=>(0,u.take)(e,n.index),e=>(0,u.map)(e,"dataDictionaryBranch"),u.compact,e=>(0,u.filter)(e,e=>{var t;return null===(t=e.children)||void 0===t?void 0:t.length}),e=>this.rxObjectUtilsService.cloneDeep(e))(t):[]},...i]}),(0,h.distinctUntilChanged)(u.isEqual))}getComponentCommonDataDictionary(e){return this.componentsCommonDataDictionaryStateClone$.pipe((0,h.map)(t=>t[e]))}getCommonDataDictionary(e){return(0,f.combineLatest)([this.viewCommonDataDictionaryStateClone$,this.componentsCommonDataDictionaryStateClone$.pipe((0,h.map)(t=>Object.values(e?Object.assign(Object.assign({},t),e):t)))]).pipe((0,h.map)(([e,t])=>[{label:"General",children:[{label:"Current user",icon:"d-icon-dollar",expression:"${keywords.user}"},{label:"New line",icon:"d-icon-dollar",expression:"${keywords.newLine}"}]},{label:"Functions",children:this.rxDataDictionaryUtils.getFunctionsDataDictionaryBranch(p.RX_EXPRESSION_FUNCTIONS)},Object.assign(Object.assign({},e),{children:[{label:"Components",children:(0,u.compact)(t),expanded:!0},...e.children]})]))}getSettablePropsDataDictionary(e,t){return ve(t.viewDesignModel).map(i=>this.getSettablePropsDataDictionaryBranch(i,t,e,!0)).filter(Boolean)}getSettablePropsDataDictionaryBranch(e,t,i,n=!1){const o=i[e],r=t.viewComponentDesignModels[e],a=this.rxViewComponentRegistryService.get(r.type),s=a.outlets&&r.layout?p.RxViewLayout.getViewLayoutChildGuids(r.layout):null,l=(0,u.map)(s,e=>this.getSettablePropsDataDictionaryBranch(e,t,i)).filter(Boolean),d=(0,u.get)(o,"dataDictionary",[]);if(l.length||d.length)return{label:(null==o?void 0:o.componentName)||a.name,expanded:n,children:l.length&&d.length?[{label:"Components",children:l},{label:"Properties",children:d}]:l.length?l:d}}}Nt.\u0275fac=function(e){return new(e||Nt)(n["\u0275\u0275inject"](Ft),n["\u0275\u0275inject"](xe),n["\u0275\u0275inject"](p.RxViewComponentRegistryService),n["\u0275\u0275inject"](g.RxObjectUtilsService),n["\u0275\u0275inject"](l.RxDataDictionaryUtils))},Nt.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Nt,factory:Nt.\u0275fac,providedIn:"root"});class kt extends l.RxExpressionConfigurator{constructor(e){super(),this.injector=e,this.rxExpressionHelperService=this.injector.get(p.RxExpressionHelperService)}getDefaultConfig(){return Object.assign(Object.assign({},super.getDefaultConfig()),{dataDictionary$:this.commonDataDictionary$,operators:l.ExpressionOperatorRowsByGroup.get(l.ExpressionOperatorGroup.AllClient),validateExpression:(e,t)=>{let i=!0;const n=this.getExpressionEvaluator(e);try{n.parseExpression(this.rxExpressionHelperService.prepare(t))}catch(o){i=!1}return(0,f.of)(i)}})}}class jt extends kt{constructor(e,t,i,n){super(e),this.injector=e,this.componentGuid=t,this.componentModel=i,this.componentType=n,this.rxDefaultExpressionEvaluatorService=this.injector.get(p.RxDefaultExpressionEvaluatorService),this.rxViewDataDictionaryService=this.injector.get(Nt),this.rxViewComponentRegistryService=this.injector.get(p.RxViewComponentRegistryService),this.commonDataDictionary$=this.rxViewDataDictionaryService.commonDataDictionary$}getExpressionEvaluator(e){var t;const i=this.componentType&&this.rxViewComponentRegistryService.get(this.componentType).properties.find(t=>t.name===e);return(0,u.isFunction)(null===(t=null==i?void 0:i.evaluatorService)||void 0===t?void 0:t.parseExpression)?i.evaluatorService:this.rxDefaultExpressionEvaluatorService}getCommonDataDictionary(e,t=this.componentGuid){return e?e.pipe((0,h.switchMap)(e=>this.rxViewDataDictionaryService.getCommonDataDictionary({[t]:e}))):this.commonDataDictionary$}getComponentCommonDataDictionary(e){return this.rxViewDataDictionaryService.getComponentCommonDataDictionary(e||this.componentGuid)}}class _t{constructor(e,t,i){this.viewDesignerFacade=e,this.rxOverlayService=t,this.translateService=i,this.destroyed$=new f.ReplaySubject(1)}ngOnInit(){(0,f.combineLatest)([this.viewDesignerFacade.getViewPropertyValue("allowOverlay"),this.viewDesignerFacade.getViewPropertyValue("scope"),this.viewDesignerFacade.getViewPropertyValue("overlayGroupId"),this.viewDesignerFacade.getViewPropertyValue("overlayDescriptor"),this.viewDesignerFacade.getViewPropertyValue("lastUpdateTime")]).pipe((0,h.withLatestFrom)(this.viewDesignerFacade.viewModel$),(0,h.takeUntil)(this.destroyed$)).subscribe(([[e,t,i,n,o],r])=>{this.controlOptions={allowOverlay:e,scope:t,overlayGroupId:i,overlayDescriptor:n,isDisabled:!this.rxOverlayService.isCustomizationEnabled("allowOverlay",r),definitionTypeDisplayName:this.translateService.instant("com.bmc.arsys.rx.client.view-definition.label").toLowerCase()}})}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}setCustomization(e){this.viewDesignerFacade.updateViewProperties(e)}}_t.\u0275fac=function(e){return new(e||_t)(n["\u0275\u0275directiveInject"](Ft),n["\u0275\u0275directiveInject"](l.RxOverlayService),n["\u0275\u0275directiveInject"](m.TranslateService))},_t.\u0275cmp=n["\u0275\u0275defineComponent"]({type:_t,selectors:[["rx-view-customization-options"]],inputs:{options:"options"},decls:1,vars:2,consts:[[3,"options","ngModel","ngModelChange"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"rx-scope-customization-control",0),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.value=e})("ngModelChange",function(e){return t.setCustomization(e)}),n["\u0275\u0275elementEnd"]()),2&e&&n["\u0275\u0275property"]("options",t.controlOptions)("ngModel",t.value)},directives:[d.CustomizationOptionsComponent,x.NgControlStatus,x.NgModel],encapsulation:2});class Bt{constructor(e){this.viewDesignerFacade=e,this.events=new n.EventEmitter,this.controlOptions$=(0,f.combineLatest)([this.viewDesignerFacade.getViewPropertyValue("allowOverlay"),this.viewDesignerFacade.getViewPropertyValue("scope"),this.viewDesignerFacade.getViewPropertyValue("overlayGroupId"),this.viewDesignerFacade.getViewPropertyValue("overlayDescriptor")]).pipe((0,h.map)(([e,t,i,n])=>({allowOverlay:e,scope:t,overlayGroupId:i,overlayDescriptor:n})))}}Bt.\u0275fac=function(e){return new(e||Bt)(n["\u0275\u0275directiveInject"](Ft))},Bt.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Bt,selectors:[["rx-view-revert-customization"]],inputs:{options:"options",isDisabled:"isDisabled"},outputs:{events:"events"},decls:2,vars:4,consts:[[3,"options","isDisabled","events"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"rx-revert-customization",0),n["\u0275\u0275listener"]("events",function(e){return t.events.emit(e)}),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275elementEnd"]()),2&e&&n["\u0275\u0275property"]("options",n["\u0275\u0275pipeBind1"](1,2,t.controlOptions$))("isDisabled",t.isDisabled)},directives:[d.RxRevertCustomizationComponent],pipes:[b.AsyncPipe],encapsulation:2});class $t{}$t.\u0275fac=function(e){return new(e||$t)},$t.\u0275mod=n["\u0275\u0275defineNgModule"]({type:$t,declarations:[Bt],imports:[b.CommonModule,d.RxRevertCustomizationModule]}),$t.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[b.CommonModule,d.RxRevertCustomizationModule]]});class Lt{constructor(e,t,i,n,o,r,a,s,l,d,c,p,m){this.injector=e,this.viewDesignerFacade=t,this.rxStringService=i,this.rxOverlayService=n,this.rxViewComponentRegistryService=o,this.rxBundleCacheService=r,this.rxModalService=a,this.rxViewDefinitionCacheService=s,this.rxViewDefinitionParserService=l,this.rxGuidService=d,this.viewDesignerDispatcher=c,this.rxDefinitionNameService=p,this.rxViewExpressionValidatorService=m,this.expressionConfigurator=new jt(this.injector,null,this),this.destroyed$=new f.ReplaySubject(1),this.allViewDefinitionNamesByBundleId$=this.viewDesignerFacade.currentBundleId$.pipe((0,h.filter)(Boolean),(0,h.switchMap)(e=>this.rxViewDefinitionCacheService.getViewDefinitionNames(e).pipe((0,h.map)(e=>e.map(e=>this.rxDefinitionNameService.getDisplayNameForValidation(e)))))),this.targetExtensionContainerOptions$=this.viewDesignerFacade.getViewPropertyValue("targetViewDefinitionName").pipe((0,h.switchMap)(e=>e?this.getTargetExtensionContainerOptions(e).pipe((0,h.take)(1)):(0,f.of)(null)),(0,h.shareReplay)(1)),this.targetViewDefinition$=this.viewDesignerFacade.getViewPropertyValue("targetViewDefinitionName").pipe((0,h.filter)(Boolean),(0,h.switchMap)(e=>this.rxViewDefinitionCacheService.getViewDefinition(e))),this.init()}init(){this.viewDesignerFacade.initViewDesigner$.pipe((0,h.concatMapTo)(this.viewDesignerFacade.viewModelsInitialized$.pipe((0,h.switchMapTo)((0,f.combineLatest)([this.viewDesignerFacade.viewComponentModels$.pipe((0,h.map)(e=>{const t=Object.values(e).find(e=>e.type===p.RxViewComponentType.Page);return t?e[t.childDataComponentGuids[0]].type:null})),this.viewDesignerFacade.viewModel$,this.targetExtensionContainerOptions$]).pipe((0,h.take)(1))))),(0,h.takeUntil)(this.destroyed$)).subscribe(([e,t,i])=>{this.viewDesignerFacade.updateViewProperties({pageComponent:e}),this.viewDesignerFacade.setViewInspectorConfig(this.getInspector(Object.assign(Object.assign({},t),{pageComponent:e}),i))}),this.viewDesignerFacade.initViewDesigner$.pipe((0,h.switchMapTo)(this.targetExtensionContainerOptions$.pipe((0,h.skip)(1),(0,h.withLatestFrom)(this.viewDesignerFacade.viewModel$))),(0,h.takeUntil)(this.destroyed$)).subscribe(([e,t])=>this.onTargetExtensionContainerOptionsChange(e,t)),this.viewDesignerFacade.initViewDesigner$.pipe((0,h.switchMapTo)(this.viewDesignerFacade.getViewPropertyValue("pageComponent").pipe((0,h.skip)(1),(0,h.switchMapTo)((0,f.combineLatest)([this.viewDesignerFacade.viewModel$,this.viewDesignerFacade.viewComponentModels$,this.targetExtensionContainerOptions$]).pipe((0,h.take)(1))))),(0,h.takeUntil)(this.destroyed$)).subscribe(([e,t,i])=>this.onPageComponentChange(e,t,i)),this.viewDesignerFacade.initViewDesigner$.pipe((0,h.switchMapTo)(this.viewDesignerFacade.getViewPropertyValue("targetViewDefinitionName").pipe((0,h.skip)(1))),(0,h.switchMap)(()=>this.viewDesignerFacade.viewComponentModels$.pipe((0,h.first)())),(0,h.takeUntil)(this.destroyed$)).subscribe(e=>{(0,u.isEmpty)(e)||this.viewDesignerFacade.clearCanvas()}),this.viewDesignerFacade.initViewDesigner$.pipe((0,h.switchMapTo)((0,f.combineLatest)([this.viewDesignerFacade.getViewPropertyValue("styles").pipe((0,h.map)(Ot)),this.validateDisplayName(),this.validateInputParams(),this.validateOutputParamExpressions(),this.validateExtensionContainer()]).pipe((0,h.map)(u.flatten),(0,h.map)(u.compact),(0,h.withLatestFrom)(this.viewDesignerFacade.viewModelGuid$))),(0,h.takeUntil)(this.destroyed$)).subscribe(([e,t])=>{this.viewDesignerFacade.setValidationIssues(t,e)}),this.viewDesignerFacade.initViewDesigner$.pipe((0,h.switchMapTo)(this.viewDesignerFacade.getViewPropertyValue("inputParams")),(0,h.takeUntil)(this.destroyed$)).subscribe(e=>this.viewDesignerFacade.setViewCommonDataDictionaryBranch(this.getViewCommonDataDictionary(e))),this.viewDesignerFacade.getViewPropertyValue("targetExtensionContainerGuid").pipe((0,h.withLatestFrom)(this.targetViewDefinition$),(0,h.map)(([e,t])=>this.getTargetRecordDefinitionName(t,e)),(0,h.distinctUntilChanged)(),(0,h.switchMapTo)(this.viewDesignerFacade.viewComponentModels$.pipe((0,h.take)(1))),(0,h.filter)(e=>!(0,u.isEmpty)(e)),(0,h.takeUntil)(this.destroyed$)).subscribe(()=>this.viewDesignerFacade.clearCanvas())}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}getTargetExtensionContainerOptions(e){return this.rxViewDefinitionCacheService.getViewDefinition(e).pipe((0,h.map)(e=>this.rxViewDefinitionParserService.getComponents(e).filter(({componentDefinition:e})=>e.type===p.RxViewComponentType.ExtensionContainer).map(({componentDefinition:e})=>({id:e.guid,name:e.propertiesByName.name||e.name}))))}onTargetExtensionContainerOptionsChange(e,t){this.viewDesignerFacade.setViewInspectorConfig(this.getInspector(t,e)),e?1===e.length&&this.viewDesignerFacade.updateViewProperties({targetExtensionContainerGuid:e[0].id}):this.viewDesignerFacade.updateViewProperties({targetExtensionContainerGuid:null})}onPageComponentChange(e,t,i){const n=(0,u.find)(t,{type:p.RxViewComponentType.Page});this.viewDesignerFacade.setViewInspectorConfig(this.getInspector(e,i));const o=[];if(e.pageComponent){if(n)this.viewDesignerFacade.updateComponentModel(n.childDataComponentGuids[0],{type:e.pageComponent});else{const i=this.rxGuidService.generate();(0,u.isEmpty)(t)||this.viewDesignerFacade.removeViewComponents(ve(e)),o.push(we({payload:[{componentModel:{guid:i,resourceType:p.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent,type:p.RxViewComponentType.Page,propertiesByName:{},parentGuid:e.guid},insertIndex:0,columnIndex:0,outletName:p.RX_VIEW_DEFINITION.defaultOutletName}]}),De({payload:[{componentModel:{guid:this.rxGuidService.generate(),type:e.pageComponent,resourceType:p.RX_VIEW_DEFINITION.resourceTypes.viewComponent,propertiesByName:{},parentGuid:i}}]}))}this.viewDesignerFacade.updateViewProperties({inputParams:[],outputParams:[]})}else n&&this.viewDesignerFacade.removeViewComponents([n.guid]);o.forEach(e=>this.viewDesignerDispatcher.dispatch(e))}getInspector(e,t=[]){const i=!Boolean(e.lastUpdateTime)||this.rxOverlayService.isCustomizationEnabled("allowOverlay",e),n=this.rxViewComponentRegistryService.getBundlePageComponents(this.rxBundleCacheService.bundleId).map(e=>({id:e.type,name:e.name}));e.pageComponent&&!this.rxViewComponentRegistryService.get(e.pageComponent)&&n.unshift({name:p.RX_VIEW_DEFINITION.unknownPageComponent.name,id:e.pageComponent});const o={name:"pageComponent",component:d.SelectFormControlComponent,options:{label:"Page component",options:n,beforeValueChange:(e,t)=>this.viewDesignerFacade.viewModel$.pipe((0,h.take)(1),(0,h.withLatestFrom)(this.viewDesignerFacade.viewComponentModels$),(0,h.map)(([i,n])=>!(null==e?void 0:e.length)&&t.length&&(i.inputParams.length||i.outputParams.length||!(0,u.isEmpty)(n)))).toPromise().then(e=>!e||this.rxModalService.confirm({title:"Warning",modalStyle:c.RX_MODAL.modalStyles.warning,message:"The view canvas, input and output parameters will be cleared. Do you want to continue?"})),emptyOption:!0}},r={name:"targetExtensionContainerGuid",component:d.SelectFormControlComponent,options:{label:"Extension container",tooltip:new l.Tooltip("Select an extension container in the view to extend where record editor fields from this view will be injected.\n            The records defined for the view to extend and for this view must be associated one-to-one."),options:t||[],required:!0,beforeValueChange:(e,t)=>this.isTargetRecordDefinitionChanged(e,t).pipe((0,h.withLatestFrom)(this.viewDesignerFacade.viewComponentModels$),(0,h.map)(([e,t])=>!(0,u.isEmpty)(t)&&e),(0,h.take)(1)).toPromise().then(e=>!e||this.rxModalService.confirm({title:"Warning",modalStyle:c.RX_MODAL.modalStyles.warning,message:"The view canvas will be cleared. Do you want to continue?"}))}},a=[{label:"General",controls:[{name:"displayName",component:d.TextFormControlComponent,isDisabled:Boolean(e.lastUpdateTime),options:{required:!0,label:"Name"}},{name:"description",component:d.TextareaFormControlComponent,isDisabled:!i,options:{label:"Description",rows:3}},{name:"layoutName",component:d.TextFormControlComponent,isDisabled:!0,options:{label:"Layout template"}},{name:"targetViewDefinitionName",component:d.RxDefinitionPickerComponent,isDisabled:!i,options:{label:"View to extend",tooltip:new l.Tooltip("Select a view to extend in order to inject this view into it.\n                The view to extend may be read-only, but must contain at least one Record editor with an Extension container."),definitionType:d.RxDefinitionPickerType.View,beforeValueChange:(e,t)=>this.viewDesignerFacade.viewComponentModels$.pipe((0,h.first)(),(0,h.withLatestFrom)(this.viewDesignerFacade.viewModel$)).toPromise().then(([i,n])=>{const o=Boolean(!(null==e?void 0:e.length)&&t.length&&(n.inputParams.length||n.outputParams.length));let r;return!(0,u.isEmpty)(i)&&o?r="The view canvas, input and output parameters will be cleared. Do you want to continue?":(0,u.isEmpty)(i)?o&&(r="The input and output parameters will be cleared. Do you want to continue?"):r="The view canvas will be cleared. Do you want to continue?",!r||this.rxModalService.confirm({title:"Warning",modalStyle:c.RX_MODAL.modalStyles.warning,message:r})})}},{name:"styles",component:d.TagsFormControlComponent,isDisabled:!i,options:{label:"CSS classes",placeholder:"Add CSS classes",tooltip:new l.Tooltip("Enter CSS class names to apply to this view."),errorCheck:At}},{name:"permissions",component:d.RxPermissionEditorComponent,isDisabled:!i,options:{label:"Permissions",type:"view"}},{component:Bt},{component:_t}]},{label:"Input parameters",controls:[{name:"inputParams",component:d.ListFormControlComponent,isDisabled:!i,options:{addItemText:"Add",emptyListText:"No input parameters added.",items:[{label:"Name",propertyName:"name"}]}}]},{label:"Output parameters",controls:[{name:"outputParams",component:d.ListFormControlComponent,isDisabled:!i,options:{addItemText:"Add",emptyListText:"No output parameters added.",items:[{label:"Name",propertyName:"name"},{label:"Source",propertyName:"source",dataDictionary$:this.expressionConfigurator.getDataDictionary(),operators:this.expressionConfigurator.getOperators()}]}}]}];if(n.length&&a[0].controls.splice(2,0,o),e.pageComponent&&(a.splice(1,2),a[0].controls.splice((0,u.findIndex)(a[0].controls,{name:"targetViewDefinitionName"}),1)),e.targetViewDefinitionName){const e=(0,u.findIndex)(a[0].controls,{name:"targetViewDefinitionName"});a[0].controls.splice(e+1,0,r),a[0].controls.splice((0,u.findIndex)(a[0].controls,{name:"pageComponent"}),1),a.splice(1,2),this.viewDesignerFacade.updateViewProperties({inputParams:[],outputParams:[]})}return{inspectorSectionConfigs:a}}validateDisplayName(){return this.viewDesignerFacade.getViewPropertyValue("displayName").pipe((0,h.switchMap)(e=>(0,f.combineLatest)([(0,f.of)(e?s.RX_RECORD_DEFINITION.validDefinitionNameRegex.test(e)?null:{type:"error",propertyName:"displayName",description:"View name can only contain letters, numbers, spaces, dashes, and underscores."}:{type:"error",propertyName:"displayName",description:"View name cannot be blank."}),this.viewDesignerFacade.getViewPropertyValue("lastUpdateTime").pipe((0,h.switchMap)(t=>e&&!t?this.allViewDefinitionNamesByBundleId$.pipe((0,h.map)(i=>!t&&(null==i?void 0:i.some(t=>this.rxStringService.caseInsensitiveIsEqual(e,t)))?{type:"error",propertyName:"displayName",description:"View definition with this name already exists."}:null),(0,h.take)(1)):(0,f.of)(null)),(0,h.take)(1))]))).pipe((0,h.map)(u.compact))}validateInputParams(){return this.viewDesignerFacade.getViewPropertyValue("inputParams").pipe((0,h.map)(e=>{const t=(0,u.flow)(e=>(0,u.map)(e,e=>e.name),u.compact)(e),i=(0,u.uniq)(t),n=[];return e.length&&t.length!==e.length&&n.push({type:"error",propertyName:"inputParams",description:"Input parameter name cannot be blank."}),t.length!==i.length&&n.push({type:"error",propertyName:"inputParams",description:"Input parameter names must be unique."}),n}))}validateOutputParamExpressions(){return this.viewDesignerFacade.getViewPropertyValue("outputParams").pipe((0,h.map)(e=>(0,u.map)(e,e=>e.source).filter(Boolean)),(0,h.distinctUntilChanged)(u.isEqual),(0,h.switchMap)(e=>e.length?(0,f.combineLatest)(e.map(e=>this.rxViewExpressionValidatorService.validate(e,"source","Output parameter source"))).pipe((0,h.map)(u.flatten)):(0,f.of)([])))}validateExtensionContainer(){return(0,f.combineLatest)([this.viewDesignerFacade.getViewPropertyValue("targetViewDefinitionName"),this.viewDesignerFacade.getViewPropertyValue("targetExtensionContainerGuid")]).pipe((0,h.map)(([e,t])=>e&&!t?{type:"error",propertyName:"targetExtensionContainerGuid",description:"Extension container cannot be blank."}:null))}getViewCommonDataDictionary(e){return{label:"View",expression:"${view.api}",icon:"d-icon-file_o",expanded:!0,children:[...(0,u.isEmpty)(e)?[]:[{label:"Input parameters",expanded:!0,children:e.filter(e=>e.name).map(e=>({label:e.name,expression:`\${view.inputParams.${e.name}}`,icon:"d-icon-arrow_right_square_input"}))}],{label:"Properties",expanded:!0,children:[{label:"Is valid",expression:"${view.isValid}",icon:"d-icon-arrow_right_square_input"}]}]}}isTargetRecordDefinitionChanged(e,t){return this.targetViewDefinition$.pipe((0,h.map)(i=>this.getTargetRecordDefinitionName(i,e)!==this.getTargetRecordDefinitionName(i,t)))}getTargetRecordDefinitionName(e,t){const i=this.rxViewDefinitionParserService.findParentComponentDefinition(e,{guid:t},e=>e.type===p.RxViewComponentType.RecordEditor);return null==i?void 0:i.propertiesByName.recordDefinitionName}}Lt.\u0275fac=function(e){return new(e||Lt)(n["\u0275\u0275inject"](n.Injector),n["\u0275\u0275inject"](Ft),n["\u0275\u0275inject"](g.RxStringService),n["\u0275\u0275inject"](l.RxOverlayService),n["\u0275\u0275inject"](p.RxViewComponentRegistryService),n["\u0275\u0275inject"](l.RxBundleCacheService),n["\u0275\u0275inject"](c.RxModalService),n["\u0275\u0275inject"](p.RxViewDefinitionCacheService),n["\u0275\u0275inject"](p.RxViewDefinitionParserService),n["\u0275\u0275inject"](g.RxGuidService),n["\u0275\u0275inject"](je),n["\u0275\u0275inject"](l.RxDefinitionNameService),n["\u0275\u0275inject"](Vt))},Lt.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Lt,factory:Lt.\u0275fac});const Gt=new n.InjectionToken("CanvasItemApi");class qt{constructor(){this.core=null}registerCoreApi(e){this.core=e}}qt.\u0275fac=function(e){return new(e||qt)},qt.\u0275prov=n["\u0275\u0275defineInjectable"]({token:qt,factory:qt.\u0275fac});class Ut{constructor(e,t,i,n){this.data=e,this.targetGuid=t,this.outletName=i,this.insertIndex=n}}class zt{constructor(){this.componentSelectSubject=new f.ReplaySubject,this.componentRemoveSubject=new f.ReplaySubject,this.componentDropSubject=new f.ReplaySubject,this.componentDrop$=this.componentDropSubject.asObservable(),this.componentSelect$=this.componentSelectSubject.asObservable(),this.componentRemove$=this.componentRemoveSubject.asObservable()}selectComponent(e){this.componentSelectSubject.next(e)}removeComponent(e){this.componentRemoveSubject.next(e)}dropComponent(e,t,i,n){this.componentDropSubject.next(new Ut(e,t,i,n))}}zt.\u0275fac=function(e){return new(e||zt)},zt.\u0275prov=n["\u0275\u0275defineInjectable"]({token:zt,factory:zt.\u0275fac});class Xt{constructor(e,t,i,n){this.injector=e,this.renderer=t,this.canvasItemApi=i,this.viewDesignerCanvasService=n,this.interactive=!0,this.childContainers=new Map}ngOnInit(){this.initializeItemApi()}ngOnChanges(e){const t=e.layout;if(t){const e=(0,u.get)(t,"previousValue.guid"),i=(0,u.get)(t,"currentValue.guid"),n=(0,u.get)(t,"previousValue.outlets"),o=(0,u.get)(t,"currentValue.outlets");e!==i?(this.componentReference&&this.cleanUp(),this.renderViewComponent()):(0,u.isEqual)(n,o)||o.forEach(e=>{const t=this.childContainers.get(e.name);t&&(t.instance.outlet=e,t.instance.layout=this.layout)})}}ngOnDestroy(){this.cleanUp()}cleanUp(){this.componentReference.destroy(),this.childContainers.clear()}registerOutlet(e,t,i){const n=this.layout.outlets.find(t=>t.name===e),o=this.renderContainerComponent(t,n,i);return this.childContainers.set(e,o),o}onSelectComponent(e){this.interactive&&(e.stopPropagation(),this.viewDesignerCanvasService.selectComponent(this.layout.guid))}dropComponent(e,t,i=p.RX_VIEW_DEFINITION.defaultOutletName){this.viewDesignerCanvasService.dropComponent(e,this.layout.guid,i,t)}initializeItemApi(){this.canvasItemApi.registerCoreApi({dropComponent:this.dropComponent.bind(this),registerOutlet:this.registerOutlet.bind(this)})}renderViewComponent(){this.componentReference=this.container.createComponent(this.layout.factory,null,this.injector);const e=this.componentReference.instance,t=this.componentReference.location.nativeElement;e.guid=this.layout.guid,e.model=this.layout.model,e.isReadOnly=this.isReadOnly,this.renderer.setAttribute(t,"rx-view-component-id",this.layout.guid)}renderContainerComponent(e,t,i){const n=e.createComponent(i);return n.instance.outlet=t,n.instance.layout=this.layout,n.instance.isReadOnly=this.isReadOnly,n}}Xt.\u0275fac=function(e){return new(e||Xt)(n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](n.Renderer2),n["\u0275\u0275directiveInject"](Gt),n["\u0275\u0275directiveInject"](zt))},Xt.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Xt,selectors:[["rx-canvas-item"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](R,7,n.ViewContainerRef),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.container=e.first)}},inputs:{layout:"layout",interactive:"interactive",isReadOnly:"isReadOnly"},features:[n["\u0275\u0275ProvidersFeature"]([{provide:Gt,useClass:qt}]),n["\u0275\u0275NgOnChangesFeature"]],decls:4,vars:3,consts:[[3,"hidden","click"],["container",""]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275listener"]("click",function(e){return t.onSelectComponent(e)}),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275elementContainer"](2,null,1),n["\u0275\u0275elementEnd"]()),2&e&&n["\u0275\u0275property"]("hidden",n["\u0275\u0275pipeBind1"](1,1,null==t.layout||null==t.layout.model?null:t.layout.model.hiddenOnCanvas$))},pipes:[b.AsyncPipe],encapsulation:2});class Wt{constructor(e){this.viewDesignerCanvasService=e,this.componentSelect=new n.EventEmitter,this.componentDrop=new n.EventEmitter,this.componentRemove=new n.EventEmitter,this.beforeComponentDropInRoot=new n.EventEmitter}ngOnInit(){this.viewDesignerCanvasService.componentSelect$.subscribe(e=>{this.componentSelect.emit(e)}),this.viewDesignerCanvasService.componentRemove$.subscribe(e=>{this.componentRemove.emit(e)}),this.viewDesignerCanvasService.componentDrop$.subscribe(e=>{this.componentDrop.emit(e)})}}Wt.\u0275fac=function(e){return new(e||Wt)(n["\u0275\u0275directiveInject"](zt))},Wt.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Wt,selectors:[["rx-view-designer-canvas"]],inputs:{layout:"layout",isReadOnly:"isReadOnly"},outputs:{componentSelect:"componentSelect",componentDrop:"componentDrop",componentRemove:"componentRemove",beforeComponentDropInRoot:"beforeComponentDropInRoot"},features:[n["\u0275\u0275ProvidersFeature"]([zt])],decls:1,vars:1,consts:[["class","root-item",3,"layout","isReadOnly",4,"ngIf"],[1,"root-item",3,"layout","isReadOnly"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,I,1,2,"rx-canvas-item",0),2&e&&n["\u0275\u0275property"]("ngIf",t.layout)},directives:[b.NgIf,Xt],encapsulation:2,changeDetection:0});class Ht{constructor(){this.beforeViewComponentDropSubject=new f.ReplaySubject,this.beforeViewComponentDrop$=this.beforeViewComponentDropSubject.asObservable()}setBeforeViewComponentDropState(e){this.beforeViewComponentDropSubject.next(e)}canBeDropped(e){let t=!0;return(0,u.isFunction)(e.draggedViewComponentDescriptor.canBeInsertedInto)&&(t=e.draggedViewComponentDescriptor.canBeInsertedInto(e.dropTargetViewComponentWithParents.map(e=>e.type))),t&&(t=(!e.draggedViewComponentGuid||!this._isParentRecordEditorChanging(this.containerComponentInstance.layout.viewComponentWithParents,e.draggedViewComponentParents))&&this.componentDropPredicate(e)),t}componentDropPredicate(e,t=!1){return(t||this.dropPredicate(e))&&(!this.parentOutletComponent||this.parentOutletComponent.componentDropPredicate(e,this.skipParentPredicate))}_isParentRecordEditorChanging(e,t){const i=(0,u.find)(e,{type:p.RxViewComponentType.RecordEditor}),n=(0,u.find)(t,{type:p.RxViewComponentType.RecordEditor}),o=Boolean(i)&&Boolean(n)&&i.guid!==n.guid,r=!i&&Boolean(n),a=!n&&Boolean(i);return o||r||a}}Ht.\u0275fac=function(e){return new(e||Ht)},Ht.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Ht,factory:Ht.\u0275fac});class Qt{constructor(e,t){this.viewDesignerCanvasService=e,this.canvasOutletHelperService=t,this.dropListDropped=new n.EventEmitter,this.dropListEnterPredicateBind=(0,u.throttle)(this.dropListEnterPredicate.bind(this),200)}ngOnInit(){this.dropListOrientation=this.canvasOutletHelperService.dropListOrientation}getViewComponentDragData(e){return{draggedViewComponentGuid:e.guid,draggedViewComponentDescriptor:e.descriptor,draggedViewComponentParents:this.layout.viewComponentWithParents}}onDragEntered(e){this.enforceDragToSelf(e.container)}onDragStarted(e){this.enforceDragToSelf(e.source.dropContainer)}remove(e,t){e.stopPropagation(),this.viewDesignerCanvasService.removeComponent(t.guid)}onSelectComponent(e,t){e.stopPropagation(),this.viewDesignerCanvasService.selectComponent(t.guid)}trackByFn(e,t){return t.guid}dropListEnterPredicate(e){return this.canvasOutletHelperService.canBeDropped(Object.assign(Object.assign({},e.data),{dropTargetViewComponentWithParents:this.layout.viewComponentWithParents||[]}))}enforceDragToSelf(e){let t=e.connectedTo;t=t.reduce((e,t)=>{if((0,u.isString)(t)){const i=C.CdkDropList._dropLists.find(e=>e.id===t);i&&e.push(i)}return e},[]);const i=e._dropListRef;f.asapScheduler.schedule(()=>{i.connectedTo(t.map(e=>e._dropListRef))})}}Qt.\u0275fac=function(e){return new(e||Qt)(n["\u0275\u0275directiveInject"](zt),n["\u0275\u0275directiveInject"](Ht))},Qt.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Qt,selectors:[["rx-canvas-item-column"]],inputs:{isReadOnly:"isReadOnly",colIndex:"colIndex",column:"column",layout:"layout"},outputs:{dropListDropped:"dropListDropped"},decls:2,vars:9,consts:[["cdkDropList","",3,"cdkDropListOrientation","cdkDropListConnectedTo","cdkDropListEnterPredicate","cdkDropListData","id","cdkDropListDropped"],["cdkDrag","",3,"class","cdkDragData","cdkDragDisabled","cdkDragEntered","cdkDragStarted",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",3,"cdkDragData","cdkDragDisabled","cdkDragEntered","cdkDragStarted"],[1,"canvas-item",3,"click"],["cdkDragHandle","",1,"canvas-item-header",3,"hidden"],[1,"icon","d-icon-dots","mr-1"],[1,"label"],["class","remove-button btn btn-sm btn-link d-icon-cross_adapt p-0 px-1","type","button","aria-label","Close",3,"click",4,"ngIf"],[3,"layout","isReadOnly"],["type","button","aria-label","Close",1,"remove-button","btn","btn-sm","btn-link","d-icon-cross_adapt","p-0","px-1",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275listener"]("cdkDropListDropped",function(e){return t.dropListDropped.next(e)}),n["\u0275\u0275template"](1,E,10,16,"div",1),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("cdkDropListOrientation",t.dropListOrientation)("cdkDropListConnectedTo",t.column.dndListIds)("cdkDropListEnterPredicate",t.dropListEnterPredicateBind)("cdkDropListData",n["\u0275\u0275pureFunction1"](7,M,t.colIndex))("id",t.column.listId),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",t.column.children)("ngForTrackBy",t.trackByFn))},directives:[C.CdkDropList,b.NgForOf,C.CdkDrag,C.CdkDragHandle,b.NgIf,Xt],pipes:[b.AsyncPipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{display:block}.cdk-drop-list[_ngcontent-%COMP%]{min-height:100px}.cdk-drop-list[_ngcontent-%COMP%] > .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5}.card-header[_ngcontent-%COMP%]{cursor:move}.canvas-item-wrapper.cdk-drag-preview[_ngcontent-%COMP%]{background:white;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.canvas-item[_ngcontent-%COMP%]{border:1px solid transparent;position:relative;padding:3px}.canvas-item.active[_ngcontent-%COMP%]{border-color:#20c997}.canvas-item-header[_ngcontent-%COMP%]{color:#fff;position:absolute;top:0;right:0;padding:1px 0 1px 5px;background:#20c997;cursor:move;z-index:1;display:flex}.canvas-item-header[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{white-space:nowrap}.remove-button[_ngcontent-%COMP%]{color:#fff}']});class Jt{constructor(e,t){this.canvasItemApi=e,this.canvasOutletHelperService=t}trackByColFn(e,t){return t.listId}onDropListDropped(e){const t=Object.assign(Object.assign({},e.item.data),{initialPropertiesByName:{},columnIndex:e.container.data.columnIndex});this.canvasOutletHelperService.setBeforeViewComponentDropState(t),t.preventDrop||this.canvasItemApi.core.dropComponent(t,e.currentIndex,this.outlet.name)}}Jt.\u0275fac=function(e){return new(e||Jt)(n["\u0275\u0275directiveInject"](Gt),n["\u0275\u0275directiveInject"](Ht))},Jt.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Jt,selectors:[["rx-canvas-item-container"]],inputs:{outlet:"outlet",isReadOnly:"isReadOnly",layout:"layout"},decls:2,vars:2,consts:[[1,"row"],[3,"class","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngClass"],[3,"ngClass","isReadOnly","colIndex","column","layout","dropListDropped"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275template"](1,P,2,13,"div",1),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",t.outlet.columns)("ngForTrackBy",t.trackByColFn))},directives:[b.NgForOf,b.NgClass,Qt],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.col-border[_ngcontent-%COMP%]{border-right:1px dashed #d6d7d8}']});class Kt{constructor(e,t,i,o){this.canvasItemApi=e,this.parentOutletComponent=t,this.canvasOutletHelperService=i,this.componentFactoryResolver=o,this.containerComponentInstance=null,this.destroyed$=new f.ReplaySubject(1),this.name=p.RX_VIEW_DEFINITION.defaultOutletName,this.skipParentPredicate=!1,this.dropListOrientation="vertical",this.beforeViewComponentDrop=new n.EventEmitter,this.dropPredicate=()=>!0}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}ngOnInit(){this.containerComponentInstance=this.canvasItemApi.core.registerOutlet(this.name,this.container,this.componentFactoryResolver.resolveComponentFactory(this.containerComponent||Jt)).instance,this.canvasOutletHelperService.dropListOrientation=this.dropListOrientation,this.canvasOutletHelperService.parentOutletComponent=this.parentOutletComponent,this.canvasOutletHelperService.dropPredicate=this.dropPredicate,this.canvasOutletHelperService.skipParentPredicate=this.skipParentPredicate,this.canvasOutletHelperService.containerComponentInstance=this.containerComponentInstance,this.canvasOutletHelperService.beforeViewComponentDrop$.pipe((0,h.takeUntil)(this.destroyed$)).subscribe(e=>{this.beforeViewComponentDrop.emit(e)})}canBeDropped(e){return this.canvasOutletHelperService.canBeDropped(e)}componentDropPredicate(e,t=!1){return this.canvasOutletHelperService.componentDropPredicate(e,t)}}Kt.\u0275fac=function(e){return new(e||Kt)(n["\u0275\u0275directiveInject"](Gt),n["\u0275\u0275directiveInject"](Kt,12),n["\u0275\u0275directiveInject"](Ht),n["\u0275\u0275directiveInject"](n.ComponentFactoryResolver))},Kt.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Kt,selectors:[["rx-canvas-outlet"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](R,7,n.ViewContainerRef),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.container=e.first)}},inputs:{name:"name",skipParentPredicate:"skipParentPredicate",containerComponent:"containerComponent",dropListOrientation:"dropListOrientation",dropPredicate:"dropPredicate"},outputs:{beforeViewComponentDrop:"beforeViewComponentDrop"},features:[n["\u0275\u0275ProvidersFeature"]([Ht])],decls:2,vars:0,consts:[["container",""]],template:function(e,t){1&e&&n["\u0275\u0275elementContainer"](0,null,0)},encapsulation:2});class Yt{constructor(e,t){this.canvasItemComponent=e,this.viewDesignerCanvasComponent=t,this.defaultOutletName=p.RX_VIEW_DEFINITION.defaultOutletName}trackByFn(e,t){return t.name}}Yt.\u0275fac=function(e){return new(e||Yt)(n["\u0275\u0275directiveInject"](Xt),n["\u0275\u0275directiveInject"](Wt))},Yt.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Yt,selectors:[["rx-designer"]],decls:1,vars:2,consts:[[3,"border","default-outlet","name","beforeViewComponentDrop",4,"ngFor","ngForOf","ngForTrackBy"],[3,"name","beforeViewComponentDrop"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,T,1,5,"rx-canvas-outlet",0),2&e&&n["\u0275\u0275property"]("ngForOf",t.canvasItemComponent.layout.outlets)("ngForTrackBy",t.trackByFn)},directives:[b.NgForOf,Kt],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}rx-canvas-outlet[_ngcontent-%COMP%]{display:block}rx-canvas-outlet.default-outlet[_ngcontent-%COMP%]:not(:only-child)    >rx-canvas-item-container>.row>*>rx-canvas-item-column>.cdk-drop-list{min-height:300px}rx-canvas-outlet.default-outlet[_ngcontent-%COMP%]:only-child    >rx-canvas-item-container>.row>*>rx-canvas-item-column>.cdk-drop-list{min-height:calc(100vh - 155px)}rx-canvas-outlet.border[_ngcontent-%COMP%]{border:1px solid #d6d7d8}rx-canvas-outlet[_ngcontent-%COMP%] + rx-canvas-outlet[_ngcontent-%COMP%]{margin-top:10px}']});class Zt{constructor(e,t,i,n){this.viewDesignerFacade=e,this.rxViewComponentRegistryService=t,this.componentFactoryResolver=i,this.viewDesignerModels=n,this.designerComponentFactory=this.componentFactoryResolver.resolveComponentFactory(Yt),this.canvasDndListIds=[],this.extensionViewAllowedComponentTypes=new Set([p.RxViewComponentType.Container,p.RxViewComponentType.RichText,p.RxViewComponentType.RecordEditor,p.RxViewComponentType.Character,p.RxViewComponentType.Textarea,p.RxViewComponentType.Boolean,p.RxViewComponentType.Date,p.RxViewComponentType.DateTime,p.RxViewComponentType.Time,p.RxViewComponentType.Decimal,p.RxViewComponentType.Floating,p.RxViewComponentType.Integer,p.RxViewComponentType.LocalizedCharacter,p.RxViewComponentType.Selection,p.RxViewComponentType.SelectGroup,p.RxViewComponentType.RichTextarea,p.BwfViewComponentType.DynamicNamedList]),this.canvasLayout$=this.getRecursiveViewLayoutGuids().pipe((0,h.switchMap)(e=>e.length?this.viewDesignerFacade.areViewModelsReady$.pipe((0,h.filter)(Boolean),(0,h.switchMapTo)(this.viewDesignerFacade.viewDesignerModelState$.pipe((0,h.take)(1)))):this.viewDesignerFacade.viewDesignerModelState$.pipe((0,h.take)(1))),(0,h.map)(e=>{const t=e.viewDesignModel,i=e.viewComponentDesignModels;return this.canvasDndListIds.length=0,{guid:t.guid,factory:this.designerComponentFactory,outlets:t.layout.outlets.map(e=>({name:e.name,columns:e.columns.map((n,o)=>{const r=String(`${t.guid}-${e.name}-${o}`);return t.type!==p.ViewDefinitionType.Shell&&this.canvasDndListIds.push(r),Object.assign(Object.assign({},n),{children:n.children.map(e=>this.initializeCanvasItem(e,i,this.canvasDndListIds)),listId:r,dndListIds:this.canvasDndListIds})})})),model:null,descriptor:null,isSelected$:(0,f.of)(!1)}}),(0,h.tap)(()=>{this.canvasDndListIds.reverse()})),this.viewBreadcrumbItem$=this.viewDesignerFacade.getViewPropertyValue("displayName").pipe((0,h.concatMap)(e=>(0,f.of)(e?e===l.RX_APPLICATION.shellDefinitionName?"Application shell":e:"<New view>")),(0,h.withLatestFrom)(this.viewDesignerFacade.viewModelGuid$),(0,h.map)(([e,t])=>({label:e,data:{guid:t}}))),this.selectedComponentBreadcrumbItems$=this.viewDesignerFacade.selectedComponentGuid$.pipe((0,h.switchMap)(e=>e?(0,f.combineLatest)([this.viewDesignerFacade.breadcrumbs$,this.viewDesignerFacade.getParentComponentGuid(e)]).pipe((0,h.withLatestFrom)(this.viewDesignerFacade.viewComponentModels$),(0,h.map)(([[t],i])=>(0,u.isEmpty)(i)?[]:ue(e,i).map(e=>{let n=t[e];if(!n){const t=i[e];n=this.rxViewComponentRegistryService.get(t.type).name}return{label:n,data:{guid:e}}}))):(0,f.of)([]))),this.breadcrumbItems$=(0,f.combineLatest)([this.viewBreadcrumbItem$,this.selectedComponentBreadcrumbItems$]).pipe((0,h.map)(([e,t])=>[e,...t])),this.validationIssues$=this.viewDesignerFacade.validationIssues$.pipe((0,h.withLatestFrom)(this.viewDesignerFacade.viewDesignerModelState$),(0,h.map)(([e,t])=>(0,u.flow)(e=>(0,u.mergeWith)(Object.assign({},e.issues),e.expressionIssues,(e=[],t=[])=>e.concat(t)),e=>(0,u.reduce)(e,(e,i,n)=>{var o;let r;if((null===(o=t.viewDesignModel)||void 0===o?void 0:o.guid)===n)r=t.viewDesignModel.displayName||"View designer";else if(t.viewComponentDesignModels[n]){const e=t.viewComponentDesignModels[n].type,i=this.rxViewComponentRegistryService.get(e);r=i&&i.name}return r&&e.push({title:r,issues:i.map(e=>({type:e.type,description:e.description,disableCorrection:e.disableCorrection,data:{guid:n,propertyName:e.propertyName,data:e.data}}))}),e},[]))(e)))}getLicensedComponents(){return this.rxViewComponentRegistryService.getLicensedComponents().pipe((0,h.first)(),(0,h.map)(e=>e.filter(e=>!this.rxViewComponentRegistryService.isDataComponentDescriptor(e)&&!e.hidden&&!e.isPageComponent)))}getRecursiveViewLayoutGuids(){return this.viewDesignerFacade.getViewPropertyValue("layout").pipe((0,h.switchMap)(e=>this.getRecursiveComponentLayoutGuids(e)))}getRecursiveComponentLayoutGuids(e){const t=p.RxViewLayout.getViewLayoutChildGuids(e);return t.length?(0,f.combineLatest)(t.map(e=>this.viewDesignerFacade.getComponentLayout(e).pipe((0,h.switchMap)(e=>e?this.getRecursiveComponentLayoutGuids(e).pipe((0,h.map)(e=>[...e,...t])):(0,f.of)(t))))):(0,f.of)([])}initializeCanvasItem(e,t,i){const n=t[e],o=this.rxViewComponentRegistryService.get(n.type),r={guid:n.guid,descriptor:o,factory:o.designComponentFactory,model:this.viewDesignerModels.get(n.guid),outlets:[],isSelected$:this.viewDesignerFacade.selectedComponentGuid$.pipe((0,h.map)(e=>e===n.guid)),label:o.name};return n.layout&&(r.viewComponentWithParents=ue(n.guid,t).map(e=>({guid:e,type:t[e].type})),n.layout.outlets.forEach(e=>{const o={name:e.name,columns:e.columns.map((o,r)=>{const a=`${n.guid}-${e.name}-${r}`;return i.push(a),{children:o.children.map(e=>this.initializeCanvasItem(e,t,i)),span:o.span,listId:a,dndListIds:i}})};r.outlets.push(o)})),r}}Zt.\u0275fac=function(e){return new(e||Zt)(n["\u0275\u0275inject"](Ft),n["\u0275\u0275inject"](p.RxViewComponentRegistryService),n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](Et))},Zt.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Zt,factory:Zt.\u0275fac,providedIn:"root"});const ei={stencilGroups:{basicComponents:{label:"Basic components"},chatbotComponents:{label:"Chatbot components"},recordEditorInputs:{label:"Record editor inputs"}},inspectorTabs:{viewProperties:{tabId:0},componentProperties:{tabId:1},validationIssues:{tabId:2}}};class ti{constructor(e){this.stringService=e,this.allowedDropListIds=[],this.filterFormControl=new x.FormControl,this.componentsSubject$=new f.ReplaySubject(1)}set components(e){this.componentsSubject$.next(e)}ngOnInit(){this.viewComponentGroups$=(0,f.combineLatest)([this.filterFormControl.valueChanges.pipe((0,h.debounceTime)(200),(0,h.startWith)(null)),this.componentsSubject$]).pipe((0,h.map)(([e,t])=>(0,u.flow)(e=>(0,u.groupBy)(e,e=>e.group),e=>(0,u.map)(e,(e,t)=>({name:t,components:(0,u.sortBy)(e,e=>isFinite(e.index)?e.index:e.name)})),e=>(0,u.sortBy)(e,e=>e.name===ei.stencilGroups.basicComponents.label?"1":e.name===ei.stencilGroups.recordEditorInputs.label?"2":"3"+(0,u.lowerCase)(e.name)),t=>e?t.map(t=>Object.assign(Object.assign({},t),{components:t.components.filter(t=>this.stringService.caseInsensitiveSearch(t.name,e))})).filter(e=>e.components.length):t)(t)))}getViewComponentDragData(e){return{draggedViewComponentDescriptor:e}}trackByNameFn(e,t){return t.name}ngOnDestroy(){this.componentsSubject$.complete()}}ti.\u0275fac=function(e){return new(e||ti)(n["\u0275\u0275directiveInject"](g.RxStringService))},ti.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ti,selectors:[["rx-view-designer-palette"]],inputs:{components:"components",allowedDropListIds:"allowedDropListIds"},decls:5,vars:9,consts:[[1,"search-field-container"],["rx-id","stencil-search-field","placeholder","Search",3,"formControl"],[3,"config"],[3,"title","isOpen",4,"ngFor","ngForOf","ngForTrackBy"],[3,"title","isOpen"],["cdkDropList","","cdkDropListSortingDisabled","",1,"group-items-container",3,"cdkDropListConnectedTo"],["class","group-item","cdkDrag","",3,"cdkDragData",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"group-item",3,"cdkDragData"],[1,"group-item-inner"],[1,"item-name",3,"title"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275element"](1,"adapt-rx-search",1),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](2,"adapt-accordion",2),n["\u0275\u0275template"](3,N,3,6,"adapt-accordion-tab",3),n["\u0275\u0275pipe"](4,"async"),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("formControl",t.filterFormControl),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("config",n["\u0275\u0275pureFunction1"](7,j,n["\u0275\u0275pureFunction0"](6,k))),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",n["\u0275\u0275pipeBind1"](4,4,t.viewComponentGroups$))("ngForTrackBy",t.trackByNameFn))},directives:[S.AdaptRxSearchComponent,x.NgControlStatus,x.FormControlDirective,S.AdaptAccordionComponent,b.NgForOf,S.AdaptAccordionTabComponent,C.CdkDropList,C.CdkDrag],pipes:[b.AsyncPipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{display:block}.group-items-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.group-items-container[_ngcontent-%COMP%]   .group-item.cdk-drag-placeholder[_ngcontent-%COMP%]{width:33.3%}.group-item[_ngcontent-%COMP%]{border-right:1px solid #d6d7d8;border-bottom:1px solid #d6d7d8;text-align:center;width:33.3%;cursor:move;height:90px;padding:3px 0}.group-item.cdk-drag-preview[_ngcontent-%COMP%]{background:white;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.group-item.cdk-drag-placeholder[_ngcontent-%COMP%]{border:0;width:100px;height:40px;padding:0;position:relative;z-index:3}.group-item.cdk-drag-placeholder[_ngcontent-%COMP%]   .group-item-inner[_ngcontent-%COMP%]{border:1px solid #d6d7d8;background:#fff}.group-item[_ngcontent-%COMP%]:nth-child(3n){border-right:none}.group-item-inner[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column}.item-image[_ngcontent-%COMP%]{color:#626668;font-size:40px;height:54px;flex-grow:1}.item-name[_ngcontent-%COMP%]{font-size:10px;overflow:hidden;height:34px}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:1!important}adapt-accordion-tab[_ngcontent-%COMP%]     .card-block{padding:0}.form-group[_ngcontent-%COMP%]{margin:10px 20px}.search-field-container[_ngcontent-%COMP%]{padding:.9375rem}'],changeDetection:0});const ii=new n.InjectionToken("RX_VIEW_MODEL");class ni{constructor(e,t,i,o,r,a,s,l,d,c,m,u,g,v,y,x,b,C,S,w,D,R,I){this.viewDesignerFacade=e,this.rxNotificationService=t,this.rxDefinitionPickerCacheService=i,this.rxNamedListDefinitionCacheService=o,this.rxModalService=r,this.translateService=a,this.rxUtilityModalsService=s,this.rxViewDesignerHelperService=l,this.rxExpressionEditorService=d,this.rxViewDefinitionService=c,this.rxComponentCanDeactivateGuard=m,this.rxViewDefinitionGeneratorService=u,this.rxViewDesignerModels=g,this.rxLogService=v,this.injector=y,this.renderer=x,this.rxRecordDefinitionCacheService=b,this.rxAssociationDefinitionCacheService=C,this.rxProcessDefinitionCacheService=S,this.rxViewDefinitionCacheService=w,this.rxGainsightConfiguratorService=D,this.rxDefinitionNameService=R,this.rxFeatureService=I,this.viewDefinitionSaved=new n.EventEmitter,this.viewDefinitionErrorLoading=new n.EventEmitter,this.closeDesigner=new n.EventEmitter,this.destroyed$=new f.ReplaySubject(1),this.inspectorFocusEditorSubject=new f.Subject,this.isViewDefinitionChanged$=new f.BehaviorSubject(!1),this.validationIssues$=this.rxViewDesignerHelperService.validationIssues$.pipe((0,h.shareReplay)(1),(0,h.takeUntil)(this.destroyed$)),this.breadcrumbItems$=this.rxViewDesignerHelperService.breadcrumbItems$,this.canvasLayout$=this.rxViewDesignerHelperService.canvasLayout$,this.canvasDndListIds=this.rxViewDesignerHelperService.canvasDndListIds,this.extensionViewRootComponentType=p.RxViewComponentType.RecordEditor,this.isDesignMode=!0,this.isStencilExpanded=!0,this.isInspectorExpanded=!0,this.inspectorFocusEditor$=this.inspectorFocusEditorSubject.asObservable(),this.viewComponentInspectorEmptyText$=this.viewDesignerFacade.selectedComponentInspectorLayout$.pipe((0,h.switchMap)(e=>e?(0,f.of)(null):this.viewDesignerFacade.selectedComponentGuid$.pipe((0,h.withLatestFrom)(this.viewDesignerFacade.viewModel$),(0,h.map)(([e,t])=>e&&e!==t.guid?"Selected component has no properties.":"Select a component to view its properties here."))),(0,h.shareReplay)({refCount:!0,bufferSize:1})),this.selectedComponentModel$=this.viewDesignerFacade.selectedComponentGuid$.pipe((0,h.map)(e=>this.rxViewDesignerModels.get(e))),this.isReadOnly$=this.viewDesignerFacade.isViewReadOnly$,this.paletteComponents$=(0,f.combineLatest)([this.viewDesignerFacade.isExtensionView$.pipe((0,h.tap)(e=>this.isExtensionView=e)),this.viewDesignerFacade.isExtensionContainerSet$.pipe((0,h.tap)(e=>this.isExtensionContainerSet=e)),this.rxViewDesignerHelperService.getLicensedComponents().pipe((0,h.map)(e=>this.configuration.paletteComponentsPredicate?e.filter(e=>this.configuration.paletteComponentsPredicate(e)):e))]).pipe((0,h.switchMap)(([e,t,i])=>e?this.viewDesignerFacade.firstViewComponentModelType$.pipe((0,h.map)(e=>e===this.extensionViewRootComponentType?i.filter(({type:e})=>e!==this.extensionViewRootComponentType&&this.rxViewDesignerHelperService.extensionViewAllowedComponentTypes.has(e)):i.filter(({type:e})=>e===this.extensionViewRootComponentType))):(0,f.of)(i)));const F=this.injector.get(ii,null,n.InjectFlags.Optional);this.rxViewModel=F||this.injector.get(Lt),this.rxDefinitionPickerCacheService.registerConsumer(),this.rxNamedListDefinitionCacheService.registerConsumer(this.destroyed$),this.rxAssociationDefinitionCacheService.registerConsumer(this.destroyed$),this.rxProcessDefinitionCacheService.registerConsumer(this.destroyed$),this.rxRecordDefinitionCacheService.registerConsumer(this.destroyed$),this.rxViewDefinitionCacheService.registerConsumer(this.destroyed$)}ngOnInit(){this.isPreviewAvailable$=this.viewDesignerFacade.getViewPropertyValue("lastUpdateTime").pipe((0,h.map)(e=>!this.configuration.disablePreview&&(Boolean(e)||!(0,u.isUndefined)(this.configuration.viewDefinitionName))),(0,h.takeUntil)(this.destroyed$)),this.viewDefinitionName$=this.viewDesignerFacade.getViewPropertyValue("name"),this.viewDesignerFacade.getViewPropertyValue("pageComponent").pipe((0,h.takeUntil)(this.destroyed$)).subscribe(e=>{this.isPageView=Boolean(e)}),this.viewDesignerFacade.viewDefinitionSaveSuccess$.pipe((0,h.takeUntil)(this.destroyed$)).subscribe(({viewDefinitionName:e})=>{this.rxNotificationService.addSuccessMessage("View definition saved successfully."),this.viewDefinitionSaved.emit(e),this.initViewDesigner()}),this.viewDesignerFacade.viewDefinitionLoadError$.pipe((0,h.takeUntil)(this.destroyed$)).subscribe(()=>this.viewDefinitionErrorLoading.emit()),this.hasValidationErrors$=this.validationIssues$.pipe((0,h.map)(e=>Boolean((0,u.filter)(e,{issues:[{type:c.ValidationIssueType.Error}]}).length)),(0,h.distinctUntilChanged)()),this.hasValidationWarning$=this.validationIssues$.pipe((0,h.map)(e=>Boolean((0,u.filter)(e,{issues:[{type:c.ValidationIssueType.Warning}]}).length)),(0,h.distinctUntilChanged)()),this.isSaveButtonDisabled$=(0,f.combineLatest)([this.hasValidationErrors$,this.viewDesignerFacade.areViewModelsReady$,this.isViewDefinitionChanged$,this.isReadOnly$]).pipe((0,h.map)(([e,t,i,n])=>e||!t||!i||n),(0,h.startWith)(!0)),this.isReadOnly$.pipe((0,h.takeUntil)(this.destroyed$)).subscribe(e=>{e&&this.rxNotificationService.addWarningMessage(this.translateService.instant("com.bmc.arsys.rx.client.designer.read-only-definition-warning.message"))}),this.rxFeatureService.isFeatureEnabled("DRD21-11744")&&this.viewDefinitionName$.pipe((0,h.take)(1)).subscribe(e=>{this.rxGainsightConfiguratorService.updateGlobalContext({subProductLevel1:{name:"Design"},subProductLevel2:{name:this.rxDefinitionNameService.getDisplayName(e)==l.RX_APPLICATION.shellDefinitionName?"Shell designer":"View designer"}})})}ngOnChanges(e){e.configuration.currentValue&&this.initViewDesigner(!0)}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete(),this.inspectorFocusEditorSubject.complete(),this.isViewDefinitionChanged$.complete(),this.rxDefinitionPickerCacheService.unRegisterConsumer(),this.viewDesignerFacade.destroyViewDesigner(),this.rxGainsightConfiguratorService.removeGlobalContext(["subProductLevel2","subProductLevel3"])}initViewDesigner(e=!1){var t;this.isViewDefinitionChanged$.getValue()&&this.isViewDefinitionChanged$.next(!1),null===(t=this.viewDefinitionChangeSubscription)||void 0===t||t.unsubscribe(),e&&this.viewDesignerFacade.initViewDesigner((0,u.pick)(this.configuration,["bundleId","viewDefinitionName","layoutTemplate"])),this.initViewDefinitionChangeSubscription()}initViewDefinitionChangeSubscription(){this.viewDefinitionChangeSubscription=this.viewDesignerFacade.areViewModelsReady$.pipe((0,h.filter)(Boolean),(0,h.take)(1),(0,h.switchMap)(()=>(0,f.combineLatest)([this.viewDesignerFacade.viewModel$,this.viewDesignerFacade.viewComponentModels$]).pipe((0,h.map)(([e,t])=>this.rxViewDefinitionGeneratorService.generate(e,t)),(0,h.distinctUntilChanged)(u.isEqual),(0,h.skip)(1),(0,h.take)(1),(0,h.takeUntil)(this.destroyed$))),(0,h.takeUntil)(this.destroyed$)).subscribe(()=>{this.isViewDefinitionChanged$.next(!0)})}onSelectComponent(e){this.viewDesignerFacade.selectComponent(e)}onDropComponent(e){this.viewDesignerFacade.insertComponent(e)}onRemoveComponent(e){this.rxUtilityModalsService.confirm("Are you sure you want to delete this view component?").then(t=>{t&&(this.viewDesignerFacade.removeViewComponents([e],!0),this.isPageView&&this.viewDesignerFacade.updateViewProperties({pageComponent:null}))})}onInspectorTabChange(e){this.viewDesignerFacade.selectInspectorTab({tabId:e.index})}toggleDesignMode(){this.isDesignMode&&this.viewDesignerFacade.generateViewDefinition(),this.isDesignMode=!this.isDesignMode}onComponentPropertiesChange(e){this.viewDesignerFacade.updateSelectedComponentProperties(e)}onEditorEvent(e,t){e.type===d.RX_VALIDATION_FORM_CONTROL.events.correctValidationIssue&&this.correctValidationIssue(e.payload.componentGuid,e.payload.propertyName),e.type===d.RX_REVERT_CUSTOMIZATION.events.revertCustomization&&this.revertCustomization(),e.type===d.RX_EXPRESSION_EDITOR.events.openExpressionEditor&&this.openExpressionEditor(e.payload,t)}getExpressionProperties(e){return(this.viewComponentPropertyInspectorElementRef===e?this.viewDesignerFacade.selectedComponentProperties$:this.viewDesignerFacade.viewModel$).pipe((0,h.map)(t=>Array.from(this.renderer.selectRootElement(e.nativeElement,!0).querySelectorAll("rx-expression-form-control")).map(e=>{const i=e.getAttribute("property-path");return{path:i,value:(0,u.get)(t,i),label:e.getAttribute("property-label")}})))}openExpressionEditor(e,t){const i=this.viewComponentPropertyInspectorElementRef===t,n=i?this.viewDesignerFacade.selectedComponentProperties$:this.viewDesignerFacade.viewModel$;(0,f.combineLatest)([this.viewDesignerFacade.selectedComponentGuid$,n]).pipe((0,h.take)(1),(0,h.switchMap)(([o,r])=>{const a=i?this.rxViewDesignerModels.get(o):this.rxViewModel,s=null==a?void 0:a.expressionConfigurator;return s?this.rxExpressionEditorService.openEditor({property:{path:e.propertyPath,value:(0,u.get)(r,e.propertyPath),label:e.propertyLabel},isReadOnly:e.isReadOnly,expressionConfigurator:s,legend:[{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.function.label"),icon:"d-icon-mathematical_function"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.keyword.label"),icon:"d-icon-dollar"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-component.label"),icon:"d-icon-file_o"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-component-property.label"),icon:"d-icon-file_o_gear"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-input-parameter.label"),icon:"d-icon-arrow_right_square_input"}],expressionPropertyNavigator:{getProperties:this.getExpressionProperties.bind(this,t)}}).pipe((0,h.withLatestFrom)(n),(0,h.map)(([{path:e,value:t},i])=>{if(i.hasOwnProperty(e))return{[e]:t};{const n=(0,u.toPath)(e)[0];return(0,u.set)({[n]:(0,u.cloneDeep)(i[n])},e,t)}})):(this.rxLogService.debug("View designer: Expression editor cannot be opened without expression configurator."),f.EMPTY)}),(0,h.takeUntil)(this.destroyed$)).subscribe(e=>i?this.viewDesignerFacade.updateSelectedComponentProperties(e):this.viewDesignerFacade.updateViewProperties(e))}saveViewDefinition(){this.viewDesignerFacade.viewModel$.pipe((0,h.take)(1),(0,h.switchMap)(e=>{const t=e.type===p.ViewDefinitionType.Shell?"If you save your changes now, you will not be able to run this application using the old UI. Do you want to continue?":"If you save this view definition, you will not be able to open it in the old view designer. Do you want to continue?";return e.isAngularJsView?this.rxModalService.confirm({title:"Warning",modalStyle:c.RX_MODAL.modalStyles.warning,message:t}):(0,f.of)(!0)}),(0,h.filter)(Boolean),(0,h.takeUntil)(this.destroyed$)).subscribe(()=>{this.viewDesignerFacade.saveViewDefinition()})}onCorrectIssue(e){this.correctValidationIssue(e.data.guid,e.data.propertyName,e.data.data)}correctValidationIssue(e,t,i){this.viewDesignerFacade.selectComponent(e),setTimeout(()=>this.inspectorFocusEditorSubject.next({editorName:t,data:i}),10)}revertCustomization(){this.viewDefinitionName$.pipe((0,h.switchMap)(e=>this.rxViewDefinitionService.revertCustomization(e)),(0,h.takeUntil)(this.destroyed$)).subscribe(()=>{this.rxComponentCanDeactivateGuard.disable(),window.location.reload()})}onViewPropertiesChange(e){this.viewDesignerFacade.updateViewProperties(e)}showPreview(){this.viewDesignerFacade.runPreview()}canDeactivate(){let e=!0;return(0,f.combineLatest)([this.isViewDefinitionChanged$,this.isReadOnly$]).pipe((0,h.map)(([e,t])=>!e||t),(0,h.take)(1)).subscribe(t=>{e=t}),e}onBeforeComponentDropInRoot(e){this.isExtensionView&&(this.isExtensionContainerSet?e.draggedViewComponentDescriptor.type!==p.RxViewComponentType.RecordEditor&&(this.rxNotificationService.addWarningMessage("This view component can only be added inside a Record editor."),e.preventDrop=!0):(this.rxNotificationService.addWarningMessage("Select Extension container before adding view components."),e.preventDrop=!0))}}ni.\u0275fac=function(e){return new(e||ni)(n["\u0275\u0275directiveInject"](Ft),n["\u0275\u0275directiveInject"](l.RxNotificationService),n["\u0275\u0275directiveInject"](d.RxDefinitionPickerCacheService),n["\u0275\u0275directiveInject"](r.RxNamedListDefinitionCacheService),n["\u0275\u0275directiveInject"](c.RxModalService),n["\u0275\u0275directiveInject"](m.TranslateService),n["\u0275\u0275directiveInject"](c.RxUtilityModalsService),n["\u0275\u0275directiveInject"](Zt),n["\u0275\u0275directiveInject"](d.RxExpressionEditorService),n["\u0275\u0275directiveInject"](p.RxViewDefinitionService),n["\u0275\u0275directiveInject"](l.RxComponentCanDeactivateGuard),n["\u0275\u0275directiveInject"](Mt),n["\u0275\u0275directiveInject"](Et),n["\u0275\u0275directiveInject"](l.RxLogService),n["\u0275\u0275directiveInject"](n.Injector),n["\u0275\u0275directiveInject"](n.Renderer2),n["\u0275\u0275directiveInject"](s.RxRecordDefinitionCacheService),n["\u0275\u0275directiveInject"](o.RxAssociationDefinitionCacheService),n["\u0275\u0275directiveInject"](a.RxProcessDefinitionCacheService),n["\u0275\u0275directiveInject"](p.RxViewDefinitionCacheService),n["\u0275\u0275directiveInject"](d.RxGainsightConfiguratorService),n["\u0275\u0275directiveInject"](l.RxDefinitionNameService),n["\u0275\u0275directiveInject"](l.RxFeatureService))},ni.\u0275cmp=n["\u0275\u0275defineComponent"]({type:ni,selectors:[["rx-view-designer"]],viewQuery:function(e,t){if(1&e&&(n["\u0275\u0275viewQuery"](_,5,n.ElementRef),n["\u0275\u0275viewQuery"](B,5,n.ElementRef)),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.viewPropertyInspectorElementRef=e.first),n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.viewComponentPropertyInspectorElementRef=e.first)}},inputs:{configuration:"configuration"},outputs:{viewDefinitionSaved:"viewDefinitionSaved",viewDefinitionErrorLoading:"viewDefinitionErrorLoading",closeDesigner:"closeDesigner"},features:[n["\u0275\u0275ProvidersFeature"]([Lt]),n["\u0275\u0275NgOnChangesFeature"]],decls:45,vars:87,consts:[[3,"bundleName","breadcrumbItems","isDesignMode","isPreviewAvailable","isSaveButtonDisabled","breadcrumbSelected","toggleDesignMode","showPreview","save","closeDesigner"],[1,"rx-component-view-designer",3,"hidden"],["rx-id","palette",3,"title","isExpanded","toggle"],[3,"components","allowedDropListIds",4,"ngIf"],["class","p-3",3,"config",4,"ngIf"],[1,"rx-view-designer-container"],[1,"flex-grow-1",3,"layout","isReadOnly","componentSelect","componentRemove","componentDrop","beforeComponentDropInRoot"],["dockTo","right","rx-id","properties",3,"title","isExpanded","toggle"],["customCssTabContent","p-0","justify","justified",3,"tab-active","tab-active-changed"],["icon","d-icon-pencil"],[3,"focusEditor$","config","model","isReadOnly","modelChange","editorEvent"],["viewPropertyInspector",""],["icon","d-icon-gear"],["rxInspector","",3,"designerItemModel","focusEditor$","config","model","guid","isReadOnly","modelChange","editorEvent"],["viewComponentPropertyInspector",""],[1,"p-3",3,"hidden","config"],["icon","d-icon-exclamation_triangle"],[3,"definitionTypeDisplayName","issueSections","correctIssue"],["class","full-size",3,"code","lang","hasToolbar","theme",4,"ngIf"],[3,"components","allowedDropListIds"],[1,"p-3",3,"config"],[1,"full-size",3,"code","lang","hasToolbar","theme"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"rx-designer-header",0),n["\u0275\u0275listener"]("breadcrumbSelected",function(e){return t.onSelectComponent(e.data.guid)})("toggleDesignMode",function(){return t.toggleDesignMode()})("showPreview",function(){return t.showPreview()})("save",function(){return t.saveViewDefinition()})("closeDesigner",function(){return t.closeDesigner.emit()}),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275pipe"](2,"async"),n["\u0275\u0275pipe"](3,"async"),n["\u0275\u0275pipe"](4,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"div",1),n["\u0275\u0275elementStart"](6,"rx-blade",2),n["\u0275\u0275listener"]("toggle",function(){return t.isStencilExpanded=!t.isStencilExpanded}),n["\u0275\u0275template"](7,$,2,4,"rx-view-designer-palette",3),n["\u0275\u0275pipe"](8,"async"),n["\u0275\u0275template"](9,G,1,2,"adapt-alert",4),n["\u0275\u0275pipe"](10,"async"),n["\u0275\u0275template"](11,U,1,2,"adapt-alert",4),n["\u0275\u0275pipe"](12,"async"),n["\u0275\u0275pipe"](13,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](14,"section",5),n["\u0275\u0275elementStart"](15,"rx-view-designer-canvas",6),n["\u0275\u0275listener"]("componentSelect",function(e){return t.onSelectComponent(e)})("componentRemove",function(e){return t.onRemoveComponent(e)})("componentDrop",function(e){return t.onDropComponent(e)})("beforeComponentDropInRoot",function(e){return t.onBeforeComponentDropInRoot(e)}),n["\u0275\u0275pipe"](16,"async"),n["\u0275\u0275pipe"](17,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](18,"rx-blade",7),n["\u0275\u0275listener"]("toggle",function(){return t.isInspectorExpanded=!t.isInspectorExpanded}),n["\u0275\u0275elementStart"](19,"adapt-tabset",8),n["\u0275\u0275listener"]("tab-active-changed",function(e){return t.onInspectorTabChange(e)}),n["\u0275\u0275pipe"](20,"async"),n["\u0275\u0275pipe"](21,"async"),n["\u0275\u0275pipe"](22,"async"),n["\u0275\u0275elementStart"](23,"adapt-tab-panel",9),n["\u0275\u0275elementStart"](24,"rx-form-builder",10,11),n["\u0275\u0275listener"]("modelChange",function(e){return t.onViewPropertiesChange(e)})("editorEvent",function(e){return t.onEditorEvent(e,t.viewPropertyInspectorElementRef)}),n["\u0275\u0275pipe"](26,"async"),n["\u0275\u0275pipe"](27,"async"),n["\u0275\u0275pipe"](28,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](29,"adapt-tab-panel",12),n["\u0275\u0275elementStart"](30,"rx-form-builder",13,14),n["\u0275\u0275listener"]("modelChange",function(e){return t.onComponentPropertiesChange(e)})("editorEvent",function(e){return t.onEditorEvent(e,t.viewComponentPropertyInspectorElementRef)}),n["\u0275\u0275pipe"](32,"async"),n["\u0275\u0275pipe"](33,"async"),n["\u0275\u0275pipe"](34,"async"),n["\u0275\u0275pipe"](35,"async"),n["\u0275\u0275pipe"](36,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](37,"adapt-alert",15),n["\u0275\u0275pipe"](38,"async"),n["\u0275\u0275pipe"](39,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](40,"adapt-tab-panel",16),n["\u0275\u0275elementStart"](41,"rx-validation-issues",17),n["\u0275\u0275listener"]("correctIssue",function(e){return t.onCorrectIssue(e)}),n["\u0275\u0275pipe"](42,"translate"),n["\u0275\u0275pipe"](43,"async"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](44,z,3,8,"adapt-code-viewer",18)),2&e&&(n["\u0275\u0275property"]("bundleName",n["\u0275\u0275pipeBind1"](1,35,t.viewDesignerFacade.bundleFriendlyName$))("breadcrumbItems",n["\u0275\u0275pipeBind1"](2,37,t.breadcrumbItems$))("isDesignMode",t.isDesignMode)("isPreviewAvailable",n["\u0275\u0275pipeBind1"](3,39,t.isPreviewAvailable$))("isSaveButtonDisabled",n["\u0275\u0275pipeBind1"](4,41,t.isSaveButtonDisabled$)),n["\u0275\u0275advance"](5),n["\u0275\u0275property"]("hidden",!t.isDesignMode),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("title","Palette")("isExpanded",t.isStencilExpanded),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.isPageView&&!n["\u0275\u0275pipeBind1"](8,43,t.isReadOnly$)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.isPageView&&!n["\u0275\u0275pipeBind1"](10,45,t.isReadOnly$)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",n["\u0275\u0275pipeBind1"](12,47,!n["\u0275\u0275pipeBind1"](13,49,t.viewDesignerFacade.isViewDefinitionLoading$)&&t.isReadOnly$)),n["\u0275\u0275advance"](4),n["\u0275\u0275property"]("layout",n["\u0275\u0275pipeBind1"](16,51,t.canvasLayout$))("isReadOnly",n["\u0275\u0275pipeBind1"](17,53,t.isReadOnly$)),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("title","Properties")("isExpanded",t.isInspectorExpanded),n["\u0275\u0275advance"](1),n["\u0275\u0275classProp"]("has-validation-warning",n["\u0275\u0275pipeBind1"](20,55,t.hasValidationWarning$))("has-validation-errors",n["\u0275\u0275pipeBind1"](21,57,t.hasValidationErrors$)),n["\u0275\u0275property"]("tab-active",n["\u0275\u0275pipeBind1"](22,59,t.viewDesignerFacade.selectedInspectorTabId$)),n["\u0275\u0275advance"](5),n["\u0275\u0275property"]("focusEditor$",t.inspectorFocusEditor$)("config",n["\u0275\u0275pipeBind1"](26,61,t.viewDesignerFacade.viewInspectorLayout$))("model",n["\u0275\u0275pipeBind1"](27,63,t.viewDesignerFacade.viewModel$))("isReadOnly",n["\u0275\u0275pipeBind1"](28,65,t.isReadOnly$)),n["\u0275\u0275advance"](6),n["\u0275\u0275property"]("designerItemModel",n["\u0275\u0275pipeBind1"](32,67,t.selectedComponentModel$))("focusEditor$",t.inspectorFocusEditor$)("config",n["\u0275\u0275pipeBind1"](33,69,t.viewDesignerFacade.selectedComponentInspectorLayout$))("model",n["\u0275\u0275pipeBind1"](34,71,t.viewDesignerFacade.selectedComponentProperties$))("guid",n["\u0275\u0275pipeBind1"](35,73,t.viewDesignerFacade.selectedComponentGuid$))("isReadOnly",n["\u0275\u0275pipeBind1"](36,75,t.isReadOnly$)),n["\u0275\u0275advance"](7),n["\u0275\u0275property"]("hidden",!n["\u0275\u0275pipeBind1"](38,77,t.viewComponentInspectorEmptyText$))("config",n["\u0275\u0275pureFunction1"](85,X,n["\u0275\u0275pipeBind1"](39,79,t.viewComponentInspectorEmptyText$))),n["\u0275\u0275advance"](4),n["\u0275\u0275property"]("definitionTypeDisplayName",n["\u0275\u0275pipeBind1"](42,81,"com.bmc.arsys.rx.client.view-definition.label"))("issueSections",n["\u0275\u0275pipeBind1"](43,83,t.validationIssues$)),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngIf",!t.isDesignMode))},directives:[d.RxDesignerHeaderComponent,c.RxBladeComponent,b.NgIf,Wt,S.AdaptTabsComponent,S.AdaptTabsPanelComponent,d.FormBuilderComponent,d.InspectorDirective,S.AdaptAlertComponent,c.RxValidationIssuesComponent,ti,S.AdaptCodeViewerComponent],pipes:[b.AsyncPipe,m.TranslatePipe,b.JsonPipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}.rx-component-view-designer[_ngcontent-%COMP%]{display:flex;flex-grow:1;height:calc(100% - 50px);overflow:hidden}.rx-view-designer-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-grow:1;overflow:auto;padding:2.2rem 1rem 1rem}[_nghost-%COMP%]     .has-validation-warning:not(.has-validation-errors) .nav-link .d-icon-exclamation_triangle{color:#f1b521}[_nghost-%COMP%]     .has-validation-errors .nav-link .d-icon-exclamation_triangle{color:#f83200}[_nghost-%COMP%]     adapt-tabset .nav-tabs .nav-link-icon{margin-right:0}']});class oi{}oi.\u0275fac=function(e){return new(e||oi)},oi.\u0275mod=n["\u0275\u0275defineNgModule"]({type:oi,declarations:[Wt,Xt,Jt,Kt,Qt],imports:[b.CommonModule,C.DragDropModule],exports:[Wt,Kt,Xt,Qt]}),oi.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[b.CommonModule,C.DragDropModule]]});class ri{}ri.\u0275fac=function(e){return new(e||ri)},ri.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ri,declarations:[Yt],imports:[oi,b.CommonModule]}),ri.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[oi,b.CommonModule]]});class ai{}ai.\u0275fac=function(e){return new(e||ai)},ai.\u0275mod=n["\u0275\u0275defineNgModule"]({type:ai,declarations:[ti],imports:[b.CommonModule,C.DragDropModule,x.ReactiveFormsModule,S.AdaptAccordionModule,w.AdaptTextFieldModule,S.AdaptRxSearchModule],exports:[ti]}),ai.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[b.CommonModule,C.DragDropModule,x.ReactiveFormsModule,S.AdaptAccordionModule,w.AdaptTextFieldModule,S.AdaptRxSearchModule]]});class si extends c.RxModalClass{constructor(e,t){super(e,t),this.activeModalRef=e,this.injector=t,this.inputParams={},this.inputParamNames=this.activeModalRef.getData().inputParams}isDirty(){return(0,u.values)(this.inputParams).some(e=>e)}cancel(){this.activeModalRef.dismiss(S.DismissReasons.CLOSE_BTN)}}si.\u0275fac=function(e){return new(e||si)(n["\u0275\u0275directiveInject"](S.ActiveModalRef),n["\u0275\u0275directiveInject"](n.Injector))},si.\u0275cmp=n["\u0275\u0275defineComponent"]({type:si,selectors:[["rx-runtime-view-params-modal"]],features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:7,vars:1,consts:[[1,"modal-body"],[4,"ngFor","ngForOf"],[1,"modal-footer"],["btn-type","primary","rx-id","ok-button",3,"click"],["btn-type","secondary","rx-id","cancel-button",3,"click"],[3,"label","autofocus","ngModel","ngModelChange"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275template"](1,W,2,4,"div",1),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](2,"div",2),n["\u0275\u0275elementStart"](3,"adapt-button",3),n["\u0275\u0275listener"]("click",function(){return t.activeModalRef.close(t.inputParams)}),n["\u0275\u0275text"](4," OK "),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](5,"adapt-button",4),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](6," Cancel "),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",t.inputParamNames))},directives:[b.NgForOf,S.AdaptButtonComponent,S.AdaptRxTextfieldComponent,x.NgControlStatus,x.NgModel],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.modal-body[_ngcontent-%COMP%]{padding:20px}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;border-top:1px solid #d6d7d8;padding:10px 15px}.modal-footer[_ngcontent-%COMP%]   adapt-button[_ngcontent-%COMP%]{margin-right:5px}']});class li{}li.\u0275fac=function(e){return new(e||li)},li.\u0275mod=n["\u0275\u0275defineNgModule"]({type:li,declarations:[si],imports:[b.CommonModule,x.FormsModule,S.AdaptButtonModule,S.AdaptModalModule,S.AdaptRxTextfieldModule],exports:[si]}),li.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[b.CommonModule,x.FormsModule,S.AdaptButtonModule,S.AdaptModalModule,S.AdaptRxTextfieldModule]]});class di extends kt{constructor(e,t,i){super(e),this.injector=e,this.actionType=t,this.actionGuid=i,this.rxViewDataDictionaryService=this.injector.get(Nt),this.rxDefaultExpressionEvaluatorService=this.injector.get(p.RxDefaultExpressionEvaluatorService),this.rxViewActionRegistryService=this.injector.get(p.RxViewActionRegistryService),this.commonDataDictionary$=this.rxViewDataDictionaryService.getActionDataDictionary(this.actionGuid)}getExpressionEvaluator(e){const t=this.rxViewActionRegistryService.get(this.actionType).parameters.find(t=>t.name===e);return(0,u.get)(t,"evaluatorService",this.rxDefaultExpressionEvaluatorService)}}class ci extends kt{constructor(e,t){super(t),this.fieldDefinition=e,this.injector=t,this.rxNamedListDefinitionCacheService=this.injector.get(r.RxNamedListDefinitionCacheService),this.rxRecordDefinitionCacheService=this.injector.get(s.RxRecordDefinitionCacheService),this.rxViewDataDictionaryService=this.injector.get(Nt),this.rxDefaultExpressionEvaluatorService=this.injector.get(p.RxDefaultExpressionEvaluatorService),this.commonDataDictionary$=this.rxNamedListDefinitionCacheService.getNamedListDefinition(this.fieldDefinition.namedListDefinition).pipe((0,h.switchMap)(e=>this.rxRecordDefinitionCacheService.getRecordDefinition(e.recordDefinitionName)),(0,h.switchMap)(e=>this.getNamedListBranch(e)),(0,h.withLatestFrom)(this.rxViewDataDictionaryService.getCommonDataDictionary()),(0,h.map)(([e,t])=>[e,...t]))}getExpressionEvaluator(){return this.rxDefaultExpressionEvaluatorService}getDefaultConfig(){return Object.assign(Object.assign({},super.getDefaultConfig()),{operators:l.ExpressionOperatorRowsByGroup.get(l.ExpressionOperatorGroup.AllServer)})}getNamedListBranch(e){const t=(0,u.chain)(e.fieldDefinitions).reject({resourceType:s.RX_RECORD_DEFINITION.resourceTypes.attachment}).map(e=>({label:e.name,expression:`'${e.id}'`,icon:"d-icon-file_o_gear",children:e.resourceType===s.RX_RECORD_DEFINITION.resourceTypes.selection?[{label:"Options",children:(0,u.map)(e.optionNamesById,(e,t)=>({label:e,expression:t,icon:"d-icon-file_o_gear"}))}]:[]})).sortBy("label").value();return(0,f.of)({label:"Filter by",expanded:!0,children:t})}}class pi{constructor(e,t,i,n){this.injector=e,this.descriptor=t,this.guid=i,this.initialProps=n,this.destroyedSubject=new f.Subject,this.viewDesignerFacade=this.injector.get(Ft),this.actionPropertyEditorConfigSubject=new f.BehaviorSubject([]),this.actionPropertiesSubject=new f.BehaviorSubject(this.initialProps),this.children=[],this.children$=this.viewDesignerFacade.getChildComponents(this.guid),this.destroyed$=this.destroyedSubject.asObservable(),this.actionPropertyEditorConfig$=this.actionPropertyEditorConfigSubject.pipe((0,h.takeUntil)(this.destroyed$)),this.actionProperties$=this.actionPropertiesSubject.pipe((0,h.map)(()=>(0,u.omit)(this.getActionProperties(),["name"])),(0,h.distinctUntilChanged)(u.isEqual),(0,h.takeUntil)(this.destroyed$)),this.children$.pipe((0,h.first)(),(0,h.takeUntil)(this.destroyed$)).subscribe(e=>{this.setChildren(e)})}updateActionProperties(e){this.actionPropertiesSubject.next(Object.assign(Object.assign({},this.actionPropertiesSubject.getValue()),e))}setActionProperties(e){const{name:t,index:i}=this.actionPropertiesSubject.getValue();this.actionPropertiesSubject.next(Object.assign(Object.assign({$condition$:null},e),{name:t,index:i}))}getActionProperties(){return this.actionPropertiesSubject.getValue()}getActionPropertyValue(e){return this.actionPropertiesSubject.getValue()[e]}setActionPropertyEditorConfig(e){const t=new di(this.injector,this.descriptor.name,this.guid);e=[{name:"$condition$",component:d.ExpressionFormControlComponent,options:{label:"Condition",tooltip:new l.Tooltip("The action will execute if the condition is true, or if no condition is defined."),dataDictionary$:t.getDataDictionary(),operators:t.getOperators()}},...e],this.actionPropertyEditorConfigSubject.next(e)}getActionPropertyEditorConfig(){return this.actionPropertyEditorConfigSubject.getValue()}setActionOutputDataDictionary(e){this.viewDesignerFacade.setActionDataDictionaryBranch(this.guid,this.getActionPropertyValue("index"),this.descriptor.label,e)}setChildren(e){this.children=e}getChildren(){return this.children}onDestroy(){this.destroyedSubject.next(),this.destroyedSubject.complete()}}class mi{constructor(e,t){this.injector=e,this.sandbox=t,this.guid=this.sandbox.guid,this.expressionConfigurator=new di(this.injector,this.sandbox.descriptor.name,this.sandbox.guid)}getExpressionConfigurator(){return this.expressionConfigurator}getPropertiesByName(){return this.sandbox.getActionProperties()}getChildren(){return this.sandbox.getChildren()}getOutputExpressionForPropertyPath(e){return`\${view.components.${this.guid}.output.${e}}`}}class ui extends mi{constructor(e,t){super(e,t),this.injector=e,this.sandbox=t,this.defaultProps=this.sandbox.descriptor.parameters.reduce((e,t)=>(e[t.name]=t.defaultValue,e),{}),this.sandbox.actionProperties$.pipe((0,h.take)(1)).subscribe(e=>{this.sandbox.updateActionProperties(Object.assign(Object.assign({},this.defaultProps),e)),this.sandbox.setActionPropertyEditorConfig(this.getActionEditorConfig())})}getActionEditorConfig(){return this.sandbox.descriptor.parameters.filter(e=>e.editor).map(e=>({name:e.name,component:e.editor,options:Object.assign({label:e.label,isRequired:e.isRequired,tooltip:e.tooltip},e.editor===d.ExpressionFormControlComponent?{dataDictionary$:this.expressionConfigurator.getDataDictionary(e.name),operators:this.expressionConfigurator.getOperators(e.name)}:e.editorOptions||{})}))}}class fi{constructor(e){this.injector=e,this.models=new Map}create(e,t,i){var n;const o=new pi(this.injector,e,t,(0,u.isFunction)(null===(n=null==e?void 0:e.designModel)||void 0===n?void 0:n.getInitialProperties)?Object.assign(Object.assign({},e.designModel.getInitialProperties((0,u.omit)(i,["index","name"]))),{name:i.name,index:i.index}):i),r=new(e.designModel||ui)(this.injector,o);return this.models.set(t,r),r}remove(e){this.models.delete(e)}get(e){return this.models.get(e)}ngOnDestroy(){this.models.forEach(e=>e.sandbox.onDestroy()),this.models.clear()}}fi.\u0275fac=function(e){return new(e||fi)(n["\u0275\u0275inject"](n.Injector))},fi.\u0275prov=n["\u0275\u0275defineInjectable"]({token:fi,factory:fi.\u0275fac});class hi extends c.RxModalClass{constructor(e,t,i,n,o,r,a,s,l){super(i,l),this.rxViewActionRegistryService=e,this.rxStringService=t,this.activeModalRef=i,this.viewDesignerFacade=n,this.rxActionListModelManagerService=o,this.rxExpressionEditorService=r,this.rxGuidService=a,this.translateService=s,this.injector=l,this.availableActionDescriptors$=this.rxViewActionRegistryService.getLicensedActions(),this.selectedActions=[],this.config=this.activeModalRef.getData(),this.treeWrap=S.TreeWrap.WrapAll,this.destroyed$=new f.ReplaySubject(1),this.isEditorDirtySubject=new f.BehaviorSubject(!1),this.isSaveButtonDisabled$=this.isEditorDirtySubject.asObservable().pipe((0,h.map)(e=>!e)),this.availableActionTreeNodes$=this.availableActionDescriptors$.pipe((0,h.map)(e=>e.filter(e=>!e.hidden).sort((e,t)=>e.label.localeCompare(t.label)).map(e=>({data:e,label:e.label})))),this.actionLabelsMap$=this.availableActionDescriptors$.pipe((0,h.map)(e=>(0,u.transform)(e,(e,t)=>{e[t.name]=t.label},{}))),this.config.selectedActions=(0,u.map)(this.config.selectedActions,e=>Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{index:(0,S.toNumber)(e.data.index)})})),this.selectedActions=(0,u.flow)(e=>(0,u.sortBy)(e,e=>e.data.index),e=>(0,u.map)(e,e=>{const t=this.rxViewActionRegistryService.get(e.data.name);this.viewDesignerFacade.setActionDataDictionaryBranch(e.guid,e.data.index,e.data.name);const i=this.rxActionListModelManagerService.create(t,e.guid,e.data);return{isOpen:Boolean(this.config.actionToEdit)&&e.guid===this.config.actionToEdit.guid,model:i,config$:i.sandbox.actionPropertyEditorConfig$.pipe((0,h.map)(e=>[{controls:e}])),name:t.name}}))(this.config.selectedActions)}isDirty(){return this.isEditorDirtySubject.getValue()}addAction(e,t=this.selectedActions.length){const i=this.rxGuidService.generate();this.viewDesignerFacade.setActionDataDictionaryBranch(i,t,e.name);const n=this.rxActionListModelManagerService.create(e,i,{name:e.name,index:t});this.selectedActions.splice(t,0,{isOpen:!0,model:n,config$:n.sandbox.actionPropertyEditorConfig$.pipe((0,h.map)(e=>[{controls:e}])),name:e.name}),this.updateIndexProp(),this.markEditorAsDirty(),setTimeout(()=>{this.accordionTabEls.toArray()[t].nativeElement.scrollIntoView({block:"nearest"})})}onSave(){const e=this.selectedActions.map(e=>{var t,i,n;return{guid:e.model.guid,data:e.model.getPropertiesByName(),children:null!==(n=null===(i=(t=e.model).getChildren)||void 0===i?void 0:i.call(t))&&void 0!==n?n:null}});this.activeModalRef.close(e)}removeAction(e){(0,u.pull)(this.selectedActions,e),this.rxActionListModelManagerService.remove(e.model.guid),this.viewDesignerFacade.removeActionDataDictionaryBranch(e.model.guid),this.markEditorAsDirty()}moveAction(e,t){(0,C.moveItemInArray)(this.selectedActions,e,t),this.updateIndexProp(),this.markEditorAsDirty()}toggleOpen(e){this.selectedActions.forEach(t=>t.isOpen=e)}onSelectedActionsListDrop(e){var t;const i=e.item.data;(null===(t=i.model)||void 0===t?void 0:t.guid)?this.moveAction(e.previousIndex,e.currentIndex):this.addAction(i,e.currentIndex)}openExpressionEditor(e,t,i,n=!1,o){this.rxExpressionEditorService.openEditor({property:{path:t,value:(0,u.get)(e.sandbox.getActionProperties(),t),label:i},isReadOnly:n,expressionConfigurator:e.getExpressionConfigurator(),legend:[{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.function.label"),icon:"d-icon-mathematical_function"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.keyword.label"),icon:"d-icon-dollar"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-component.label"),icon:"d-icon-file_o"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-component-property.label"),icon:"d-icon-file_o_gear"},{label:this.translateService.instant("com.bmc.arsys.rx.client.expression-editor.legend.view-input-parameter.label"),icon:"d-icon-arrow_right_square_input"}],expressionPropertyNavigator:{getProperties:()=>{const t=Array.from(o.querySelectorAll("rx-expression-form-control")).map(t=>{const i=t.getAttribute("property-path");return{path:i,value:(0,u.get)(e.sandbox.getActionProperties(),i),label:t.getAttribute("property-label")}});return(0,f.of)(t)}}}).pipe((0,h.map)(({path:t,value:i})=>{const n=e.sandbox.getActionProperties(),o=t in n?t:(0,u.toPath)(t)[0];return(0,u.set)({[o]:(0,u.cloneDeep)(n[o])},t,i)})).subscribe(t=>{e.sandbox.updateActionProperties(t),this.markEditorAsDirty()})}onEvent(e,t,i){e.type===d.RX_EXPRESSION_EDITOR.events.openExpressionEditor&&this.openExpressionEditor(t,e.payload.propertyPath,e.payload.propertyLabel,e.payload.isReadOnly,i)}updateIndexProp(){this.selectedActions.forEach((e,t)=>{e.model.sandbox.updateActionProperties({index:t})}),this.viewDesignerFacade.updateActionDataDictionaryBranchOrder(this.selectedActions.reduce((e,t,i)=>(e[t.model.guid]=i,e),{}))}markEditorAsDirty(){this.isEditorDirtySubject.next(!0)}ngAfterViewInit(){const e=(0,u.findIndex)(this.selectedActions,"isOpen");-1!==e&&this.accordionTabEls.toArray()[e].nativeElement.scrollIntoView({block:"nearest"})}ngOnDestroy(){this.isEditorDirtySubject.complete(),this.destroyed$.next(!0),this.destroyed$.complete(),this.viewDesignerFacade.removeAllActionDataDictionaryBranches()}cancel(){this.activeModalRef.dismiss(S.DismissReasons.CLOSE_BTN)}}hi.\u0275fac=function(e){return new(e||hi)(n["\u0275\u0275directiveInject"](p.RxViewActionRegistryService),n["\u0275\u0275directiveInject"](g.RxStringService),n["\u0275\u0275directiveInject"](S.ActiveModalRef),n["\u0275\u0275directiveInject"](Ft),n["\u0275\u0275directiveInject"](fi),n["\u0275\u0275directiveInject"](d.RxExpressionEditorService),n["\u0275\u0275directiveInject"](g.RxGuidService),n["\u0275\u0275directiveInject"](m.TranslateService),n["\u0275\u0275directiveInject"](n.Injector))},hi.\u0275cmp=n["\u0275\u0275defineComponent"]({type:hi,selectors:[["rx-action-list-editor-dialog"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](S.AdaptAccordionTabComponent,5,n.ElementRef),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.accordionTabEls=e)}},features:[n["\u0275\u0275ProvidersFeature"]([fi]),n["\u0275\u0275InheritDefinitionFeature"]],decls:22,vars:20,consts:[[1,"designer-modal-body","modal-body","d-flex","mh-100"],[1,"row","flex-grow-1","w-100"],["class","col-4 border-right d-flex flex-column mh-100",4,"ngIf"],[1,"d-flex","align-items-start","justify-content-between"],[1,"d-flex","align-items-center"],[1,"mt-2"],["name","question_circle_o","appendToBody","true",1,"ml-2",3,"adaptPopover"],["class","btn-group",4,"ngIf"],["id","selected-action-list","cdkDropList","",1,"designer-modal-accordion-wrapper",3,"cdkDropListDropped"],[3,"multiselect"],["class","designer-modal-accordion-content","cdkDrag","","cdkDragLockAxis","y",3,"cdkDragData","cdkDragDisabled",4,"ngFor","ngForOf"],["class","d-flex justify-content-center h-100 align-items-center mt-2",4,"ngIf"],[1,"modal-footer"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click",4,"ngIf"],["adapt-button","","btn-type","secondary","type","button","rx-id","cancel-button",3,"click"],[1,"col-4","border-right","d-flex","flex-column","mh-100"],[1,"rx-card","card","flex-grow-1","mt-2"],["class","card-block",4,"ngIf"],[1,"card-block"],["cdkDropList","","cdkDropListSortingDisabled","",3,"cdkDropListConnectedTo",4,"ngIf","ngIfElse"],["adaptTreeEmptyStateTemplate",""],["cdkDropList","","cdkDropListSortingDisabled","",3,"cdkDropListConnectedTo"],["filter","true",3,"value","wrap"],["adaptTreeNodeTemplate",""],["class","rx-tree-draggable-node","cdkDrag","",3,"cdkDragData",4,"ngIf"],["cdkDrag","",1,"rx-tree-draggable-node",3,"cdkDragData"],[3,"dblclick"],["type","button",1,"rx-button-unstyled","d-icon-plus_circle",3,"click"],[1,"rx-tree-node-label","ml-3"],[1,"d-flex","justify-content-center","h-100","align-items-center","mt-2"],["type","search",1,"w-100",3,"label"],[1,"btn-group"],["adapt-button","","btn-type","tertiary","type","button","rx-id","expand-all-button",3,"click"],["adapt-button","","btn-type","tertiary","type","button","rx-id","collapse-all-button",3,"click"],["cdkDrag","","cdkDragLockAxis","y",1,"designer-modal-accordion-content",3,"cdkDragData","cdkDragDisabled"],["container",""],["class","designer-modal-drag-handle d-icon-left-dots","cdkDragHandle","",4,"ngIf"],[1,"d-block",3,"isOpen","open","close"],[1,"card-title-text","w-100"],[1,"designer-modal-card-title-content"],[1,"left-header-block"],["class","rx-ellipsis","rx-id","card-title",3,"title",4,"ngIf"],["class","right-header-block",4,"ngIf"],[1,"d-block",3,"config","model","isReadOnly","modelChange","editorEvent"],["cdkDragHandle","",1,"designer-modal-drag-handle","d-icon-left-dots"],["rx-id","card-title",1,"rx-ellipsis",3,"title"],[1,"right-header-block"],[1,"designer-modal-card-title-index-buttons"],["type","button","rx-id","move-down-button",1,"d-icon-left-triangle_down","rx-button-unstyled",3,"disabled","click"],["type","button","rx-id","move-up-button",1,"d-icon-left-triangle_up","rx-button-unstyled",3,"disabled","click"],["adapt-button","","size","small","type","button","rx-id","remove-button",1,"d-icon-left-cross_adapt","p-1","pr-4","ml-3",3,"click"],["type","config",1,"w-100",3,"label"],["adapt-button","","btn-type","primary","type","button","rx-id","save-button",3,"disabled","click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275template"](2,Z,8,6,"div",2),n["\u0275\u0275elementStart"](3,"div"),n["\u0275\u0275elementStart"](4,"div",3),n["\u0275\u0275elementStart"](5,"div",4),n["\u0275\u0275elementStart"](6,"h4",5),n["\u0275\u0275text"](7),n["\u0275\u0275pipe"](8,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](9,"adapt-icon",6),n["\u0275\u0275pipe"](10,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](11,ee,7,6,"div",7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](12,"div",8),n["\u0275\u0275listener"]("cdkDropListDropped",function(e){return t.onSelectedActionsListDrop(e)}),n["\u0275\u0275elementStart"](13,"adapt-accordion",9),n["\u0275\u0275template"](14,oe,13,17,"div",10),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](15,re,3,3,"div",11),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](16,"div",12),n["\u0275\u0275template"](17,ae,4,6,"button",13),n["\u0275\u0275elementStart"](18,"button",14),n["\u0275\u0275listener"]("click",function(){return t.cancel()}),n["\u0275\u0275text"](19),n["\u0275\u0275pipe"](20,"translate"),n["\u0275\u0275pipe"](21,"translate"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.config.isReadOnly),n["\u0275\u0275advance"](1),n["\u0275\u0275classMapInterpolate1"]("d-flex flex-column mh-100 ",t.config.isReadOnly?"col":"col-8",""),n["\u0275\u0275advance"](4),n["\u0275\u0275textInterpolate1"](" ",n["\u0275\u0275pipeBind1"](8,12,"com.bmc.arsys.rx.client.view-components.action-list.selected-actions.title")," "),n["\u0275\u0275advance"](2),n["\u0275\u0275propertyInterpolate"]("adaptPopover",n["\u0275\u0275pipeBind1"](10,14,"com.bmc.arsys.rx.client.view-components.action-list.selected-actions.tooltip")),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",t.selectedActions.length),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("multiselect",!0),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",t.selectedActions),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",!t.selectedActions.length),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",!t.config.isReadOnly),n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"](" ",t.config.isReadOnly?n["\u0275\u0275pipeBind1"](20,16,"com.bmc.arsys.rx.client.common.close.label"):n["\u0275\u0275pipeBind1"](21,18,"com.bmc.arsys.rx.client.common.cancel.label")," "))},directives:[b.NgIf,S.AdaptIconComponent,S.AdaptPopoverDirective,C.CdkDropList,S.AdaptAccordionComponent,b.NgForOf,S.AdaptButtonComponent,S.AdaptTreeComponent,S.AdaptTreeNodeTemplateDirective,C.CdkDrag,S.AdaptEmptyStateComponent,S.AdaptAccordionTabComponent,d.FormBuilderComponent,C.CdkDragHandle],pipes:[m.TranslatePipe,b.AsyncPipe],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}.designer-modal-body[_ngcontent-%COMP%]{height:645px;min-height:calc(100% - 61px)!important}.designer-modal-accordion-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:auto;padding-top:10px}.designer-modal-accordion-content[_ngcontent-%COMP%]{position:relative}.designer-modal-accordion-content.cdk-drag-preview[_ngcontent-%COMP%]{z-index:1200!important}.designer-modal-drag-handle[_ngcontent-%COMP%]{cursor:move;position:absolute;top:0;left:0;height:46px;padding:14px 10px 14px 14px;z-index:1}.designer-modal-card-title-content[_ngcontent-%COMP%]{width:100%;display:flex}.designer-modal-card-title-content[_ngcontent-%COMP%]   .left-header-block[_ngcontent-%COMP%], .designer-modal-card-title-content[_ngcontent-%COMP%]   .right-header-block[_ngcontent-%COMP%]{display:flex;align-items:center}.designer-modal-card-title-content[_ngcontent-%COMP%]   .left-header-block[_ngcontent-%COMP%]{flex-grow:1;min-width:0;font-size:14px;padding-left:22px}.designer-modal-card-sub-title[_ngcontent-%COMP%]{color:#7c7f81;font-weight:normal}.designer-modal-card-title-index-buttons[_ngcontent-%COMP%]{display:flex;font-size:19px}.rx-card[_ngcontent-%COMP%]{overflow:auto}.rx-tree-draggable-node[_ngcontent-%COMP%]{cursor:pointer}.rx-tree-draggable-node.cdk-drag-preview[_ngcontent-%COMP%]{z-index:1200!important}.rx-tree-draggable-node.cdk-drag[_ngcontent-%COMP%]{opacity:1}.rx-tree-node-label[_ngcontent-%COMP%]{word-break:break-all}rx-form-builder[_ngcontent-%COMP%]{max-width:400px}[_nghost-%COMP%]  .a-tree__node_leaf .a-tree__toggle{display:none}']});class gi{}gi.\u0275fac=function(e){return new(e||gi)},gi.\u0275mod=n["\u0275\u0275defineNgModule"]({type:gi,declarations:[hi],imports:[b.CommonModule,S.AdaptRxSearchModule,S.AdaptButtonModule,S.AdaptAccordionModule,C.DragDropModule,S.AdaptEmptyStateModule,d.ExpressionEditorModule,x.FormsModule,d.RxFormBuilderModule,S.AdaptIconModule,S.AdaptPopoverModule,m.TranslateModule,S.AdaptTreeModule],exports:[hi]}),gi.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[b.CommonModule,S.AdaptRxSearchModule,S.AdaptButtonModule,S.AdaptAccordionModule,C.DragDropModule,S.AdaptEmptyStateModule,d.ExpressionEditorModule,x.FormsModule,d.RxFormBuilderModule,S.AdaptIconModule,S.AdaptPopoverModule,m.TranslateModule,S.AdaptTreeModule]]});class vi extends d.ValueAccessor{constructor(e,t){super(),this.rxModalService=e,this.rxViewActionRegistryService=t,this.availableActions$=this.rxViewActionRegistryService.getLicensedActions(),this.selectedActions=[],this.availableActions$.subscribe(e=>{this.actionLabelsMap=(0,u.transform)(e,(e,t)=>{e[t.name]=t.label},{})})}focus(e){(null==e?void 0:e.actionIndex)>=0?this.openActionSelector(this.selectedActions.find(t=>t.data.index===e.actionIndex)):this.openActionSelector()}openActionSelector(e){this.rxModalService.openModal({title:"Edit actions",data:{selectedActions:this.value,actionToEdit:e,isReadOnly:this.isDisabled},content:hi,size:p.OpenViewActionModalSize.Large,testID:"edit-actions"}).then(e=>{this.value=e}).catch(u.noop)}onSetValue(){this.updateSortedActionsList()}onWriteValue(e){this.updateSortedActionsList()}removeAction(e){this.value=(0,u.without)(this.value,e)}editAction(e){this.openActionSelector(e)}updateSortedActionsList(){this.selectedActions=(0,u.sortBy)(this.value,e=>e.data.index)}}vi.\u0275fac=function(e){return new(e||vi)(n["\u0275\u0275directiveInject"](c.RxModalService),n["\u0275\u0275directiveInject"](p.RxViewActionRegistryService))},vi.\u0275cmp=n["\u0275\u0275defineComponent"]({type:vi,selectors:[["rx-action-list-control"]],inputs:{options:"options",tooltip:"tooltip"},features:[n["\u0275\u0275ProvidersFeature"]([{provide:x.NG_VALUE_ACCESSOR,useExisting:vi,multi:!0}]),n["\u0275\u0275InheritDefinitionFeature"]],decls:7,vars:3,consts:[["rx-id","open-modal-button","btn-type","tertiary",1,"px-0","py-0","pb-1",3,"click"],["name","plus_circle",1,"mr-1"],["class","align-middle",4,"ngIf"],["rx-id","columns"],["class","text-tertiary",4,"ngIf"],["class","list-unstyled mb-0",4,"ngIf"],[1,"align-middle"],[1,"letter-space"],["appendToBody","true",3,"name","adaptPopover"],[1,"text-tertiary"],[1,"list-unstyled","mb-0"],["class","border px-2 py-1 mb-1 d-flex align-items-center",4,"ngFor","ngForOf"],[1,"border","px-2","py-1","mb-1","d-flex","align-items-center"],[1,"mr-auto"],["adapt-button","","btn-type","tertiary","size","small","type","button",1,"d-icon-left-pencil","p-1",3,"click"],["class","d-icon-left-cross_adapt p-1","adapt-button","","btn-type","tertiary","size","small","type","button",3,"click",4,"ngIf"],["adapt-button","","btn-type","tertiary","size","small","type","button",1,"d-icon-left-cross_adapt","p-1",3,"click"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"adapt-button",0),n["\u0275\u0275listener"]("click",function(){return t.openActionSelector()}),n["\u0275\u0275element"](1,"adapt-icon",1),n["\u0275\u0275text"](2," Edit actions\n"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](3,se,3,2,"span",2),n["\u0275\u0275elementStart"](4,"div",3),n["\u0275\u0275template"](5,le,2,0,"span",4),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](6,pe,2,1,"ul",5)),2&e&&(n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngIf",t.tooltip),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",0===t.selectedActions.length),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",t.selectedActions.length>0))},directives:[S.AdaptButtonComponent,S.AdaptIconComponent,b.NgIf,S.AdaptPopoverDirective,b.NgForOf],encapsulation:2});class yi{}yi.\u0275fac=function(e){return new(e||yi)},yi.\u0275mod=n["\u0275\u0275defineNgModule"]({type:yi,declarations:[vi],imports:[b.CommonModule,S.AdaptIconModule,S.AdaptButtonModule,gi,S.AdaptPopoverModule],exports:[vi]}),yi.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[b.CommonModule,S.AdaptIconModule,S.AdaptButtonModule,gi,S.AdaptPopoverModule]]});class xi{constructor(e){this.viewDesignerFacade=e,this.permissions=[],this.destroyed$=new f.ReplaySubject(1)}ngOnInit(){this.viewDesignerFacade.getComponentPermissions(this.options.componentGuid).pipe((0,h.takeUntil)(this.destroyed$)).subscribe(e=>{this.permissions=e})}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}onPermissionsChange(e){this.viewDesignerFacade.updateComponentModel(this.options.componentGuid,{permissions:e})}}xi.\u0275fac=function(e){return new(e||xi)(n["\u0275\u0275directiveInject"](Ft))},xi.\u0275cmp=n["\u0275\u0275defineComponent"]({type:xi,selectors:[["rx-component-permission-editor-widget"]],inputs:{options:"options",isDisabled:"isDisabled"},decls:1,vars:3,consts:[[3,"options","disabled","ngModel","ngModelChange"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"rx-permission-editor",0),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.permissions=e})("ngModelChange",function(e){return t.onPermissionsChange(e)}),n["\u0275\u0275elementEnd"]()),2&e&&n["\u0275\u0275property"]("options",t.options)("disabled",t.isDisabled)("ngModel",t.permissions)},directives:[d.RxPermissionEditorComponent,x.NgControlStatus,x.NgModel],encapsulation:2});class bi{}bi.\u0275fac=function(e){return new(e||bi)},bi.\u0275mod=n["\u0275\u0275defineNgModule"]({type:bi,declarations:[xi],imports:[b.CommonModule,x.FormsModule,d.RxPermissionEditorModule]}),bi.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[b.CommonModule,x.FormsModule,d.RxPermissionEditorModule]]});class Ci{}Ci.\u0275fac=function(e){return new(e||Ci)},Ci.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Ci,declarations:[_t],imports:[b.CommonModule,x.FormsModule,d.CustomizationOptionsModule]}),Ci.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[b.CommonModule,x.FormsModule,d.CustomizationOptionsModule]]});class Si extends d.InspectorWidgetBase{constructor(e){super(e),this.injector=e,this.actions=[],this.modelSandbox=this.designerItemModel.sandbox,this.destroyed$=new f.ReplaySubject(1)}ngOnInit(){this.modelSandbox.getChildComponents().pipe((0,h.takeUntil)(this.destroyed$)).subscribe(e=>{this.actions=e})}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}onActionsChange(e){this.modelSandbox.setChildren(this.getActionComponentPayloads(e))}focus(e){this.actionListControlComponent.focus(e)}getActionComponentPayloads(e){return e.map(e=>Object.assign({type:p.RxViewComponentType.Action},e))}}Si.\u0275fac=function(e){return new(e||Si)(n["\u0275\u0275directiveInject"](n.Injector))},Si.\u0275cmp=n["\u0275\u0275defineComponent"]({type:Si,selectors:[["rx-action-list-widget"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](vi,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.actionListControlComponent=e.first)}},features:[n["\u0275\u0275InheritDefinitionFeature"]],decls:2,vars:5,consts:[[3,"disabled","ngModel","tooltip","ngModelChange"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"rx-action-list-control",0),n["\u0275\u0275listener"]("ngModelChange",function(e){return t.actions=e})("ngModelChange",function(e){return t.onActionsChange(e)}),n["\u0275\u0275pipe"](1,"async"),n["\u0275\u0275elementEnd"]()),2&e&&n["\u0275\u0275property"]("disabled",n["\u0275\u0275pipeBind1"](1,3,t.modelSandbox.isViewReadOnly$))("ngModel",t.actions)("tooltip",null==t.options?null:t.options.tooltip)},directives:[vi,x.NgControlStatus,x.NgModel],pipes:[b.AsyncPipe],encapsulation:2});class wi{}wi.\u0275fac=function(e){return new(e||wi)},wi.\u0275mod=n["\u0275\u0275defineNgModule"]({type:wi,declarations:[Si],imports:[b.CommonModule,yi,x.FormsModule]}),wi.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[b.CommonModule,yi,x.FormsModule]]});class Di{constructor(e,t){this.injector=e,this.sandbox=t}get expressionConfigurator(){return this._expressionConfigurator||(this._expressionConfigurator=new(this.sandbox.descriptor.expressionConfigurator||jt)(this.injector,this.sandbox.guid,this,this.sandbox.descriptor.type)),this._expressionConfigurator}getExpressionForProperty(e){return`\${view.components.${this.sandbox.guid}.${e}}`}}const Ri=[{id:p.RxDevice.Desktop,name:"Desktop"},{id:p.RxDevice.Tablet,name:"Tablet"},{id:p.RxDevice.Mobile,name:"Mobile"}];function Ii(){return{name:p.RX_AVAILABLE_ON_DEVICES_PROP_NAME,component:d.SelectFormControlComponent,options:{label:"Available on devices",options:Ri,multiple:!0,required:!0,hideSelectAllButton:!0,hideDeselectAllButton:!0}}}function Fi(){return{name:p.RX_HIDDEN_PROP_NAME,component:d.OptionalExpressionInspectorControlComponent,options:{label:"Hidden"}}}function Ei(){return{name:p.RX_DISABLED_PROP_NAME,component:d.OptionalExpressionInspectorControlComponent,options:{label:"Disabled"}}}function Mi(e=[]){return{name:p.RX_STYLES_PROP_NAME,component:d.TagsFormControlComponent,options:{label:"CSS classes",placeholder:"Add CSS classes",tooltip:new l.Tooltip("Enter CSS class names to apply to this view component."),errorCheck:At,autocompleteValues:e}}}function Ai(){return[Fi(),Ii(),Mi()]}class Oi{constructor(e,t,i,n){this.rxViewActionRegistryService=e,this.rxStringService=t,this.rxLogService=i,this.rxViewExpressionValidatorService=n}validate(e,t){const i=(0,u.flow)(e=>e.map(({data:e})=>{const i=this.rxViewActionRegistryService.get(e.name);return[(0,f.of)(this.validateRequiredProps(e,i,t)),this.performCustomValidation(e,i,t),this.validateExpressions(e,i,t)]}),u.flatten)(e);return(0,f.combineLatest)([(0,f.of)(this.validateActionSequence(e,t)),...i]).pipe((0,h.map)(u.flatten))}performCustomValidation(e,t,i){const n=this.rxViewActionRegistryService.getDesignManager(t.name);return n?n.validate(e,i).pipe((0,h.map)(t=>t.map(t=>Object.assign(Object.assign({},t),{data:{actionIndex:e.index}})))):(0,f.of)([])}validateRequiredProps(e,t,i){return(0,u.flow)(t=>t.filter(t=>!0===t.isRequired&&this.rxStringService.isEmptySafe(e[t.name])),n=>n.map(n=>({type:"error",description:`${t.label} action: ${n.label||n.name} cannot be blank.`,propertyName:i,data:{actionIndex:e.index}})))(t.parameters)}validateExpressions(e,t,i){const n=t.parameters.filter(t=>!0===t.enableExpressionEvaluation&&e[t.name]).map(n=>this.rxViewExpressionValidatorService.validate(e[n.name],i,n.label||n.name,n.evaluatorService).pipe((0,h.map)(i=>i.map(i=>Object.assign(Object.assign({},i),{description:`${t.label} action: ${i.description}`,data:{actionIndex:e.index}})))));return n.length?(0,f.combineLatest)(n).pipe((0,h.map)(u.flatten)):(0,f.of)([])}validateActionSequence(e,t){return(0,u.flow)(e=>(0,u.map)(e,({data:i})=>{const n=this.rxViewActionRegistryService.get(i.name);return n?(0,u.map)(i,(o,r)=>{var a;if((null===(a=n.parameters.find(e=>e.name===r))||void 0===a?void 0:a.enableExpressionEvaluation)&&this.rxStringService.isNonEmptyString(o)){const a=o.match(/\${view\.components\.([0-9a-z-]+)\..+}/);if(a&&a[1]){const o=(0,u.find)(e,{guid:a[1]});if(Number(null==o?void 0:o.data.index)>Number(i.index))return{type:"error",description:`${n.label} action: invalid expression for ${r}.`,propertyName:t}}}}):[]}),u.flatten,u.compact)(e)}}Oi.\u0275fac=function(e){return new(e||Oi)(n["\u0275\u0275inject"](p.RxViewActionRegistryService),n["\u0275\u0275inject"](g.RxStringService),n["\u0275\u0275inject"](l.RxLogService),n["\u0275\u0275inject"](Vt))},Oi.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Oi,factory:Oi.\u0275fac,providedIn:"root"});class Pi{constructor(e,t,i){this.injector=e,this.guid=t,this.descriptor=i,this.viewDesignerFacade=this.injector.get(Ft),this.systemActions$=this.injector.get(v.Actions),this.viewDesignerDispatcher=this.injector.get(je),this.rxViewDesignerModels=this.injector.get(Et),this.childModelsInitialized$=new f.BehaviorSubject(!1),this.dispatcher$=new f.Subject,this.breadcrumbs$=new f.ReplaySubject(1),this.setUpPublicStreams(),this.viewDesignerFacade.getComponentType(t).pipe((0,h.take)(1)).subscribe(e=>this.componentType=e),this.viewDesignerFacade.getComponentModel(this.guid).pipe((0,h.map)(e=>Boolean(e.lastUpdateTime||e.name)),(0,h.switchMap)(e=>e?this.viewDesignerFacade.viewModelsInitialized$:(0,f.of)(null)),(0,h.take)(1),(0,h.takeUntil)(this.destroyed$)).subscribe(()=>{this.childModelsInitialized$.next(!0)}),this.viewModelsInitialized$=this.viewDesignerFacade.viewModelsInitialized$.pipe((0,h.takeUntil)(this.destroyed$)),this.isComponentSelected$.pipe((0,h.filter)(e=>e),(0,h.first)(),(0,h.switchMap)(()=>this.breadcrumbs$),(0,h.distinctUntilChanged)(),(0,h.takeUntil)(this.destroyed$)).subscribe(e=>{this.dispatcher$.next(Me({guid:this.guid,label:e}))}),(0,f.merge)(this.dispatcher$.pipe((0,v.ofType)(Re),(0,h.skipWhile)(e=>0===e.issues.length)),this.dispatcher$.pipe((0,h.filter)(e=>e.type!==Re.type))).pipe((0,h.takeUntil)(this.destroyed$)).subscribe(e=>this.viewDesignerDispatcher.dispatch(e)),this.destroyed$.subscribe(()=>{this.childModelsInitialized$.complete(),this.dispatcher$.complete(),this.breadcrumbs$.complete()})}createError(e,t,i){return{type:"error",description:e,propertyName:t,disableCorrection:i}}createWarning(e,t,i){return{type:"warning",description:e,propertyName:t,disableCorrection:i}}getComponent(e){return this.viewDesignerFacade.getComponent(e)}getChildComponents(e){return this.childModelsInitialized$.asObservable().pipe((0,h.filter)(Boolean),(0,h.switchMapTo)(this.viewDesignerFacade.getChildComponents(this.guid,e)),(0,h.takeUntil)(this.destroyed$))}getChildComponentsTree(){return this.childModelsInitialized$.asObservable().pipe((0,h.filter)(e=>e),(0,h.switchMapTo)(this.viewDesignerFacade.getChildComponentTree(this.guid)),(0,h.shareReplay)(1),(0,h.takeUntil)(this.destroyed$))}getChildComponentGuids(e,t=!1){return this.childModelsInitialized$.asObservable().pipe((0,h.filter)(Boolean),(0,h.switchMapTo)(this.viewDesignerFacade.getChildComponentGuids(this.guid,t,e)),(0,h.takeUntil)(this.destroyed$))}setChildren(e,t){this.dispatcher$.next(Ee({payload:{guid:t||this.guid,data:e}}))}setChildrenByType(e,t){this.dispatcher$.next(Ee({payload:{guid:this.guid,data:e,types:t}}))}getParentComponentGuid(e){return this.viewDesignerFacade.getParentComponentGuid(this.guid,e).pipe((0,h.distinctUntilChanged)(),(0,h.takeUntil)(this.destroyed$))}setValidationIssues(e){this.dispatcher$.next(Re({issues:e,guid:this.guid}))}updateComponentProperties(e){this.viewDesignerFacade.updateComponentProperties(this.guid,e)}getComponentPropertyValue(e,t=this.guid){return this.viewDesignerFacade.getComponentPropertyValue(t,e).pipe((0,h.shareReplay)(1),(0,h.takeUntil)(this.destroyed$))}getViewPropertyValue(e){return this.viewDesignerFacade.getViewPropertyValue(e).pipe((0,h.shareReplay)(1),(0,h.takeUntil)(this.destroyed$))}updateInspectorConfig(e){this.viewDesignerFacade.setComponentInspector(this.guid,e)}setBreadcrumbs(e){this.breadcrumbs$.next(e)}addComponent(e){const t=(0,u.castArray)(e).map(e=>Object.assign(Object.assign({},e),{parentGuid:this.guid}));this.dispatcher$.next(Ve({payload:t}))}selectComponent(e){this.dispatcher$.next(Ae({guid:e}))}removeComponents(e,t){this.viewDesignerFacade.removeViewComponents(e,t)}moveComponent(e,t,i){const n={guid:e},o=p.RX_VIEW_DEFINITION.defaultOutletName;this.dispatcher$.next(Te({data:n,insertIndex:t,columnIndex:0,outletName:o,targetGuid:i}))}setLayout(e){this.dispatcher$.next(Oe({guid:this.guid,cols:e}))}getLayout(e){return this.viewDesignerFacade.getComponentLayout(e).pipe((0,h.shareReplay)(1),(0,h.takeUntil)(this.destroyed$))}setCommonDataDictionary(e){this.viewDesignerFacade.setComponentCommonDataDictionaryBranch(this.guid,e)}setSettablePropertiesDataDictionary(e,t){this.viewDesignerFacade.setComponentSettablePropertiesDataDictionary(this.guid,e,t)}getComponentModel(e){return this.rxViewDesignerModels.get(e)}getComponentsByType(e){return this.viewDesignerFacade.getComponentsByType(e).pipe((0,h.takeUntil)(this.destroyed$))}setUpPublicStreams(){const e=this.systemActions$.pipe((0,v.ofType)(Se),(0,h.filter)(e=>e.guids.includes(this.guid)));this.destroyed$=(0,f.merge)(e,this.viewDesignerFacade.initViewDesigner$,this.viewDesignerFacade.destroyViewDesigner$).pipe((0,h.mapTo)(!0),(0,h.first)()),this.componentProperties$=this.viewDesignerFacade.getComponentProperties(this.guid).pipe((0,h.filter)(Boolean),(0,h.takeUntil)(this.destroyed$),(0,h.shareReplay)(1)),this.isComponentSelected$=this.systemActions$.pipe((0,v.ofType)(Ae),(0,h.map)(({guid:e})=>e===this.guid),(0,h.distinctUntilChanged)(),(0,h.startWith)(!1),(0,h.takeUntil)(this.destroyed$),(0,h.shareReplay)(1)),this.isViewReadOnly$=this.viewDesignerFacade.isViewReadOnly$}}class Ti{constructor(e,t,i){this.rxViewComponentRegistryService=e,this.viewDesignerFacade=t,this.rxViewExpressionValidatorService=i,this.issuesObservableMap=new Map}registerComponents(e){e.forEach(e=>this.issuesObservableMap.set(e,this.getComponentValidationIssues(e))),this.initValidation()}unregisterComponents(e){e.forEach(e=>this.issuesObservableMap.delete(e)),this.initValidation()}unregisterAllComponents(){var e;this.issuesObservableMap.clear(),null===(e=this.validateSubscription)||void 0===e||e.unsubscribe()}initValidation(){var e;null===(e=this.validateSubscription)||void 0===e||e.unsubscribe(),this.validateSubscription=(0,f.combineLatest)(Array.from(this.issuesObservableMap.entries()).map(([e,t])=>t.pipe((0,h.map)(t=>({[e]:t}))))).pipe((0,h.map)(e=>(0,u.merge)({},...e)),(0,h.skipWhile)(e=>(0,u.every)(Object.values(e),u.isEmpty)),(0,h.debounceTime)(0)).subscribe(e=>{this.viewDesignerFacade.setExpressionValidationIssues(e)})}getComponentValidationIssues(e){return this.viewDesignerFacade.getComponentType(e).pipe((0,h.take)(1),(0,h.switchMap)(t=>{const i=this.rxViewComponentRegistryService.get(t),n=(0,u.filter)(null==i?void 0:i.properties,{enableExpressionEvaluation:!0}),o=(0,u.map)(n,"name"),r=new Map(n.map(e=>[e.name,e]));return o.length?(0,f.combineLatest)(o.map(t=>this.viewDesignerFacade.getComponentPropertyValue(e,t).pipe((0,h.switchMap)(i=>this.rxViewExpressionValidatorService.validate(i,t,r.get(t).label,r.get(t).evaluatorService).pipe((0,h.takeUntil)(this.viewDesignerFacade.allComponentGuids$.pipe((0,h.filter)(t=>!t.has(e))))))))).pipe((0,h.map)(u.flatten)):(0,f.of)([])}),(0,h.publishReplay)(1),(0,h.refCount)())}}Ti.\u0275fac=function(e){return new(e||Ti)(n["\u0275\u0275inject"](p.RxViewComponentRegistryService),n["\u0275\u0275inject"](Ft),n["\u0275\u0275inject"](Vt))},Ti.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Ti,factory:Ti.\u0275fac,providedIn:"root"});class Vi{getInitialComponentProperties(e,t){var i;let n=e;return(0,u.isFunction)(null===(i=t.designComponentModel)||void 0===i?void 0:i.getInitialProperties)&&(n=t.designComponentModel.getInitialProperties(e)),n}getDefaultComponentPermissions(e){var t;let i=null;return(0,u.isFunction)(null===(t=e.designComponentModel)||void 0===t?void 0:t.getDefaultPermissions)&&(i=e.designComponentModel.getDefaultPermissions()),i}}Vi.\u0275fac=function(e){return new(e||Vi)},Vi.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Vi,factory:Vi.\u0275fac,providedIn:"root"});class Ni{constructor(e,t,i,n,o,r,a,s,l,d){this.actions$=e,this.injector=t,this.viewDesignerModels=i,this.rxGuidService=n,this.store$=o,this.rxViewComponentRegistryService=r,this.rxViewDesignerInspectorService=a,this.rxViewExpressionValidatorRegistryService=s,this.rxViewDesignerStateHelperService=l,this.rxViewDataDictionaryStoreService=d,this.initializeComponentModel$=this.actions$.pipe((0,v.ofType)(we),(0,h.tap)(e=>{e.payload.forEach(({componentModel:e})=>{const t=this.rxViewComponentRegistryService.get(e.type),i=new Pi(this.injector,e.guid,t),n=new t.designComponentModel(this.injector,i);(0,u.isFunction)(n.rxInit)&&n.rxInit(),this.viewDesignerModels.set(e.guid,n)})}),(0,h.map)(()=>Xe())),this.registerComponentsValidation$=this.actions$.pipe((0,v.ofType)(De,we),(0,h.tap)(e=>this.rxViewExpressionValidatorRegistryService.registerComponents((0,u.map)(e.payload,e=>e.componentModel.guid)))),this.onComponentsRemoved$=this.actions$.pipe((0,v.ofType)(Se),(0,h.tap)(({guids:e})=>{this.rxViewExpressionValidatorRegistryService.unregisterComponents(e),this.rxViewDataDictionaryStoreService.removeDataDictionaryForComponents(e)})),this.unregisterAllComponentsValidation$=this.actions$.pipe((0,v.ofType)(it,nt),(0,h.tap)(()=>this.rxViewExpressionValidatorRegistryService.unregisterAllComponents())),this.insertComponent$=this.actions$.pipe((0,v.ofType)(Te),(0,h.map)(e=>{const t={insertIndex:e.insertIndex,columnIndex:e.columnIndex,outletName:e.outletName,parentGuid:e.targetGuid};return e.data.guid?Pe(Object.assign(Object.assign({},t),{guid:e.data.guid})):Ve({payload:[Object.assign(Object.assign({},t),{type:e.data.type,selectComponent:!0,propertiesByName:e.data.initialPropertiesByName})]})})),this.addNewComponent$=this.actions$.pipe((0,v.ofType)(Ve),(0,h.withLatestFrom)(this.store$.select(lt)),(0,h.mergeMap)(([e,t])=>{const i=[],n=[],o=[];return e.payload.forEach(e=>{this.processAddComponentPayload(e,i,n,o,t)}),[i.length?we({payload:i}):null,n.length?De({payload:n}):null,o.length?Ae({guid:(0,u.last)(o)}):null].filter(Boolean)})),this.removeComponent$=this.actions$.pipe((0,v.ofType)(ke),(0,h.filter)(({guids:e})=>!(0,u.isEmpty)(e)),(0,h.withLatestFrom)(this.store$.select(lt)),(0,h.mergeMap)(([e,t])=>{const i=e.guids.reduce((e,i)=>{const n=t[i];return n&&e.push(i,...ye(n,t)),e},[]),n=new Set(i);n.forEach(e=>{this.viewDesignerModels.delete(e),this.rxViewDesignerInspectorService.delete(e)});const o=[Se({guids:[...n]})];if(e.selectParent){const i=t[(0,u.last)(e.guids)];(null==i?void 0:i.parentGuid)&&o.push(Ae({guid:i.parentGuid}))}return o})),this.setChildren$=this.actions$.pipe((0,v.ofType)(Ee),(0,h.map)(e=>e.payload),(0,h.withLatestFrom)(this.store$.select(lt)),(0,h.mergeMap)(([e,t])=>{const i=[],n=[],o=[],r=[];function a(e,t){const i={propertiesByName:e.data,guid:e.guid,parentGuid:t,type:e.type,columnIndex:e.columnIndex||0,insertIndex:e.insertIndex,outletName:e.outletName||p.RX_VIEW_DEFINITION.defaultOutletName};return e.children&&(i.children=(0,u.map)(e.children,t=>a(t,e.guid))),i}return function e(i){const s=i.data,l=s.map(e=>e.guid);let d=ve(t[i.guid]);i.types&&(d=d.filter(e=>i.types.includes(t[e].type)));const c=(0,u.difference)(d,l),p=(0,u.difference)(l,d),m=(0,u.difference)(d,p,c);n.push(...c);const f=s.reduce((e,t)=>((0,u.includes)(p,t.guid)&&e.push(a(t,i.guid)),e),[]);o.push(...f);const h=s.reduce((i,n)=>{if((0,u.includes)(m,n.guid)){const o=t[n.guid];(0,u.isEqual)(o.propertiesByName,n.data||{})||i.push({guid:n.guid,data:n.data}),n.children&&e({guid:n.guid,data:n.children})}return i},[]);r.push(...h)}(e),n.length&&i.push(ke({guids:n})),o.length&&i.push(Ve({payload:o})),r.length&&i.push(Fe({payload:r})),i}))}processAddComponentPayload(e,t,i,n,o){const r=this.rxViewComponentRegistryService.get(e.type),a=t.find(t=>t.componentModel.guid===e.parentGuid),s=o[e.parentGuid],l=a&&!a.componentModel.layout||s&&!s.layout,d={guid:e.guid||this.rxGuidService.generate(),type:e.type,parentGuid:e.parentGuid,propertiesByName:this.rxViewDesignerStateHelperService.getInitialComponentProperties(e.propertiesByName,r),permissions:this.rxViewDesignerStateHelperService.getDefaultComponentPermissions(r)};this.rxViewComponentRegistryService.isDataComponentDescriptor(r)||l?(d.resourceType=r.isContainerComponent?p.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent:p.RX_VIEW_DEFINITION.resourceTypes.viewComponent,i.push({componentModel:d})):(d.resourceType=r.outlets||r.isContainerComponent?p.RX_VIEW_DEFINITION.resourceTypes.containerViewComponent:p.RX_VIEW_DEFINITION.resourceTypes.viewComponent,r.outlets&&(d.layout=p.RxViewLayout.getEmptyViewLayoutForOutletNames(r.outlets)),t.push({componentModel:d,insertIndex:e.insertIndex,columnIndex:e.columnIndex||0,outletName:e.outletName||p.RX_VIEW_DEFINITION.defaultOutletName}),e.selectComponent&&n.push(d.guid)),(0,u.forEach)(e.children,e=>{this.processAddComponentPayload(Object.assign(Object.assign({},e),{parentGuid:d.guid}),t,i,n,o)})}}Ni.\u0275fac=function(e){return new(e||Ni)(n["\u0275\u0275inject"](v.Actions),n["\u0275\u0275inject"](n.Injector),n["\u0275\u0275inject"](Et),n["\u0275\u0275inject"](g.RxGuidService),n["\u0275\u0275inject"](y.Store),n["\u0275\u0275inject"](p.RxViewComponentRegistryService),n["\u0275\u0275inject"](Ce),n["\u0275\u0275inject"](Ti),n["\u0275\u0275inject"](Vi),n["\u0275\u0275inject"](be))},Ni.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Ni,factory:Ni.\u0275fac}),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],Ni.prototype,"initializeComponentModel$",void 0),(0,D.__decorate)([(0,v.Effect)({dispatch:!1}),(0,D.__metadata)("design:type",Object)],Ni.prototype,"registerComponentsValidation$",void 0),(0,D.__decorate)([(0,v.Effect)({dispatch:!1}),(0,D.__metadata)("design:type",Object)],Ni.prototype,"onComponentsRemoved$",void 0),(0,D.__decorate)([(0,v.Effect)({dispatch:!1}),(0,D.__metadata)("design:type",Object)],Ni.prototype,"unregisterAllComponentsValidation$",void 0),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],Ni.prototype,"insertComponent$",void 0),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],Ni.prototype,"addNewComponent$",void 0),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],Ni.prototype,"removeComponent$",void 0),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],Ni.prototype,"setChildren$",void 0);class ki{constructor(e,t,i,n,o,r,a,s,l,d,c,p,m,g,y,x,b,C,S,w,D,R,I,F){this.actions$=e,this.store$=t,this.rxBundleCacheService=i,this.rxDefinitionNameService=n,this.rxDefinitionUpdateService=o,this.rxGlobalCacheService=r,this.rxJsonParserService=a,this.rxViewComponentRegistryService=s,this.rxViewActionRegistryService=l,this.rxViewDefinitionService=d,this.viewDesignerModels=c,this.rxOldViewLayoutAdapterService=p,this.rxViewDefinitionParserService=m,this.rxLogService=g,this.rxModalService=y,this.errorHandler=x,this.rxUtilityModalsService=b,this.rxDefinitionAdapterRegistryService=C,this.rxViewDesignerInspectorService=S,this.rxViewDefinitionGeneratorService=w,this.rxViewDesignerStateHelperService=D,this.rxViewActionDefinitionAdapterRegistryService=R,this.rxGuidService=I,this.rxViewDataDictionaryStoreService=F,this.initViewDesigner$=this.actions$.pipe((0,v.ofType)(it),(0,h.switchMap)(({payload:e})=>{const{viewDefinitionName:t,layoutTemplate:i}=e;return this.clearStorages(),[Ze(),qe({viewDefinitionName:t,layoutTemplate:i})]})),this.destroyViewDesigner$=this.actions$.pipe((0,v.ofType)(nt),(0,h.tap)(()=>this.clearStorages())),this.loadFriendlyBundleName$=this.actions$.pipe((0,v.ofType)(Ze),(0,h.switchMap)(()=>this.rxGlobalCacheService.getBundleDescriptor(this.rxBundleCacheService.bundleId)),(0,h.switchMap)(e=>{let t;return t=e?(0,f.of)(Ue({friendlyBundleName:e.friendlyName})):(0,f.throwError)(`Bundle "${this.rxBundleCacheService.bundleId}" not found`),t.pipe((0,h.catchError)(e=>(this.errorHandler.handleError(e),(0,f.of)(ze({payload:e})))))})),this.loadViewDefinition$=this.actions$.pipe((0,v.ofType)(qe),(0,h.switchMap)(({viewDefinitionName:e,layoutTemplate:t})=>(e?this.rxViewDefinitionService.get(e):this.rxViewDefinitionService.getNew(t)).pipe((0,h.map)(e=>$e({viewDefinition:e})),(0,h.catchError)(e=>(this.errorHandler.handleError(e),(0,f.of)(Le())))))),this.viewDefinitionLoadSuccess$=this.actions$.pipe((0,v.ofType)($e),(0,h.withLatestFrom)(this.store$.select(at)),(0,h.mergeMap)(([e,t])=>t?this.getActionsToUpdateExistingViewModels(e.viewDefinition):this.getActionsToInitializeViewModels(e.viewDefinition))),this.selectViewComponent$=this.actions$.pipe((0,v.ofType)(Ae),(0,h.withLatestFrom)(this.store$.select(at),this.store$.select(Dt)),(0,h.mergeMap)(([e,t,i])=>{const n=t.guid===e.guid?0:1;return n!==i?[Je({tabId:n})]:[]})),this.generateViewDefinition$=this.actions$.pipe((0,v.ofType)(et),(0,h.withLatestFrom)(this.store$.select(at),this.store$.select(lt),(e,t,i)=>({viewModel:t,componentModels:i})),(0,h.map)(({viewModel:e,componentModels:t})=>this.rxViewDefinitionGeneratorService.generate(e,t)),(0,h.map)(e=>Ge({payload:e}))),this.saveViewDefinition$=this.actions$.pipe((0,v.ofType)(Ke),(0,h.withLatestFrom)(this.store$.select(at),this.store$.select(lt),(e,t,i)=>({viewModel:t,components:i})),(0,h.switchMap)(({viewModel:e,components:t})=>{const i=this.rxViewDefinitionGeneratorService.generate(e,t,!0);return(i.lastUpdateTime?this.rxDefinitionUpdateService.execute(this.rxViewDefinitionService.update.bind(this.rxViewDefinitionService,i.name,i)):this.rxViewDefinitionService.create(i)).pipe((0,h.switchMap)(e=>{const t=decodeURIComponent((0,u.last)(null==e?void 0:e.headers.get("Location").split("/"))||"")||i.name;return[_e({viewDefinitionName:t}),i.lastUpdateTime?qe({viewDefinitionName:i.name}):null].filter(Boolean)}),(0,h.catchError)(e=>(this.errorHandler.handleError(e),(0,f.of)(Be()))))})),this.clearCanvas$=this.actions$.pipe((0,v.ofType)(tt),(0,h.withLatestFrom)(this.store$.select(at)),(0,h.map)(([e,t])=>ke({guids:ve(t)}))),this.runPreview$=this.actions$.pipe((0,v.ofType)(Ye),(0,h.withLatestFrom)(this.store$.select(at),(e,t)=>t),(0,h.switchMap)(e=>e.targetViewDefinitionName?this.rxViewDefinitionService.get(e.targetViewDefinitionName):(0,f.of)(e)),(0,h.tap)(e=>{const t=encodeURIComponent(e.name);let i=`/helix/index.html#/${this.rxBundleCacheService.bundleId}/preview/${t}`;e.inputParams.length?this.rxModalService.openModal({title:"Enter view parameter values",content:si,data:{inputParams:(0,u.map)(e.inputParams,"name")},size:"sm"}).catch(f.noop).then(e=>{const t=(0,u.map)(e,(e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`);i+=`?${t.join("&")}`,e&&window.open(i)}):window.open(i)}))}clearStorages(){this.viewDesignerModels.clear(),this.rxViewDesignerInspectorService.clear(),this.rxViewDataDictionaryStoreService.clear()}convertViewDefinitionToModel(e){const t=Boolean(e.lastUpdateTime)&&!(0,u.includes)(e.layout,'"outlets"');this.rxViewDefinitionParserService.getComponents(e).forEach(e=>this.rxOldViewLayoutAdapterService.convertLayout(e));const i=(0,u.omit)(e,["componentDefinitions","layout"]),n=this.rxJsonParserService.tryParseJson(e.layout);return i.layout=p.RxViewLayout.getEmptyViewLayoutForOutlets(n.outlets),i.displayName=decodeURIComponent(this.rxDefinitionNameService.getDisplayName(i.name)),i.layoutName=p.RxViewLayout.getLayoutName(i.layout),i.isAngularJsView=t,i}convertComponentDefinitionToModel(e,t,i){const n=(0,u.omit)(e,["componentDefinitions","layout"]);if(n.parentGuid=t,this.processComponentDefinitionProperties(n,i),this.isComponentHasLayout(e)){const t=this.rxJsonParserService.tryParseJson(e.layout);n.layout=p.RxViewLayout.getEmptyViewLayoutForOutlets(t.outlets)}return n}processComponentDefinitionProperties(e,t){e.propertiesByName=(0,u.transform)(e.propertiesByName,(e,i,n)=>{const o=(0,u.find)(t.properties||t.parameters,{name:n});if(o&&o.designType)if(!0==(o.designType===p.ViewComponentPropertyType.String))e[n]=i;else e[n]=this.rxJsonParserService.tryParseJson(i,i);else e[n]=i;return e},{}),this.rxGuidService.isGuid(e.name)||(e.propertiesByName.name=e.name),"type"in t&&(e.propertiesByName=this.rxViewDesignerStateHelperService.getInitialComponentProperties(e.propertiesByName,t))}traverseByComponents(e,t){const i=this.rxJsonParserService.tryParseJson(e.layout),n=e.componentDefinitions;i&&i.outlets.forEach(i=>{i.columns.forEach((o,r)=>{o.children.forEach((a,s)=>{const l=n.find(e=>e.guid===a);l&&(t(l,e.guid,i.name,s,r,o.span),l.componentDefinitions&&this.traverseByComponents(l,t))})})}),n.filter(e=>{const t=this.rxViewComponentRegistryService.get(e.type);return(null==t?void 0:t.isDataComponent)||(null==t?void 0:t.isPageComponent)}).forEach((i,n)=>{t(i,e.guid,null,n,0,0),i.componentDefinitions&&this.traverseByComponents(i,t)})}isComponentHasLayout(e){return Boolean(e.layout)}getActionsToInitializeViewModels(e){const t=(0,u.cloneDeep)(e),i=this.convertViewDefinitionToModel(t),n=[],o=[];return this.traverseByComponents(t,(e,i,r,a,s,l)=>{const d=this.rxViewComponentRegistryService.get(e.type);if(d&&!d.isPageComponent){const c=e.type===p.RxViewComponentType.Action?this.rxViewActionDefinitionAdapterRegistryService.getDesignAdapter(e.propertiesByName.name):this.rxDefinitionAdapterRegistryService.getDesignAdapter(e.type);let m;null==c||c.adaptDefinition(e,t),e.type===p.RxViewComponentType.Action&&(m=this.rxViewActionRegistryService.get(e.propertiesByName.name),m||(m=this.rxViewActionRegistryService.registerUnknownAction(e.propertiesByName.name)));const u=this.convertComponentDefinitionToModel(e,i,m||d);this.rxViewComponentRegistryService.isDataComponentDescriptor(d)||null===r?o.push({componentModel:u}):n.push({insertIndex:a,columnIndex:s,componentModel:u,outletName:r,columnSpan:l})}else if(this.rxViewDefinitionService.isPageView(t)){let t=this.rxViewComponentRegistryService.get(e.type);t||(t={type:e.type,name:p.RX_VIEW_DEFINITION.unknownPageComponent.name});const n=this.convertComponentDefinitionToModel(e,i,t);o.push({componentModel:n})}else{const t=Object.assign(Object.assign({},this.rxViewComponentRegistryService.get(p.RxViewComponentType.Unknown)),{type:e.type});this.rxViewComponentRegistryService.registerSync(t);const o=this.convertComponentDefinitionToModel(e,i,t);n.push({insertIndex:a,columnIndex:s,componentModel:o,outletName:r,columnSpan:l}),this.rxLogService.warning(`Cannot initialize view component. View Component Descriptor for ${e.type} not found.`)}}),[Qe({payload:i}),n.length?we({payload:n}):null,o.length?De({payload:o}):null,n.length?null:Xe()].filter(Boolean)}getActionsToUpdateExistingViewModels(e){const t=(0,u.cloneDeep)(e),i=this.rxViewDefinitionParserService.getComponents(t,!0).map(({componentDefinition:e})=>({guid:e.guid,partialModel:(0,u.omit)(e,["layout","propertiesByName","componentDefinitions"])}));return[He({payload:(0,u.omit)(t,["layout","componentDefinitions"])}),i.length?Ne({payload:i}):null,We()].filter(Boolean)}}function ji(){return null}ki.\u0275fac=function(e){return new(e||ki)(n["\u0275\u0275inject"](v.Actions),n["\u0275\u0275inject"](y.Store),n["\u0275\u0275inject"](l.RxBundleCacheService),n["\u0275\u0275inject"](l.RxDefinitionNameService),n["\u0275\u0275inject"](l.RxDefinitionUpdateService),n["\u0275\u0275inject"](l.RxGlobalCacheService),n["\u0275\u0275inject"](g.RxJsonParserService),n["\u0275\u0275inject"](p.RxViewComponentRegistryService),n["\u0275\u0275inject"](p.RxViewActionRegistryService),n["\u0275\u0275inject"](p.RxViewDefinitionService),n["\u0275\u0275inject"](Et),n["\u0275\u0275inject"](p.RxOldViewLayoutAdapterService),n["\u0275\u0275inject"](p.RxViewDefinitionParserService),n["\u0275\u0275inject"](l.RxLogService),n["\u0275\u0275inject"](c.RxModalService),n["\u0275\u0275inject"](n.ErrorHandler),n["\u0275\u0275inject"](c.RxUtilityModalsService),n["\u0275\u0275inject"](l.RxDefinitionAdapterRegistryService),n["\u0275\u0275inject"](Ce),n["\u0275\u0275inject"](Mt),n["\u0275\u0275inject"](Vi),n["\u0275\u0275inject"](p.RxViewActionDefinitionAdapterRegistryService),n["\u0275\u0275inject"](g.RxGuidService),n["\u0275\u0275inject"](be))},ki.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ki,factory:ki.\u0275fac}),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],ki.prototype,"initViewDesigner$",void 0),(0,D.__decorate)([(0,v.Effect)({dispatch:!1}),(0,D.__metadata)("design:type",Object)],ki.prototype,"destroyViewDesigner$",void 0),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],ki.prototype,"loadFriendlyBundleName$",void 0),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],ki.prototype,"loadViewDefinition$",void 0),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],ki.prototype,"viewDefinitionLoadSuccess$",void 0),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],ki.prototype,"selectViewComponent$",void 0),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],ki.prototype,"generateViewDefinition$",void 0),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],ki.prototype,"saveViewDefinition$",void 0),(0,D.__decorate)([(0,v.Effect)(),(0,D.__metadata)("design:type",Object)],ki.prototype,"clearCanvas$",void 0),(0,D.__decorate)([(0,v.Effect)({dispatch:!1}),(0,D.__metadata)("design:type",Object)],ki.prototype,"runPreview$",void 0);const _i=(0,y.createReducer)(null,(0,y.on)(it,ji),(0,y.on)(nt,ji),(0,y.on)(Ge,(e,{payload:t})=>t));function Bi(e,t){return _i(e,t)}function $i(){return{}}const Li=(0,y.createReducer)({},(0,y.on)(it,$i),(0,y.on)(nt,$i),(0,y.on)(Me,(e,{guid:t,label:i})=>Object.assign(Object.assign({},e),{[t]:i})),(0,y.on)(Se,(e,{guids:t})=>{let i=e;return t.some(t=>(0,u.has)(e,t))&&(i=(0,u.omit)(e,t)),i}));function Gi(e,t){return Li(e,t)}function qi(){return{viewDesignModel:null,viewComponentDesignModels:{}}}const Ui=(0,y.createReducer)({viewDesignModel:null,viewComponentDesignModels:{}},(0,y.on)(it,qi),(0,y.on)(nt,qi),(0,y.on)(we,(e,{payload:t})=>{const i=Object.assign({},e);return t.forEach(e=>function(e,t){if(e.viewComponentDesignModels=Object.assign(Object.assign({},e.viewComponentDesignModels),{[t.componentModel.guid]:t.componentModel}),t.componentModel.parentGuid===e.viewDesignModel.guid)e.viewDesignModel=he(e.viewDesignModel,t.componentModel.guid,t.outletName,t.insertIndex,t.columnIndex,t.columnSpan);else{const i=e.viewComponentDesignModels[t.componentModel.parentGuid];if(i){const n=he(i,t.componentModel.guid,t.outletName,t.insertIndex,t.columnIndex,t.columnSpan);e.viewComponentDesignModels[n.guid]=n}}}(i,e)),i}),(0,y.on)(De,(e,{payload:t})=>{const i=Object.assign(Object.assign({},e),{viewComponentDesignModels:Object.assign({},e.viewComponentDesignModels)});return t.forEach(e=>{const t=i.viewComponentDesignModels[e.componentModel.parentGuid];if(t){i.viewComponentDesignModels[e.componentModel.guid]=e.componentModel;const n=Object.assign(Object.assign({},t),{childDataComponentGuids:[...t.childDataComponentGuids||[],e.componentModel.guid]});i.viewComponentDesignModels[n.guid]=n}}),i}),(0,y.on)(Pe,(e,t)=>{const i=Object.assign({},e);if(fe(t.guid,e.viewDesignModel))i.viewDesignModel=ge(t.guid,i.viewDesignModel);else{let e=me(t.guid,i.viewComponentDesignModels);e=ge(t.guid,e),i.viewComponentDesignModels=Object.assign(Object.assign({},i.viewComponentDesignModels),{[e.guid]:e})}if(t.parentGuid===i.viewDesignModel.guid)i.viewDesignModel=he(i.viewDesignModel,t.guid,t.outletName,t.insertIndex,t.columnIndex);else{let e=i.viewComponentDesignModels[t.parentGuid];e=he(e,t.guid,t.outletName,t.insertIndex,t.columnIndex),i.viewComponentDesignModels=Object.assign(Object.assign({},i.viewComponentDesignModels),{[e.guid]:e})}return i.viewComponentDesignModels=Object.assign(Object.assign({},i.viewComponentDesignModels),{[t.guid]:Object.assign(Object.assign({},i.viewComponentDesignModels[t.guid]),{parentGuid:t.parentGuid})}),i}),(0,y.on)(Se,(e,{guids:t})=>{const i=Object.assign(Object.assign({},e),{viewComponentDesignModels:(0,u.omit)(e.viewComponentDesignModels,t)});return t.forEach(t=>{if(fe(t,e.viewDesignModel))i.viewDesignModel=ge(t,i.viewDesignModel);else{let n=me(t,e.viewComponentDesignModels);n&&i.viewComponentDesignModels[n.guid]&&(n=ge(t,i.viewComponentDesignModels[n.guid]),i.viewComponentDesignModels=Object.assign(Object.assign({},i.viewComponentDesignModels),{[n.guid]:n}))}}),i}),(0,y.on)(Oe,(e,{guid:t,cols:i})=>{const n=e.viewComponentDesignModels[t],o=n.layout.outlets.find(e=>e.name===p.RX_VIEW_DEFINITION.defaultOutletName),r=(0,u.cloneDeep)(o.columns),a=r.splice(i.length);i.forEach((e,t)=>{r[t]?r[t].span=e:r[t]={span:e,children:[]}});const s=a.reduce((e,t)=>(e.push(...t.children),e),[]);if(s.length){const e=(0,u.last)(r);e.children=e.children.concat(s)}return Object.assign(Object.assign({},e),{viewComponentDesignModels:Object.assign(Object.assign({},e.viewComponentDesignModels),{[t]:Object.assign(Object.assign({},n),{layout:Object.assign(Object.assign({},n.layout),{outlets:n.layout.outlets.map(e=>Object.assign(Object.assign({},e),{columns:r}))})})})})}),(0,y.on)(Qe,(e,{payload:t})=>Object.assign(Object.assign({},e),{viewDesignModel:t})),(0,y.on)(He,(e,{payload:t})=>Object.assign(Object.assign({},e),{viewDesignModel:Object.assign(Object.assign({},e.viewDesignModel),t)})),(0,y.on)(_e,e=>e.viewDesignModel.isAngularJsView?Object.assign(Object.assign({},e),{viewDesignModel:Object.assign(Object.assign({},e.viewDesignModel),{isAngularJsView:!1})}):e),(0,y.on)(Fe,(e,{payload:t})=>Object.assign(Object.assign({},e),{viewComponentDesignModels:Object.assign(Object.assign({},e.viewComponentDesignModels),t.reduce((t,{guid:i,data:n})=>(t[i]=Object.assign(Object.assign({},e.viewComponentDesignModels[i]),{propertiesByName:n}),t),{}))})),(0,y.on)(Ne,(e,{payload:t})=>Object.assign(Object.assign({},e),{viewComponentDesignModels:Object.assign(Object.assign({},e.viewComponentDesignModels),t.filter(t=>e.viewComponentDesignModels[t.guid]).reduce((t,{guid:i,partialModel:n})=>(t[i]=Object.assign(Object.assign(Object.assign({},e.viewComponentDesignModels[i]),n),{propertiesByName:Object.assign(Object.assign({},e.viewComponentDesignModels[i].propertiesByName),n.propertiesByName)}),t),{}))})));function zi(e,t){return Ui(e,t)}function Xi(){return{selectedComponentGuid:null,selectedInspectorTabId:0,currentBundleId:null,isViewDefinitionLoading:!1,areViewModelsReady:!1,friendlyBundleName:null}}const Wi=(0,y.createReducer)({selectedComponentGuid:null,selectedInspectorTabId:0,currentBundleId:null,isViewDefinitionLoading:!1,areViewModelsReady:!1,friendlyBundleName:null},(0,y.on)(it,(e,{payload:t})=>Object.assign(Object.assign({},{selectedComponentGuid:null,selectedInspectorTabId:0,currentBundleId:null,isViewDefinitionLoading:!1,areViewModelsReady:!1,friendlyBundleName:null}),{currentBundleId:t.bundleId})),(0,y.on)(nt,Xi),(0,y.on)(Ae,(e,{guid:t})=>Object.assign(Object.assign({},e),{selectedComponentGuid:t})),(0,y.on)(Je,(e,{tabId:t})=>Object.assign(Object.assign({},e),{selectedInspectorTabId:t})),(0,y.on)(Se,(e,{guids:t})=>t.includes(e.selectedComponentGuid)?Object.assign(Object.assign({},e),{selectedComponentGuid:null}):Object.assign({},e)),(0,y.on)(Ue,(e,{friendlyBundleName:t})=>Object.assign(Object.assign({},e),{friendlyBundleName:t})),(0,y.on)(ze,e=>Object.assign(Object.assign({},e),{friendlyBundleName:null})),(0,y.on)(Ke,qe,e=>Object.assign(Object.assign({},e),{isViewDefinitionLoading:!0,areViewModelsReady:!1})),(0,y.on)(_e,$e,Le,e=>Object.assign(Object.assign({},e),{isViewDefinitionLoading:!1})),(0,y.on)(Be,e=>Object.assign(Object.assign({},e),{isViewDefinitionLoading:!1,areViewModelsReady:!0})),(0,y.on)(We,Xe,e=>Object.assign(Object.assign({},e),{areViewModelsReady:!0})),(0,y.on)(we,e=>Object.assign(Object.assign({},e),{areViewModelsReady:!1})));function Hi(e,t){return Wi(e,t)}function Qi(){return{issues:{},expressionIssues:{}}}const Ji=(0,y.createReducer)({issues:{},expressionIssues:{}},(0,y.on)(it,nt,Qi),(0,y.on)(Re,(e,{guid:t,issues:i})=>{if(i.length)return Object.assign(Object.assign({},e),{issues:Object.assign(Object.assign({},e.issues),{[t]:i})});{let i=e;return(0,u.has)(i.issues,t)&&(i=Object.assign(Object.assign({},e),{issues:(0,u.omit)(e.issues,[t])})),i}}),(0,y.on)(Ie,(e,{issues:t})=>(0,u.isEmpty)(t)?e:Object.assign(Object.assign({},e),{expressionIssues:Object.assign(Object.assign({},(0,u.omit)(e.expressionIssues,Object.keys(t))),(0,u.omitBy)(t,u.isEmpty))})),(0,y.on)(Se,(e,{guids:t})=>{let i=e;return t.some(t=>(0,u.has)(e.issues,t))&&(i=Object.assign(Object.assign({},e),{issues:(0,u.omit)(e.issues,t)})),t.some(t=>(0,u.has)(e.expressionIssues,t))&&(i=Object.assign(Object.assign({},e),{expressionIssues:(0,u.omit)(e.expressionIssues,t)})),i}));function Ki(e,t){return Ji(e,t)}class Yi{}Yi.\u0275fac=function(e){return new(e||Yi)},Yi.\u0275mod=n["\u0275\u0275defineNgModule"]({type:Yi,declarations:[ni],imports:[b.CommonModule,S.AdaptCodeViewerModule,S.AdaptTabsModule,c.RxBladeModule,d.RxFormBuilderModule,c.RxValidationIssuesModule,c.RxJsonViewerModule,ai,oi,ri,d.FormControlsModule,d.RxPermissionEditorModule,d.RxRevertCustomizationModule,p.ViewActionDesignModule,li,d.RxDesignerHeaderModule,S.AdaptAlertModule,d.RxInspectorModule,Ci,$t,m.TranslateModule,y.StoreFeatureModule,v.EffectsFeatureModule],exports:[ni]}),Yi.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[b.CommonModule,S.AdaptCodeViewerModule,S.AdaptTabsModule.forRoot(),c.RxBladeModule,d.RxFormBuilderModule,c.RxValidationIssuesModule,c.RxJsonViewerModule,ai,oi,ri,d.FormControlsModule,d.RxPermissionEditorModule,d.RxRevertCustomizationModule,p.ViewActionDesignModule,li,d.RxDesignerHeaderModule,S.AdaptAlertModule,d.RxInspectorModule,Ci,$t,m.TranslateModule,y.StoreModule.forFeature("viewDesigner",{model:zi,viewDefinition:Bi,validation:Ki,ui:Hi,breadcrumbs:Gi}),v.EffectsModule.forFeature([ki,Ni])]]})},"./node_modules/@helix/platform/fesm2015/helix-platform-view-runtime-page.js":(e,t,i)=>{"use strict";i.r(t),i.d(t,{ViewRuntimePageComponent:()=>b,ViewRuntimePageModule:()=>w});var n=i("./node_modules/@angular/common/fesm2015/common.js"),o=i("./node_modules/@angular/core/fesm2015/core.js"),r=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-actions.js"),a=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-components.js"),s=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-runtime.js"),l=i("./node_modules/@ngx-translate/core/fesm2015/ngx-translate-core.js"),d=i("./node_modules/@angular/router/fesm2015/router.js"),c=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-api.js"),p=i("rxjs"),m=i("./node_modules/rxjs/_esm2015/operators/index.js"),u=i("lodash"),f=i("./node_modules/@helix/platform/fesm2015/helix-platform-utils.js"),h=i("./node_modules/@helix/platform/fesm2015/helix-platform-ui-kit.js"),g=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-components.js"),v=i("./node_modules/@helix/platform/fesm2015/helix-platform-approval-components.js"),y=i("./node_modules/@helix/platform/fesm2015/helix-platform-dataload-components.js");function x(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"rx-runtime-view",1),o["\u0275\u0275listener"]("cancelView",function(){o["\u0275\u0275restoreView"](e);return o["\u0275\u0275nextContext"]().onCancelView()})("closeView",function(t){o["\u0275\u0275restoreView"](e);return o["\u0275\u0275nextContext"]().onCloseView(t)}),o["\u0275\u0275elementEnd"]()}if(2&e){const e=o["\u0275\u0275nextContext"]();o["\u0275\u0275property"]("configuration",e.configuration)}}class b{constructor(e,t,i,n,o,r,a,s,l,d){this.route=e,this.rxDefinitionNameService=t,this.rxPageTitleService=i,this.rxPreviousStateService=n,this.rxComponentCanDeactivateGuard=o,this.rxUtilityModalsService=r,this.rxRuntimeViewRegistryService=a,this.rxIframeUtilsService=s,this.rxGainsightConfiguratorService=l,this.rxFeatureService=d,this.showRuntimeView=!0,this.currentRoute={bundleId:"",viewDefinitionName:"",inputParams:null}}ngOnInit(){this.rxComponentCanDeactivateGuard.setPageComponent(this),this.rxIframeUtilsService.isRunningInIframe()&&this.rxFeatureService.isFeatureEnabled("DRD21-11744")&&this.rxGainsightConfiguratorService.gainsightInitConfiguration$.pipe((0,m.take)(1)).subscribe(),this.subscription=(0,p.combineLatest)([this.route.params.pipe((0,m.pluck)("bundleId")),this.route.params.pipe((0,m.pluck)("viewDefinitionName")),this.route.queryParams]).pipe((0,m.distinctUntilChanged)(u.isEqual)).subscribe(([e,t,i])=>{this.currentRoute.bundleId!==e||this.currentRoute.viewDefinitionName!==t||(0,u.isEqual)(this.currentRoute.inputParams,i)||(this.showRuntimeView=!1,setTimeout(()=>this.showRuntimeView=!0)),this.currentRoute.bundleId=e,this.currentRoute.viewDefinitionName=t,this.currentRoute.inputParams=i,this.updateConfig({viewDefinitionName:t,inputParams:i}),this.rxPageTitleService.set(this.rxDefinitionNameService.getDisplayName(t)),this.rxGainsightConfiguratorService.updateGlobalContext(null,t)})}ngOnDestroy(){this.subscription.unsubscribe(),this.rxComponentCanDeactivateGuard.setPageComponent(null)}canDeactivate(){return(0,u.every)(this.rxRuntimeViewRegistryService.getAll(),e=>e.canClose())}confirmDeactivation(){return this.rxUtilityModalsService.confirmUnsavedChanges()}onCancelView(){this.rxComponentCanDeactivateGuard.disable(),this.onCloseOrCancel({actionName:s.RX_RUNTIME_VIEW.actions.cancel})}onCloseView(e){this.onCloseOrCancel({actionName:s.RX_RUNTIME_VIEW.actions.close,outputParams:e})}onCloseOrCancel(e){this.rxIframeUtilsService.isRunningInIframe()?this.rxIframeUtilsService.postMessageToHost(e):this.rxPreviousStateService.goToPrevState()}onRegisterApi(e){this.runtimeViewApi=e}updateConfig(e){this.configuration=Object.assign(Object.assign(Object.assign({},this.configuration),e),{onRegisterApi:this.onRegisterApi.bind(this)})}}b.\u0275fac=function(e){return new(e||b)(o["\u0275\u0275directiveInject"](d.ActivatedRoute),o["\u0275\u0275directiveInject"](c.RxDefinitionNameService),o["\u0275\u0275directiveInject"](c.RxPageTitleService),o["\u0275\u0275directiveInject"](c.RxPreviousStateService),o["\u0275\u0275directiveInject"](c.RxComponentCanDeactivateGuard),o["\u0275\u0275directiveInject"](h.RxUtilityModalsService),o["\u0275\u0275directiveInject"](s.RxRuntimeViewRegistryService),o["\u0275\u0275directiveInject"](f.RxIframeUtilsService),o["\u0275\u0275directiveInject"](g.RxGainsightConfiguratorService),o["\u0275\u0275directiveInject"](c.RxFeatureService))},b.\u0275cmp=o["\u0275\u0275defineComponent"]({type:b,selectors:[["rx-view-runtime-page"]],decls:1,vars:1,consts:[[3,"configuration","cancelView","closeView",4,"ngIf"],[3,"configuration","cancelView","closeView"]],template:function(e,t){1&e&&o["\u0275\u0275template"](0,x,1,1,"rx-runtime-view",0),2&e&&o["\u0275\u0275property"]("ngIf",t.showRuntimeView)},directives:[n.NgIf,s.RuntimeViewComponent],encapsulation:2});const C=[{path:"",component:b,pathMatch:"full"}];class S{}S.\u0275fac=function(e){return new(e||S)},S.\u0275mod=o["\u0275\u0275defineNgModule"]({type:S,imports:[d.RouterModule],exports:[d.RouterModule]}),S.\u0275inj=o["\u0275\u0275defineInjector"]({imports:[[d.RouterModule.forChild(C)],d.RouterModule]});class w{}w.\u0275fac=function(e){return new(e||w)},w.\u0275mod=o["\u0275\u0275defineNgModule"]({type:w,declarations:[b],imports:[n.CommonModule,l.TranslateModule,S,s.RuntimeViewModule,a.ViewComponentsModule,r.ViewActionsModule,v.ApprovalConsoleModule,y.DataloadModule]}),w.\u0275inj=o["\u0275\u0275defineInjector"]({imports:[[n.CommonModule,l.TranslateModule,S,s.RuntimeViewModule,a.ViewComponentsModule,r.ViewActionsModule,v.ApprovalConsoleModule,y.DataloadModule]]})},"./node_modules/@helix/platform/fesm2015/helix-platform-view-runtime.js":(e,t,i)=>{"use strict";i.r(t),i.d(t,{BaseViewComponent:()=>ae,RX_RUNTIME_VIEW:()=>ce,RuntimeLayoutItem:()=>q,RuntimeLayoutOutlet:()=>G,RuntimeLayoutOutletColumn:()=>L,RuntimeViewCanvasComponent:()=>oe,RuntimeViewCanvasItemComponent:()=>X,RuntimeViewCanvasItemContainerComponent:()=>W,RuntimeViewCanvasItemService:()=>z,RuntimeViewCanvasModule:()=>le,RuntimeViewCanvasOutletComponent:()=>se,RuntimeViewComponent:()=>re,RuntimeViewModalComponent:()=>de,RuntimeViewModel:()=>ie,RuntimeViewModelApi:()=>J,RuntimeViewModule:()=>pe,RuntimeViewRootComponent:()=>H,RxRuntimeViewRegistryService:()=>ne,RxRuntimeViewUtilsService:()=>ee,VIEW_COMPONENT_DEFAULT_EVENT_NAME:()=>Z,ViewComponentEventManager:()=>Y});var n=i("./node_modules/@angular/core/fesm2015/core.js"),o=i("rxjs"),r=i("./node_modules/rxjs/_esm2015/operators/index.js"),a=i("./node_modules/@helix/platform/fesm2015/helix-platform-record-api.js"),s=i("./node_modules/@helix/platform/fesm2015/helix-platform-view-api.js"),l=i("./node_modules/@helix/platform/fesm2015/helix-platform-utils.js"),d=i("lodash"),c=i("./node_modules/@angular/common/fesm2015/common.js"),p=i("./node_modules/@helix/platform/fesm2015/helix-platform-shared-api.js"),m=i("./node_modules/@helix/platform/fesm2015/helix-platform-ui-kit.js"),u=i("./node_modules/@helix/platform/fesm2015/helix-platform-association-api.js"),f=i("./node_modules/@helix/platform/fesm2015/helix-platform-process-api.js"),h=i("./node_modules/@angular/forms/fesm2015/forms.js"),g=i("./node_modules/@ngx-translate/core/fesm2015/ngx-translate-core.js"),v=i("./node_modules/@bmc-ux/adapt-angular/fesm2015/bmc-ux-adapt-angular.js");const y=["container"];function x(e,t){1&e&&n["\u0275\u0275elementContainer"](0)}const b=function(e){return{$implicit:e}};function C(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",4),n["\u0275\u0275template"](1,x,1,0,"ng-container",5),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275nextContext"](2);const i=n["\u0275\u0275reference"](3);n["\u0275\u0275property"]("ngClass",e.cssClass?e.cssClass:e.span?"col-"+e.span:"col"),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngTemplateOutlet",i)("ngTemplateOutletContext",n["\u0275\u0275pureFunction1"](3,b,e.children))}}function S(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275elementStart"](1,"div",2),n["\u0275\u0275template"](2,C,2,5,"div",3),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngForOf",e.columns)}}function w(e,t){1&e&&n["\u0275\u0275elementContainer"](0)}function D(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,w,1,0,"ng-container",5),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](3);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",n["\u0275\u0275pureFunction1"](2,b,e.columns[0].children))}}function R(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-runtime-view-canvas-item",7,8),2&e){const e=t.$implicit;n["\u0275\u0275property"]("layout",e)}}function I(e,t){if(1&e&&n["\u0275\u0275template"](0,R,2,1,"rx-runtime-view-canvas-item",6),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("ngForOf",e)("ngForTrackBy",i.trackByFn)}}const F=function(e,t,i){return[e,t,i]},E=function(e,t){return{"content-outlet":e,"outlet-padding":t}};function M(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-runtime-view-canvas-item-container",1),2&e){const e=t.$implicit,i=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("hidden",i.isHidden(e))("columns",e.columns)("outlet",e)("ngClass",n["\u0275\u0275pureFunction2"](8,E,e.name===i.defaultOutletName,n["\u0275\u0275pureFunction3"](4,F,i.layoutRole.Header,i.layoutRole.Footer,i.defaultOutletName).includes(e.name)))}}function A(e,t){if(1&e&&n["\u0275\u0275element"](0,"rx-runtime-view-canvas-item",1),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("layout",e.layout)}}function O(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"rx-runtime-view-canvas",1),n["\u0275\u0275listener"]("componentPropertyChanged",function(t){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"]().runtimeViewModel.onViewComponentPropertyChanged(t)}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("layout",e.runtimeViewLayoutService.layout)}}function P(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",11),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](3).closeModal()}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](3);n["\u0275\u0275attribute"]("aria-label",e.closeLabel)}}function T(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",8),n["\u0275\u0275elementStart"](1,"span",9),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](3,P,1,1,"button",10),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.title),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isCancellable)}}function V(e,t){if(1&e&&(n["\u0275\u0275elementContainerStart"](0),n["\u0275\u0275template"](1,T,4,2,"div",7),n["\u0275\u0275elementContainerEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](),t=n["\u0275\u0275reference"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isBlade)("ngIfElse",t)}}function N(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",11),n["\u0275\u0275listener"]("click",function(){n["\u0275\u0275restoreView"](e);return n["\u0275\u0275nextContext"](2).closeModal()}),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275attribute"]("aria-label",e.closeLabel)}}function k(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",12),n["\u0275\u0275elementStart"](1,"h5",13),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275template"](3,N,1,1,"button",10),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate"](e.title),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.isCancellable)}}const j=function(e){return{content:e,type:"inline",variant:"info"}};function _(e,t){if(1&e&&n["\u0275\u0275element"](0,"adapt-alert",14),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275property"]("config",n["\u0275\u0275pureFunction1"](1,j,e.notification))}}const B=function(e,t){return{"modal-body p-0":e,"dp-content":t}},$=function(e){return{busy:e,loaderType:"lineLoader",delay:250,backdrop:!1,message:null}};class L{constructor(){this.children=[]}}class G{constructor(){this.children=[],this.columns=[new L],this.height=null}}class q{constructor(e){this.outlets=[],this.parent=null,this.runtimeViewModelApi=null,Object.assign(this,{guid:e.guid,config:e.config,parent:e.parent,runtimeViewModelApi:e.runtimeViewModelApi,factory:e.factory}),e.outlets&&this.initializeOutlets(e.outlets)}initializeOutlets(e){e.forEach(e=>{const t=new G;t.name=e.name,t.height=e.hasOwnProperty("height")?e.height:null,this.outlets.push(t)})}addLayoutItem(e,t){const i=this.outlets.find(e=>e.name===t.parentOutlet.name),n=t.parentOutlet.columns[t.columnIndex].children.indexOf(e.guid);t.parentOutlet.columns.forEach((e,t)=>{i.columns[t]||(i.columns[t]=new L),e.cssClass&&(i.columns[t].cssClass=e.cssClass),e.span&&(i.columns[t].span=e.span)}),e&&(i.columns[t.columnIndex].children[n]=e)}}class U{constructor(){this.componentPropertyChangedSubject=new o.Subject,this.componentPropertyChanged$=this.componentPropertyChangedSubject.asObservable()}onViewComponentPropertyChanged(e){this.componentPropertyChangedSubject.next(e)}}U.\u0275fac=function(e){return new(e||U)},U.\u0275prov=n["\u0275\u0275defineInjectable"]({token:U,factory:U.\u0275fac});class z{constructor(e,t,i){this.injector=e,this.componentFactoryResolver=t,this.runtimeViewCanvasService=i,this.hasMargin=!0,this.hasAutoFill=!1,this.hasAutoScroll=!1,this.isHidden=!1,this.destroyed$=new o.ReplaySubject(1)}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}registerOutlet(e,t,i){const n=this.layout.outlets.find(t=>t.name===e);n&&this.renderContainerComponent(t,n,i)}getChildren(e){return this.layout.outlets.find(t=>t.name===e).columns.map(e=>Object.assign(Object.assign({},e),{children:e.children.filter(Boolean).map(e=>(0,d.pick)(e,"config","guid","runtimeViewModelApi","factory","outlets"))}))}renderViewComponent(){var e,t,i,n;this.componentRef=this.container.createComponent(this.layout.factory,null,this.injector),this.componentInstance=this.componentRef.instance,this.componentInstance.guid=this.layout.guid,this.componentInstance.config=this.layout.config,this.componentInstance.runtimeViewModelApi=this.layout.runtimeViewModelApi,null===(e=this.componentInstance.propertyChanged)||void 0===e||e.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.runtimeViewCanvasService.onViewComponentPropertyChanged(e)}),null===(t=this.componentInstance.hidden)||void 0===t||t.pipe((0,r.skipWhile)(e=>!e),(0,r.distinctUntilChanged)(),(0,r.delay)(0),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.hasMargin=!e,this.isHidden=e}),null===(i=this.componentInstance.autoScroll)||void 0===i||i.pipe((0,r.skipWhile)(e=>!e),(0,r.distinctUntilChanged)(),(0,r.delay)(0),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.hasAutoScroll=e}),null===(n=this.componentInstance.autoFill)||void 0===n||n.pipe((0,r.skipWhile)(e=>!e),(0,r.distinctUntilChanged)(),(0,r.delay)(0),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.hasAutoFill=e})}renderContainerComponent(e,t,i){const n=i,o=e.createComponent(n);o.instance.columns=t.columns,o.instance.outlet=t}}z.\u0275fac=function(e){return new(e||z)(n["\u0275\u0275inject"](n.Injector),n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](U))},z.\u0275prov=n["\u0275\u0275defineInjectable"]({token:z,factory:z.\u0275fac});class X{constructor(e){this.runtimeViewCanvasItemService=e}get hasMargin(){return this.runtimeViewCanvasItemService.hasMargin}get hasAutoFill(){return this.runtimeViewCanvasItemService.hasAutoFill&&!this.runtimeViewCanvasItemService.isHidden}get hasAutoScroll(){return this.runtimeViewCanvasItemService.hasAutoScroll}ngOnChanges(e){this.runtimeViewCanvasItemService.container||(this.runtimeViewCanvasItemService.container=this.container),e.layout.currentValue&&(this.runtimeViewCanvasItemService.layout=e.layout.currentValue,e.layout.previousValue&&this.container.clear(),this.runtimeViewCanvasItemService.renderViewComponent())}registerOutlet(e,t){this.runtimeViewCanvasItemService.registerOutlet(e,t)}getChildren(e){return this.runtimeViewCanvasItemService.getChildren(e)}}X.\u0275fac=function(e){return new(e||X)(n["\u0275\u0275directiveInject"](z))},X.\u0275cmp=n["\u0275\u0275defineComponent"]({type:X,selectors:[["rx-runtime-view-canvas-item"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](y,7,n.ViewContainerRef),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.container=e.first)}},hostVars:6,hostBindings:function(e,t){2&e&&n["\u0275\u0275classProp"]("rx-runtime-view-canvas-item-margin",t.hasMargin)("rx-runtime-view-canvas-item-auto-fill",t.hasAutoFill)("rx-runtime-view-canvas-item-auto-scroll",t.hasAutoScroll)},inputs:{layout:"layout"},features:[n["\u0275\u0275ProvidersFeature"]([z]),n["\u0275\u0275NgOnChangesFeature"]],decls:2,vars:0,consts:[["container",""]],template:function(e,t){1&e&&n["\u0275\u0275elementContainer"](0,null,0)},encapsulation:2});class W{constructor(){this.columns=[]}get hostClass(){return this.outlet.height?`${this.outlet.height}px`:null}trackByFn(e,t){return(null==t?void 0:t.guid)||e}}W.\u0275fac=function(e){return new(e||W)},W.\u0275cmp=n["\u0275\u0275defineComponent"]({type:W,selectors:[["rx-runtime-view-canvas-item-container"]],hostVars:2,hostBindings:function(e,t){2&e&&n["\u0275\u0275styleProp"]("min-height",t.hostClass)},inputs:{columns:"columns",outlet:"outlet"},decls:4,vars:2,consts:[[4,"ngIf"],["itemTpl",""],[1,"row","rx-runtime-view-canvas-item-container-row"],["class","rx-runtime-view-canvas-item-container-column",3,"ngClass",4,"ngFor","ngForOf"],[1,"rx-runtime-view-canvas-item-container-column",3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"layout",4,"ngFor","ngForOf","ngForTrackBy"],[3,"layout"],["item",""]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,S,3,1,"ng-container",0),n["\u0275\u0275template"](1,D,2,4,"ng-container",0),n["\u0275\u0275template"](2,I,1,2,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"])),2&e&&(n["\u0275\u0275property"]("ngIf",t.columns.length>1),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",1===t.columns.length))},directives:[c.NgIf,c.NgForOf,c.NgClass,c.NgTemplateOutlet,X],styles:['[_ngcontent-%COMP%]:root{--border-radius: 4px;--nav-background: var(--gray-900);--nav-links-color: var(--white);--font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;--color-primary-disabled-hover: #ff8d2a;--color-primary-disabled: #ff7d18;--color-primary: #f86e00;--color-primary-hover: #e45f00;--color-primary-active: #d05100;--color-primary-active-hover: #bc4300;--color-secondary-disabled-hover: #ffffff;--color-secondary-disabled: #ffffff;--color-secondary: #f9f9fa;--color-secondary-hover: #e5e5e6;--color-secondary-active: #d2d2d3;--color-secondary-active-hover: #c0c0c2;--color-active-disabled-hover: #45c8bd;--color-active-disabled: #2db7ad;--color-active: #00a79d;--color-active-hover: #00978e;--color-active-active: #00887f;--color-active-active-hover: #007970;--color-info-disabled-hover: #66d9f1;--color-info-disabled: #52c7df;--color-info: #3cb6ce;--color-info-hover: #21a6bd;--color-info-active: #0096ad;--color-info-active-hover: #00879e;--color-success-disabled-hover: #aae860;--color-success-disabled: #99d550;--color-success: #89c341;--color-success-hover: #7ab232;--color-success-active: #6ba122;--color-success-active-hover: #5d9110;--color-warning-disabled-hover: #ffda46;--color-warning-disabled: #ffc734;--color-warning: #f1b521;--color-warning-hover: #dea406;--color-warning-active: #cc9400;--color-warning-active-hover: #ba8400;--color-danger-disabled-hover: #ff5323;--color-danger-disabled: #ff4313;--color-danger: #f83200;--color-danger-hover: #e31f00;--color-danger-active: #cd0500;--color-danger-active-hover: #b80000;--dense-spacing-custom: false;--table-scroll-width: 0}rx-runtime-view-canvas-item[_ngcontent-%COMP%]{display:block}  .rx-runtime-view-canvas-item-margin:not(:last-child){margin-bottom:1rem}.rx-runtime-view-canvas-item-auto-fill[_ngcontent-%COMP%], .rx-runtime-view-canvas-item-container-row[_ngcontent-%COMP%], .rx-runtime-view-canvas-item-container-column[_ngcontent-%COMP%]{height:100%}.rx-runtime-view-canvas-item-container-column[_ngcontent-%COMP%]{display:flex;flex-direction:column}.rx-runtime-view-canvas-item-auto-scroll[_ngcontent-%COMP%]{overflow-y:auto}.rx-mb-sm[_ngcontent-%COMP%]{margin-bottom:1rem}@media (min-width: 576px){.rx-mb-sm[_ngcontent-%COMP%]{margin-bottom:0}}.rx-mb-sm[_ngcontent-%COMP%]:nth-last-child(1){margin-bottom:0}.rx-mb-md[_ngcontent-%COMP%]{margin-bottom:1rem}@media (min-width: 768px){.rx-mb-md[_ngcontent-%COMP%]{margin-bottom:0}}.rx-mb-md[_ngcontent-%COMP%]:nth-last-child(1){margin-bottom:0}.rx-mb-lg[_ngcontent-%COMP%]{margin-bottom:1rem}@media (min-width: 992px){.rx-mb-lg[_ngcontent-%COMP%]{margin-bottom:0}}.rx-mb-lg[_ngcontent-%COMP%]:nth-last-child(1){margin-bottom:0}.rx-mb-xl[_ngcontent-%COMP%]{margin-bottom:1rem}@media (min-width: 1200px){.rx-mb-xl[_ngcontent-%COMP%]{margin-bottom:0}}.rx-mb-xl[_ngcontent-%COMP%]:nth-last-child(1){margin-bottom:0}.rx-mb-xxl[_ngcontent-%COMP%]{margin-bottom:1rem}@media (min-width: 1600px){.rx-mb-xxl[_ngcontent-%COMP%]{margin-bottom:0}}.rx-mb-xxl[_ngcontent-%COMP%]:nth-last-child(1){margin-bottom:0}']});class H{constructor(e){this.runtimeCanvasItemComponent=e,this.defaultOutletName=s.RX_VIEW_DEFINITION.defaultOutletName,this.layoutRole=s.ViewLayoutRole}isHidden(e){return e.name===s.ViewLayoutRole.Header&&0===e.columns[0].children.length}}H.\u0275fac=function(e){return new(e||H)(n["\u0275\u0275directiveInject"](X))},H.\u0275cmp=n["\u0275\u0275defineComponent"]({type:H,selectors:[["rx-runtime-view-root"]],decls:1,vars:1,consts:[[3,"hidden","columns","outlet","ngClass",4,"ngFor","ngForOf"],[3,"hidden","columns","outlet","ngClass"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,M,1,11,"rx-runtime-view-canvas-item-container",0),2&e&&n["\u0275\u0275property"]("ngForOf",t.runtimeCanvasItemComponent.layout.outlets)},directives:[c.NgForOf,W,c.NgClass],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:hidden}rx-runtime-view-canvas-item-container[_ngcontent-%COMP%]{padding:0 1rem}.outlet-padding[_ngcontent-%COMP%]{padding:1rem}.content-outlet[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden}"]});class Q{constructor(e,t,i,n,o,r,a){this.rxViewComponentRegistryService=e,this.viewDefinitionParserService=t,this.factoryResolver=i,this.tree=n,this.rxJsonParserService=o,this.rxLogService=r,this.rxOldViewLayoutAdapterService=a}clear(){this.layout=null}init(e,t){this.runtimeViewModel=e,this.runtimeViewModelApi=t,this.viewDefinitionParserService.getComponents(e.viewDefinition).forEach(this.processDefinition.bind(this))}processDefinition(e){if(this.rxOldViewLayoutAdapterService.convertLayout(e),e.parentComponentDefinition){const t=this.rxViewComponentRegistryService.get(e.componentDefinition.type);if(e.componentDefinition.type!==s.RxViewComponentType.Action&&t&&!this.runtimeViewModel.isDataViewComponentDefinition(t)){const i=JSON.parse(e.parentComponentDefinition.layout);let n=0;const o=i.outlets.find(t=>t.columns.find((t,i)=>{const o=t.children.includes(e.componentDefinition.guid);return o&&(n=i),o}));if(o){const i=this.runtimeViewModel.viewComponentStates.get(e.componentDefinition.guid).config$.asObservable(),r=this.getLayoutItem(e.parentComponentDefinition.guid);r.addLayoutItem(new q({guid:e.componentDefinition.guid,config:i,parent:r,runtimeViewModelApi:this.runtimeViewModelApi,outlets:t.outlets,factory:t.componentFactory}),{parentOutlet:o,columnIndex:n})}else{const t=e.componentDefinition;this.rxLogService.warning(`Cannot render view component. ${t.type} (${t.guid}) is not used in layout.`)}}}else this.initializeView(e.componentDefinition)}initializeView(e){const t=this.rxJsonParserService.tryParseJson(e.layout);this.layout=new q({guid:e.guid,parent:null,runtimeViewModelApi:this.runtimeViewModelApi,outlets:t.outlets,factory:this.factoryResolver.resolveComponentFactory(H)})}getLayoutItem(e){return this.tree.flattenBy(this.layout,e=>e.outlets.reduce((e,t)=>(t.columns.forEach(t=>{t.children.forEach(t=>{e.push(t)})}),e),[])).find(t=>t.guid===e)}}Q.\u0275fac=function(e){return new(e||Q)(n["\u0275\u0275inject"](s.RxViewComponentRegistryService),n["\u0275\u0275inject"](s.RxViewDefinitionParserService),n["\u0275\u0275inject"](n.ComponentFactoryResolver),n["\u0275\u0275inject"](l.RxTreeService),n["\u0275\u0275inject"](l.RxJsonParserService),n["\u0275\u0275inject"](p.RxLogService),n["\u0275\u0275inject"](s.RxOldViewLayoutAdapterService))},Q.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Q,factory:Q.\u0275fac});class J{clear(){this.runtimeViewModel=null}init(e){this.runtimeViewModel||(this.runtimeViewModel=e)}triggerViewActions(e,t){return this.runtimeViewModel.triggerViewActions(e,t)}cancel(e){return this.runtimeViewModel.cancel(e)}close(){return this.runtimeViewModel.close()}getViewInputParameters(){return this.runtimeViewModel.getViewInputParameters()}applyViewPreset(e,t,i){return this.runtimeViewModel.applyViewPreset(e,t,i)}deleteViewPreset(e){return this.runtimeViewModel.deleteViewPreset(e)}discardViewPresetChanges(e,t){return this.runtimeViewModel.discardViewPresetChanges(e,t)}saveViewPreset(e){return this.runtimeViewModel.saveViewPreset(e)}shareViewPreset(e){return this.runtimeViewModel.shareViewPreset(e)}}J.\u0275fac=function(e){return new(e||J)},J.\u0275prov=n["\u0275\u0275defineInjectable"]({token:J,factory:J.\u0275fac});class K{constructor(e,t,i,n){this.propertyName=e,this.expression=t,this.rxExpressionEvaluatorService=i,this.customEvaluatorService=n}evaluate(e){return this.rxExpressionEvaluatorService.tryEvaluate(this.expression,e,this.customEvaluatorService)}hasDependency(e,t){return(0,d.includes)(this.expression,`${e}.${t}`)}hasTokens(){return(0,d.includes)(this.expression,"${view.")||this.hasKeywordTokens()}hasKeywordTokens(){return(0,d.includes)(this.expression,"${keywords.")}hasViewTokens(){return(0,d.includes)(this.expression,"${view.inputParams")||(0,d.includes)(this.expression,"${view.api")||this.hasViewIsValidToken()}hasViewIsValidToken(){return(0,d.includes)(this.expression,"${view.isValid}")}hasComponentTokens(){return(0,d.includes)(this.expression,"${view.components")}}class Y{constructor(e,t,i,n){this.rxGlobalEventsService=e,this.rxLogService=t,this.rxViewActionService=i,this.errorHandler=n}executeActions(e,t){return new Promise((i,n)=>{let a;(0,o.from)(e).pipe((0,r.mergeScan)((e,i)=>(this.rxLogService.debug("ACTION STARTED: "+i.name),this.rxViewActionService.execute(i.name,i.parameters).pipe((0,r.map)(e=>t(i,e)),(0,r.take)(1))),null,1)).subscribe({next:e=>a=e,error:e=>{n(e),this.rxGlobalEventsService.viewActionsCompleted$.next(),(0,d.castArray)(e).forEach(e=>{(0,d.isString)(e)?this.rxLogService.warning(e):e&&this.errorHandler.handleError(e)})},complete:()=>{this.rxGlobalEventsService.viewActionsCompleted$.next(),i(a)}})})}}Y.\u0275fac=function(e){return new(e||Y)(n["\u0275\u0275inject"](p.RxGlobalEventsService),n["\u0275\u0275inject"](p.RxLogService),n["\u0275\u0275inject"](s.RxViewActionService),n["\u0275\u0275inject"](n.ErrorHandler))},Y.\u0275prov=n["\u0275\u0275defineInjectable"]({token:Y,factory:Y.\u0275fac,providedIn:"root"});const Z="default";class ee{constructor(e,t,i,n,o){this.rxViewDefinitionService=e,this.rxViewDefinitionParserService=t,this.rxDefinitionAdapterRegistryService=i,this.rxViewActionDefinitionAdapterRegistryService=n,this.rxViewDefinitionCacheService=o}isViewCancellable(e){return(0,d.isString)(e)?this.rxViewDefinitionCacheService.getViewDefinition(e).pipe((0,r.map)(e=>this.hasPageComponent(e)||this.hasViewCancellingAction(e))):(0,o.of)(this.hasPageComponent(e)||this.hasViewCancellingAction(e))}runAdaptersForComponents(e,t){const i=this.rxViewDefinitionParserService.getComponents(t||e),n=new RegExp(`\\\${view.components.${l.RX_GUID.baseGuidPattern}.`);e.viewComponentExpressions=(0,d.chain)(i).map(e=>(0,d.values)(e.componentDefinition.propertiesByName)).flatten().map(e=>(0,d.isObject)(e)?(0,d.values)(e):e).flatten().filter(d.isString).filter(e=>n.test(e)).value();const a=i.reduce((t,{componentDefinition:i})=>{const n=i.type===s.RxViewComponentType.Action?this.rxViewActionDefinitionAdapterRegistryService.getRuntimeAdapter(i.propertiesByName.name):this.rxDefinitionAdapterRegistryService.getRuntimeAdapter(i.type);if(n){const a=n.adaptDefinition(i,e);t.push(a?a.pipe((0,r.take)(1)):o.EMPTY)}return t},[]);return(0,d.isEmpty)(a)?[o.EMPTY]:a}hasViewCancellingAction(e){return Boolean(this.rxViewDefinitionParserService.findViewComponent(e,e=>e.type===s.RxViewComponentType.Action&&"rxCloseViewAction"===e.propertiesByName.name&&"true"===e.propertiesByName.actAsCancel))}hasPageComponent(e){var t;return(null===(t=(0,d.head)(e.componentDefinitions))||void 0===t?void 0:t.type)===s.RxViewComponentType.Page}}ee.\u0275fac=function(e){return new(e||ee)(n["\u0275\u0275inject"](s.RxViewDefinitionService),n["\u0275\u0275inject"](s.RxViewDefinitionParserService),n["\u0275\u0275inject"](p.RxDefinitionAdapterRegistryService),n["\u0275\u0275inject"](s.RxViewActionDefinitionAdapterRegistryService),n["\u0275\u0275inject"](s.RxViewDefinitionCacheService))},ee.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ee,factory:ee.\u0275fac,providedIn:"root"});class te{constructor(e,t,i){this.rxObjectUtilsService=e,this.rxJsonParserService=t,this.rxDeviceDetectionService=i}preProcessViewDefinition(e){var t;null===(t=e.componentDefinitions)||void 0===t||t.forEach(e=>{this.expandProperties(e)})}postProcessViewDefinition(e){var t;null===(t=e.componentDefinitions)||void 0===t||t.forEach(t=>{this.filterComponentsForDevice(t,e)})}expandProperties(e){e.propertiesByName=this.rxObjectUtilsService.expandProperties(e.propertiesByName),e.componentDefinitions&&e.componentDefinitions.forEach(e=>{this.expandProperties(e)})}filterComponentsForDevice(e,t){var i;if((this.rxJsonParserService.tryParseJson(null===(i=e.propertiesByName)||void 0===i?void 0:i[s.RX_AVAILABLE_ON_DEVICES_PROP_NAME],s.RX_AVAILABLE_ON_DEVICES_ALL_VALUE)||s.RX_AVAILABLE_ON_DEVICES_ALL_VALUE).includes(this.rxDeviceDetectionService.currentDevice))"componentDefinitions"in e&&e.componentDefinitions.forEach(t=>{this.filterComponentsForDevice(t,e)});else if(t.componentDefinitions=t.componentDefinitions.filter(t=>t!==e),t.layout){const i=s.RxViewLayout.removeChildFromLayout(this.rxJsonParserService.tryParseJson(t.layout),e.guid);t.layout=JSON.stringify(i)}}}te.\u0275fac=function(e){return new(e||te)(n["\u0275\u0275inject"](l.RxObjectUtilsService),n["\u0275\u0275inject"](l.RxJsonParserService),n["\u0275\u0275inject"](s.RxDeviceDetectionService))},te.\u0275prov=n["\u0275\u0275defineInjectable"]({token:te,factory:te.\u0275fac,providedIn:"root"});class ie{constructor(e,t,i,n,r,a,s,l,d,c,p,m,u,f,h,g,v){this.rxBundleService=e,this.rxGlobalCacheService=t,this.rxViewComponentRegistryService=i,this.rxViewDefinitionAdapterService=n,this.rxViewDefinitionParserService=r,this.rxViewDefinitionService=a,this.rxRuntimeViewUtilsService=s,this.rxExpressionEvaluatorService=l,this.rxNotificationService=d,this.rxViewActionRegistryService=c,this.rxLogService=p,this.viewComponentEventManager=m,this.rxUtilityModalsService=u,this.rxViewDefinitionCacheService=f,this.rxObjectUtilsService=h,this.rxJsonParserService=g,this.rxCurrentUserService=v,this.api={save:this.save.bind(this),close:this.close.bind(this),cancel:this.cancel.bind(this),refresh:this.refresh.bind(this),canClose:this.canClose.bind(this),applyViewPreset:this.applyViewPreset.bind(this),deleteViewPreset:this.deleteViewPreset.bind(this),discardViewPresetChanges:this.discardViewPresetChanges.bind(this),saveViewPreset:this.saveViewPreset.bind(this)},this.saveSubject=new o.Subject,this.closeSubject=new o.Subject,this.cancelSubject=new o.Subject,this.save$=this.saveSubject.asObservable(),this.close$=this.closeSubject.asObservable(),this.cancel$=this.cancelSubject.asObservable(),this.viewComponentStates=new Map,this.evaluationData={view:{api:this.api,components:{},inputParams:{},isValid:!1},keywords:{user:this.rxCurrentUserService.getName(),newLine:"\n"}}}init(e){this.configuration=e,this.clear();return((0,d.isString)(e.viewDefinitionName)?this.rxViewDefinitionCacheService.getViewDefinition(e.viewDefinitionName):(0,o.of)(e.viewDefinitionName)).pipe((0,r.switchMap)(e=>{const t=this.rxViewDefinitionParserService.getComponents(e,!0).map(e=>e.componentDefinition.type===s.RxViewComponentType.Action?this.rxViewActionRegistryService.getActionOwnerBundleId(e.componentDefinition.propertiesByName.name):this.rxViewComponentRegistryService.getComponentOwnerBundleId(e.componentDefinition.type));return(0,o.merge)(...t).pipe((0,r.filter)(Boolean),(0,r.distinct)(),(0,r.reduce)((e,t)=>(e.push(t),e),[]),(0,r.switchMap)(t=>t.length?this.rxBundleService.loadBundles(t,!0).pipe((0,r.map)(()=>e)):(0,o.of)(e)),(0,r.switchMap)(e=>this.rxViewComponentRegistryService.resolveAsyncDescriptors().pipe((0,r.map)(()=>e))))}),(0,r.switchMap)(e=>this.processViewDefinition(e)))}clear(){this.viewComponentStates.clear(),this.evaluationData.view.components={},this.evaluationData.view.inputParams={}}save(e=!1){return this.callRuntimeComponentsApi("save",e).pipe((0,r.tap)({complete:()=>this.saveSubject.next()}))}close(){const e=this.evaluateViewOutputParams();return this.closeSubject.next(e),(0,o.of)(e)}cancel(e){return e?(this.cancelSubject.next(),o.EMPTY):this.isDirtyView().pipe((0,r.switchMap)(e=>e?this.rxUtilityModalsService.confirmUnsavedChanges():(0,o.of)(!0)),(0,r.tap)(e=>{e&&this.cancelSubject.next()}),(0,r.switchMap)(e=>e?o.EMPTY:(0,o.throwError)(null)))}refresh(){return this.callRuntimeComponentsApi("refresh")}canClose(){let e=!0;return this.isDirtyView().subscribe(t=>e=!t),e}applyViewPreset(e,t,i){return this.callRuntimeComponentsApi("applyViewPreset",e,t,i).pipe((0,r.switchMap)(()=>o.EMPTY))}deleteViewPreset(e){return this.callRuntimeComponentsApi("deleteViewPreset",e).pipe((0,r.switchMap)(()=>o.EMPTY))}discardViewPresetChanges(e,t){return this.callRuntimeComponentsApi("discardViewPresetChanges",e,t).pipe((0,r.switchMap)(()=>o.EMPTY))}saveViewPreset(e){return this.callRuntimeComponentsApi("saveViewPreset",e).pipe((0,r.switchMap)(()=>o.EMPTY))}shareViewPreset(e){return this.callRuntimeComponentsApi("shareViewPreset",e).pipe((0,r.defaultIfEmpty)([]),(0,r.map)(e=>e.filter(e=>Boolean(null==e?void 0:e.data)).reduce((e,t)=>(e[t.guid]=t.data,e),{})))}triggerViewActions(e,t){let i=Promise.resolve();const n=this.viewComponentStates.get(e);if(n){const o=n.eventStates[t];if(o){const t=o.map(e=>({guid:e.guid,name:e.name,parameters:e.config}));i=this.viewComponentEventManager.executeActions(t,(t,i)=>{this.onViewComponentActionOutputChanged(e,t.guid,i)})}else this.rxLogService.warning(`Cannot trigger view actions. View Action Trigger Event ${t} not found.`)}else this.rxLogService.warning(`Cannot trigger view actions. View Component ${e} not found.`);return i}onViewComponentPropertyChanged({guid:e,propertyName:t,newValue:i}){const n=this.viewComponentStates.get(e);n.publicState[t]=i,this.updateEvaluationData(n),"api"!==t&&(0,d.some)(n.componentDescriptor.properties,{name:t})&&(this.updateComponentConfigProperty(t,i,n),this.updateViewComponentConfig(n));const o=n.dependentViewComponentsMap.get(t);let r;o?r=o.map(e=>this.viewComponentStates.get(e)):(r=this.getDependentViewComponentStates(i=>i.hasDependency(e,t)),n.dependentViewComponentsMap.set(t,r.map(e=>e.guid))),r.forEach(i=>{this.evaluateDependentProperties(i,e,t)}),r.map(e=>e.isDataViewComponent?this.getParentViewComponent(e):e).forEach(e=>{this.updateViewComponentConfig(e)}),"isValid"===t&&this.triggerViewValidation(i)}isDataViewComponentDefinition(e){return void 0!==e.configPropertyName}getViewInputParameters(){return this.configuration.inputParams}isDirtyView(){const e=new o.ReplaySubject(1);let t=!1;return this.isUserInteractionDetected?this.callRuntimeComponentsApi("isDirty").pipe((0,r.tap)(e=>t=e.some(({data:e})=>e))).subscribe({complete:()=>e.next(t)}):e.next(t),e.asObservable().pipe((0,r.take)(1))}triggerViewValidation(e){if(e&&(e=Array.from(this.viewComponentStates.values()).filter(e=>(0,d.has)(e.publicState,"isValid")).every(e=>e.publicState.isValid)),this.evaluationData.view.isValid!==e){let t;this.evaluationData.view.isValid=e,this.dependentOnViewIsValidPropViewComponentGuids?t=this.dependentOnViewIsValidPropViewComponentGuids.map(e=>this.viewComponentStates.get(e)):(t=this.getDependentViewComponentStates(e=>e.hasViewIsValidToken()),this.dependentOnViewIsValidPropViewComponentGuids=t.map(e=>e.guid)),t.forEach(e=>{this.evaluateComponentExpressions(e,e=>e.hasViewIsValidToken())}),o.asyncScheduler.schedule(()=>{t.forEach(this.updateViewComponentConfig.bind(this))})}}getParentViewComponent(e){let t=e;for(;t.isDataViewComponent;)t=this.viewComponentStates.get(t.parentViewComponentGuid);return t}getDependentViewComponentStates(e){return Array.from(this.viewComponentStates.values()).filter(t=>{const i=(0,d.some)(t.expressions,e),n=(0,d.some)(t.eventStates,t=>(0,d.some)(t,t=>(0,d.some)(t.expressions,e)));return i||n})}updateViewComponentConfig(e){e.config$.next(this.buildComponentConfig(e))}buildComponentConfig(e){const t=Object.assign({},e.configState);return this.buildComponentChildDataConfig(e,t),t}buildComponentChildDataConfig(e,t={}){const i=e.childViewComponentGuids.map(e=>this.viewComponentStates.get(e)).filter(e=>Boolean(e)).filter(e=>e.isDataViewComponent),n=(0,d.groupBy)(i,e=>e.configPropertyName);Object.keys(n).forEach(e=>{t[e]=n[e].map(e=>{const t=Object.assign({},e.configState);return this.buildComponentChildDataConfig(e,t),t})})}onViewComponentActionOutputChanged(e,t,i){const n=this.viewComponentStates.get(e);if(n){n.eventStates[Z].find(e=>e.guid===t).publicState.output=i,this.updateEvaluationData(n),this.evaluateDependentProperties(n,t,"output")}}evaluateViewOutputParams(){return this.viewDefinition.outputParams.reduce((e,t)=>(e[t.name]=this.rxExpressionEvaluatorService.tryEvaluate(t.source,this.evaluationData),e),{})}processViewDefinition(e){this.viewDefinition=this.rxObjectUtilsService.cloneDeep(e),this.rxViewDefinitionAdapterService.preProcessViewDefinition(this.viewDefinition);const t=this.rxRuntimeViewUtilsService.runAdaptersForComponents(this.viewDefinition);return(0,o.combineLatest)(t).pipe((0,r.switchMapTo)(o.EMPTY),(0,r.tap)({complete:()=>{this.rxViewDefinitionAdapterService.postProcessViewDefinition(this.viewDefinition),this.rxViewDefinitionParserService.getComponents(this.viewDefinition).forEach(this.processComponentDefinition.bind(this)),this.viewComponentStates.forEach(e=>{this.evaluateComponentExpressions(e,e=>e.hasKeywordTokens())}),this.viewComponentStates.forEach(e=>{this.evaluateComponentExpressions(e,e=>!e.hasTokens())}),this.viewComponentStates.forEach(e=>{this.evaluateComponentExpressions(e,e=>e.hasViewTokens())}),this.viewComponentStates.forEach(e=>{this.evaluateComponentExpressions(e,e=>e.hasComponentTokens())}),this.viewComponentStates.forEach(e=>{this.updateViewComponentConfig(e)})}}))}processComponentDefinition(e){if(e.parentComponentDefinition){const t=e.componentDefinition,i=this.buildViewComponentState(e);i&&this.viewComponentStates.set(t.guid,i)}else{const t=(0,d.map)(e.componentDefinition.inputParams,"name"),i=(0,d.keys)(this.configuration.inputParams);i.length>0&&(0,d.every)(i,e=>/^\$[0-9]+\$$/.test(e))&&0===(0,d.intersection)(t,i).length?(0,d.forEach)(i,t=>{const i=Number(t.match(/^\$([0-9]+)\$$/)[1]),n=(0,d.get)(e.componentDefinition,`inputParams[${i}].name`);this.evaluationData.view.inputParams[n]=this.configuration.inputParams[t]}):(0,d.forEach)(t,e=>{this.evaluationData.view.inputParams[e]=this.configuration.inputParams[e]})}}buildViewComponentState(e){const t=e.componentDefinition,i=this.rxViewComponentRegistryService.get(t.type);if(i){const n={guid:t.guid,type:t.type,config$:new o.BehaviorSubject({}),expressions:[],eventStates:{[Z]:[]},configState:{},publicState:{},isDataViewComponent:!1,configPropertyName:null,parentViewComponentGuid:e.parentComponentDefinition.guid,childViewComponentGuids:[],dependentViewComponentsMap:new Map,componentDescriptor:i};return this.isDataViewComponentDefinition(i)&&(n.isDataViewComponent=!0,n.configPropertyName=i.configPropertyName),(0,d.forOwn)(t.propertiesByName,(e,t)=>{const o=(0,d.find)(i.properties,e=>t===e.name),r=o&&o.enableExpressionEvaluation;r&&n.expressions.push(new K(t,e,this.rxExpressionEvaluatorService,o.evaluatorService)),this.updateComponentConfigProperty(t,r?null:e,n)}),this.updateEvaluationData(n),this.isContainerComponentDefinition(t)&&(t.componentDefinitions.filter(e=>e.type===s.RxViewComponentType.Action).forEach(e=>{const t=this.buildViewComponentActionState(e);t&&n.eventStates[Z].push(t)}),n.eventStates[Z]=(0,d.sortBy)(n.eventStates[Z],"index"),n.childViewComponentGuids=t.componentDefinitions.filter(e=>e.type!==s.RxViewComponentType.Action).map(e=>e.guid)),n}t.type!==s.RxViewComponentType.Action&&this.rxLogService.warning(`Cannot initialize view component. View Component Descriptor for ${t.type} not found.`)}buildViewComponentActionState(e){const t=this.rxViewActionRegistryService.get(e.propertiesByName.name);if(t){const i={guid:e.guid,name:e.propertiesByName.name,index:(0,d.toNumber)(e.propertiesByName.index)||0,config:{},publicState:{},expressions:[]};return Object.keys(e.propertiesByName||{}).filter(e=>"name"!==e).map(n=>{const o=(t.parameters||[]).find(e=>n===e.name),r=o&&o.enableExpressionEvaluation;r&&this.initializeActionExpressionForProperty(i,o.evaluatorService,n,e.propertiesByName[n]),this.updateActionConfigProperty(n,r?null:e.propertiesByName[n],i)}),i}}initializeActionExpressionForProperty(e,t,i,n){(0,d.isObject)(n)?(0,d.forIn)(n,(n,o)=>{this.initializeActionExpressionForProperty(e,t,`${i}.${o}`,n)}):e.expressions.push(new K(i,n,this.rxExpressionEvaluatorService,t))}callRuntimeComponentsApi(e,...t){const i=new o.ReplaySubject(1),n=[],a=Array.from(this.viewComponentStates.values()).filter(t=>Boolean(t.publicState.api&&(0,d.isFunction)(t.publicState.api[e]))).map(i=>{let a=i.publicState.api[e].apply(null,t);return a&&a.then?a=(0,o.from)(a):a instanceof o.Observable||(a=(0,o.of)(a)),a.pipe((0,r.take)(1),(0,r.map)(e=>({guid:i.guid,data:e})),(0,r.tap)({error:e=>n.push(e)}),(0,r.catchError)(()=>o.EMPTY))});return(0,o.combineLatest)(a).subscribe({next:e=>i.next(e),complete:()=>(0,d.isEmpty)(n)?i.complete():i.error(n)}),i.asObservable()}evaluateComponentExpressions(e,t){e.expressions.filter(t).forEach(t=>{this.updateComponentConfigProperty(t.propertyName,this.evaluateExpression(t),e)}),this.updateEvaluationData(e),Object.keys(e.eventStates).forEach(i=>{e.eventStates[i].forEach(i=>{i.expressions.filter(t).forEach(t=>{this.updateActionConfigProperty(t.propertyName,this.evaluateExpression(t),i),this.updateEvaluationData(e)})})})}evaluateDependentProperties(e,t,i){this.evaluateComponentExpressions(e,e=>e.hasDependency(t,i))}evaluateExpression(e){let t;try{t=e.evaluate(this.evaluationData)}catch(i){t=null,this.rxNotificationService.addErrorMessage(i.message,"")}return t}updateComponentConfigProperty(e,t,i){const n=this.rxViewComponentRegistryService.get(i.type),o=(0,d.find)(n.properties,{name:e});i.configState[e]=this.processPropertyValue(t,o)}updateActionConfigProperty(e,t,i){const n=this.rxViewActionRegistryService.get(i.name);let o=(0,d.find)(n.parameters,{name:e});if(!o&&(0,d.includes)(e,".")){const t=e.split(".")[0];o=(0,d.find)(n.parameters,{name:t})}(0,d.set)(i.config,e,this.processPropertyValue(t,o))}updateEvaluationData(e){this.evaluationData.view.components[e.guid]=Object.assign(Object.assign({},e.configState),e.publicState),Object.keys(e.eventStates).forEach(t=>{e.eventStates[t].forEach(e=>{this.evaluationData.view.components[e.guid]=e.publicState})})}processPropertyValue(e,t){return t&&t.type&&!(0,d.isNil)(e)&&(t.type===s.ViewComponentPropertyType.Boolean?e=!(0,d.includes)(["0","false"],e)&&Boolean(e):t.type===s.ViewComponentPropertyType.Number?(e=Number(e),Number.isNaN(e)&&(e=null)):t.type===s.ViewComponentPropertyType.String?e=String(e):[s.ViewComponentPropertyType.Array,s.ViewComponentPropertyType.Object].includes(t.type)&&(e=this.rxJsonParserService.tryParseJson(e))),e}isContainerComponentDefinition(e){return void 0!==e.componentDefinitions}}ie.\u0275fac=function(e){return new(e||ie)(n["\u0275\u0275inject"](p.RxBundleService),n["\u0275\u0275inject"](p.RxGlobalCacheService),n["\u0275\u0275inject"](s.RxViewComponentRegistryService),n["\u0275\u0275inject"](te),n["\u0275\u0275inject"](s.RxViewDefinitionParserService),n["\u0275\u0275inject"](s.RxViewDefinitionService),n["\u0275\u0275inject"](ee),n["\u0275\u0275inject"](s.RxExpressionEvaluatorService),n["\u0275\u0275inject"](p.RxNotificationService),n["\u0275\u0275inject"](s.RxViewActionRegistryService),n["\u0275\u0275inject"](p.RxLogService),n["\u0275\u0275inject"](Y),n["\u0275\u0275inject"](m.RxUtilityModalsService),n["\u0275\u0275inject"](s.RxViewDefinitionCacheService),n["\u0275\u0275inject"](l.RxObjectUtilsService),n["\u0275\u0275inject"](l.RxJsonParserService),n["\u0275\u0275inject"](p.RxCurrentUserService))},ie.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ie,factory:ie.\u0275fac});class ne{constructor(){this.activeRuntimeViews=[]}register(e){this.activeRuntimeViews.includes(e)||this.activeRuntimeViews.push(e)}getAll(){return this.activeRuntimeViews}unregister(e){(0,d.pull)(this.activeRuntimeViews,e)}}ne.\u0275fac=function(e){return new(e||ne)},ne.\u0275prov=n["\u0275\u0275defineInjectable"]({token:ne,factory:ne.\u0275fac,providedIn:"root"});class oe{constructor(e){this.runtimeViewCanvasService=e,this.componentPropertyChanged=new n.EventEmitter,this.destroy$=new o.Subject}ngOnInit(){this.runtimeViewCanvasService.componentPropertyChanged$.pipe((0,r.takeUntil)(this.destroy$)).subscribe(e=>{this.componentPropertyChanged.emit(e)})}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}}oe.\u0275fac=function(e){return new(e||oe)(n["\u0275\u0275directiveInject"](U))},oe.\u0275cmp=n["\u0275\u0275defineComponent"]({type:oe,selectors:[["rx-runtime-view-canvas"]],inputs:{layout:"layout"},outputs:{componentPropertyChanged:"componentPropertyChanged"},features:[n["\u0275\u0275ProvidersFeature"]([U])],decls:1,vars:1,consts:[["class","root-item",3,"layout",4,"ngIf"],[1,"root-item",3,"layout"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,A,1,1,"rx-runtime-view-canvas-item",0),2&e&&n["\u0275\u0275property"]("ngIf",t.layout)},directives:[c.NgIf,X],encapsulation:2});class re{constructor(e,t,i,r,a,s,l,d,c){this.runtimeViewModelApi=e,this.rxRecordDefinitionCacheService=t,this.runtimeViewLayoutService=i,this.runtimeViewModel=r,this.rxProcessDefinitionCacheService=a,this.rxRuntimeViewRegistryService=s,this.rxViewDefinitionCacheService=l,this.rxAssociationDefinitionCacheService=d,this.rxViewDefinitionService=c,this.destroyed$=new o.ReplaySubject(1),this.save=new n.EventEmitter,this.closeView=new n.EventEmitter,this.cancelView=new n.EventEmitter,this.beforeLoad=new n.EventEmitter,this.afterLoad=new n.EventEmitter,this.rxAssociationDefinitionCacheService.registerConsumer(this.destroyed$),this.rxProcessDefinitionCacheService.registerConsumer(this.destroyed$),this.rxRecordDefinitionCacheService.registerConsumer(this.destroyed$),this.rxViewDefinitionCacheService.registerConsumer(this.destroyed$)}onTrigger(){this.runtimeViewModel.isUserInteractionDetected=!0}ngOnInit(){this.init(),this.runtimeViewModel.cancel$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(()=>this.cancelView.emit()),this.runtimeViewModel.save$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(()=>this.save.emit()),this.runtimeViewModel.close$.pipe((0,r.takeUntil)(this.destroyed$)).subscribe(e=>this.closeView.emit(e))}ngOnChanges(e){e.configuration.currentValue&&e.configuration.previousValue&&e.configuration.currentValue.viewDefinitionName!==e.configuration.previousValue.viewDefinitionName&&(this.runtimeViewModelApi.clear(),this.runtimeViewLayoutService.clear(),this.configuration=e.configuration.currentValue,this.init())}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete(),this.rxRuntimeViewRegistryService.unregister(this.runtimeViewModel)}init(){this.beforeLoad.emit(),this.runtimeViewModel.init(this.configuration).subscribe({complete:()=>{this.runtimeViewModelApi.init(this.runtimeViewModel),this.runtimeViewLayoutService.init(this.runtimeViewModel,this.runtimeViewModelApi),this.hostClass=this.runtimeViewModel.viewDefinition.styles||"",this.rxViewDefinitionService.isPageView(this.runtimeViewModel.viewDefinition)&&(this.hostClass=this.hostClass+" rx-page-view"),this.viewDefinitionGuid=this.runtimeViewModel.viewDefinition.guid,this.runtimeViewModel.isUserInteractionDetected=!1,this.afterLoad.emit()}}),this.configuration.onRegisterApi&&this.configuration.onRegisterApi(this.runtimeViewModel.api),this.rxRuntimeViewRegistryService.register(this.runtimeViewModel)}}re.\u0275fac=function(e){return new(e||re)(n["\u0275\u0275directiveInject"](J),n["\u0275\u0275directiveInject"](a.RxRecordDefinitionCacheService),n["\u0275\u0275directiveInject"](Q),n["\u0275\u0275directiveInject"](ie),n["\u0275\u0275directiveInject"](f.RxProcessDefinitionCacheService),n["\u0275\u0275directiveInject"](ne),n["\u0275\u0275directiveInject"](s.RxViewDefinitionCacheService),n["\u0275\u0275directiveInject"](u.RxAssociationDefinitionCacheService),n["\u0275\u0275directiveInject"](s.RxViewDefinitionService))},re.\u0275cmp=n["\u0275\u0275defineComponent"]({type:re,selectors:[["rx-runtime-view"]],hostVars:3,hostBindings:function(e,t){1&e&&n["\u0275\u0275listener"]("focusin",function(){return t.onTrigger()}),2&e&&(n["\u0275\u0275attribute"]("rx-view-definition-guid",t.viewDefinitionGuid),n["\u0275\u0275classMap"](t.hostClass))},inputs:{configuration:"configuration"},outputs:{save:"save",closeView:"closeView",cancelView:"cancelView",beforeLoad:"beforeLoad",afterLoad:"afterLoad"},features:[n["\u0275\u0275ProvidersFeature"]([ie,J,Q]),n["\u0275\u0275NgOnChangesFeature"]],decls:1,vars:1,consts:[[3,"layout","componentPropertyChanged",4,"ngIf"],[3,"layout","componentPropertyChanged"]],template:function(e,t){1&e&&n["\u0275\u0275template"](0,O,1,1,"rx-runtime-view-canvas",0),2&e&&n["\u0275\u0275property"]("ngIf",t.runtimeViewLayoutService.layout)},directives:[c.NgIf,oe],styles:[".rx-page-view[_nghost-%COMP%]     .outlet-padding{padding:0}.rx-page-view[_nghost-%COMP%]     rx-runtime-view-canvas-item{height:100%}"]});class ae{constructor(){this.customCssClasses="",this.autoFill=new n.EventEmitter,this.autoScroll=new n.EventEmitter,this.hidden=new n.EventEmitter,this.isComponentHidden=!1,this.destroyed$=new o.ReplaySubject(1),this.propertyChanged=new n.EventEmitter}get isHidden(){return this.isComponentHidden}set isHidden(e){this.hidden.emit(e),this.isComponentHidden=Boolean(e)}ngOnInit(){this.config.pipe((0,r.pluck)("styles"),(0,r.takeUntil)(this.destroyed$)).subscribe(e=>{this.customCssClasses=e||"",this.autoFill.emit(this.customCssClasses.includes("rx-auto-fill")),this.autoScroll.emit(this.customCssClasses.includes("rx-auto-scroll"))})}notifyPropertyChanged(e,t,i){this.propertyChanged.next({guid:this.guid,propertyName:e,newValue:t,oldValue:i})}triggerViewActions(e=this.guid,t=Z){return this.runtimeViewModelApi.triggerViewActions(e,t)}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}}ae.\u0275fac=function(e){return new(e||ae)},ae.\u0275dir=n["\u0275\u0275defineDirective"]({type:ae,hostVars:4,hostBindings:function(e,t){2&e&&(n["\u0275\u0275hostProperty"]("hidden",t.isHidden),n["\u0275\u0275attribute"]("rx-view-component-id",t.guid),n["\u0275\u0275classMap"](t.customCssClasses))},outputs:{autoFill:"autoFill",autoScroll:"autoScroll",hidden:"hidden"}});class se{constructor(e,t){this.runtimeViewCanvasItemService=e,this.componentFactoryResolver=t,this.name=s.RX_VIEW_DEFINITION.defaultOutletName}ngOnInit(){this.runtimeViewCanvasItemService.registerOutlet(this.name,this.container,this.componentFactoryResolver.resolveComponentFactory(W))}}se.\u0275fac=function(e){return new(e||se)(n["\u0275\u0275directiveInject"](z),n["\u0275\u0275directiveInject"](n.ComponentFactoryResolver))},se.\u0275cmp=n["\u0275\u0275defineComponent"]({type:se,selectors:[["rx-runtime-view-canvas-outlet"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](y,7,n.ViewContainerRef),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.container=e.first)}},inputs:{name:"name"},decls:2,vars:0,consts:[["container",""]],template:function(e,t){1&e&&n["\u0275\u0275elementContainer"](0,null,0)},encapsulation:2});class le{}le.\u0275fac=function(e){return new(e||le)},le.\u0275mod=n["\u0275\u0275defineNgModule"]({type:le,declarations:[oe,X,W,se],imports:[c.CommonModule,h.FormsModule],exports:[se,oe,X,W]}),le.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[c.CommonModule,h.FormsModule]]});class de{constructor(e,t,i,n,o,r){this.rxRuntimeViewRegistryService=e,this.rxUtilityModalsService=t,this.translateService=i,this.changeDetector=n,this.activeModalRef=o,this.dockedPanelContext=r,this.isBlade=!1,this.context=r||o,this.isBlade=Boolean(r);const a=this.context.getData();this.configuration=a.configuration,this.title=a.title,this.notification=a.notification,this.isCancellable=a.isCancellable,this.closeLabel=i.instant("com.bmc.arsys.rx.client.common.close.label")}onCancelView(){this.context.dismiss(null)}closeModal(){this.context.dismiss(v.DismissReasons.CLOSE_BTN)}onClose(e){this.context.close(e)}onBeforeLoad(){this.busySubscription=o.NEVER.subscribe(),this.changeDetector.detectChanges()}onAfterLoad(){var e;null===(e=this.busySubscription)||void 0===e||e.unsubscribe()}}de.\u0275fac=function(e){return new(e||de)(n["\u0275\u0275directiveInject"](ne),n["\u0275\u0275directiveInject"](m.RxUtilityModalsService),n["\u0275\u0275directiveInject"](g.TranslateService),n["\u0275\u0275directiveInject"](n.ChangeDetectorRef),n["\u0275\u0275directiveInject"](v.ActiveModalRef,8),n["\u0275\u0275directiveInject"](v.DockedPanelContext,8))},de.\u0275cmp=n["\u0275\u0275defineComponent"]({type:de,selectors:[["rx-runtime-view-modal"]],decls:8,vars:10,consts:[[4,"ngIf"],["modalHeader",""],["class","pl-4 pt-4",3,"config",4,"ngIf"],[3,"ngClass"],[1,"position-relative"],[3,"options"],[3,"configuration","cancelView","closeView","beforeLoad","afterLoad"],["class","dp-header",4,"ngIf","ngIfElse"],[1,"dp-header"],[1,"dp-title"],["class","close dp-close","rx-id","x-button",3,"click",4,"ngIf"],["rx-id","x-button",1,"close","dp-close",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"pl-4","pt-4",3,"config"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,V,2,2,"ng-container",0),n["\u0275\u0275template"](1,k,4,2,"ng-template",null,1,n["\u0275\u0275templateRefExtractor"]),n["\u0275\u0275template"](3,_,1,3,"adapt-alert",2),n["\u0275\u0275elementStart"](4,"div",3),n["\u0275\u0275elementStart"](5,"div",4),n["\u0275\u0275element"](6,"rx-busy-indicator",5),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementStart"](7,"rx-runtime-view",6),n["\u0275\u0275listener"]("cancelView",function(){return t.onCancelView()})("closeView",function(e){return t.onClose(e)})("beforeLoad",function(){return t.onBeforeLoad()})("afterLoad",function(){return t.onAfterLoad()}),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("ngIf",t.title||t.isCancellable),n["\u0275\u0275advance"](3),n["\u0275\u0275property"]("ngIf",t.notification),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngClass",n["\u0275\u0275pureFunction2"](5,B,!t.isBlade,t.isBlade)),n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("options",n["\u0275\u0275pureFunction1"](8,$,t.busySubscription)),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("configuration",t.configuration))},directives:[c.NgIf,c.NgClass,m.RxBusyIndicatorComponent,re,v.AdaptAlertComponent],styles:["[_nghost-%COMP%]{height:100%;display:flex;flex-direction:column}.modal-header[_ngcontent-%COMP%]{min-height:34px}.dp-header[_ngcontent-%COMP%]{flex-direction:row!important}.dp-content[_ngcontent-%COMP%] > rx-runtime-view[_ngcontent-%COMP%]{height:100%}"]});const ce={actions:{save:"rx-runtime-view-save",close:"rx-runtime-view-close",cancel:"rx-runtime-view-cancel"}};class pe{}pe.\u0275fac=function(e){return new(e||pe)},pe.\u0275mod=n["\u0275\u0275defineNgModule"]({type:pe,declarations:[re,H,de],imports:[c.CommonModule,le,g.TranslateModule,v.AdaptAlertModule,m.RxBusyIndicatorModule],exports:[le,re,H,de]}),pe.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[c.CommonModule,le,g.TranslateModule,v.AdaptAlertModule,m.RxBusyIndicatorModule],le]})},"./node_modules/angular-split/fesm2015/angular-split.js":(e,t,i)=>{"use strict";i.r(t),i.d(t,{AngularSplitModule:()=>C,SplitAreaDirective:()=>b,SplitComponent:()=>x});var n=i("./node_modules/@angular/core/fesm2015/core.js"),o=i("./node_modules/@angular/common/fesm2015/common.js"),r=i("rxjs"),a=i("./node_modules/rxjs/_esm2015/operators/index.js");const s=["gutterEls"];function l(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"div",2,3),n["\u0275\u0275listener"]("mousedown",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index;return n["\u0275\u0275nextContext"]().startDragging(t,2*i+1,i+1)})("touchstart",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index;return n["\u0275\u0275nextContext"]().startDragging(t,2*i+1,i+1)})("mouseup",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index;return n["\u0275\u0275nextContext"]().clickGutter(t,i+1)})("touchend",function(t){n["\u0275\u0275restoreView"](e);const i=n["\u0275\u0275nextContext"]().index;return n["\u0275\u0275nextContext"]().clickGutter(t,i+1)}),n["\u0275\u0275element"](2,"div",4),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"]().index,t=n["\u0275\u0275nextContext"]();n["\u0275\u0275styleProp"]("flex-basis",t.gutterSize,"px")("order",2*e+1)}}function d(e,t){if(1&e&&n["\u0275\u0275template"](0,l,3,4,"div",1),2&e){const e=t.last;n["\u0275\u0275property"]("ngIf",!1===e)}}function c(e){return void 0!==e.changedTouches&&e.changedTouches.length>0?{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}:void 0!==e.clientX&&void 0!==e.clientY?{x:e.clientX,y:e.clientY}:null}function p(e,t){const i=e.nativeElement.getBoundingClientRect();return"horizontal"===t?i.width:i.height}function m(e){return"boolean"==typeof e?e:"false"!==e}function u(e,t){return null==e?t:(e=Number(e),!isNaN(e)&&e>=0?e:t)}function f(e,t){if("percent"===e){const e=t.reduce((e,t)=>null!==t?e+t:e,0);return t.every(e=>null!==e)&&e>99.9&&e<100.1}if("pixel"===e)return 1===t.filter(e=>null===e).length}function h(e){return null===e.size?null:!0===e.component.lockSize?e.size:null===e.component.minSize?null:e.component.minSize>e.size?e.size:e.component.minSize}function g(e){return null===e.size?null:!0===e.component.lockSize?e.size:null===e.component.maxSize?null:e.component.maxSize<e.size?e.size:e.component.maxSize}function v(e,t,i,n){return t.reduce((t,i)=>{const o=function(e,t,i,n){if(0===i)return{areaSnapshot:t,pixelAbsorb:0,percentAfterAbsorption:t.sizePercentAtStart,pixelRemain:0};if(0===t.sizePixelAtStart&&i<0)return{areaSnapshot:t,pixelAbsorb:0,percentAfterAbsorption:0,pixelRemain:i};if("percent"===e)return function(e,t,i){const n=e.sizePixelAtStart+t,o=n/i*100;if(t>0){if(null!==e.area.maxSize&&o>e.area.maxSize){const n=e.area.maxSize/100*i;return{areaSnapshot:e,pixelAbsorb:n,percentAfterAbsorption:e.area.maxSize,pixelRemain:e.sizePixelAtStart+t-n}}return{areaSnapshot:e,pixelAbsorb:t,percentAfterAbsorption:o>100?100:o,pixelRemain:0}}if(t<0){if(null!==e.area.minSize&&o<e.area.minSize){const n=e.area.minSize/100*i;return{areaSnapshot:e,pixelAbsorb:n,percentAfterAbsorption:e.area.minSize,pixelRemain:e.sizePixelAtStart+t-n}}return o<0?{areaSnapshot:e,pixelAbsorb:-e.sizePixelAtStart,percentAfterAbsorption:0,pixelRemain:t+e.sizePixelAtStart}:{areaSnapshot:e,pixelAbsorb:t,percentAfterAbsorption:o,pixelRemain:0}}}(t,i,n);if("pixel"===e)return function(e,t,i){const n=e.sizePixelAtStart+t;if(t>0)return null!==e.area.maxSize&&n>e.area.maxSize?{areaSnapshot:e,pixelAbsorb:e.area.maxSize-e.sizePixelAtStart,percentAfterAbsorption:-1,pixelRemain:n-e.area.maxSize}:{areaSnapshot:e,pixelAbsorb:t,percentAfterAbsorption:-1,pixelRemain:0};if(t<0)return null!==e.area.minSize&&n<e.area.minSize?{areaSnapshot:e,pixelAbsorb:e.area.minSize+t-n,percentAfterAbsorption:-1,pixelRemain:n-e.area.minSize}:n<0?{areaSnapshot:e,pixelAbsorb:-e.sizePixelAtStart,percentAfterAbsorption:-1,pixelRemain:t+e.sizePixelAtStart}:{areaSnapshot:e,pixelAbsorb:t,percentAfterAbsorption:-1,pixelRemain:0}}(t,i)}(e,i,t.remain,n);return t.list.push(o),t.remain=o.pixelRemain,t},{remain:i,list:[]})}function y(e,t){"percent"===e?t.areaSnapshot.area.size=t.percentAfterAbsorption:"pixel"===e&&null!==t.areaSnapshot.area.size&&(t.areaSnapshot.area.size=t.areaSnapshot.sizePixelAtStart+t.pixelAbsorb)}class x{constructor(e,t,i,o){this.ngZone=e,this.elRef=t,this.cdRef=i,this.renderer=o,this._direction="horizontal",this._unit="percent",this._gutterSize=11,this._gutterStep=1,this._restrictMove=!1,this._useTransition=!1,this._disabled=!1,this._dir="ltr",this._gutterDblClickDuration=0,this.dragStart=new n.EventEmitter(!1),this.dragEnd=new n.EventEmitter(!1),this.gutterClick=new n.EventEmitter(!1),this.gutterDblClick=new n.EventEmitter(!1),this.dragProgressSubject=new r.Subject,this.dragProgress$=this.dragProgressSubject.asObservable(),this.isDragging=!1,this.isWaitingClear=!1,this.dragListeners=[],this.snapshot=null,this.startPoint=null,this.endPoint=null,this.displayedAreas=[],this.hidedAreas=[],this._clickTimeout=null,this.direction=this._direction}set direction(e){this._direction="vertical"===e?"vertical":"horizontal",this.renderer.addClass(this.elRef.nativeElement,`as-${this._direction}`),this.renderer.removeClass(this.elRef.nativeElement,"as-"+("vertical"===this._direction?"horizontal":"vertical")),this.build(!1,!1)}get direction(){return this._direction}set unit(e){this._unit="pixel"===e?"pixel":"percent",this.renderer.addClass(this.elRef.nativeElement,`as-${this._unit}`),this.renderer.removeClass(this.elRef.nativeElement,"as-"+("pixel"===this._unit?"percent":"pixel")),this.build(!1,!0)}get unit(){return this._unit}set gutterSize(e){this._gutterSize=u(e,11),this.build(!1,!1)}get gutterSize(){return this._gutterSize}set gutterStep(e){this._gutterStep=u(e,1)}get gutterStep(){return this._gutterStep}set restrictMove(e){this._restrictMove=m(e)}get restrictMove(){return this._restrictMove}set useTransition(e){this._useTransition=m(e),this._useTransition?this.renderer.addClass(this.elRef.nativeElement,"as-transition"):this.renderer.removeClass(this.elRef.nativeElement,"as-transition")}get useTransition(){return this._useTransition}set disabled(e){this._disabled=m(e),this._disabled?this.renderer.addClass(this.elRef.nativeElement,"as-disabled"):this.renderer.removeClass(this.elRef.nativeElement,"as-disabled")}get disabled(){return this._disabled}set dir(e){this._dir="rtl"===e?"rtl":"ltr",this.renderer.setAttribute(this.elRef.nativeElement,"dir",this._dir)}get dir(){return this._dir}set gutterDblClickDuration(e){this._gutterDblClickDuration=u(e,0)}get gutterDblClickDuration(){return this._gutterDblClickDuration}get transitionEnd(){return new r.Observable(e=>this.transitionEndSubscriber=e).pipe((0,a.debounceTime)(20))}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{setTimeout(()=>this.renderer.addClass(this.elRef.nativeElement,"as-init"))})}getNbGutters(){return 0===this.displayedAreas.length?0:this.displayedAreas.length-1}addArea(e){const t={component:e,order:0,size:0,minSize:null,maxSize:null};!0===e.visible?(this.displayedAreas.push(t),this.build(!0,!0)):this.hidedAreas.push(t)}removeArea(e){if(this.displayedAreas.some(t=>t.component===e)){const t=this.displayedAreas.find(t=>t.component===e);this.displayedAreas.splice(this.displayedAreas.indexOf(t),1),this.build(!0,!0)}else if(this.hidedAreas.some(t=>t.component===e)){const t=this.hidedAreas.find(t=>t.component===e);this.hidedAreas.splice(this.hidedAreas.indexOf(t),1)}}updateArea(e,t,i){!0===e.visible&&this.build(t,i)}showArea(e){const t=this.hidedAreas.find(t=>t.component===e);if(void 0===t)return;const i=this.hidedAreas.splice(this.hidedAreas.indexOf(t),1);this.displayedAreas.push(...i),this.build(!0,!0)}hideArea(e){const t=this.displayedAreas.find(t=>t.component===e);if(void 0===t)return;const i=this.displayedAreas.splice(this.displayedAreas.indexOf(t),1);i.forEach(e=>{e.order=0,e.size=0}),this.hidedAreas.push(...i),this.build(!0,!0)}getVisibleAreaSizes(){return this.displayedAreas.map(e=>null===e.size?"*":e.size)}setVisibleAreaSizes(e){if(e.length!==this.displayedAreas.length)return!1;const t=e.map(e=>u(e,null));return!1!==f(this.unit,t)&&(this.displayedAreas.forEach((e,i)=>e.component._size=t[i]),this.build(!1,!0),!0)}build(e,t){if(this.stopDragging(),!0===e&&(this.displayedAreas.every(e=>null!==e.component.order)&&this.displayedAreas.sort((e,t)=>e.component.order-t.component.order),this.displayedAreas.forEach((e,t)=>{e.order=2*t,e.component.setStyleOrder(e.order)})),!0===t){const e=f(this.unit,this.displayedAreas.map(e=>e.component.size));switch(this.unit){case"percent":{const t=100/this.displayedAreas.length;this.displayedAreas.forEach(i=>{i.size=e?i.component.size:t,i.minSize=h(i),i.maxSize=g(i)});break}case"pixel":if(e)this.displayedAreas.forEach(e=>{e.size=e.component.size,e.minSize=h(e),e.maxSize=g(e)});else{const e=this.displayedAreas.filter(e=>null===e.component.size);if(0===e.length&&this.displayedAreas.length>0)this.displayedAreas.forEach((e,t)=>{e.size=0===t?null:e.component.size,e.minSize=0===t?null:h(e),e.maxSize=0===t?null:g(e)});else if(e.length>1){let e=!1;this.displayedAreas.forEach(t=>{null===t.component.size?!1===e?(t.size=null,t.minSize=null,t.maxSize=null,e=!0):(t.size=100,t.minSize=null,t.maxSize=null):(t.size=t.component.size,t.minSize=h(t),t.maxSize=g(t))})}}}}this.refreshStyleSizes(),this.cdRef.markForCheck()}refreshStyleSizes(){if("percent"===this.unit)if(1===this.displayedAreas.length)this.displayedAreas[0].component.setStyleFlex(0,0,"100%",!1,!1);else{const e=this.getNbGutters()*this.gutterSize;this.displayedAreas.forEach(t=>{t.component.setStyleFlex(0,0,`calc( ${t.size}% - ${t.size/100*e}px )`,null!==t.minSize&&t.minSize===t.size,null!==t.maxSize&&t.maxSize===t.size)})}else"pixel"===this.unit&&this.displayedAreas.forEach(e=>{null===e.size?1===this.displayedAreas.length?e.component.setStyleFlex(1,1,"100%",!1,!1):e.component.setStyleFlex(1,1,"auto",!1,!1):1===this.displayedAreas.length?e.component.setStyleFlex(0,0,"100%",!1,!1):e.component.setStyleFlex(0,0,`${e.size}px`,null!==e.minSize&&e.minSize===e.size,null!==e.maxSize&&e.maxSize===e.size)})}clickGutter(e,t){const i=c(e);this.startPoint&&this.startPoint.x===i.x&&this.startPoint.y===i.y&&(null!==this._clickTimeout?(window.clearTimeout(this._clickTimeout),this._clickTimeout=null,this.notify("dblclick",t),this.stopDragging()):this._clickTimeout=window.setTimeout(()=>{this._clickTimeout=null,this.notify("click",t),this.stopDragging()},this.gutterDblClickDuration))}startDragging(e,t,i){e.preventDefault(),e.stopPropagation(),this.startPoint=c(e),null!==this.startPoint&&!0!==this.disabled&&!0!==this.isWaitingClear&&(this.snapshot={gutterNum:i,lastSteppedOffset:0,allAreasSizePixel:p(this.elRef,this.direction)-this.getNbGutters()*this.gutterSize,allInvolvedAreasSizePercent:100,areasBeforeGutter:[],areasAfterGutter:[]},this.displayedAreas.forEach(e=>{const i={area:e,sizePixelAtStart:p(e.component.elRef,this.direction),sizePercentAtStart:"percent"===this.unit?e.size:-1};e.order<t?!0===this.restrictMove?this.snapshot.areasBeforeGutter=[i]:this.snapshot.areasBeforeGutter.unshift(i):e.order>t&&(!0===this.restrictMove?0===this.snapshot.areasAfterGutter.length&&(this.snapshot.areasAfterGutter=[i]):this.snapshot.areasAfterGutter.push(i))}),this.snapshot.allInvolvedAreasSizePercent=[...this.snapshot.areasBeforeGutter,...this.snapshot.areasAfterGutter].reduce((e,t)=>e+t.sizePercentAtStart,0),0!==this.snapshot.areasBeforeGutter.length&&0!==this.snapshot.areasAfterGutter.length&&(this.dragListeners.push(this.renderer.listen("document","mouseup",this.stopDragging.bind(this))),this.dragListeners.push(this.renderer.listen("document","touchend",this.stopDragging.bind(this))),this.dragListeners.push(this.renderer.listen("document","touchcancel",this.stopDragging.bind(this))),this.ngZone.runOutsideAngular(()=>{this.dragListeners.push(this.renderer.listen("document","mousemove",this.dragEvent.bind(this))),this.dragListeners.push(this.renderer.listen("document","touchmove",this.dragEvent.bind(this)))}),this.displayedAreas.forEach(e=>e.component.lockEvents()),this.isDragging=!0,this.renderer.addClass(this.elRef.nativeElement,"as-dragging"),this.renderer.addClass(this.gutterEls.toArray()[this.snapshot.gutterNum-1].nativeElement,"as-dragged"),this.notify("start",this.snapshot.gutterNum)))}dragEvent(e){if(e.preventDefault(),e.stopPropagation(),null!==this._clickTimeout&&(window.clearTimeout(this._clickTimeout),this._clickTimeout=null),!1===this.isDragging)return;if(this.endPoint=c(e),null===this.endPoint)return;let t="horizontal"===this.direction?this.startPoint.x-this.endPoint.x:this.startPoint.y-this.endPoint.y;"rtl"===this.dir&&(t=-t);const i=Math.round(t/this.gutterStep)*this.gutterStep;if(i===this.snapshot.lastSteppedOffset)return;this.snapshot.lastSteppedOffset=i;let n=v(this.unit,this.snapshot.areasBeforeGutter,-i,this.snapshot.allAreasSizePixel),o=v(this.unit,this.snapshot.areasAfterGutter,i,this.snapshot.allAreasSizePixel);if(0!==n.remain&&0!==o.remain?Math.abs(n.remain)===Math.abs(o.remain)||(Math.abs(n.remain)>Math.abs(o.remain)?o=v(this.unit,this.snapshot.areasAfterGutter,i+n.remain,this.snapshot.allAreasSizePixel):n=v(this.unit,this.snapshot.areasBeforeGutter,-(i-o.remain),this.snapshot.allAreasSizePixel)):0!==n.remain?o=v(this.unit,this.snapshot.areasAfterGutter,i+n.remain,this.snapshot.allAreasSizePixel):0!==o.remain&&(n=v(this.unit,this.snapshot.areasBeforeGutter,-(i-o.remain),this.snapshot.allAreasSizePixel)),"percent"===this.unit){const e=[...n.list,...o.list],t=e.find(e=>0!==e.percentAfterAbsorption&&e.percentAfterAbsorption!==e.areaSnapshot.area.minSize&&e.percentAfterAbsorption!==e.areaSnapshot.area.maxSize);t&&(t.percentAfterAbsorption=this.snapshot.allInvolvedAreasSizePercent-e.filter(e=>e!==t).reduce((e,t)=>e+t.percentAfterAbsorption,0))}n.list.forEach(e=>y(this.unit,e)),o.list.forEach(e=>y(this.unit,e)),this.refreshStyleSizes(),this.notify("progress",this.snapshot.gutterNum)}stopDragging(e){if(e&&(e.preventDefault(),e.stopPropagation()),!1!==this.isDragging){for(this.displayedAreas.forEach(e=>e.component.unlockEvents());this.dragListeners.length>0;){const e=this.dragListeners.pop();e&&e()}this.isDragging=!1,!this.endPoint||this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y||this.notify("end",this.snapshot.gutterNum),this.renderer.removeClass(this.elRef.nativeElement,"as-dragging"),this.renderer.removeClass(this.gutterEls.toArray()[this.snapshot.gutterNum-1].nativeElement,"as-dragged"),this.snapshot=null,this.isWaitingClear=!0,this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.startPoint=null,this.endPoint=null,this.isWaitingClear=!1})})}}notify(e,t){const i=this.getVisibleAreaSizes();"start"===e?this.dragStart.emit({gutterNum:t,sizes:i}):"end"===e?this.dragEnd.emit({gutterNum:t,sizes:i}):"click"===e?this.gutterClick.emit({gutterNum:t,sizes:i}):"dblclick"===e?this.gutterDblClick.emit({gutterNum:t,sizes:i}):"transitionEnd"===e?this.transitionEndSubscriber&&this.ngZone.run(()=>this.transitionEndSubscriber.next(i)):"progress"===e&&this.dragProgressSubject.next({gutterNum:t,sizes:i})}ngOnDestroy(){this.stopDragging()}}x.\u0275fac=function(e){return new(e||x)(n["\u0275\u0275directiveInject"](n.NgZone),n["\u0275\u0275directiveInject"](n.ElementRef),n["\u0275\u0275directiveInject"](n.ChangeDetectorRef),n["\u0275\u0275directiveInject"](n.Renderer2))},x.\u0275cmp=n["\u0275\u0275defineComponent"]({type:x,selectors:[["as-split"]],viewQuery:function(e,t){if(1&e&&n["\u0275\u0275viewQuery"](s,5),2&e){let e;n["\u0275\u0275queryRefresh"](e=n["\u0275\u0275loadQuery"]())&&(t.gutterEls=e)}},inputs:{direction:"direction",unit:"unit",gutterSize:"gutterSize",gutterStep:"gutterStep",restrictMove:"restrictMove",useTransition:"useTransition",disabled:"disabled",dir:"dir",gutterDblClickDuration:"gutterDblClickDuration"},outputs:{dragStart:"dragStart",dragEnd:"dragEnd",gutterClick:"gutterClick",gutterDblClick:"gutterDblClick",transitionEnd:"transitionEnd"},exportAs:["asSplit"],ngContentSelectors:["*"],decls:2,vars:1,consts:[["ngFor","",3,"ngForOf"],["class","as-split-gutter",3,"flex-basis","order","mousedown","touchstart","mouseup","touchend",4,"ngIf"],[1,"as-split-gutter",3,"mousedown","touchstart","mouseup","touchend"],["gutterEls",""],[1,"as-split-gutter-icon"]],template:function(e,t){1&e&&(n["\u0275\u0275projectionDef"](),n["\u0275\u0275projection"](0),n["\u0275\u0275template"](1,d,1,1,"ng-template",0)),2&e&&(n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",t.displayedAreas))},directives:[o.NgForOf,o.NgIf],styles:['[_nghost-%COMP%]{display:flex;flex-wrap:nowrap;justify-content:flex-start;align-items:stretch;overflow:hidden;width:100%;height:100%}[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:0;background-color:#eee;display:flex;align-items:center;justify-content:center}[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%] > .as-split-gutter-icon[_ngcontent-%COMP%]{width:100%;height:100%;background-position:center center;background-repeat:no-repeat}[_nghost-%COMP%]    >.as-split-area{flex-grow:0;flex-shrink:0;overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]    >.as-split-area.as-hidden{flex:0 1 0px!important;overflow-x:hidden;overflow-y:hidden}.as-horizontal[_nghost-%COMP%]{flex-direction:row}.as-horizontal[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-direction:row;cursor:col-resize;height:100%}.as-horizontal[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%] > .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==)}.as-horizontal[_nghost-%COMP%]    >.as-split-area{height:100%}.as-vertical[_nghost-%COMP%]{flex-direction:column}.as-vertical[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-direction:column;cursor:row-resize;width:100%}.as-vertical[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]   .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFCAMAAABl/6zIAAAABlBMVEUAAADMzMzIT8AyAAAAAXRSTlMAQObYZgAAABRJREFUeAFjYGRkwIMJSeMHlBkOABP7AEGzSuPKAAAAAElFTkSuQmCC)}.as-vertical[_nghost-%COMP%]    >.as-split-area{width:100%}.as-vertical[_nghost-%COMP%]    >.as-split-area.as-hidden{max-width:0}.as-disabled[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{cursor:default}.as-disabled[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]   .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url("")}.as-transition.as-init[_nghost-%COMP%]:not(.as-dragging)    >.as-split-area, .as-transition.as-init[_nghost-%COMP%]:not(.as-dragging) > .as-split-gutter[_ngcontent-%COMP%]{transition:flex-basis .3s}'],changeDetection:0}),x.ctorParameters=()=>[{type:n.NgZone},{type:n.ElementRef},{type:n.ChangeDetectorRef},{type:n.Renderer2}],x.propDecorators={direction:[{type:n.Input}],unit:[{type:n.Input}],gutterSize:[{type:n.Input}],gutterStep:[{type:n.Input}],restrictMove:[{type:n.Input}],useTransition:[{type:n.Input}],disabled:[{type:n.Input}],dir:[{type:n.Input}],gutterDblClickDuration:[{type:n.Input}],dragStart:[{type:n.Output}],dragEnd:[{type:n.Output}],gutterClick:[{type:n.Output}],gutterDblClick:[{type:n.Output}],transitionEnd:[{type:n.Output}],gutterEls:[{type:n.ViewChildren,args:["gutterEls"]}]};class b{constructor(e,t,i,n){this.ngZone=e,this.elRef=t,this.renderer=i,this.split=n,this._order=null,this._size=null,this._minSize=null,this._maxSize=null,this._lockSize=!1,this._visible=!0,this.lockListeners=[],this.renderer.addClass(this.elRef.nativeElement,"as-split-area")}set order(e){this._order=u(e,null),this.split.updateArea(this,!0,!1)}get order(){return this._order}set size(e){this._size=u(e,null),this.split.updateArea(this,!1,!0)}get size(){return this._size}set minSize(e){this._minSize=u(e,null),this.split.updateArea(this,!1,!0)}get minSize(){return this._minSize}set maxSize(e){this._maxSize=u(e,null),this.split.updateArea(this,!1,!0)}get maxSize(){return this._maxSize}set lockSize(e){this._lockSize=m(e),this.split.updateArea(this,!1,!0)}get lockSize(){return this._lockSize}set visible(e){this._visible=m(e),this._visible?(this.split.showArea(this),this.renderer.removeClass(this.elRef.nativeElement,"as-hidden")):(this.split.hideArea(this),this.renderer.addClass(this.elRef.nativeElement,"as-hidden"))}get visible(){return this._visible}ngOnInit(){this.split.addArea(this),this.ngZone.runOutsideAngular(()=>{this.transitionListener=this.renderer.listen(this.elRef.nativeElement,"transitionend",e=>{"flex-basis"===e.propertyName&&this.split.notify("transitionEnd",-1)})})}setStyleOrder(e){this.renderer.setStyle(this.elRef.nativeElement,"order",e)}setStyleFlex(e,t,i,n,o){this.renderer.setStyle(this.elRef.nativeElement,"flex-grow",e),this.renderer.setStyle(this.elRef.nativeElement,"flex-shrink",t),this.renderer.setStyle(this.elRef.nativeElement,"flex-basis",i),!0===n?this.renderer.addClass(this.elRef.nativeElement,"as-min"):this.renderer.removeClass(this.elRef.nativeElement,"as-min"),!0===o?this.renderer.addClass(this.elRef.nativeElement,"as-max"):this.renderer.removeClass(this.elRef.nativeElement,"as-max")}lockEvents(){this.ngZone.runOutsideAngular(()=>{this.lockListeners.push(this.renderer.listen(this.elRef.nativeElement,"selectstart",e=>!1)),this.lockListeners.push(this.renderer.listen(this.elRef.nativeElement,"dragstart",e=>!1))})}unlockEvents(){for(;this.lockListeners.length>0;){const e=this.lockListeners.pop();e&&e()}}ngOnDestroy(){this.unlockEvents(),this.transitionListener&&this.transitionListener(),this.split.removeArea(this)}}b.\u0275fac=function(e){return new(e||b)(n["\u0275\u0275directiveInject"](n.NgZone),n["\u0275\u0275directiveInject"](n.ElementRef),n["\u0275\u0275directiveInject"](n.Renderer2),n["\u0275\u0275directiveInject"](x))},b.\u0275dir=n["\u0275\u0275defineDirective"]({type:b,selectors:[["as-split-area"],["","as-split-area",""]],inputs:{order:"order",size:"size",minSize:"minSize",maxSize:"maxSize",lockSize:"lockSize",visible:"visible"},exportAs:["asSplitArea"]}),b.ctorParameters=()=>[{type:n.NgZone},{type:n.ElementRef},{type:n.Renderer2},{type:x}],b.propDecorators={order:[{type:n.Input}],size:[{type:n.Input}],minSize:[{type:n.Input}],maxSize:[{type:n.Input}],lockSize:[{type:n.Input}],visible:[{type:n.Input}]};class C{static forRoot(){return{ngModule:C,providers:[]}}static forChild(){return{ngModule:C,providers:[]}}}C.\u0275fac=function(e){return new(e||C)},C.\u0275mod=n["\u0275\u0275defineNgModule"]({type:C}),C.\u0275inj=n["\u0275\u0275defineInjector"]({imports:[[o.CommonModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&n["\u0275\u0275setNgModuleScope"](C,{declarations:function(){return[x,b]},imports:function(){return[o.CommonModule]},exports:function(){return[x,b]}})},"./node_modules/css-element-queries/index.js":(e,t,i)=>{e.exports={ResizeSensor:i("./node_modules/css-element-queries/src/ResizeSensor.js"),ElementQueries:i("./node_modules/css-element-queries/src/ElementQueries.js")}},"./node_modules/css-element-queries/src/ElementQueries.js":function(e,t,i){"use strict";var n,o,r;"undefined"!=typeof window&&window,o=[i("./node_modules/css-element-queries/src/ResizeSensor.js")],void 0===(r="function"==typeof(n=function(e){var t=function(){var t,i={},n=[];function o(e){e||(e=document.documentElement);var t=window.getComputedStyle(e,null).fontSize;return parseFloat(t)||16}function r(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function a(e,t){var i=t.split(/\d/),n=i[i.length-1];switch(t=parseFloat(t),n){case"px":default:return t;case"em":return t*o(e);case"rem":return t*o();case"vw":return t*document.documentElement.clientWidth/100;case"vh":return t*document.documentElement.clientHeight/100;case"vmin":case"vmax":var r=document.documentElement.clientWidth/100,a=document.documentElement.clientHeight/100;return t*(0,Math["vmin"===n?"min":"max"])(r,a)}}function s(e,t){var n,o,s,l,d,c,p,m;this.element=e;var u=["min-width","min-height","max-width","max-height"];this.call=function(){for(n in s=r(this.element),c={},i[t])i[t].hasOwnProperty(n)&&(o=i[t][n],l=a(this.element,o.value),d="width"===o.property?s.width:s.height,m=o.mode+"-"+o.property,p="","min"===o.mode&&d>=l&&(p+=o.value),"max"===o.mode&&d<=l&&(p+=o.value),c[m]||(c[m]=""),p&&-1===(" "+c[m]+" ").indexOf(" "+p+" ")&&(c[m]+=" "+p));for(var e in u)u.hasOwnProperty(e)&&(c[u[e]]?this.element.setAttribute(u[e],c[u[e]].substr(1)):this.element.removeAttribute(u[e]))}}function l(t,i){t.elementQueriesSetupInformation||(t.elementQueriesSetupInformation=new s(t,i)),t.elementQueriesSensor||(t.elementQueriesSensor=new e(t,function(){t.elementQueriesSetupInformation.call()}))}function d(e,o,r,a){if(void 0===i[e]){i[e]=[];var s=n.length;t.innerHTML+="\n"+e+" {animation: 0.1s element-queries;}",t.innerHTML+="\n"+e+" > .resize-sensor {min-width: "+s+"px;}",n.push(e)}i[e].push({mode:o,property:r,value:a})}function c(e){var t;if(document.querySelectorAll&&(t=e?e.querySelectorAll.bind(e):document.querySelectorAll.bind(document)),t||"undefined"==typeof $$||(t=$$),t||"undefined"==typeof jQuery||(t=jQuery),!t)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return t}function p(e){var t=c(e);for(var n in i)if(i.hasOwnProperty(n))for(var o=t(n,e),r=0,a=o.length;r<a;r++)l(o[r],n)}function m(t){var i=[],n=[],o=[],r=0,a=-1,s=[];for(var l in t.children)if(t.children.hasOwnProperty(l)&&t.children[l].tagName&&"img"===t.children[l].tagName.toLowerCase()){i.push(t.children[l]);var d=t.children[l].getAttribute("min-width")||t.children[l].getAttribute("data-min-width"),c=t.children[l].getAttribute("data-src")||t.children[l].getAttribute("url");o.push(c);var p={minWidth:d};n.push(p),d?t.children[l].style.display="none":(r=i.length-1,t.children[l].style.display="block")}function m(){var e,l=!1;for(e in i)i.hasOwnProperty(e)&&n[e].minWidth&&t.offsetWidth>n[e].minWidth&&(l=e);if(l||(l=r),a!==l)if(s[l])i[a].style.display="none",i[l].style.display="block",a=l;else{var d=new Image;d.onload=function(){i[l].src=o[l],i[a].style.display="none",i[l].style.display="block",s[l]=!0,a=l},d.src=o[l]}else i[l].src=o[l]}a=r,t.resizeSensorInstance=new e(t,m),m()}function u(){for(var e=c()("[data-responsive-image],[responsive-image]"),t=0,i=e.length;t<i;t++)m(e[t])}var f=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,h=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function g(e){var t,i,n,o;for(e=e.replace(/'/g,'"');null!==(t=f.exec(e));)for(i=t[1]+t[3],n=t[2];null!==(o=h.exec(n));)d(i,o[1],o[2],o[3])}function v(e){var t="";if(e)if("string"==typeof e)-1===(e=e.toLowerCase()).indexOf("min-width")&&-1===e.indexOf("max-width")||g(e);else for(var i=0,n=e.length;i<n;i++)1===e[i].type?-1!==(t=e[i].selectorText||e[i].cssText).indexOf("min-height")||-1!==t.indexOf("max-height")?g(t):-1===t.indexOf("min-width")&&-1===t.indexOf("max-width")||g(t):4===e[i].type?v(e[i].cssRules||e[i].rules):3===e[i].type&&e[i].styleSheet.hasOwnProperty("cssRules")&&v(e[i].styleSheet.cssRules)}var y=!1;this.init=function(){var i="animationstart";void 0!==document.documentElement.style.webkitAnimationName?i="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?i="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(i="oanimationstart"),document.body.addEventListener(i,function(t){var i=t.target,o=i&&window.getComputedStyle(i,null),r=o&&o.getPropertyValue("animation-name");if(r&&-1!==r.indexOf("element-queries")){i.elementQueriesSensor=new e(i,function(){i.elementQueriesSetupInformation&&i.elementQueriesSetupInformation.call()});var a=window.getComputedStyle(i.resizeSensor,null).getPropertyValue("min-width");a=parseInt(a.replace("px","")),l(t.target,n[a])}}),y||((t=document.createElement("style")).type="text/css",t.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",t.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(t),y=!0);for(var o=0,r=document.styleSheets.length;o<r;o++)try{document.styleSheets[o].href&&0===document.styleSheets[o].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[o].href),v(document.styleSheets[o].cssRules||document.styleSheets[o].rules||document.styleSheets[o].cssText)}catch(a){}u()},this.findElementQueriesElements=function(e){p(e)},this.update=function(){this.init()}};t.update=function(){t.instance.update()},t.detach=function(e){e.elementQueriesSetupInformation?(e.elementQueriesSensor.detach(),delete e.elementQueriesSetupInformation,delete e.elementQueriesSensor):e.resizeSensorInstance&&(e.resizeSensorInstance.detach(),delete e.resizeSensorInstance)},t.init=function(){t.instance||(t.instance=new t),t.instance.init()};var i=function(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var t=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(e(),clearInterval(t))},10);else window.onload=e};return t.findElementQueriesElements=function(e){t.instance.findElementQueriesElements(e)},t.listen=function(){i(t.init)},t})?n.apply(t,o):n)||(e.exports=r)},"./node_modules/css-element-queries/src/ResizeSensor.js":function(e,t,i){"use strict";var n,o;"undefined"!=typeof window&&window,void 0===(o="function"==typeof(n=function(){if("undefined"==typeof window)return null;var e="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),t=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||function(t){return e.setTimeout(t,20)},i=e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelAnimationFrame||function(t){e.clearTimeout(t)};function n(e,t){var i=Object.prototype.toString.call(e),n="[object Array]"===i||"[object NodeList]"===i||"[object HTMLCollection]"===i||"[object Object]"===i||"undefined"!=typeof jQuery&&e instanceof jQuery||"undefined"!=typeof Elements&&e instanceof Elements,o=0,r=e.length;if(n)for(;o<r;o++)t(e[o]);else t(e)}function o(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function r(e,t){Object.keys(t).forEach(function(i){e.style[i]=t[i]})}var a=function(e,s){var l=0;function d(){var e,t,i=[];this.add=function(e){i.push(e)},this.call=function(n){for(e=0,t=i.length;e<t;e++)i[e].call(this,n)},this.remove=function(n){var o=[];for(e=0,t=i.length;e<t;e++)i[e]!==n&&o.push(i[e]);i=o},this.length=function(){return i.length}}function c(e,i){if(e)if(e.resizedAttached)e.resizedAttached.add(i);else{e.resizedAttached=new d,e.resizedAttached.add(i),e.resizeSensor=document.createElement("div"),e.resizeSensor.dir="ltr",e.resizeSensor.className="resize-sensor";var n={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},a={position:"absolute",left:"0px",top:"0px",transition:"0s"};r(e.resizeSensor,n);var s=document.createElement("div");s.className="resize-sensor-expand",r(s,n);var c=document.createElement("div");r(c,a),s.appendChild(c);var p=document.createElement("div");p.className="resize-sensor-shrink",r(p,n);var m=document.createElement("div");r(m,a),r(m,{width:"200%",height:"200%"}),p.appendChild(m),e.resizeSensor.appendChild(s),e.resizeSensor.appendChild(p),e.appendChild(e.resizeSensor);var u=window.getComputedStyle(e),f=u?u.getPropertyValue("position"):null;"absolute"!==f&&"relative"!==f&&"fixed"!==f&&"sticky"!==f&&(e.style.position="relative");var h=!1,g=0,v=o(e),y=0,x=0,b=!0;l=0;var C=function(){var t=e.offsetWidth,i=e.offsetHeight;c.style.width=t+10+"px",c.style.height=i+10+"px",s.scrollLeft=t+10,s.scrollTop=i+10,p.scrollLeft=t+10,p.scrollTop=i+10},S=function(){if(b){if(0===e.offsetWidth&&0===e.offsetHeight)return void(l||(l=t(function(){l=0,S()})));b=!1}C()};e.resizeSensor.resetSensor=S;var w=function(){g=0,h&&(y=v.width,x=v.height,e.resizedAttached&&e.resizedAttached.call(v))},D=function(){v=o(e),(h=v.width!==y||v.height!==x)&&!g&&(g=t(w)),S()},R=function(e,t,i){e.attachEvent?e.attachEvent("on"+t,i):e.addEventListener(t,i)};R(s,"scroll",D),R(p,"scroll",D),l=t(function(){l=0,S()})}}n(e,function(e){c(e,s)}),this.detach=function(t){l||(i(l),l=0),a.detach(e,t)},this.reset=function(){e.resizeSensor.resetSensor()}};if(a.reset=function(e){n(e,function(e){e.resizeSensor.resetSensor()})},a.detach=function(e,t){n(e,function(e){e&&(e.resizedAttached&&"function"==typeof t&&(e.resizedAttached.remove(t),e.resizedAttached.length())||e.resizeSensor&&(e.contains(e.resizeSensor)&&e.removeChild(e.resizeSensor),delete e.resizeSensor,delete e.resizedAttached))})},"undefined"!=typeof MutationObserver){var s=new MutationObserver(function(e){for(var t in e)if(e.hasOwnProperty(t))for(var i=e[t].addedNodes,n=0;n<i.length;n++)i[n].resizeSensor&&a.reset(i[n])});document.addEventListener("DOMContentLoaded",function(e){s.observe(document.body,{childList:!0,subtree:!0})})}return a})?n.call(t,i,t,e):n)||(e.exports=o)}}]);
//# sourceMappingURL=node_modules_helix_platform_fesm2015_helix-platform-view-runtime-page_js.js.map