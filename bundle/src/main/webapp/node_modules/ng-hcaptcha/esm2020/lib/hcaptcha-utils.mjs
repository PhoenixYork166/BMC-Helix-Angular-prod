import { Observable } from 'rxjs';
/**
 * Load the hCaptcha script by appending a script element to the head element.
 * The script won't be loaded again if it has already been loaded.
 * Async and defer are set to prevent blocking the renderer while loading hCaptcha.
 */
export function loadHCaptcha(languageCode) {
    return new Observable((observer) => {
        // No window object (ssr)
        if (!window) {
            return;
        }
        // The hCaptcha script has already been loaded
        if (typeof window.hcaptcha !== 'undefined') {
            observer.next();
            observer.complete();
            return;
        }
        let src = 'https://hcaptcha.com/1/api.js?render=explicit';
        // Set language code
        if (languageCode) {
            src += `&hl=${languageCode}`;
        }
        const script = document.createElement('script');
        script.src = src;
        script.async = true;
        script.defer = true;
        script.onerror = (e) => observer.error(e);
        script.onload = () => {
            observer.next();
            observer.complete();
        };
        document.head.appendChild(script);
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGNhcHRjaGEtdXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZy1oY2FwdGNoYS9zcmMvbGliL2hjYXB0Y2hhLXV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQWMsTUFBTSxNQUFNLENBQUM7QUFJOUM7Ozs7R0FJRztBQUNILE1BQU0sVUFBVSxZQUFZLENBQUMsWUFBcUI7SUFDaEQsT0FBTyxJQUFJLFVBQVUsQ0FBTyxDQUFDLFFBQTBCLEVBQUUsRUFBRTtRQUN6RCx5QkFBeUI7UUFDekIsSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUNYLE9BQU87U0FDUjtRQUVELDhDQUE4QztRQUM5QyxJQUFJLE9BQU8sTUFBTSxDQUFDLFFBQVEsS0FBSyxXQUFXLEVBQUU7WUFDMUMsUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ2hCLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUNwQixPQUFPO1NBQ1I7UUFFRCxJQUFJLEdBQUcsR0FBRywrQ0FBK0MsQ0FBQztRQUUxRCxvQkFBb0I7UUFDcEIsSUFBSSxZQUFZLEVBQUU7WUFDaEIsR0FBRyxJQUFJLE9BQU8sWUFBWSxFQUFFLENBQUM7U0FDOUI7UUFFRCxNQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2hELE1BQU0sQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDO1FBQ2pCLE1BQU0sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO1FBQ3BCLE1BQU0sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO1FBQ3BCLE1BQU0sQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDMUMsTUFBTSxDQUFDLE1BQU0sR0FBRyxHQUFHLEVBQUU7WUFDbkIsUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ2hCLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUN0QixDQUFDLENBQUM7UUFDRixRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNwQyxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJzY3JpYmVyIH0gZnJvbSAncnhqcyc7XHJcblxyXG5kZWNsYXJlIGNvbnN0IHdpbmRvdzogYW55O1xyXG5cclxuLyoqXHJcbiAqIExvYWQgdGhlIGhDYXB0Y2hhIHNjcmlwdCBieSBhcHBlbmRpbmcgYSBzY3JpcHQgZWxlbWVudCB0byB0aGUgaGVhZCBlbGVtZW50LlxyXG4gKiBUaGUgc2NyaXB0IHdvbid0IGJlIGxvYWRlZCBhZ2FpbiBpZiBpdCBoYXMgYWxyZWFkeSBiZWVuIGxvYWRlZC5cclxuICogQXN5bmMgYW5kIGRlZmVyIGFyZSBzZXQgdG8gcHJldmVudCBibG9ja2luZyB0aGUgcmVuZGVyZXIgd2hpbGUgbG9hZGluZyBoQ2FwdGNoYS5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBsb2FkSENhcHRjaGEobGFuZ3VhZ2VDb2RlPzogc3RyaW5nKTogT2JzZXJ2YWJsZTx2b2lkPiB7XHJcbiAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPHZvaWQ+KChvYnNlcnZlcjogU3Vic2NyaWJlcjx2b2lkPikgPT4ge1xyXG4gICAgLy8gTm8gd2luZG93IG9iamVjdCAoc3NyKVxyXG4gICAgaWYgKCF3aW5kb3cpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRoZSBoQ2FwdGNoYSBzY3JpcHQgaGFzIGFscmVhZHkgYmVlbiBsb2FkZWRcclxuICAgIGlmICh0eXBlb2Ygd2luZG93LmhjYXB0Y2hhICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICBvYnNlcnZlci5uZXh0KCk7XHJcbiAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgc3JjID0gJ2h0dHBzOi8vaGNhcHRjaGEuY29tLzEvYXBpLmpzP3JlbmRlcj1leHBsaWNpdCc7XHJcblxyXG4gICAgLy8gU2V0IGxhbmd1YWdlIGNvZGVcclxuICAgIGlmIChsYW5ndWFnZUNvZGUpIHtcclxuICAgICAgc3JjICs9IGAmaGw9JHtsYW5ndWFnZUNvZGV9YDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcclxuICAgIHNjcmlwdC5zcmMgPSBzcmM7XHJcbiAgICBzY3JpcHQuYXN5bmMgPSB0cnVlO1xyXG4gICAgc2NyaXB0LmRlZmVyID0gdHJ1ZTtcclxuICAgIHNjcmlwdC5vbmVycm9yID0gKGUpID0+IG9ic2VydmVyLmVycm9yKGUpO1xyXG4gICAgc2NyaXB0Lm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgb2JzZXJ2ZXIubmV4dCgpO1xyXG4gICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xyXG4gICAgfTtcclxuICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcclxuICB9KTtcclxufVxyXG4iXX0=