{"version":3,"file":"area-graph-slider.component.js","sourceRoot":"","sources":["../../../../../libs/adapt-charts/src/area-graph/area-graph-slider.component.ts"],"names":[],"mappings":"AAAA,OAAO,EAEL,SAAS,EACT,UAAU,EACV,YAAY,EACZ,KAAK,EACL,MAAM,EAIN,MAAM,EAEN,SAAS,EACV,MAAM,eAAe,CAAC;AACvB,yCAAyC;AACzC,OAAO,KAAK,EAAE,MAAM,IAAI,CAAC;AAKzB,OAAO,EAAC,aAAa,EAAC,MAAM,MAAM,CAAC;AACnC,OAAO,EAAC,IAAI,EAAE,SAAS,EAAC,MAAM,gBAAgB,CAAC;;;;;;;IAgCzC,oBAAoC;IAApC,6BAAoC;IAClC,0BAAA;IAAA,sBAGwC;IAExC,4BAAA;IAAA,yBAMoE;IAEpE,4BAAA;IAAA,sBAIqD;IACvD,wBAAA;IAAA,0BAAe;;;IAlBR,eAAuE;IAAvE,8GAAuE;IACvE,oDAAiC,+BAAA,iCAAA;IAIjC,eAA4B;IAA5B,0DAA4B;IAC5B,oDAAiC,cAAA,mCAAA,kCAAA,gCAAA;IAKjC,oFAAwD;IAExD,eAAsE;IAAtE,6GAAsE;IACtE,oDAAiC,+BAAA,uCAAA,8CAAA;;;;;AA5C9C,MAAM,WAAW,GAAG,oBAAoB,CAAC;AACzC,MAAM,gBAAgB,GAAG,EAAE,CAAC,CAAC,2DAA2D;AAuDxF,MAAM,OAAO,6BAA6B;IAmCxC,YAAoB,OAAe;QAAf,YAAO,GAAP,OAAO,CAAQ;QAhCnC,kBAAa,GAAY,KAAK,CAAC;QAE/B,aAAQ,GAAY,KAAK,CAAC;QAGjB,WAAM,GAAW,EAAE,CAAC;QAIpB,cAAS,GAAW,CAAC,CAAC;QAIZ,iBAAY,GAA2B,IAAI,YAAY,EAAY,CAAC;QACpE,cAAS,GAAuB,IAAI,YAAY,EAAE,CAAC;QAU9D,QAAG,GAAW,CAAC,CAAC;QAIhB,cAAS,GAAY,KAAK,CAAC;QAE3B,gBAAW,GAA2B,IAAI,aAAa,CAAC,CAAC,CAAC,CAAC;QAGjE,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;IAC3C,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,OAAO,CAAC,QAAQ;aAClB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;aAC1C,SAAS,CAAC,GAAG,EAAE;YACd,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;QAC5B,CAAC,CAAC,CAAC;IACP,CAAC;IAED,WAAW,CAAC,OAAsB;QAChC,IAAI,IAAI,CAAC,aAAa,IAAI,OAAO,CAAC,gBAAgB,EAAE;YAClD,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,EAAE,CAAC;YACtC,IAAI,CAAC,UAAU,EAAE,CAAC;SACnB;IACH,CAAC;IAED,eAAe;QACb,IAAI,CAAC,EAAE,GAAyB,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;QAC9E,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC/D,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAE/D,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACzB,IAAI,CAAC,UAAU,EAAE,CAAC;IACpB,CAAC;IAED,WAAW;QACT,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC5B,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC;IAC9B,CAAC;IAED,OAAO;QACL,OAAO,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;IACxD,CAAC;IAED,cAAc;QACZ,OAAO,IAAI,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC;IAC1C,CAAC;IAED,oBAAoB;QAClB,OAAO,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;IACtE,CAAC;IAED,YAAY,CAAC,QAAgB;QAC3B,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;IACrD,CAAC;IAED,YAAY,CAAC,QAAgB;QAC3B,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;IACrD,CAAC;IAED,YAAY,CAAC,GAAyB;QACpC,IAAI,CAAC,cAAc,GAAG,GAAG,CAAC,CAAC,CAAC;QAC5B,MAAM,EAAC,MAAM,EAAC,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,qBAAqB,EAAE,CAAC;QAEtE,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC;YAChC,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,SAAS;YACzB,CAAC,EAAE,MAAM,GAAG,IAAI,CAAC,gBAAgB,GAAG,CAAC;SACtC,CAAC,CAAC;QAEH,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,WAAW,EAAE;aAC3B,KAAK,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC;aAClC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;QAE9C,MAAM,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;QAErC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE,CAAC,CAAC;QAErC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,EAAE,CAAC;QACtC,IAAI,CAAC,UAAU,EAAE,CAAC;IACpB,CAAC;IAEO,iBAAiB;QACvB,IAAI,CAAC,EAAE;aACJ,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,cAAc,CAAC;aACzC,IAAI,CAAC,WAAW,EAAE,gBAAgB,IAAI,CAAC,MAAM,GAAG,CAAC;aACjD,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE,CAAC,CAAC;IACxC,CAAC;IAEO,qBAAqB;QAC3B,OAAO,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACpC,CAAC;IAEO,UAAU;QAChB,6BAA6B;QAC7B,4DAA4D;QAC5D,MAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,MAAM,EAAE;aACtB,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;aACrE,EAAE,CAAC,OAAO,EAAE;YACX,KAAK,CAAC,QAAQ,EAAE,CAAC;QACnB,CAAC,CAAC;aACD,EAAE,CAAC,WAAW,EAAE;YACf,KAAK,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;QACzB,CAAC,CAAC,CAAC;QAEL,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;QACvF,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAC5B,CAAC;IAEO,kBAAkB;QACxB,6BAA6B;QAC7B,4DAA4D;QAC5D,MAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,EAAE;aACJ,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC;aACtC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC;aAClC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;aACjB,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC;aAC9D,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC,cAAc,EAAE,KAAK,CAAC;aAC/E,EAAE,CAAC,WAAW,EAAE;YACf,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC;QACxB,CAAC,CAAC;aACD,EAAE,CAAC,WAAW,EAAE;YACf,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC;QACzB,CAAC,CAAC;aACD,EAAE,CAAC,UAAU,EAAE;YACd,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE;gBACpB,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC;aACxB;QACH,CAAC,CAAC,CAAC;aACJ,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC;aAC5B,KAAK,CAAC,EAAC,IAAI,EAAE,WAAW,EAAC,CAAC;aAC1B,EAAE,CAAC,WAAW,EAAE;YACf,MAAM,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,IAAmB,CAAC,CAAC;YAC3C,MAAM,CAAC,EAAE,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE,GAAG,KAAK,CAAC,UAAU,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC;YACxE,MAAM,CAAC,EAAE,EAAE,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;YAEtC,EAAE,CAAC,MAAM,CAAE,IAAoB,CAAC,UAAU,CAAC;iBACxC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,EAAE,GAAG,EAAE;gBAC9B,CAAC,CAAC,CAAC,EAAE,GAAG,KAAK,CAAC,UAAU,EAAE,EAAE,CAAC;gBAC7B,CAAC,CAAC,EAAE,GAAG,EAAE;oBACP,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,GAAG,KAAK,CAAC,UAAU,CAAC;oBAC7B,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC;QACpB,CAAC,CAAC,CAAC,CAAC;QACR,mBAAmB;QACnB,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,+BAA+B,CAAC,CAAC,MAAM,EAAE,CAAC;QAC5D,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;IACnF,CAAC;IAEO,QAAQ;QACd,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QACjC,MAAM,SAAS,GAAG,EAAE,CAAC,KAAK,CAAC,SAAS,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;QAE5D,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;QACzE,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;IACzB,CAAC;;0GA1LU,6BAA6B;gFAA7B,6BAA6B;;;;;;;;;;QAlDtC,sBAAA;QAAA,oCAEuC;QACrC,wBAAA;QAAA,yCAQ6D;QAE7D,0BAAA;QAAA,mBAO4B;QAP5B,iCAO4B;QAC5B,wBAAA;QAAA,iBAAM;QAEN,2BAAA;QAAA,mGAmBe;QAEf,2BAAA;QAAA,oBAA0C;QAA1C,4BAA0C;QACxC,2BAAA;QAAA,uBAAwC;QAC1C,yBAAA;QAAA,iBAAM;QACR,uBAAA;QAAA,iBAAM;QACR,qBAAA;;QA/CO,eAAqB;QAArB,8BAAqB;QACrB,kDAAiC;QAElB,eAAe;QAAf,iCAAe,sCAAA,sFAAA,oBAAA,sBAAA,yBAAA,sBAAA,wBAAA;QAc5B,eAA4D;QAA5D,sGAA4D;QAC5D,2DAAyC,sBAAA;QAI/B,eAAmB;QAAnB,wCAAmB;QAqB7B,eAAoC;QAApC,+DAAoC;QAClC,eAA4B;QAA5B,uDAA4B;;uFAK5B,6BAA6B;cArDzC,SAAS;eAAC;gBACT,QAAQ,EAAE,yBAAyB;gBACnC,QAAQ,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAiDT;aACF;yDAQU,KAAK;kBAAb,KAAK;YACG,MAAM;kBAAd,KAAK;YACG,gBAAgB;kBAAxB,KAAK;YACG,YAAY;kBAApB,KAAK;YACG,MAAM;kBAAd,KAAK;YACG,SAAS;kBAAjB,KAAK;YACG,cAAc;kBAAtB,KAAK;YACG,IAAI;kBAAZ,KAAK;YAEa,YAAY;kBAA9B,MAAM;YACY,SAAS;kBAA3B,MAAM;YAEiC,eAAe;kBAAtD,SAAS;mBAAC,mBAAmB;YACD,SAAS;kBAArC,SAAS;mBAAC,QAAQ;YAES,eAAe;kBAA1C,SAAS;mBAAC,OAAO","sourcesContent":["import {\n  AfterViewInit,\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  NgZone,\n  OnChanges,\n  OnDestroy,\n  OnInit,\n  Output,\n  SimpleChanges,\n  ViewChild\n} from '@angular/core';\n/* eslint-disable no-duplicate-imports */\nimport * as d3 from 'd3';\nimport {Axis, AxisDomain} from 'd3';\n/* eslint-enable no-duplicate-imports */\nimport {BrushBehavior} from 'd3-brush';\nimport {AdaptChartDimensions, AdaptSVGGroupElement} from '../common/models/chart.model';\nimport {ReplaySubject} from 'rxjs';\nimport {take, takeUntil} from 'rxjs/operators';\nimport {AdaptAreaGraphData} from '../common/models/area-graph.model';\n\nconst classPrefix = 'adapt-chart-slider';\nconst sliderPaddingTop = 10; // need to be aligned with the css $slider-padding-top: 10;\n\n@Component({\n  selector: 'adapt-area-graph-slider',\n  template: `\n    <div #slider\n         [class]=\"classPrefix\"\n         [style.marginLeft.px]=\"leftShift\">\n      <adapt-area-graph #chart\n                        [xAxis]=\"xAxis\"\n                        [yAxis]=\"{}\"\n                        [legend]=\"{items: [], customColors: customColors}\"\n                        [series]=\"data\"\n                        [height]=\"height\"\n                        [disallowPadding]=\"true\"\n                        [supressAxles]=\"true\"\n                        [suppressLegend]=\"true\"></adapt-area-graph>\n\n      <svg xmlns=\"http://www.w3.org/2000/svg\" #svgBrushContainer\n           class=\"adapt-chart-slider-brush-svg\"\n           tabindex=\"-1\"\n           role=\"graphic/image\"\n           aria-describedby=\"title desc\"\n           attr.viewbox=\"0 0 {{containerWidth - leftShift}} {{height}}\"\n           [attr.width]=\"containerWidth - leftShift\"\n           [attr.height]=\"height\">\n      </svg>\n\n      <ng-container *ngIf=\"isInitialized\">\n        <div class=\"{{classPrefix}}-side-overlay {{classPrefix}}-side-overlay-right\"\n             [style.top.px]=\"sliderPaddingTop\"\n             [style.height.px]=\"height\"\n             [style.width.px]=\"getXPos()\"></div>\n\n        <div class=\"{{classPrefix}}-spot\"\n             [style.top.px]=\"sliderPaddingTop\"\n             [style.zIndex]=\"1\"\n             [style.height.px]=\"height + 5\"\n             [style.width.px]=\"brushWidth\"\n             [style.left.px]=\"getXPos()\"\n             [ngClass]=\"isActive ? classPrefix + '-spot-active' : ''\"></div>\n\n        <div class=\"{{classPrefix}}-side-overlay {{classPrefix}}-side-overlay-left\"\n             [style.top.px]=\"sliderPaddingTop\"\n             [style.height.px]=\"height\"\n             [style.left.px]=\"getXOverlayPos()\"\n             [style.width.px]=\"getRightOverlayWidth()\"></div>\n      </ng-container>\n\n      <div class=\"{{classPrefix}}-line-wrapper\">\n        <div class=\"{{classPrefix}}-line\"></div>\n      </div>\n    </div>\n  `\n})\nexport class AdaptAreaGraphSliderComponent implements OnInit, OnChanges, AfterViewInit, OnDestroy {\n  classPrefix: string;\n  sliderPaddingTop: number;\n  isInitialized: boolean = false;\n  brushWidth: number;\n  isActive: boolean = false;\n\n  @Input() xAxis: Axis<AxisDomain>;\n  @Input() height: number = 35;\n  @Input() slidePointsCount: number;\n  @Input() customColors: string[];\n  @Input() xBrush: d3.ScaleLinear<number, number>;\n  @Input() leftShift: number = 0;\n  @Input() containerWidth: number;\n  @Input() data: AdaptAreaGraphData[];\n\n  @Output() readonly rangeChanged: EventEmitter<number[]> = new EventEmitter<number[]>();\n  @Output() readonly scrollEnd: EventEmitter<void> = new EventEmitter();\n\n  @ViewChild('svgBrushContainer') private _svgContainerEl: ElementRef<SVGElement>;\n  @ViewChild('slider') private _sliderEl: ElementRef;\n  /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n  @ViewChild('chart') private _chartComponent: any;\n\n  // TODO check for type improvements\n  //eslint-disable-next-line\n  private _brush: BrushBehavior<any>;\n  private _cX: number = 0;\n  private _xMinValue: number;\n  private _xMaxValue: number;\n  private _g: AdaptSVGGroupElement;\n  private _inMotion: boolean = false;\n  private _dndEl: SVGRectElement;\n  private _destroyed$: ReplaySubject<boolean> = new ReplaySubject(1);\n\n  constructor(private _ngZone: NgZone) {\n    this.classPrefix = classPrefix;\n    this.sliderPaddingTop = sliderPaddingTop;\n  }\n\n  ngOnInit(): void {\n    this._ngZone.onStable\n      .pipe(takeUntil(this._destroyed$), take(1))\n      .subscribe(() => {\n        this.isInitialized = true;\n      });\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (this.isInitialized && changes.slidePointsCount) {\n      this._g.select('.brush-wrp').remove();\n      this._initBrush();\n    }\n  }\n\n  ngAfterViewInit(): void {\n    this._g = <AdaptSVGGroupElement>d3.select(this._svgContainerEl.nativeElement);\n    this._xMinValue = this._chartComponent.getXMinValue(this.data);\n    this._xMaxValue = this._chartComponent.getXMaxValue(this.data);\n\n    this._renderBrushXAxis();\n    this._initBrush();\n  }\n\n  ngOnDestroy(): void {\n    this._destroyed$.next(true);\n    this._destroyed$.complete();\n  }\n\n  getXPos(): number {\n    return parseFloat(this._dndEl.getAttribute('x')) || 0;\n  }\n\n  getXOverlayPos(): number {\n    return this.getXPos() + this.brushWidth;\n  }\n\n  getRightOverlayWidth(): number {\n    return this.containerWidth - this.leftShift - this.getXOverlayPos();\n  }\n\n  showCategory(category: string): void {\n    this._chartComponent.categoryShowHandler(category);\n  }\n\n  hideCategory(category: string): void {\n    this._chartComponent.categoryHideHandler(category);\n  }\n\n  updateSlider(dim: AdaptChartDimensions): void {\n    this.containerWidth = dim.w;\n    const {height} = this._sliderEl.nativeElement.getBoundingClientRect();\n\n    this._chartComponent._updateChart({\n      w: dim.w - this.leftShift,\n      h: height - this.sliderPaddingTop * 2\n    });\n\n    this.xBrush = d3.scaleLinear()\n      .range([0, dim.w - this.leftShift])\n      .domain([this._xMinValue, this._xMaxValue]);\n\n    const x = this._g.select('.axis--x');\n\n    x.call(this._getXAxisLineRenderer());\n\n    this._g.select('.brush-wrp').remove();\n    this._initBrush();\n  }\n\n  private _renderBrushXAxis(): void {\n    this._g\n      .append('g').attr('class', 'axis axis--x')\n      .attr('transform', `translate(0, ${this.height})`)\n      .call(this._getXAxisLineRenderer());\n  }\n\n  private _getXAxisLineRenderer(): Axis<AxisDomain> {\n    return d3.axisBottom(this.xBrush);\n  }\n\n  private _initBrush(): void {\n    // TODO check for refactoring\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const _self = this;\n\n    this._brush = d3.brushX()\n      .extent([[0, 0], [this.containerWidth - this.leftShift, this.height]])\n      .on('brush', function (): void {\n        _self._brushed();\n      })\n      .on('end.brush', function (): void {\n        _self.scrollEnd.emit();\n      });\n\n    this.brushWidth = Math.ceil(this.xBrush((this.xBrush).ticks()[this.slidePointsCount]));\n    this._initBrushHandlers();\n  }\n\n  private _initBrushHandlers(): void {\n    // TODO check for refactoring\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const _self = this;\n\n    this._g\n      .append('g').attr('class', 'brush-wrp')\n      .append('g').attr('class', 'brush')\n      .call(this._brush)\n      .call(this._brush.move, [this._cX, this._cX + this.brushWidth])\n      .call(g => g.select('.selection').attr('stroke', null).attr('fill-opacity', '0.1')\n        .on('mouseover', function (): void {\n          _self.isActive = true;\n        })\n        .on('mousedown', function (): void {\n          _self._inMotion = true;\n        })\n        .on('mouseout', function (): void {\n          if (!_self._inMotion) {\n            _self.isActive = false;\n          }\n        }))\n      .call(g => g.select('.overlay')\n        .datum({type: 'selection'})\n        .on('mousedown', function (): void { // change slider spot position on slider click\n          const [cx] = d3.mouse(this as SVGGElement);\n          const [x0, x1] = [cx - _self.brushWidth / 2, cx + _self.brushWidth / 2];\n          const [r0, r1] = _self.xBrush.range();\n\n          d3.select((this as SVGGElement).parentNode)\n            .call(_self._brush.move, x1 > r1\n              ? [r1 - _self.brushWidth, r1]\n              : x0 < r0\n                ? [r0, r0 + _self.brushWidth]\n                : [x0, x1]);\n        }));\n    // prevent resizing\n    this._g.selectAll('.brush-wrp > .brush > .handle').remove();\n    this._dndEl = this._svgContainerEl.nativeElement.querySelector('rect.selection');\n  }\n\n  private _brushed(): void {\n    this._cX = d3.event.selection[0];\n    const selection = d3.event.selection || this.xBrush.range();\n\n    this.rangeChanged.emit(selection.map((this.xBrush).invert, this.xBrush));\n    this._inMotion = false;\n  }\n}\n"]}