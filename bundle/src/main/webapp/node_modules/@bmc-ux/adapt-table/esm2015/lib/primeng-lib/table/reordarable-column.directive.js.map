{"version":3,"file":"reordarable-column.directive.js","sourceRoot":"","sources":["../../../../../../../libs/adapt-table/src/lib/primeng-lib/table/reordarable-column.directive.ts"],"names":[],"mappings":"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","sourcesContent":["import {AfterViewInit, Directive, ElementRef, HostListener, Input, NgZone, OnDestroy} from '@angular/core';\nimport {AdaptTableComponent} from '../../adapt-table.component';\nimport {DomHandler} from 'primeng/dom';\nimport {isFunction} from 'lodash-es';\n\n\n@Directive({\n  // eslint-disable-next-line @angular-eslint/directive-selector\n  selector: '[pReorderableColumn]'\n})\n// eslint-disable-next-line @angular-eslint/directive-class-suffix\nexport class ReorderableColumn implements AfterViewInit, OnDestroy {\n\n  @Input() pReorderableColumnDisabled: boolean;\n\n  dragStartListener: EventListenerOrEventListenerObject;\n  dragOverListener: EventListenerOrEventListenerObject;\n  dragEnterListener: EventListenerOrEventListenerObject;\n  dragLeaveListener: EventListenerOrEventListenerObject;\n  mouseDownListener: EventListenerOrEventListenerObject;\n\n  constructor(public dt: AdaptTableComponent, public el: ElementRef<HTMLTableHeaderCellElement>, public zone: NgZone) {\n  }\n\n  ngAfterViewInit(): void {\n    if (this.isEnabled()) {\n      this.bindEvents();\n    }\n  }\n\n  bindEvents(): void {\n    this.zone.runOutsideAngular(() => {\n      this.mouseDownListener = this.onMouseDown.bind(this);\n      this.el.nativeElement.addEventListener('mousedown', this.mouseDownListener);\n\n      this.dragStartListener = this.onDragStart.bind(this);\n      this.el.nativeElement.addEventListener('dragstart', this.dragStartListener);\n\n      this.dragOverListener = this.onDragEnter.bind(this);\n      this.el.nativeElement.addEventListener('dragover', this.dragOverListener);\n\n      this.dragEnterListener = this.onDragEnter.bind(this);\n      this.el.nativeElement.addEventListener('dragenter', this.dragEnterListener);\n\n      this.dragLeaveListener = this.onDragLeave.bind(this);\n      this.el.nativeElement.addEventListener('dragleave', this.dragLeaveListener);\n    });\n  }\n\n  unbindEvents(): void {\n    if (this.mouseDownListener) {\n      document.removeEventListener('mousedown', this.mouseDownListener);\n      this.mouseDownListener = null;\n    }\n\n    if (this.dragOverListener) {\n      document.removeEventListener('dragover', this.dragOverListener);\n      this.dragOverListener = null;\n    }\n\n    if (this.dragEnterListener) {\n      document.removeEventListener('dragenter', this.dragEnterListener);\n      this.dragEnterListener = null;\n    }\n\n    if (this.dragEnterListener) {\n      document.removeEventListener('dragenter', this.dragEnterListener);\n      this.dragEnterListener = null;\n    }\n\n    if (this.dragLeaveListener) {\n      document.removeEventListener('dragleave', this.dragLeaveListener);\n      this.dragLeaveListener = null;\n    }\n  }\n\n  onMouseDown(event: MouseEvent): void {\n    if ((event.target as Node).nodeName === 'INPUT'\n      || (event.target as Node).nodeName === 'TEXTAREA'\n      || DomHandler.hasClass(event.target, 'ui-column-resizer')) {\n      this.el.nativeElement.draggable = false;\n    } else {\n      this.el.nativeElement.draggable = true;\n    }\n  }\n\n  onDragStart(event: DragEvent): void {\n    this.dt.onColumnDragStart(event, this.el.nativeElement);\n  }\n\n  onDragOver(event: DragEvent): void {\n    event.preventDefault();\n  }\n\n  onDragEnter(event: DragEvent): void {\n    this.onColumnDragEnter(event, this.el.nativeElement);\n  }\n\n  onDragLeave(event: DragEvent): void {\n    this.dt.onColumnDragLeave(event);\n  }\n\n  @HostListener('drop', ['$event'])\n  onDrop(event: DragEvent): void {\n    if (this.isEnabled()) {\n      this.dt.onColumnDrop(event, this.el.nativeElement);\n    }\n  }\n\n  onColumnDragEnter(event: DragEvent, dropHeader: HTMLTableHeaderCellElement): void {\n    if (!isFunction(this.dt.allowColumnReorderingResolver)) {\n      this.dt.onColumnDragEnter(event, dropHeader);\n    } else {\n      const draggedHeaderColumn = this.dt.dataHeaderCells.find(headerCell => headerCell.element.nativeElement === this.dt.draggedColumn);\n      const droppedHeaderColumn = this.dt.dataHeaderCells.find(headerCell => headerCell.element.nativeElement === dropHeader);\n      const allowColumnsReordering = draggedHeaderColumn && droppedHeaderColumn\n        && this.dt.allowColumnReorderingResolver(draggedHeaderColumn, droppedHeaderColumn);\n\n      if (allowColumnsReordering) {\n        this.dt.onColumnDragEnter(event, dropHeader);\n      } else {\n        event.dataTransfer.dropEffect = 'none';\n      }\n    }\n  }\n\n  isEnabled(): boolean {\n    return this.pReorderableColumnDisabled !== true;\n  }\n\n  ngOnDestroy(): void {\n    this.unbindEvents();\n  }\n\n}\n"]}