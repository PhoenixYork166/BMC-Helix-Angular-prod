{"version":3,"file":"simple-filter.component.js","sourceRoot":"","sources":["../../../../../../libs/adapt-angular/src/advanced-filtering/simple-filter/simple-filter.component.ts","../../../../../../libs/adapt-angular/src/advanced-filtering/simple-filter/simple-filter.component.html"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component, ElementRef,\n  EventEmitter,\n  Input,\n  NgZone,\n  OnDestroy,\n  OnInit,\n  Output,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {DOWN_ARROW, ENTER} from '@angular/cdk/keycodes';\nimport {ListKeyManager} from '@angular/cdk/a11y';\nimport {take, takeUntil} from 'rxjs/operators';\nimport {Subject} from 'rxjs';\nimport {isEqual} from 'lodash-es';\n\nimport {SimpleFilterOption, SimpleFilterTexts} from './simple-filter.models';\nimport {BaseFilterDirective} from '../base-filter';\nimport {AdaptTranslateService} from '../../common/i18n/index';\nimport {KeyValueObject} from '../../common/common.models';\nimport {getEventKeyCode} from '../../common/key-codes';\nimport {AdaptListKeyManagerItemDirective} from '../../common/list-key-manager/index';\nimport {AdaptDropdownDirective, AdaptDropdownMobileView} from '../../dropdown/index';\nimport {AdaptDeviceDetectionService} from '../../common/device-detection.service';\nimport {AdaptRadarAngularCustomEventName, AdaptRadarAngularService} from '../../common/radar/adapt-radar';\n\n@Component({\n  selector: 'adapt-simple-filter',\n  templateUrl: './simple-filter.component.html',\n  encapsulation: ViewEncapsulation.None\n})\nexport class AdaptSimpleFilterComponent extends BaseFilterDirective<SimpleFilterTexts> implements OnDestroy, OnInit {\n  activeDescendant: string;\n  isTablet: boolean;\n\n  get mobileViewConfig(): AdaptDropdownMobileView {\n    return {\n      title: this.texts.initialDropdownAnchorLabel,\n      isPicker: this.isTablet\n    };\n  }\n\n  @Input() activeFilterOption: SimpleFilterOption = null;\n\n  @Input() filterOptions: SimpleFilterOption[] = [];\n\n  /**\n   * This input controls if filter button (anchor) should be disabled\n   */\n  @Input() anchorDisabled: boolean = false;\n\n  @Output() readonly activeFilterOptionChange: EventEmitter<SimpleFilterOption> = new EventEmitter<SimpleFilterOption>();\n\n  @ViewChild('filtersDropdown', {static: true}) popup: AdaptDropdownDirective;\n\n  private _listKeyManager: ListKeyManager<AdaptListKeyManagerItemDirective>;\n  private _listKeyManagerDestroy: Subject<void> = new Subject<void>();\n\n  constructor(private _translateService: AdaptTranslateService,\n              private _deviceDetection: AdaptDeviceDetectionService,\n              private _ngZone: NgZone,\n              _adaptRadarService: AdaptRadarAngularService,\n              _elem: ElementRef<HTMLElement>) {\n    super(_translateService, _adaptRadarService, _elem, AdaptRadarAngularCustomEventName.AdaptSimpleFilter);\n  }\n\n  ngOnInit(): void {\n    this.isTablet = this._deviceDetection.deviceTablet();\n  }\n\n  ngOnDestroy(): void {\n    super.ngOnDestroy();\n\n    this._listKeyManagerDestroy.next();\n  }\n\n  get popupId(): string {\n    return this._uniqueId + '_popup';\n  }\n\n  setDefaultTexts(translation: KeyValueObject): void {\n    this.defaultTexts.noneOptionLabel = translation['adapt.common.none'];\n    this.defaultTexts.initialDropdownAnchorLabel = translation['adapt.simpleFilter.initialDropdownAnchorLabel'];\n  }\n\n  selectFilter(filterOption: SimpleFilterOption): void {\n    this.activeFilterOption = filterOption;\n    this.activeFilterOptionChange.emit(filterOption);\n  }\n\n  isActiveFilterOption(filterOption: SimpleFilterOption): boolean {\n    return this.activeFilterOption && filterOption.id === this.activeFilterOption.id;\n  }\n\n  isActiveDescendant(keyManagerItem: AdaptListKeyManagerItemDirective): boolean {\n    return keyManagerItem.getNativeElement().id === this.activeDescendant;\n  }\n\n  getDropdownAnchorLabel(): string {\n    return this.activeFilterOption ? this.activeFilterOption.label : this.texts.initialDropdownAnchorLabel;\n  }\n\n  keydownHandler(event: KeyboardEvent): void {\n    if (!this.popup.isOpen() && getEventKeyCode(event) === DOWN_ARROW) {\n      event.preventDefault();\n      this.popup.open();\n\n      return;\n    }\n\n    if (this._listKeyManager) {\n      this._listKeyManager.onKeydown(event);\n\n      if (getEventKeyCode(event) === ENTER) {\n        this.selectFilter(this._listKeyManager.activeItem.item);\n      }\n    }\n  }\n\n  keyManagerStateChange(listKeyManager?: ListKeyManager<AdaptListKeyManagerItemDirective>): void {\n    this._listKeyManager = listKeyManager;\n\n    if (this._listKeyManager) {\n      this._ngZone.onStable\n        .pipe(takeUntil(this._destroyed$), take(1))\n        .subscribe(() => {\n          const indexToActivate = this.activeFilterOption ?\n            this.filterOptions.findIndex(i => isEqual(i, this.activeFilterOption)) + 1 : 0;\n\n          this._listKeyManager.setActiveItem(indexToActivate);\n        });\n\n      this._listKeyManager.change\n        .pipe(takeUntil(this._listKeyManagerDestroy))\n        .subscribe(() => {\n          this.activeDescendant = this._listKeyManager.activeItem?.getNativeElement().id;\n        });\n\n      this._listKeyManager.tabOut\n        .pipe(takeUntil(this._listKeyManagerDestroy))\n        .subscribe(() => {\n          this.popup.close();\n        });\n    } else {\n      this._listKeyManagerDestroy.next();\n      this.activeDescendant = null;\n    }\n  }\n\n  onItemMouseover(index: number): void {\n    this._listKeyManager?.setActiveItem(index);\n  }\n}\n","<div #filtersDropdown=\"adaptDropdown\"\n     adaptDropdown\n     [adaptRadarDisableEventSending]=\"true\"\n     [appendToBody]=\"appendDropdownToBody\"\n     [holdFocusInMenu]=\"appendDropdownToBody\"\n     [restoreFocusAfterClose]=\"true\"\n     [mobileView]=\"mobileViewConfig\"\n     [placement]=\"dropdownPlacement\"\n     (onOpen)=\"dropdownOpenStateChange.emit(true)\"\n     (onClose)=\"dropdownOpenStateChange.emit(false)\">\n  <button type=\"button\"\n          class=\"btn btn-link px-0 d-icon-left-filter d-icon-right-triangle_down\"\n          adaptDropdownAnchor\n          [disabled]=\"anchorDisabled\"\n          [attr.data-testid]=\"testID + '_menu'\"\n          [attr.aria-controls]=\"filtersDropdown.isOpen() ? popupId : undefined\"\n          [attr.aria-expanded]=\"filtersDropdown.isOpen()\"\n          [attr.aria-activedescendant]=\"activeDescendant\"\n          (click)=\"filtersDropdown.toggle($event)\"\n          (keydown)=\"keydownHandler($event)\">\n    {{ getDropdownAnchorLabel() }}\n  </button>\n  <ng-template adaptDropdownMenuTemplate>\n    <div class=\"dropdown-menu simple-filter__dropdown-container\"\n         adaptListKeyManager\n         #adaptListKeyManager=\"adaptListKeyManager\"\n         [id]=\"popupId\"\n         (keyManagerStateChange)=\"keyManagerStateChange($event)\">\n      <button type=\"button\"\n              class=\"dropdown-item\"\n              tabindex=\"-1\"\n              adaptListKeyManagerItem\n              #adaptListKeyManagerNullItem=\"adaptListKeyManagerItem\"\n              [item]=\"null\"\n              [id]=\"_uniqueId + '_none-option'\"\n              [class.text-active]=\"isActiveDescendant(adaptListKeyManagerNullItem)\"\n              [attr.data-testid]=\"testID + '_item_none'\"\n              (click)=\"selectFilter(null)\"\n              (mouseover)=\"onItemMouseover(0)\">\n        <i>{{ texts.noneOptionLabel }}</i>\n      </button>\n      <button type=\"button\"\n              class=\"dropdown-item\"\n              tabindex=\"-1\"\n              adaptListKeyManagerItem\n              #adaptListKeyManagerItem=\"adaptListKeyManagerItem\"\n              *ngFor=\"let filterOption of filterOptions; let i = index;\"\n              [item]=\"filterOption\"\n              [id]=\"_uniqueId + '_' + filterOption.id\"\n              [class.text-active]=\"isActiveDescendant(adaptListKeyManagerItem)\"\n              [class.active]=\"isActiveFilterOption(filterOption)\"\n              [attr.data-testid]=\"testID + '_item_' + i\"\n              (click)=\"selectFilter(filterOption)\"\n              (mouseover)=\"onItemMouseover(i + 1)\">\n        {{ filterOption.label }}\n      </button>\n    </div>\n  </ng-template>\n</div>\n"]}