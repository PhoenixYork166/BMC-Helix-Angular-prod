import { fromEvent, merge } from 'rxjs';
import { mergeMap, map, startWith, take, takeUntil, tap } from 'rxjs/operators';
export function GetAngle(x1, y1, x2, y2) {
    const distX = x2 - x1;
    const distY = y2 - y1;
    // +450 for starting from 0
    return (Math.atan2(distY, distX) * (180 / Math.PI) + 450) % 360; // return angle in degrees
}
export function GetDistance(x1, y1, x2, y2) {
    const distX = x2 - x1;
    const distY = y2 - y1;
    return Math.sqrt(distX * distX + distY * distY);
}
export function GetDragNDrop(startEl, moveEl, endEl, startTap, endTap, preventDefault = true) {
    const mouseMap = (event) => {
        if (preventDefault && event.cancelable) {
            event.preventDefault();
        }
        return { x: event.clientX, y: event.clientY };
    };
    const touchMap = (event) => {
        if (preventDefault && event.cancelable) {
            event.preventDefault();
        }
        return { x: event.changedTouches[0].clientX, y: event.changedTouches[0].clientY };
    };
    const start$ = merge(fromEvent(startEl, 'mousedown', { passive: false }).pipe(map(mouseMap)), fromEvent(startEl, 'touchstart', { passive: false }).pipe(map(touchMap)));
    const move$ = merge(fromEvent(moveEl || window, 'mousemove', { passive: false }).pipe(map(mouseMap)), fromEvent(moveEl || window, 'touchmove', { passive: false }).pipe(map(touchMap)));
    const end$ = merge(fromEvent(endEl || window, 'mouseup', { passive: false }).pipe(map(mouseMap)), fromEvent(endEl || window, 'touchend', { passive: false }).pipe(map(touchMap)));
    const drag$ = start$.pipe(tap((startCoords) => {
        if (startTap) {
            startTap(startCoords);
        }
    }), mergeMap((start) => move$.pipe(startWith(start), 
    // TODO: Refactor this if possible
    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */
    map((move) => {
        return move;
    }), takeUntil(end$.pipe(take(1), tap((endCoords) => {
        if (endTap) {
            endTap(endCoords);
        }
    }))))));
    return drag$;
}
//# sourceMappingURL=drag-n-drop.js.map