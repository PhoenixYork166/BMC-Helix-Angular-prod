{"version":3,"file":"adapt-rx-rating-like.component.js","sourceRoot":"","sources":["../../../../../../../libs/adapt-angular/src/rx/rx-rating/adapt-rx-rating-like/adapt-rx-rating-like.component.ts","../../../../../../../libs/adapt-angular/src/rx/rx-rating/adapt-rx-rating-like/adapt-rx-rating-like.component.html"],"names":[],"mappings":"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","sourcesContent":["import {Component, ElementRef, EventEmitter, Input, Output, ViewEncapsulation} from '@angular/core';\nimport {cloneDeep} from 'lodash-es';\nimport {AdaptDeviceDetectionService} from '../../../common/device-detection.service';\n\nimport {Placement} from '../../../common/positioning';\nimport {\n  AdaptRadarAngularCustomEventName,\n  AdaptRadarAngularCustomEventType,\n  AdaptRadarAngularService,\n  AdaptRadarAngularGenericDirective\n} from '../../../common/radar/adapt-radar';\nimport {getInteractionSource} from '../../../common/interaction-source';\nimport {AdaptRxRatingConfigService} from '../adapt-rx-rating-config.service';\nimport {RxRatingLikeItem, RxRatingLikeScale, RxRatingLikeTexts, RxRatingSize} from '../adapt-rx-rating.types';\n\n@Component({\n  selector: 'adapt-rx-rating-like',\n  templateUrl: './adapt-rx-rating-like.component.html',\n  encapsulation: ViewEncapsulation.None\n})\nexport class AdaptRxRatingLikeComponent extends AdaptRadarAngularGenericDirective {\n  static Scales: Map<RxRatingLikeScale, RxRatingLikeItem[]> = new Map([\n    [\n      RxRatingLikeScale.ScalePoint5,\n      [\n        RxRatingLikeItem.Terrible,\n        RxRatingLikeItem.Disliked,\n        RxRatingLikeItem.Ok,\n        RxRatingLikeItem.Good,\n        RxRatingLikeItem.Excellent\n      ]\n    ],\n    [\n      RxRatingLikeScale.ScalePoint3,\n      [\n        RxRatingLikeItem.Disliked,\n        RxRatingLikeItem.Ok,\n        RxRatingLikeItem.Good,\n      ]\n    ]\n  ]);\n\n  UI_SIZE: typeof RxRatingSize = RxRatingSize;\n\n  ratingItemsClassNameMap: Map<RxRatingLikeItem, string> = new Map<RxRatingLikeItem, string>([\n    [RxRatingLikeItem.Terrible, 'is-terrible'],\n    [RxRatingLikeItem.Disliked, 'is-disliked'],\n    [RxRatingLikeItem.Ok, 'is-ok'],\n    [RxRatingLikeItem.Good, 'is-good'],\n    [RxRatingLikeItem.Excellent, 'is-excellent']\n  ]);\n\n  ratingValues: RxRatingLikeItem[];\n  ratingTooltips: string[];\n  selectedRate: RxRatingLikeItem = null;\n  isMobile: boolean = false;\n\n  /**\n   * Active rate\n   * @docs-default null\n   */\n  @Input() set rate(v: RxRatingLikeItem) {\n    this.selectedRate = v;\n  }\n\n  /**\n   * Scale point of rating\n   * @docs-default RxRatingLikeScale.ScalePoint5\n   */\n  @Input() set scale(nextScale: RxRatingLikeScale) {\n    switch (nextScale) {\n      case RxRatingLikeScale.ScalePoint3: {\n        this._scale = RxRatingLikeScale.ScalePoint3;\n        break;\n      }\n      default: {\n        this._scale = RxRatingLikeScale.ScalePoint5;\n        break;\n      }\n    }\n\n    this.ratingValues = AdaptRxRatingLikeComponent.Scales.get(this._scale);\n    this.ratingTooltips = this._getRatingTooltips(this._scale);\n  }\n\n  /**\n   * UI Texts\n   * @docs-default AdaptRxRatingConfigService.texts.like\n   */\n  @Input() set texts(newTexts: RxRatingLikeTexts) {\n    Object.assign(this._uiTexts, newTexts);\n    this.ratingTooltips = this._getRatingTooltips(this._scale);\n  }\n\n  /**\n   * Component size\n   * @docs-default RxRatingSize.sm\n   */\n  @Input() size: RxRatingSize = RxRatingSize.sm;\n\n  /**\n   * Tooltip placement\n   * @docs-default top\n   */\n  @Input() tooltipPlacement: Placement = 'top';\n\n  /**\n   * Disabled state\n   * @docs-default false\n   */\n  @Input() disabled: boolean = false;\n\n  /**\n   * Disabled rate items list\n   * @docs-default\n   */\n  @Input() disabledList: RxRatingLikeItem[];\n\n  /**\n   * @docs-default\n   */\n  @Input() testID: string;\n\n  /**\n   * @docs-default null\n   */\n  @Input() analyticsMetadata: {\n    label: string;\n  } = null;\n\n  /* eslint-disable @angular-eslint/no-output-on-prefix */\n  /**\n   * An event fired when a user selects a new rating.\n   */\n  @Output() readonly onRateChange: EventEmitter<RxRatingLikeItem> = new EventEmitter<RxRatingLikeItem>();\n  /* eslint-enable @angular-eslint/no-output-on-prefix */\n\n  readonly _uiTexts: RxRatingLikeTexts;\n  private _scale: RxRatingLikeScale = RxRatingLikeScale.ScalePoint5;\n\n  constructor(rxRatingConfigService: AdaptRxRatingConfigService,\n              protected _adaptRadarService: AdaptRadarAngularService,\n              private _deviceDetectionService: AdaptDeviceDetectionService,\n              _elem: ElementRef<HTMLElement>) {\n    super(_adaptRadarService, _elem, AdaptRadarAngularCustomEventName.AdaptRxRatingLike);\n\n    this.ratingValues = AdaptRxRatingLikeComponent.Scales.get(RxRatingLikeScale.ScalePoint5);\n    this._uiTexts = cloneDeep(rxRatingConfigService.texts.like);\n    this.ratingTooltips = this._getRatingTooltips(this._scale);\n    this.isMobile = this._deviceDetectionService.isMobile();\n  }\n\n  handleClick(event: MouseEvent, ratingItem: RxRatingLikeItem): void {\n    this._adaptRadarService.sendCustomEventForAllProviders(AdaptRadarAngularCustomEventName.AdaptRxRatingLike, {\n      GroupName: this.adaptRadarGroupName,\n      EventType: AdaptRadarAngularCustomEventType.Click,\n      Label: this.analyticsMetadata?.label,\n      FieldSize: this.size,\n      RatingEntered: !!this.rate,\n      RatingValue: this.rate,\n      Disabled: this.disabled,\n      SubmitMethod: getInteractionSource(event, this.isMobile)\n    });\n\n    if (!this.disabled) {\n      this._stopDisabled(event, ratingItem);\n      this.selectedRate = ratingItem;\n      this.onRateChange.emit(ratingItem);\n    }\n  }\n\n  private _stopDisabled(event: Event, ratingItem: RxRatingLikeItem): void {\n    if (this.disabledList && this.disabledList.indexOf(ratingItem) === -1) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  }\n\n  private _getRatingTooltips(scale: RxRatingLikeScale): string[] {\n    switch (scale) {\n      case RxRatingLikeScale.ScalePoint3: {\n        return [\n          this._uiTexts.tooltipDisliked,\n          this._uiTexts.tooltipOk,\n          this._uiTexts.tooltipGood\n        ];\n      }\n      default: {\n        return [\n          this._uiTexts.tooltipTerrible,\n          this._uiTexts.tooltipDisliked,\n          this._uiTexts.tooltipOk,\n          this._uiTexts.tooltipGood,\n          this._uiTexts.tooltipExcellent\n        ];\n      }\n    }\n  }\n}\n","<div class=\"a-rating a-rating_like\"\n     [class.a-rating_small]=\"size === UI_SIZE.sm\"\n     [class.a-rating_medium]=\"size === UI_SIZE.md\"\n     [class.a-rating_large]=\"size === UI_SIZE.lg\">\n  <ng-container *ngFor=\"let ratingItem of ratingValues;\n      let index = index;\">\n    <button type=\"button\"\n            class=\"a-rating__item\"\n            [ngClass]=\"ratingItemsClassNameMap.get(ratingItem)\"\n            [class.is-disabled]=\"disabledList && disabledList.indexOf(ratingItem) !== -1\"\n            [class.is-selected]=\"selectedRate === ratingItem\"\n            [class.is-inactive]=\"selectedRate !== ratingItem && selectedRate !== null || (disabledList && disabledList.indexOf(ratingItem) !== -1)\"\n            [attr.aria-label]=\"ratingTooltips[index]\"\n            [attr.data-testid]=\"testID + '_item-' + index\"\n            [adaptTooltip]=\"!disabled ? ratingTooltips[index] : ''\"\n            [adaptRadarDisableEventSending]=\"true\"\n            [placement]=\"tooltipPlacement\"\n            [disabled]=\"disabled || (disabledList && disabledList.indexOf(ratingItem) !== -1)\"\n            (click)=\"handleClick($event, ratingItem)\">\n    </button>\n  </ng-container>\n</div>\n\n"]}