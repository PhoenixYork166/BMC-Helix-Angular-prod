{"version":3,"file":"docked-panel.component.js","sourceRoot":"","sources":["../../../../../libs/adapt-angular/src/docked-panel/docked-panel.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  ComponentFactoryResolver, ElementRef,\n  EventEmitter,\n  Input,\n  OnDestroy,\n  OnInit,\n  Output,\n  Renderer2,\n  TemplateRef,\n  ViewChild,\n  ViewContainerRef\n} from '@angular/core';\nimport {query, transition, trigger, useAnimation} from '@angular/animations';\nimport {ReplaySubject} from 'rxjs';\nimport {takeUntil} from 'rxjs/operators';\n\nimport {AlertAnimatedConfig, AlertCloseEvent} from '../alert-animated/adapt-alert.model';\nimport {ANIMATION_NAME} from '../common/animation';\nimport {DismissReasons} from '../common/common.enums';\nimport {AdaptTranslateService} from '../common/i18n/index';\nimport {LayerService} from '../common/layer-service';\nimport {AdaptOverlayService} from '../common/overlay/index';\n\nimport {AdaptDockedPanelService} from './docked-panel.service';\nimport {AdaptDockedPanelConfig} from './docked-panel.config';\nimport {DockedPanelContent, DockedPanelInstance} from './docked-panel.model';\nimport {DockedPanelContext} from './docked-panel.context';\nimport {\n  AdaptRadarAngularCustomEventName,\n  AdaptRadarAngularGenericDirective,\n  AdaptRadarAngularService\n} from '../common/radar/adapt-radar';\n\n@Component({\n  selector: 'adapt-docked-panel',\n  template: `\n    <adapt-focus-holder [adaptFocusHolder]=\"true\" [preventScroll]=\"true\">\n      <fieldset [class]=\"'dp dp-size-' + (panel.config.size || defaultConfig.size)\"\n                [attr.data-testid]=\"panel.config.testID\"\n                role=\"document\"\n                [disabled]=\"panel.inactive\"\n                [class.inactive]=\"panel.inactive\">\n        <div class=\"dp-header\" *ngIf=\"panel.config.title\">\n          <button class=\"close dp-close\"\n                  [attr.aria-label]=\"closeText\"\n                  (click)=\"dismiss(dismissReason.CLOSE_BTN)\" type=\"button\"></button>\n          <span class=\"dp-title\">{{panel.config.title}}</span>\n        </div>\n        <adapt-alert-animated #alertsSection\n                              [adaptRadarDisableEventSending]=\"true\"\n                              [config]=\"alerts\"\n                              [isVisible]=\"alerts.length > 0\"\n                              (alertClosed)=\"alertClosed.emit($event)\"></adapt-alert-animated>\n        <div [class]=\"'dp-content ' + 'dp-footer-align_' + (panel.config.footerAlign || defaultConfig.footerAlign)\"\n             [class.float-footer]=\"panel.config.floatFooter || defaultConfig.floatFooter\">\n          <ng-template #contentPlacement></ng-template>\n        </div>\n\n        <adapt-over-modal [config]=\"panel.config.overModal\"\n                          [className]=\"'over-modal-dp'\"\n                          (onClose)=\"closeOverModal()\"\n                          *ngIf=\"panel.overModalOpen\"></adapt-over-modal>\n      </fieldset>\n    </adapt-focus-holder>\n  `,\n  // eslint-disable-next-line @angular-eslint/no-host-metadata-property\n  host: {\n    '[class.dp-wrapper]': 'true'\n  },\n  animations: [\n    trigger('overModalAnimation', [\n      transition('void => *', [\n        query('.modal-content', [\n          useAnimation(ANIMATION_NAME.popIn)\n        ])\n      ]),\n      transition('* => void', [\n        query('.modal-content', [\n          useAnimation(ANIMATION_NAME.popOut)\n        ])\n      ])\n    ])\n  ],\n  providers: [DockedPanelContext]\n})\nexport class AdaptDockedPanelComponent extends AdaptRadarAngularGenericDirective implements OnInit, OnDestroy {\n  modalClassInstance: boolean = true; // Needed for LayerService\n  dismissReason: typeof DismissReasons = DismissReasons;\n  defaultConfig: AdaptDockedPanelConfig;\n  closeText: string;\n  context: DockedPanelContext = {\n    close: this.close.bind(this),\n    dismiss: this.dismiss.bind(this),\n    openOverModal: this.openOverModal.bind(this),\n    getData: this._getData.bind(this)\n  };\n\n  // TODO: Refactor this if possible\n  /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n  overModal: any = {\n    title: null,\n    type: null,\n    contentString: null,\n    contentTemplate: null\n  };\n  alerts: AlertAnimatedConfig[] = [];\n\n  @Output() readonly alertClosed: EventEmitter<AlertCloseEvent> = new EventEmitter<AlertCloseEvent>();\n\n  @Input() panel: DockedPanelInstance;\n  @Input() floatFooter: boolean = false;\n\n  @ViewChild('contentPlacement', {read: ViewContainerRef, static: true}) contentPlacement: ViewContainerRef;\n\n  // TODO: Refactor this if possible\n  /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n  private _beforeDismiss: (reason: any) => boolean;\n  private _destroyed$: ReplaySubject<boolean> = new ReplaySubject(1);\n\n  @Input() set content(newContent: DockedPanelContent) {\n    if (newContent) {\n      this._loadContent(newContent);\n    }\n  }\n\n  constructor(private _dockedPanelConfig: AdaptDockedPanelConfig,\n              private _componentFactoryResolver: ComponentFactoryResolver,\n              private _dockedPanelContext: DockedPanelContext,\n              private _renderer2: Renderer2,\n              private _dockedPanelService: AdaptDockedPanelService,\n              private _layerService: LayerService,\n              private _overlayService: AdaptOverlayService,\n              public ts: AdaptTranslateService,\n              _adaptRadarService: AdaptRadarAngularService,\n              _elem: ElementRef<HTMLElement>) {\n    super(_adaptRadarService, _elem, AdaptRadarAngularCustomEventName.AdaptDockedPanel);\n\n    this.defaultConfig = _dockedPanelConfig;\n    Object.assign(this._dockedPanelContext, this.context);\n    this.closeText = ts.getCurrentLanguage()['adapt.common.close'];\n  }\n\n  ngOnInit(): void {\n    if (this.panel.config.overModal) {\n      this.overModal.title = this.panel.config.overModal.title;\n      this.overModal.type = this.panel.config.overModal.type;\n\n      if (this.panel.config.overModal.content instanceof TemplateRef) {\n        this.overModal.contentTemplate = this.panel.config.overModal.content;\n      } else {\n        this.overModal.contentString = this.panel.config.overModal.content;\n      }\n    }\n\n    this._dockedPanelService.alertsState\n      .pipe(takeUntil(this._destroyed$))\n      .subscribe(this._alertSubscriptionHandler.bind(this));\n\n    if (this.panel.config && this.panel.config.beforeDismiss) {\n      this._beforeDismiss = this.panel.config.beforeDismiss;\n    }\n\n    if (!this._overlayService.enableCDKOverlayControl) {\n      this._layerService.addComponent(this, () => {\n        this.panel.overModalOpen ? this.closeOverModal() : this.dismiss(DismissReasons.ESC);\n      });\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (!this._overlayService.enableCDKOverlayControl) {\n      this._layerService.removeComponent(this);\n    }\n  }\n\n  dismiss(reason: DismissReasons): void {\n    if (this._beforeDismiss && !this._beforeDismiss(reason)) {\n      return;\n    }\n\n    this.panel.promise.reject(reason);\n  }\n\n  /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n  close(result: any): void {\n    this.panel.promise.resolve(result);\n  }\n\n  openOverModal(): void {\n    this.panel.overModalOpen = true;\n  }\n\n  closeOverModal(): void {\n    this.panel.overModalOpen = false;\n  }\n\n  private _loadContent(content: DockedPanelContent): void {\n    this.contentPlacement.clear();\n\n    if (content instanceof TemplateRef) {\n      // TODO: Refactor this if possible\n      /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n      this.contentPlacement.createEmbeddedView(content as any, this.context);\n\n    } else if (typeof content === 'string') {\n      const modalBodyContainer = this.contentPlacement.element.nativeElement.parentNode;\n\n      const newNode = document.createElement('div');\n\n      newNode.classList.add('dp-body');\n      newNode.innerText = content;\n\n      modalBodyContainer.appendChild(newNode);\n\n    } else {\n      const factory = this._componentFactoryResolver.resolveComponentFactory(content);\n      const innerContent = this.contentPlacement.createComponent(factory);\n\n      this._renderer2.addClass(innerContent.location.nativeElement, 'dp-content-inner-wrapper');\n\n      this.panel.contentInstanceRef = innerContent.instance;\n    }\n  }\n\n  private _getData(): Object {\n    return this.panel.config ? this.panel.config.data : undefined;\n  }\n\n  private _alertSubscriptionHandler(newAlert: AlertAnimatedConfig): void {\n    this.alerts.unshift(newAlert);\n  }\n}\n"]}