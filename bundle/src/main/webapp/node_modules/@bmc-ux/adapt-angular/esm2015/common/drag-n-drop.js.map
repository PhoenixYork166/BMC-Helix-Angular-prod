{"version":3,"file":"drag-n-drop.js","sourceRoot":"","sources":["../../../../../libs/adapt-angular/src/common/drag-n-drop.ts"],"names":[],"mappings":"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","sourcesContent":["import {Point} from '@angular/cdk/drag-drop';\nimport {fromEvent, merge, Observable} from 'rxjs';\nimport {mergeMap, map, startWith, take, takeUntil, tap} from 'rxjs/operators';\n\nexport function GetAngle(x1: number, y1: number, x2: number, y2: number): number {\n  const distX = x2 - x1;\n  const distY = y2 - y1;\n\n  // +450 for starting from 0\n  return (Math.atan2(distY, distX) * (180 / Math.PI) + 450) % 360; // return angle in degrees\n}\n\nexport function GetDistance(x1: number, y1: number, x2: number, y2: number): number {\n  const distX = x2 - x1;\n  const distY = y2 - y1;\n\n  return Math.sqrt(distX * distX + distY * distY);\n}\n\nexport function GetDragNDrop(startEl: Window | Document | HTMLElement,\n                             moveEl?: HTMLElement,\n                             endEl?: HTMLElement,\n                             startTap?: (Coords: Point) => void,\n                             endTap?: (Coords: Point) => void,\n                             preventDefault: boolean = true): Observable<Point> {\n\n  const mouseMap = (event: MouseEvent): Point => {\n    if (preventDefault && event.cancelable) {\n      event.preventDefault();\n    }\n\n    return {x: event.clientX, y: event.clientY};\n  };\n\n  const touchMap = (event: TouchEvent): Point => {\n    if (preventDefault && event.cancelable) {\n      event.preventDefault();\n    }\n\n    return {x: event.changedTouches[0].clientX, y: event.changedTouches[0].clientY};\n  };\n\n  const start$ = merge(\n    fromEvent(startEl, 'mousedown', {passive: false}).pipe(map(mouseMap)),\n    fromEvent(startEl, 'touchstart', {passive: false}).pipe(map(touchMap)),\n  );\n  const move$ = merge(\n    fromEvent(moveEl || window, 'mousemove', {passive: false}).pipe(map(mouseMap)),\n    fromEvent(moveEl || window, 'touchmove', {passive: false}).pipe(map(touchMap)),\n  );\n  const end$ = merge(\n    fromEvent(endEl || window, 'mouseup', {passive: false}).pipe(map(mouseMap)),\n    fromEvent(endEl || window, 'touchend', {passive: false}).pipe(map(touchMap)),\n  );\n\n\n  const drag$ =\n    start$.pipe(\n      tap((startCoords) => {\n        if (startTap) {\n          startTap(startCoords);\n        }\n      }),\n      mergeMap(\n        (start) =>\n          move$.pipe(\n            startWith(start),\n            // TODO: Refactor this if possible\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            map((move: any) => {\n              return move;\n            }),\n            takeUntil(end$.pipe(\n              take(1),\n              tap((endCoords) => {\n                if (endTap) {\n                  endTap(endCoords);\n                }\n              })\n            ))\n          )\n      )\n    );\n\n  return drag$;\n}\n"]}