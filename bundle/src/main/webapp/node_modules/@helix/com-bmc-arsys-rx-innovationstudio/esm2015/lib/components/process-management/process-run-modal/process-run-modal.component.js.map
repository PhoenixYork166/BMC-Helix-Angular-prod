{"version":3,"file":"process-run-modal.component.js","sourceRoot":"","sources":["../../../../../../../../libs/com-bmc-arsys-rx-innovationstudio/src/lib/components/process-management/process-run-modal/process-run-modal.component.ts","../../../../../../../../libs/com-bmc-arsys-rx-innovationstudio/src/lib/components/process-management/process-run-modal/process-run-modal.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component } from '@angular/core';\nimport { DockedPanelContext } from '@bmc-ux/adapt-angular';\nimport { IPlainObject } from '@helix/platform/shared/api';\nimport { ProcessManagementService } from '../process-management.service';\nimport { isEmpty, has, isNull, isUndefined, includes } from 'lodash';\nimport { RX_RECORD_DEFINITION } from '@helix/platform/record/api';\n\n@Component({\n  selector: 'ax-process-run-modal',\n  templateUrl: './process-run-modal.component.html'\n})\nexport class ProcessRunModalComponent {\n  inputParamsModel: IPlainObject;\n  inputParamsControls: IPlainObject[];\n\n  constructor(public context: DockedPanelContext, private manageProcessesService: ProcessManagementService) {\n    this.inputParamsControls = this.manageProcessesService.buildInputParamsControls(context.getData().inputParams);\n    this.inputParamsModel = this.manageProcessesService.buildInputParamsModel(context.getData().inputParams);\n  }\n\n  onModelChange(model: IPlainObject): void {\n    this.inputParamsModel = {\n      ...this.inputParamsModel,\n      ...model\n    };\n  }\n\n  startProcess(): void {\n    this.onBeforeStart();\n    this.context.close(this.inputParamsModel);\n  }\n\n  isRunButtonDisabled(): boolean {\n    let isDisabled = false;\n\n    this.inputParamsControls\n      .filter((param) => param.options.required)\n      .map((param) => {\n        const value = this.inputParamsModel[param.name];\n\n        switch (param.dataType) {\n        case RX_RECORD_DEFINITION.resourceTypes.character:\n        case RX_RECORD_DEFINITION.resourceTypes.object:\n          if (isEmpty(value) || value?.trim().length === 0) {\n            isDisabled = true;\n          }\n          break;\n\n        case RX_RECORD_DEFINITION.resourceTypes.recordInstance:\n          if (\n            isEmpty(value) ||\n              !has(value, 'id') ||\n              !has(value, 'recordDefinitionName') ||\n              isEmpty(value.id) ||\n              isEmpty(value.recordDefinitionName)\n          ) {\n            isDisabled = true;\n          }\n          break;\n\n        default:\n          if (isNull(value) || isUndefined(value)) {\n            isDisabled = true;\n          }\n          break;\n        }\n      });\n\n    return isDisabled;\n  }\n\n  private onBeforeStart(): void {\n    this.inputParamsControls.map((param) => {\n      const value = this.inputParamsModel[param.name];\n\n      switch (param.dataType) {\n      case RX_RECORD_DEFINITION.resourceTypes.boolean: {\n        if (value === true) {\n          this.inputParamsModel[param.name] = '1';\n        } else if (value === false) {\n          this.inputParamsModel[param.name] = '0';\n        } else {\n          this.inputParamsModel[param.name] = value;\n        }\n\n        break;\n      }\n\n      case RX_RECORD_DEFINITION.resourceTypes.decimal:\n      case RX_RECORD_DEFINITION.resourceTypes.integer:\n      case RX_RECORD_DEFINITION.resourceTypes.real: {\n        this.inputParamsModel[param.name] = value?.toString() || null;\n\n        break;\n      }\n\n      case RX_RECORD_DEFINITION.resourceTypes.character: {\n        this.inputParamsModel[param.name] = value?.trim();\n\n        break;\n      }\n\n      case RX_RECORD_DEFINITION.resourceTypes.object: {\n        this.inputParamsModel[param.name] = value?.trim() || null;\n\n        break;\n      }\n      }\n    });\n  }\n}\n","<div class=\"modal-body\">\n  <rx-form-builder\n    *ngIf=\"inputParamsControls.length > 0\"\n    [config]=\"[{ controls: inputParamsControls }]\"\n    [model]=\"inputParamsModel\"\n    (modelChange)=\"onModelChange($event)\"\n  ></rx-form-builder>\n\n  <span *ngIf=\"inputParamsControls.length === 0\">{{\n    'com.bmc.arsys.rx.innovation-studio.process-management.run-process.no-input-params.label' | translate\n  }}</span>\n</div>\n\n<div class=\"modal-footer d-flex w-100\">\n  <button\n    adapt-button\n    type=\"button\"\n    btn-type=\"primary\"\n    rx-id=\"ok-button\"\n    [disabled]=\"isRunButtonDisabled()\"\n    (click)=\"startProcess()\"\n  >\n    {{ 'com.bmc.arsys.rx.innovation-studio.process-management.run-process.button.label' | translate }}\n  </button>\n\n  <button\n    adapt-button\n    type=\"button\"\n    btn-type=\"secondary\"\n    (click)=\"context.dismiss(0)\"\n    rx-id=\"cancel-button\"\n  >\n    {{ 'com.bmc.arsys.rx.client.common.cancel.label' | translate }}\n  </button>\n</div>\n"]}