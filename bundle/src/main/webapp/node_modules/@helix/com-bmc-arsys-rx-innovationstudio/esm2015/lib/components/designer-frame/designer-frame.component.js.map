{"version":3,"file":"designer-frame.component.js","sourceRoot":"","sources":["../../../../../../../libs/com-bmc-arsys-rx-innovationstudio/src/lib/components/designer-frame/designer-frame.component.ts","../../../../../../../libs/com-bmc-arsys-rx-innovationstudio/src/lib/components/designer-frame/designer-frame.component.html"],"names":[],"mappings":"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","sourcesContent":["import { HttpErrorResponse, HttpHeaders } from '@angular/common/http';\nimport { Component, HostListener, OnDestroy, OnInit } from '@angular/core';\nimport { ActivatedRoute, Data, NavigationEnd, Params, Router } from '@angular/router';\nimport {\n  DefinitionType,\n  IComponentCanDeactivate,\n  IPlainObject,\n  RX_APPLICATION,\n  RX_DESIGNER,\n  RxComponentCanDeactivateGuard,\n  RxDefinitionNameService,\n  RxGlobalCacheService,\n  RxPageTitleService,\n  RxPreviousStateService\n} from '@helix/platform/shared/api';\nimport { IIframeApi, RxIframeService } from '@helix/platform/shared/components';\nimport { RxUtilityModalsService } from '@helix/platform/ui-kit';\nimport { IWindowMessage, RxJsonParserService } from '@helix/platform/utils';\nimport { TranslateService } from '@ngx-translate/core';\nimport { capitalize, get, isEmpty, map as _map, noop } from 'lodash';\nimport { from, NEVER, ReplaySubject, Subscription, throwError } from 'rxjs';\nimport { filter, map, pairwise, startWith, switchMap, take, takeUntil, tap, withLatestFrom } from 'rxjs/operators';\nimport { AX_DESIGNER_FRAME } from './designer-frame.const';\nimport { RxGainsightConfiguratorService } from '@helix/platform/shared/components';\n\n@Component({\n  selector: 'ax-designer-frame',\n  templateUrl: './designer-frame.component.html',\n  styleUrls: ['./designer-frame.component.scss']\n})\nexport class DesignerFrameComponent implements OnInit, OnDestroy, IComponentCanDeactivate {\n  private iframeComponentApi: IIframeApi;\n  private currentBundleId: string;\n  private designerOptions: IPlainObject;\n  private isDefinitionDirty = false;\n  private intervalId;\n  private destroyed$ = new ReplaySubject(1);\n\n  busySubscription: Subscription;\n\n  constructor(\n    private router: Router,\n    private activatedRoute: ActivatedRoute,\n    private rxDefinitionNameService: RxDefinitionNameService,\n    private rxPageTitleService: RxPageTitleService,\n    private rxGlobalCacheService: RxGlobalCacheService,\n    private translateService: TranslateService,\n    private rxComponentCanDeactivateGuard: RxComponentCanDeactivateGuard,\n    private rxUtilityModalsService: RxUtilityModalsService,\n    private rxIframeService: RxIframeService,\n    private rxJsonParserService: RxJsonParserService,\n    private rxPreviousStateService: RxPreviousStateService,\n    private rxGainsightConfiguratorService: RxGainsightConfiguratorService\n  ) {\n    this.designerOptions = get(this.router.getCurrentNavigation(), 'extras.state.designerOptions');\n\n    this.router.events\n      .pipe(\n        filter((event) => event instanceof NavigationEnd),\n        withLatestFrom(this.activatedRoute.data, (_, data) => data),\n        startWith(undefined),\n        pairwise<Data>(),\n        withLatestFrom(this.activatedRoute.params, this.activatedRoute.queryParams),\n        tap(([[prevData, nextData], params]) => {\n          if (\n            (prevData?.designerMode &&\n              nextData.designerMode &&\n              prevData.designerMode !== AX_DESIGNER_FRAME.designerModes.new &&\n              nextData.designerMode !== AX_DESIGNER_FRAME.designerModes.edit) ||\n            prevData?.definitionType !== nextData.definitionType\n          ) {\n            this.intervalId = setInterval(noop, 100000);\n            this.busySubscription = NEVER.subscribe();\n          }\n\n          this.currentBundleId =\n            params.bundleId ||\n            this.rxDefinitionNameService.getBundleId(params.definitionName) ||\n            this.activatedRoute.parent.snapshot.data.defaultBundleId;\n\n          this.setPageTitle(\n            this.currentBundleId,\n            this.activatedRoute.parent.snapshot.data.definitionType,\n            this.activatedRoute.snapshot.data.legacyDesignerName,\n            params.definitionName\n          );\n        }),\n        map(([_, params, queryParams]) =>\n          this.buildDesignerUrl(\n            this.currentBundleId,\n            this.activatedRoute.parent.snapshot.data.definitionType,\n            this.activatedRoute.snapshot.data.legacyDesignerName,\n            params,\n            queryParams\n          )\n        ),\n        takeUntil(this.destroyed$)\n      )\n      .subscribe((url) => {\n        this.rxIframeService.showIframe(url);\n\n        this.iframeComponentApi = this.rxIframeService.getIframeApi();\n      });\n  }\n\n  ngOnInit() {\n    this.rxComponentCanDeactivateGuard.setPageComponent(this);\n\n    this.rxGainsightConfiguratorService.updateGlobalContext({\n      subProductLevel1: {\n        name: 'Design'\n      },\n      subProductLevel2: {\n        name: `${capitalize(this.activatedRoute.snapshot.data.definitionType)} designer`\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this.rxComponentCanDeactivateGuard.setPageComponent(null);\n\n    this.destroyed$.next();\n    this.destroyed$.complete();\n\n    this.rxIframeService.hideIframe();\n  }\n\n  canDeactivate(): boolean {\n    return !this.isDefinitionDirty;\n  }\n\n  confirmDeactivation(): Promise<boolean> {\n    return this.rxUtilityModalsService.confirmUnsavedChanges().then((isConfirmed) => {\n      if (isConfirmed) {\n        this.isDefinitionDirty = false;\n      }\n\n      return isConfirmed;\n    });\n  }\n\n  @HostListener('window:message', ['$event'])\n  onMessage(event: MessageEvent): void {\n    const windowMessage = this.rxJsonParserService.tryParseJson<IWindowMessage>(event.data);\n\n    switch (windowMessage?.messageType) {\n      case RX_DESIGNER.messageTypes.designerLoaded: {\n        this.busySubscription?.unsubscribe();\n        clearInterval(this.intervalId);\n\n        break;\n      }\n\n      case RX_DESIGNER.messageTypes.closeDesigner: {\n        if (\n          this.activatedRoute.parent.snapshot.data.definitionType === 'shell' ||\n          this.activatedRoute.snapshot.data.legacyDesignerName === AX_DESIGNER_FRAME.legacyDesignerNames.processPreview\n        ) {\n          this.rxPreviousStateService.goToPrevState();\n        } else if (\n          this.activatedRoute.snapshot.data.legacyDesignerName === AX_DESIGNER_FRAME.legacyDesignerNames.chatWizard\n        ) {\n          this.router.navigate([RX_APPLICATION.innovationStudioBundleId, this.activatedRoute.snapshot.params.bundleId]);\n        } else {\n          this.router.navigate([\n            RX_APPLICATION.innovationStudioBundleId,\n            this.currentBundleId,\n            `${this.activatedRoute.parent.snapshot.data.definitionType}-definitions`\n          ]);\n        }\n\n        break;\n      }\n\n      case RX_DESIGNER.messageTypes.afterSave: {\n        if (!windowMessage.payload.isEditMode) {\n          this.router.navigate(['edit', windowMessage.payload.definitionName], {\n            relativeTo: this.activatedRoute.parent\n          });\n        }\n\n        this.isDefinitionDirty = false;\n\n        break;\n      }\n\n      case RX_DESIGNER.messageTypes.waitingForDesignerOptions: {\n        this.iframeComponentApi.postMessageToFrame({\n          messageType: 'designerOptions',\n          payload: this.designerOptions\n        });\n\n        break;\n      }\n\n      case RX_DESIGNER.messageTypes.designerLoadFailed: {\n        this.busySubscription?.unsubscribe();\n        clearInterval(this.intervalId);\n\n        from(\n          this.router.navigate([\n            RX_APPLICATION.innovationStudioBundleId,\n            this.currentBundleId,\n            `${this.activatedRoute.parent.snapshot.data.definitionType}-definitions`\n          ])\n        )\n          .pipe(\n            switchMap(() => {\n              const err = windowMessage.payload.err;\n\n              return throwError(\n                new HttpErrorResponse({\n                  error: err.data,\n                  headers: new HttpHeaders(err.config.headers),\n                  status: err.status,\n                  statusText: err.statusText,\n                  url: err.config.url\n                })\n              );\n            })\n          )\n          .subscribe();\n\n        break;\n      }\n\n      case RX_DESIGNER.messageTypes.definitionStatusChanged: {\n        this.isDefinitionDirty = windowMessage.payload.isDirty;\n\n        break;\n      }\n    }\n  }\n\n  private buildDesignerUrl(\n    bundleId: string,\n    type: DefinitionType,\n    legacyDesignerName: string,\n    params: Params,\n    queryParams: Params\n  ): string {\n    const { definitionName, instanceId } = params;\n\n    const debugOptions = window['rx'].logger.getCategories();\n    const queryString = debugOptions.length ? `?debug=${debugOptions.join(',')}` : '';\n\n    const baseInnovationStudioUrl = `/${RX_APPLICATION.innovationStudioBundleId}/index.html${queryString}#`;\n\n    if (legacyDesignerName === AX_DESIGNER_FRAME.legacyDesignerNames.processPreview) {\n      return `${baseInnovationStudioUrl}/app/bundle/${bundleId}/iprocess-instance/view/${definitionName}/${instanceId}`;\n    } else if (legacyDesignerName === AX_DESIGNER_FRAME.legacyDesignerNames.chatWizard) {\n      return `${baseInnovationStudioUrl}/app/bundle/${bundleId}/enable-chat-for-service`;\n    } else if (legacyDesignerName === AX_DESIGNER_FRAME.legacyDesignerNames.recordDataEditor) {\n      return `${baseInnovationStudioUrl}/app/bundle/${bundleId}/irecord-data-editor/${definitionName}`;\n    } else if (type === 'shell') {\n      return `${baseInnovationStudioUrl}/app/bundle/${bundleId}/ishell/config`;\n    } else {\n      let baseUrl = `${baseInnovationStudioUrl}/app/bundle/${bundleId}/i${type}/${definitionName || ''}`;\n\n      if (!isEmpty(queryParams)) {\n        const queryParamsString = _map(\n          queryParams,\n          (value, name) => `${encodeURIComponent(name)}=${encodeURIComponent(value)}`\n        ).join('&');\n\n        baseUrl += `?${queryParamsString}`;\n      }\n\n      return this.designerOptions ? `${baseUrl}?waitForDesignerOptions=true` : baseUrl;\n    }\n  }\n\n  private setPageTitle(bundleId: string, type: string, legacyDesignerName: string, definitionName: string): void {\n    this.rxGlobalCacheService\n      .getBundleFriendlyName(bundleId)\n      .pipe(take(1))\n      .subscribe((bundleFriendlyName) => {\n        if (legacyDesignerName === AX_DESIGNER_FRAME.legacyDesignerNames.processPreview) {\n          this.rxPageTitleService.set(\n            [\n              this.translateService.instant(\n                'com.bmc.arsys.rx.innovation-studio.process-management.process-preview.title'\n              ),\n              bundleFriendlyName\n            ],\n            this.rxGlobalCacheService.applicationId\n          );\n        } else if (legacyDesignerName === AX_DESIGNER_FRAME.legacyDesignerNames.recordDataEditor) {\n          this.rxPageTitleService.set(\n            [\n              this.rxDefinitionNameService.getDisplayName(definitionName),\n              this.translateService.instant('com.bmc.arsys.rx.client.data-editor.title'),\n              bundleFriendlyName\n            ],\n            this.rxGlobalCacheService.applicationId\n          );\n        } else if (legacyDesignerName === AX_DESIGNER_FRAME.legacyDesignerNames.chatWizard) {\n          this.rxPageTitleService.set(\n            [\n              this.translateService.instant('com.bmc.arsys.rx.innovation-studio.publish-chat-enabled-service.label'),\n              bundleFriendlyName\n            ],\n            RX_APPLICATION.innovationStudioBundleId\n          );\n        } else if (type === 'shell') {\n          this.rxPageTitleService.set(\n            [RX_APPLICATION.shellDefinitionName, bundleFriendlyName],\n            RX_APPLICATION.innovationStudioBundleId\n          );\n        } else {\n          this.rxPageTitleService.set(\n            [\n              definitionName\n                ? this.rxDefinitionNameService.getDisplayName(definitionName)\n                : this.translateService.instant('com.bmc.arsys.rx.client.create-new.title'),\n              this.translateService.instant(AX_DESIGNER_FRAME.designerPageTitleKeys[type]),\n              bundleFriendlyName\n            ],\n            this.rxGlobalCacheService.applicationId\n          );\n        }\n      });\n  }\n}\n","<rx-busy-indicator [options]=\"{ busy: busySubscription }\"></rx-busy-indicator>\n"]}