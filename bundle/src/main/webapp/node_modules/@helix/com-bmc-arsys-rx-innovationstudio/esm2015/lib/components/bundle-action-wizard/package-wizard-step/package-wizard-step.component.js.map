{"version":3,"file":"package-wizard-step.component.js","sourceRoot":"","sources":["../../../../../../../../libs/com-bmc-arsys-rx-innovationstudio/src/lib/components/bundle-action-wizard/package-wizard-step/package-wizard-step.component.ts","../../../../../../../../libs/com-bmc-arsys-rx-innovationstudio/src/lib/components/bundle-action-wizard/package-wizard-step/package-wizard-step.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAC;AAClD,OAAO,EAAE,SAAS,EAAE,KAAK,EAAqB,MAAM,eAAe,CAAC;AAEpE,OAAO,EAGL,uBAAuB,EACvB,2BAA2B,EAC5B,MAAM,4BAA4B,CAAC;AACpC,OAAO,EAAE,sBAAsB,EAAE,MAAM,mCAAmC,CAAC;AAC3E,OAAO,EAAE,sBAAsB,EAAE,MAAM,wBAAwB,CAAC;AAChE,OAAO,EAAE,gBAAgB,EAAE,MAAM,qBAAqB,CAAC;AACvD,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,QAAQ,CAAC;AACjE,OAAO,EAAE,eAAe,EAAE,aAAa,EAAE,KAAK,EAAc,aAAa,EAAE,MAAM,MAAM,CAAC;AACxF,OAAO,EAAE,UAAU,EAAE,GAAG,EAAE,SAAS,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,cAAc,EAAE,MAAM,gBAAgB,CAAC;AAElG,OAAO,EAAE,yBAAyB,EAAE,MAAM,+DAA+D,CAAC;AAC1G,OAAO,EAAE,iBAAiB,EAAE,MAAM,8CAA8C,CAAC;;;;;;;;;;;AAOjF,MAAM,OAAO,0BAA0B;IA0ErC,YACU,UAAsB,EACtB,yBAAoD,EACpD,uBAAgD,EAChD,2BAAwD,EACxD,sBAA8C,EAC9C,sBAA8C,EAC/C,gBAAkC;QANjC,eAAU,GAAV,UAAU,CAAY;QACtB,8BAAyB,GAAzB,yBAAyB,CAA2B;QACpD,4BAAuB,GAAvB,uBAAuB,CAAyB;QAChD,gCAA2B,GAA3B,2BAA2B,CAA6B;QACxD,2BAAsB,GAAtB,sBAAsB,CAAwB;QAC9C,2BAAsB,GAAtB,sBAAsB,CAAwB;QAC/C,qBAAgB,GAAhB,gBAAgB,CAAkB;QA7EnC,wCAAmC,GAAa,IAAI,CAAC,uBAAuB,CAAC,eAAe,CAClG,uFAAuF,CACxF,CAAC;QAGM,eAAU,GAA2B,IAAI,aAAa,CAAC,CAAC,CAAC,CAAC;QAE1D,2BAAsB,GAAG,IAAI,eAAe,CAAS,EAAE,CAAC,CAAC;QACjE,qBAAgB,GAAG,IAAI,CAAC,sBAAsB,CAAC,YAAY,EAAE,CAAC;QAC9D,2BAAsB,GAAG,IAAI,CAAC;QAE9B,sBAAiB,GAAG;YAClB,OAAO,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CACpC,sFAAsF,CACvF;YACD,MAAM,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CACnC,qFAAqF,CACtF;YACD,SAAS,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CACtC,wFAAwF,CACzF;SACF,CAAC;QAEF,yCAAoC,GAAG,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,IAAI,CAC9E,GAAG,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,2BAA2B,CAAC,iCAAiC,CAAC,CAAC,CAClG,CAAC;QAEF,iCAA4B,GAAG,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,IAAI,CACtE,GAAG,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,kBAAkB,IAAI,OAAO,CAAC,2BAA2B,CAAC,2BAA2B,CAAC,CACrH,CAAC;QAEF,uDAAkD,GAAG,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,IAAI,CAC5F,GAAG,CACD,CAAC,OAAO,EAAE,EAAE,CACV,IAAI,CAAC,OAAO,CAAC,kBAAkB;YAC/B,CAAC,OAAO,CAAC,OAAO,CAAC,2BAA2B,CAAC,uCAAuC,CAAC,CACxF,CACF,CAAC;QAEF,yCAAoC,GAAG,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,IAAI,CAC9E,GAAG,CACD,CAAC,OAAO,EAAE,EAAE,CACV,IAAI,CAAC,OAAO,CAAC,kBAAkB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,2BAA2B,CAAC,yBAAyB,CAAC,CAC7G,CACF,CAAC;QAEF,yCAAoC,GAAG,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,IAAI,CAC9E,GAAG,CACD,CAAC,OAAO,EAAE,EAAE,CACV,IAAI,CAAC,OAAO,CAAC,kBAAkB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,2BAA2B,CAAC,yBAAyB,CAAC,CAC7G,CACF,CAAC;QAEF,wBAAmB,GAAG,aAAa,CAAC;YAClC,IAAI,CAAC,oCAAoC;YACzC,IAAI,CAAC,kDAAkD;YACvD,IAAI,CAAC,4BAA4B;YACjC,IAAI,CAAC,oCAAoC;SAC1C,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAE1D,mCAA8B,GAAG,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,IAAI,CACxE,cAAc,CAAC,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,gBAAgB,CAAC,EAC/D,GAAG,CACD,CAAC,CAAC,OAAO,EAAE,kBAAkB,EAAE,eAAe,CAAC,EAAE,EAAE,CACjD,eAAe,KAAK,IAAI,CAAC,iBAAiB,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,qBAAqB,IAAI,kBAAkB,CAC7G,CACF,CAAC;IAYC,CAAC;IAEJ,QAAQ;;QACN,IAAI,CAAC,yBAAyB,GAAG,aAAa,CAC5C;YACE,IAAI,CAAC,oCAAoC;YACzC,IAAI,CAAC,kDAAkD;YACvD,IAAI,CAAC,4BAA4B;YACjC,IAAI,CAAC,oCAAoC;SAC1C,CAAC,MAAM,CAAC,CAAA,MAAA,IAAI,CAAC,OAAO,0CAAE,yBAAyB,EAAC,CAAC,CAAC,CAAC,IAAI,CAAC,oCAAoC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CACrG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAE/C,IAAI,CAAC,sBAAsB,CAAC,MAAM;aAC/B,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE,IAAI,CAAC,gBAAgB,CAAC,EAAE,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAC9G,SAAS,CAAC,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,eAAe,CAAC,EAAE,EAAE;YAChD,IAAI,KAAK,CAAC,QAAQ,CAAC,CAAC,EAAE,KAAK,SAAS,IAAI,eAAe,KAAK,IAAI,CAAC,iBAAiB,CAAC,SAAS,EAAE;gBAC5F,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,iBAAiB,EAAE,CAAC;aACrD;QACH,CAAC,CAAC,CAAC;IACP,CAAC;IAED,WAAW;QACT,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC3B,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;IAC7B,CAAC;IAED,aAAa,CAAC,aAAsB,KAAK;QACvC,IAAI,CAAC,sBAAsB,CAAC,QAAQ;aACjC,IAAI,CACH,IAAI,CAAC,CAAC,CAAC,EACP,GAAG,CAAC,GAAG,EAAE;;YACP,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,aAAa,CAAC;gBAC5C,qBAAqB,EAAE,KAAK;aAC7B,CAAC,CAAC;YAEH,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;YAEjE,IAAI,MAAA,IAAI,CAAC,OAAO,0CAAE,yBAAyB,EAAE;gBAC3C,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,oBAAoB,CAClD,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAC3B,oGAAoG,CACrG,CACF,CAAC;gBAEF,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;aAC5C;QACH,CAAC,CAAC,EACF,GAAG,CAAC,CAAC,OAAO,EAAE,EAAE;YACd,MAAM,UAAU,GAAG;gBACjB,uBAAuB,EAAE,SAAS,CAAC,OAAO,CAAC,2BAA2B,CAAC;gBACvE,WAAW,EAAE,UAAU;aACxB,CAAC;YAEF,OAAO,CACL,UAAU,CAAC,uBAAuB,CAAC,uCAAuC,EAC1E,CAAC,sCAAsC,EAAE,EAAE;gBACzC,OAAO,sCAAsC,CAAC,4CAA4C,CAAC;gBAC3F,OAAO,sCAAsC,CAAC,oBAAoB,CAAC;gBACnE,OAAO,sCAAsC,CAAC,aAAa,CAAC;YAC9D,CAAC,CACF,CAAC;YAEF,OAAO,UAAU,CAAC;QACpB,CAAC,CAAC,EACF,SAAS,CAAC,CAAC,UAAU,EAAE,EAAE,CACvB,IAAI,CAAC,mCAAmC,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,YAAY,EAAE,MAAM,EAAE,CAAC,CACvF,EACD,GAAG,CAAC,CAAC,QAAgB,EAAE,EAAE;YACvB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;YAEtC,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,aAAa,CAAC;gBAC5C,WAAW,EAAE,IAAI,CAAC,IAAI;aACvB,CAAC,CAAC;QACL,CAAC,CAAC,EACF,SAAS,CAAC,GAAG,EAAE,CACb,IAAI,CAAC,yBAAyB;aAC3B,oBAAoB,CAAC,IAAI,CAAC,IAAI,EAAE,gDAAgD,CAAC;aACjF,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CACpC,EACD,GAAG,CAAC,CAAC,gBAAmC,EAAE,EAAE;YAC1C,IAAI,gBAAgB,CAAC,UAAU,EAAE;gBAC/B,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;gBAEnE,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,oBAAoB,CAClD,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,4CAA4C,CAAC,CAC5E,CAAC;gBAEF,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;gBAC3C,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,gBAAgB,EAAE,CAAC;aACpD;iBAAM,IAAI,gBAAgB,CAAC,YAAY,EAAE;gBACxC,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;gBAChE,IAAI,CAAC,sBAAsB,GAAG,gBAAgB,CAAC,YAAY,CAAC;aAC7D;QACH,CAAC,CAAC,EACF,UAAU,CAAC,CAAC,KAAK,EAAE,EAAE;YACnB,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;YAEhE,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,iBAAiB,EAAE,CAAC;YACpD,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC;YAExC,MAAM,YAAY,GAAG,IAAI,CAAC,2BAA2B,CAAC,6BAA6B,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YAEjG,IAAI,IAAI,CAAC,YAAY,EAAE,EAAE,aAAa,EAAE,iBAAiB,CAAC,UAAU,CAAC,gCAAgC,EAAE,CAAC,EAAE;gBACxG,IAAI,CAAC,sBAAsB;qBACxB,OAAO,CACN,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAC3B,wGAAwG,CACzG,CACF;qBACA,IAAI,CAAC,CAAC,WAAoB,EAAE,EAAE;oBAC7B,IAAI,WAAW,EAAE;wBACf,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;qBAC1B;yBAAM;wBACL,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,aAAa,CAAC,EAAE,qBAAqB,EAAE,IAAI,EAAE,CAAC,CAAC;qBAChF;gBACH,CAAC,CAAC,CAAC;aACN;YAED,OAAO,KAAK,CAAC;QACf,CAAC,CAAC,CACH;aACA,SAAS,EAAE,CAAC;IACjB,CAAC;;0IA5MU,0BAA0B;8HAA1B,0BAA0B,8FCxBvC,w0JA2HA;2FDnGa,0BAA0B;kBALtC,SAAS;mBAAC;oBACT,QAAQ,EAAE,wBAAwB;oBAClC,WAAW,EAAE,sCAAsC;oBACnD,SAAS,EAAE,CAAC,sCAAsC,CAAC;iBACpD;kUAGC,OAAO;sBADN,KAAK","sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Component, Input, OnDestroy, OnInit } from '@angular/core';\n\nimport {\n  ICommand,\n  IPlainObject,\n  RxCommandFactoryService,\n  RxServerErrorHandlerService\n} from '@helix/platform/shared/api';\nimport { RxWizardModalComponent } from '@helix/platform/shared/components';\nimport { RxUtilityModalsService } from '@helix/platform/ui-kit';\nimport { TranslateService } from '@ngx-translate/core';\nimport { cloneDeep, forEach, isEmpty, last, some } from 'lodash';\nimport { BehaviorSubject, combineLatest, EMPTY, Observable, ReplaySubject } from 'rxjs';\nimport { catchError, map, switchMap, take, takeUntil, tap, withLatestFrom } from 'rxjs/operators';\nimport { IDeploymentStatus } from '../../../services/bundle-deployment/bundle-deployment.interfaces';\nimport { AxBundleDeploymentService } from '../../../services/bundle-deployment/bundle-deployment.service';\nimport { AX_BUNDLE_DETAILS } from '../../bundle-details/bundle-details.constant';\n\n@Component({\n  selector: 'ax-package-wizard-step',\n  templateUrl: './package-wizard-step.component.html',\n  styleUrls: ['./package-wizard-step.component.scss']\n})\nexport class PackageWizardStepComponent implements OnInit, OnDestroy {\n  @Input()\n  options: IPlainObject;\n\n  private queueCreateDeploymentPackageCommand: ICommand = this.rxCommandFactoryService.forResourceType(\n    'com.bmc.arsys.rx.application.bundledeploy.command.QueueCreateDeploymentPackageCommand'\n  );\n\n  private guid: string;\n  private destroyed$: ReplaySubject<boolean> = new ReplaySubject(1);\n\n  private operationStatusSubject = new BehaviorSubject<string>('');\n  operationStatus$ = this.operationStatusSubject.asObservable();\n  operationStatusMessage = null;\n\n  operationStatuses = {\n    pending: this.translateService.instant(\n      'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.status.pending.label'\n    ),\n    failed: this.translateService.instant(\n      'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.status.failed.label'\n    ),\n    succeeded: this.translateService.instant(\n      'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.status.succeeded.label'\n    )\n  };\n\n  isApprovalConfigurationDataIncluded$ = this.rxWizardModalComponent.context$.pipe(\n    map((context) => !isEmpty(context.deploymentPackageDescriptor.approvalConfigurationQueryOptions))\n  );\n\n  isConfigurationDataIncluded$ = this.rxWizardModalComponent.context$.pipe(\n    map((context) => this.options.isInstallOperation || context.deploymentPackageDescriptor.isConfigurationDataIncluded)\n  );\n\n  isDataImportOptionsByRecordDefinitionNameIncluded$ = this.rxWizardModalComponent.context$.pipe(\n    map(\n      (context) =>\n        this.options.isInstallOperation ||\n        !isEmpty(context.deploymentPackageDescriptor.dataImportOptionsByRecordDefinitionName)\n    )\n  );\n\n  isDefinitionsToDeleteByTypeIncluded$ = this.rxWizardModalComponent.context$.pipe(\n    map(\n      (context) =>\n        this.options.isInstallOperation || !isEmpty(context.deploymentPackageDescriptor.definitionsToDeleteByType)\n    )\n  );\n\n  isDefinitionsToDeployByTypeIncluded$ = this.rxWizardModalComponent.context$.pipe(\n    map(\n      (context) =>\n        this.options.isInstallOperation || !isEmpty(context.deploymentPackageDescriptor.definitionsToDeployByType)\n    )\n  );\n\n  isPackageDataEmpty$ = combineLatest([\n    this.isDefinitionsToDeployByTypeIncluded$,\n    this.isDataImportOptionsByRecordDefinitionNameIncluded$,\n    this.isConfigurationDataIncluded$,\n    this.isDefinitionsToDeleteByTypeIncluded$\n  ]).pipe(map((params) => params.every((value) => !value)));\n\n  isCreatePackageButtonDisabled$ = this.rxWizardModalComponent.context$.pipe(\n    withLatestFrom(this.isPackageDataEmpty$, this.operationStatus$),\n    map(\n      ([context, isPackageDataEmpty, operationStatus]) =>\n        operationStatus === this.operationStatuses.pending || !context.isPackageDataModified || isPackageDataEmpty\n    )\n  );\n\n  isAllPackageDataIncluded$: Observable<boolean>;\n\n  constructor(\n    private httpClient: HttpClient,\n    private axBundleDeploymentService: AxBundleDeploymentService,\n    private rxCommandFactoryService: RxCommandFactoryService,\n    private rxServerErrorHandlerService: RxServerErrorHandlerService,\n    private rxUtilityModalsService: RxUtilityModalsService,\n    private rxWizardModalComponent: RxWizardModalComponent,\n    public translateService: TranslateService\n  ) {}\n\n  ngOnInit(): void {\n    this.isAllPackageDataIncluded$ = combineLatest(\n      [\n        this.isDefinitionsToDeployByTypeIncluded$,\n        this.isDataImportOptionsByRecordDefinitionNameIncluded$,\n        this.isConfigurationDataIncluded$,\n        this.isDefinitionsToDeleteByTypeIncluded$\n      ].concat(this.options?.isContentPackageOperation ? [this.isApprovalConfigurationDataIncluded$] : [])\n    ).pipe(map((params) => params.every(Boolean)));\n\n    this.rxWizardModalComponent.steps$\n      .pipe(withLatestFrom(this.rxWizardModalComponent.tabIndex$, this.operationStatus$), takeUntil(this.destroyed$))\n      .subscribe(([steps, tabIndex, operationStatus]) => {\n        if (steps[tabIndex].id === 'package' && operationStatus !== this.operationStatuses.succeeded) {\n          this.rxWizardModalComponent.api.disableNextButton();\n        }\n      });\n  }\n\n  ngOnDestroy(): void {\n    this.destroyed$.next(true);\n    this.destroyed$.complete();\n  }\n\n  createPackage(forceStart: boolean = false): void {\n    this.rxWizardModalComponent.context$\n      .pipe(\n        take(1),\n        tap(() => {\n          this.rxWizardModalComponent.api.updateContext({\n            isPackageDataModified: false\n          });\n\n          this.operationStatusSubject.next(this.operationStatuses.pending);\n\n          if (this.options?.isContentPackageOperation) {\n            this.rxWizardModalComponent.api.setFinishButtonLabel(\n              this.translateService.instant(\n                'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.close-and-continue-packaging.label'\n              )\n            );\n\n            this.rxWizardModalComponent.api.complete();\n          }\n        }),\n        map((context) => {\n          const parameters = {\n            bundlePackageDescriptor: cloneDeep(context.deploymentPackageDescriptor),\n            shouldForce: forceStart\n          };\n\n          forEach(\n            parameters.bundlePackageDescriptor.dataImportOptionsByRecordDefinitionName,\n            (dataImportOptionByRecordDefinitionName) => {\n              delete dataImportOptionByRecordDefinitionName.dataFilterColumnExpressionFormControlOptions;\n              delete dataImportOptionByRecordDefinitionName.dataFilterExpression;\n              delete dataImportOptionByRecordDefinitionName.defaultFilter;\n            }\n          );\n\n          return parameters;\n        }),\n        switchMap((parameters) =>\n          this.queueCreateDeploymentPackageCommand.execute(parameters, { responseType: 'text' })\n        ),\n        tap((response: string) => {\n          this.guid = last(response.split('/'));\n\n          this.rxWizardModalComponent.api.updateContext({\n            packageGuid: this.guid\n          });\n        }),\n        switchMap(() =>\n          this.axBundleDeploymentService\n            .pollDeploymentStatus(this.guid, '/api/rx/application/bundle/createpackagestatus')\n            .pipe(takeUntil(this.destroyed$))\n        ),\n        tap((deploymentStatus: IDeploymentStatus) => {\n          if (deploymentStatus.isFinished) {\n            this.operationStatusSubject.next(this.operationStatuses.succeeded);\n\n            this.rxWizardModalComponent.api.setFinishButtonLabel(\n              this.translateService.instant('com.bmc.arsys.rx.client.common.close.label')\n            );\n\n            this.rxWizardModalComponent.api.complete();\n            this.rxWizardModalComponent.api.enableNextButton();\n          } else if (deploymentStatus.errorMessage) {\n            this.operationStatusSubject.next(this.operationStatuses.failed);\n            this.operationStatusMessage = deploymentStatus.errorMessage;\n          }\n        }),\n        catchError((error) => {\n          this.operationStatusSubject.next(this.operationStatuses.failed);\n\n          this.rxWizardModalComponent.api.disableNextButton();\n          this.rxWizardModalComponent.api.renew();\n\n          const errorDetails = this.rxServerErrorHandlerService.getServerResponseErrorDetails(error.error);\n\n          if (some(errorDetails, { messageNumber: AX_BUNDLE_DETAILS.errorCodes.packageCreationAlreadyInProgress })) {\n            this.rxUtilityModalsService\n              .confirm(\n                this.translateService.instant(\n                  'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.creation-operation-in-progress.message'\n                )\n              )\n              .then((isConfirmed: boolean) => {\n                if (isConfirmed) {\n                  this.createPackage(true);\n                } else {\n                  this.rxWizardModalComponent.api.updateContext({ isPackageDataModified: true });\n                }\n              });\n          }\n\n          return EMPTY;\n        })\n      )\n      .subscribe();\n  }\n}\n","<h5 class=\"mt-0\">{{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.label' | translate }}</h5>\n\n<button\n  adapt-button\n  btn-type=\"primary\"\n  rx-id=\"create-package-button\"\n  type=\"button\"\n  (click)=\"createPackage()\"\n  [disabled]=\"isCreatePackageButtonDisabled$ | async\"\n>\n  {{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.create-package.label' | translate }}\n</button>\n\n<span\n  class=\"empty-package-warning d-icon-left-exclamation_triangle\"\n  rx-id=\"empty-package-message\"\n  [hidden]=\"!(isPackageDataEmpty$ | async)\"\n>\n  {{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.empty-package.message' | translate }}\n</span>\n\n<ng-container *ngIf=\"!(isPackageDataEmpty$ | async)\">\n  <h6>{{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.included.label' | translate }}:</h6>\n\n  <ul>\n    <li [hidden]=\"!(isDefinitionsToDeployByTypeIncluded$ | async)\">\n      {{\n        'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.select-definitions.customized-definitions.label'\n          | translate\n      }}\n    </li>\n    <li [hidden]=\"!(isDataImportOptionsByRecordDefinitionNameIncluded$ | async)\">\n      {{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.data-items.label' | translate }}\n    </li>\n    <li [hidden]=\"!(isConfigurationDataIncluded$ | async)\">\n      {{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.configuration-data.label' | translate }}\n    </li>\n    <li [hidden]=\"!(isApprovalConfigurationDataIncluded$ | async)\">\n      {{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.approval-configurations.label' | translate }}\n    </li>\n    <li [hidden]=\"!(!options?.isInstallOperation && isDefinitionsToDeleteByTypeIncluded$ | async)\">\n      {{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.definitions-to-delete.label' | translate }}\n    </li>\n  </ul>\n</ng-container>\n\n<ng-container *ngIf=\"!(isAllPackageDataIncluded$ | async)\">\n  <h6>{{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.not-included.label' | translate }}:</h6>\n\n  <ul>\n    <li [hidden]=\"isDefinitionsToDeployByTypeIncluded$ | async\">\n      {{\n        'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.select-definitions.customized-definitions.label'\n          | translate\n      }}\n    </li>\n    <li [hidden]=\"isDataImportOptionsByRecordDefinitionNameIncluded$ | async\">\n      {{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.data-items.label' | translate }}\n    </li>\n    <li [hidden]=\"isConfigurationDataIncluded$ | async\">\n      {{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.configuration-data.label' | translate }}\n    </li>\n    <li [hidden]=\"!(options?.isContentPackageOperation && !(isApprovalConfigurationDataIncluded$ | async))\">\n      {{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.approval-configurations.label' | translate }}\n    </li>\n    <li [hidden]=\"isDefinitionsToDeleteByTypeIncluded$ | async\">\n      {{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.definitions-to-delete.label' | translate }}\n    </li>\n  </ul>\n</ng-container>\n\n<div class=\"mt-4\" *ngIf=\"operationStatus$ | async as operationStatus\">\n  <div *ngIf=\"operationStatus === operationStatuses.pending\">\n    <div class=\"mb-3\">\n      {{ 'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.creating-package.message' | translate }}\n    </div>\n\n    <div class=\"progress\">\n      <div\n        class=\"progress-bar progress-bar-intermediate w-100\"\n        role=\"progressbar\"\n        aria-valuenow=\"100\"\n        aria-valuemin=\"0\"\n        aria-valuemax=\"100\"\n      ></div>\n    </div>\n  </div>\n\n  <adapt-alert\n    *ngIf=\"operationStatus === operationStatuses.succeeded\"\n    [config]=\"{\n      content: translateService.instant(\n        'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.packaging-completed.message'\n      ),\n      dismissible: false,\n      type: 'inline',\n      variant: 'success'\n    }\"\n  ></adapt-alert>\n\n  <div *ngIf=\"operationStatus === operationStatuses.failed\">\n    <adapt-alert\n      [config]=\"{\n        content: translateService.instant(\n          'com.bmc.arsys.rx.innovation-studio.bundle-action-wizard.package.packaging-failed.message'\n        ),\n        dismissible: false,\n        type: 'inline',\n        variant: 'danger'\n      }\"\n    ></adapt-alert>\n\n    <adapt-rx-textarea\n      *ngIf=\"operationStatusMessage\"\n      label=\"{{ 'com.bmc.arsys.rx.client.common.messages.label' | translate }}\"\n      [ngModel]=\"operationStatusMessage\"\n      rx-id=\"messages-textarea\"\n      rows=\"13\"\n      [disabledStyleForReadonlyState]=\"true\"\n      [readonly]=\"true\"\n    ></adapt-rx-textarea>\n  </div>\n</div>\n"]}