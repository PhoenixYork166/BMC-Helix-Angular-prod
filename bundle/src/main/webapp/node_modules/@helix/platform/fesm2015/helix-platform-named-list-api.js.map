{"version":3,"file":"helix-platform-named-list-api.js","sources":["../../../../libs/platform/named-list/api/named-list-definition-data-page.service.ts","../../../../libs/platform/named-list/api/named-list-definition.constant.ts","../../../../libs/platform/named-list/api/named-list-definition.service.ts","../../../../libs/platform/named-list/api/named-list-data-page.service.ts","../../../../libs/platform/named-list/api/named-list-definition-cache.service.ts","../../../../libs/platform/named-list/api/named-list.service.ts","../../../../libs/platform/named-list/api/helix-platform-named-list-api.ts"],"sourcesContent":["import { Injectable, Injector } from '@angular/core';\nimport { DataPage } from '@helix/platform/shared/api';\n\nconst namedListDefinitionDataPageQuery =\n  'com.bmc.arsys.rx.application.namedlist.datapage.NamedListDefinitionDataPageQuery';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class RxNamedListDefinitionDataPageService extends DataPage {\n  constructor(private injector: Injector) {\n    super(injector, namedListDefinitionDataPageQuery);\n  }\n}\n","export const RX_NAMED_LIST_DEFINITION = {\n  searchBehaviorTypes: {\n    contains: 'CONTAINS',\n    exactMatch: 'EXACT_MATCH',\n    startsWith: 'STARTS_WITH'\n  },\n\n  maxNumberOfContextualLabelFields: 4\n};\n","import { HttpClient, HttpResponse } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport {\n  IHttpGetParams,\n  IHttpOptions,\n  RX_BUNDLE,\n  RxCommandFactoryService,\n  RxFeatureService\n} from '@helix/platform/shared/api';\nimport { Observable, of } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { RX_NAMED_LIST_DEFINITION } from './named-list-definition.constant';\nimport { INamedListDefinition } from './named-list-definition.types';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class RxNamedListDefinitionService {\n  constructor(\n    private httpClient: HttpClient,\n    private rxCommandFactoryService: RxCommandFactoryService,\n    private rxFeatureService: RxFeatureService\n  ) {}\n\n  get(namedListDefinitionName: string, options?: IHttpGetParams): Observable<INamedListDefinition> {\n    return this.httpClient.get<INamedListDefinition>(this.getUrl(namedListDefinitionName), options).pipe(\n      tap((definition: INamedListDefinition) => {\n        if (this.rxFeatureService.isFeatureEnabled('DRD21-43015')) {\n          definition.searchBehavior ??= RX_NAMED_LIST_DEFINITION.searchBehaviorTypes.contains;\n        }\n      })\n    );\n  }\n\n  getNew(): Observable<INamedListDefinition> {\n    const definition: Partial<INamedListDefinition> = {\n      name: '',\n      allowOverlay: false,\n      scope: RX_BUNDLE.definitionScopeTypes.bundle,\n      recordDefinitionName: null,\n      labelFieldId: null,\n      valueFieldId: null\n    };\n\n    if (this.rxFeatureService.isFeatureEnabled('DRD21-43015')) {\n      definition.searchBehavior = RX_NAMED_LIST_DEFINITION.searchBehaviorTypes.contains;\n    }\n\n    return of(definition);\n  }\n\n  create(namedListDefinition: INamedListDefinition): Observable<HttpResponse<any>> {\n    return this.httpClient.post(this.getUrl(), namedListDefinition, { observe: 'response' });\n  }\n\n  update(namedListDefinition: INamedListDefinition, options?: IHttpOptions): Observable<any> {\n    return this.httpClient.put(this.getUrl(namedListDefinition.name), namedListDefinition, options);\n  }\n\n  private getUrl(namedListDefinitionName?: string): string {\n    return namedListDefinitionName\n      ? `/api/rx/application/namedlist/namedlistdefinition/${encodeURIComponent(namedListDefinitionName)}`\n      : '/api/rx/application/namedlist/namedlistdefinition';\n  }\n\n  rename(oldNamedListDefinitionName: string, newNamedListDefinitionName: string): Observable<any> {\n    return this.rxCommandFactoryService\n      .forResourceType('com.bmc.arsys.rx.application.namedlist.command.RenameNamedListDefinitionCommand')\n      .execute({\n        name: oldNamedListDefinitionName,\n        newName: newNamedListDefinitionName\n      });\n  }\n\n  revertCustomization(namedListDefinitionName: string): Observable<any> {\n    return this.rxCommandFactoryService\n      .forResourceType('com.bmc.arsys.rx.application.namedlist.command.RevertNamedListDefinitionCommand')\n      .execute({ namedListDefinitionName });\n  }\n\n  delete(definitionNames: string[]): Observable<any> {\n    return this.rxCommandFactoryService\n      .forResourceType('com.bmc.arsys.rx.application.namedlist.command.DeleteNamedListDefinitionsCommand')\n      .execute({ definitionNames });\n  }\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { DataPage, IDataPageRequestConfiguration, IDataPageResult, RxLogService } from '@helix/platform/shared/api';\nimport { Observable } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class RxNamedListDataPageService extends DataPage {\n  constructor(injector: Injector, private rxLogService: RxLogService) {\n    super(injector, 'com.bmc.arsys.rx.application.namedlist.datapage.NamedListDataPageQuery');\n  }\n\n  get(dataPageRequestConfiguration: IDataPageRequestConfiguration = {}): Observable<IDataPageResult> {\n    this.rxLogService.warning('RxNamedListDataPageService: The get() method is deprecated. Use post() instead.');\n\n    return super.get(dataPageRequestConfiguration);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { INamedListDefinition } from './named-list-definition.types';\nimport { RxNamedListDefinitionService } from './named-list-definition.service';\nimport { shareReplay } from 'rxjs/operators';\nimport { isEmpty } from 'lodash';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class RxNamedListDefinitionCacheService {\n  private consumers = new Set<Observable<any>>();\n  private namedListDefinitions: Map<string, Observable<INamedListDefinition>> = new Map();\n\n  constructor(private rxNamedListDefinitionService: RxNamedListDefinitionService) {}\n\n  getNamedListDefinition(namedListDefinitionName: string): Observable<INamedListDefinition> {\n    if (!this.namedListDefinitions.has(namedListDefinitionName)) {\n      const namedListDefinition = this.rxNamedListDefinitionService.get(namedListDefinitionName).pipe(shareReplay(1));\n\n      this.namedListDefinitions.set(namedListDefinitionName, namedListDefinition);\n    }\n\n    return this.namedListDefinitions.get(namedListDefinitionName);\n  }\n\n  registerConsumer(consumerDestroy$: Observable<any>): void {\n    this.consumers.add(consumerDestroy$);\n\n    consumerDestroy$.subscribe(() => {\n      this.consumers.delete(consumerDestroy$);\n\n      if (isEmpty(this.consumers)) {\n        this.clearCache();\n      }\n    });\n  }\n\n  private clearCache(): void {\n    this.namedListDefinitions.clear();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { IDataPageParams, RxLogService, RX_DATA_PAGE } from '@helix/platform/shared/api';\nimport { RxRecordInstanceUtilsService } from '@helix/platform/record/api';\nimport { RxNamedListDataPageService } from './named-list-data-page.service';\nimport { INamedListOption, INamedListOptionPage, NamedListTypeAheadOption } from './named-list.types';\nimport { INamedListDefinition } from './named-list-definition.types';\nimport { chain, has, isEmpty, isString } from 'lodash';\nimport { RX_NAMED_LIST_DEFINITION } from './named-list-definition.constant';\nimport { RX_EXPRESSION_EVALUATOR } from '@helix/platform/view/api';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class RxNamedListService {\n  constructor(\n    private rxNamedListDataPageService: RxNamedListDataPageService,\n    private rxRecordInstanceUtilsService: RxRecordInstanceUtilsService,\n    private rxLogService: RxLogService\n  ) {}\n\n  getOptionPage(\n    namedListDefinition: INamedListDefinition,\n    searchQuery: string,\n    queryCriteria: string = null,\n    startIndex = 0,\n    pageSize = RX_DATA_PAGE.defaultPageSize\n  ): Observable<INamedListOptionPage> {\n    return this.getOptionPageByFieldIds(\n      namedListDefinition,\n      searchQuery,\n      [namedListDefinition.labelFieldId],\n      queryCriteria,\n      startIndex,\n      pageSize\n    );\n  }\n\n  getOptionPageByLabelOrValue(\n    namedListDefinition: INamedListDefinition,\n    searchQuery: string,\n    queryCriteria: string = null,\n    startIndex = 0,\n    pageSize = RX_DATA_PAGE.defaultPageSize\n  ): Observable<INamedListOptionPage> {\n    return this.getOptionPageByFieldIds(\n      namedListDefinition,\n      searchQuery,\n      [namedListDefinition.labelFieldId, namedListDefinition.valueFieldId],\n      queryCriteria,\n      startIndex,\n      pageSize\n    );\n  }\n\n  private getOptionPageByFieldIds(\n    namedListDefinition: INamedListDefinition,\n    searchQuery: string,\n    fieldIds: number[],\n    queryCriteria: string,\n    startIndex,\n    pageSize\n  ): Observable<INamedListOptionPage> {\n    if (queryCriteria?.includes(RX_EXPRESSION_EVALUATOR.operands.undefined)) {\n      this.rxLogService.debug(`Query criteria expression contains undefined operands: ${queryCriteria}`);\n\n      return of({ options: [], totalSize: 0 });\n    }\n\n    const params: IDataPageParams = {\n      namedlistdefinition: namedListDefinition.name,\n      pageSize,\n      startIndex\n    };\n\n    const startingWildcard = [\n      RX_NAMED_LIST_DEFINITION.searchBehaviorTypes.startsWith,\n      RX_NAMED_LIST_DEFINITION.searchBehaviorTypes.exactMatch\n    ].includes(namedListDefinition.searchBehavior)\n      ? ''\n      : '%';\n\n    const endingWildcard =\n      namedListDefinition.searchBehavior === RX_NAMED_LIST_DEFINITION.searchBehaviorTypes.exactMatch ? '' : '%';\n\n    const matchingOperator =\n      namedListDefinition.searchBehavior === RX_NAMED_LIST_DEFINITION.searchBehaviorTypes.exactMatch ? '=' : 'LIKE';\n\n    const searchableFieldIds = chain(namedListDefinition.fields)\n      .filter((field) => field.searchable as boolean)\n      .map((field) => Number(field.id))\n      .concat(fieldIds)\n      .uniq()\n      .value();\n\n    const searchQueryCriteria = searchQuery\n      ? searchableFieldIds\n          .map((fieldId) => {\n            const escapedSearchQuery = this.rxRecordInstanceUtilsService.escapeTextWildcards(searchQuery);\n\n            return `('${fieldId}' ${matchingOperator} \"${startingWildcard}${escapedSearchQuery}${endingWildcard}\")`;\n          })\n          .join(' OR ')\n      : null;\n\n    const additionalQueryCriteria =\n      searchQueryCriteria && queryCriteria\n        ? `(${searchQueryCriteria}) AND (${queryCriteria})`\n        : searchQueryCriteria || queryCriteria;\n\n    if (additionalQueryCriteria) {\n      params.additionalQueryCriteria = `(${additionalQueryCriteria})`;\n    }\n\n    return this.rxNamedListDataPageService\n      .post({\n        params\n      })\n      .pipe(\n        map((result) => ({\n          options: result.data.map((item) => {\n            // We are still getting all the keys in the response despite disabling the feature flag 'DRD21-43103'.\n            if (Object.keys(item).length === 1) {\n              const displayValue = Object.keys(item)[0];\n\n              return {\n                displayValue,\n                value: item[displayValue],\n                title: '',\n                contextualFields: []\n              };\n            } else {\n              const contextualFields = namedListDefinition.fields\n                .filter((field) => field.visible)\n                .map((field) => item[field.id]);\n\n              return {\n                displayValue: item[namedListDefinition.labelFieldId],\n                value: item[namedListDefinition.valueFieldId],\n                title: contextualFields.join(' / '),\n                contextualFields\n              };\n            }\n          }),\n          totalSize: result.totalSize\n        }))\n      );\n  }\n\n  getOptionsForValues(\n    namedListDefinition: INamedListDefinition,\n    optionValues: string[]\n  ): Observable<INamedListOption[]> {\n    if (optionValues.length) {\n      const params: IDataPageParams = {\n        namedlistdefinition: namedListDefinition.name,\n        pageSize: -1,\n        startIndex: 0\n      };\n\n      params.additionalQueryCriteria = optionValues\n        .map((value) => `'${namedListDefinition.valueFieldId}'=\"${value.replace(/\"/g, '\"\"')}\"`)\n        .join(' OR ');\n\n      return this.rxNamedListDataPageService\n        .post({\n          params\n        })\n        .pipe(\n          map((result) =>\n            result.data.map((item) => {\n              const displayValue = Object.keys(item)[0];\n\n              return {\n                displayValue,\n                value: item[displayValue],\n                title: '',\n                contextualFields: []\n              };\n            })\n          )\n        );\n    } else {\n      return of([]);\n    }\n  }\n\n  isNamedListOption(namedListTypeAheadOption: NamedListTypeAheadOption): boolean {\n    return has(namedListTypeAheadOption, 'value');\n  }\n\n  getNamesFromTypeAheadOptions(namedListTypeAheadOptions: NamedListTypeAheadOption[]): string[] {\n    if (!isEmpty(namedListTypeAheadOptions)) {\n      return isString(namedListTypeAheadOptions[0])\n        ? (namedListTypeAheadOptions as string[])\n        : namedListTypeAheadOptions.map(\n            (filterValue: NamedListTypeAheadOption) => (<INamedListOption>filterValue).value\n          );\n    }\n\n    return [];\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}