{"version":3,"file":"helix-platform-document-designer.js","sources":["../../../../libs/platform/document/designer/document-designer.service.ts","../../../../libs/platform/document/designer/document-designer/+state/document-designer.actions.ts","../../../../libs/platform/document/designer/document-designer.constant.ts","../../../../libs/platform/document/designer/document-designer/+state/document-designer.selectors.ts","../../../../libs/platform/document/designer/document-designer/document-designer.component.ts","../../../../libs/platform/document/designer/document-designer/document-designer.component.html","../../../../libs/platform/document/designer/document-designer-page/document-designer-page.component.ts","../../../../libs/platform/document/designer/document-designer-page/document-designer-page.component.html","../../../../libs/platform/document/designer/document-designer/+state/document-designer-model.reducer.ts","../../../../libs/platform/document/designer/document-designer/+state/document-designer.effects.ts","../../../../libs/platform/document/designer/document-designer/document-designer.module.ts","../../../../libs/platform/document/designer/document-designer-page/document-designer-page.module.ts","../../../../libs/platform/document/designer/helix-platform-document-designer.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { IDocumentDefinition } from '@helix/platform/document/api';\nimport { IDocumentDefinitionModel } from './document-designer.types';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DocumentDesignerService {\n  getDefinitionFromDefinitionModel(model: IDocumentDefinitionModel, bundleId: string): IDocumentDefinition {\n    return {\n      lastUpdateTime: model.lastUpdateTime,\n      lastChangedBy: model.lastChangedBy,\n      owner: model.owner,\n      name: `${bundleId}:${model.name}`,\n      description: model.description,\n      overlayGroupId: model.overlayGroupId,\n      scope: model.customizationOptions.scope,\n      guid: model.guid,\n      allowOverlay: model.customizationOptions.allowOverlay,\n      overlayDescriptor: model.overlayDescriptor,\n      documentSchema: model.documentSchema\n    };\n  }\n}\n","import { IDocumentDefinition } from '@helix/platform/document/api';\nimport { createAction, props } from '@ngrx/store';\nimport { IDocumentDefinitionModel } from '../../document-designer.types';\nimport { IInitDocumentDesignerActionPayload } from './document-designer.types';\n\nexport const init = createAction('[Document Designer] Init', props<{ payload: IInitDocumentDesignerActionPayload }>());\n\nexport const loadDefinition = createAction('[Document Designer] Load Definition');\n\nexport const loadDefinitionSuccess = createAction(\n  '[Document Designer] Load Definition Success',\n  props<{ definition: IDocumentDefinition }>()\n);\n\nexport const initDefinitionData = createAction(\n  '[Document Designer] Init Definition Model',\n  props<{ definition: IDocumentDefinition; definitionModel: IDocumentDefinitionModel }>()\n);\n\nexport const markDesignerPristine = createAction('[Document Designer] Mark Designer Pristine');\n\nexport const markDesignerDirty = createAction('[Document Designer] Mark Designer Dirty');\n\nexport const updateDefinitionModelFromDesigner = createAction(\n  '[Document Designer] Update Definition Model From Designer',\n  props<{ definitionModelFromDesigner: IDocumentDefinitionModel }>()\n);\n\nexport const toggleDesignMode = createAction('[Document Designer] Toggle Design Mode');\n\nexport const revertCustomization = createAction('[Document Designer] Revert Customization');\n\nexport const saveDefinition = createAction('[Document Designer] Save Definition');\n\nexport const saveDefinitionSuccess = createAction(\n  '[Document Designer] Save Definition Success',\n  props<{ savedDefinitionName: string }>()\n);\n\nexport const saveDefinitionError = createAction('[Document Designer] Save Definition Error');\n\nexport const destroy = createAction('[Document Designer] Destroy');\n","export const RX_DOCUMENT_DESIGNER = {\n  featureSelector: 'documentDesigner'\n};\n","import { createFeatureSelector, createSelector } from '@ngrx/store';\nimport { RX_DOCUMENT_DESIGNER } from '../../document-designer.constant';\nimport { IDocumentDesignerModel, IDocumentDesignerState } from './document-designer.types';\n\nexport const documentDesignerStateSelector = createFeatureSelector<IDocumentDesignerState>(\n  RX_DOCUMENT_DESIGNER.featureSelector\n);\n\nexport const documentDesignerModelSelector = createSelector(\n  documentDesignerStateSelector,\n  (documentDesignerState: IDocumentDesignerState) => documentDesignerState.model\n);\n\nexport const bundleIdSelector = createSelector(\n  documentDesignerModelSelector,\n  (documentDesignerModel: IDocumentDesignerModel) => documentDesignerModel.bundleId\n);\n\nexport const definitionNameSelector = createSelector(\n  documentDesignerModelSelector,\n  (documentDesignerModel: IDocumentDesignerModel) => documentDesignerModel.definitionName\n);\n\nexport const isDesignModeSelector = createSelector(\n  documentDesignerModelSelector,\n  (documentDesignerModel: IDocumentDesignerModel) => documentDesignerModel.isDesignMode\n);\n\nexport const definitionModelFromDefinitionSelector = createSelector(\n  documentDesignerModelSelector,\n  (documentDesignerModel: IDocumentDesignerModel) => documentDesignerModel.definitionModelFromDefinition\n);\n\nexport const definitionModelSelector = createSelector(\n  documentDesignerModelSelector,\n  (documentDesignerModel: IDocumentDesignerModel) => documentDesignerModel.definitionModel\n);\n\nexport const isDirtySelector = createSelector(\n  documentDesignerModelSelector,\n  (documentDesignerModel: IDocumentDesignerModel) => documentDesignerModel.isDirty\n);\n\nexport const savedDefinitionNameSelector = createSelector(\n  documentDesignerModelSelector,\n  (documentDesignerModel: IDocumentDesignerModel) => documentDesignerModel.savedDefinitionName\n);\n\nexport const originalDefinitionSelector = createSelector(\n  documentDesignerModelSelector,\n  (documentDesignerModel: IDocumentDesignerModel) => documentDesignerModel.originalDefinition\n);\n","import {\n  Component,\n  EventEmitter,\n  Input,\n  OnChanges,\n  OnDestroy,\n  OnInit,\n  Output,\n  Renderer2,\n  SimpleChanges,\n  ViewChild\n} from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { AdaptSidebarComponent } from '@bmc-ux/adapt-angular';\nimport { IDocumentDefinition } from '@helix/platform/document/api';\nimport { RX_RECORD_DEFINITION } from '@helix/platform/record/api';\nimport {\n  IDesignerConfiguration,\n  IFormBuilderConfig,\n  IFormBuilderEvent,\n  IPlainObject,\n  RxGlobalCacheService,\n  RxNotificationService,\n  RxOverlayService\n} from '@helix/platform/shared/api';\nimport {\n  CustomizationOptionsComponent,\n  ITextareaFormControlOptions,\n  ITextFormControlOptions,\n  RX_REVERT_CUSTOMIZATION,\n  RxRevertCustomizationComponent,\n  TextareaFormControlComponent,\n  TextFormControlComponent\n} from '@helix/platform/shared/components';\nimport {\n  IBreadcrumbItem,\n  IValidationIssue,\n  IValidationIssueSection,\n  ValidationIssueType\n} from '@helix/platform/ui-kit';\nimport { RxJsonParserService } from '@helix/platform/utils';\nimport { Store } from '@ngrx/store';\nimport { TranslateService } from '@ngx-translate/core';\nimport { isEmpty, isUndefined, some, trim } from 'lodash';\nimport { combineLatest, Observable, of, ReplaySubject, Subject } from 'rxjs';\nimport {\n  filter,\n  map,\n  shareReplay,\n  skip,\n  startWith,\n  switchMap,\n  take,\n  takeUntil,\n  tap,\n  withLatestFrom\n} from 'rxjs/operators';\nimport { DocumentDesignerService } from '../document-designer.service';\nimport { IDocumentDefinitionModel } from '../document-designer.types';\nimport * as DocumentDesignerActions from './+state/document-designer.actions';\nimport {\n  bundleIdSelector,\n  definitionModelFromDefinitionSelector,\n  definitionModelSelector,\n  isDesignModeSelector,\n  isDirtySelector,\n  originalDefinitionSelector,\n  savedDefinitionNameSelector\n} from './+state/document-designer.selectors';\n\n@Component({\n  selector: 'rx-document-designer',\n  templateUrl: './document-designer.component.html',\n  styleUrls: ['./document-designer.component.scss']\n})\nexport class DocumentDesignerComponent implements OnInit, OnChanges, OnDestroy {\n  @Input()\n  configuration: IDesignerConfiguration;\n\n  @Output()\n  definitionSaved: EventEmitter<string> = new EventEmitter();\n\n  @Output()\n  definitionErrorLoading: EventEmitter<void> = new EventEmitter();\n\n  @Output()\n  closeDesigner: EventEmitter<void> = new EventEmitter<void>();\n\n  @ViewChild(AdaptSidebarComponent, { static: false })\n  inspectorSidebar: AdaptSidebarComponent;\n\n  schemaFormControl: FormControl = new FormControl('', { updateOn: 'blur' });\n  private isDirty$: Observable<boolean> = this.store$.select(isDirtySelector);\n  private definitionModel$: Observable<IDocumentDefinitionModel> = this.store$.select(definitionModelSelector);\n  private isDesignMode$ = this.store$.select(isDesignModeSelector);\n  private bundleId$ = this.store$.select(bundleIdSelector);\n  private destroyed$ = new ReplaySubject<boolean>(1);\n  private originalDefinition$ = this.store$.select(originalDefinitionSelector);\n  private inspectorFocusEditorSubject = new Subject<{ editorName: string; data: IPlainObject }>();\n  inspectorFocusEditor$ = this.inspectorFocusEditorSubject.asObservable();\n\n  private bundleFriendlyName$ = this.bundleId$.pipe(\n    switchMap((bundleId) => this.rxGlobalCacheService.getBundleFriendlyName(bundleId))\n  );\n\n  private validationIssues$: Observable<IValidationIssueSection[]> = this.definitionModel$.pipe(\n    map((definitionModel: IDocumentDefinitionModel) => this.validate(definitionModel)),\n    shareReplay(1)\n  );\n\n  private hasValidationErrors$: Observable<boolean> = this.validationIssues$.pipe(\n    map((issueSections) =>\n      some(issueSections, {\n        issues: [{ type: ValidationIssueType.Error }]\n      })\n    )\n  );\n\n  private definitionFromDefinitionModel$: Observable<IDocumentDefinition> = this.definitionModel$.pipe(\n    withLatestFrom(this.bundleId$),\n    map(([definitionModel, bundleId]) =>\n      this.documentDesignerService.getDefinitionFromDefinitionModel(definitionModel, bundleId)\n    )\n  );\n\n  private areNewDefinitionsAllowed$ = this.store$\n    .select(bundleIdSelector)\n    .pipe(switchMap((bundleId) => this.rxOverlayService.areNewDefinitionsAllowed(bundleId)));\n\n  private isReadOnly$ = this.definitionFromDefinitionModel$.pipe(\n    filter((definition) => !!definition.lastUpdateTime),\n    withLatestFrom(this.areNewDefinitionsAllowed$),\n    map(\n      ([definition, areNewDefinitionsAllowed]) =>\n        !areNewDefinitionsAllowed || !this.rxOverlayService.isCustomizationEnabled('allowOverlay', definition)\n    ),\n    tap((isReadOnly: boolean) => {\n      if (isReadOnly) {\n        this.rxNotificationService.addWarningMessage(\n          this.translateService.instant('com.bmc.arsys.rx.client.designer.read-only-definition-warning.message')\n        );\n      }\n    }),\n    startWith(false),\n    shareReplay(1)\n  );\n\n  private isSaveButtonDisabled$: Observable<boolean> = combineLatest([\n    this.hasValidationErrors$,\n    this.isDirty$,\n    this.isReadOnly$\n  ]).pipe(\n    map(([hasValidationErrors, isDirty, isReadOnly]) => hasValidationErrors || !isDirty || isReadOnly),\n    startWith(true)\n  );\n\n  private definitionForJsonViewer$: Observable<IDocumentDefinition> = this.isDesignMode$.pipe(\n    switchMap((isDesignMode: boolean) =>\n      isDesignMode\n        ? of(null)\n        : combineLatest([this.definitionFromDefinitionModel$, this.originalDefinition$]).pipe(\n            map(([definitionFromDefinitionModel, originalDefinition]) => ({\n              ...originalDefinition,\n              ...definitionFromDefinitionModel\n            }))\n          )\n    )\n  );\n\n  private breadcrumbItems$: Observable<IBreadcrumbItem[]> = this.definitionModel$.pipe(\n    map((definitionModel) => [\n      {\n        label:\n          definitionModel.name ||\n          `<${this.translateService.instant('com.bmc.arsys.rx.client.document-designer.new-document.label')}>`,\n        data: {}\n      }\n    ])\n  );\n\n  private definitionInspectorConfig$ = this.definitionModel$.pipe(\n    map((definitionModel) => {\n      const isCustomizationAllowed = Boolean(definitionModel.lastUpdateTime)\n        ? this.rxOverlayService.isCustomizationEnabled('allowOverlay', definitionModel)\n        : true;\n\n      return this.getFormBuilderConfig(definitionModel, isCustomizationAllowed);\n    })\n  );\n\n  vm$ = combineLatest([\n    this.breadcrumbItems$,\n    this.bundleFriendlyName$,\n    this.definitionModel$,\n    this.hasValidationErrors$,\n    this.isReadOnly$,\n    this.definitionForJsonViewer$,\n    this.isSaveButtonDisabled$,\n    this.definitionInspectorConfig$,\n    this.validationIssues$\n  ]).pipe(\n    map(\n      ([\n        breadcrumbItems,\n        bundleFriendlyName,\n        definitionModel,\n        hasValidationErrors,\n        isReadOnly,\n        definitionForJsonViewer,\n        isSaveButtonDisabled,\n        definitionInspectorConfig,\n        validationIssues\n      ]) => ({\n        breadcrumbItems,\n        bundleFriendlyName,\n        definitionModel,\n        hasValidationErrors,\n        isReadOnly,\n        definitionForJsonViewer,\n        isSaveButtonDisabled,\n        definitionInspectorConfig,\n        validationIssues\n      })\n    )\n  );\n\n  constructor(\n    private store$: Store<any>,\n    private renderer: Renderer2,\n    private rxGlobalCacheService: RxGlobalCacheService,\n    private rxJsonParserService: RxJsonParserService,\n    private rxNotificationService: RxNotificationService,\n    private rxOverlayService: RxOverlayService,\n    private translateService: TranslateService,\n    private documentDesignerService: DocumentDesignerService\n  ) {}\n\n  ngOnInit(): void {\n    this.schemaFormControl.valueChanges.pipe(takeUntil(this.destroyed$)).subscribe((documentSchema) => {\n      this.store$.dispatch(\n        DocumentDesignerActions.updateDefinitionModelFromDesigner({\n          definitionModelFromDesigner: { documentSchema } as IDocumentDefinitionModel\n        })\n      );\n    });\n\n    this.store$\n      .select(definitionModelFromDefinitionSelector)\n      .pipe(takeUntil(this.destroyed$))\n      .subscribe((definitionModel) => {\n        this.schemaFormControl.patchValue(definitionModel.documentSchema, { emitEvent: false });\n      });\n\n    this.store$\n      .select(savedDefinitionNameSelector)\n      .pipe(skip(1), takeUntil(this.destroyed$), filter(Boolean))\n      .subscribe((savedDefinitionName: string) => {\n        this.definitionSaved.emit(savedDefinitionName);\n      });\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.configuration.currentValue) {\n      this.store$.dispatch(DocumentDesignerActions.init({ payload: this.configuration }));\n    }\n  }\n\n  onEditorEvent(event: IFormBuilderEvent): void {\n    if (event.type === RX_REVERT_CUSTOMIZATION.events.revertCustomization) {\n      this.store$.dispatch(DocumentDesignerActions.revertCustomization());\n    }\n  }\n\n  canDeactivate(): boolean {\n    let canDeactivate = true;\n\n    this.isDirty$.pipe(take(1)).subscribe((isDirty) => {\n      canDeactivate = !isDirty;\n    });\n\n    return canDeactivate;\n  }\n\n  onCorrectIssue(validationIssue: IValidationIssue) {\n    if (validationIssue.data.propertyName === 'documentSchema') {\n      this.renderer.selectRootElement('#document-schema').focus();\n    } else {\n      this.inspectorSidebar.openPanel(0);\n\n      // need to wait until inspector will be visible\n      // there are no way to focus to invisible elements\n      setTimeout(\n        () =>\n          this.inspectorFocusEditorSubject.next({\n            editorName: validationIssue.data.propertyName,\n            data: validationIssue.data.data\n          }),\n        10\n      );\n    }\n  }\n\n  onSave(): void {\n    this.store$.dispatch(DocumentDesignerActions.saveDefinition());\n  }\n\n  onToggleDesignMode(): void {\n    this.store$.dispatch(DocumentDesignerActions.toggleDesignMode());\n  }\n\n  onDefinitionModelChange(definitionModel: IDocumentDefinitionModel): void {\n    this.store$.dispatch(\n      DocumentDesignerActions.updateDefinitionModelFromDesigner({ definitionModelFromDesigner: definitionModel })\n    );\n  }\n\n  onDefinitionInspectorInitialized(): void {\n    setTimeout(\n      () =>\n        this.inspectorFocusEditorSubject.next({\n          editorName: 'name',\n          data: {}\n        }),\n      10\n    );\n  }\n\n  private getFormBuilderConfig(\n    definitionModel: IDocumentDefinitionModel,\n    isCustomizationAllowed: boolean\n  ): IFormBuilderConfig {\n    return [\n      {\n        label: this.translateService.instant('com.bmc.arsys.rx.client.common.general-items.label'),\n        controls: [\n          {\n            name: 'name',\n            component: TextFormControlComponent,\n            isDisabled: Boolean(definitionModel.lastUpdateTime),\n            options: {\n              label: this.translateService.instant('com.bmc.arsys.rx.client.common.name.label'),\n              required: true\n            } as ITextFormControlOptions\n          },\n          {\n            name: 'description',\n            component: TextareaFormControlComponent,\n            options: {\n              label: this.translateService.instant('com.bmc.arsys.rx.client.common.description.label'),\n              rows: 3\n            } as ITextareaFormControlOptions\n          },\n          {\n            component: RxRevertCustomizationComponent,\n            options: {\n              allowOverlay: definitionModel.customizationOptions.allowOverlay,\n              scope: definitionModel.customizationOptions.scope,\n              overlayGroupId: definitionModel.overlayGroupId,\n              overlayDescriptor: definitionModel.overlayDescriptor\n            }\n          },\n          {\n            name: 'customizationOptions',\n            component: CustomizationOptionsComponent,\n            isDisabled: !isCustomizationAllowed,\n            options: {\n              definitionTypeDisplayName: this.translateService\n                .instant('com.bmc.arsys.rx.client.document-definition.label')\n                .toLowerCase(),\n              allowOverlay: definitionModel.customizationOptions.allowOverlay,\n              scope: definitionModel.customizationOptions.scope,\n              overlayGroupId: definitionModel.overlayGroupId,\n              overlayDescriptor: definitionModel.overlayDescriptor\n            }\n          }\n        ]\n      }\n    ] as IFormBuilderConfig;\n  }\n\n  private validate(definitionModel: IDocumentDefinitionModel): IValidationIssueSection[] {\n    const validationIssues: IValidationIssue[] = [];\n\n    if (isEmpty(trim(definitionModel.name))) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.cannot-be-blank.message',\n          {\n            propertyName: this.translateService.instant('com.bmc.arsys.rx.client.document-designer.document-name.label')\n          }\n        ),\n        data: {\n          propertyName: 'name'\n        }\n      });\n    }\n\n    if (definitionModel.name && !RX_RECORD_DEFINITION.validDefinitionNameRegex.test(definitionModel.name)) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.invalid-definition-name.message',\n          {\n            propertyName: this.translateService.instant('com.bmc.arsys.rx.client.document-designer.document-name.label')\n          }\n        ),\n        data: {\n          propertyName: 'name'\n        }\n      });\n    }\n\n    if (isEmpty(trim(definitionModel.documentSchema))) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.cannot-be-blank.message',\n          {\n            propertyName: this.translateService.instant(\n              'com.bmc.arsys.rx.client.document-designer.document-schema.label'\n            )\n          }\n        ),\n        data: {\n          propertyName: 'documentSchema'\n        }\n      });\n    } else if (isUndefined(this.rxJsonParserService.tryParseJson(definitionModel.documentSchema))) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.document-designer.validation.json-is-not-valid.message'\n        ),\n        data: {\n          propertyName: 'documentSchema'\n        }\n      });\n    }\n\n    return validationIssues.length\n      ? [\n          {\n            title: this.translateService.instant('com.bmc.arsys.rx.client.document-designer.title'),\n            issues: validationIssues\n          }\n        ]\n      : [];\n  }\n\n  ngOnDestroy(): void {\n    this.inspectorFocusEditorSubject.complete();\n    this.destroyed$.next(true);\n    this.destroyed$.complete();\n    this.store$.dispatch(DocumentDesignerActions.destroy());\n  }\n}\n","<ng-container *ngIf=\"vm$ | async as vm\">\n  <rx-designer-header\n    [bundleName]=\"vm.bundleFriendlyName\"\n    [breadcrumbItems]=\"vm.breadcrumbItems\"\n    [isDesignMode]=\"!vm.definitionForJsonViewer\"\n    [isSaveButtonDisabled]=\"vm.isSaveButtonDisabled\"\n    (toggleDesignMode)=\"onToggleDesignMode()\"\n    (save)=\"onSave()\"\n    (closeDesigner)=\"closeDesigner.emit()\"\n  ></rx-designer-header>\n\n  <div class=\"rx-designer-component\" [hidden]=\"!!vm.definitionForJsonViewer\">\n    <adapt-sidebar position=\"right\" panelWidth=\"280px\" [openedId]=\"0\">\n      <adapt-sidebar-item\n        headerTitle=\"{{ 'com.bmc.arsys.rx.client.common.properties.label' | translate }}\"\n        tooltipText=\"{{ 'com.bmc.arsys.rx.client.common.properties.label' | translate }}\"\n        iconClass=\"d-icon-pencil\"\n      >\n        <rx-form-builder\n          [config]=\"vm.definitionInspectorConfig\"\n          [focusEditor$]=\"inspectorFocusEditor$\"\n          (editorEvent)=\"onEditorEvent($event)\"\n          [isReadOnly]=\"vm.isReadOnly\"\n          [model]=\"vm.definitionModel\"\n          (formInitialized)=\"onDefinitionInspectorInitialized()\"\n          (modelChange)=\"onDefinitionModelChange($event)\"\n        ></rx-form-builder>\n      </adapt-sidebar-item>\n\n      <adapt-sidebar-item\n        headerTitle=\"{{ 'com.bmc.arsys.rx.client.designer.validation-issues.label' | translate }}\"\n        tooltipText=\"{{ 'com.bmc.arsys.rx.client.designer.validation-issues.label' | translate }}\"\n        [iconClass]=\"vm.hasValidationErrors ? 'd-icon-exclamation_triangle text-danger' : 'd-icon-exclamation_triangle'\"\n      >\n        <rx-validation-issues\n          [definitionTypeDisplayName]=\"'com.bmc.arsys.rx.client.document-definition.label' | translate\"\n          [issueSections]=\"vm.validationIssues\"\n          (correctIssue)=\"onCorrectIssue($event)\"\n        ></rx-validation-issues>\n      </adapt-sidebar-item>\n\n      <div class=\"main rx-designer-container h-100\">\n        <adapt-rx-control-label\n          [label]=\"'com.bmc.arsys.rx.client.document-designer.document-schema.label' | translate\"\n          [showRequiredLabel]=\"true\"\n        >\n        </adapt-rx-control-label>\n\n        <textarea\n          [formControl]=\"schemaFormControl\"\n          [readonly]=\"vm.isReadOnly\"\n          class=\"form-control h-100\"\n          name=\"documentSchema\"\n          required\n          id=\"document-schema\"\n          rx-id=\"document-schema\"\n        ></textarea>\n      </div>\n    </adapt-sidebar>\n  </div>\n\n  <adapt-code-viewer\n    *ngIf=\"vm.definitionForJsonViewer\"\n    [code]=\"vm.definitionForJsonViewer | json\"\n    [lang]=\"'javascript'\"\n    [hasToolbar]=\"false\"\n    [theme]=\"'light'\"\n    class=\"full-size\"\n  >\n  </adapt-code-viewer>\n</ng-container>\n","import { Component, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport {\n  IComponentCanDeactivate,\n  IDesignerConfiguration,\n  RX_APPLICATION,\n  RxBundleCacheService,\n  RxComponentCanDeactivateGuard,\n  RxDefinitionNameService,\n  RxPageTitleService\n} from '@helix/platform/shared/api';\nimport { RxUtilityModalsService } from '@helix/platform/ui-kit';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Subscription } from 'rxjs';\nimport { DocumentDesignerComponent } from '../document-designer/document-designer.component';\n\n@Component({\n  selector: 'rx-document-designer-page',\n  templateUrl: './document-designer-page.component.html'\n})\nexport class DocumentDesignerPageComponent implements OnInit, OnDestroy, IComponentCanDeactivate {\n  configuration: IDesignerConfiguration;\n  isInitialized = false;\n\n  private definitionsRoute = 'document-definitions';\n  private pageTitle = this.translateService.instant('com.bmc.arsys.rx.client.document-designer.title');\n\n  private isNewDefinition: boolean;\n  private subscription: Subscription;\n\n  @ViewChild(DocumentDesignerComponent)\n  private designerComponent: DocumentDesignerComponent;\n\n  constructor(\n    private activatedRoute: ActivatedRoute,\n    private router: Router,\n    private rxBundleCacheService: RxBundleCacheService,\n    private rxComponentCanDeactivateGuard: RxComponentCanDeactivateGuard,\n    private rxDefinitionNameService: RxDefinitionNameService,\n    private rxPageTitleService: RxPageTitleService,\n    private rxUtilityModalsService: RxUtilityModalsService,\n    private translateService: TranslateService\n  ) {}\n\n  ngOnInit(): void {\n    this.rxComponentCanDeactivateGuard.setPageComponent(this);\n\n    this.subscription = this.activatedRoute.params.subscribe(({ definitionName, bundleId }) => {\n      this.rxBundleCacheService.bundleId = bundleId || this.rxDefinitionNameService.getBundleId(definitionName);\n\n      this.isInitialized = true;\n      this.isNewDefinition = !definitionName;\n\n      this.configuration = {\n        ...this.configuration,\n        bundleId: this.rxBundleCacheService.bundleId,\n        definitionName\n      };\n\n      this.rxPageTitleService.set([this.rxDefinitionNameService.getDisplayName(definitionName), this.pageTitle]);\n    });\n  }\n\n  ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n    this.rxComponentCanDeactivateGuard.setPageComponent(null);\n  }\n\n  canDeactivate(): boolean {\n    return this.designerComponent?.canDeactivate() ?? true;\n  }\n\n  confirmDeactivation(): Promise<boolean> {\n    return this.rxUtilityModalsService.confirmUnsavedChanges();\n  }\n\n  onCloseDesigner(): void {\n    this.router.navigate([\n      RX_APPLICATION.innovationStudioBundleId,\n      this.rxBundleCacheService.bundleId,\n      this.definitionsRoute\n    ]);\n  }\n\n  onDefinitionSaved(definitionName: string): void {\n    if (this.isNewDefinition) {\n      this.router.navigate(['edit2', definitionName], { relativeTo: this.activatedRoute.parent });\n    }\n  }\n\n  onDefinitionErrorLoading(): void {\n    this.router.navigate(['new2', this.rxBundleCacheService.bundleId], { relativeTo: this.activatedRoute.parent });\n  }\n}\n","<rx-document-designer\n  *ngIf=\"isInitialized\"\n  [configuration]=\"configuration\"\n  (definitionSaved)=\"onDefinitionSaved($event)\"\n  (definitionErrorLoading)=\"onDefinitionErrorLoading()\"\n  (closeDesigner)=\"onCloseDesigner()\"\n></rx-document-designer>\n","import { createReducer, on } from '@ngrx/store';\nimport { IDocumentDefinitionModel } from '../../document-designer.types';\nimport * as DocumentDesignerActions from './document-designer.actions';\nimport { IDocumentDesignerModel } from './document-designer.types';\n\nconst initialModel: IDocumentDefinitionModel = {\n  name: null,\n  documentSchema: null,\n  customizationOptions: { allowOverlay: null, scope: null }\n};\n\nexport const initialState: IDocumentDesignerModel = {\n  bundleId: null,\n  definitionName: null,\n  isDesignMode: true,\n  definitionModel: initialModel,\n  definitionModelFromDefinition: initialModel,\n  isDirty: false,\n  savedDefinitionName: null,\n  originalDefinition: null\n};\n\nconst reducer = createReducer(\n  initialState,\n\n  on(DocumentDesignerActions.init, (state: IDocumentDesignerModel, { payload }) => ({\n    ...initialState,\n    bundleId: payload.bundleId,\n    definitionName: payload.definitionName\n  })),\n\n  on(DocumentDesignerActions.initDefinitionData, (state: IDocumentDesignerModel, { definition, definitionModel }) => ({\n    ...state,\n    definitionModel,\n    definitionModelFromDefinition: definitionModel,\n    originalDefinition: definition\n  })),\n\n  on(DocumentDesignerActions.markDesignerPristine, (state: IDocumentDesignerModel) => ({\n    ...state,\n    isDirty: false\n  })),\n\n  on(DocumentDesignerActions.markDesignerDirty, (state: IDocumentDesignerModel) => ({\n    ...state,\n    isDirty: true\n  })),\n\n  on(DocumentDesignerActions.toggleDesignMode, (state: IDocumentDesignerModel) => ({\n    ...state,\n    isDesignMode: !state.isDesignMode\n  })),\n\n  on(\n    DocumentDesignerActions.updateDefinitionModelFromDesigner,\n    (state: IDocumentDesignerModel, { definitionModelFromDesigner }) => ({\n      ...state,\n      definitionModel: { ...state.definitionModel, ...definitionModelFromDesigner }\n    })\n  ),\n\n  on(DocumentDesignerActions.saveDefinitionSuccess, (state: IDocumentDesignerModel, { savedDefinitionName }) => ({\n    ...state,\n    savedDefinitionName\n  })),\n\n  on(DocumentDesignerActions.destroy, (state: IDocumentDesignerModel) => ({\n    ...initialState\n  }))\n);\n\nexport function documentDesignerModelReducer(state, action) {\n  return reducer(state, action);\n}\n","import { HttpResponse } from '@angular/common/http';\nimport { ErrorHandler, Injectable } from '@angular/core';\nimport { IDocumentDefinition, RxDocumentDefinitionService } from '@helix/platform/document/api';\nimport { RxDefinitionNameService, RxDefinitionUpdateService, RxNotificationService } from '@helix/platform/shared/api';\nimport { Actions, createEffect, ofType } from '@ngrx/effects';\nimport { Store } from '@ngrx/store';\nimport { TranslateService } from '@ngx-translate/core';\nimport { last } from 'lodash';\nimport { of } from 'rxjs';\nimport { catchError, filter, map, switchMap, tap, withLatestFrom } from 'rxjs/operators';\nimport { DocumentDesignerService } from '../../document-designer.service';\nimport * as DocumentDesignerActions from './document-designer.actions';\nimport {\n  bundleIdSelector,\n  definitionModelSelector,\n  definitionNameSelector,\n  originalDefinitionSelector\n} from './document-designer.selectors';\n\n@Injectable()\nexport class DocumentDesignerEffects {\n  constructor(\n    private store$: Store<any>,\n    private actions$: Actions,\n    private errorHandler: ErrorHandler,\n    private rxDefinitionUpdateService: RxDefinitionUpdateService,\n    private documentDesignerService: DocumentDesignerService,\n    private rxNotificationService: RxNotificationService,\n    private translateService: TranslateService,\n    private rxDocumentDefinitionService: RxDocumentDefinitionService,\n    private rxDefinitionNameService: RxDefinitionNameService\n  ) {}\n\n  initDocumentDesigner$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(DocumentDesignerActions.init),\n      map((action) => DocumentDesignerActions.loadDefinition())\n    )\n  );\n\n  loadDefinition$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(DocumentDesignerActions.loadDefinition),\n      withLatestFrom(this.store$.select(definitionNameSelector)),\n      switchMap(([action, definitionName]) =>\n        definitionName\n          ? this.rxDocumentDefinitionService.get(definitionName)\n          : this.rxDocumentDefinitionService.getNew()\n      ),\n      map((definition: IDocumentDefinition) =>\n        DocumentDesignerActions.loadDefinitionSuccess({\n          definition\n        })\n      )\n    )\n  );\n\n  loadDefinitionSuccess$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(DocumentDesignerActions.loadDefinitionSuccess),\n      map((action) => {\n        let definitionModelFromDefinition = {\n          customizationOptions: {\n            scope: action.definition.scope,\n            allowOverlay: action.definition.allowOverlay\n          },\n          description: action.definition.description,\n          documentSchema: action.definition.documentSchema,\n          guid: action.definition.guid,\n          lastChangedBy: action.definition.lastChangedBy,\n          lastUpdateTime: action.definition.lastUpdateTime,\n          name: this.rxDefinitionNameService.getDisplayName(action.definition.name),\n          overlayDescriptor: action.definition.overlayDescriptor,\n          overlayGroupId: action.definition.overlayGroupId,\n          owner: action.definition.owner\n        };\n\n        return DocumentDesignerActions.initDefinitionData({\n          definition: action.definition,\n          definitionModel: definitionModelFromDefinition\n        });\n      })\n    )\n  );\n\n  revertCustomization$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(DocumentDesignerActions.revertCustomization),\n      withLatestFrom(this.store$.select(definitionModelSelector), this.store$.select(bundleIdSelector)),\n      switchMap(([_, definitionModel, bundleId]) =>\n        this.rxDocumentDefinitionService.revertCustomization(`${bundleId}:${definitionModel.name}`)\n      ),\n      map(() => DocumentDesignerActions.loadDefinition())\n    )\n  );\n\n  markPristine$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(DocumentDesignerActions.initDefinitionData, DocumentDesignerActions.saveDefinition),\n      map(() => DocumentDesignerActions.markDesignerPristine())\n    )\n  );\n\n  markDirty$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(DocumentDesignerActions.updateDefinitionModelFromDesigner, DocumentDesignerActions.saveDefinitionError),\n      map(() => DocumentDesignerActions.markDesignerDirty())\n    )\n  );\n\n  saveDefinition$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(DocumentDesignerActions.saveDefinition),\n      withLatestFrom(\n        this.store$.select(definitionModelSelector),\n        this.store$.select(originalDefinitionSelector),\n        this.store$.select(bundleIdSelector)\n      ),\n      switchMap(([_, definitionModel, originalDefinition, bundleId]) => {\n        const definition = this.documentDesignerService.getDefinitionFromDefinitionModel(definitionModel, bundleId);\n\n        return (\n          definition.lastUpdateTime\n            ? this.rxDefinitionUpdateService.execute(\n                this.rxDocumentDefinitionService.update.bind(this.rxDocumentDefinitionService, {\n                  ...originalDefinition,\n                  ...definition\n                })\n              )\n            : this.rxDocumentDefinitionService.create(definition)\n        ).pipe(\n          map((response: HttpResponse<any>) => {\n            const definitionName =\n              decodeURIComponent(last(response?.headers.get('location').split('/')) || '') ||\n              this.rxDefinitionNameService.getDefinitionName(bundleId, definitionModel.name);\n\n            return DocumentDesignerActions.saveDefinitionSuccess({\n              savedDefinitionName: definitionName\n            });\n          }),\n          catchError((error) => {\n            this.errorHandler.handleError(error);\n\n            return of(DocumentDesignerActions.saveDefinitionError());\n          })\n        );\n      })\n    )\n  );\n\n  saveDefinitionSuccess$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(DocumentDesignerActions.saveDefinitionSuccess),\n      withLatestFrom(this.store$.select(definitionNameSelector)),\n      tap(() => {\n        this.rxNotificationService.addSuccessMessage(\n          this.translateService.instant('com.bmc.arsys.rx.client.designer.definition-saved-successfully.message', {\n            definitionTypeDisplayName: this.translateService.instant(\n              'com.bmc.arsys.rx.client.document-definition.label'\n            )\n          })\n        );\n      }),\n      filter(([action, definitionName]) => !!definitionName),\n      map(() => DocumentDesignerActions.loadDefinition())\n    )\n  );\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { AdaptCodeViewerModule, AdaptRxLabelModule, AdaptSidebarModule, AdaptTabsModule } from '@bmc-ux/adapt-angular';\nimport { RxDesignerHeaderModule, RxFormBuilderModule } from '@helix/platform/shared/components';\nimport { RxJsonViewerModule, RxValidationIssuesModule } from '@helix/platform/ui-kit';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { DocumentDesignerComponent } from './document-designer.component';\nimport { StoreModule } from '@ngrx/store';\nimport { EffectsModule } from '@ngrx/effects';\nimport { RX_DOCUMENT_DESIGNER } from '../document-designer.constant';\nimport { documentDesignerModelReducer } from './+state/document-designer-model.reducer';\nimport { DocumentDesignerEffects } from './+state/document-designer.effects';\n\n@NgModule({\n  declarations: [DocumentDesignerComponent],\n  exports: [DocumentDesignerComponent],\n  imports: [\n    AdaptCodeViewerModule,\n    AdaptRxLabelModule,\n    AdaptSidebarModule,\n    AdaptTabsModule,\n    CommonModule,\n    FormsModule,\n    TranslateModule,\n    RxDesignerHeaderModule,\n    RxFormBuilderModule,\n    RxJsonViewerModule,\n    RxValidationIssuesModule,\n    ReactiveFormsModule,\n    StoreModule.forFeature(RX_DOCUMENT_DESIGNER.featureSelector, {\n      model: documentDesignerModelReducer\n    }),\n    EffectsModule.forFeature([DocumentDesignerEffects])\n  ]\n})\nexport class DocumentDesignerModule {}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { DocumentDesignerModule } from '../document-designer/document-designer.module';\nimport { DocumentDesignerPageComponent } from './document-designer-page.component';\n\n@NgModule({\n  declarations: [DocumentDesignerPageComponent],\n  exports: [DocumentDesignerPageComponent],\n  imports: [CommonModule, DocumentDesignerModule, TranslateModule]\n})\nexport class DocumentDesignerPageModule {\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["DocumentDesignerActions.updateDefinitionModelFromDesigner","DocumentDesignerActions.init","DocumentDesignerActions.revertCustomization","DocumentDesignerActions.saveDefinition","DocumentDesignerActions.toggleDesignMode","DocumentDesignerActions.destroy","DocumentDesignerActions.initDefinitionData","DocumentDesignerActions.markDesignerPristine","DocumentDesignerActions.markDesignerDirty","DocumentDesignerActions.saveDefinitionSuccess","DocumentDesignerActions.loadDefinition","DocumentDesignerActions.loadDefinitionSuccess","DocumentDesignerActions.saveDefinitionError"],"mappings":"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"}