{"version":3,"file":"services-provider-region.component.js","sourceRoot":"","sources":["../../../../../../../libs/platform/admin/components/services-provider-region/services-provider-region.component.ts","../../../../../../../libs/platform/admin/components/services-provider-region/services-provider-region.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { KeyValueObject, RxSelectOption } from '@bmc-ux/adapt-angular';\nimport { find, get } from 'lodash';\nimport { RX_SERVICES_PROVIDER_REGION } from './services-provider-region.constant';\nimport { TranslateService } from '@ngx-translate/core';\nimport { RxNotificationService, RxSystemConfigurationService } from '@helix/platform/shared/api';\n\n@Component({\n  selector: 'rx-admin-services-provider-region',\n  templateUrl: './services-provider-region.component.html',\n  styleUrls: ['./services-provider-region.component.scss']\n})\nexport class ServicesProviderRegionAdminComponent implements OnInit {\n  servicesProviderRegionForm: FormGroup;\n  private isSaveInProgress = false;\n  private defaultSelection = this.translateService.instant('com.bmc.arsys.rx.client.common.select.label');\n\n  regionOptions: RxSelectOption[] = RX_SERVICES_PROVIDER_REGION.regionOptions.map((region: KeyValueObject) => ({\n    ...region,\n    name: this.translateService.instant(region.name)\n  }));\n\n  constructor(\n    private translateService: TranslateService,\n    private rxSystemConfigurationService: RxSystemConfigurationService,\n    private rxNotificationService: RxNotificationService\n  ) {}\n\n  ngOnInit(): void {\n    this.servicesProviderRegionForm = new FormGroup({\n      region: new FormControl('')\n    });\n\n    this.rxSystemConfigurationService\n      .getConfiguration(RX_SERVICES_PROVIDER_REGION.connections.cognitiveAdminCredential)\n      .subscribe((result) => {\n        const cognitiveAdminCredential = JSON.parse(result.value as string);\n\n        this.servicesProviderRegionForm.get('region').setValue([\n          find(this.regionOptions, {\n            id: cognitiveAdminCredential[RX_SERVICES_PROVIDER_REGION.providers.watson].cognitiveAdminRegionName\n          }) as RxSelectOption\n        ]);\n      });\n  }\n\n  optionFormatter = (regionNameOption: RxSelectOption): string => {\n    return get(regionNameOption, 'name', this.defaultSelection);\n  };\n\n  save(): void {\n    this.isSaveInProgress = true;\n\n    const payload = {\n      [RX_SERVICES_PROVIDER_REGION.providers.watson]: {\n        cognitiveAdminRegionName: this.servicesProviderRegionForm.get('region').value[0].id\n      }\n    };\n\n    this.rxSystemConfigurationService\n      .setConfiguration(RX_SERVICES_PROVIDER_REGION.connections.cognitiveAdminCredential, payload)\n      .subscribe(\n        (response) => {\n          this.isSaveInProgress = false;\n          this.servicesProviderRegionForm.markAsPristine();\n\n          this.rxNotificationService.addSuccessMessage(\n            this.translateService.instant('com.bmc.arsys.rx.client.admin.services-provider-region.saved.message')\n          );\n        },\n        (error) => {\n          this.isSaveInProgress = false;\n        }\n      );\n  }\n\n  canSave(): boolean {\n    return !this.isSaveInProgress && this.servicesProviderRegionForm.valid && this.servicesProviderRegionForm.dirty;\n  }\n}\n","<rx-admin-settings header=\"{{ 'com.bmc.arsys.rx.client.admin.services-provider-region.header.title' | translate }}\">\n  <form [formGroup]=\"servicesProviderRegionForm\">\n    <adapt-rx-select\n      [options]=\"regionOptions\"\n      label=\"{{ 'com.bmc.arsys.rx.client.admin.services-provider-region.region.label' | translate }}\"\n      name=\"region\"\n      [optionFormatter]=\"optionFormatter\"\n      formControlName=\"region\"\n      rx-id=\"region\"\n      class=\"form-group d-block\"\n      required\n    ></adapt-rx-select>\n\n    <button adapt-button btn-type=\"primary\" type=\"button\" rx-id=\"save-button\" (click)=\"save()\" [disabled]=\"!canSave()\">\n      {{ 'com.bmc.arsys.rx.client.common.save.label' | translate }}\n    </button>\n  </form>\n</rx-admin-settings>\n"]}