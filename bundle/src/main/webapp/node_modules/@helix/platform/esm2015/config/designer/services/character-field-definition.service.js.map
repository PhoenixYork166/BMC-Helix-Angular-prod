{"version":3,"file":"character-field-definition.service.js","sourceRoot":"","sources":["../../../../../../../libs/platform/config/designer/services/character-field-definition.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable, Injector } from '@angular/core';\nimport { IFieldOptions } from '@helix/platform/config/api';\nimport { RX_RECORD_DEFINITION } from '@helix/platform/record/api';\nimport { IFormBuilderConfig } from '@helix/platform/shared/api';\nimport {\n  CounterFormControlComponent,\n  ICounterFormControlOptions,\n  ITextFormControlOptions,\n  TextFormControlComponent\n} from '@helix/platform/shared/components';\nimport { BaseFieldDefinitionService } from './base-field-definition.service';\nimport { IValidationIssue, ValidationIssueType } from '@helix/platform/ui-kit';\nimport { RX_NUMBER, RxNumberUtilsService } from '@helix/platform/utils';\nimport { IConfigFieldDefinitionModel } from '../config-designer.types';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CharacterFieldDefinitionService extends BaseFieldDefinitionService {\n  dataType = RX_RECORD_DEFINITION.dataTypes.character.resourceType;\n\n  constructor(injector: Injector, private rxNumberUtilsService: RxNumberUtilsService) {\n    super(injector);\n  }\n\n  getFieldInspectorConfig(options: IFieldOptions): IFormBuilderConfig {\n    const inspectorConfig = super.getFieldInspectorConfig(options);\n\n    // Adding controls specific to character field to Details section\n    inspectorConfig[1].controls.splice(\n      1,\n      0,\n      {\n        name: 'minValue',\n        component: CounterFormControlComponent,\n        options: {\n          label: this.translateService.instant(\n            'com.bmc.arsys.rx.client.config-designer.config-properties.min-length.label'\n          ),\n          allowIntegerOnly: true,\n          minValue: 0,\n          maxValue: RX_NUMBER.maxInteger\n        } as ICounterFormControlOptions\n      },\n      {\n        name: 'maxValue',\n        component: CounterFormControlComponent,\n        options: {\n          label: this.translateService.instant(\n            'com.bmc.arsys.rx.client.config-designer.config-properties.max-length.label'\n          ),\n          allowIntegerOnly: true,\n          minValue: 0,\n          maxValue: RX_NUMBER.maxInteger\n        } as ICounterFormControlOptions\n      },\n      {\n        name: 'defaultValue',\n        component: TextFormControlComponent,\n        options: {\n          label: this.translateService.instant('com.bmc.arsys.rx.client.common.default-value.label')\n        } as ITextFormControlOptions\n      }\n    );\n\n    return inspectorConfig;\n  }\n\n  validate(fieldModel: IConfigFieldDefinitionModel): IValidationIssue[] {\n    const validationIssues = super.validate(fieldModel);\n\n    if (this.rxNumberUtilsService.isFiniteOrNumberString(fieldModel.minValue) && Number(fieldModel.minValue) < 0) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.invalid-min-length-error.message'\n        ),\n        data: {\n          propertyName: 'minValue',\n          guid: fieldModel.guid\n        }\n      });\n    }\n\n    if (this.rxNumberUtilsService.isFiniteOrNumberString(fieldModel.maxValue) && Number(fieldModel.maxValue) < 0) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.invalid-min-length-error.message'\n        ),\n        data: {\n          propertyName: 'maxValue',\n          guid: fieldModel.guid\n        }\n      });\n    }\n\n    if (fieldModel.minValue && Number(fieldModel.minValue) > RX_NUMBER.maxInteger) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.value-is-too-large-error.message',\n          {\n            propertyName: this.translateService.instant(\n              'com.bmc.arsys.rx.client.config-designer.config-properties.min-length.label'\n            ),\n            maxValue: RX_NUMBER.maxInteger\n          }\n        ),\n        data: {\n          propertyName: 'minValue',\n          guid: fieldModel.guid\n        }\n      });\n    }\n\n    if (fieldModel.maxValue && Number(fieldModel.maxValue) > RX_NUMBER.maxInteger) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.value-is-too-large-error.message',\n          {\n            propertyName: this.translateService.instant(\n              'com.bmc.arsys.rx.client.config-designer.config-properties.max-length.label'\n            ),\n            maxValue: RX_NUMBER.maxInteger\n          }\n        ),\n        data: {\n          propertyName: 'maxValue',\n          guid: fieldModel.guid\n        }\n      });\n    }\n\n    if (\n      this.rxNumberUtilsService.isFiniteOrNumberString(fieldModel.minValue) &&\n      this.rxNumberUtilsService.isFiniteOrNumberString(fieldModel.maxValue) &&\n      Number(fieldModel.minValue) > Number(fieldModel.maxValue)\n    ) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.value-is-too-large-error.message',\n          {\n            propertyName: this.translateService.instant(\n              'com.bmc.arsys.rx.client.config-designer.config-properties.min-length.label'\n            ),\n            maxValue: this.translateService.instant(\n              'com.bmc.arsys.rx.client.config-designer.config-properties.max-length.label'\n            )\n          }\n        ),\n        data: {\n          propertyName: 'minValue',\n          guid: fieldModel.guid\n        }\n      });\n    }\n\n    return validationIssues;\n  }\n}\n"]}