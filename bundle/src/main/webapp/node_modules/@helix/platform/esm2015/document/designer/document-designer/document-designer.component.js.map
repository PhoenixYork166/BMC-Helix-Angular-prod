{"version":3,"file":"document-designer.component.js","sourceRoot":"","sources":["../../../../../../../libs/platform/document/designer/document-designer/document-designer.component.ts","../../../../../../../libs/platform/document/designer/document-designer/document-designer.component.html"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  EventEmitter,\n  Input,\n  OnChanges,\n  OnDestroy,\n  OnInit,\n  Output,\n  Renderer2,\n  SimpleChanges,\n  ViewChild\n} from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { AdaptSidebarComponent } from '@bmc-ux/adapt-angular';\nimport { IDocumentDefinition } from '@helix/platform/document/api';\nimport { RX_RECORD_DEFINITION } from '@helix/platform/record/api';\nimport {\n  IDesignerConfiguration,\n  IFormBuilderConfig,\n  IFormBuilderEvent,\n  IPlainObject,\n  RxGlobalCacheService,\n  RxNotificationService,\n  RxOverlayService\n} from '@helix/platform/shared/api';\nimport {\n  CustomizationOptionsComponent,\n  ITextareaFormControlOptions,\n  ITextFormControlOptions,\n  RX_REVERT_CUSTOMIZATION,\n  RxRevertCustomizationComponent,\n  TextareaFormControlComponent,\n  TextFormControlComponent\n} from '@helix/platform/shared/components';\nimport {\n  IBreadcrumbItem,\n  IValidationIssue,\n  IValidationIssueSection,\n  ValidationIssueType\n} from '@helix/platform/ui-kit';\nimport { RxJsonParserService } from '@helix/platform/utils';\nimport { Store } from '@ngrx/store';\nimport { TranslateService } from '@ngx-translate/core';\nimport { isEmpty, isUndefined, some, trim } from 'lodash';\nimport { combineLatest, Observable, of, ReplaySubject, Subject } from 'rxjs';\nimport {\n  filter,\n  map,\n  shareReplay,\n  skip,\n  startWith,\n  switchMap,\n  take,\n  takeUntil,\n  tap,\n  withLatestFrom\n} from 'rxjs/operators';\nimport { DocumentDesignerService } from '../document-designer.service';\nimport { IDocumentDefinitionModel } from '../document-designer.types';\nimport * as DocumentDesignerActions from './+state/document-designer.actions';\nimport {\n  bundleIdSelector,\n  definitionModelFromDefinitionSelector,\n  definitionModelSelector,\n  isDesignModeSelector,\n  isDirtySelector,\n  originalDefinitionSelector,\n  savedDefinitionNameSelector\n} from './+state/document-designer.selectors';\n\n@Component({\n  selector: 'rx-document-designer',\n  templateUrl: './document-designer.component.html',\n  styleUrls: ['./document-designer.component.scss']\n})\nexport class DocumentDesignerComponent implements OnInit, OnChanges, OnDestroy {\n  @Input()\n  configuration: IDesignerConfiguration;\n\n  @Output()\n  definitionSaved: EventEmitter<string> = new EventEmitter();\n\n  @Output()\n  definitionErrorLoading: EventEmitter<void> = new EventEmitter();\n\n  @Output()\n  closeDesigner: EventEmitter<void> = new EventEmitter<void>();\n\n  @ViewChild(AdaptSidebarComponent, { static: false })\n  inspectorSidebar: AdaptSidebarComponent;\n\n  schemaFormControl: FormControl = new FormControl('', { updateOn: 'blur' });\n  private isDirty$: Observable<boolean> = this.store$.select(isDirtySelector);\n  private definitionModel$: Observable<IDocumentDefinitionModel> = this.store$.select(definitionModelSelector);\n  private isDesignMode$ = this.store$.select(isDesignModeSelector);\n  private bundleId$ = this.store$.select(bundleIdSelector);\n  private destroyed$ = new ReplaySubject<boolean>(1);\n  private originalDefinition$ = this.store$.select(originalDefinitionSelector);\n  private inspectorFocusEditorSubject = new Subject<{ editorName: string; data: IPlainObject }>();\n  inspectorFocusEditor$ = this.inspectorFocusEditorSubject.asObservable();\n\n  private bundleFriendlyName$ = this.bundleId$.pipe(\n    switchMap((bundleId) => this.rxGlobalCacheService.getBundleFriendlyName(bundleId))\n  );\n\n  private validationIssues$: Observable<IValidationIssueSection[]> = this.definitionModel$.pipe(\n    map((definitionModel: IDocumentDefinitionModel) => this.validate(definitionModel)),\n    shareReplay(1)\n  );\n\n  private hasValidationErrors$: Observable<boolean> = this.validationIssues$.pipe(\n    map((issueSections) =>\n      some(issueSections, {\n        issues: [{ type: ValidationIssueType.Error }]\n      })\n    )\n  );\n\n  private definitionFromDefinitionModel$: Observable<IDocumentDefinition> = this.definitionModel$.pipe(\n    withLatestFrom(this.bundleId$),\n    map(([definitionModel, bundleId]) =>\n      this.documentDesignerService.getDefinitionFromDefinitionModel(definitionModel, bundleId)\n    )\n  );\n\n  private areNewDefinitionsAllowed$ = this.store$\n    .select(bundleIdSelector)\n    .pipe(switchMap((bundleId) => this.rxOverlayService.areNewDefinitionsAllowed(bundleId)));\n\n  private isReadOnly$ = this.definitionFromDefinitionModel$.pipe(\n    filter((definition) => !!definition.lastUpdateTime),\n    withLatestFrom(this.areNewDefinitionsAllowed$),\n    map(\n      ([definition, areNewDefinitionsAllowed]) =>\n        !areNewDefinitionsAllowed || !this.rxOverlayService.isCustomizationEnabled('allowOverlay', definition)\n    ),\n    tap((isReadOnly: boolean) => {\n      if (isReadOnly) {\n        this.rxNotificationService.addWarningMessage(\n          this.translateService.instant('com.bmc.arsys.rx.client.designer.read-only-definition-warning.message')\n        );\n      }\n    }),\n    startWith(false),\n    shareReplay(1)\n  );\n\n  private isSaveButtonDisabled$: Observable<boolean> = combineLatest([\n    this.hasValidationErrors$,\n    this.isDirty$,\n    this.isReadOnly$\n  ]).pipe(\n    map(([hasValidationErrors, isDirty, isReadOnly]) => hasValidationErrors || !isDirty || isReadOnly),\n    startWith(true)\n  );\n\n  private definitionForJsonViewer$: Observable<IDocumentDefinition> = this.isDesignMode$.pipe(\n    switchMap((isDesignMode: boolean) =>\n      isDesignMode\n        ? of(null)\n        : combineLatest([this.definitionFromDefinitionModel$, this.originalDefinition$]).pipe(\n            map(([definitionFromDefinitionModel, originalDefinition]) => ({\n              ...originalDefinition,\n              ...definitionFromDefinitionModel\n            }))\n          )\n    )\n  );\n\n  private breadcrumbItems$: Observable<IBreadcrumbItem[]> = this.definitionModel$.pipe(\n    map((definitionModel) => [\n      {\n        label:\n          definitionModel.name ||\n          `<${this.translateService.instant('com.bmc.arsys.rx.client.document-designer.new-document.label')}>`,\n        data: {}\n      }\n    ])\n  );\n\n  private definitionInspectorConfig$ = this.definitionModel$.pipe(\n    map((definitionModel) => {\n      const isCustomizationAllowed = Boolean(definitionModel.lastUpdateTime)\n        ? this.rxOverlayService.isCustomizationEnabled('allowOverlay', definitionModel)\n        : true;\n\n      return this.getFormBuilderConfig(definitionModel, isCustomizationAllowed);\n    })\n  );\n\n  vm$ = combineLatest([\n    this.breadcrumbItems$,\n    this.bundleFriendlyName$,\n    this.definitionModel$,\n    this.hasValidationErrors$,\n    this.isReadOnly$,\n    this.definitionForJsonViewer$,\n    this.isSaveButtonDisabled$,\n    this.definitionInspectorConfig$,\n    this.validationIssues$\n  ]).pipe(\n    map(\n      ([\n        breadcrumbItems,\n        bundleFriendlyName,\n        definitionModel,\n        hasValidationErrors,\n        isReadOnly,\n        definitionForJsonViewer,\n        isSaveButtonDisabled,\n        definitionInspectorConfig,\n        validationIssues\n      ]) => ({\n        breadcrumbItems,\n        bundleFriendlyName,\n        definitionModel,\n        hasValidationErrors,\n        isReadOnly,\n        definitionForJsonViewer,\n        isSaveButtonDisabled,\n        definitionInspectorConfig,\n        validationIssues\n      })\n    )\n  );\n\n  constructor(\n    private store$: Store<any>,\n    private renderer: Renderer2,\n    private rxGlobalCacheService: RxGlobalCacheService,\n    private rxJsonParserService: RxJsonParserService,\n    private rxNotificationService: RxNotificationService,\n    private rxOverlayService: RxOverlayService,\n    private translateService: TranslateService,\n    private documentDesignerService: DocumentDesignerService\n  ) {}\n\n  ngOnInit(): void {\n    this.schemaFormControl.valueChanges.pipe(takeUntil(this.destroyed$)).subscribe((documentSchema) => {\n      this.store$.dispatch(\n        DocumentDesignerActions.updateDefinitionModelFromDesigner({\n          definitionModelFromDesigner: { documentSchema } as IDocumentDefinitionModel\n        })\n      );\n    });\n\n    this.store$\n      .select(definitionModelFromDefinitionSelector)\n      .pipe(takeUntil(this.destroyed$))\n      .subscribe((definitionModel) => {\n        this.schemaFormControl.patchValue(definitionModel.documentSchema, { emitEvent: false });\n      });\n\n    this.store$\n      .select(savedDefinitionNameSelector)\n      .pipe(skip(1), takeUntil(this.destroyed$), filter(Boolean))\n      .subscribe((savedDefinitionName: string) => {\n        this.definitionSaved.emit(savedDefinitionName);\n      });\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.configuration.currentValue) {\n      this.store$.dispatch(DocumentDesignerActions.init({ payload: this.configuration }));\n    }\n  }\n\n  onEditorEvent(event: IFormBuilderEvent): void {\n    if (event.type === RX_REVERT_CUSTOMIZATION.events.revertCustomization) {\n      this.store$.dispatch(DocumentDesignerActions.revertCustomization());\n    }\n  }\n\n  canDeactivate(): boolean {\n    let canDeactivate = true;\n\n    this.isDirty$.pipe(take(1)).subscribe((isDirty) => {\n      canDeactivate = !isDirty;\n    });\n\n    return canDeactivate;\n  }\n\n  onCorrectIssue(validationIssue: IValidationIssue) {\n    if (validationIssue.data.propertyName === 'documentSchema') {\n      this.renderer.selectRootElement('#document-schema').focus();\n    } else {\n      this.inspectorSidebar.openPanel(0);\n\n      // need to wait until inspector will be visible\n      // there are no way to focus to invisible elements\n      setTimeout(\n        () =>\n          this.inspectorFocusEditorSubject.next({\n            editorName: validationIssue.data.propertyName,\n            data: validationIssue.data.data\n          }),\n        10\n      );\n    }\n  }\n\n  onSave(): void {\n    this.store$.dispatch(DocumentDesignerActions.saveDefinition());\n  }\n\n  onToggleDesignMode(): void {\n    this.store$.dispatch(DocumentDesignerActions.toggleDesignMode());\n  }\n\n  onDefinitionModelChange(definitionModel: IDocumentDefinitionModel): void {\n    this.store$.dispatch(\n      DocumentDesignerActions.updateDefinitionModelFromDesigner({ definitionModelFromDesigner: definitionModel })\n    );\n  }\n\n  onDefinitionInspectorInitialized(): void {\n    setTimeout(\n      () =>\n        this.inspectorFocusEditorSubject.next({\n          editorName: 'name',\n          data: {}\n        }),\n      10\n    );\n  }\n\n  private getFormBuilderConfig(\n    definitionModel: IDocumentDefinitionModel,\n    isCustomizationAllowed: boolean\n  ): IFormBuilderConfig {\n    return [\n      {\n        label: this.translateService.instant('com.bmc.arsys.rx.client.common.general-items.label'),\n        controls: [\n          {\n            name: 'name',\n            component: TextFormControlComponent,\n            isDisabled: Boolean(definitionModel.lastUpdateTime),\n            options: {\n              label: this.translateService.instant('com.bmc.arsys.rx.client.common.name.label'),\n              required: true\n            } as ITextFormControlOptions\n          },\n          {\n            name: 'description',\n            component: TextareaFormControlComponent,\n            options: {\n              label: this.translateService.instant('com.bmc.arsys.rx.client.common.description.label'),\n              rows: 3\n            } as ITextareaFormControlOptions\n          },\n          {\n            component: RxRevertCustomizationComponent,\n            options: {\n              allowOverlay: definitionModel.customizationOptions.allowOverlay,\n              scope: definitionModel.customizationOptions.scope,\n              overlayGroupId: definitionModel.overlayGroupId,\n              overlayDescriptor: definitionModel.overlayDescriptor\n            }\n          },\n          {\n            name: 'customizationOptions',\n            component: CustomizationOptionsComponent,\n            isDisabled: !isCustomizationAllowed,\n            options: {\n              definitionTypeDisplayName: this.translateService\n                .instant('com.bmc.arsys.rx.client.document-definition.label')\n                .toLowerCase(),\n              allowOverlay: definitionModel.customizationOptions.allowOverlay,\n              scope: definitionModel.customizationOptions.scope,\n              overlayGroupId: definitionModel.overlayGroupId,\n              overlayDescriptor: definitionModel.overlayDescriptor\n            }\n          }\n        ]\n      }\n    ] as IFormBuilderConfig;\n  }\n\n  private validate(definitionModel: IDocumentDefinitionModel): IValidationIssueSection[] {\n    const validationIssues: IValidationIssue[] = [];\n\n    if (isEmpty(trim(definitionModel.name))) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.cannot-be-blank.message',\n          {\n            propertyName: this.translateService.instant('com.bmc.arsys.rx.client.document-designer.document-name.label')\n          }\n        ),\n        data: {\n          propertyName: 'name'\n        }\n      });\n    }\n\n    if (definitionModel.name && !RX_RECORD_DEFINITION.validDefinitionNameRegex.test(definitionModel.name)) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.invalid-definition-name.message',\n          {\n            propertyName: this.translateService.instant('com.bmc.arsys.rx.client.document-designer.document-name.label')\n          }\n        ),\n        data: {\n          propertyName: 'name'\n        }\n      });\n    }\n\n    if (isEmpty(trim(definitionModel.documentSchema))) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.designer.validation.cannot-be-blank.message',\n          {\n            propertyName: this.translateService.instant(\n              'com.bmc.arsys.rx.client.document-designer.document-schema.label'\n            )\n          }\n        ),\n        data: {\n          propertyName: 'documentSchema'\n        }\n      });\n    } else if (isUndefined(this.rxJsonParserService.tryParseJson(definitionModel.documentSchema))) {\n      validationIssues.push({\n        type: ValidationIssueType.Error,\n        description: this.translateService.instant(\n          'com.bmc.arsys.rx.client.document-designer.validation.json-is-not-valid.message'\n        ),\n        data: {\n          propertyName: 'documentSchema'\n        }\n      });\n    }\n\n    return validationIssues.length\n      ? [\n          {\n            title: this.translateService.instant('com.bmc.arsys.rx.client.document-designer.title'),\n            issues: validationIssues\n          }\n        ]\n      : [];\n  }\n\n  ngOnDestroy(): void {\n    this.inspectorFocusEditorSubject.complete();\n    this.destroyed$.next(true);\n    this.destroyed$.complete();\n    this.store$.dispatch(DocumentDesignerActions.destroy());\n  }\n}\n","<ng-container *ngIf=\"vm$ | async as vm\">\n  <rx-designer-header\n    [bundleName]=\"vm.bundleFriendlyName\"\n    [breadcrumbItems]=\"vm.breadcrumbItems\"\n    [isDesignMode]=\"!vm.definitionForJsonViewer\"\n    [isSaveButtonDisabled]=\"vm.isSaveButtonDisabled\"\n    (toggleDesignMode)=\"onToggleDesignMode()\"\n    (save)=\"onSave()\"\n    (closeDesigner)=\"closeDesigner.emit()\"\n  ></rx-designer-header>\n\n  <div class=\"rx-designer-component\" [hidden]=\"!!vm.definitionForJsonViewer\">\n    <adapt-sidebar position=\"right\" panelWidth=\"280px\" [openedId]=\"0\">\n      <adapt-sidebar-item\n        headerTitle=\"{{ 'com.bmc.arsys.rx.client.common.properties.label' | translate }}\"\n        tooltipText=\"{{ 'com.bmc.arsys.rx.client.common.properties.label' | translate }}\"\n        iconClass=\"d-icon-pencil\"\n      >\n        <rx-form-builder\n          [config]=\"vm.definitionInspectorConfig\"\n          [focusEditor$]=\"inspectorFocusEditor$\"\n          (editorEvent)=\"onEditorEvent($event)\"\n          [isReadOnly]=\"vm.isReadOnly\"\n          [model]=\"vm.definitionModel\"\n          (formInitialized)=\"onDefinitionInspectorInitialized()\"\n          (modelChange)=\"onDefinitionModelChange($event)\"\n        ></rx-form-builder>\n      </adapt-sidebar-item>\n\n      <adapt-sidebar-item\n        headerTitle=\"{{ 'com.bmc.arsys.rx.client.designer.validation-issues.label' | translate }}\"\n        tooltipText=\"{{ 'com.bmc.arsys.rx.client.designer.validation-issues.label' | translate }}\"\n        [iconClass]=\"vm.hasValidationErrors ? 'd-icon-exclamation_triangle text-danger' : 'd-icon-exclamation_triangle'\"\n      >\n        <rx-validation-issues\n          [definitionTypeDisplayName]=\"'com.bmc.arsys.rx.client.document-definition.label' | translate\"\n          [issueSections]=\"vm.validationIssues\"\n          (correctIssue)=\"onCorrectIssue($event)\"\n        ></rx-validation-issues>\n      </adapt-sidebar-item>\n\n      <div class=\"main rx-designer-container h-100\">\n        <adapt-rx-control-label\n          [label]=\"'com.bmc.arsys.rx.client.document-designer.document-schema.label' | translate\"\n          [showRequiredLabel]=\"true\"\n        >\n        </adapt-rx-control-label>\n\n        <textarea\n          [formControl]=\"schemaFormControl\"\n          [readonly]=\"vm.isReadOnly\"\n          class=\"form-control h-100\"\n          name=\"documentSchema\"\n          required\n          id=\"document-schema\"\n          rx-id=\"document-schema\"\n        ></textarea>\n      </div>\n    </adapt-sidebar>\n  </div>\n\n  <adapt-code-viewer\n    *ngIf=\"vm.definitionForJsonViewer\"\n    [code]=\"vm.definitionForJsonViewer | json\"\n    [lang]=\"'javascript'\"\n    [hasToolbar]=\"false\"\n    [theme]=\"'light'\"\n    class=\"full-size\"\n  >\n  </adapt-code-viewer>\n</ng-container>\n"]}