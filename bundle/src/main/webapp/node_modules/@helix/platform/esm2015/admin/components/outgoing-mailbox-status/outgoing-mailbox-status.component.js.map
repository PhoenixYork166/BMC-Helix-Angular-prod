{"version":3,"file":"outgoing-mailbox-status.component.js","sourceRoot":"","sources":["../../../../../../../libs/platform/admin/components/outgoing-mailbox-status/outgoing-mailbox-status.component.ts","../../../../../../../libs/platform/admin/components/outgoing-mailbox-status/outgoing-mailbox-status.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAU,SAAS,EAAE,MAAM,eAAe,CAAC;AAC7D,OAAO,EAAE,eAAe,EAAkB,MAAM,uBAAuB,CAAC;AACxE,OAAO,EAAE,sBAAsB,EAAC,MAAM,sBAAsB,CAAC;AAC7D,OAAO,EAAqB,oBAAoB,EAAE,MAAM,4BAA4B,CAAC;AACrF,OAAO,EAAwC,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AAC5G,OAAO,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AAChC,OAAO,MAAM,MAAM,YAAY,CAAC;AAChC,OAAO,EAAc,EAAE,EAAE,MAAM,MAAM,CAAC;AACtC,OAAO,EAAE,sCAAsC,EAAE,MAAM,6CAA6C,CAAC;AACrG,OAAO,EAAE,0BAA0B,EAAE,MAAM,oCAAoC,CAAC;AAChF,OAAO,EAAE,gBAAgB,EAAE,MAAM,qBAAqB,CAAC;;;;;;;;AAOvD,MAAM,OAAO,mCAAmC;IAa9C,YACU,sCAA8E,EAC9E,gBAAkC,EAClC,UAA2B;QAF3B,2CAAsC,GAAtC,sCAAsC,CAAwC;QAC9E,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,eAAU,GAAV,UAAU,CAAiB;QAVrC,wBAAmB,GAAqB,0BAA0B,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,EAAE,CAAC,iCACrG,SAAS,KACZ,IAAI,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,IACnD,CAAC,CAAC;QAEJ,sBAAiB,GAAqB,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC,CAAC;QAOlE,UAAU,CAAC,aAAa,CAAC,CAAC,sBAAsB,CAAC,CAAC,CAAC;IACrD,CAAC;IAED,QAAQ;QACN,MAAM,WAAW,GAAwB;YACvC;gBACE,KAAK,EAAE,CAAC;gBACR,OAAO,EAAE,0BAA0B,CAAC,MAAM,CAAC,WAAW;gBACtD,KAAK,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,0EAA0E,CAAC;aACjH;YACD;gBACE,KAAK,EAAE,CAAC;gBACR,OAAO,EAAE,0BAA0B,CAAC,MAAM,CAAC,OAAO;gBAClD,KAAK,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,qEAAqE,CAAC;gBAC3G,UAAU,EAAE,KAAK;aAClB;YACD;gBACE,KAAK,EAAE,CAAC;gBACR,OAAO,EAAE,0BAA0B,CAAC,MAAM,CAAC,KAAK;gBAChD,KAAK,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,4CAA4C,CAAC;gBAClF,UAAU,EAAE,KAAK;aAClB;YACD;gBACE,KAAK,EAAE,CAAC;gBACR,OAAO,EAAE,0BAA0B,CAAC,MAAM,CAAC,IAAI;gBAC/C,KAAK,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,kEAAkE,CAAC;gBACxG,UAAU,EAAE,KAAK;aAClB;SACF,CAAC;QAEF,MAAM,gBAAgB,GAAsB;YAC1C,gBAAgB,EAAE;gBAChB;oBACE,EAAE,EAAE,0BAA0B,CAAC,MAAM,CAAC,WAAW;oBACjD,YAAY,EAAE,oBAAoB,CAAC,aAAa,CAAC,SAAS;iBAC3D;gBACD;oBACE,EAAE,EAAE,0BAA0B,CAAC,MAAM,CAAC,OAAO;oBAC7C,YAAY,EAAE,oBAAoB,CAAC,aAAa,CAAC,SAAS;iBAC3D;gBACD;oBACE,EAAE,EAAE,0BAA0B,CAAC,MAAM,CAAC,KAAK;oBAC3C,YAAY,EAAE,oBAAoB,CAAC,aAAa,CAAC,SAAS;iBAC3D;gBACD;oBACE,EAAE,EAAE,0BAA0B,CAAC,MAAM,CAAC,IAAI;oBAC1C,YAAY,EAAE,oBAAoB,CAAC,aAAa,CAAC,SAAS;iBAC3D;aACF;SACF,CAAC;QAEF,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;YACzB,OAAO,EAAE,WAAW;YACpB,eAAe,EAAE,IAAI;YACrB,kBAAkB,EAAE,IAAI;YACxB,mBAAmB,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,gBAAgB,CAAC;YAC/C,OAAO,EAAE,CAAC,WAAW,EAAE,EAAE;gBACvB,MAAM,CAAC,WAAW,EAAE;oBAClB,cAAc,EAAE,MAAM,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,WAAW,EAAE;iBACpF,CAAC,CAAC;gBAEH,OAAO,IAAI,CAAC,sCAAsC,CAAC,GAAG,CAAC,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC,CAAC;YAClF,CAAC;YACD,MAAM,EAAE,WAAW;YACnB,oBAAoB,EAAE,KAAK;SAC5B,CAAC,CAAC;IACL,CAAC;IAED,iBAAiB,CAAC,SAAyB;QACzC,IAAI,CAAC,iBAAiB,GAAG,SAAS,CAAC;QACnC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,SAAS,EAAE,CAAC;IAC5C,CAAC;IAED,eAAe,CAAC,SAAyB;QACvC,OAAO,SAAS,CAAC,IAAI,CAAC;IACxB,CAAC;;gIA7FU,mCAAmC;oHAAnC,mCAAmC,kLCjBhD,2nCA8BA;2FDba,mCAAmC;kBAL/C,SAAS;mBAAC;oBACT,QAAQ,EAAE,kCAAkC;oBAC5C,WAAW,EAAE,0CAA0C;oBACvD,SAAS,EAAE,CAAC,0CAA0C,CAAC;iBACxD;0LAGC,UAAU;sBADT,SAAS;uBAAC,YAAY","sourcesContent":["import { Component, OnInit, ViewChild } from '@angular/core';\nimport { AdaptIconConfig, RxSelectOption } from '@bmc-ux/adapt-angular';\nimport { ai_info_circle_o_adapt} from '@bmc-ux/dpl-iconfont';\nimport { IRecordDefinition, RX_RECORD_DEFINITION } from '@helix/platform/record/api';\nimport { IRecordGridColumn, IRecordGridConfig, RecordGridComponent } from '@helix/platform/view/components';\nimport { assign } from 'lodash';\nimport moment from 'moment-es6';\nimport { Observable, of } from 'rxjs';\nimport { RxOutgoingMailboxStatusDataPageService } from './outgoing-mailbox-status-data-page.service';\nimport { RX_OUTGOING_MAILBOX_STATUS } from './outgoing-mailbox-status.constant';\nimport { TranslateService } from '@ngx-translate/core';\n\n@Component({\n  selector: 'rx-admin-outgoing-mailbox-status',\n  templateUrl: './outgoing-mailbox-status.component.html',\n  styleUrls: ['./outgoing-mailbox-status.component.scss']\n})\nexport class OutgoingMailboxStatusAdminComponent implements OnInit {\n  @ViewChild('recordGrid')\n  recordGrid: RecordGridComponent;\n\n  recordGridConfig: Observable<IRecordGridConfig>;\n\n  availableTimeFrames: RxSelectOption[] = RX_OUTGOING_MAILBOX_STATUS.availableTimeFrames.map((timeFrame) => ({\n    ...timeFrame,\n    name: this.translateService.instant(timeFrame.name)\n  }));\n\n  selectedTimeFrame: RxSelectOption[] = [this.availableTimeFrames[0]];\n\n  constructor(\n    private rxOutgoingMailboxStatusDataPageService: RxOutgoingMailboxStatusDataPageService,\n    private translateService: TranslateService,\n    private iconConfig: AdaptIconConfig\n  ) {\n    iconConfig.registerIcons([ai_info_circle_o_adapt]);\n  }\n\n  ngOnInit() {\n    const gridColumns: IRecordGridColumn[] = [\n      {\n        index: 0,\n        fieldId: RX_OUTGOING_MAILBOX_STATUS.fields.mailboxName,\n        title: this.translateService.instant('com.bmc.arsys.rx.client.admin.outgoing-mailbox-status.mailbox-name.label')\n      },\n      {\n        index: 1,\n        fieldId: RX_OUTGOING_MAILBOX_STATUS.fields.pending,\n        title: this.translateService.instant('com.bmc.arsys.rx.client.admin.outgoing-mailbox-status.pending.label'),\n        filterable: false\n      },\n      {\n        index: 2,\n        fieldId: RX_OUTGOING_MAILBOX_STATUS.fields.error,\n        title: this.translateService.instant('com.bmc.arsys.rx.client.common.error.label'),\n        filterable: false\n      },\n      {\n        index: 3,\n        fieldId: RX_OUTGOING_MAILBOX_STATUS.fields.sent,\n        title: this.translateService.instant('com.bmc.arsys.rx.client.admin.outgoing-mailbox-status.sent.label'),\n        filterable: false\n      }\n    ];\n\n    const recordDefinition: IRecordDefinition = {\n      fieldDefinitions: [\n        {\n          id: RX_OUTGOING_MAILBOX_STATUS.fields.mailboxName,\n          resourceType: RX_RECORD_DEFINITION.resourceTypes.character\n        },\n        {\n          id: RX_OUTGOING_MAILBOX_STATUS.fields.pending,\n          resourceType: RX_RECORD_DEFINITION.resourceTypes.character\n        },\n        {\n          id: RX_OUTGOING_MAILBOX_STATUS.fields.error,\n          resourceType: RX_RECORD_DEFINITION.resourceTypes.character\n        },\n        {\n          id: RX_OUTGOING_MAILBOX_STATUS.fields.sent,\n          resourceType: RX_RECORD_DEFINITION.resourceTypes.character\n        }\n      ]\n    };\n\n    this.recordGridConfig = of({\n      columns: gridColumns,\n      enableFiltering: true,\n      enableRowSelection: null,\n      getRecordDefinition: () => of(recordDefinition),\n      getData: (queryParams) => {\n        assign(queryParams, {\n          messagesBefore: moment().subtract(this.selectedTimeFrame[0].duration).toISOString()\n        });\n\n        return this.rxOutgoingMailboxStatusDataPageService.get({ params: queryParams });\n      },\n      styles: 'flex-fill',\n      useExternalFiltering: false\n    });\n  }\n\n  onTimeFrameChange(timeFrame: RxSelectOption): void {\n    this.selectedTimeFrame = timeFrame;\n    this.recordGrid.api.refresh().subscribe();\n  }\n\n  optionFormatter(timeFrame: RxSelectOption): string {\n    return timeFrame.name;\n  }\n}\n","<rx-admin-settings header=\"Outgoing mailbox status\">\n  <div class=\"d-flex flex-wrap\">\n    <adapt-rx-select\n      label=\"{{ 'com.bmc.arsys.rx.client.admin.outgoing-mailbox-status.time-frame.label' | translate }}\"\n      class=\"form-group\"\n      rx-id=\"time-frame\"\n      [options]=\"availableTimeFrames\"\n      [ngModel]=\"selectedTimeFrame\"\n      [optionFormatter]=\"optionFormatter\"\n      (ngModelChange)=\"onTimeFrameChange($event)\"\n    >\n    </adapt-rx-select>\n\n    <button\n      adapt-button\n      btn-type=\"tertiary\"\n      class=\"form-group ml-auto align-self-end\"\n      placement=\"bottom\"\n      type=\"button\"\n      [adaptPopover]=\"'com.bmc.arsys.rx.client.admin.outgoing-mailbox-status.about-sent-email.tooltip' | translate\"\n    >\n      <span>\n        <adapt-icon name=\"info_circle_o_adapt\"></adapt-icon>\n        {{ 'com.bmc.arsys.rx.client.admin.outgoing-mailbox-status.about-sent-email.label' | translate }}\n      </span>\n    </button>\n  </div>\n\n  <rx-record-grid rx-id=\"outgoing-mailbox-status-grid\" #recordGrid [config]=\"recordGridConfig\"></rx-record-grid>\n</rx-admin-settings>\n"]}