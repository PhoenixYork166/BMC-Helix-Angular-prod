{"version":3,"file":"tab-panel-design.component.js","sourceRoot":"","sources":["../../../../../../../../libs/platform/view/components/tab-panel/design/tab-panel-design.component.ts","../../../../../../../../libs/platform/view/components/tab-panel/design/tab-panel-design.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input, OnInit, ViewChild } from '@angular/core';\nimport { TabEvent } from '@bmc-ux/adapt-angular';\nimport { RxUtilityModalsService } from '@helix/platform/ui-kit';\nimport { findIndex, first } from 'lodash';\nimport { ReplaySubject } from 'rxjs';\nimport { take, takeUntil } from 'rxjs/operators';\nimport { TabPanelDesignModel } from './tab-panel-design.model';\n\n@Component({\n  selector: 'rx-tab-panel-design',\n  templateUrl: './tab-panel-design.component.html',\n  styleUrls: ['./tab-panel-design.component.scss']\n})\nexport class TabPanelDesignComponent implements OnInit {\n  @Input()\n  model: TabPanelDesignModel;\n\n  @Input()\n  isReadOnly: boolean;\n\n  @ViewChild('adaptTabset', { static: true })\n  adaptTabset;\n\n  components = [];\n\n  private destroyed$: ReplaySubject<boolean> = new ReplaySubject(1);\n\n  constructor(private rxUtilityModalsService: RxUtilityModalsService) {}\n\n  ngOnInit(): void {\n    this.model.tabContainerComponents$.pipe(takeUntil(this.destroyed$)).subscribe((components) => {\n      this.components = components;\n\n      this.adaptTabset.checkActiveIndex();\n    });\n\n    this.model.tabContainerComponents$.pipe(take(1)).subscribe((components) => {\n      this.model.selectTab(first(components).guid, true);\n    });\n  }\n\n  ngOnDestroy(): void {\n    this.destroyed$.next(true);\n    this.destroyed$.complete();\n  }\n\n  trackByForTabs<T extends { guid: string }>(index: number, item: T): string {\n    return item.guid;\n  }\n\n  onTabClicked(event: TabEvent): void {\n    this.activeTabChanged(event);\n  }\n\n  onTabAdded(e: Event) {\n    e.stopPropagation();\n\n    this.model.addTab();\n\n    setTimeout(() => {\n      this.adaptTabset.setActiveTab(this.components.length - 1, true, new MouseEvent('click'));\n    });\n  }\n\n  activeTabChanged({ index, event }) {\n    event.stopPropagation();\n\n    this.model.tabContainerGuids$.pipe(take(1)).subscribe((guids) => {\n      this.model.selectTab(guids[index]);\n    });\n  }\n\n  onTabDropped(tabs) {\n    for (let i = 0; i < this.components.length; i++) {\n      if (this.components[i].guid !== tabs[i].id) {\n        if (this.components[i].guid === tabs[i + 1].id) {\n          this.model.moveComponent(tabs[i].id, i);\n          break;\n        } else {\n          this.model.moveComponent(this.components[i].guid, findIndex(tabs, { id: this.components[i].guid }));\n          break;\n        }\n      }\n    }\n  }\n\n  removeTab({ index }: TabEvent): void {\n    this.rxUtilityModalsService\n      .confirm('Are you sure you want to delete this view component?')\n      .then((isConfirmed: boolean) => {\n        if (isConfirmed) {\n          this.model.tabContainerGuids$.pipe(take(1)).subscribe((guids) => {\n            this.model.removeTab(guids[index]);\n          });\n        }\n      });\n  }\n}\n","<adapt-tabset\n  #adaptTabset\n  (tab-index-closed)=\"removeTab($event)\"\n  (tab-active-changed)=\"activeTabChanged($event)\"\n  (tabClicked)=\"onTabClicked($event)\"\n  (tabDropped)=\"onTabDropped($event)\"\n  (add-tab-clicked)=\"onTabAdded($event)\"\n  [allow-tabs-adding]=\"!isReadOnly\"\n  [enableDnD]=\"true\"\n>\n  <adapt-tab-panel\n    *ngFor=\"\n      let component of components;\n      let index = index;\n      trackBy: trackByForTabs\n    \"\n    [adapt-tab-title]=\"component.data.label\"\n    [icon-close]=\"!isReadOnly && components.length && components.length > 1\"\n    [id]=\"component.guid\"\n  >\n  </adapt-tab-panel>\n</adapt-tabset>\n\n<rx-canvas-outlet [dropPredicate]=\"model.dropPredicate\"></rx-canvas-outlet>\n"]}